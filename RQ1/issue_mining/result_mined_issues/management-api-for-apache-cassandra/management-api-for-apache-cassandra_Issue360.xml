<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>360</ISSUENO>
  <ISSUEURL>https://github.com/k8ssandra/management-api-for-apache-cassandra/issues/360</ISSUEURL>
  <TITLE>Support Cassandra 5.0-alpha1</TITLE>
  <DESCRIPTION>A recent test showed that Management API fails to start correctly with Cassandra 5.0-alpha1. The following is observed in the Cassandra logs: ``` WARN [epollEventLoopGroup-5-4] 2023-08-22 19:23:41,004 AbstractChannelHandlerContext.java:355 - An exception 'java.lang.IllegalArgumentException: Unsupported socket address type: class io.netty.channel.unix.DomainSocketAddress' [enable DEBUG level for full stacktrace] was thrown by a user handler's exceptionCaught() method while handling the following exception: io.netty.handler.codec.DecoderException: java.lang.ClassCastException: class io.netty.channel.unix.DomainSocketAddress cannot be cast to class java.net.InetSocketAddress (io.netty.channel.unix.DomainSocketAddress is in unnamed module of loader 'app'; java.net.InetSocketAddress is in module java.base of loader 'bootstrap') at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:499) at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:290) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:800) at io.netty.channel.epoll.EpollDomainSocketChannel$EpollDomainUnsafe.epollInReady(EpollDomainSocketChannel.java:140) at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:509) at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:407) at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997) at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) at java.base/java.lang.Thread.run(Thread.java:829) Caused by: java.lang.ClassCastException: class io.netty.channel.unix.DomainSocketAddress cannot be cast to class java.net.InetSocketAddress (io.netty.channel.unix.DomainSocketAddress is in unnamed module of loader 'app'; java.net.InetSocketAddress is in module java.base of loader 'bootstrap') at org.apache.cassandra.service.ClientState.forExternalCalls(ClientState.java:199) at org.apache.cassandra.transport.ServerConnection.&lt;init&gt;(ServerConnection.java:47) at org.apache.cassandra.transport.UnixSocketServer50x$UnixSocketConnection.&lt;init&gt;(UnixSocketServer50x.java:143) at org.apache.cassandra.transport.UnixSocketServer50x$1.lambda$initChannel$0(UnixSocketServer50x.java:68) at org.apache.cassandra.transport.UnixSocketServer50x$PipelineChannelInitializer.decode(UnixSocketServer50x.java:253) at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:529) at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:468) ... 16 common frames omitted ```</DESCRIPTION>
  <REPONAME>management-api-for-apache-cassandra</REPONAME>
  <TIMEDIFFERENCEDAYS>69</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Refactor shaded library project</MESSAGE>
    <SHA>ba983afb3daff595b81dd3f5cdce90f34815519e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Release v0.1.71 * [CHANGE] [#425](https://github.com/k8ssandra/management-api-for-apache-cassandra/issues/425) Shade Jackson libraries in agents * [BUGFIX] [#413](https://github.com/k8ssandra/management-api-for-apache-cassandra/issues/413) UBI8 images do not terminate correctly * [BUGFIX] [#360](https://github.com/k8ssandra/management-api-for-apache-cassandra/issues/360) Support Cassandra 5.0-alpha1 * [BUGFIX] [#415](https://github.com/k8ssandra/management-api-for-apache-cassandra/issues/415) Some jvm_* metrics aren't labelled correctly * [BUGFIX] [#422](https://github.com/k8ssandra/management-api-for-apache-cassandra/issues/422) Metrics endpoint fails to start for some DSE images * [FEATURE] [#398](https://github.com/k8ssandra/management-api-for-apache-cassandra/issues/398) Make Management API port configurable * [FEATURE] [#419](https://github.com/k8ssandra/management-api-for-apache-cassandra/issues/419) Add DSE 6.8.40 to the build matrix * [FEATURE] [#397](https://github.com/k8ssandra/management-api-for-apache-cassandra/issues/397) Add Cassandra 4.0.11, 4.1.3 5.0-alpha2</MESSAGE>
      <SHA>9795d838e7c965c50a0a6a0d687c93db70344255</SHA>
      <PATCHEDFILES>
        <FILE>CHANGELOG.md</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
