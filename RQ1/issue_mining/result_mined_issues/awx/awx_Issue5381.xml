<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5381</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/5381</ISSUEURL>
  <TITLE>&quot;Stop AWX before upgrading postgres&quot; fails with docker.io/awx_web not found</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Bug Report ##### SUMMARY &lt;!-- Briefly describe the problem. --&gt; Task &quot;Stop AWX before upgrading postgres&quot; fails before attempting to upgrade. This happens both with local docker image build and docker hub images. ##### ENVIRONMENT * AWX version: 7.0.0 * AWX install docker on linux * Ansible version: 2.9 * Operating System: Centos 7 ##### STEPS TO REPRODUCE &lt;!-- Please describe exactly how to reproduce the problem. --&gt; Upgrade existing AWX 7.0.0 with data to AWX 9.0.1 ##### ACTUAL RESULTS &lt;!-- What actually happened? --&gt; ``` TASK [local_docker : Stop AWX before upgrading postgres] **************************************************************************************************************************** task path: /root/awx/9.0.1/awx/installer/roles/local_docker/tasks/main.yml:25 &lt;localhost&gt; ESTABLISH LOCAL CONNECTION FOR USER: root &lt;localhost&gt; EXEC /bin/sh -c 'echo ~root &amp;&amp; sleep 0' &lt;localhost&gt; EXEC /bin/sh -c '( umask 77 &amp;&amp; mkdir -p &quot;` echo /root/.ansible/tmp/ansible-tmp-1574414988.12-30300653511081 `&quot; &amp;&amp; echo ansible-tmp-1574414988.12-30300653511081=&quot;` echo /root/.ansible/tmp/ansible-tmp-1574414988.12-30300653511081 `&quot; ) &amp;&amp; sleep 0' Using module file /usr/lib/python2.7/site-packages/ansible/modules/cloud/docker/_docker_service.py &lt;localhost&gt; PUT /root/.ansible/tmp/ansible-local-9744MbI606/tmpbSyoOO TO /root/.ansible/tmp/ansible-tmp-1574414988.12-30300653511081/AnsiballZ__docker_service.py &lt;localhost&gt; EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1574414988.12-30300653511081/ /root/.ansible/tmp/ansible-tmp-1574414988.12-30300653511081/AnsiballZ__docker_service.py &amp;&amp; sleep 0' &lt;localhost&gt; EXEC /bin/sh -c '/usr/bin/env python /root/.ansible/tmp/ansible-tmp-1574414988.12-30300653511081/AnsiballZ__docker_service.py &amp;&amp; sleep 0' &lt;localhost&gt; EXEC /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1574414988.12-30300653511081/ &gt; /dev/null 2&gt;&amp;1 &amp;&amp; sleep 0' The full traceback is: WARNING: The below traceback may *not* be related to the actual failure. File &quot;/tmp/ansible_docker_service_payload_LZ0zA2/__main__.py&quot;, line 784, in cmd_up timeout=self.timeout) File &quot;/usr/lib/python2.7/site-packages/compose/project.py&quot;, line 527, in up svc.ensure_image_exists(do_build=do_build, silent=silent) File &quot;/usr/lib/python2.7/site-packages/compose/service.py&quot;, line 354, in ensure_image_exists self.pull(silent=silent) File &quot;/usr/lib/python2.7/site-packages/compose/service.py&quot;, line 1222, in pull return progress_stream.get_digest_from_pull(event_stream) File &quot;/usr/lib/python2.7/site-packages/compose/progress_stream.py&quot;, line 102, in get_digest_from_pull for event in events: File &quot;/usr/lib/python2.7/site-packages/compose/service.py&quot;, line 1193, in _do_pull for event in stream_output(output, sys.stdout): File &quot;/usr/lib/python2.7/site-packages/compose/progress_stream.py&quot;, line 30, in stream_output print_output_event(event, stream, is_terminal) File &quot;/usr/lib/python2.7/site-packages/compose/progress_stream.py&quot;, line 62, in print_output_event raise StreamOutputError(event['errorDetail']['message']) [DEPRECATION WARNING]: The 'docker_service' module has been renamed to 'docker_compose'.. This feature will be removed in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg. fatal: [localhost]: FAILED! =&gt; { &quot;changed&quot;: false, &quot;errors&quot;: [], &quot;invocation&quot;: { &quot;module_args&quot;: { &quot;api_version&quot;: &quot;auto&quot;, &quot;build&quot;: false, &quot;ca_cert&quot;: null, &quot;client_cert&quot;: null, &quot;client_key&quot;: null, &quot;debug&quot;: false, &quot;definition&quot;: null, &quot;dependencies&quot;: true, &quot;docker_host&quot;: &quot;unix://var/run/docker.sock&quot;, &quot;files&quot;: null, &quot;hostname_check&quot;: false, &quot;nocache&quot;: false, &quot;project_name&quot;: null, &quot;project_src&quot;: &quot;/opt/awxcompose&quot;, &quot;pull&quot;: false, &quot;recreate&quot;: &quot;smart&quot;, &quot;remove_images&quot;: null, &quot;remove_orphans&quot;: false, &quot;remove_volumes&quot;: false, &quot;restarted&quot;: false, &quot;scale&quot;: null, &quot;services&quot;: null, &quot;ssl_version&quot;: null, &quot;state&quot;: &quot;present&quot;, &quot;stopped&quot;: true, &quot;timeout&quot;: 10, &quot;tls&quot;: false, &quot;tls_hostname&quot;: &quot;localhost&quot;, &quot;validate_certs&quot;: false } }, &quot;module_stderr&quot;: &quot;&quot;, &quot;module_stdout&quot;: &quot;Trying to pull repository docker.io/library/memcached ... \nalpine: Pulling from docker.io/library/memcached\nDigest: sha256:3cfb2eee0b618722a62f4cc907fa0ede848efa87d773bb9384044f490926e7ce\nStatus: Downloaded newer image for docker.io/memcached:alpine\nTrying to pull repository docker.io/library/postgres ... \n9.6: Pulling from docker.io/library/postgres\nDigest: sha256:ee2bca621b318e79267b169cff0db52a163af0167537483736d14f471ff4ba0a\nStatus: Downloaded newer image for docker.io/postgres:9.6\nTrying to pull repository docker.io/ansible/awx_rabbitmq ... \n3.7.4: Pulling from docker.io/ansible/awx_rabbitmq\nDigest: sha256:3ff448f979149a0684c61b0f00eb0fe7bc480b123323aa80fb3bb8934027f895\nStatus: Downloaded newer image for docker.io/ansible/awx_rabbitmq:3.7.4\nTrying to pull repository docker.io/library/awx_web ... \n&quot;, &quot;msg&quot;: &quot;Error starting project repository docker.io/awx_web not found: does not exist or no pull access&quot; } ``` ##### ADDITIONAL INFORMATION &lt;!-- Include any links to sosreport, database dumps, screenshots or other information. --&gt;</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #5373 from ansible/ui_settings_saml Fix SAML variables default values</MESSAGE>
    <SHA>553cbec84ce6c882fd996dffd5c1551b1cf8bd53</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #5381 from ansible/revert_reaping2 Revert &quot;Merge pull request #5354 from ansible/jobs_killed_via_receptor_should_get_reaped&quot;</MESSAGE>
      <SHA>38a90061611f6c3bd7b06ba160b746825adc6e50</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/tasks.py</FILE>
        <FILE>awx/main/tests/unit/test_tasks.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
