<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>8641</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/8641</ISSUEURL>
  <TITLE>Cannot disable a schedule for a JT with a missing project (and it keeps running)</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Bug Report ##### SUMMARY It's fairly easy to get into a state where a schedule is enabled with an invalid JT, and the schedule cannot be turned off, due to a validation error on the JT. Even though the schedule is invalid, it keeps running on the schedule interval, and its jobs fail obviously. ##### ENVIRONMENT * AWX version: 15.0.1 ##### STEPS TO REPRODUCE Create a JT Create a 1-minute schedule for that JT Delete the project used by the JT (or its inventory) Try to disable the schedule in the UI ##### EXPECTED RESULTS Schedule turns off ##### ACTUAL RESULTS 400 response ```json {&quot;resources_needed_to_start&quot;:[&quot;Job Template project is missing or undefined.&quot;,&quot;Job Template inventory is missing or undefined.&quot;]} ``` This is what you get hitting the disable button in the UI, which performs a PATCH to the schedule, setting the &quot;enabled&quot; field to False, and it includes the rest of the data. The issue is on the API here, because the request made by the UI seems reasonable, and should be expected to succeed. Perhaps the API should only error on this type of validation if the schedule is being _enabled_. ##### ADDITIONAL INFORMATION Similar to https://github.com/ansible/awx/issues/7521 by @chrismeyersfsu, seen in test runs, and creates background processing since the 1-minute schedule continues to run for the duration that the server is up.</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>189</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #9537 from AlexSCorey/lingUIUpdate Updates Ling UI SUMMARY This PR updates Ling ui. One of the reasons for updating this dependency was that they were deprecating withI18n(). They changed their minds on that so we didn't need to urgently remove all those HOCs. Thus, we can now make that conversion a bit slower a couple of files at a time. One other thing: When we are changing the string based on a count of an item (ie. Cancel Job vs. Cancel Jobs) we should use ling ui's &lt;Plural&gt; component. However, in order to show the update strings passed to that component the developer will have to run npm run extract-strings each time they are changed to render the updated strings properly. More info here. ISSUE TYPE -dependency upgrade COMPONENT NAME UI AWX VERSION ADDITIONAL INFORMATION Reviewed-by: Kersom &lt;None&gt; Reviewed-by: Alex Corey &lt;Alex.swansboro@gmail.com&gt; Reviewed-by: Sergio Moreno &lt;sergiomorenoalbert@gmail.com&gt;</MESSAGE>
    <SHA>c72cc6486c2d8e001d5f342aada6e36bcc0c5b1d</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>allow schedules to be disabled even if the UJT isn't valid see: https://github.com/ansible/awx/issues/8641</MESSAGE>
      <SHA>b5f77bfe4c5e686bc8798e42abd0bd127ccc142b</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/serializers.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>record the receptor unit ID on the job record for debugging purposes see: https://github.com/ansible/awx/issues/8641</MESSAGE>
      <SHA>450e71e056a4e6372def292fe122643b1eab9d31</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/tasks.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>record the receptor unit ID on the job record for debugging purposes see: https://github.com/ansible/awx/issues/8641</MESSAGE>
      <SHA>b3b7e557e6c0e6ac93dc3ee58029241c0a164106</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/tasks.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>record the receptor unit ID on the job record for debugging purposes see: https://github.com/ansible/awx/issues/8641</MESSAGE>
      <SHA>4db3c36ac3c133726dfd43401848025dee807542</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/tasks.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9892 from ryanpetrello/record-unit-id record the receptor unit ID on the job record for debugging purposes see: #8641 Reviewed-by: Shane McDonald &lt;me@shanemcd.com&gt;</MESSAGE>
      <SHA>e67923382a4336b3f23c5bbf46cde2506dc7e50b</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/tasks.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9890 from ryanpetrello/schedule-invalid-ujt allow schedules to be disabled even if the associated UJT isn't valid see: #8641 Reviewed-by: Christian Adams &lt;rooftopcellist@gmail.com&gt; Reviewed-by: Jeff Bradberry &lt;None&gt;</MESSAGE>
      <SHA>b82318161c5ea737621106da139da285c49b10dc</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/serializers.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
