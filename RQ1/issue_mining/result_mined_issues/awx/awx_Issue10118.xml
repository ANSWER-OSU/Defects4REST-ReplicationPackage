<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>10118</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/10118</ISSUEURL>
  <TITLE>Jobs on systems missing EEs throw an error instead of failing</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Bug Report ##### SUMMARY If the user fails to have an execution environment available, the dispatcher will raise an error and a traceback will go to the logs, but the feedback provided to the user via the UI or API is mysterious. ##### ENVIRONMENT * AWX version: 19.1.0 ##### STEPS TO REPRODUCE 1. deliberately delete all EEs, including any installed managed-by-tower EEs 2. trigger a project update ##### EXPECTED RESULTS If there are no EEs available, the job should fail with an explicit reason provided in the job output in the UI. ##### ACTUAL RESULTS job output: ![image(4)](https://user-images.githubusercontent.com/685957/117202438-d17c3580-adbb-11eb-8d5e-ab255aefeacc.png) in the logs: ``` tools_awx_1 | awx-dispatcher stdout | 2021-05-05 19:46:16,092 ERROR [c77b9784] awx.main.tasks project_update 17 (running) Exception occurred while running task tools_awx_1 | awx-dispatcher stdout | Traceback (most recent call last): tools_awx_1 | awx-dispatcher stdout | File &quot;/awx_devel/awx/main/tasks.py&quot;, line 1316, in run tools_awx_1 | awx-dispatcher stdout | env = self.build_env(self.instance, private_data_dir, private_data_files=private_data_files) tools_awx_1 | awx-dispatcher stdout | File &quot;/awx_devel/awx/main/tasks.py&quot;, line 1883, in build_env tools_awx_1 | awx-dispatcher stdout | env = super(RunProjectUpdate, self).build_env(project_update, private_data_dir, private_data_files=private_data_files) tools_awx_1 | awx-dispatcher stdout | File &quot;/awx_devel/awx/main/tasks.py&quot;, line 997, in build_env tools_awx_1 | awx-dispatcher stdout | ee_cred = self.instance.execution_environment.credential tools_awx_1 | awx-dispatcher stdout | AttributeError: 'NoneType' object has no attribute 'credential' tools_awx_1 | awx-dispatcher stdout | ```</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>20</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #10113 from AlexSCorey/10045-ProjectListIssues Adds Job Cancel Button SUMMARY This addresses part of #10045 and adds a sync cancel button on the projects list. It also expands the usage of that button to the Project details page, and the Inventory Source list. It does this by introducing a new component called JobCancelButton, that basically takes the work of the job cancel button on the Output toolbar and refactors it slightly to make it useable in these other areas. This button could also be used in the Inventory Source details page once we have websockets hooked up for that view and we can track the status of the sync. (#9013) ISSUE TYPE Feature Pull Request COMPONENT NAME UI ADDITIONAL INFORMATION Reviewed-by: Jake McDermott &lt;yo@jakemcdermott.me&gt; Reviewed-by: Kersom &lt;None&gt; Reviewed-by: Alex Corey &lt;Alex.swansboro@gmail.com&gt; Reviewed-by: Tiago GÃ³es &lt;tiago.goes2009@gmail.com&gt;</MESSAGE>
    <SHA>550a66553efbf2f741eb19104d2189e103193723</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #10183 from beeankha/null_ee_show_error Show Error if No Execution Environment is Found on Project Sync or Job Run SUMMARY Duplicate of PR #10147 fixing issue #10118 Reviewed-by: Jeff Bradberry &lt;None&gt; Reviewed-by: Shane McDonald &lt;me@shanemcd.com&gt;</MESSAGE>
      <SHA>7f90a8b2b3d507770131c4b7d55548c80b654663</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/tasks.py</FILE>
        <FILE>awx/main/tests/unit/test_tasks.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
