<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>9472</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/9472</ISSUEURL>
  <TITLE>awx.main.utils.common.get_ansible_version breaks with ansible-core</TITLE>
  <DESCRIPTION>&lt;!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --&gt; ##### ISSUE TYPE - Bug Report ##### SUMMARY &lt;!-- Briefly describe the problem. --&gt; The `awx.main.utils.common.get_ansible_version` helper breaks with new `ansible --version` when ansible-core is installed. This also changes the format the `api/v2/config` returns for the `ansible_version` field. What breaks tools that relies on this field to check the current ansible version used by AWX. ##### ENVIRONMENT * AWX version: devel * AWX install method: vm * Ansible version: ansible-core 2.11 * Operating System: RHEL8.3 * Web Browser: ##### STEPS TO REPRODUCE &lt;!-- Please describe exactly how to reproduce the problem. --&gt; Install AWX with ansible-core and perform a GET request to `/api/v2/config` and check the `ansible_version` field format. ##### EXPECTED RESULTS &lt;!-- What did you expect to happen when running the steps above? --&gt; The ansible version format should be something like `X.Y.Z` (format capable to be parsed by tools like `distutils.version.LooseVersion`) ##### ACTUAL RESULTS &lt;!-- What actually happened? --&gt; Returning something like `&quot;ansible_version&quot;: &quot;[core 2.11.0.dev0]&quot;` ##### ADDITIONAL INFORMATION &lt;!-- Include any links to sosreport, database dumps, screenshots or other information. --&gt; Output of `ansible --version` for ansible-core 2.11: ```console $ ansible --version ansible [core 2.11.0b1] config file = /home/elyezer/code/ansible/ansible-core/ansible.cfg configured module search path = ['/home/elyezer/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules'] ansible python module location = /home/elyezer/.virtualenvs/ansible-core/lib/python3.9/site-packages/ansible ansible collection location = /home/elyezer/.ansible/collections:/usr/share/ansible/collections executable location = /home/elyezer/.virtualenvs/ansible-core/bin/ansible python version = 3.9.0 (default, Oct 6 2020, 00:00:00) [GCC 10.2.1 20200826 (Red Hat 10.2.1-3)] jinja version = 2.11.3 libyaml = True ``` For ansible 2.9: ``` ansible 2.9.16 config file = /home/elyezer/code/ansible/ansible/ansible.cfg configured module search path = ['/home/elyezer/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules'] ansible python module location = /home/elyezer/.virtualenvs/ansible/lib/python3.9/site-packages/ansible executable location = /home/elyezer/.virtualenvs/ansible/bin/ansible python version = 3.9.0 (default, Oct 6 2020, 00:00:00) [GCC 10.2.1 20200826 (Red Hat 10.2.1-3)] ```</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>22</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #9688 from ryanpetrello/fix-busted-collection-pep8 fix busted pep8 collection tests see: psf/black#1841 Reviewed-by: Elijah DeLee &lt;kdelee@redhat.com&gt; Reviewed-by: Matt Clay &lt;None&gt;</MESSAGE>
    <SHA>73cc9e7b353c29b392c8fb93aa2a652f66982a5e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>remove ansible_version from the API config and metrics endpoints AWX no longer includes Ansible on the control plane and there is no &quot;default&quot; version of Ansible aside from what's configured at the Execution Environment level see: https://github.com/ansible/awx/issues/9472</MESSAGE>
      <SHA>41a5e9cfd43365f5be90a33925b305e2eb61443b</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/views/root.py</FILE>
        <FILE>awx/main/analytics/collectors.py</FILE>
        <FILE>awx/main/analytics/metrics.py</FILE>
        <FILE>awx/main/utils/common.py</FILE>
        <FILE>awx/ui_next/src/components/About/About.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.test.jsx</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>remove ansible_version from the API config and metrics endpoints AWX no longer includes Ansible on the control plane and there is no &quot;default&quot; version of Ansible aside from what's configured at the Execution Environment level see: https://github.com/ansible/awx/issues/9472</MESSAGE>
      <SHA>68ec759032cfe7157be6ac226849720af911705f</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/views/root.py</FILE>
        <FILE>awx/main/analytics/collectors.py</FILE>
        <FILE>awx/main/analytics/metrics.py</FILE>
        <FILE>awx/main/utils/common.py</FILE>
        <FILE>awx/ui_next/src/components/About/About.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.test.jsx</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>remove ansible_version from the API config and metrics endpoints AWX no longer includes Ansible on the control plane and there is no &quot;default&quot; version of Ansible aside from what's configured at the Execution Environment level see: https://github.com/ansible/awx/issues/9472</MESSAGE>
      <SHA>73cc2e99c2f5d026f4f5e3591fde710783e7eea0</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/views/root.py</FILE>
        <FILE>awx/main/analytics/collectors.py</FILE>
        <FILE>awx/main/analytics/metrics.py</FILE>
        <FILE>awx/main/utils/common.py</FILE>
        <FILE>awx/ui_next/src/components/About/About.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.test.jsx</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>remove ansible_version from the API config and metrics endpoints AWX no longer includes Ansible on the control plane and there is no &quot;default&quot; version of Ansible aside from what's configured at the Execution Environment level see: https://github.com/ansible/awx/issues/9472</MESSAGE>
      <SHA>db20bbe6820893bbe4979855c310de86afbbf255</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/views/root.py</FILE>
        <FILE>awx/main/analytics/collectors.py</FILE>
        <FILE>awx/main/analytics/metrics.py</FILE>
        <FILE>awx/main/utils/common.py</FILE>
        <FILE>awx/ui_next/src/components/About/About.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.test.jsx</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9697 from ryanpetrello/ansible-version remove ansible_version from the API config and metrics endpoints AWX no longer includes Ansible on the control plane and there is no &quot;global&quot; version of Ansible aside from what's configured at the Execution Environment level see: #9472 Reviewed-by: Ryan Petrello &lt;None&gt; Reviewed-by: Ladislav Smola &lt;lsmola@redhat.com&gt; Reviewed-by: Yanis Guenane &lt;None&gt; Reviewed-by: Bianca Henderson &lt;beeankha@gmail.com&gt; Reviewed-by: Jake McDermott &lt;yo@jakemcdermott.me&gt;</MESSAGE>
      <SHA>6aff5d9b5a1d8f882bf6660f07a6cbc5bc0e98e1</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/views/root.py</FILE>
        <FILE>awx/main/analytics/collectors.py</FILE>
        <FILE>awx/main/analytics/metrics.py</FILE>
        <FILE>awx/main/utils/common.py</FILE>
        <FILE>awx/ui_next/src/components/About/About.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.jsx</FILE>
        <FILE>awx/ui_next/src/components/AppContainer/AppContainer.test.jsx</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
