<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6517</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/6517</ISSUEURL>
  <TITLE>Slack integration fails with invalid_auth for notifications</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Bug Report ##### SUMMARY Slack integration fails with invalid_auth for notifications. ##### ENVIRONMENT * AWX version: 9.3.0 * AWX install method: docker on linux * Ansible version: 2.9.5 * Operating System: Ubuntu 18.04.4 * Web Browser: Google Chrome ##### STEPS TO REPRODUCE Slack credentials created by adding new configuration to the &quot;Incoming WebHooks&quot; Slack App. Verified that these work by posting to channel with Curl. Create a new notification of type Slack. Add token (xxx/xxxxx/xxxxxxx format) and destination channel. Save and click on test bell. ##### EXPECTED RESULTS Message posted to the Slack channel specified. ##### ACTUAL RESULTS Error message in GUI: &gt; Slack notifications: Norification failed. &gt; Slack Notification unable to send drift: Tower Notification Test 2 https://someserver.somedomain.com (invalid_auth) ##### ADDITIONAL INFORMATION Log output below. ``` 2020-04-01 09:21:36,106 DEBUG awx.main.notifications.slack_backend {'ok': False, 'error': 'invalid_auth', 'headers': {'Content-Type': 'application/json; charset=utf-8', 'Content-Length': '55', 'Connection': 'keep-alive', 'Date': 'Wed, 01 Apr 2020 09:21:36 GMT', 'Server': 'Apache', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'Access-Control-Allow-Headers': 'slack-route, x-slack-version-ts, x-b3-traceid, x-b3-spanid, x-b3-parentspanid, x-b3-sampled, x-b3-flags', 'Referrer-Policy': 'no-referrer', 'X-Slack-Backend': 'h', 'Access-Control-Expose-Headers': 'x-slack-req-id, retry-after', 'Vary': 'Accept-Encoding', 'X-Content-Type-Options': 'nosniff', 'X-Slack-Req-Id': 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX', 'X-XSS-Protection': '0', 'Content-Encoding': 'gzip', 'Access-Control-Allow-Origin': '*', 'X-Via': 'haproxy-www-cy4d', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 bcd5dadccb0831729969c938747ff79a.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'OSL50-C1', 'X-Amz-Cf-Id': 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'}} 2020-04-01 09:21:36,107 ERROR awx.main.notifications.slack_backend Exception sending messages: Slack Notification unable to send drift: Tower Notification Test 2 https://someserver.somedomain.com (invalid_auth) 2020-04-01 09:21:36,109 ERROR awx.main.tasks Send Notification Failed Slack Notification unable to send drift: Tower Notification Test 2 https://someserver.somedomain.com (invalid_auth) Traceback (most recent call last): File &quot;/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py&quot;, line 324, in send_notifications sent = notification.notification_template.send(notification.subject, notification.body) File &quot;/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/notifications.py&quot;, line 196, in send return backend_obj.send_messages([notification_obj]) File &quot;/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/notifications/slack_backend.py&quot;, line 56, in send_messages raise RuntimeError(&quot;Slack Notification unable to send {}: {} ({})&quot;.format(r, m.subject, ret['error'])) RuntimeError: Slack Notification unable to send drift: Tower Notification Test 2 https://someserver.somedomain.com (invalid_auth) ```</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>5</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Cleaning SOS report passwords (#14557) (#6511) Co-authored-by: Steffen Scheib &lt;92300342+sscheib-rh@users.noreply.github.com&gt;</MESSAGE>
    <SHA>176bc5c15f7f959d62b8f1f5c1a75c09005f6749</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Update receptor-collection version to 2.0.2 (#14613) (#6517)</MESSAGE>
      <SHA>678c014eb56e7981a47cd6e5b080927e44af959c</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/templates/instance_install_bundle/requirements.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
