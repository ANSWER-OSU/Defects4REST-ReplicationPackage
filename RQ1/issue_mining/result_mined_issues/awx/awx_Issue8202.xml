<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>8202</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/8202</ISSUEURL>
  <TITLE>Launching job with vault password 400s when default machine cred is replaced</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Bug Report ##### SUMMARY Really odd behavior that I came across while building out credential prompting in the new UI. This can be reproduced via the API browser though. I created a JT with a default machine credential (that prompted for some passwords) and a default vault credential (that prompted for password). If I swap the machine credential for one that does not prompt for a password then the API responds with a 400 on launch complaining about the vault password: `{&quot;passwords_needed_to_start&quot;:[&quot;vault_password.A&quot;]}` In the example below credential with ID = 1 is the machine credential that prompts for ssh and become passwords. Credential ID = 2 is the machine credential that does not prompt for passwords. Credential ID = 4 is the vault credential that prompts for password. A normal launch without changing credentials: ![good_launch](https://user-images.githubusercontent.com/9889020/93922608-26ad8000-fce0-11ea-8b61-8604ec329d83.gif) A launch where I change the machine credential: ![bad_launch](https://user-images.githubusercontent.com/9889020/93922684-493f9900-fce0-11ea-93a5-891b46041a13.gif)</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>9</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #8224 from tchellomello/import_db Ability to import standard pgdump into Openshift Reviewed-by: https://github.com/apps/softwarefactory-project-zuul</MESSAGE>
    <SHA>d6201d9eb6369e9cd9cb7022e2cce2bc5dd20c7e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix a bug that can break password prompting in certain scenarios see: https://github.com/ansible/awx/issues/8202</MESSAGE>
      <SHA>7619be10db403fd0832095238952350a2faea569</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/serializers.py</FILE>
        <FILE>awx/main/tests/functional/api/test_job_runtime_params.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix a bug that can break password prompting in certain scenarios see: https://github.com/ansible/awx/issues/8202</MESSAGE>
      <SHA>c52054951dbb54909dc0a24545df10103117ddd4</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/serializers.py</FILE>
        <FILE>awx/main/tests/functional/api/test_job_runtime_params.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix a bug that can break password prompting in certain scenarios see: https://github.com/ansible/awx/issues/8202</MESSAGE>
      <SHA>d8fb37ea2898d7734b4675f559a3065c21a1c68f</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/serializers.py</FILE>
        <FILE>awx/main/tests/functional/api/test_job_runtime_params.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
