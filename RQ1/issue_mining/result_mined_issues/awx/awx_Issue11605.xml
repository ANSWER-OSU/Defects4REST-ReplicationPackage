<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>11605</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/11605</ISSUEURL>
  <TITLE>preserve_existing_hosts flag in awx.awx.group module, while adding a new host to inventory group, retains only 25 existing hosts</TITLE>
  <DESCRIPTION>### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Summary I have an inventory group with minimum 26 host. When adding a new host to that group, one of the already present host gets discarded from group. That's because get_endpoint method from ControllerAPIModule, used in group.py module returns pages containing 25 results. In my opinion, group.py should use get_all_endpoint instead to retrieve all group's hosts to preserve. ### AWX version 19.5.1 ### Installation method minikube ### Modifications no ### Ansible version 2.9.20 ### Operating system RHEL 8 ### Web browser _No response_ ### Steps to reproduce Create an Inventory 'I' Create a Group 'G' Create 26 hosts an assign to group 'G' Run a playbook on local to add new host: ``` - name: Add host to group hosts: localhost gather_facts: no connection: local vars_files: - vars/secrets.yml - vars/defaults.yml tasks: - awx.awx.host: name: &quot;{{ 'testhost%02d' | format(item) }}&quot; inventory: Test_Inventory tower_host: &quot;{{ tower_cli_host }}&quot; tower_oauthtoken: &quot;{{ tower_oauth_token }}&quot; state: present loop: &quot;{{ range(0, 27, 1)|list }}&quot; - awx.awx.group: name: &quot;G&quot; inventory: Test_Inventory tower_host: &quot;{{ tower_cli_host }}&quot; tower_oauthtoken: &quot;{{ tower_oauth_token }}&quot; validate_certs: true state: present - awx.awx.group: name: &quot;G&quot; hosts: &quot;{{ 'testhost%02d' | format(item) }}&quot; inventory: Test_Inventory tower_host: &quot;{{ tower_cli_host }}&quot; tower_oauthtoken: &quot;{{ tower_oauth_token }}&quot; validate_certs: true state: present preserve_existing_hosts: true loop: &quot;{{ range(0, 27, 1)|list }}&quot; ``` ### Expected results Group 'G' contains 27 hosts ### Actual results Group 'G' contains 26 hosts ### Additional information No error</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>225</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #12785 from jangel97/devel Fix list_instances command * Change from modified to last seen</MESSAGE>
    <SHA>e7c97923a305ffeb2bd06de84fcc8e69e164d589</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #12724 from mtward/issue-11605 Fix: preserve_existing_hosts flag in awx.awx.group module, while adding a new host to inventory group, retains only 25 existing hosts related #11605</MESSAGE>
      <SHA>cea8c16064348e2300f7a9d3a1c25f2adcce4812</SHA>
      <PATCHEDFILES>
        <FILE>awx_collection/plugins/modules/group.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
