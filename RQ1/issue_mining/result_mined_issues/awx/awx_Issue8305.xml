<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>8305</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/8305</ISSUEURL>
  <TITLE>500 error when attempting to delete workflow approval</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Bug Report ##### SUMMARY ![delete_wf_approval](https://user-images.githubusercontent.com/9889020/94853438-67e91280-03f9-11eb-9233-63c15e611f70.gif) I haven't tried this with a pending workflow approval but I suspect it would yield the same result. We don't have an interface that interacts with this endpoint in the UI so maybe this has been around for a while? I'm exploring adding an interface for listing out _all_ workflow approvals so that a user could go back and see who approved/denied what in the past. This interface will support deletion if the API allows it. ##### STEPS TO REPRODUCE 1) Create a workflow with an approval step 2) Launch workflow 3) Approve step 4) Attempt to delete workflow approval via API ##### EXPECTED RESULTS Successful delete ##### ACTUAL RESULTS 500 error ``` Request Method: | DELETE -- | -- https://localhost:8043/api/v2/workflow_approvals/3/ 2.2.16 AttributeError 'NoneType' object has no attribute 'objects' ./awx/main/models/unified_jobs.py in get_event_queryset, line 994 /venv/awx/bin/uwsgi 3.6.8 ['/venv/awx/lib/python3.6/site-packages/git/ext/gitdb', '.', '', '/venv/awx/lib64/python36.zip', '/venv/awx/lib64/python3.6', '/venv/awx/lib64/python3.6/lib-dynload', '/usr/lib64/python3.6', '/usr/lib/python3.6', '/venv/awx/lib/python3.6/site-packages', '/venv/awx/lib/python3.6/site-packages/gitdb/ext/smmap'] Thu, 1 Oct 2020 19:17:11 +0000 ```</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #8299 from jakemcdermott/fix-8154 Force logout and clear before social auth login Reviewed-by: Jake McDermott &lt;yo@jakemcdermott.me&gt; https://github.com/jakemcdermott</MESSAGE>
    <SHA>796a61da864f20ee3563578680ca4b8ae6500ee2</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix a bug that prevents deletion of workflow approval records see: https://github.com/ansible/awx/issues/8305</MESSAGE>
      <SHA>64485c1066f61248f2080567a7d982b7aada10d9</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/models/workflow.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
