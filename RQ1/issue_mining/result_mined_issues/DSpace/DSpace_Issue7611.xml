<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>7611</ISSUENO>
  <ISSUEURL>https://github.com/DSpace/DSpace/issues/7611</ISSUEURL>
  <TITLE>[DS-4271] Discovery &quot;contains&quot; filter does not perform a phrase query</TITLE>
  <DESCRIPTION>&lt;i&gt;Imported from JIRA &lt;a href=&quot;https://jira.lyrasis.org/browse/DS-4271&quot;&gt;[DS-4271]&lt;/a&gt; created by cwilper&lt;/i&gt; &lt;p&gt;When doing a &quot;contains&quot; filter query, if the value entered for the field contains spaces, the behavior is to return documents where the individual words are present in any order the field.&lt;/p&gt; &lt;p&gt;A typical user would expect &quot;contains&quot; to do a phrase query, where the entire phrase occurs somewhere in the field's value.&lt;/p&gt; &lt;p&gt;This is a long-standing issue that stems from the following line in SolrServiceImpl, which has remained untouched since the original Discovery implementation, and is present in versions 4.x through 7.0 Preview 1:&lt;/p&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-api/src/main/java/org/dspace/discovery/SolrServiceImpl.java#L2110&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-api/src/main/java/org/dspace/discovery/SolrServiceImpl.java#L2110&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Notice how it surrounds the text sent to solr with &quot;(&quot; and &quot;)&quot;. &lt;em&gt;This has specific meaning in solr, which differs from surrounding the text with double quotes.&lt;/em&gt; Surrounding with double quotes would have the expected effect of doing a phrase query. Surrounding with parentheses is equivalent to entering multiple fielded search tearms, one for each word. For example, a the solr query:&lt;/p&gt; &lt;p&gt;&lt;tt&gt;title:(introduction to dspace)&lt;/tt&gt;&lt;/p&gt; &lt;p&gt;...is the same as the solr query:&lt;/p&gt; &lt;p&gt;&lt;tt&gt;title:introduction title:to title:dspace&lt;/tt&gt;&lt;/p&gt; &lt;p&gt;...which is not the expected effect.&lt;/p&gt; &lt;p&gt;The solution, which we have tested, is to replace the surrounding parentheses in the code referenced above, with double quotes.&lt;/p&gt;</DESCRIPTION>
  <REPONAME>DSpace</REPONAME>
  <TIMEDIFFERENCEDAYS>1060</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #8259 from tdonohue/update_outdated_dependencies Remove Google Gson, replacing with Jackson Databind. Upgrade Jackson Databind</MESSAGE>
    <SHA>a235551fabbb7e0b34b877e73704e8941a510cae</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>dspace-api: Replace brackets with double quotes in SolrServiceImpl Port of GitHub PR #2543 from DSpace 6.x to DSpace 7.x, originally by @jonas-atmire. Resolves DS-4271 (GitHub Issue #7611).</MESSAGE>
      <SHA>a585b16b1abb46e7b985692c985f16b1046309a8</SHA>
      <PATCHEDFILES>
        <FILE>dspace-api/src/main/java/org/dspace/discovery/SolrServiceImpl.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
