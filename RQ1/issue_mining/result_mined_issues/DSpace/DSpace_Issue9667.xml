<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>9667</ISSUENO>
  <ISSUEURL>https://github.com/DSpace/DSpace/issues/9667</ISSUEURL>
  <TITLE>Request-a-copy link has subpath stripped from dspace.ui.url</TITLE>
  <DESCRIPTION>In a dspace instance configured to run at a subpath, that subpath is stripped when request-a-copy link is generated here: https://github.com/DSpace/DSpace/blob/87f66fbc55cf2b8f8e265d74ce2c902ac2ee7e26/dspace-server-webapp/src/main/java/org/dspace/app/rest/repository/RequestItemRepository.java#L300 URIBuilder.setPathSegments removes any exiting path segments from the base url before adding the new segments.</DESCRIPTION>
  <REPONAME>DSpace</REPONAME>
  <TIMEDIFFERENCEDAYS>71</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #9639 from 4Science/task/main/DURACOM-265_CC-licence-step-does-not-work [ #2161] Provide a way to require Creative Commons license in submission form</MESSAGE>
    <SHA>658b452959907bbd0ff063d2e965e46d8a6b1f64</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #9668 from kshepherd/request_copy_link_generation Fix for DSpace#9667: Request-a-copy link generation for base URLs that have sub-paths</MESSAGE>
      <SHA>d4f6cd6bb44946186813db0b0a77774f32827461</SHA>
      <PATCHEDFILES>
        <FILE>dspace-server-webapp/src/main/java/org/dspace/app/rest/repository/RequestItemRepository.java</FILE>
        <FILE>dspace-server-webapp/src/test/java/org/dspace/app/rest/RequestItemRepositoryIT.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9800 from DSpace/backport-9668-to-dspace-8_x [Port dspace-8_x] Fix for DSpace#9667: Request-a-copy link generation for base URLs that have sub-paths</MESSAGE>
      <SHA>a2c9576691a5a2067357022c7b79d083e973a08b</SHA>
      <PATCHEDFILES>
        <FILE>dspace-server-webapp/src/main/java/org/dspace/app/rest/repository/RequestItemRepository.java</FILE>
        <FILE>dspace-server-webapp/src/test/java/org/dspace/app/rest/RequestItemRepositoryIT.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9801 from tdonohue/port_9668_to_7x [Port dspace-7_x] Fix for DSpace#9667: Request-a-copy link generation for base URLs that have sub-paths</MESSAGE>
      <SHA>b6209e0a95cd401cbebf1c47c046fedd6708b336</SHA>
      <PATCHEDFILES>
        <FILE>dspace-server-webapp/src/main/java/org/dspace/app/rest/repository/RequestItemRepository.java</FILE>
        <FILE>dspace-server-webapp/src/test/java/org/dspace/app/rest/RequestItemRepositoryIT.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
