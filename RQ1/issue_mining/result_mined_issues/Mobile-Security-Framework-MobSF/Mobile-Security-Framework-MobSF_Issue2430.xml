<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2430</ISSUENO>
  <ISSUEURL>https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2430</ISSUEURL>
  <TITLE>[FEATURE] Native Postgres Support for docker image</TITLE>
  <DESCRIPTION>As a mobsf user I want to run the latest version of mobsf with the least support needed on my side to always be up to date. I also want to have it use postgres without having to clone and build image. In addition to that it could be extended to add other database support like Mysql... ### Solution 1 make 2 tags on publish 1 for sqlite support and 1 for postgres (so each version would have two image on docker hub) for example in docker latest workflow: ```YML - name: Build and push AMD64, ARM64 images id: docker_build uses: docker/build-push-action@v5 with: push: true context: . build-args: | POSTGRES = True # Add this platforms: linux/amd64,linux/arm64 tags: opensecurity/mobile-security-framework-mobsf:postgres-latest ``` ### Solution 2 make it dynamic at runtime by checking what environement variables are defined in `settings.py`: ```PYTHON if 'POSTGRES_HOST' in os.environ: # Could use a POSTGRES True/False variable too logger.info('Using Postgres as backend DB') default = { 'ENGINE': 'django.db.backends.postgresql_psycopg2', 'NAME': 'mobsf', 'USER': os.environ['POSTGRES_USER'], 'PASSWORD': os.environ['POSTGRES_PASSWORD'], 'HOST': os.environ['POSTGRES_HOST'], 'PORT': 5432, } else: logger.info('Using Default Sqlite3 as backend DB') default = { 'ENGINE': 'django.db.backends.sqlite3', 'NAME': DB_DIR, }, DATABASES = { 'default': default } ``` this means getting rid of `postgres_support.sh` and add psycopg2-binary by default: ![image](https://github.com/user-attachments/assets/fc516cd9-e0d4-48f4-8b94-cf1ad0cf3be8)</DESCRIPTION>
  <REPONAME>Mobile-Security-Framework-MobSF</REPONAME>
  <TIMEDIFFERENCEDAYS>20</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>[HOTFIX] dep bups + Fix #2424</MESSAGE>
    <SHA>fec37069f36a34bfdcb845f34a40452173d72298</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[HOTFIX] Dockerfile and dependency upgrade, Bug Fixes (#2439) * Dockerfile: migrate from Ubuntu to Debian Bookworm * Update and MachO and ELF Analysis * Update docker compose with postgres * JDK bump to 22.0.2 * Python bump to 3.12 * Bump jadx, apktool, vd2svg, bundletool * Remove jadx from repo and download it dynamically during setup * Install jadx during docker build * Replace deprecated dependencies * Bump httptools * Postgres Support by default * Bump LIEF to latest, reintroduce PIE checks for ELF * Fixes #2430 #2432 #2395 * Bug Fixes</MESSAGE>
      <SHA>9b2a3c855260d01cfe1f6735c06838ee5dc8c001</SHA>
      <PATCHEDFILES>
        <FILE>.github/workflows/mobsf-test.yml</FILE>
        <FILE>.github/workflows/python-publish.yml</FILE>
        <FILE>Dockerfile</FILE>
        <FILE>README.md</FILE>
        <FILE>docker-compose.yml</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/webproxy.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/analysis.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/tests_frida.py</FILE>
        <FILE>mobsf/MobSF/init.py</FILE>
        <FILE>mobsf/MobSF/security.py</FILE>
        <FILE>mobsf/MobSF/settings.py</FILE>
        <FILE>mobsf/MobSF/tools_download.py</FILE>
        <FILE>mobsf/MobSF/utils.py</FILE>
        <FILE>mobsf/MobSF/views/authentication.py</FILE>
        <FILE>mobsf/MobSF/views/home.py</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/apktool_2.10.0.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/bundletool-all-1.17.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/LICENSE</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/NOTICE</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/README.md</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/bin/jadx</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/bin/jadx-gui</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/bin/jadx-gui.bat</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/bin/jadx.bat</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/ST4-4.0.8.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/aapt2-proto-7.3.1-8691043.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/activation-1.1.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/antlr-2.7.7.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/antlr-3.5.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/antlr-runtime-3.5.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/apksig-7.3.1.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/asm-9.4.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/baksmali-2.5.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/checker-qual-3.8.0.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/commons-lang3-3.12.0.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/commons-text-1.10.0.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/dalvik-dx-11.0.0_r3.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/dexlib2-2.5.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/error_prone_annotations-2.5.1.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/failureaccess-1.0.1.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/flatlaf-2.6.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/flatlaf-extras-2.6.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/flatlaf-intellij-themes-2.6.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/gson-2.9.1.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/guava-30.1.1-jre.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/image-viewer-1.2.3.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/j2objc-annotations-1.3.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-cli-1.4.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-core-1.4.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-dex-input-1.4.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-gui-1.4.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-java-convert-1.4.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-java-input-1.4.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-plugins-api-1.4.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-smali-input-1.4.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/javax.mail-1.6.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jcommander-1.82.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jdwp-2.0.0.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jfontchooser-1.0.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jsr305-3.0.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/logback-classic-1.3.4.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/logback-core-1.3.4.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/mapping-io-0.4.0-SNAPSHOT.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/protobuf-java-3.21.8.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/r8-3.3.75.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/raung-common-0.0.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/raung-disasm-0.0.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/reactive-streams-1.0.3.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/rsyntaxtextarea-3.3.0.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/rxjava-2.2.21.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/rxjava2-swing-0.3.7.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/slf4j-api-2.0.3.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/smali-2.5.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/stringtemplate-3.2.1.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/svgSalamander-1.1.4.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/util-2.5.2.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/vd2svg-0.4.4.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/converter.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/icon_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/jar_aar.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/manifest_utils.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/static_analyzer.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/xapk.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/binary/elf.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/binary/macho.py</FILE>
        <FILE>mobsf/templates/pdf/android_report.html</FILE>
        <FILE>mobsf/templates/static_analysis/android_binary_analysis.html</FILE>
        <FILE>poetry.lock</FILE>
        <FILE>pyproject.toml</FILE>
        <FILE>scripts/clean.bat</FILE>
        <FILE>scripts/dependencies.sh</FILE>
        <FILE>scripts/postgres_support.sh</FILE>
        <FILE>setup.bat</FILE>
        <FILE>setup.sh</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
