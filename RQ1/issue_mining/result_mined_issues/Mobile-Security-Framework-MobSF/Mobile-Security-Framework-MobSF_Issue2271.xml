<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2271</ISSUENO>
  <ISSUEURL>https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2271</ISSUEURL>
  <TITLE>Dynamic Analyzer &gt; Pull &amp; Static Analysis fails with split apks</TITLE>
  <DESCRIPTION>## ENVIRONMENT ``` OS and Version: Kali Linux, 6.5.0-kali1-amd64 Distributor ID: Kali Description: Kali GNU/Linux Rolling Release: 2023.3 Codename: kali-rolling Python Version: Python 3.9.16 MobSF Version: MobSF v3.7.8 Beta ``` ## EXPLANATION OF THE ISSUE The &quot;Pull &amp; Static Analysis&quot; button fails to pull an app with split apks. MobSF seems to be running `adb pm path com.coinhako` and then running `adb pull &lt;result&gt;` which improperly parses out the multiline return value: ![image](https://github.com/MobSF/Mobile-Security-Framework-MobSF/assets/65432843/bbb7e00b-3255-4c57-883c-7845ee07fcfa) ![image](https://github.com/MobSF/Mobile-Security-Framework-MobSF/assets/65432843/19b24187-9a3d-4868-8621-493509e82491) ## STEPS TO REPRODUCE THE ISSUE 1. Start Mobsf: `sudo docker run --network=&quot;host&quot; -it --rm -p 8000:8000 -p 1337:1337 -e MOBSF_ANALYZER_IDENTIFIER=&quot;emulator-5554&quot; -e MOBSF_PLATFORM=&quot;somethingelse&quot; opensecurity/mobile-security-framework-mobsf:latest` 2. Navigate to Dynamic Analyzer tab 3. Click Pull &amp; Static Analysis button ## LOG FILE For some reason, both debug files in ~/.MobSF and /root/.MobSF (since i'm using sudo) are empty... I couldn't upload the apk(s), files were too large: https://play.google.com/store/apps/details?id=com.coinhako&amp;hl=en_US&amp;gl=US &lt;!-- BEFORE POSTING YOUR ISSUE/BUG - These comments won't show up when you submit the issue. - GitHub issues ARE NOT FOR FEATURE REQUESTS, SUPPORT, DISCUSSIONS AND QUESTIONS! - If you have questions, use our slack channel. Join MobSF Slack channel: https://bit.ly/3mCMNOx - Reproduce issue in the latest master and try to add as much detail as possible. - Search this repository (top of the page) for the issue and it has not been fixed or reported already. - Once you open a bug, you should also provide additional information if requested. - Failure to do so in 25 days will result in closure of the bug without further communication. --&gt;</DESCRIPTION>
  <REPONAME>Mobile-Security-Framework-MobSF</REPONAME>
  <TIMEDIFFERENCEDAYS>405</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>4.1.5 (#2445) * Support custom home from environment variables * Reduce iOS binary findings severity to warning from high * Code QA and dependency updates * docker-compose QA, added example nginx config * Added docker-compose_swarm.yml by @antonkap add support for docker secrets * IPA PNG Uncrush support for Windows and Linux #2397</MESSAGE>
    <SHA>e5af3a8219e2a7b4078fab6a3b5d5a66900e7cf1</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add support for pulling split apks, Fixes #2271</MESSAGE>
      <SHA>14d48df0c3b9c26401488c01a458af1ff0bca62e</SHA>
      <PATCHEDFILES>
        <FILE>mobsf/DynamicAnalyzer/views/android/dynamic_analyzer.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/environment.py</FILE>
        <FILE>mobsf/MobSF/init.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/xapk.py</FILE>
        <FILE>pyproject.toml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add support for pulling split apks, Fixes #2271 (#2446) * Add support for pulling split apks from device, Fixes #2271 * Replace Quark with Behaviour analysis using quark rules</MESSAGE>
      <SHA>ee2cb738247e50442650fd293fe91292bed13aa7</SHA>
      <PATCHEDFILES>
        <FILE>mobsf/DynamicAnalyzer/views/android/dynamic_analyzer.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/environment.py</FILE>
        <FILE>mobsf/MalwareAnalyzer/views/android/behaviour_analysis.py</FILE>
        <FILE>mobsf/MalwareAnalyzer/views/android/quark.py</FILE>
        <FILE>mobsf/MalwareAnalyzer/views/android/rules/behaviour_rules.yaml</FILE>
        <FILE>mobsf/MobSF/init.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/code_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/db_interaction.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/jar_aar.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/so.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/static_analyzer.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/xapk.py</FILE>
        <FILE>mobsf/templates/pdf/android_report.html</FILE>
        <FILE>mobsf/templates/static_analysis/android_binary_analysis.html</FILE>
        <FILE>mobsf/templates/static_analysis/android_source_analysis.html</FILE>
        <FILE>pyproject.toml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
