<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2349</ISSUENO>
  <ISSUEURL>https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2349</ISSUEURL>
  <TITLE>Tests failing for Binskim and Binscope in StaticAnalysis</TITLE>
  <DESCRIPTION>&lt;!-- ## IMPORTANT --&gt; &lt;!-- Issues are ONLY for reporting BUGS. For support, feature requests, questions, queries, and discussions use our slack channel for limited support. Join MobSF Slack channel: https://join.slack.com/t/mobsf/shared_invite/zt-153nfus2r-hMCGrwzm8Lyy3OxsihnolQ --&gt; &lt;!-- If you see errors while running setup/run scripts, it is mostly because you haven't installed the required dependencies correctly. You will have to look into the errors and figure out what is causing them and solve them accordingly. Make sure you have installed all the required dependencies and their correct versions as per the latest documentation. If you still find yourself at a dead end, join MobSF Slack channel:https://join.slack.com/t/mobsf/shared_invite/zt-153nfus2r-hMCGrwzm8Lyy3OxsihnolQ Please do not post support/help request in GitHub issues, doing so will definitely waste our time get them closed without further response. --&gt; ## ENVIRONMENT ``` OS and Version: Windows 10 Python Version: Python 3.11.4 MobSF Version: v3.9.4 ``` ## EXPLANATION OF THE ISSUE Binskim and Binscope arguments are being passed to [subprocess_hook](https://github.com/MobSF/Mobile-Security-Framework-MobSF/blob/f20ee08a68de14fdfc91dc7caf2b166b010558c2/mobsf/MobSF/security.py#L138) from [windows.py binskim function](https://github.com/MobSF/Mobile-Security-Framework-MobSF/blob/f20ee08a68de14fdfc91dc7caf2b166b010558c2/mobsf/StaticAnalyzer/views/windows/windows.py#L301) and [windows.py binscope function](https://github.com/MobSF/Mobile-Security-Framework-MobSF/blob/f20ee08a68de14fdfc91dc7caf2b166b010558c2/mobsf/StaticAnalyzer/views/windows/windows.py#L470) as a tuple with string inside it, instead of a tuple containing list. In result it throws an TypeError when trying to parse executable name from params. ``` Args in subprocess hook currently: ('\\MobSF\\Tools\\Microsoft.CodeAnalysis.BinSkim.1.7.2\\tools\\netcoreapp3.1\\win-x64\\BinSkim.exe analyze \\.MobSF\\uploads/8179b557433835827a70510584f3143e/AppStudio.exe --verbose -o \\.MobSF\\uploads/8179b557433835827a70510584f3143e/AppStudio.exe_binskim --config default --force',) Should be: (['\\MobSF\\Tools\\Microsoft.CodeAnalysis.BinSkim.1.7.2\\tools\\netcoreapp3.1\\win-x64\\BinSkim.exe', 'analyze', '\\.MobSF\\uploads/8179b557433835827a70510584f3143e/AppStudio.exe', '--verbose', '-o', '\\.MobSF\\uploads/8179b557433835827a70510584f3143e/AppStudio.exe_binskim', '--config', 'default', '--force'],) ``` I think the problem is the use of subprocess.list2cmdline function in mentioned lines [here](https://github.com/MobSF/Mobile-Security-Framework-MobSF/blob/f20ee08a68de14fdfc91dc7caf2b166b010558c2/mobsf/StaticAnalyzer/views/windows/windows.py#L301) and [here](https://github.com/MobSF/Mobile-Security-Framework-MobSF/blob/f20ee08a68de14fdfc91dc7caf2b166b010558c2/mobsf/StaticAnalyzer/views/windows/windows.py#L470), because without it everything seemed to work correctly</DESCRIPTION>
  <REPONAME>Mobile-Security-Framework-MobSF</REPONAME>
  <TIMEDIFFERENCEDAYS>17</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Error 500 for non administrators when viewing recent scans (#197) * Adding cyberspect_scans table * Fix for health check sometimes requiring auth * Lint fix * Reording to fix slice error * Lint fix --------- Co-authored-by: Brice Williams &lt;brice@cyberspect.com&gt;</MESSAGE>
    <SHA>e133ac2b1d42a473b6e366efcef9b036a45ec7a7</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>MobSF platform update, merge 3.9.7 (#199) * HOTFIX: EFR01 Enterprise feature request (#1908) * Replace Warning with Medium and added Hotspot * Add file analysis to hotspot * Enterprise Feature Request Flag * EFR01 changes * version bump * update quark &amp; frida (#1903) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update tldextract from 3.1.2 to 3.2.0 (#1910) * upgrade apktool to 2.6.1 (#1915) * Hotfix: Update slack link * Hotfix: update slack link * Hotfix: Slack link * Hotfix:Slack link * Hotfix:Slack link * Introduce jadx decompilation timeout with env var (#1916) * Introduce jadx decompilation timeout with env var - exception for timeout - replace subprocess.call for run Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update ip2location from 8.6.4 to 8.7.2 (#1926) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Scheduled weekly dependency update for week 13 (#1931) * Update quark-engine from 22.2.1 to 22.3.1 * update lief Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * update apkid (#1939) * Fix dynamic report_json api bug (#1934) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Hotfix: LIEF * Update README.md (#1951) * update jadx to 1.3.4 (#1941) * update jadx to 1.3.4 * update lief * update jadx and requirements * Scheduled weekly dependency update for week 22 (#1972) * Update ip2location from 8.7.3 to 8.7.4 * Update quark-engine from 22.4.1 to 22.5.1 * Update frida from 15.1.17 to 15.1.23 * Update tldextract from 3.2.1 to 3.3.0 * Check for updates via GitHub releases (#1957) * Check the GitHub releases page for latest version number * Update utils.py Only log distro if not empty (or spaces) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update cert_analysis.py (#1948) * Update cert_analysis.py Flag on MD5 hash algorithm in signer certificate * Update cert_analysis.py Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: Update Readme with Rewards Banner * Update frida from 15.1.23 to 15.1.24 (#1975) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: openSSL link and readme update * Hotfix: Broken slack channel link fix * Hotfix: Windows setup script * Feature Parity Allow iOS IPA download (#1977) * Allow iOS IPA download * Code QA * Add the checking of the parent element of the permission-related elements to manifest analysis (#1905) * Add the checking of the parent element of the permission-related elements to manifest analysis Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Remove RELRO (#1978) * Revert &quot;Add the checking of the parent element of the permission-related elements to manifest analysis (#1905)&quot; (#1984) HOTFIX: Revert #1905 * Scheduled weekly dependency update for week 26 (#1986) * Update ip2location from 8.7.4 to 8.8.0 * Update frida from 15.1.24 to 15.1.27 * Update quark-engine from 22.5.1 to 22.6.1 (#1989) * Scheduled weekly dependency update for week 28 (#1993) * Update frida from 15.1.27 to 15.1.28 * Update tldextract from 3.3.0 to 3.3.1 * HOTFIX: libsast, iOS Rule, M1 Mac support * Hotfix #1999 * Update frida from 15.1.28 to 15.2.2 (#2002) * Update README.md (#2020) add Badge App * Fix bug #1917 where checking for stripped debugging symbols produces false positives in iOS. (#2023) Co-authored-by: Toor &lt;toor@DES-macOS-pentest.local&gt; Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update ip2location from 8.8.0 to 8.8.1 (#2035) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * update apkid to 2.1.4 (#2037) * Adding tarfile member sanitization to extractall() (#2039) Co-authored-by: TrellixVulnTeam &lt;kasimir.schulz@trellix.com&gt; Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * fix res directory not exist (#2042) Fix the problem that the res resource folder does not exist, the solution is to copy from the apktool_out directory * [EFR-02]Enterprise Feature Request - False Positive Triaging (#2000) * Suppression logic * Android code analysis suppression * Fixes #1981 * iOS source support bundle id extraction * iOS Source Code - Suppression support * Remove check in CFBundleURLName * iOS Binary code analysis suppression support * Add Code QL * Suppression support for Manifest analysis * Fixes #2014 * REST API + Docs * Address review comments * update suppression wordings * Fixes #2043 * Icon analysis code QA * Unit Test for False Positive Triaging * Adding numeric_owner as a keyword argument (#2050) numeric_owner needs to be a keyword argument. * Scheduled weekly dependency update for week 41 (#2046) * Update quark-engine from 22.6.1 to 22.9.1 * Update frida from 15.2.2 to 16.0.1 * Update tldextract from 3.3.1 to 3.4.0 * Update openstep-parser from 1.5.3 to 1.5.4 Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: revert frida to 15.X * HOTFIX: UI changes and warning on mobsf.live (#2051) * UI changes and warning on mobsf.live * Update home.html * HOTFIX: Split certificate analysis out, suppression list fixes (#2052) * Hotfix: ui on donate page * Hotfix: Homescreen Navbar * Hotfix: UI icon * hotfix for quyark rules location (#2053) * HOTFIX: jadx update to 1.4.5 (#2064) * jadx update to 1.4.5 * MobSF version bump * Fixes CVE-2022-42889 in third party dependency * Installation script error: Solving spelling error (#2067) changed &quot;installtion&quot; to &quot;installation&quot; * Android APK support extracting icon SVG from XML (#2060) * Added support for SVG icon extraction * Add jar binaries * code refactoring * Update settings.py * HOTFIX: Setup improvement (#2078) * Improve setup scripts. * Python support to 3.8 - 3.10 * Delete MobSF data directory on running setup. * Bump applicable dependencies. * Apktool 2.7.0 update (#2082) * Update apktool to version 2.7.0 * HOTFIX: Icon should be a file * version bump * New Android Manifest Rule: App support vulnerable android versions (#2114) * add a new rule: dangerous os version * qa * lint checks * run lint test on one os * Support for filenames containing &amp; (#2129) Co-authored-by: none &lt;none@none.com&gt; * HOTFIX: Fix docker build (#2135) * Fix Scorecard Severity Distribution chart data (#2140) * HOTIX: Update Dockerfile to install jq (#2149) * Update Dockerfile * Update tox.ini * [HOTFIX] Add support for environment variable for MobSF config (#2150) * add support for environment variable config * Fixes #2109 * update lief * HOTFIX: Fixes #2144 * HOTFIX: Android min SDK check on janus vulnerability detection (#2159) * Android min SDK check on janus check * Update README.md * [Enterprise Feature Request EFR02] Support summary of severity in each section. (#2160) * Summary for Android and iOS SCA * [EFR05] Enterprise Feature Request: AAR and JAR support (#2163) * AAR and JAR support * Enable binary analysis for aar/jar * Scheduled weekly dependency update for week 24 (#2187) * Update ip2location from 8.9.0 to 8.10.0 * Update quark-engine from 22.10.1 to 23.5.1 * Update LIEF from to 0.13.1 * Update tldextract from 3.4.0 to 3.4.4 * Update requirements.txt --------- Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update requirements.txt 0.13.1 not available. * HOTFIX: update lief * Revert Hotfix * HOTFIX: Feature updates and Bug Fixes (#2197) * OFAC, jquery bump, tox fix * AAR handle multiple application tags * HOTFIX: MobSF Android Dynamic Analysis Docker Support (#2214) * MobSF Android Docker Support * Pin pip version * Update mobsf-test.yml * Update setup.py * Hotfix: Docker error fixes * Hotfix: Add Corellium support message * Hotfix: Broken donate link fix * Update dynamic_analysis.html (#2218) * Hotfix: Handle Docker &lt;-&gt; ADB connectivity internally (#2219) * host.docker.internal transilation for localhost * Replace urlparse with re * version bump * update ascii art * update apktool to 2.8.1 (#2220) * update apktool (#2225) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: translate upstream proxy ip for docker * Dynamic Analysis support alert (#2227) * [HOTFIX] Regex + Rule Update (#2232) * IOS Swift Rules updates * Updated or added rules `ios_biometric_bool`, `ios_biometric_acl`, `ios_keychain_weak_acl_device_passcode`, `ios_keychain_weak_accessibility_value`, `ios_insecure_random_no_generator`, `ios_biometry_hardened` * Regex Hardening: Fixes possible Regex DoS in rules and MobSF code base * [HOTFIX][EFR06] Independent Shared Object (.so) Scan and Improved String search (#2228) * String extraction from APK, Source, AAR, JAR, SO * Strings sections to show source of strings extracted * Strings Refactor * Support for independent .SO scan * Android SCA rules update * Entropies scan support for strings * URLs/Email extraction refactor * Bug Fixes * iOS Source Report Fix * Frida APK Patcher (WIP) * Dynamic Analyzer identifier not available * Settings env var not working fix for enabled by default features * AppSec Score fix * Recent `scan not completed` fix for iOS zip * HOTFIX: Improve code string extraction * Update macho_analysis.py - SYMBOLS STRIPPED False Negative (#2234) * Update macho_analysis.py PR for this issue: https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2233 * Update macho_analysis.py Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: fix IPA download support * [HOTFIX][EFR-08] Dylib + Symbols + Other Features (#2239) * Dylib analysis support + PDF for iOS Binary * Dylib string extraction * Improved iOS Plist secret extraction * iOS/Android Form Validation QA * Independent Dylib scan * Symbols view for dylib and so * Trackers support for so * Fix missing exported components (#2176) Components which are exported and have no permission were not listed in the results because of a wrong template description key. Also added a warning if this happens again. Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * [HOTFIX][EFR09] AAR/JAR obfuscation and debug check + Exception Handed strings and symbols extraction (#2240) * AAR/JAR obfuscation and debug check * Exception handling symbols and strings from so/dylib * [HOTFIX][EFR10] Independent Static Library(.a) ELF/MachO Analysis + Graceful Analysis (#2242) * Independent Static Library(.a) ELF/MachO Analysis * Mac FAT binary only supported on Mac * Static and Dynamic Binary Analysis QA * Refactor Dex permissions * Fallback certificate analysis using apksigtool * Refactor Androguard `apk.APK()` usage * Pip to Poetry, Ubuntu Base image Bump, Dockerfile QA, Python 3.11 support (#2244) * Docker base image update * Docker file QA * Github Actions version update * Removed unwanted pinned repository * Pip to Poetry migration * Bump httptools * Jump yara-python-dex * Python 3.11 support * [HOTFIX] Docker Buildx test (#2247) * Docker image build test for PRs * [HOTFIX] bs4 malformed xml parsing + xml namespace detection (#2248) * Use BeautifulSoup4 to prettify malformed XML * Detect non standard XML namespace in AndroidManifest.xml (Fixes : https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2198) * Updated android permissions list * Updated android permission update check script * [HOTFIX] Migrate from setup.py to poetry, tox QA (#2249) * Migrate from setup.py to use poetry build and publish * Tox QA * Version is now configured only at pyproject.toml * Added poetry build test * Updated mobsf PyPI publishing workflow * Update local DBs * Performance Improvements on SAST (#2251) * Performance improvements in SAST scans (Code Analysis, API Analysis, NIAP etc.) with libsast bump * Android API rule QA * Manifest analysis continuation on apktool failure * Linux setup script fix * Disable NIAP by default * [HOTFIX] add apksigner.jar for reading signatures (#2254) * Add `apksigner.jar` * Use apksigner to extract signature versions (v1, v2, v3, v4) * Fix: #2120 * [HOTFIX] add jar (#2255) * Add apksigner jar * [HOTFIX] Bump Frida to address crash on M1 Mac (#2258) * Update frida to 16.1.4 to resolve segmentation faults on Docker arm image --------- Co-authored-by: Mark Sowell &lt;mark@marksowell.com&gt; * [HOTFIX] simplify scan api (#2259) * Simplify Scan API * Need only scan hash to trigger a scan * Updated API Docs * [HOTFIX] iOS Framework Analysis + Multiple Feature QA (#2260) * iOS Framework Analysis * Static Analysis URL simplification * Replace hardcoded urls in template with `{% url %}` * Code QA * Remove unwanted template file * Remove `rescan` query param from url * Android icon SVG guessing improvements * Icon analysis refactoring, change icon storage location * Remove SVG to PNG converter. Support PNG and SVG icon. * Github docker release action update * [HOTFIX] Support webp for icon (#2267) * [HOTFIX] Fixed that the icon cannot be found (#2265) fixed that the icon cannot be found when the suffix name is uppercase * Allow jpeg icons (#2268) * [HOTFIX] Fix jadx and apktool failure due to JDK changes (#2269) * Fix jadx and apktool failure due to JDK zip64 changes * [HOTFIX][EFR] Priority Bug Fixes (#2275) * P1.1 AAR Permissions not properly listed * P1.2 Local variable table not listed in proper section * P1.3 static library strings are not listed * P1.5 Stripping of dynamic and static libraries are not correctly reported * Dependency bump * MobSF version bump * Hotfix: Bump deps * update apktool to 2.9.0 (#2278) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Build(deps): Bump django from 4.1.12 to 4.1.13 (#2282) Bumps [django](https://github.com/django/django) from 4.1.12 to 4.1.13. - [Commits](https://github.com/django/django/compare/4.1.12...4.1.13) --- updated-dependencies: - dependency-name: django dependency-type: direct:production ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; Co-authored-by: dependabot[bot] &lt;49699333+dependabot[bot]@users.noreply.github.com&gt; * Hotfix: Support viewing kotlin files #2283 * iOS Dynamic Analysis with Corellium (#2194) * iOS Dynamic Analysis Support with Corellium Jailbroken iOS devices * Corellium API layer for complete device and project management * Frida instrumentation (attach, spawn and inject) over SSH local port forward * Shell access over SSH * MobSF httptools proxy integration over SSH remote port forward * Device File upload and download over SSH * Frida scripts for core defense bypass, monitoring, and tracing * Helper iOS Frida scripts for pentesting and malware analysis * Screen cast with touch, swipe and text input support from web UI * Dynamic Analysis device data dump and report Generation * Android Certificate analysis, replaced oscrypto with cryptography for public key parsing * Python minimum support is 3.10 * Bumped httptools to latest, fixes httptools repeat bug * Added unzip to docker to fix a bug * Relaxed bundleid regex * HOTFIX: Dynamic Analysis Improvements Android &amp; iOS (#2295) iOS Screencast, better swipe Android Screencast to support touch, swipe and text input events Android Frida Logs update Android Improved Screencast Android Frida spawn, inject and attach support Added new Android Frida scripts Replaced Clipdump with Frida script for clipboard monitoring * Hotfix QA (#2297) * REST API update for android frida instrument * Code QA * [HOTFIX] More Android &amp; iOS Frida Scripts (#2299) Improved existing frida scripts More Android &amp; iOS frida Scripts Code QA * [HOTFIX] Android script loading, frida injected code view, paramiko SSH issues (#2300) * Android script loading bug fix * Frida injected code view * Paramiko SSH reactor to address some host key issues, revert from warning to autoadd. * Frida Injection refactoring * Enhancements to ARC and Stack Canary Checks in Mach-O Parsing (#2284) * Extend 'has_arc' check to include '_swift_release' Updated the has_arc method to detect the usage of ARC not only by the presence of the _objc_release symbol but also by the _swift_release symbol. This change broadens the scope of ARC detection to cover both Objective-C and Swift implementations. * Optimize has_canary function without using a set Refactored the has_canary method to directly check the presence of ___stack_chk_fail and ___stack_chk_guard symbols in imported_functions. Removed the unnecessary conversion to a set, streamlining the function and enhancing readability. Now, has_canary uses any() for efficient symbol existence checks. * [HOTFIX] RPC hook suggestions + Bug Fix (#2301) * String compare script improvements * Fix iOS Frida script bugs * Added RPC helpers for hook suggestion (TODO:Expose to UI) * Code QA * HOTFIX: Add missing RPC script, Frida Logs font size * version bump * update pktool to 2.9.1 (#2304) * [EFR][HOTFIX] QA Request (#2306) * Scan independent library file (.so, .dylib, Framework dylib) from APK/IPA Static Analysis Report * Library analysis refactored relative path helper for Django template. * Re-introduced RELRO checks for Android, added Dart binary check to avoid Flutter false positives. * Improved stripped debug symbol check for ELF and MachO using native OS tools such as nm and objdump when available. * Merge iOS Framework and Dylib Analysis. * Bug Fixes + Improvements (#2307) * Replace Android test APK * Added tests for Library analysis from binary (scan_library route) * iOS merge findings from swift and objective c rules with same rule identifier. Fixes #2287 * iOS Binary analysis, sort regex matches. Fixes #2252 * Framework dylibs with no extensions to skip PIE checks. Fixes #2307 * Select correct network_security config. Fixes #2049 * Android Manifest Analysis added support for detecting task hijacking (StrandHogg 1.0 and StrandHogg 2.0) . Fixes #2124 * Added new manifest analysis rule to warn on apps targeting older Android OS * Updated severity of findings * UI improvement for AppSec dashboard to show a loader * UI changes in Static Analysis to collapse large no of files in API and Code Analysis for better real estate * Improved certificate file analysis for android, jar, aar, and ios * MobSF version Bump * [HOTFIX] ChatGPT Permission Mapping + Improved Description (#2308) * Android Permission Mapping, generated with ChatGPT + axplorer. Addressed #1772 * Android Permission description enhancement generated with ChatGPT * Added new permissions to permission analyzer * Windows Python tempfile permission error fix (#2309) * Fix PermissionError: [Errno 13] Permission denied Windows Python tempfile permission error fix * Multiple Features Improved or Added (#2310) * Android added App Link assetlinks.json check * Added more new permission mappings * Updated Permission database * Improved Source code view content search * Added upstream proxy support for Corellium API calls * Updated Readme * [HOTFIX] Malware Permission Check for Android, API Rules + Version Bump (#2313) * Malware Permission Check for Android * New Android API rule to support Passkeys * Updated Readme * Version Bump * Bug Fix and QA (#2315) * Bug Fix * QA * Version bumps * HOTFIX: update apktool, fixes a security issue GHSA-2hqv-2xv4-5h5w * Update submodule * Using multithreading to improve code efficiency (#2319) * Using multithreading to improve code efficiency * Update manifest_analysis.py * QA * Handle asterik in host names. --------- Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * GPT Goodness (#2318) * QA * Version Bump * Update SECURITY.md (#2323) updated security policy * [HOTFIX][SECURITY] Fix an LFI, DSA Pub Key parsing bug and dependencies (#2326) * [SECURITY] Fixes an LFI reported by @0x33c0unt - A crafted APK resource with icon name containing arbitrary path will get copied by MobSF as the icon file to the download directory which is available under `/download/` route. Fixed by https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/a58f8a8c0aa49e1581d97e19e8e2255ca96cd838 * Fixes #2324 , Bug in parsing DSA Public Key parameters for fingerprint calculation. * Update dependencies * Filter out invalid links (#2322) * Filter out invalid links [ERROR] 2024-01-10 10:28:29 - Well Known Assetlinks Check for URL: http://*/.well-known/assetlinks.json Traceback (most recent call last): requests.exceptions.InvalidURL: URL has an invalid label. * Update manifest_analysis.py --------- Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Fix Arbitrary file writes on Windows (#2328) * Runtime Exec Tampering Detection, iOS Dynamic REST APIs, Datatables Export (#2339) * Runtime Executable Tampering Detection * Add security.py * Code QA Performance * Code QA Runtime EXEC tampering detection * Corellium API QA + Domain support * REST API Docs + Datatables export * HOTFIX: Dependency bump * HOTFIX: Injected code overwrite revert * HOTFIX: Bump deps + ELF strings check fix * MOBSF_CORELLIUM_API_DOMAIN Update (#2347) * MOBSF_CORELLIUM_API_DOMAIN Update Set the default of `MOBSF_CORELLIUM_API_DOMAIN` to `https://app.corellium.com` was it was not being picked up properly in `dynamic_analyzer.py` for iOS * Update corellium_apis.py * Update settings.py --------- Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Add name parameter to create vm * Add name support in ui * HOTFIX: Frida Logs API response code + Dependency bump * HOTFIX: Bump deps + expose Corellium stop app api * Fix #2343 * HOTFIX: target sdk bug * HOTFIX: Bump androguard + remove quark * HOTFIX: androguard bump * Fix #2349 * HOTFIX: Individual image publish * HOTFIX:[SECURITY] Fix GHSA-wfgj-wrgh-h3r3, dep bump, docker build qa * poetry pyqt5 fixes (#2362) * poetry pyqt5 fixes * QA * fix * Cert analysis qa * QA * pin pyqt5 * HOTFIX: Remove Androguard dependency use only features required by MobSF (#2363) This PR strips out androguard and it's dependencies from MobSF. Extract androguard related functions used by MobSF. Some dependencies such as pyQt5 from apkinspector is breaking the ARM64 docker image. This should address that issue. In future, we will have to copy over any fixes to axml, apk, public, types from androguard and ZipEntry from apkinspector. We won't be adding linting to these files. The extracted functions will be considered as an external tool. * Optimize rendering of big lists (#2351) * Optimize rendering of big lists * Dynamic rendering in browser to improve ux Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Fixes GHSA-m435-9v6r-v5f6 * Update SECURITY.md (#2364) * Update SECURITY.md (#2365) * Update SECURITY.md * HOTFIX: Build and push docker arm64 and amd64 together * HOTFIX: Possible SSRF * Resolve the situation where the function name is bytes (#2367) fix error: if function.name.endswith('_chk'): ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TypeError: endswith first arg must be bytes or a tuple of bytes, not str Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Lint fixes #1 * Lint fixes #2 * Lint fixes #3 * Lint fixes #4 * Lint fixes #5 * Removing authentication requirement for /tests * Lint fixes * Updated * Updated test logging * Lint fix * Setting template in context * Lint fixes * Added missing api params * is_admin adjustment * Include checksum * Lint fixes * Adding more logging * Unit test fixes * Lint fix * # Get App Icon fix * SCAN_LOGS support * Timestamp fix * Undid some bad updates * Lint fix * Error set is_admin * Adding logging * Removing logs field * Debugging error * Debugging * Adding framework_analysis to fake_bin_dict * Fixed so_analysis * scan_library fix * Handling of empty fields * Lint fixes * Lint fixes * Updates to settings.py to allow ECS environment variables to be used * Changing errors to warnings * Resetting tests.py to match 3.9.7 * Fixing unit test * exec2 in EXECUTABLE_HASH_MAP * SCAN_TYPE fixes * Removing old &quot;custom&quot; HTTP header tests --------- Signed-off-by: dependabot[bot] &lt;support@github.com&gt; Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; Co-authored-by: superpoussin22 &lt;vincent.nadal@orange.fr&gt; Co-authored-by: pyup.io bot &lt;github-bot@pyup.io&gt; Co-authored-by: Matej Soroka &lt;hi@matejsoroka.com&gt; Co-authored-by: N1neSun &lt;917549681@qq.com&gt; Co-authored-by: Ajin.Abraham &lt;ajin.abraham@chime.com&gt; Co-authored-by: Dapo Adedire &lt;adedireadedapo19@gmail.com&gt; Co-authored-by: Atarii &lt;atarii@users.noreply.github.com&gt; Co-authored-by: Han0nly &lt;byxiaohanzhang@foxmail.com&gt; Co-authored-by: rustaska &lt;11994805+rustaska@users.noreply.github.com&gt; Co-authored-by: Toor &lt;toor@DES-macOS-pentest.local&gt; Co-authored-by: TrellixVulnTeam &lt;112716341+TrellixVulnTeam@users.noreply.github.com&gt; Co-authored-by: TrellixVulnTeam &lt;kasimir.schulz@trellix.com&gt; Co-authored-by: ohyeah521 &lt;ohyeah521@gmail.com&gt; Co-authored-by: th3-d4v1d-c0de &lt;116191845+th3-d4v1d-c0de@users.noreply.github.com&gt; Co-authored-by: evmxattr &lt;evmxattr@users.noreply.github.com&gt; Co-authored-by: none &lt;none@none.com&gt; Co-authored-by: antoinbo &lt;87284775+antoinbo@users.noreply.github.com&gt; Co-authored-by: Karmaz &lt;51202595+Karmaz95@users.noreply.github.com&gt; Co-authored-by: Abb4d0n &lt;Abb4d0n@users.noreply.github.com&gt; Co-authored-by: Mark Sowell &lt;mark@marksowell.com&gt; Co-authored-by: dependabot[bot] &lt;49699333+dependabot[bot]@users.noreply.github.com&gt; Co-authored-by: cpuu &lt;cpuu@icloud.com&gt; Co-authored-by: JJ &lt;124142040+HackJJ@users.noreply.github.com&gt; Co-authored-by: JPSxzy8 &lt;147696419+JPSxzy8@users.noreply.github.com&gt;</MESSAGE>
      <SHA>177b0ad270de07e8f32528b6159541a1fe7203d8</SHA>
      <PATCHEDFILES>
        <FILE>.github/SECURITY.md</FILE>
        <FILE>.github/workflows/mobsf-test.yml</FILE>
        <FILE>.pyup.yml</FILE>
        <FILE>.sonarcloud.properties</FILE>
        <FILE>Dockerfile</FILE>
        <FILE>LICENSES/apkinspector.txt</FILE>
        <FILE>LICENSES/apksigner.txt</FILE>
        <FILE>LICENSES/vd2svg.txt</FILE>
        <FILE>README.md</FILE>
        <FILE>mobsf/DynamicAnalyzer/forms.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/apk_patcher.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/auxiliary/class_trace.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/auxiliary/get_loaded_classes.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/auxiliary/get_methods.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/auxiliary/search_class_pattern.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/auxiliary/string_catch.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/auxiliary/string_compare.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/default/api_monitor.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/default/debugger_check_bypass.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/default/dump_clipboard.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/default/root_bypass.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/default/ssl_pinning_bypass.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/app-environment.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/bypass-adb-detection.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/bypass-emulator-detection.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/bypass-react-native-emulator-detection.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/crypto-aes-key.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/crypto-dump-keystore.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/crypto-keyguard-credential-intent.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/crypto-trace-cipher.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/crypto-trace-keygenparameterspec.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/crypto-trace-keystore.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/crypto-trace-secretkeyfactory.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/default.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/device-android-id.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/device-environment.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/dump-inputstream.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/dump-intent.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/dump-library-exports.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/dump-okhttp-calls.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/helper-android-change-sdk-version.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/helper-android-spoof-gps.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/helper-bypass-method.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/helper-convert.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/helper-early-java.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/helper-heap-search.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/helper-jni-hook-by-address.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/helper-trace-jni.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/hook-billing.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/hook-constructor.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/hook-java-reflection.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/hook-json.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/hook-logging.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/ssl-bypass-flutter.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/ssl-pinning-bypass.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/stop-app-terminate.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/trace-bluetooth.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/trace-file.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/trace-shared-preference.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/ui-deeplink-trace.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/ui-fingerprint-bypass-via-exception-handling.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/ui-fingerprint-bypass.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/ui-flag-secure-bypass.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/others/ui-webview-enable-debugging.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/android/rpc/get-hooks.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/auxiliary/string_compare.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/default/debugger_check_bypass.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/auxiliary/class-trace.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/auxiliary/find-app-classes-methods.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/auxiliary/find-app-classes.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/auxiliary/find-specific-method.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/auxiliary/get-methods.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/auxiliary/search-class-pattern.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/auxiliary/string-capture.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/auxiliary/string-compare.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/default/jailbreak_bypass.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/cookies.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/crypto.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/data-dir.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/file-access.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/json.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/keychain.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/network.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/nslog.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/nsurlcredentialstorage.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/nsuserdefaults.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/pasteboard.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/sqlite.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/dump/text-inputs.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/app-environment.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/bypass-ssl-flutter.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/bypass-ssl-ios10.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/bypass-ssl-ios11.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/bypass-ssl-ios12.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/bypass-ssl-ios13.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/bypass-ssl-trustkit.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/check-keyboard-cache.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/check-keyboard-thridparty.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/device-environment.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/dump-ios-url-scheme.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/find-all-classes-methods.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/find-all-classes.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/flutter-trace-function.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/get-exports.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/get-modules.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-backtrace.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-get-memory-address-of-class.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-ios-change-system-version.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-ios-spoof-gps.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-memory-hex-dump.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-method-hooking.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-read-plist-file.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-replace-exported-method.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-show-modify-function-arguments.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-show-modify-method-return-value.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-ssh-commands.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-view-and-modify-method-registers.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/helper-view-method-arguments.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/trace-bluetooth.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/ui-enable-webinspector.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/ui-ios-alert.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/ui-ios-biometric-bypass.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/ui-send-url-scheme.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/ui-trace.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/ui-view-trace.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/others/ui-webview-trace.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/frida_scripts/ios/rpc/get-app-container.js</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/onDevice/xposed/ClipDump.apk</FILE>
        <FILE>mobsf/DynamicAnalyzer/tools/onDevice/xposed/hooks.json</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/analysis.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/dynamic_analyzer.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/environment.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/frida_core.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/frida_scripts.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/operations.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/report.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/tests_common.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/tests_frida.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/tests_tls.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/common/device.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/common/frida.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/common/shared.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/ios/analysis.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/ios/corellium_apis.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/ios/corellium_instance.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/ios/corellium_ssh.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/ios/dynamic_analyzer.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/ios/frida_auxiliary_scripts.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/ios/frida_core.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/ios/report.py</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/ios/tests_frida.py</FILE>
        <FILE>mobsf/MalwareAnalyzer/views/android/apkid.py</FILE>
        <FILE>mobsf/MalwareAnalyzer/views/android/permissions.py</FILE>
        <FILE>mobsf/MalwareAnalyzer/views/android/quark.py</FILE>
        <FILE>mobsf/MobSF/init.py</FILE>
        <FILE>mobsf/MobSF/security.py</FILE>
        <FILE>mobsf/MobSF/settings.py</FILE>
        <FILE>mobsf/MobSF/urls.py</FILE>
        <FILE>mobsf/MobSF/utils.py</FILE>
        <FILE>mobsf/MobSF/views/admin.py</FILE>
        <FILE>mobsf/MobSF/views/api/api_android_dynamic_analysis.py</FILE>
        <FILE>mobsf/MobSF/views/api/api_ios_dynamic_analysis.py</FILE>
        <FILE>mobsf/MobSF/views/api/api_static_analysis.py</FILE>
        <FILE>mobsf/MobSF/views/apk_downloader.py</FILE>
        <FILE>mobsf/MobSF/views/home.py</FILE>
        <FILE>mobsf/MobSF/views/scanning.py</FILE>
        <FILE>mobsf/StaticAnalyzer/forms.py</FILE>
        <FILE>mobsf/StaticAnalyzer/models.py</FILE>
        <FILE>mobsf/StaticAnalyzer/test_files</FILE>
        <FILE>mobsf/StaticAnalyzer/tests.py</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/androguard4/apk.py</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/androguard4/axml.py</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/androguard4/resources/public.py</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/androguard4/resources/public.xml</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/androguard4/types.py</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/androguard4/zipfile.py</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/apksigner.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/apktool_2.9.3.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/bin/jadx</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/bin/jadx.bat</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-cli-1.3.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-core-1.3.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-dex-input-1.3.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-gui-1.3.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-java-convert-1.3.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-java-input-1.3.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-plugins-api-1.3.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/tools/jadx/lib/jadx-smali-input-1.3.5.jar</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/android_manifest_desc.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/app.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/cert_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/code_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/db_interaction.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/dvm_permissions.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/find.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/icon_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/jar_aar.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/manifest_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/manifest_utils.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/manifest_view.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/network_security.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/rules/android_apis.yaml</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/rules/android_permissions.yaml</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/so.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/source_tree.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/static_analyzer.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/view_source.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/win_fixes.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/a.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/appsec.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/binary/elf.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/binary/lib_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/binary/macho.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/binary/strings.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/pdf.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/shared_func.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/suppression.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/comparer.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/binary_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/binary_rule_matcher.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/code_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/db_interaction.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/dylib.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/file_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/icon_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/rules/swift_rules.yaml</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/static_analyzer.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/strings.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/view_source.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/windows/windows.py</FILE>
        <FILE>mobsf/install/windows/setup.py</FILE>
        <FILE>mobsf/signatures/exodus_trackers</FILE>
        <FILE>mobsf/signatures/maltrail-malware-domains.txt</FILE>
        <FILE>mobsf/static/datatables/css/datatables.combined.min.css</FILE>
        <FILE>mobsf/static/datatables/js/datatables.combined.min.js</FILE>
        <FILE>mobsf/static/datatables/js/pdfmake.min.js</FILE>
        <FILE>mobsf/static/datatables/js/pdfmake.min.js.map</FILE>
        <FILE>mobsf/static/datatables/js/vfs_fonts.js</FILE>
        <FILE>mobsf/static/others/css/devices.min.css</FILE>
        <FILE>mobsf/static/others/css/terminal.css</FILE>
        <FILE>mobsf/static/others/js/datatables_init.js</FILE>
        <FILE>mobsf/static/others/js/swipe.js</FILE>
        <FILE>mobsf/static/terminal/terminal.css</FILE>
        <FILE>mobsf/templates/base/list.html</FILE>
        <FILE>mobsf/templates/dynamic_analysis/android/dynamic_analysis.html</FILE>
        <FILE>mobsf/templates/dynamic_analysis/android/dynamic_analyzer.html</FILE>
        <FILE>mobsf/templates/dynamic_analysis/android/dynamic_report.html</FILE>
        <FILE>mobsf/templates/dynamic_analysis/android/frida_logs.html</FILE>
        <FILE>mobsf/templates/dynamic_analysis/ios/dynamic_analysis.html</FILE>
        <FILE>mobsf/templates/dynamic_analysis/ios/dynamic_analyzer.html</FILE>
        <FILE>mobsf/templates/dynamic_analysis/ios/dynamic_report.html</FILE>
        <FILE>mobsf/templates/dynamic_analysis/ios/system_logs.html</FILE>
        <FILE>mobsf/templates/general/apidocs.html</FILE>
        <FILE>mobsf/templates/general/dynamic.html</FILE>
        <FILE>mobsf/templates/general/home.html</FILE>
        <FILE>mobsf/templates/general/recent.html</FILE>
        <FILE>mobsf/templates/general/search.html</FILE>
        <FILE>mobsf/templates/general/support.html</FILE>
        <FILE>mobsf/templates/pdf/android_report.html</FILE>
        <FILE>mobsf/templates/pdf/ios_report.html</FILE>
        <FILE>mobsf/templates/static_analysis/android_binary_analysis.html</FILE>
        <FILE>mobsf/templates/static_analysis/android_source_analysis.html</FILE>
        <FILE>mobsf/templates/static_analysis/appsec_dashboard.html</FILE>
        <FILE>mobsf/templates/static_analysis/compare.html</FILE>
        <FILE>mobsf/templates/static_analysis/ios_binary_analysis.html</FILE>
        <FILE>mobsf/templates/static_analysis/ios_source_analysis.html</FILE>
        <FILE>mobsf/templates/static_analysis/source_tree.html</FILE>
        <FILE>mobsf/templates/static_analysis/windows_binary_analysis.html</FILE>
        <FILE>poetry.lock</FILE>
        <FILE>pyproject.toml</FILE>
        <FILE>run.sh</FILE>
        <FILE>scripts/mass_static_analysis.py</FILE>
        <FILE>setup.bat</FILE>
        <FILE>setup.sh</FILE>
        <FILE>tox.ini</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge 3.9.7 #2 (#200) * HOTFIX: EFR01 Enterprise feature request (#1908) * Replace Warning with Medium and added Hotspot * Add file analysis to hotspot * Enterprise Feature Request Flag * EFR01 changes * version bump * update quark &amp; frida (#1903) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update tldextract from 3.1.2 to 3.2.0 (#1910) * upgrade apktool to 2.6.1 (#1915) * Hotfix: Update slack link * Hotfix: update slack link * Hotfix: Slack link * Hotfix:Slack link * Hotfix:Slack link * Introduce jadx decompilation timeout with env var (#1916) * Introduce jadx decompilation timeout with env var - exception for timeout - replace subprocess.call for run Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update ip2location from 8.6.4 to 8.7.2 (#1926) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Scheduled weekly dependency update for week 13 (#1931) * Update quark-engine from 22.2.1 to 22.3.1 * update lief Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * update apkid (#1939) * Fix dynamic report_json api bug (#1934) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Hotfix: LIEF * Update README.md (#1951) * update jadx to 1.3.4 (#1941) * update jadx to 1.3.4 * update lief * update jadx and requirements * Scheduled weekly dependency update for week 22 (#1972) * Update ip2location from 8.7.3 to 8.7.4 * Update quark-engine from 22.4.1 to 22.5.1 * Update frida from 15.1.17 to 15.1.23 * Update tldextract from 3.2.1 to 3.3.0 * Check for updates via GitHub releases (#1957) * Check the GitHub releases page for latest version number * Update utils.py Only log distro if not empty (or spaces) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update cert_analysis.py (#1948) * Update cert_analysis.py Flag on MD5 hash algorithm in signer certificate * Update cert_analysis.py Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: Update Readme with Rewards Banner * Update frida from 15.1.23 to 15.1.24 (#1975) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: openSSL link and readme update * Hotfix: Broken slack channel link fix * Hotfix: Windows setup script * Feature Parity Allow iOS IPA download (#1977) * Allow iOS IPA download * Code QA * Add the checking of the parent element of the permission-related elements to manifest analysis (#1905) * Add the checking of the parent element of the permission-related elements to manifest analysis Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Remove RELRO (#1978) * Revert &quot;Add the checking of the parent element of the permission-related elements to manifest analysis (#1905)&quot; (#1984) HOTFIX: Revert #1905 * Scheduled weekly dependency update for week 26 (#1986) * Update ip2location from 8.7.4 to 8.8.0 * Update frida from 15.1.24 to 15.1.27 * Update quark-engine from 22.5.1 to 22.6.1 (#1989) * Scheduled weekly dependency update for week 28 (#1993) * Update frida from 15.1.27 to 15.1.28 * Update tldextract from 3.3.0 to 3.3.1 * HOTFIX: libsast, iOS Rule, M1 Mac support * Hotfix #1999 * Update frida from 15.1.28 to 15.2.2 (#2002) * Update README.md (#2020) add Badge App * Fix bug #1917 where checking for stripped debugging symbols produces false positives in iOS. (#2023) Co-authored-by: Toor &lt;toor@DES-macOS-pentest.local&gt; Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update ip2location from 8.8.0 to 8.8.1 (#2035) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * update apkid to 2.1.4 (#2037) * Adding tarfile member sanitization to extractall() (#2039) Co-authored-by: TrellixVulnTeam &lt;kasimir.schulz@trellix.com&gt; Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * fix res directory not exist (#2042) Fix the problem that the res resource folder does not exist, the solution is to copy from the apktool_out directory * [EFR-02]Enterprise Feature Request - False Positive Triaging (#2000) * Suppression logic * Android code analysis suppression * Fixes #1981 * iOS source support bundle id extraction * iOS Source Code - Suppression support * Remove check in CFBundleURLName * iOS Binary code analysis suppression support * Add Code QL * Suppression support for Manifest analysis * Fixes #2014 * REST API + Docs * Address review comments * update suppression wordings * Fixes #2043 * Icon analysis code QA * Unit Test for False Positive Triaging * Adding numeric_owner as a keyword argument (#2050) numeric_owner needs to be a keyword argument. * Scheduled weekly dependency update for week 41 (#2046) * Update quark-engine from 22.6.1 to 22.9.1 * Update frida from 15.2.2 to 16.0.1 * Update tldextract from 3.3.1 to 3.4.0 * Update openstep-parser from 1.5.3 to 1.5.4 Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: revert frida to 15.X * HOTFIX: UI changes and warning on mobsf.live (#2051) * UI changes and warning on mobsf.live * Update home.html * HOTFIX: Split certificate analysis out, suppression list fixes (#2052) * Hotfix: ui on donate page * Hotfix: Homescreen Navbar * Hotfix: UI icon * hotfix for quyark rules location (#2053) * HOTFIX: jadx update to 1.4.5 (#2064) * jadx update to 1.4.5 * MobSF version bump * Fixes CVE-2022-42889 in third party dependency * Installation script error: Solving spelling error (#2067) changed &quot;installtion&quot; to &quot;installation&quot; * Android APK support extracting icon SVG from XML (#2060) * Added support for SVG icon extraction * Add jar binaries * code refactoring * Update settings.py * HOTFIX: Setup improvement (#2078) * Improve setup scripts. * Python support to 3.8 - 3.10 * Delete MobSF data directory on running setup. * Bump applicable dependencies. * Apktool 2.7.0 update (#2082) * Update apktool to version 2.7.0 * HOTFIX: Icon should be a file * version bump * New Android Manifest Rule: App support vulnerable android versions (#2114) * add a new rule: dangerous os version * qa * lint checks * run lint test on one os * Support for filenames containing &amp; (#2129) Co-authored-by: none &lt;none@none.com&gt; * HOTFIX: Fix docker build (#2135) * Fix Scorecard Severity Distribution chart data (#2140) * HOTIX: Update Dockerfile to install jq (#2149) * Update Dockerfile * Update tox.ini * [HOTFIX] Add support for environment variable for MobSF config (#2150) * add support for environment variable config * Fixes #2109 * update lief * HOTFIX: Fixes #2144 * HOTFIX: Android min SDK check on janus vulnerability detection (#2159) * Android min SDK check on janus check * Update README.md * [Enterprise Feature Request EFR02] Support summary of severity in each section. (#2160) * Summary for Android and iOS SCA * [EFR05] Enterprise Feature Request: AAR and JAR support (#2163) * AAR and JAR support * Enable binary analysis for aar/jar * Scheduled weekly dependency update for week 24 (#2187) * Update ip2location from 8.9.0 to 8.10.0 * Update quark-engine from 22.10.1 to 23.5.1 * Update LIEF from to 0.13.1 * Update tldextract from 3.4.0 to 3.4.4 * Update requirements.txt --------- Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Update requirements.txt 0.13.1 not available. * HOTFIX: update lief * Revert Hotfix * HOTFIX: Feature updates and Bug Fixes (#2197) * OFAC, jquery bump, tox fix * AAR handle multiple application tags * HOTFIX: MobSF Android Dynamic Analysis Docker Support (#2214) * MobSF Android Docker Support * Pin pip version * Update mobsf-test.yml * Update setup.py * Hotfix: Docker error fixes * Hotfix: Add Corellium support message * Hotfix: Broken donate link fix * Update dynamic_analysis.html (#2218) * Hotfix: Handle Docker &lt;-&gt; ADB connectivity internally (#2219) * host.docker.internal transilation for localhost * Replace urlparse with re * version bump * update ascii art * update apktool to 2.8.1 (#2220) * update apktool (#2225) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: translate upstream proxy ip for docker * Dynamic Analysis support alert (#2227) * [HOTFIX] Regex + Rule Update (#2232) * IOS Swift Rules updates * Updated or added rules `ios_biometric_bool`, `ios_biometric_acl`, `ios_keychain_weak_acl_device_passcode`, `ios_keychain_weak_accessibility_value`, `ios_insecure_random_no_generator`, `ios_biometry_hardened` * Regex Hardening: Fixes possible Regex DoS in rules and MobSF code base * [HOTFIX][EFR06] Independent Shared Object (.so) Scan and Improved String search (#2228) * String extraction from APK, Source, AAR, JAR, SO * Strings sections to show source of strings extracted * Strings Refactor * Support for independent .SO scan * Android SCA rules update * Entropies scan support for strings * URLs/Email extraction refactor * Bug Fixes * iOS Source Report Fix * Frida APK Patcher (WIP) * Dynamic Analyzer identifier not available * Settings env var not working fix for enabled by default features * AppSec Score fix * Recent `scan not completed` fix for iOS zip * HOTFIX: Improve code string extraction * Update macho_analysis.py - SYMBOLS STRIPPED False Negative (#2234) * Update macho_analysis.py PR for this issue: https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2233 * Update macho_analysis.py Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * HOTFIX: fix IPA download support * [HOTFIX][EFR-08] Dylib + Symbols + Other Features (#2239) * Dylib analysis support + PDF for iOS Binary * Dylib string extraction * Improved iOS Plist secret extraction * iOS/Android Form Validation QA * Independent Dylib scan * Symbols view for dylib and so * Trackers support for so * Fix missing exported components (#2176) Components which are exported and have no permission were not listed in the results because of a wrong template description key. Also added a warning if this happens again. Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * [HOTFIX][EFR09] AAR/JAR obfuscation and debug check + Exception Handed strings and symbols extraction (#2240) * AAR/JAR obfuscation and debug check * Exception handling symbols and strings from so/dylib * [HOTFIX][EFR10] Independent Static Library(.a) ELF/MachO Analysis + Graceful Analysis (#2242) * Independent Static Library(.a) ELF/MachO Analysis * Mac FAT binary only supported on Mac * Static and Dynamic Binary Analysis QA * Refactor Dex permissions * Fallback certificate analysis using apksigtool * Refactor Androguard `apk.APK()` usage * Pip to Poetry, Ubuntu Base image Bump, Dockerfile QA, Python 3.11 support (#2244) * Docker base image update * Docker file QA * Github Actions version update * Removed unwanted pinned repository * Pip to Poetry migration * Bump httptools * Jump yara-python-dex * Python 3.11 support * [HOTFIX] Docker Buildx test (#2247) * Docker image build test for PRs * [HOTFIX] bs4 malformed xml parsing + xml namespace detection (#2248) * Use BeautifulSoup4 to prettify malformed XML * Detect non standard XML namespace in AndroidManifest.xml (Fixes : https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2198) * Updated android permissions list * Updated android permission update check script * [HOTFIX] Migrate from setup.py to poetry, tox QA (#2249) * Migrate from setup.py to use poetry build and publish * Tox QA * Version is now configured only at pyproject.toml * Added poetry build test * Updated mobsf PyPI publishing workflow * Update local DBs * Performance Improvements on SAST (#2251) * Performance improvements in SAST scans (Code Analysis, API Analysis, NIAP etc.) with libsast bump * Android API rule QA * Manifest analysis continuation on apktool failure * Linux setup script fix * Disable NIAP by default * [HOTFIX] add apksigner.jar for reading signatures (#2254) * Add `apksigner.jar` * Use apksigner to extract signature versions (v1, v2, v3, v4) * Fix: #2120 * [HOTFIX] add jar (#2255) * Add apksigner jar * [HOTFIX] Bump Frida to address crash on M1 Mac (#2258) * Update frida to 16.1.4 to resolve segmentation faults on Docker arm image --------- Co-authored-by: Mark Sowell &lt;mark@marksowell.com&gt; * [HOTFIX] simplify scan api (#2259) * Simplify Scan API * Need only scan hash to trigger a scan * Updated API Docs * [HOTFIX] iOS Framework Analysis + Multiple Feature QA (#2260) * iOS Framework Analysis * Static Analysis URL simplification * Replace hardcoded urls in template with `{% url %}` * Code QA * Remove unwanted template file * Remove `rescan` query param from url * Android icon SVG guessing improvements * Icon analysis refactoring, change icon storage location * Remove SVG to PNG converter. Support PNG and SVG icon. * Github docker release action update * [HOTFIX] Support webp for icon (#2267) * [HOTFIX] Fixed that the icon cannot be found (#2265) fixed that the icon cannot be found when the suffix name is uppercase * Allow jpeg icons (#2268) * [HOTFIX] Fix jadx and apktool failure due to JDK changes (#2269) * Fix jadx and apktool failure due to JDK zip64 changes * [HOTFIX][EFR] Priority Bug Fixes (#2275) * P1.1 AAR Permissions not properly listed * P1.2 Local variable table not listed in proper section * P1.3 static library strings are not listed * P1.5 Stripping of dynamic and static libraries are not correctly reported * Dependency bump * MobSF version bump * Hotfix: Bump deps * update apktool to 2.9.0 (#2278) Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Build(deps): Bump django from 4.1.12 to 4.1.13 (#2282) Bumps [django](https://github.com/django/django) from 4.1.12 to 4.1.13. - [Commits](https://github.com/django/django/compare/4.1.12...4.1.13) --- updated-dependencies: - dependency-name: django dependency-type: direct:production ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; Co-authored-by: dependabot[bot] &lt;49699333+dependabot[bot]@users.noreply.github.com&gt; * Hotfix: Support viewing kotlin files #2283 * iOS Dynamic Analysis with Corellium (#2194) * iOS Dynamic Analysis Support with Corellium Jailbroken iOS devices * Corellium API layer for complete device and project management * Frida instrumentation (attach, spawn and inject) over SSH local port forward * Shell access over SSH * MobSF httptools proxy integration over SSH remote port forward * Device File upload and download over SSH * Frida scripts for core defense bypass, monitoring, and tracing * Helper iOS Frida scripts for pentesting and malware analysis * Screen cast with touch, swipe and text input support from web UI * Dynamic Analysis device data dump and report Generation * Android Certificate analysis, replaced oscrypto with cryptography for public key parsing * Python minimum support is 3.10 * Bumped httptools to latest, fixes httptools repeat bug * Added unzip to docker to fix a bug * Relaxed bundleid regex * HOTFIX: Dynamic Analysis Improvements Android &amp; iOS (#2295) iOS Screencast, better swipe Android Screencast to support touch, swipe and text input events Android Frida Logs update Android Improved Screencast Android Frida spawn, inject and attach support Added new Android Frida scripts Replaced Clipdump with Frida script for clipboard monitoring * Hotfix QA (#2297) * REST API update for android frida instrument * Code QA * [HOTFIX] More Android &amp; iOS Frida Scripts (#2299) Improved existing frida scripts More Android &amp; iOS frida Scripts Code QA * [HOTFIX] Android script loading, frida injected code view, paramiko SSH issues (#2300) * Android script loading bug fix * Frida injected code view * Paramiko SSH reactor to address some host key issues, revert from warning to autoadd. * Frida Injection refactoring * Enhancements to ARC and Stack Canary Checks in Mach-O Parsing (#2284) * Extend 'has_arc' check to include '_swift_release' Updated the has_arc method to detect the usage of ARC not only by the presence of the _objc_release symbol but also by the _swift_release symbol. This change broadens the scope of ARC detection to cover both Objective-C and Swift implementations. * Optimize has_canary function without using a set Refactored the has_canary method to directly check the presence of ___stack_chk_fail and ___stack_chk_guard symbols in imported_functions. Removed the unnecessary conversion to a set, streamlining the function and enhancing readability. Now, has_canary uses any() for efficient symbol existence checks. * [HOTFIX] RPC hook suggestions + Bug Fix (#2301) * String compare script improvements * Fix iOS Frida script bugs * Added RPC helpers for hook suggestion (TODO:Expose to UI) * Code QA * HOTFIX: Add missing RPC script, Frida Logs font size * version bump * update pktool to 2.9.1 (#2304) * [EFR][HOTFIX] QA Request (#2306) * Scan independent library file (.so, .dylib, Framework dylib) from APK/IPA Static Analysis Report * Library analysis refactored relative path helper for Django template. * Re-introduced RELRO checks for Android, added Dart binary check to avoid Flutter false positives. * Improved stripped debug symbol check for ELF and MachO using native OS tools such as nm and objdump when available. * Merge iOS Framework and Dylib Analysis. * Bug Fixes + Improvements (#2307) * Replace Android test APK * Added tests for Library analysis from binary (scan_library route) * iOS merge findings from swift and objective c rules with same rule identifier. Fixes #2287 * iOS Binary analysis, sort regex matches. Fixes #2252 * Framework dylibs with no extensions to skip PIE checks. Fixes #2307 * Select correct network_security config. Fixes #2049 * Android Manifest Analysis added support for detecting task hijacking (StrandHogg 1.0 and StrandHogg 2.0) . Fixes #2124 * Added new manifest analysis rule to warn on apps targeting older Android OS * Updated severity of findings * UI improvement for AppSec dashboard to show a loader * UI changes in Static Analysis to collapse large no of files in API and Code Analysis for better real estate * Improved certificate file analysis for android, jar, aar, and ios * MobSF version Bump * [HOTFIX] ChatGPT Permission Mapping + Improved Description (#2308) * Android Permission Mapping, generated with ChatGPT + axplorer. Addressed #1772 * Android Permission description enhancement generated with ChatGPT * Added new permissions to permission analyzer * Windows Python tempfile permission error fix (#2309) * Fix PermissionError: [Errno 13] Permission denied Windows Python tempfile permission error fix * Multiple Features Improved or Added (#2310) * Android added App Link assetlinks.json check * Added more new permission mappings * Updated Permission database * Improved Source code view content search * Added upstream proxy support for Corellium API calls * Updated Readme * [HOTFIX] Malware Permission Check for Android, API Rules + Version Bump (#2313) * Malware Permission Check for Android * New Android API rule to support Passkeys * Updated Readme * Version Bump * Bug Fix and QA (#2315) * Bug Fix * QA * Version bumps * HOTFIX: update apktool, fixes a security issue GHSA-2hqv-2xv4-5h5w * Update submodule * Using multithreading to improve code efficiency (#2319) * Using multithreading to improve code efficiency * Update manifest_analysis.py * QA * Handle asterik in host names. --------- Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * GPT Goodness (#2318) * QA * Version Bump * Update SECURITY.md (#2323) updated security policy * [HOTFIX][SECURITY] Fix an LFI, DSA Pub Key parsing bug and dependencies (#2326) * [SECURITY] Fixes an LFI reported by @0x33c0unt - A crafted APK resource with icon name containing arbitrary path will get copied by MobSF as the icon file to the download directory which is available under `/download/` route. Fixed by https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/a58f8a8c0aa49e1581d97e19e8e2255ca96cd838 * Fixes #2324 , Bug in parsing DSA Public Key parameters for fingerprint calculation. * Update dependencies * Filter out invalid links (#2322) * Filter out invalid links [ERROR] 2024-01-10 10:28:29 - Well Known Assetlinks Check for URL: http://*/.well-known/assetlinks.json Traceback (most recent call last): requests.exceptions.InvalidURL: URL has an invalid label. * Update manifest_analysis.py --------- Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Fix Arbitrary file writes on Windows (#2328) * Runtime Exec Tampering Detection, iOS Dynamic REST APIs, Datatables Export (#2339) * Runtime Executable Tampering Detection * Add security.py * Code QA Performance * Code QA Runtime EXEC tampering detection * Corellium API QA + Domain support * REST API Docs + Datatables export * HOTFIX: Dependency bump * HOTFIX: Injected code overwrite revert * HOTFIX: Bump deps + ELF strings check fix * MOBSF_CORELLIUM_API_DOMAIN Update (#2347) * MOBSF_CORELLIUM_API_DOMAIN Update Set the default of `MOBSF_CORELLIUM_API_DOMAIN` to `https://app.corellium.com` was it was not being picked up properly in `dynamic_analyzer.py` for iOS * Update corellium_apis.py * Update settings.py --------- Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Add name parameter to create vm * Add name support in ui * HOTFIX: Frida Logs API response code + Dependency bump * HOTFIX: Bump deps + expose Corellium stop app api * Fix #2343 * HOTFIX: target sdk bug * HOTFIX: Bump androguard + remove quark * HOTFIX: androguard bump * Fix #2349 * HOTFIX: Individual image publish * HOTFIX:[SECURITY] Fix GHSA-wfgj-wrgh-h3r3, dep bump, docker build qa * poetry pyqt5 fixes (#2362) * poetry pyqt5 fixes * QA * fix * Cert analysis qa * QA * pin pyqt5 * HOTFIX: Remove Androguard dependency use only features required by MobSF (#2363) This PR strips out androguard and it's dependencies from MobSF. Extract androguard related functions used by MobSF. Some dependencies such as pyQt5 from apkinspector is breaking the ARM64 docker image. This should address that issue. In future, we will have to copy over any fixes to axml, apk, public, types from androguard and ZipEntry from apkinspector. We won't be adding linting to these files. The extracted functions will be considered as an external tool. * Optimize rendering of big lists (#2351) * Optimize rendering of big lists * Dynamic rendering in browser to improve ux Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Fixes GHSA-m435-9v6r-v5f6 * Update SECURITY.md (#2364) * Update SECURITY.md (#2365) * Update SECURITY.md * HOTFIX: Build and push docker arm64 and amd64 together * HOTFIX: Possible SSRF * Resolve the situation where the function name is bytes (#2367) fix error: if function.name.endswith('_chk'): ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TypeError: endswith first arg must be bytes or a tuple of bytes, not str Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; * Lint fixes #1 * Lint fixes #2 * Lint fixes #3 * Lint fixes #4 * Lint fixes #5 * Removing authentication requirement for /tests * Lint fixes * Updated * Updated test logging * Lint fix * Setting template in context * Lint fixes * Added missing api params * is_admin adjustment * Include checksum * Lint fixes * Adding more logging * Unit test fixes * Lint fix * # Get App Icon fix * SCAN_LOGS support * Timestamp fix * Undid some bad updates * Lint fix * Error set is_admin * Adding logging * Removing logs field * Debugging error * Debugging * Adding framework_analysis to fake_bin_dict * Fixed so_analysis * scan_library fix * Handling of empty fields * Lint fixes * Lint fixes * Updates to settings.py to allow ECS environment variables to be used * Changing errors to warnings * Resetting tests.py to match 3.9.7 * Fixing unit test * exec2 in EXECUTABLE_HASH_MAP * SCAN_TYPE fixes * Removing old &quot;custom&quot; HTTP header tests * Version update * Fixing pdf report link * Fixed section display logic --------- Signed-off-by: dependabot[bot] &lt;support@github.com&gt; Co-authored-by: Ajin Abraham &lt;ajin25@gmail.com&gt; Co-authored-by: superpoussin22 &lt;vincent.nadal@orange.fr&gt; Co-authored-by: pyup.io bot &lt;github-bot@pyup.io&gt; Co-authored-by: Matej Soroka &lt;hi@matejsoroka.com&gt; Co-authored-by: N1neSun &lt;917549681@qq.com&gt; Co-authored-by: Ajin.Abraham &lt;ajin.abraham@chime.com&gt; Co-authored-by: Dapo Adedire &lt;adedireadedapo19@gmail.com&gt; Co-authored-by: Atarii &lt;atarii@users.noreply.github.com&gt; Co-authored-by: Han0nly &lt;byxiaohanzhang@foxmail.com&gt; Co-authored-by: rustaska &lt;11994805+rustaska@users.noreply.github.com&gt; Co-authored-by: Toor &lt;toor@DES-macOS-pentest.local&gt; Co-authored-by: TrellixVulnTeam &lt;112716341+TrellixVulnTeam@users.noreply.github.com&gt; Co-authored-by: TrellixVulnTeam &lt;kasimir.schulz@trellix.com&gt; Co-authored-by: ohyeah521 &lt;ohyeah521@gmail.com&gt; Co-authored-by: th3-d4v1d-c0de &lt;116191845+th3-d4v1d-c0de@users.noreply.github.com&gt; Co-authored-by: evmxattr &lt;evmxattr@users.noreply.github.com&gt; Co-authored-by: none &lt;none@none.com&gt; Co-authored-by: antoinbo &lt;87284775+antoinbo@users.noreply.github.com&gt; Co-authored-by: Karmaz &lt;51202595+Karmaz95@users.noreply.github.com&gt; Co-authored-by: Abb4d0n &lt;Abb4d0n@users.noreply.github.com&gt; Co-authored-by: Mark Sowell &lt;mark@marksowell.com&gt; Co-authored-by: dependabot[bot] &lt;49699333+dependabot[bot]@users.noreply.github.com&gt; Co-authored-by: cpuu &lt;cpuu@icloud.com&gt; Co-authored-by: JJ &lt;124142040+HackJJ@users.noreply.github.com&gt; Co-authored-by: JPSxzy8 &lt;147696419+JPSxzy8@users.noreply.github.com&gt;</MESSAGE>
      <SHA>fa240f9a6dc41618a6ca33cff974f2835a9b583f</SHA>
      <PATCHEDFILES>
        <FILE>mobsf/MobSF/init.py</FILE>
        <FILE>mobsf/templates/general/recent.html</FILE>
        <FILE>mobsf/templates/general/support.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
