<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1573</ISSUENO>
  <ISSUEURL>https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/1573</ISSUEURL>
  <TITLE>Use extension to get file type</TITLE>
  <DESCRIPTION>I review API code and I found a error when extract a file type. This is a error, because you check if file has a specific extension to get a file type. I can change a extension and file is still same type. In malware, It is usually get this situation. Its necesary check a magic number of file, It is usually in firsts bytes of file. - https://en.wikipedia.org/wiki/List_of_file_signatures This error is locate in MobSF/views/helpers.py lines 27 to 41</DESCRIPTION>
  <REPONAME>Mobile-Security-Framework-MobSF</REPONAME>
  <TIMEDIFFERENCEDAYS>59</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Migrate from Travis to Github Actions (#1630) Migrate from Travis to Github Actions</MESSAGE>
    <SHA>c15050addb17b2e6a3cb25ca1639fb34f046a617</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>ZIP magic check, Fixes #1573</MESSAGE>
      <SHA>5cb5efedb81de49eaaff0321a87659d4a59d6611</SHA>
      <PATCHEDFILES>
        <FILE>MobSF/views/helpers.py</FILE>
        <FILE>MobSF/views/home.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>HOTFIX: Zip magic check, XAPK support, QA (#1632) Check for ZIP Magic on Upload Support XAPK file format. (Please note that we only scans base APK at this time) Windows utf-8 safe reads, handle frida exceptions Tests for XAPK Fixes: #1573, #1517</MESSAGE>
      <SHA>2648bf918a206066a33b891152fa36eb9c3acb21</SHA>
      <PATCHEDFILES>
        <FILE>DynamicAnalyzer/views/android/frida_core.py</FILE>
        <FILE>DynamicAnalyzer/views/android/frida_scripts.py</FILE>
        <FILE>DynamicAnalyzer/views/android/tests_frida.py</FILE>
        <FILE>DynamicAnalyzer/views/android/tests_xposed.py</FILE>
        <FILE>MobSF/settings.py</FILE>
        <FILE>MobSF/views/api/api_static_analysis.py</FILE>
        <FILE>MobSF/views/helpers.py</FILE>
        <FILE>MobSF/views/home.py</FILE>
        <FILE>MobSF/views/scanning.py</FILE>
        <FILE>README.md</FILE>
        <FILE>StaticAnalyzer/test_files</FILE>
        <FILE>StaticAnalyzer/tests.py</FILE>
        <FILE>StaticAnalyzer/views/android/static_analyzer.py</FILE>
        <FILE>StaticAnalyzer/views/android/xapk.py</FILE>
        <FILE>templates/general/apidocs.html</FILE>
        <FILE>templates/general/home.html</FILE>
        <FILE>templates/general/recent.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
