<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6672</ISSUENO>
  <ISSUEURL>https://github.com/hummingbot/hummingbot/issues/6672</ISSUEURL>
  <TITLE>XxxOrderCreatedEvent is not triggered when limit order gets completely filled immediately after placement</TITLE>
  <DESCRIPTION>### Describe the bug I'm testing `miner_script.py` from #6600 and got an error when the bot is unable to place TakeProfit order because it's amount is 0. This issue is not specific for the PR change however. The logic flow is the following: 1. `PositionExecutor` first creating open order via `place_open_order()` 1. It then expects order creation event to assign order via `get_in_flight_order()`: ```python def process_order_created_event(self, _, market, event: Union[BuyOrderCreatedEvent, SellOrderCreatedEvent]): if self.open_order.order_id == event.order_id: self.open_order.order = self.get_in_flight_order(self.exchange, event.order_id) ``` 3. When order completion event is coming ( `process_order_completed_event()`), take profit order creation logic is triggered. Here, order amount is `amount=self.open_order.executed_amount_base,`. The issue: when `XxxOrderCreatedEvent` event is not coming, `self.open_order.order` assignment is not happening. 0 amount is returned from `TrackedOrder`: ```python @property def executed_amount_base(self): if self.order: return self.order.executed_amount_base else: return Decimal(&quot;0&quot;) # &lt;----- this ``` The fix I made locally: ```python diff --git a/hummingbot/connector/client_order_tracker.py b/hummingbot/connector/client_order_tracker.py index 77d02df4b..193cff4dd 100644 --- a/hummingbot/connector/client_order_tracker.py +++ b/hummingbot/connector/client_order_tracker.py @@ -390,7 +390,10 @@ class ClientOrderTracker: ) def _trigger_order_creation(self, tracked_order: InFlightOrder, previous_state: OrderState, new_state: OrderState): - if previous_state == OrderState.PENDING_CREATE and new_state == OrderState.OPEN: + if previous_state == OrderState.PENDING_CREATE and new_state in (OrderState.OPEN, + OrderState.PARTIALLY_FILLED, + OrderState.FILLED, + OrderState.COMPLETED): self.logger().info(tracked_order.build_order_created_message()) self._trigger_created_event(tracked_order) ``` ### Steps to reproduce 1. 2. 3. ### Release version c0133082cb3b432b9c195b6136a4c11e5eb88f79 ### Type of installation Docker ### Attach required files _No response_</DESCRIPTION>
  <REPONAME>hummingbot</REPONAME>
  <TIMEDIFFERENCEDAYS>425</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Workaround for #6587</MESSAGE>
    <SHA>3548e3fb45418f626d2aa1c6c3e455e2862507aa</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix for OrderCreatedEvent not emitted #6672</MESSAGE>
      <SHA>814a6bc12919a7af735da252ccc12caf21a19ee3</SHA>
      <PATCHEDFILES>
        <FILE>hummingbot/connector/client_order_tracker.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
