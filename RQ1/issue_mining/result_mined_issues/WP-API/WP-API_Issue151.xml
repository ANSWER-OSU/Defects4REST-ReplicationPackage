<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>151</ISSUENO>
  <ISSUEURL>https://github.com/WP-API/WP-API/issues/151</ISSUEURL>
  <TITLE>Add json_ensure_response function</TITLE>
  <DESCRIPTION>API endpoints can return three types of values: - `WP_JSON_Response`: A response object which wraps data, and adds headers + status code - `WP_Error`: A object indicating an error. We also can't really avoid using this, since we want `is_wp_error` to keep working - `mixed`: Any other mixed data to return to the API The ability to return a raw result makes it way easier to use the API since you don't need to worry about instantiating objects and such. PHP functions calling these (i.e. callbacks embedding another one) might want to add extra headers or change the status code. This is only possible with a `WP_JSON_Response` object, not with mixed data. This means a callback calling this needs to do: ``` php if ( ! ( $resp instanceof WP_JSON_Response ) ) { $resp = new WP_JSON_Response( $resp ); } ``` We should add a convenience function to do this. Functions would then be able to do... ``` php $resp = json_ensure_response( $this-&gt;get_post( 4 ) ); if ( is_wp_error( $resp ) ) { return $resp; $resp-&gt;set_status( 201 ); return $resp; ``` (Discovered the need for this one in #146, see [this line](https://github.com/WP-API/WP-API/pull/146/files#diff-cc13d1af83bca665c308c0d134411047R323).) @rachelbaker Thoughts?</DESCRIPTION>
  <REPONAME>WP-API</REPONAME>
  <TIMEDIFFERENCEDAYS>3</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #146 from WP-API/user-endpoints Add endpoints to handle user management. Closes #20.</MESSAGE>
    <SHA>b3b79d3c364abddb015a1b0feedacec2cf516532</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #154 from WP-API/ensure-response Add json_ensure_response function to ensure either a WP_JSON_ResponseInterface or a WP_Error object is returned. Fixes #151.</MESSAGE>
      <SHA>c0f8ae38e4a16b1301b0b12c9bf82ddba765216b</SHA>
      <PATCHEDFILES>
        <FILE>lib/class-wp-json-posts.php</FILE>
        <FILE>plugin.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #154 from WP-API/ensure-response Add json_ensure_response function to ensure either a WP_JSON_ResponseInterface or a WP_Error object is returned. Fixes #151.</MESSAGE>
      <SHA>e7835317adfe3cbf6ed53b41cacb89348bf3bbb7</SHA>
      <PATCHEDFILES>
        <FILE>lib/class-wp-json-posts.php</FILE>
        <FILE>plugin.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
