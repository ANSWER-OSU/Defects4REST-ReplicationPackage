<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2255</ISSUENO>
  <ISSUEURL>https://github.com/WP-API/WP-API/issues/2255</ISSUEURL>
  <TITLE>Comments collection accidentally generates a search query</TITLE>
  <DESCRIPTION>We default `search` to `null`, but internally, `WP_Comment_Query` checks that it's an empty string. This generates a search query which looks like: ``` sql SELECT SQL_CALC_FOUND_ROWS sz_comments.comment_ID FROM sz_comments WHERE ( comment_approved = '1' ) AND comment_post_ID IN ( 85 ) AND comment_type IN ('') AND (comment_author LIKE '%%' OR comment_author_email LIKE '%%' OR comment_author_url LIKE '%%' OR comment_author_IP LIKE '%%' OR comment_content LIKE '%%') ORDER BY sz_comments.comment_date_gmt ASC, sz_comments.comment_ID ASC LIMIT 10 ``` :hear_no_evil: Core needs to be patched to have a better check, but we should work around this in the meantime. cc @rachelbaker our comment overlord</DESCRIPTION>
  <REPONAME>WP-API</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #2250 from WP-API/2081-rm-unused-variable Remove unused `$img_url_basename` variable</MESSAGE>
    <SHA>eeabf0f8d773e3f540c44075eaaed595264bb99e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Ensure search is an empty string See #2255; if it's an empty value (like null, our default) but not an empty string, this will generate a useless search query.</MESSAGE>
      <SHA>caa9bcf0a3278695e6a6344cd2b725611168a24f</SHA>
      <PATCHEDFILES>
        <FILE>lib/endpoints/class-wp-rest-comments-controller.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
