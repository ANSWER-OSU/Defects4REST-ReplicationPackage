<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>149</ISSUENO>
  <ISSUEURL>https://github.com/treasure-data/digdag/issues/149</ISSUEURL>
  <TITLE>Set next runs at after 24+ hours when set non-UTC timezone</TITLE>
  <DESCRIPTION>``` console $ digdag init test $ cd test ... edit test.dig ... $ LANG=C date Wed Jun 29 00:30:29 JST 2016 $ cat test.dig timezone: Asia/Tokyo schedule: daily&gt;: 03:00:00 _export: hello: &quot;Hello, world!&quot; +step1: sh&gt;: tasks/shell_sample.sh +step2: _parallel: true +worker1: sh&gt;: tasks/repeat_hello.sh +worker2: sh&gt;: tasks/repeat_hello.sh +step3: # defined at tasks/__init__.py py&gt;: tasks.MyWorkflow.step3 $ digdag push sched -c /dev/null 2016-06-29 00:32:14 +0900: Digdag v0.8.2 Creating .digdag/tmp/archive-3637571230657586954.tar.gz... Archiving test.dig Archiving tasks/__init__.py Archiving tasks/repeat_hello.sh Archiving tasks/shell_sample.sh Workflows: test Uploaded: id: 1 name: sched revision: b27d99c4-1984-4d06-9f31-9c8cc86c5760 archive type: db project created at: 2016-06-28T15:32:15Z revision updated at: 2016-06-28T15:32:15Z Use `digdag workflows` to show all workflows. $ digdag schedules -c /dev/null 2016-06-29 00:32:19 +0900: Digdag v0.8.2 Schedules: id: 1 project: sched workflow: test next session time: 2016-06-30 00:00:00 +0900 next runs at: 2016-06-30 03:00:00 +0900 (26h 27m 40s later) 1 entries. Use `digdag workflows [project-name] [workflow-name]` to show workflow details. ``` I want to schedule at 2.5 hours later instead of 26.5 hours later.</DESCRIPTION>
  <REPONAME>digdag</REPONAME>
  <TIMEDIFFERENCEDAYS>41</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>always null</MESSAGE>
    <SHA>fdbd881bd662138c8cf5007f80330a6664b5525a</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>First schedule time is expected to be calculated using next run time First schedule time was calculated using next session time. But it's expected to be calculated using next run time instead as an issue filed at [#149].</MESSAGE>
      <SHA>b981a3642a4ab581d8133304534392909b739f9c</SHA>
      <PATCHEDFILES>
        <FILE>digdag-cli/src/main/java/io/digdag/cli/TimeUtil.java</FILE>
        <FILE>digdag-cli/src/main/java/io/digdag/cli/client/Push.java</FILE>
        <FILE>digdag-client/src/main/java/io/digdag/client/DigdagClient.java</FILE>
        <FILE>digdag-core/src/main/java/io/digdag/core/schedule/ScheduleExecutor.java</FILE>
        <FILE>digdag-docs/src/command_reference.rst</FILE>
        <FILE>digdag-server/src/main/java/io/digdag/server/rs/ProjectResource.java</FILE>
        <FILE>digdag-spi/src/main/java/io/digdag/spi/Scheduler.java</FILE>
        <FILE>digdag-standards/src/main/java/io/digdag/standards/scheduler/CronScheduler.java</FILE>
        <FILE>digdag-standards/src/test/java/io/digdag/standards/scheduler/DailySchedulerTest.java</FILE>
        <FILE>digdag-tests/src/test/java/acceptance/ServerScheduleIT.java</FILE>
        <FILE>digdag-tests/src/test/resources/acceptance/schedule/schedule.dig</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
