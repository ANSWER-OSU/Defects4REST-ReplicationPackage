<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>18452</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/18452</ISSUEURL>
  <TITLE>open pidfd: no such process</TITLE>
  <DESCRIPTION>Not a new flake -- this one started cropping up in 2020, but never often enough to even merit an issue. Now, it's happening constantly in #18442, a PR that adds error checking to e2e-test cleanup. ``` $ podman [options] stop --all -t 0 open pidfd: No such process ``` This may not be a complete list--it has been overwhelming: * fedora-37 : int podman fedora-37 root container boltdb * [05-03 11:21](https://api.cirrus-ci.com/v1/artifact/task/5506136472813568/html/int-podman-fedora-37-root-container-boltdb.log.html#t--podman-pod-container-can-override-pod-not-sharing-pid--1) in podman pod container can override pod not sharing pid * fedora-38 : int podman fedora-38 root container boltdb * [05-03 11:17](https://api.cirrus-ci.com/v1/artifact/task/6069086426234880/html/int-podman-fedora-38-root-container-boltdb.log.html#t--podman-pod-correctly-sets-up-PIDNS--1) in podman pod correctly sets up PIDNS * fedora-38 : int podman fedora-38 root host boltdb * [05-03 11:19](https://api.cirrus-ci.com/v1/artifact/task/6209823914590208/html/int-podman-fedora-38-root-host-boltdb.log.html#t--podman-generate-kube-sharing-pid-namespace--1) in podman generate kube sharing pid namespace * fedora-38 : int podman fedora-38 root host sqlite * [05-03 11:19](https://api.cirrus-ci.com/v1/artifact/task/4802449031036928/html/int-podman-fedora-38-root-host-sqlite.log.html#t--podman-play-kube-should-share-ipc-net-uts-when-shareProcessNamespace-is-set--1) in podman play kube should share ipc,net,uts when shareProcessNamespace is set * [05-03 11:19](https://api.cirrus-ci.com/v1/artifact/task/4802449031036928/html/int-podman-fedora-38-root-host-sqlite.log.html#t--podman-play-kube-test-with-init-containers-and-annotation-set--1) in podman play kube test with init containers and annotation set * [05-03 11:19](https://api.cirrus-ci.com/v1/artifact/task/4802449031036928/html/int-podman-fedora-38-root-host-sqlite.log.html#t--podman-play-kube-multi-doc-yaml-with-multiple-services--pods-and-deployments--1) in podman play kube multi doc yaml with multiple services, pods and deployments * [05-03 11:19](https://api.cirrus-ci.com/v1/artifact/task/4802449031036928/html/int-podman-fedora-38-root-host-sqlite.log.html#t--podman-play-kube-with-replicas-limits-the-count-to-1-and-emits-a-warning--1) in podman play kube with replicas limits the count to 1 and emits a warning * [05-03 11:19](https://api.cirrus-ci.com/v1/artifact/task/4802449031036928/html/int-podman-fedora-38-root-host-sqlite.log.html#t--podman-play-kube-override-with-udp-should-keep-tcp-from-YAML-file--1) in podman play kube override with udp should keep tcp from YAML file * fedora-38 : int podman fedora-38 rootless host sqlite * [05-03 11:18](https://api.cirrus-ci.com/v1/artifact/task/4591342798503936/html/int-podman-fedora-38-rootless-host-sqlite.log.html#t--podman-play-kube-test-with-init-containers-and-annotation-set--1) in podman play kube test with init containers and annotation set * [05-03 11:18](https://api.cirrus-ci.com/v1/artifact/task/4591342798503936/html/int-podman-fedora-38-rootless-host-sqlite.log.html#t--podman-play-kube-deployment-more-than-1-replica-test-correct-command--1) in podman play kube deployment more than 1 replica test correct command * [05-03 11:18](https://api.cirrus-ci.com/v1/artifact/task/4591342798503936/html/int-podman-fedora-38-rootless-host-sqlite.log.html#t--podman-play-kube-multi-doc-yaml-with-multiple-services--pods-and-deployments--1) in podman play kube multi doc yaml with multiple services, pods and deployments * rawhide : int podman rawhide root host sqlite * [05-03 11:18](https://api.cirrus-ci.com/v1/artifact/task/5365398984458240/html/int-podman-rawhide-root-host-sqlite.log.html#t--podman-generate-kube-with-volume--1) in podman generate kube with volume * [05-03 11:18](https://api.cirrus-ci.com/v1/artifact/task/5365398984458240/html/int-podman-rawhide-root-host-sqlite.log.html#t--podman-generate-kube-sharing-pid-namespace--1) in podman generate kube sharing pid namespace * [05-03 11:18](https://api.cirrus-ci.com/v1/artifact/task/5365398984458240/html/int-podman-rawhide-root-host-sqlite.log.html#t--podman-play-kube-should-share-ipc-net-uts-when-shareProcessNamespace-is-set--1) in podman play kube should share ipc,net,uts when shareProcessNamespace is set * [05-03 11:18](https://api.cirrus-ci.com/v1/artifact/task/5365398984458240/html/int-podman-rawhide-root-host-sqlite.log.html#t--podman-play-kube-expose-character-device-inside-container--1) in podman play kube expose character device inside container * [05-03 11:18](https://api.cirrus-ci.com/v1/artifact/task/5365398984458240/html/int-podman-rawhide-root-host-sqlite.log.html#t--podman-play-kube-override-with-udp-should-keep-tcp-from-YAML-file--1) in podman play kube override with udp should keep tcp from YAML file * [05-03 11:18](https://api.cirrus-ci.com/v1/artifact/task/5365398984458240/html/int-podman-rawhide-root-host-sqlite.log.html#t--podman-pod-correctly-sets-up-PIDNS--1) in podman pod correctly sets up PIDNS * rawhide : int podman rawhide rootless host sqlite * [05-03 11:17](https://api.cirrus-ci.com/v1/artifact/task/5154292751925248/html/int-podman-rawhide-rootless-host-sqlite.log.html#t--podman-play-kube-support-container-liveness-probe--1) in podman play kube support container liveness probe * [05-03 11:17](https://api.cirrus-ci.com/v1/artifact/task/5154292751925248/html/int-podman-rawhide-rootless-host-sqlite.log.html#t--podman-play-kube-test-with-init-containers-and-annotation-set--1) in podman play kube test with init containers and annotation set * [05-03 11:17](https://api.cirrus-ci.com/v1/artifact/task/5154292751925248/html/int-podman-rawhide-rootless-host-sqlite.log.html#t--podman-play-kube-test-with-DirectoryOrCreate-HostPath-type-volume-and-non-existent-directory-path--1) in podman play kube test with DirectoryOrCreate HostPath type volume and non-existent directory path * [05-03 11:17](https://api.cirrus-ci.com/v1/artifact/task/5154292751925248/html/int-podman-rawhide-rootless-host-sqlite.log.html#t--podman-generate-and-reimport-kube-on-pod--1) in podman generate and reimport kube on pod</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>116</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #18451 from containers/renovate/github.com-onsi-ginkgo-v2-2.x fix(deps): update module github.com/onsi/ginkgo/v2 to v2.9.4</MESSAGE>
    <SHA>4acc1a14a8cbf9c6ed649b9c65f353473d2958ea</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>container stop: handle race There is an inherent race when stopping/killing a container with other processes attempting to do the same and also with the container having exited in the meantime. In those cases, the OCI runtime may fail to kill the container as it has already exited. Handle those races by first checking if the container state has changed before returning the error. [NO NEW TESTS NEEDED] - as it's a hard to test race. Fixes: #18452 Signed-off-by: Valentin Rothberg &lt;vrothberg@redhat.com&gt;</MESSAGE>
      <SHA>8d0050a372338681a6d3d55d59a2215d47589ed1</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container_internal.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
