<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>17912</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/17912</ISSUEURL>
  <TITLE>Podman Test Day</TITLE>
  <DESCRIPTION>Hey Folks! We are in beta now and this is a good time to start planning for a Test Day/Week. As discussed, we will have this post April 15th ( 2023-04-15) ## Initial Tasks (to be done at least one week before test week) - [x] Open this ticket in the `podman` repo - [ ] Open a ticket with [Fedora QA](https://pagure.io/fedora-qa/issues). - [F36 example](https://pagure.io/fedora-qa/issue/695) To be done after the Fedora QA folks have taken action on the QA ticket: - [ ] Confirm the Test Day page is created on the Fedora Wiki. - For example: &lt;https://fedoraproject.org/wiki/Test_Day:Fedora_38_CoreOS_2023-04-03&gt; - [ ] Confirm the Test Day results app is created. - For example: &lt;https://testdays.fedoraproject.org/events/131&gt; - [ ] Choose a day during the Test Week to host a video session for live debug help (optional) - [ ] Setup a Google Meet or other video conference session (optional) - [ ] Create a HackMD doc for capturing notes during live video session (optional) - [ ] Find volunteers to enumerate new documentation + test cases required for Test Week - Best done via dedicated video session - [ ] File an issue on `podman` with TODO items. - For example: &lt;https://github.com/coreos/fedora-coreos-tracker/issues/1147&gt; - [ ] File a ticket requesting a Fedora badge is created - For example: &lt;https://pagure.io/fedora-badges/issue/871&gt; ## Announcing Test Week Should be completed after the Initial Tasks are done - [ ] Draft an email to &lt;podman@lists.fedoraproject.org&gt; and few other relevant announcing the Test Week - [ ] Include a link to the Fedora Wiki - [ ] Include a link to the Test Day results app - [ ] Include a link to `podman-issue-tracker` for Test Week - [ ] Include a link to the video conference - [ ] Include a link to the HackMD doc - [ ] Cross-post announcement email to discussion.fedoraproject.org with `#podman` tag and whatever fits fine - Example format: &lt;https://hackmd.io/lCrVoW_RSMCRf2neiGhiPg&gt; ## During Test Week - Monitor `podman` issue tracker for new issues reported as part of Test Week - Monitor #fedora-test-day #podman on IRC for new issues reported as part of Test Week - Ensure there is one or more representatives of Podman team present ## After Test Week - [ ] Update `podman` ticket with any issues found - [ ] Update `podman` issue tracker ticket with any documentation updates made - [ ] Review Test Day results app and follow-up on any errors reported, if possible - [ ] Follow up with the Fedora Badges ticket with Fedora Account System (FAS) usernames that participated in Test Week</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>127</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #18268 from edsantiago/bindingtest_fail_early bindings tests: bail out early on image errors</MESSAGE>
    <SHA>911be1cbcb0ad654a8e10666262bdcee50ee54e0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>libpod: stop containers with --restart=always Commit 1ab833fb73 improved the situation but it is still not enough. If you run short lived containers with --restart=always podman is basically permanently restarting them. To only way to stop this is podman stop. However podman stop does not do anything when the container is already in a not running state. While this makes sense we should still mark the container as explicitly stopped by the user. Together with the change in shouldRestart() which now checks for StoppedByUser this makes sure the cleanup process is not going to start it back up again. A simple reproducer is: ``` podman run --restart=always --name test -d alpine true podman stop test ``` then check if the container is still running, the behavior is very flaky, it took me like 20 podman stop tries before I finally hit the correct window were it was stopped permanently. With this patch it worked on the first try. Fixes #18259 [NO NEW TESTS NEEDED] This is super flaky and hard to correctly test in CI. MY ginkgo v2 work seems to trigger this in play kube tests so that should catch at least some regressions. Also this may be something that should be tested at podman test days by users (#17912). Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>edb64f8a768e28352e43578fcf2ad8c209689ea9</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container_api.go</FILE>
        <FILE>libpod/container_internal.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>libpod: stop containers with --restart=always Commit 1ab833fb73 improved the situation but it is still not enough. If you run short lived containers with --restart=always podman is basically permanently restarting them. To only way to stop this is podman stop. However podman stop does not do anything when the container is already in a not running state. While this makes sense we should still mark the container as explicitly stopped by the user. Together with the change in shouldRestart() which now checks for StoppedByUser this makes sure the cleanup process is not going to start it back up again. A simple reproducer is: ``` podman run --restart=always --name test -d alpine true podman stop test ``` then check if the container is still running, the behavior is very flaky, it took me like 20 podman stop tries before I finally hit the correct window were it was stopped permanently. With this patch it worked on the first try. Fixes #18259 [NO NEW TESTS NEEDED] This is super flaky and hard to correctly test in CI. MY ginkgo v2 work seems to trigger this in play kube tests so that should catch at least some regressions. Also this may be something that should be tested at podman test days by users (#17912). Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>9558af2c4cd55744ffc19fb8d0b1f40abc3ba290</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container_api.go</FILE>
        <FILE>libpod/container_internal.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
