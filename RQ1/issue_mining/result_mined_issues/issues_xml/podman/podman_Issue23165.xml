<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>23165</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/23165</ISSUEURL>
  <TITLE>podman events --since=&quot;nonsense&quot; is nondeterministic</TITLE>
  <DESCRIPTION>It will sometimes succeed! ```console $ t0=$SECONDS;i=0;while :;do i=$((i+1));bin/podman events --since=&quot;the dawn of time...ish&quot; &amp;&amp; break;done;printf &quot;%d seconds, %d tries\n&quot; $((SECONDS-$t0)) $i ... Error: failed to parse event filters: unable to convert since time of the dawn of time...ish: unable to interpret time value 74 seconds, 3674 tries ``` And sometimes that will continue looping forever (or five minutes, which is ~equivalent). I have no idea what makes it &quot;succeed&quot;. And, given a loop exit, no idea what to do to investigate.</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>2</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #23157 from cevich/update_non-beta_civm Update CI VM images</MESSAGE>
    <SHA>b5bfd7233b1a3d500f0df1968dfcc2bd5c3c30ce</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>podman events: fix error race The events code makes use of two channels, one for the events and one for the resulting error. Then in the main file we have a loop reading from both channels that should exit on first error it gets. However in case the event channel is closed before the error channel cotains the error it could caused an early exit as it looked like all events were done. Commit c46884aa93 fixed that somewhat by checking for an error in the error channel before exiting. This however was still racy as it added a default case in the select which means the channel check is non blocking. Thus the error was not yet send into the channel. To fix this we should make it a blocking read to wait for the error in the channel. Also the err != nil check can be removed as we either return err or nil anyway. And as last step make sure the error channel is closed, that prevents us from blocking forever in case the main select already processed the nil error. Fixes #23165 Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>d00e68e55069216cd1022d1f304d24db379607ca</SHA>
      <PATCHEDFILES>
        <FILE>cmd/podman/system/events.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
