<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>15869</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/15869</ISSUEURL>
  <TITLE>podman save cli doesn't support --signature-policy</TITLE>
  <DESCRIPTION>&lt;!-- --------------------------------------------------- BUG REPORT INFORMATION --------------------------------------------------- Use the commands below to provide key information from your environment: You do NOT have to include this information if this is a FEATURE REQUEST **NOTE** A large number of issues reported against Podman are often found to already be fixed in more current versions of the project. Before reporting an issue, please verify the version you are running with `podman version` and compare it to the latest release documented on the top of Podman's [README.md](../README.md). If they differ, please update your version of Podman to the latest possible and retry your command before creating an issue. Also, there is a running list of known issues in the [Podman Troubleshooting Guide](https://github.com/containers/podman/blob/main/troubleshooting.md), please reference that page before opening a new issue. If you are filing a bug against `podman build`, please instead file a bug against Buildah (https://github.com/containers/buildah/issues). Podman build executes Buildah to perform container builds, and as such the Buildah maintainers are best equipped to handle these bugs. --&gt; **Is this a BUG REPORT or FEATURE REQUEST? (leave only one on its own line)** /kind bug It is not possible to use custom signature-policy files with `podman save` in the similar manner to other cli commands like `podman load`, `podman pull`, .... This effectively means without a default `/etc/containers/policy.json` the `podman save` fails. ``` Error: open /etc/containers/policy.json: no such file or directory ``` &lt;!-- Briefly describe the problem you are having in a few paragraphs. --&gt; **Steps to reproduce the issue:** 1. Remove `/etc/containers/policy.json` 2. Use `podman save ...` `podman save` should support `--signature-policy`. **Output of `podman version`:** ``` podman version 4.3.0-dev ``` **Output of `podman info`:** ``` host: arch: amd64 buildahVersion: 1.28.0-dev cgroupControllers: - cpuset - cpu - cpuacct - blkio - memory - devices - freezer - net_cls - perf_event - net_prio - pids cgroupManager: systemd cgroupVersion: v1 conmon: package: conmon-2.0.27+git0+3efab3e71c-r0.core2_64 path: /usr/bin/conmon version: 'conmon version 2.0.28-dev, commit: 3efab3e71c4c29f127cd7b8e8a5a885fc17dec88' cpuUtilization: idlePercent: 94.95 systemPercent: 1.46 userPercent: 3.6 cpus: 6 distribution: distribution: mbient version: &quot;1.0&quot; eventLogger: file hostname: qemux86-64 idMappings: gidmap: null uidmap: null kernel: 5.4.178-yocto-standard linkmode: dynamic logDriver: k8s-file memFree: 8516308992 memTotal: 22189408256 networkBackend: cni ociRuntime: name: crun package: crun-0.18+gitf302dd8c02c6fddd2c50d1685d82b7a19aae8afe-r0.core2_64 path: /usr/bin/crun version: |- crun version 0.19.5-f302 commit: f302dd8c02c6fddd2c50d1685d82b7a19aae8afe spec: 1.0.0 +SYSTEMD +SELINUX +APPARMOR +CAP +SECCOMP +EBPF +YAJL os: linux remoteSocket: path: /run/podman/podman.sock security: apparmorEnabled: true capabilities: CAP_AUDIT_WRITE,CAP_CHOWN,CAP_DAC_OVERRIDE,CAP_FOWNER,CAP_FSETID,CAP_KILL,CAP_MKNOD,CAP_NET_BIND_SERVICE,CAP_NET_RAW,CAP_SETFCAP,CAP_SETGID,CAP_SETPCAP,CAP_SETUID,CAP_SYS_CHROOT rootless: false seccompEnabled: true seccompProfilePath: &quot;&quot; selinuxEnabled: false serviceIsRemote: false slirp4netns: executable: /usr/bin/slirp4netns package: slirp4netns-0.4.1-r0.core2_64 version: |- slirp4netns version 0.4.1 commit: unknown swapFree: 46133248 swapTotal: 46133248 uptime: 6h 13m 12.00s (Approximately 0.25 days) plugins: authorization: null log: - k8s-file - none - passthrough - journald network: - bridge - macvlan - ipvlan volume: - local registries: search: - docker.io - registry.fedoraproject.org - quay.io - registry.access.redhat.com - registry.centos.org store: configFile: /etc/containers/storage.conf containerStore: number: 5 paused: 0 running: 0 stopped: 5 graphDriverName: overlay graphOptions: overlay.mountopt: nodev graphRoot: &lt;removed&gt; graphRootAllocated: 4093313024 graphRootUsed: 38490112 graphStatus: Backing Filesystem: extfs Native Overlay Diff: &quot;true&quot; Supports d_type: &quot;true&quot; Using metacopy: &quot;false&quot; imageCopyTmpDir: /var/tmp imageStore: number: 2 runRoot: /var/run/containers/storage volumePath: &lt;removed&gt; version: APIVersion: 4.3.0-dev Built: 1663677023 BuiltTime: Tue Sep 20 14:30:23 2022 GitCommit: 2e3967be2fa368e5b6dbcbc0080f7f9ffd99b8bc GoVersion: go1.19 Os: linux OsArch: linux/amd64 Version: 4.3.0-dev ``` **Have you tested with the latest version of Podman and have you checked the Podman Troubleshooting Guide? (https://github.com/containers/podman/blob/main/troubleshooting.md)** Yes</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>2</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #15859 from edsantiago/docs_format_events [CI:DOCS] man pages: document some --format options</MESSAGE>
    <SHA>30231d0da7e6dcf3d6d1f45b10150baae35aaf28</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>cli: Add signature-policy flag to podman save Allow overwrite of the signature-policy file by passing signature-policy flag to podman save command Closes: https://github.com/containers/podman/issues/15869 Signed-off-by: Mostafa Emami &lt;mustafaemami@gmail.com&gt;</MESSAGE>
      <SHA>33c31112fb44da455b8841b73a92980a07f42720</SHA>
      <PATCHEDFILES>
        <FILE>cmd/podman/images/save.go</FILE>
        <FILE>pkg/domain/entities/images.go</FILE>
        <FILE>pkg/domain/infra/abi/images.go</FILE>
        <FILE>test/e2e/save_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
