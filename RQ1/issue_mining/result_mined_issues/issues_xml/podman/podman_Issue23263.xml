<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>23263</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/23263</ISSUEURL>
  <TITLE>CI: network bind: timeout</TITLE>
  <DESCRIPTION>New flake, started July 11, same day as my local-registry PR (not sure if related, but it seems suspicious). Mostly in `network bind to 127.0.0.1` test: ``` # podman-remote [options] run --network slirp4netns:outbound_addr=127.0.0.1,allow_host_loopback=true -dt quay.io/libpod/alpine:latest nc -w 2 10.0.2.2 5546 b3a860c2439c32a2ee2f4a363ae08e813f8223bac6148d8a6ad5396390ef999b Ncat: Version 7.95 ( https://nmap.org/ncat ) Ncat: Listening on [::]:5546 Ncat: Listening on 0.0.0.0:5546 [FAILED] Timed out after 90.001s. command timed out after 90s: [nc -v -n -l -p 5546] STDOUT: STDERR: Ncat: Version 7.95 ( https://nmap.org/ncat ) Ncat: Listening on [::]:5546 Ncat: Listening on 0.0.0.0:5546 Expected process to exit. It did not. ``` ...but also in a kube test (weirdly, in `pod rm`): ``` # podman-remote [options] pod rm -fa -t 0 [FAILED] Timed out after 90.001s. command timed out after 90s: [/var/tmp/go/src/github.com/containers/podman/bin/podman-remote --remote --url unix:///run/podman/podman-6f170c3cdcc4e5cc9207eaf41298d418fd0cb7f904ae8be3f5ec412f2a5909b0.sock pod rm -fa -t 0] STDOUT: STDERR: Expected process to exit. It did not. ``` Only common factor is `root`. My go-to when I see socket hangs is &quot;somehow I've mixed CNI and netavark&quot;. It's possible that my local-registry work is doing that because it uses system-installed podman. But, even on f40 and rawhide? And it seems weird, because that tends to hang EVERYTHING, not just intermittent. I will look into it on Monday. * ~~debian-13 : int remote debian-13 root host sqlite [remote]~~ * ~~[07-11 23:13](https://api.cirrus-ci.com/v1/artifact/task/5213561172000768/html/int-remote-debian-13-root-host-sqlite.log.html#t--Podman-kube-play-test-with-annotation-size-within-limits--1) in TOP-LEVEL [AfterEach] Podman kube play test with annotation size within limits~~ * fedora-39 : int remote fedora-39 root host boltdb [remote] * [07-12 10:23](https://api.cirrus-ci.com/v1/artifact/task/6248076254380032/html/int-remote-fedora-39-root-host-boltdb.log.html#t--Podman-kube-play-test-with-annotation-size-within-limits--1) in TOP-LEVEL [AfterEach] Podman kube play test with annotation size within limits * fedora-40 : int podman fedora-40 root host sqlite * [07-11 23:14](https://api.cirrus-ci.com/v1/artifact/task/6198723590488064/html/int-podman-fedora-40-root-host-sqlite.log.html#t--Podman-run-networking-podman-run-network-bind-to-HostIP--1) in Podman run networking podman run network bind to HostIP * [07-11 23:14](https://api.cirrus-ci.com/v1/artifact/task/6198723590488064/html/int-podman-fedora-40-root-host-sqlite.log.html#t--Podman-run-networking-podman-run-network-bind-to-127-0-0-1--1) in Podman run networking podman run network bind to 127.0.0.1 * fedora-40 : int remote fedora-40 root host sqlite [remote] * [07-11 23:14](https://api.cirrus-ci.com/v1/artifact/task/6480198567198720/html/int-remote-fedora-40-root-host-sqlite.log.html#t--Podman-run-networking-podman-run-network-bind-to-127-0-0-1--1) in Podman run networking podman run network bind to 127.0.0.1 * rawhide : int podman rawhide root host sqlite * [07-11 23:15](https://api.cirrus-ci.com/v1/artifact/task/5917248613777408/html/int-podman-rawhide-root-host-sqlite.log.html#t--Podman-run-networking-podman-run-network-bind-to-127-0-0-1--1) in Podman run networking podman run network bind to 127.0.0.1 * rawhide : int remote rawhide root host sqlite [remote] * [07-12 10:23](https://api.cirrus-ci.com/v1/artifact/task/4840701370826752/html/int-remote-rawhide-root-host-sqlite.log.html#t--Podman-run-networking-podman-run-network-bind-to-127-0-0-1--1) in Podman run networking podman run network bind to 127.0.0.1 * [07-11 23:15](https://api.cirrus-ci.com/v1/artifact/task/5776511125422080/html/int-remote-rawhide-root-host-sqlite.log.html#t--Podman-run-networking-podman-run-network-bind-to-127-0-0-1--1) in Podman run networking podman run network bind to 127.0.0.1 | x | x | x | x | x | x | | ---: | ---: | ---: | ---: | ---: | ---: | | int(8) | remote(5) | rawhide(3) | root(8) | host(8) | sqlite(7) | | | podman(3) | fedora-40(3) | | | boltdb(1) | | | | fedora-39(1) | | | |</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>9</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #23357 from Luap99/pod-stats-err podman pod stats: fix race when ctr process exits</MESSAGE>
    <SHA>d62ef3fb212255a50563d9b8f69f684199f2da9e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>test/e2e: fix ncat tests These tests are flaking for unknown reasons. One problem could be ncat did not bound the port before we connect to it. Simple fix do not use ncat and just use the golang API to listen on the port without the extra ncat process. This should be race free in theory. Also do not run the nc container in the background, we want to see the errors from the ncat process in the container. And because both tests do the same thing deduplicate them into one that just uses a loop to create both tests. Fixes #23263 Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>52094958651f697cba24dca50b4f370e15cf8396</SHA>
      <PATCHEDFILES>
        <FILE>test/e2e/run_networking_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
