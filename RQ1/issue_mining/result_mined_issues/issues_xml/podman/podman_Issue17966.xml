<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>17966</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/17966</ISSUEURL>
  <TITLE>e2e: sign image: Unexpected error: can't connect to the gpg-agent</TITLE>
  <DESCRIPTION>``` podman sign image ... Unexpected error: &lt;*exec.ExitError | 0xc0019f86c0&gt;: exit status 2 { ProcessState: { pid: 130096, status: 512, rusage: { Utime: {Sec: 0, Usec: 6129}, Stime: {Sec: 0, Usec: 10342}, Maxrss: 62000, Ixrss: 0, Idrss: 0, Isrss: 0, Minflt: 603, Majflt: 5, Nswap: 0, Inblock: 520, Oublock: 56, Msgsnd: 0, Msgrcv: 0, Nsignals: 0, Nvcsw: 34, Nivcsw: 15, }, }, Stderr: nil, } ``` the ginkgo line seems to be https://github.com/containers/podman/blob/a91cde637ee2b4f6e8db60147b2f46e6fe482476/test/e2e/image_sign_test.go#L48-L50 There's no useful output or any indication of what the error actually is, but I'm going to guess that this is another contention bug which needs to be addressed either via locking or via `$GNUPGHOME` or `--homedir` ### Podman image sign [It] podman sign image * fedora-37 : int podman fedora-37 rootless host sqlite * PR #17831 * [03-28 11:07](https://api.cirrus-ci.com/v1/artifact/task/5086792181874688/html/int-podman-fedora-37-rootless-host-sqlite.log.html#t--podman-sign-image--1) * [03-28 08:35](https://api.cirrus-ci.com/v1/artifact/task/6151518533976064/html/int-podman-fedora-37-rootless-host-sqlite.log.html#t--podman-sign-image--1) * [03-27 21:56](https://api.cirrus-ci.com/v1/artifact/task/5731587032088576/html/int-podman-fedora-37-rootless-host-sqlite.log.html#t--podman-sign-image--1)</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>48</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #17959 from vrothberg/fix-17607 auto-update: stop+start instead of restart sytemd units</MESSAGE>
    <SHA>d29a85b80e44825ea6c2858a5acb39f2f03b8d06</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>test/e2e: gpg keep stdout/err attached By default go will not keep the stdout/err attach when executing commands via exec.Command(). It is required to explicitly pass the current stdout/err fds down to the child so we can see the error output in the logs to debug #17966. Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>c40eaa2423e06988b1885f6cc06b7c6d5d4b8a9c</SHA>
      <PATCHEDFILES>
        <FILE>test/e2e/image_sign_test.go</FILE>
        <FILE>test/e2e/save_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>e2e: serialize gpg tests Reason: gpg tests all run with a different GNUPGHOME, and gpg-agent does not like that, and there's no longer any way to run gpg without the agent. So, do not run these tests in parallel, and clean up agent after each test. Fixes: #17966 (I hope) May also fix #18358 but it will take some time to be sure. Signed-off-by: Ed Santiago &lt;santiago@redhat.com&gt;</MESSAGE>
      <SHA>a485ba505a60d9fc6c608e51b5d740d6695b0183</SHA>
      <PATCHEDFILES>
        <FILE>test/e2e/image_sign_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
