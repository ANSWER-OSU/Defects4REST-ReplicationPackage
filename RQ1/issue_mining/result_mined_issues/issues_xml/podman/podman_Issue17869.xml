<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>17869</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/17869</ISSUEURL>
  <TITLE>Stats response has `&quot;Id&quot;` field instead of `&quot;id&quot;`</TITLE>
  <DESCRIPTION>### Issue Description The stats API JSON response is inconsistent with Docker, because it incorrectly capitalises the `&quot;id&quot;` field. I discovered this when using the Rust crate [Bollard](https://github.com/fussybeaver/bollard), which reported that the `&quot;id&quot;` field was missing. ### Steps to reproduce the issue 1. ```sh curl --unix-socket /var/run/docker.sock &quot;http://d/containers/$SOME_CONTAINER_ID/stats&quot; # {...,&quot;id&quot;:&quot;...&quot;,...} ``` 2. ```sh curl --unix-socket /run/user/1000/podman/podman.sock &quot;http://d/containers/$SOME_CONTAINER_ID/stats&quot; # {...,&quot;Id&quot;:&quot;...&quot;,...} ``` ### Describe the results you received JSON response contains `&quot;Id&quot;` field, but no `&quot;id&quot;`. ### Describe the results you expected JSON response should contain `&quot;id&quot;` field. ### podman info output ```yaml host: arch: amd64 buildahVersion: 1.29.0 cgroupControllers: - cpu - memory - pids cgroupManager: systemd cgroupVersion: v2 conmon: package: /usr/bin/conmon is owned by conmon 1:2.1.7-1 path: /usr/bin/conmon version: 'conmon version 2.1.7, commit: f633919178f6c8ee4fb41b848a056ec33f8d707d' cpuUtilization: idlePercent: 79.35 systemPercent: 5.16 userPercent: 15.48 cpus: 8 distribution: distribution: arch version: unknown eventLogger: journald hostname: REDACTED idMappings: gidmap: - container_id: 0 host_id: 1000 size: 1 - container_id: 1 host_id: 100000 size: 65536 uidmap: - container_id: 0 host_id: 1000 size: 1 - container_id: 1 host_id: 100000 size: 65536 kernel: 6.2.6-arch1-1 linkmode: dynamic logDriver: journald memFree: 813850624 memTotal: 24844115968 networkBackend: netavark ociRuntime: name: crun package: /usr/bin/crun is owned by crun 1.8.1-1 path: /usr/bin/crun version: |- crun version 1.8.1 commit: f8a096be060b22ccd3d5f3ebe44108517fbf6c30 rundir: /run/user/1000/crun spec: 1.0.0 +SYSTEMD +SELINUX +APPARMOR +CAP +SECCOMP +EBPF +CRIU +YAJL os: linux remoteSocket: exists: true path: /run/user/1000/podman/podman.sock security: apparmorEnabled: false capabilities: CAP_CHOWN,CAP_DAC_OVERRIDE,CAP_FOWNER,CAP_FSETID,CAP_KILL,CAP_NET_BIND_SERVICE,CAP_SETFCAP,CAP_SETGID,CAP_SETPCAP,CAP_SETUID,CAP_SYS_CHROOT rootless: true seccompEnabled: true seccompProfilePath: /etc/containers/seccomp.json selinuxEnabled: false serviceIsRemote: false slirp4netns: executable: /usr/bin/slirp4netns package: /usr/bin/slirp4netns is owned by slirp4netns 1.2.0-1 version: |- slirp4netns version 1.2.0 commit: 656041d45cfca7a4176f6b7eed9e4fe6c11e8383 libslirp: 4.7.0 SLIRP_CONFIG_VERSION_MAX: 4 libseccomp: 2.5.4 swapFree: 34215489536 swapTotal: 34359734272 uptime: 140h 28m 48.00s (Approximately 5.83 days) plugins: authorization: null log: - k8s-file - none - passthrough - journald network: - bridge - macvlan volume: - local registries: {} store: configFile: /home/REDACTED/.config/containers/storage.conf containerStore: number: 8 paused: 0 running: 8 stopped: 0 graphDriverName: overlay graphOptions: {} graphRoot: /home/REDACTED/.local/share/containers/storage graphRootAllocated: 476673212416 graphRootUsed: 276004855808 graphStatus: Backing Filesystem: f2fs Native Overlay Diff: &quot;true&quot; Supports d_type: &quot;true&quot; Using metacopy: &quot;false&quot; imageCopyTmpDir: /var/tmp imageStore: number: 202 runRoot: /run/user/1000/containers transientStore: false volumePath: /home/REDACTED/.local/share/containers/storage/volumes version: APIVersion: 4.4.2 Built: 1677255177 BuiltTime: Fri Feb 24 17:12:57 2023 GitCommit: 74afe26887f814d1c39925a1624851ef3590e79c-dirty GoVersion: go1.20.1 Os: linux OsArch: linux/amd64 Version: 4.4.2 ``` ### Podman in a container No ### Privileged Or Rootless Rootless ### Upstream Latest Release Yes ### Additional environment details _No response_ ### Additional information _No response_</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>2</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #17855 from edsantiago/logformatter_db_backend logformatter: hide --db-backend</MESSAGE>
    <SHA>74c5a013cba0ffc8b4d577b31b4323aa5109b65b</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Use lowercase &quot;id&quot; in stats API, for Docker compatibility Fixes #17869 [NO NEW TESTS NEEDED] Signed-off-by: Kieren Davies &lt;kieren@kdavi.es&gt;</MESSAGE>
      <SHA>677494937543eec2e4c808cc055348063879b347</SHA>
      <PATCHEDFILES>
        <FILE>pkg/api/handlers/compat/types.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>stats compat API: return &quot;id&quot; lowercase We use the same endpoint for libpod and docker compat API. However as reported docker returns &quot;id&quot; lowercase. Because we cannot break the libpod API right now keep the output for the libpod endpoint and only change the docker one. To do so simply use two types that we can cast with different JSON tags. Fixes #17869 Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>5185e7e39eea1882b8b6ca7dc7b98d5dd5fe3c5d</SHA>
      <PATCHEDFILES>
        <FILE>pkg/api/handlers/compat/containers_stats.go</FILE>
        <FILE>pkg/api/handlers/compat/types.go</FILE>
        <FILE>test/apiv2/20-containers.at</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
