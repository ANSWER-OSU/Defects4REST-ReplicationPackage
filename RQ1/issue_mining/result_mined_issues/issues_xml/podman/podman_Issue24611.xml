<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>24611</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/24611</ISSUEURL>
  <TITLE>Test failure: podman image-volume: ext2/ext3/ext4 mismatch</TITLE>
  <DESCRIPTION>Pretty sure this is a logic failure in the test itself. It dates back to #22831. It fails on 1mt, but (apparently???) never in CI or gating: ``` âœ— [160] podman --image-volume ... [10:55:02.588334219] # podman run --image-volume anonymous --rm volume_image sh -c grep ' /data ' /proc/mounts | cut -f3 -d' ' [10:55:02.979190999] ext4 #/vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv #| FAIL: Should match hosts graphroot fs #| expected: ext2/ext3 #| actual: ext4 ``` The test code is hard to read, but here's a simple reproducer: ```console # stat -f $(podman info --format '{{.Store.GraphRoot}}') File: &quot;/var/lib/containers/storage&quot; ID: 1f1c00f584175bfd Namelen: 255 Type: ext2/ext3 &lt;&lt;&lt;&lt;&lt; MAKE A NOTE OF THIS Block size: 4096 Fundamental block size: 4096 Blocks: Total: 5135280 Free: 4533086 Available: 4303610 Inodes: Total: 1310720 Free: 1222081 # printf &quot;FROM quay.io/libpod/testimage:20241011\nVOLUME /data\n&quot; | podman build -t foo -q - c8ccb37ea0b143024cf17dee633b6a2fd05d11f2b1f9d0d904c78a2ac173e6e2 # podman run --rm foo stat -f /data File: &quot;/data&quot; ID: 1f1c00f584175bfd Namelen: 255 Type: ext2/ext3 &lt;&lt;&lt;&lt; SAME Block size: 4096 Blocks: Total: 5135280 Free: 4533059 Available: 4303583 Inodes: Total: 1310720 Free: 1222055 # podman run --rm foo grep ' /data ' /proc/mounts /dev/vda2 /data ext4 rw,seclabel,nosuid,nodev,relatime 0 0 ^^^^------ OH NOES ``` Ed's tentative conclusion: we can't compare apples (output of `stat`) and oranges (`/proc/mounts` which comes from the kernel). Fix in progress.</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #24561 from containers/renovate/google.golang.org-protobuf-1.x fix(deps): update module google.golang.org/protobuf to v1.35.2</MESSAGE>
    <SHA>569fefc78319e3faa77ebf917ab7a94bd770bdda</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>CI: --image-volume test: robustify Test is failing on 1mt because of differences between 'stat' command output and /proc/mounts. Solution: compare stat %t (hex filesystem type), not %T (human-readable). This should match no matter what kernel version or version of stat on host/container. Fixes: #24611 Signed-off-by: Ed Santiago &lt;santiago@redhat.com&gt;</MESSAGE>
      <SHA>97ed067d1af60c947ea68270a3abcaa29102197f</SHA>
      <PATCHEDFILES>
        <FILE>test/system/160-volumes.bats</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
