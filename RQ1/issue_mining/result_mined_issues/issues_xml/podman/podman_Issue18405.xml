<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>18405</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/18405</ISSUEURL>
  <TITLE>podman run, with nonexistent $REGISTRY_AUTH_FILE, fails with ENOENT</TITLE>
  <DESCRIPTION>```console $ REGISTRY_AUTH_FILE=/tmp/nonexistent.json bin/podman run quay.io/libpod/testimage:20221018 date Error: stat /tmp/nonexistent.json: no such file or directory ``` podman `create` and `info` work fine.</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>87</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #18376 from Luap99/swagger-info [CI:DOCS] swagger: fix Info name conflict</MESSAGE>
    <SHA>3f5f90690347624c4027d1c7348af64e71bc6658</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>podman run --authfile do not stat file No other commands do this, it makes no sense to fail hard if the given authfile does not exists. We do not even know if we have to pull anything at that point. I expect the code to error at some later point if the auth file is really needed but does not exists. Fixes #18405 Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>7591f96f38ceb1b2bfcab68833135589bd3ab7c4</SHA>
      <PATCHEDFILES>
        <FILE>cmd/podman/containers/run.go</FILE>
        <FILE>test/e2e/login_logout_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>System tests: missing authfile: also check envariable Followup to #19348 and #19374: the new existence check also works when REGISTRY_AUTH_FILE points to a nonexistent file. (Except for &quot;podman build&quot;). Add tests. It is not clear to me that this is desirable behavior (see #18405), but it seems too late to change it. Signed-off-by: Ed Santiago &lt;santiago@redhat.com&gt;</MESSAGE>
      <SHA>f74d257c11ede2faa476e5ffa6f03b9dbd383482</SHA>
      <PATCHEDFILES>
        <FILE>test/system/030-run.bats</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Make sure users changes --authfile before checking In certain cases REGISTRY_AUTH_FILE is set but the auth file does not exists yet, do not throw error unless user specified a file directly using --authfile. Fixes: https://github.com/containers/podman/issues/18405 Signed-off-by: Daniel J Walsh &lt;dwalsh@redhat.com&gt;</MESSAGE>
      <SHA>f540bbffa8c1fb2512c808b7cc3a9d5b08c0a4db</SHA>
      <PATCHEDFILES>
        <FILE>cmd/podman/auto-update.go</FILE>
        <FILE>cmd/podman/containers/create.go</FILE>
        <FILE>cmd/podman/containers/run.go</FILE>
        <FILE>cmd/podman/containers/runlabel.go</FILE>
        <FILE>cmd/podman/images/build.go</FILE>
        <FILE>cmd/podman/images/pull.go</FILE>
        <FILE>cmd/podman/images/push.go</FILE>
        <FILE>cmd/podman/images/search.go</FILE>
        <FILE>cmd/podman/images/sign.go</FILE>
        <FILE>cmd/podman/kube/play.go</FILE>
        <FILE>cmd/podman/manifest/add.go</FILE>
        <FILE>cmd/podman/manifest/inspect.go</FILE>
        <FILE>cmd/podman/manifest/push.go</FILE>
        <FILE>test/system/030-run.bats</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
