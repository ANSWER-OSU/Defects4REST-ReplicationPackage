<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>15109</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/15109</ISSUEURL>
  <TITLE>&quot;podman manifest push&quot; should accept the --compression-format=format flag, like &quot;podman image push&quot; does</TITLE>
  <DESCRIPTION>**Is this a BUG REPORT or FEATURE REQUEST? (leave only one on its own line)** /kind bug **Description** All is in the title: `podman manifest push` should accept the `--compression-format=format` flag, like `podman image push` does. I am in a scenario where I attempt to push a multi-arch image into our own docker registry, using the experimental `zstd:chunked` compression. The images are pushed implicitly to the registry at the same as the manifest is pushed (ie we use the default behavior of flag `--all` to push the images at the same time). **Describe the results you received:** `Error: unknown flag: --compression-format` **Describe the results you expected:** Push should work, and the chosen compression (in our case `zstd:chunked`) shall be used for all the pushed images of the manifest list. **Additional information you deem important (e.g. issue happens only occasionally):** **Output of `podman version`:** Like most of my bug report, I tried it with the image `quay.io/podman/upsteam`: ``` [root@842fc1ace592 /]# podman version Client: Podman Engine Version: 4.2.0-dev API Version: 4.2.0-dev Go Version: go1.18.4 Built: Thu Jan 1 00:00:00 1970 OS/Arch: linux/amd64 ``` **Have you tested with the latest version of Podman and have you checked the Podman Troubleshooting Guide? (https://github.com/containers/podman/blob/main/troubleshooting.md)** Yes **Additional environment details (AWS, VirtualBox, physical, etc.):** FYI, it seems the support for this compression flag in `podman image push` was added by this pull request: https://github.com/containers/podman/pull/12450/files from which one might be inspired to add it in `podman manifest push` as well. Cheers, Romain</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>3</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #15019 from containers/dependabot/go_modules/github.com/BurntSushi/toml-1.2.0 Bump github.com/BurntSushi/toml from 1.1.0 to 1.2.0</MESSAGE>
    <SHA>fed326d8a6f8d4f7dc490099b29d51fc1754789f</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add flag &quot;--compression-format&quot; to &quot;podman manifest push&quot; both in local/remote mode. Also Fix usage of flag &quot;--compression-format&quot; for remote &quot;podman image push&quot;. Fix usage of flags &quot;--format&quot;, &quot;--remove-signatures&quot; in remote &quot;podman manifest push&quot;. Closes #15109. Signed-off-by: Romain Geissler &lt;romain.geissler@amadeus.com&gt;</MESSAGE>
      <SHA>24a599fe1d8f7f9da23cf3056c4eda8bcc89e563</SHA>
      <PATCHEDFILES>
        <FILE>cmd/podman/manifest/push.go</FILE>
        <FILE>docs/source/markdown/podman-manifest-push.1.md</FILE>
        <FILE>docs/source/markdown/podman-push.1.md</FILE>
        <FILE>pkg/api/handlers/libpod/images_push.go</FILE>
        <FILE>pkg/api/handlers/libpod/manifests.go</FILE>
        <FILE>pkg/bindings/images/types.go</FILE>
        <FILE>pkg/bindings/images/types_push_options.go</FILE>
        <FILE>pkg/domain/infra/abi/manifest.go</FILE>
        <FILE>pkg/domain/infra/tunnel/images.go</FILE>
        <FILE>pkg/domain/infra/tunnel/manifest.go</FILE>
        <FILE>test/e2e/manifest_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
