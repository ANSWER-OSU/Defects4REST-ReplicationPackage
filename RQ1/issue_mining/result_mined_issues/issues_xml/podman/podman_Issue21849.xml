<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>21849</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/21849</ISSUEURL>
  <TITLE>machine-linux: unable to load machine config file: &quot;unexpected end of JSON input&quot;</TITLE>
  <DESCRIPTION>Pretty sure I heard this one mentioned in scrum today, but there's no issue filed, so here's your tracker. ``` podman machine list list machine: check if running while starting ... podman-remote machine start 601893886e6c podman-remote machine list --format {{.LastUp}} Starting machine &quot;601893886e6c&quot; Error: unable to load machine config file: &quot;unexpected end of JSON input&quot; ``` * fedora-39 : machine-linux podman fedora-39 rootless host sqlite * PR #21838 * [02-27 07:05](https://api.cirrus-ci.com/v1/artifact/task/4595165407477760/html/machine-linux-podman-fedora-39-rootless-host-sqlite.log.html) in machine-linux podman fedora-39 rootless host sqlite: unknown failure * PR #21763 * [02-20 11:40](https://api.cirrus-ci.com/v1/artifact/task/4646925283098624/html/machine-linux-podman-fedora-39-rootless-host-sqlite.log.html) in machine-linux podman fedora-39 rootless host sqlite: unknown failure * PR #21684 * [02-18 11:22](https://api.cirrus-ci.com/v1/artifact/task/5120513140326400/html/machine-linux-podman-fedora-39-rootless-host-sqlite.log.html) in machine-linux podman fedora-39 rootless host sqlite: unknown failure</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #21572 from mheon/hyperv_9p_mkdir Ensure HyperV 9p mounts work when a dir doesn't exist</MESSAGE>
    <SHA>9d1704396a9e38abb3bcabe423ae89b4ef369fd3</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>machine config: make write atomic As indicated in #21849, loading the machine config can flake/fail with an EOF JSON error indicating an incomplete file. Address the issue by atomically writing the config. This way, it is not possible to load an incomplete or partially written file. The lock can be acquired later on to sync state. [NO NEW TESTS NEEDED] as it's a hard-to-hit race. Fixes: #21849 Signed-off-by: Valentin Rothberg &lt;vrothberg@redhat.com&gt;</MESSAGE>
      <SHA>f8abd7ff751a0ee40c4b75535d6d579494b5d34e</SHA>
      <PATCHEDFILES>
        <FILE>pkg/machine/vmconfigs/machine.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
