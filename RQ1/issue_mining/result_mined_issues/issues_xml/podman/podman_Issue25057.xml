<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>25057</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/25057</ISSUEURL>
  <TITLE>CI: podman machine test timeouts</TITLE>
  <DESCRIPTION>We noticed a lot of tasks are failing because they run into their timeout. One small problem I noticed we are pulling a huge disk image from quay.io every time which is slow and known to be flaky in a single test https://github.com/containers/podman/blob/d4fce5178f238d2480ed1e1a636917d25de2bb29/pkg/machine/e2e/list_test.go#L195-L199 Another thing I saw in only one log I looked at: ``` /Users/MacM1-3-worker/ci/task-4701288484569088/bin/darwin/podman machine init --disk-size 11 --image /private/tmp/ci/podman-machine.aarch64.applehv.raw b8936d90850f Machine init complete To start your machine run: podman machine start b8936d90850f /Users/MacM1-3-worker/ci/task-4701288484569088/bin/darwin/podman machine set b8936d90850f /Users/MacM1-3-worker/ci/task-4701288484569088/bin/darwin/podman machine start b8936d90850f Starting machine &quot;b8936d90850f&quot; This machine is currently configured in rootless mode. If your containers require root permissions (e.g. ports &lt; 1024), or if you run into compatibility issues with non-podman clients, you can switch using the following command: podman machine set --rootful b8936d90850f Error: machine did not transition into running state: ssh error: ssh: handshake failed: read tcp 127.0.0.1:56378-&gt;127.0.0.1:56337: read: connection reset by peer [FAILED] Expected &lt;int&gt;: 125 to match exit code: &lt;int&gt;: 0 In [It] at: /Users/MacM1-3-worker/ci/task-4701288484569088/pkg/machine/e2e/set_test.go:113 @ 01/20/25 16:34:43.193 ``` https://api.cirrus-ci.com/v1/task/4701288484569088/logs/test.log Overall I don't see any changes in the test code that would explain anything. The only other thing is that we have newer disk images pushed by podman-machine-os so maybe they got slower somehow. I guess the only way to get things somewhat working again is to bump the timeout.</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>pkg/machine/e2e: improve podman.exe match The regex match would return a horrible error message and is way more complicated then it should be. Simply check that .exe is not part of the output. Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
    <SHA>4b7f6d82ba33923dce8d1bac51b06cf48d338124</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>cirrus: bump macos machine test timeout We see a ton of timeouts in bot the applehv and libkrun machine tests. It seems 35m are no longer enough. I was not able to spot anything that would explain why it increased all of the sudden as such I hope this is enough. Fixes #25057 Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>67dbb42cb4e72879d3c52fa21f011d44b8234a75</SHA>
      <PATCHEDFILES>
        <FILE>.cirrus.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>cirrus: bump macos machine test timeout We see a ton of timeouts in bot the applehv and libkrun machine tests. It seems 35m are no longer enough. I was not able to spot anything that would explain why it increased all of the sudden as such I hope this is enough. Fixes #25057 Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>6ee51c5e4fcc17b86388dba2bcd05b9f0f18b80d</SHA>
      <PATCHEDFILES>
        <FILE>.cirrus.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
