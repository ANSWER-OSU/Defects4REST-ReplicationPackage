<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>15006</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/15006</ISSUEURL>
  <TITLE>Impossible to delete an image</TITLE>
  <DESCRIPTION>/kind bug **Description** I have an image that I can't delete because Podman says it's currently in use by a container which does not exist. **Steps to reproduce the issue:** Unfortunately, I'm not sure how I ended up in this situation. **Additional information you deem important (e.g. issue happens only occasionally):** **Output of `podman version`:** ``` podman version  1 ✘  16m 26s  Client: Podman Engine Version: 4.1.1 API Version: 4.1.1 Go Version: go1.18.3 Built: Tue Jun 14 22:12:46 2022 OS/Arch: darwin/amd64 Server: Podman Engine Version: 4.0.2 API Version: 4.0.2 Go Version: go1.16.14 Built: Thu Mar 3 15:56:56 2022 OS/Arch: linux/amd64 ``` **Output of `podman images`:** ``` REPOSITORY TAG IMAGE ID CREATED SIZE docker.io/library/my-custom-image latest 5be24218919b 7 minutes ago 578 MB quay.io/podman/hello latest 9b0445929568 7 days ago 81.8 kB &lt;none&gt; &lt;none&gt; 1b6b53283e24 2 months ago 1.89 GB docker.io/library/httpd latest 6b8e87fff107 4 months ago 148 MB docker.io/bitnami/mariadb 10.5.9-debian-10-r0 2df089982a8d 17 months ago 336 MB quay.io/quarkus/centos-quarkus-maven 20.0.0-java11 b3e39ba63244 23 months ago 1.89 GB registry.access.redhat.com/ubi8/ubi-minimal 8.1-409 91d23a64fdf2 2 years ago 109 MB ``` **Output of `podman rmi`:** ``` podman rmi 1b6b53283e24  ✔  Error: Image used by 8ed9a6770b15351d30638e95729fe076d50ac89ac7ddfffa3efe3e855ac06506: image is in use by a container ``` **Output of `podman image inspect`:** ``` podman image inspect 1b6b53283e24  ✔  [ { &quot;Id&quot;: &quot;1b6b53283e24f83803da6d5a5418b528670ab7f159bf69f0f25ecfcb23f11cb4&quot;, &quot;Digest&quot;: &quot;sha256:02fc108b1fe31621897182b5832fb3bb33e94e4c30fdf8aa3deff9361257a3f0&quot;, &quot;RepoTags&quot;: [], &quot;RepoDigests&quot;: [], &quot;Parent&quot;: &quot;4ef0b4011cf5ed78d20756f707a073cce66f75bf1025e011faf7706e01a4bd59&quot;, &quot;Comment&quot;: &quot;&quot;, &quot;Created&quot;: &quot;2022-05-03T14:58:14.919087242Z&quot;, &quot;Config&quot;: { &quot;User&quot;: &quot;quarkus&quot;, &quot;ExposedPorts&quot;: { &quot;8080/tcp&quot;: {} }, &quot;Env&quot;: [ &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/graalvm/bin&quot;, &quot;LANG=en_US.UTF-8&quot;, &quot;LANGUAGE=en_US:en&quot;, &quot;LC_ALL=en_US.UTF-8&quot;, &quot;QUARKUS_HOME=/home/quarkus&quot;, &quot;MAVEN_HOME=/usr/share/maven&quot;, &quot;MAVEN_OPTS=-XX:+TieredCompilation -XX:TieredStopAtLevel=1&quot;, &quot;MAVEN_VERSION=3.6.3&quot;, &quot;GRADLE_HOME=/usr/share/gradle&quot;, &quot;GRADLE_OPTS=-Dorg.gradle.daemon=false&quot;, &quot;GRADLE_VERSION=6.3&quot;, &quot;FILENAME=graalvm-ce-linux-amd64-20.0.0-java11.tar.gz&quot;, &quot;GRAALVM_HOME=/opt/graalvm&quot;, &quot;GRAALVM_VERSION=java11-20.0.0&quot;, &quot;JAVA_HOME=/opt/graalvm&quot; ], &quot;Entrypoint&quot;: [ &quot;/usr/local/bin/entrypoint-run.sh&quot; ], &quot;Cmd&quot;: [ &quot;mvn&quot;, &quot;-v&quot; ], &quot;WorkingDir&quot;: &quot;/project&quot;, &quot;Labels&quot;: { &quot;graalvm-archive-filename&quot;: &quot;graalvm-ce-linux-amd64-20.0.0-java11.tar.gz&quot;, &quot;graalvm-archive-url&quot;: &quot;https://github.com/graalvm/graalvm-ce-builds/releases/download/vm-20.0.0/graalvm-ce-java11-linux-amd64-20.0.0.tar.gz&quot;, &quot;graalvm-version&quot;: &quot;java11-20.0.0&quot;, &quot;io.buildah.version&quot;: &quot;1.24.1&quot;, &quot;io.cekit.version&quot;: &quot;3.7.0&quot;, &quot;io.k8s.description&quot;: &quot;Quarkus.io builder image for building Quarkus applications.&quot;, &quot;io.k8s.display-name&quot;: &quot;Centos + GraalVM + Maven Image&quot;, &quot;io.openshift.expose-services&quot;: &quot;8080:http&quot;, &quot;io.openshift.tags&quot;: &quot;builder,java,quarkus&quot;, &quot;maintainer&quot;: &quot;Quarkus Team &lt;quarkus-dev@googlegroups.com&gt;&quot;, &quot;org.label-schema.build-date&quot;: &quot;20200809&quot;, &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;, &quot;org.label-schema.name&quot;: &quot;CentOS Base Image&quot;, &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;, &quot;org.label-schema.vendor&quot;: &quot;CentOS&quot;, &quot;org.opencontainers.image.created&quot;: &quot;2020-08-09 00:00:00+01:00&quot;, &quot;org.opencontainers.image.licenses&quot;: &quot;GPL-2.0-only&quot;, &quot;org.opencontainers.image.title&quot;: &quot;CentOS Base Image&quot;, &quot;org.opencontainers.image.vendor&quot;: &quot;CentOS&quot; } }, &quot;Version&quot;: &quot;&quot;, &quot;Author&quot;: &quot;&quot;, &quot;Architecture&quot;: &quot;amd64&quot;, &quot;Os&quot;: &quot;linux&quot;, &quot;Size&quot;: 1889395209, &quot;VirtualSize&quot;: 1889395209, &quot;GraphDriver&quot;: { &quot;Name&quot;: &quot;overlay&quot;, &quot;Data&quot;: { &quot;LowerDir&quot;: &quot;/var/home/core/.local/share/containers/storage/overlay/17f08ab058211a61949b72e535871db9e9d736d715f57eb03ff638fc6b4217ba/diff:/var/home/core/.local/share/containers/storage/overlay/9e4f8b7d485422648a3b783ff7af81dda4cc72fc349317ecac2d6e445458f876/diff:/var/home/core/.local/share/containers/storage/overlay/2ed0b88d698a5b80d1e6d2e01c54626d9325ceab2a87f876050b561d03c25eaa/diff:/var/home/core/.local/share/containers/storage/overlay/613be09ab3c0860a5216936f412f09927947012f86bfa89b263dfa087a725f81/diff&quot;, &quot;UpperDir&quot;: &quot;/var/home/core/.local/share/containers/storage/overlay/9d8cd1578897d624d16714529fe8a874525aa5a6b6cbbeea8836dadcdc0c9c86/diff&quot;, &quot;WorkDir&quot;: &quot;/var/home/core/.local/share/containers/storage/overlay/9d8cd1578897d624d16714529fe8a874525aa5a6b6cbbeea8836dadcdc0c9c86/work&quot; } }, &quot;RootFS&quot;: { &quot;Type&quot;: &quot;layers&quot;, &quot;Layers&quot;: [ &quot;sha256:613be09ab3c0860a5216936f412f09927947012f86bfa89b263dfa087a725f81&quot;, &quot;sha256:09bc1614a6b1e7dce4dbf68ebf3080d744b1a5a31a1cd75b867d8a82b263839b&quot;, &quot;sha256:dcc99d43921d1a06481595c055d6c1548af2018f386a8f0784581b5976bbc91d&quot;, &quot;sha256:9093d3ccc79eb49d95b7fffcc660e7884d17e4356c02d089a5814e624d9e4c4f&quot;, &quot;sha256:cbf51ce405b71d4341a990bf1a72c7189fb60d0357e3eab923728dd26593e01e&quot; ] }, &quot;Labels&quot;: { &quot;graalvm-archive-filename&quot;: &quot;graalvm-ce-linux-amd64-20.0.0-java11.tar.gz&quot;, &quot;graalvm-archive-url&quot;: &quot;https://github.com/graalvm/graalvm-ce-builds/releases/download/vm-20.0.0/graalvm-ce-java11-linux-amd64-20.0.0.tar.gz&quot;, &quot;graalvm-version&quot;: &quot;java11-20.0.0&quot;, &quot;io.buildah.version&quot;: &quot;1.24.1&quot;, &quot;io.cekit.version&quot;: &quot;3.7.0&quot;, &quot;io.k8s.description&quot;: &quot;Quarkus.io builder image for building Quarkus applications.&quot;, &quot;io.k8s.display-name&quot;: &quot;Centos + GraalVM + Maven Image&quot;, &quot;io.openshift.expose-services&quot;: &quot;8080:http&quot;, &quot;io.openshift.tags&quot;: &quot;builder,java,quarkus&quot;, &quot;maintainer&quot;: &quot;Quarkus Team &lt;quarkus-dev@googlegroups.com&gt;&quot;, &quot;org.label-schema.build-date&quot;: &quot;20200809&quot;, &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;, &quot;org.label-schema.name&quot;: &quot;CentOS Base Image&quot;, &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;, &quot;org.label-schema.vendor&quot;: &quot;CentOS&quot;, &quot;org.opencontainers.image.created&quot;: &quot;2020-08-09 00:00:00+01:00&quot;, &quot;org.opencontainers.image.licenses&quot;: &quot;GPL-2.0-only&quot;, &quot;org.opencontainers.image.title&quot;: &quot;CentOS Base Image&quot;, &quot;org.opencontainers.image.vendor&quot;: &quot;CentOS&quot; }, &quot;Annotations&quot;: {}, &quot;ManifestType&quot;: &quot;application/vnd.docker.distribution.manifest.v2+json&quot;, &quot;User&quot;: &quot;quarkus&quot;, &quot;History&quot;: [ { &quot;created&quot;: &quot;2020-08-10T18:20:08.948813347Z&quot;, &quot;created_by&quot;: &quot;/bin/sh -c #(nop) ADD file:61908381d3142ffba798ae9a904476d19b197ab79d0338f14bec0f76649df8d4 in / &quot; }, { &quot;created&quot;: &quot;2020-08-10T18:20:09.298928893Z&quot;, &quot;created_by&quot;: &quot;/bin/sh -c #(nop) LABEL org.label-schema.schema-version=1.0 org.label-schema.name=CentOS Base Image org.label-schema.vendor=CentOS org.label-schema.license=GPLv2 org.label-schema.build-date=20200809 org.opencontainers.image.title=CentOS Base Image org.opencontainers.image.vendor=CentOS org.opencontainers.image.licenses=GPL-2.0-only org.opencontainers.image.created=2020-08-09 00:00:00+01:00&quot;, &quot;empty_layer&quot;: true }, { &quot;created&quot;: &quot;2020-08-10T18:20:09.474278304Z&quot;, &quot;created_by&quot;: &quot;/bin/sh -c #(nop) CMD [\&quot;/bin/bash\&quot;]&quot;, &quot;empty_layer&quot;: true }, { &quot;created&quot;: &quot;2020-08-23T01:31:38.706392Z&quot; }, { &quot;created&quot;: &quot;2022-05-03T14:58:12.830020363Z&quot;, &quot;created_by&quot;: &quot;/bin/sh -c #(nop) COPY dir:d3f231e9fb7da6c1dbbffe52d4d8c24610148c1bc81c4e9dec552f712bb84314 in /usr/src/app/src &quot;, &quot;comment&quot;: &quot;FROM quay.io/quarkus/centos-quarkus-maven:20.0.0-java11&quot; }, { &quot;created&quot;: &quot;2022-05-03T14:58:13.539798645Z&quot;, &quot;created_by&quot;: &quot;/bin/sh -c #(nop) COPY file:fe7e9e3df41c0be0c6a866c0c8e1ae66fae41795e4d806cd4e5c080e9794c833 in /usr/src/app &quot; }, { &quot;created&quot;: &quot;2022-05-03T14:58:13.748106989Z&quot;, &quot;created_by&quot;: &quot;/bin/sh -c #(nop) USER root&quot;, &quot;empty_layer&quot;: true }, { &quot;created&quot;: &quot;2022-05-03T14:58:14.69111845Z&quot;, &quot;created_by&quot;: &quot;/bin/sh -c chown -R quarkus /usr/src/app&quot; }, { &quot;created&quot;: &quot;2022-05-03T14:58:14.919696287Z&quot;, &quot;created_by&quot;: &quot;/bin/sh -c #(nop) USER quarkus&quot;, &quot;empty_layer&quot;: true } ], &quot;NamesHistory&quot;: [ &quot;docker.io/library/61f2f5fcc5ddcc045c8aeae8fd2929a500e40612eb6cebfae6f2c60c3a372fb5-tmp:latest&quot; ] } ] ``` **Output of `podman ps -a`:** ``` empty list of containers ```</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>14</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #15191 from Luap99/docs-2 fix sphinx build to include podman-create/run page</MESSAGE>
    <SHA>4dff697b772bc3a99e6b1e9755f48c2a6194348c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>podman rmi: improve error message for build containers Improve the error message when attempting to remove an image that is in use by an external/build container. Prior, the error only indicated that the image was in use but did not aid in resolving the issue. Fixes: #15006 Signed-off-by: Valentin Rothberg &lt;vrothberg@redhat.com&gt;</MESSAGE>
      <SHA>3102194f036b830bd5e242a67d04e238a4f50bc0</SHA>
      <PATCHEDFILES>
        <FILE>go.mod</FILE>
        <FILE>go.sum</FILE>
        <FILE>test/system/010-images.bats</FILE>
        <FILE>vendor/github.com/containers/common/libimage/image.go</FILE>
        <FILE>vendor/github.com/containers/common/libimage/runtime.go</FILE>
        <FILE>vendor/github.com/containers/common/version/version.go</FILE>
        <FILE>vendor/modules.txt</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
