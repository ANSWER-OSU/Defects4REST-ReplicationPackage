<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>23715</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/23715</ISSUEURL>
  <TITLE>CI: tests should perform netns leak check</TITLE>
  <DESCRIPTION>Podman will create a bind mounted netns file under /run/netns ($XDG_RUNTIME_DIR/netns) in the following format `netns-839e5791-ef98-7fe1-ff60-d9e9a39fc06d` System tests (potentially e2e tests as well) should make sure that we do no leak any of these files are running the tests. This will ensure our cleanup is working properly. We already have a leak check in on single test but we need to make sure we do not leak anywhere, https://github.com/containers/podman/blob/ae4eaaf1ae6921eab9d5ba5f3c9252cb267e77b1/test/system/500-networking.bats#L1002-L1004 It is possible that there are outstanding bugs where we currently leak so if we find them these need to be fixed first. cc @edsantiago</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>27</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>test/system: netns leak check for rootless as well This fixes the problem where even as root we check the netns files from root. But in order to catch any rootless bugs we must check the rootless files from $XDG_RUNTIME_DIR/netns. Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
    <SHA>2d469e517dd0bf1ce5a8babbb76663abc369572c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>test/e2e: add netns leak check Like we do in system tests now check for netns leaks in e2e as well. Now because things run in parallel and this dir is shared we cannot test after each test only once per suite. This will be a PITA to debug if leaks happen as the netns files do not contain the container ID and are just random bytes (maybe we should change this?) Fixes #23715 Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>755a06aa441e79319cd00c39cf5144e427d192a6</SHA>
      <PATCHEDFILES>
        <FILE>test/e2e/common_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
