<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>15476</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/15476</ISSUEURL>
  <TITLE>build from API or `podman-remote build` does not supports `--userns=auto` while it works with CLI</TITLE>
  <DESCRIPTION>User trying this implementation in Podman 4.2.0. Seems its working via CLI, but API call does not work. **Dockerfile** ``` cat &lt;&lt; EOF &gt; Dockerfile FROM alpine RUN cat /proc/self/uid_map EOF ``` Works correctly via CLI ``` podman build -t test --userns=auto . ``` Does not work via API ``` tar -czf context.tar.gz Dockerfile curl -s --unix-socket /run/podman/podman.sock -X POST -H &quot;Content-Type:application/tar&quot; --data-binary &quot;@context.tar.gz&quot; 'http://d/v4.2.0/libpod/build?userns=auto' ``` _Originally posted by @lukasmrtvy in https://github.com/containers/buildah/issues/4060#issuecomment-1226050854_</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #15482 from edsantiago/docs_dedup_systemd Man pages: refactor common options: --systemd</MESSAGE>
    <SHA>b1247b62bddd96a02741499cc63427866290e5a1</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>remote: fix implementation of build with --userns=auto for API `podman-remote` and Libpod API does not supports build with `--userns=auto` since `IDMappingOptions` were not implemented for API and bindings, following PR implements passing `IDMappingOptions` via bindings to API. Closes: https://github.com/containers/podman/issues/15476 Signed-off-by: Aditya R &lt;arajan@redhat.com&gt;</MESSAGE>
      <SHA>e00272cd99ec7ccfc73ccf1e67e123e98f2ab3f0</SHA>
      <PATCHEDFILES>
        <FILE>pkg/api/handlers/compat/images_build.go</FILE>
        <FILE>pkg/bindings/images/build.go</FILE>
        <FILE>test/e2e/build/Containerfile.userns-auto</FILE>
        <FILE>test/e2e/run_userns_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
