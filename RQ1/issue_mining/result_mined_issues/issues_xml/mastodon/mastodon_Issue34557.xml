<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>34557</ISSUENO>
  <ISSUEURL>https://github.com/mastodon/mastodon/issues/34557</ISSUEURL>
  <TITLE>`this.props.actions is undefined` on Actions modal when opening edit history on mobile view</TITLE>
  <DESCRIPTION>### Steps to reproduce the problem 1. Open a mobile device or use the devtools of a desktop browser to emulate a mobile device (and refresh the page!) 2. Go to mastodon.social (or any Mastodon instance) and log in 3. Resolve the post `https://mastodon.catgirl.cloud/@sophie144p/114361912718260123` by entering it in the search bar (if on mastodon.social: `https://mastodon.social/@sophie144p@catgirl.cloud/114361912845612037`) 4. Click on the edit history ### Expected behaviour Mastodon does not crash ### Actual behaviour Mastodon does crash ### Detailed description _No response_ ### Mastodon instance mastodon.social, (mastodon.catgirl.cloud) ### Mastodon version Mastodon v4.4.0-nightly.2025-04-15, (custom fork) ### Browser name and version Firefox 136.0 ### Operating system NixOS unstable ### Technical details Not sure how exactly it happens, but it seems like the Actions modal just gets called without an `actions` property. ``` TypeError: this.props.actions is undefined render@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:1986902 Cs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2390389 Es@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2390188 kl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2433226 yc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2421527 pc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2421455 gc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2421316 rc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2418151 lc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2418533 Zi@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2359682 ac/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416106 VoidFunction*ac@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416082 nc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2415555 enqueueSetState@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2382096 b.prototype.setState@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2442569 n.componentDidMount/this.unlisten&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:248849 a@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451133 p/notifyListeners/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451363 notifyListeners@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451333 S@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:452352 k/push/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:453370 confirmTransitionTo@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451073 push@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:453155 l.push@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:430549 _ensureHistoryBuffer@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2251325 componentDidUpdate@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2250714 vl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2413473 yl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2413159 bl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2412703 wc/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2424366 wc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2424868 lc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2418680 Zi@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2359682 ac/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416106 VoidFunction*ac@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416082 nc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2415555 So@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2376150 Eo/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2376009 H/s/notify/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 f@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:213657 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 H/s/notify/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 f@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:213657 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 H/s/notify/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 f@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:213657 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 H/s/notify/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 O/&lt;/&lt;/&lt;/subscribe/t&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:188880 l/p/&lt;@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:402688 render (webpack:///app/javascript/mastodon/features/ui/components/actions_modal.jsx:42:11) jj (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:203:188) hj (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:202:148) null,Zf(d)?(f=!0,cg (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:291:171) tj (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:279:391) tj (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:279:322) tj (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:279:179) Nk (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:270:87) Ck (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:272:299) jg (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:127:104) Dk (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:266:272) Dk (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:266:247) yi (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:265:335) isMounted (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:182:224) setState (webpack:///node_modules/react/cjs/react.production.min.js:12:236) this.props.history.listen(function (webpack:///node_modules/react-router/esm/react-router.js:270:17) listener (webpack:///node_modules/history/esm/history.js:155:23) listeners.forEach(function (webpack:///node_modules/history/esm/history.js:173:22) listeners.forEach(function (webpack:///node_modules/history/esm/history.js:172:14) setState (webpack:///node_modules/history/esm/history.js:288:22) globalHistory.pushState (webpack:///node_modules/history/esm/history.js:369:10) prompt (webpack:///node_modules/history/esm/history.js:145:6) transitionManager.confirmTransitionTo (webpack:///node_modules/history/esm/history.js:350:22) push (webpack:///app/javascript/mastodon/components/router.tsx:69:2) _ensureHistoryBuffer (webpack:///app/javascript/mastodon/components/modal_root.jsx:123:19) this._handleModalOpen (webpack:///app/javascript/mastodon/components/modal_root.jsx:92:11) kk (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:260:315) ik (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:259:445) ek (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:258:430) Wk (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:282:95) Sk (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:280:400) Ck (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:272:438) jg (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:127:104) Dk (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:266:272) Dk (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:266:247) yi (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:265:335) ci (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:167:246) ci (webpack:///node_modules/react-dom/cjs/react-dom.production.min.js:167:106) defaultNoopBatch( (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) childPropsSelector (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:657:8) handleChangeWrapper (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) defaultNoopBatch( (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) childPropsSelector (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:657:8) handleChangeWrapper (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) defaultNoopBatch( (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) childPropsSelector (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:657:8) handleChangeWrapper (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) defaultNoopBatch( (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) handleChangeWrapper (webpack:///node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) listener (webpack:///src/autoBatchEnhancer.ts:79:66) Error (webpack:///node_modules/redux/dist/redux.legacy-esm.js:166:6) ```</DESCRIPTION>
  <REPONAME>mastodon</REPONAME>
  <TIMEDIFFERENCEDAYS>3</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Store incoming quote policies as bitfield</MESSAGE>
    <SHA>66fc7cfc1d45e2a603692ff7e200b49ca698b79a</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix edit dropdown crashing the web interface on mobile Fixes #34557</MESSAGE>
      <SHA>6f63a61c5513d3e3c0aafd2c594333e50845fe72</SHA>
      <PATCHEDFILES>
        <FILE>app/javascript/mastodon/components/dropdown_menu.tsx</FILE>
        <FILE>app/javascript/mastodon/components/edited_timestamp/index.tsx</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix edit dropdown crashing the web interface on mobile Fixes #34557</MESSAGE>
      <SHA>08c203fa1546e2dc202ac362bc98eefdeadfa6e5</SHA>
      <PATCHEDFILES>
        <FILE>app/javascript/mastodon/components/dropdown_menu.tsx</FILE>
        <FILE>app/javascript/mastodon/components/edited_timestamp/index.tsx</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
