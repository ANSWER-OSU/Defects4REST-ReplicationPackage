<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>29071</ISSUENO>
  <ISSUEURL>https://github.com/mastodon/mastodon/issues/29071</ISSUEURL>
  <TITLE>Regression: Suggestion.source is documented as a string, currently returns list of strings</TITLE>
  <DESCRIPTION>### Steps to reproduce the problem 1. On `mastodon.social`, call [`/api/v2/suggestions`](https://docs.joinmastodon.org/methods/suggestions/#v2) 2. Attempt to decode output as documented, as an array of [`Suggestion`](https://docs.joinmastodon.org/entities/Suggestion/) objects 3. Decoding fails because object has changed from documented format ### Expected behaviour `Suggestion.source` should be a string ### Actual behaviour `Suggestion.source` is an array of strings ### Detailed description I'm not sure when this changed, but it's not documented, or backwards compatible with existing clients. My suggestion for the fix would be to keep `source` as a string, populate it with the first or most important of the possible source strings, deprecate `source`, and return the full list of sources as a new `sources` property on `Suggestion`. ### Mastodon instance mastodon.social ### Mastodon version v4.3.0-nightly.2024-02-02 ### Technical details _No response_</DESCRIPTION>
  <REPONAME>mastodon</REPONAME>
  <TIMEDIFFERENCEDAYS>3</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Add missing action logging to `api/v1/admin/reports#update` (#29044)</MESSAGE>
    <SHA>4cf07ed78c0f4959160f22506e1f03dc5737a815</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Change `source` attribute of `Suggestion` entity in `/api/v2/suggestions` back to a string The new array is now in the `sources` attribute. Fixes #29071</MESSAGE>
      <SHA>a6b22dc1c615536066a5776478cff880cea3dffb</SHA>
      <PATCHEDFILES>
        <FILE>app/models/account_suggestions.rb</FILE>
        <FILE>app/models/account_suggestions/suggestion.rb</FILE>
        <FILE>app/serializers/rest/suggestion_serializer.rb</FILE>
        <FILE>spec/requests/api/v2/suggestions_spec.rb</FILE>
        <FILE>spec/serializers/rest/suggestion_serializer_spec.rb</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
