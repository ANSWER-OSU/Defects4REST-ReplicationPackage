<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3359</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/3359</ISSUEURL>
  <TITLE>issue of traffic split vars</TITLE>
  <DESCRIPTION>curl http://127.0.0.1:80/apisix/admin/routes/1 -H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -X PUT -d ' { &quot;uri&quot;: &quot;/index.html&quot;, &quot;plugins&quot;: { &quot;traffic-split&quot;: { &quot;rules&quot;: [ { &quot;match&quot;: [ { &quot;vars&quot;: [ [&quot;http_h-x-strategy-token-cmnet&quot;,&quot;==&quot;,&quot;CompanyNetwork&quot;] ], &quot;vars&quot;: [ [&quot;cookie_h-x-strategy-token-cmnet&quot;,&quot;==&quot;,&quot;CompanyNetwork&quot;] ] } ], &quot;weighted_upstreams&quot;: [ { &quot;upstream&quot;: { &quot;name&quot;: &quot;upstream_A&quot;, &quot;type&quot;: &quot;roundrobin&quot;, &quot;nodes&quot;: { &quot;127.0.0.1:1981&quot;:10 } }, &quot;weight&quot;: 3 }, { &quot;weight&quot;: 2 } ] } ] } }, &quot;upstream&quot;: { &quot;type&quot;: &quot;roundrobin&quot;, &quot;nodes&quot;: { &quot;127.0.0.1:1980&quot;: 1 } } }' etcd result: { &quot;update_time&quot;:1611131384, &quot;upstream&quot;:{ &quot;type&quot;:&quot;roundrobin&quot;, &quot;hash_on&quot;:&quot;vars&quot;, &quot;nodes&quot;:{ &quot;127.0.0.1:1980&quot;:1 }, &quot;pass_host&quot;:&quot;pass&quot; }, &quot;plugins&quot;:{ &quot;traffic-split&quot;:{ &quot;rules&quot;:[ { &quot;match&quot;:[ { &quot;vars&quot;:[ [ &quot;cookie_h-x-strategy-token-cmnet&quot;, &quot;==&quot;, &quot;CompanyNetwork&quot; ] ] } ], &quot;weighted_upstreams&quot;:[ { &quot;weight&quot;:3, &quot;upstream&quot;:{ &quot;nodes&quot;:{ &quot;127.0.0.1:1981&quot;:10 }, &quot;type&quot;:&quot;roundrobin&quot;, &quot;hash_on&quot;:&quot;vars&quot;, &quot;pass_host&quot;:&quot;pass&quot;, &quot;name&quot;:&quot;upstream_A&quot; } }, { &quot;weight&quot;:2 } ] } ] } }, &quot;create_time&quot;:1611130637, &quot;priority&quot;:0, &quot;id&quot;:&quot;1&quot;, &quot;uri&quot;:&quot;/index.html&quot;, &quot;status&quot;:1 } vars http 不见了</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>test: make ci stable (#3329)</MESSAGE>
    <SHA>319c3ebefd22cd2949b84d97d196fd2a80630d38</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>docs(traffic-split): update the vars example of the documentation. close #3359</MESSAGE>
      <SHA>477797ebcdf9b94ad1e38eaf36724a02a212cd86</SHA>
      <PATCHEDFILES>
        <FILE>doc/plugins/traffic-split.md</FILE>
        <FILE>doc/zh-cn/plugins/traffic-split.md</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>docs(traffic-split): update the vars example of the docs (#3366) close #3359</MESSAGE>
      <SHA>62b5f7c6d46bcb076c235e63d7459b3d0c128b8e</SHA>
      <PATCHEDFILES>
        <FILE>doc/plugins/traffic-split.md</FILE>
        <FILE>doc/zh-cn/plugins/traffic-split.md</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
