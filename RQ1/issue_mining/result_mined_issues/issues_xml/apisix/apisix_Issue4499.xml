<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4499</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/4499</ISSUEURL>
  <TITLE>[test unstable] t/control/healthcheck.t</TITLE>
  <DESCRIPTION>### Issue description ``` # Failed test 'TEST 2: routes - response_body - response is expected (repeated req 0, req 0)' # at /home/runner/work/apisix/apisix/test-nginx/lib/Test/Nginx/Socket.pm line 1589. # @@ -1,2 +1,2 @@ # -[{&quot;healthy_nodes&quot;:[{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1980,&quot;priority&quot;:0,&quot;weight&quot;:1}],&quot;name&quot;:&quot;upstream#/routes/1&quot;,&quot;nodes&quot;:[{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1980,&quot;priority&quot;:0,&quot;weight&quot;:1},{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1988,&quot;priority&quot;:0,&quot;weight&quot;:1}],&quot;src_id&quot;:&quot;1&quot;,&quot;src_type&quot;:&quot;routes&quot;}] # +[{&quot;healthy_nodes&quot;:[{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1988,&quot;priority&quot;:0,&quot;weight&quot;:1},{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1980,&quot;priority&quot;:0,&quot;weight&quot;:1}],&quot;name&quot;:&quot;upstream#/routes/1&quot;,&quot;nodes&quot;:[{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1980,&quot;priority&quot;:0,&quot;weight&quot;:1},{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1988,&quot;priority&quot;:0,&quot;weight&quot;:1}],&quot;src_id&quot;:&quot;1&quot;,&quot;src_type&quot;:&quot;routes&quot;}] # {&quot;healthy_nodes&quot;:[{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1980,&quot;priority&quot;:0,&quot;weight&quot;:1}],&quot;name&quot;:&quot;upstream#/routes/1&quot;,&quot;nodes&quot;:[{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1980,&quot;priority&quot;:0,&quot;weight&quot;:1},{&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:1988,&quot;priority&quot;:0,&quot;weight&quot;:1}],&quot;src_id&quot;:&quot;1&quot;,&quot;src_type&quot;:&quot;routes&quot;} Error: [error] [lua] config_yaml.lua:66: read_apisix_yaml(): failed to fetch /home/runner/work/apisix/apisix/t/servroot/conf/apisix.yaml attributes: cannot obtain information from file '/home/runner/work/apisix/apisix/t/servroot/conf/apisix.yaml': No such file or directory Error: [error] [lua] config_yaml.lua:66: read_apisix_yaml(): failed to fetch /home/runner/work/apisix/apisix/t/servroot/conf/apisix.yaml attributes: cannot obtain information from file '/home/runner/work/apisix/apisix/t/servroot/conf/apisix.yaml': No such file or directory Error: [error] [lua] config_yaml.lua:66: read_apisix_yaml(): failed to fetch /home/runner/work/apisix/apisix/t/servroot/conf/apisix.yaml attributes: cannot obtain information from file '/home/runner/work/apisix/apisix/t/servroot/conf/apisix.yaml': No such file or directory # Looks like you failed 1 test of 19. t/control/healthcheck.t ......................... ``` ### Environment * CI: `build (ubuntu-18.04, linux_openresty)`</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>feat: release 2.7 (#4453)</MESSAGE>
    <SHA>3f0dee1d1dff095a521e66df17ae5e77498174eb</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>test: ensure health check is run completely Fix #4499 Signed-off-by: spacewander &lt;spacewanderlzx@gmail.com&gt;</MESSAGE>
      <SHA>2fd167a43f2a20a017d9b3ee29c7a44af239a14f</SHA>
      <PATCHEDFILES>
        <FILE>t/control/healthcheck.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
