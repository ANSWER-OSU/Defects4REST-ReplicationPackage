<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1710</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/1710</ISSUEURL>
  <TITLE>bug: Invalid JSON encoding when exporting logs with method body</TITLE>
  <DESCRIPTION>### Issue description If the method body contains JSON data, then while exporting via loggers it results in invalid encoding. ```shell curl http://127.0.0.2:9080/get --data '{&quot;sample_payload&quot;:&quot;hello&quot;}' ``` ```json { &quot;upstream&quot;:&quot;52.54.214.244:443&quot;, &quot;body&quot;:&quot;{\\&quot;sample_payload\\&quot;:\\&quot;hello\\&quot;}&quot;,&quot;method&quot;:&quot;POST&quot;}, -- wrong encoding } ``` ### Fix Encode the method body before appending to the log message.</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>211</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>docs: lint Markdown (#3178)</MESSAGE>
    <SHA>7c5df5d343ef79f9a292a8eb621fec72280d13ea</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>test: demonstrate http-logger works fine with JSON body Close #1710. Signed-off-by: spacewander &lt;spacewanderlzx@gmail.com&gt;</MESSAGE>
      <SHA>ecf25eec43c83e13e378ffc4553569cbede27bc1</SHA>
      <PATCHEDFILES>
        <FILE>t/plugin/http-logger-json.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>test: demonstrate http-logger works fine with JSON body (#3212) Close #1710</MESSAGE>
      <SHA>a2ad12bf475b9be2d5ee3e2157f70dba28d5624a</SHA>
      <PATCHEDFILES>
        <FILE>t/plugin/http-logger-json.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>test: demonstrate http-logger works fine with JSON body (#3212) Close #1710</MESSAGE>
      <SHA>e5e540cc85067089cd2cbe5ef818282811e662b9</SHA>
      <PATCHEDFILES>
        <FILE>t/plugin/http-logger-json.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
