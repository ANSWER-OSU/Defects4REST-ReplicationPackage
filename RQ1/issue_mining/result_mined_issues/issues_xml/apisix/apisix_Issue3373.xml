<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3373</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/3373</ISSUEURL>
  <TITLE>request help: The proxy-cache plugin overrides `Cache-Control` in upstream header.</TITLE>
  <DESCRIPTION>### Issue description The proxy cache plugin overrides the Cache Control in the upstream header, even if the plugin is not used in the route. https://github.com/apache/apisix/blob/e3601e6876e13a44fa8102fa19a41b4bc1a080e2/apisix/cli/ngx_tpl.lua#L511-L536 Disabling the plugin in `config.yml` solves this problem, but some routes need to enable the plugin. How should I preserve the Cache Control in the upstream header with the proxy cache plugin globally enabled? ### Environment * apisix version: 2.2 * OS: Linux 7cc563f53b08 4.19.121-linuxkit #1 SMP Tue Dec 1 17:50:32 UTC 2020 x86_64 Linux * OpenResty / Nginx version: nginx version: openresty/1.19.3.1</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>47</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>perf(standalone): load configuration in the init phase (#3782) Signed-off-by: spacewander &lt;spacewanderlzx@gmail.com&gt;</MESSAGE>
    <SHA>c530135c5a179c99637d52d99e0e8a45ce4cc8b8</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: don't override cache relative headers Fix #3373 Fix #3677 Signed-off-by: spacewander &lt;spacewanderlzx@gmail.com&gt;</MESSAGE>
      <SHA>63d883b0de2832345ee514975ecdfa990435f7c0</SHA>
      <PATCHEDFILES>
        <FILE>apisix/cli/ngx_tpl.lua</FILE>
        <FILE>apisix/core/ctx.lua</FILE>
        <FILE>apisix/plugins/proxy-cache.lua</FILE>
        <FILE>t/APISIX.pm</FILE>
        <FILE>t/plugin/proxy-cache.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
