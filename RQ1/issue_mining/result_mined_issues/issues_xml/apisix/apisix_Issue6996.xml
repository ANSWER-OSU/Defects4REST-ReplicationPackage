<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6996</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/6996</ISSUEURL>
  <TITLE>feat: As a user, I want to see `grpc-status-details-bin` in response body in case an error, so that I avoid parsing header to read error response</TITLE>
  <DESCRIPTION>### Description I'm using `grpc-transcode` plugin to manage gRPC&lt;=&gt; HTTP, It would be great to convert `grpc-status-details-bin` in header to HTTP response body in case an error from the upstream. ![Screenshot from 2022-05-07 15-31-05](https://user-images.githubusercontent.com/39027858/167256606-8855f255-5d6d-4c23-9a50-69d0b2f9b68a.png) Decoded `grpc-status-details-bin` : ![Screenshot from 2022-05-07 15-30-55](https://user-images.githubusercontent.com/39027858/167256611-80ae50df-221f-4448-aa6b-f21c946253f9.png) Corresponding error model, see https://cloud.google.com/apis/design/errors for more : ``` package google.rpc; // The `Status` type defines a logical error model that is suitable for // different programming environments, including REST APIs and RPC APIs. message Status { // A simple error code that can be easily handled by the client. The // actual error code is defined by `google.rpc.Code`. int32 code = 1; // A developer-facing human-readable error message in English. It should // both explain the error and offer an actionable resolution to it. string message = 2; // Additional error information that the client code can use to handle // the error, such as retry info or a help link. repeated google.protobuf.Any details = 3; } ``` Here are my concerns, quoting from https://www.grpc.io/docs/guides/error/ - Library implementations of the extended error model may not be consistent across languages in terms of requirements for and expectations of the error details payload - Existing proxies, loggers, and other standard HTTP request processors don’t have visibility into the error details and thus wouldn’t be able to leverage them for monitoring or other purposes - Additional error detail in the trailers interferes with head-of-line blocking, and will decrease HTTP/2 header compression efficiency due to more frequent cache misses - Larger error detail payloads may run into protocol limits (like max headers size), effectively losing the original error Resources: - Just to give you an idea , [similar problem for envoy in the past](https://github.com/envoyproxy/envoy/issues/3383)</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>198</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>docs(MAINTAIN): additional information about the release of the LTS version (#7348)</MESSAGE>
    <SHA>2da6dff984eec0608fa724e390a1ce7b0df6c26c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>feat: convert grpc-status-details-bin in header to HTTP response body (#6996)</MESSAGE>
      <SHA>0928af54f7279dc992a978b003e4c59eca49d73b</SHA>
      <PATCHEDFILES>
        <FILE>t/grpc_server_example/go.mod</FILE>
        <FILE>t/grpc_server_example/go.sum</FILE>
        <FILE>t/grpc_server_example/main.go</FILE>
        <FILE>t/grpc_server_example/proto/helloworld.pb.go</FILE>
        <FILE>t/grpc_server_example/proto/helloworld.proto</FILE>
        <FILE>t/grpc_server_example/proto/helloworld_grpc.pb.go</FILE>
        <FILE>t/plugin/grpc-transcode.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
