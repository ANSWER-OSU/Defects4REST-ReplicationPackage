<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1834</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/1834</ISSUEURL>
  <TITLE>test: when the DNS is updated, new requests should send to the updated upstream address.</TITLE>
  <DESCRIPTION>we need to add more test cases.</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>4</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>* CI: Github action run non-OSX test case, Travis-CI runs the OSX test case(allow failure). (#1860) * test: reformat by `reindex`. * CI: dry-run the OSX CI in Github Action.</MESSAGE>
    <SHA>cff822b7ae1d89971dca0c9ac1d8f5e0ff976b2e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>bugfix: fetch wrong the upstream node when there were multiple upstream node with host (#1835) Fix #1834</MESSAGE>
      <SHA>47b0ef372e9c33a464fd8fd372ee0a5ba5d34c3d</SHA>
      <PATCHEDFILES>
        <FILE>apisix/balancer.lua</FILE>
        <FILE>apisix/init.lua</FILE>
        <FILE>apisix/upstream.lua</FILE>
        <FILE>t/node/invalid-route.t</FILE>
        <FILE>t/node/upstream-domain.t</FILE>
        <FILE>t/node/upstream-node-dns.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
