<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3306</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/3306</ISSUEURL>
  <TITLE>traffic-split var中设置header不能有- 横线</TITLE>
  <DESCRIPTION>traffic-split 设置如下: ```json { &quot;disable&quot;: false, &quot;rules&quot;: [ { &quot;match&quot;: [ { &quot;vars&quot;: [ [ &quot;http_h-x-strategy-token-cmnet&quot;, &quot;==&quot;, &quot;CompanyNetwork&quot; ] ] } ], &quot;weighted_upstreams&quot;: [ { &quot;upstream&quot;: { &quot;hash_on&quot;: &quot;vars&quot;, &quot;name&quot;: &quot;upstream_A&quot;, &quot;nodes&quot;: { &quot;10.0.15.97:80&quot;: 10 }, &quot;pass_host&quot;: &quot;pass&quot;, &quot;type&quot;: &quot;roundrobin&quot; }, &quot;weight&quot;: 1 } ] } ] } ``` apisix 2.2 etcd3.4.0 经测试 如果vars中含有- 横线,会导致校验header失败,请解决</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>refactor: the parent of upstream should point to its original src (#3287) Signed-off-by: spacewander &lt;spacewanderlzx@gmail.com&gt;</MESSAGE>
    <SHA>bbbdf58d555ee89144b6923e751deabf7e0bbf15</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: the header set in vars cannot have a horizontal line fix #3306</MESSAGE>
      <SHA>08f09d62df640835d3999cae12d0a9caafc423f9</SHA>
      <PATCHEDFILES>
        <FILE>apisix/plugins/traffic-split.lua</FILE>
        <FILE>t/plugin/traffic-split.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix(traffic-split): the header set in vars cannot have a horizontal line (#3310) fix #3306</MESSAGE>
      <SHA>a1dd370962a39be652e03978a37231660a2641b6</SHA>
      <PATCHEDFILES>
        <FILE>apisix/plugins/traffic-split.lua</FILE>
        <FILE>t/plugin/traffic-split.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
