<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2818</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/2818</ISSUEURL>
  <TITLE>[DISCUSS]: Use luasocket lib instead of `curl` in &quot;bin/apisix&quot;</TITLE>
  <DESCRIPTION>Hi, I advise using luasocket lib instead of `curl` in &quot;bin/apisix&quot;. Although, it's very convenient to get HTTP responses by using &quot;io.open&quot; and &quot;curl&quot;. But, I think it's not an elegant way and has some limitations. Such as can't distinguish error info between `Connection refused` and empty response. So I think we can use luasocket lib and create a common function in &quot;cli/util.lua&quot;, so that we can deal with some HTTP request better in &quot;bin/apisix&quot;. releated: #2718</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>45</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix: reject &quot;&quot; for route's remote_addrs (#2907) This change imroves the IP schema validation.</MESSAGE>
    <SHA>ddfeb5de1de629ca2263f58371d624281f6451ff</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>feat: use luasocket instead of in etcd.lua (#2818)</MESSAGE>
      <SHA>492f439e6cd36837ccebb6e056664d6d9f240ae6</SHA>
      <PATCHEDFILES>
        <FILE>.travis/apisix_cli_test.sh</FILE>
        <FILE>apisix/cli/etcd.lua</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: use luasocket instead of in etcd.lua (#2818)</MESSAGE>
      <SHA>c5b5209a0b3a9e8a732c7abc9548ae8c139763fb</SHA>
      <PATCHEDFILES>
        <FILE>.travis/apisix_cli_test.sh</FILE>
        <FILE>apisix/cli/etcd.lua</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: use luasocket instead of in etcd.lua (#2818)</MESSAGE>
      <SHA>5782cc74613433819dcf13a73d754893309ece65</SHA>
      <PATCHEDFILES>
        <FILE>.travis/apisix_cli_test.sh</FILE>
        <FILE>apisix/cli/etcd.lua</FILE>
        <FILE>rockspec/apisix-master-0.rockspec</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: use luasocket instead of curl in etcd.lua (#2818)</MESSAGE>
      <SHA>55eafd6c66604c705f7a22715ee7da9628c0c046</SHA>
      <PATCHEDFILES>
        <FILE>.travis/apisix_cli_test.sh</FILE>
        <FILE>apisix/cli/etcd.lua</FILE>
        <FILE>rockspec/apisix-master-0.rockspec</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: use luasocket instead of curl in etcd.lua (#2818)</MESSAGE>
      <SHA>83df02bdb8fb20411b2d4c1d2959f21407919a96</SHA>
      <PATCHEDFILES>
        <FILE>.travis/apisix_cli_test/test_main.sh</FILE>
        <FILE>apisix/cli/etcd.lua</FILE>
        <FILE>rockspec/apisix-master-0.rockspec</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: use luasocket instead of curl in etcd.lua (#2965) fix: #2818 fix: #2718</MESSAGE>
      <SHA>7b5d2eae26466935c8be622b443ae23e59dbaa3b</SHA>
      <PATCHEDFILES>
        <FILE>.travis/apisix_cli_test/test_main.sh</FILE>
        <FILE>apisix/cli/etcd.lua</FILE>
        <FILE>rockspec/apisix-master-0.rockspec</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
