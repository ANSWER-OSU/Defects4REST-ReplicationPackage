<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4784</ISSUENO>
  <ISSUEURL>https://github.com/getredash/redash/issues/4784</ISSUEURL>
  <TITLE>Y-axis autoscale fails when min == 0</TITLE>
  <DESCRIPTION>&lt;!-- We use GitHub only for bug reports Anything else should be posted to https://discuss.redash.io For support, help &amp; questions use https://discuss.redash.io/c/support For feature requests &amp; ideas use https://discuss.redash.io/c/feature-requests **Found a security vulnerability?** Please email security@redash.io to report any security vulnerabilities. We will acknowledge receipt of your vulnerability and strive to send you regular updates about our progress. If you're curious about the status of your disclosure please feel free to email us again. If you want to encrypt your disclosure email, you can use this PGP key. --&gt; ### Issue Summary Y-axis auto scaling doesn't work if the user forces the minimum Y-axis value to a constant. It seems to be all-or-nothing: use auto for min **and** max or not at all. I reproduced this issue in our [preview instance](https://redash-preview.netlify.com/queries/360#629). ### Original Visualization There are three traces. Fully auto scaled. ![1_original](https://user-images.githubusercontent.com/17067911/78724059-397af680-78f2-11ea-87a4-1b75bfe479da.png) ### With full auto-scaling I've clicked to hide the highest number (green line). The Y-axis re-scales to show more precision on the blue and red lines. ![2_full_auto](https://user-images.githubusercontent.com/17067911/78724070-40a20480-78f2-11ea-80ab-240d8845830d.png) ### With auto-scale max and min forced to 0 I've clicked to hide the highest number (green line). The Y-axis does not re-scale. So the lines are inexplicably flat compared to how they would appear if the green line were not there in the first place. ![3_partial_auto](https://user-images.githubusercontent.com/17067911/78724085-4861a900-78f2-11ea-89ed-38b806f2dc0f.png) ### Steps to Reproduce 1. Write a query that returns at least two lines 2. Force the Y-axis to be minimum of 0 3. Click the legend to hide the higher numbered line 4. Observe that the Y-axis does not re-scale to accommodate the only line being displayed. ### Technical details: * Redash Version: v9 Alpha * Browser/OS: FF and Chrome * How did you install Redash: SaaS</DESCRIPTION>
  <REPONAME>redash</REPONAME>
  <TIMEDIFFERENCEDAYS>85</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Set the schema item title attribute correctly. (#4892) Co-authored-by: Gabriel Dutra &lt;nesk.frz@gmail.com&gt;</MESSAGE>
    <SHA>a2217cc4ecfa5cd916c934c19a93848284cf984b</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>getredash/redash#4784 Y-axis autoscale fails when min or max is set</MESSAGE>
      <SHA>25f4d53964a6074be4dd726930f730c90fee723a</SHA>
      <PATCHEDFILES>
        <FILE>viz-lib/src/visualizations/chart/Renderer/PlotlyChart.jsx</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/index.js</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/prepareLayout.js</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/updateLayout.js</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/utils.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Y-axis autoscale fails when min or max is set (#4904) * getredash/redash#4784 Y-axis autoscale fails when min or max is set * Update tests Co-authored-by: Gabriel Dutra &lt;nesk.frz@gmail.com&gt;</MESSAGE>
      <SHA>c6be5758ad07222b8ddde7b59cc3a48df359d6e6</SHA>
      <PATCHEDFILES>
        <FILE>viz-lib/src/visualizations/chart/Renderer/PlotlyChart.jsx</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/fixtures/prepareLayout/box-single-axis.json</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/fixtures/prepareLayout/box-with-second-axis.json</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/fixtures/prepareLayout/default-single-axis.json</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/fixtures/prepareLayout/default-with-second-axis.json</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/fixtures/prepareLayout/default-with-stacking.json</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/fixtures/prepareLayout/default-without-legend.json</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/index.js</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/prepareLayout.js</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/updateLayout.js</FILE>
        <FILE>viz-lib/src/visualizations/chart/plotly/utils.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
