<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5811</ISSUENO>
  <ISSUEURL>https://github.com/getredash/redash/issues/5811</ISSUEURL>
  <TITLE>Timing out when connecting to a MSSQL database on non-default port using ODBC driver</TITLE>
  <DESCRIPTION>I had to use &quot;Microsoft SQL Server (ODBC)&quot; data source because the &quot;Microsoft SQL Server&quot; one does not currently support using SSL. However, when trying to connect to my server on a port different than 1433, connection timed out. After a bit of digging, I found this: &gt; Microsoft's ODBC drivers for SQL Server do not use a PORT= parameter. The port number, if any, is appended to the server name/IP with a comma source: https://stackoverflow.com/a/50051708/1277401</DESCRIPTION>
  <REPONAME>redash</REPONAME>
  <TIMEDIFFERENCEDAYS>339</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>New ElasticSearch Query Runner (#5794) - A runner supporting the newest versions of ES, aggregation, nested aggregations and nested fields. - A runner for the SQL OpenDistro flavor - A runner for the SQL X-Pack flavor Co-authored-by: Nicolas Le Manchet &lt;nicolas@lemanchet.fr&gt; Co-authored-by: wwl717195673 &lt;717195673@qq.com&gt;</MESSAGE>
    <SHA>4186f8303ee28d5cde7ca248c57df9023eba6224</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix #5811: passing server,port to MS ODBC driver</MESSAGE>
      <SHA>ca5e66878b21c6de7de0045e49650819eeb32176</SHA>
      <PATCHEDFILES>
        <FILE>redash/query_runner/mssql_odbc.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix #5811: passing server,port to MS ODBC driver (#5812) Co-authored-by: Justin Clift &lt;justin@postgresql.org&gt;</MESSAGE>
      <SHA>f43bd6aadae00f7de4638584a810969932b9fd33</SHA>
      <PATCHEDFILES>
        <FILE>redash/query_runner/mssql_odbc.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix #5811: passing server,port to MS ODBC driver (#5812) Co-authored-by: Justin Clift &lt;justin@postgresql.org&gt;</MESSAGE>
      <SHA>ce8a4398bd4481eb2fa4d63769dce9c9daab688f</SHA>
      <PATCHEDFILES>
        <FILE>redash/query_runner/mssql_odbc.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
