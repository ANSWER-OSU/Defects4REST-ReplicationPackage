<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1561</ISSUENO>
  <ISSUEURL>https://github.com/getredash/redash/issues/1561</ISSUEURL>
  <TITLE>Error running query: FATAL: remaining connection slots are reserved for non-replication superuser connections</TITLE>
  <DESCRIPTION>### Issue Summary Getting a lot of ``` Error running query: FATAL: remaining connection slots are reserved for non-replication superuser connections ``` In the newest version of redash ### Technical details: * Redash Version: 1.0.0-rc * Browser/OS: Chrome * How did you install Redash: From Source</DESCRIPTION>
  <REPONAME>redash</REPONAME>
  <TIMEDIFFERENCEDAYS>20</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix: dashboards without tags break rendering</MESSAGE>
    <SHA>2e751b3dadfd47f1729ddcf7eeff12a192c530c0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix: Redash was using too many db connections Fixes #1561. The issue was caused by creating a new Flask app instance on every task execution, resulting in creating a new SQLALchemy connection pool and a new database connection.</MESSAGE>
      <SHA>e6fc73f4440a69351e56e6db4b9c1f07f3970c6e</SHA>
      <PATCHEDFILES>
        <FILE>redash/tasks/alerts.py</FILE>
        <FILE>redash/tasks/base.py</FILE>
        <FILE>redash/tasks/general.py</FILE>
        <FILE>redash/tasks/queries.py</FILE>
        <FILE>redash/worker.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix: Redash was using too many db connections Fixes #1561. The issue was caused by creating a new Flask app instance on every task execution, resulting in creating a new SQLALchemy connection pool and a new database connection.</MESSAGE>
      <SHA>ee3b07b3ec059a851c37fcac4bcf11f91eb8aa58</SHA>
      <PATCHEDFILES>
        <FILE>tasks/alerts.py</FILE>
        <FILE>tasks/base.py</FILE>
        <FILE>tasks/general.py</FILE>
        <FILE>tasks/queries.py</FILE>
        <FILE>worker.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
