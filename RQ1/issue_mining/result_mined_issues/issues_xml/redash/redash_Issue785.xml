<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>785</ISSUENO>
  <ISSUEURL>https://github.com/getredash/redash/issues/785</ISSUEURL>
  <TITLE>DataError: invalid input syntax for integer: &quot;admin&quot;</TITLE>
  <DESCRIPTION>Latest 0.9.2-RC. When you make a user admin with a checkbox: ![image](https://cloud.githubusercontent.com/assets/89186/12489616/1c1ac55c-c069-11e5-9cee-e97b299f522d.png) ``` [2016-01-21 17:58:21,655][PID:12][ERROR][redash.wsgi] Exception on /api/users/2 [POST] Traceback (most recent call last): File &quot;/usr/local/lib/python2.7/dist-packages/flask/app.py&quot;, line 1475, in full_dispatch_request rv = self.dispatch_request() File &quot;/usr/local/lib/python2.7/dist-packages/flask/app.py&quot;, line 1461, in dispatch_request return self.view_functions[rule.endpoint](**req.view_args) File &quot;/usr/local/lib/python2.7/dist-packages/flask_restful/__init__.py&quot;, line 477, in wrapper resp = resource(*args, **kwargs) File &quot;/usr/local/lib/python2.7/dist-packages/flask_login.py&quot;, line 792, in decorated_view return func(*args, **kwargs) File &quot;/usr/local/lib/python2.7/dist-packages/flask/views.py&quot;, line 84, in view return self.dispatch_request(*args, **kwargs) File &quot;/opt/redash/redash/handlers/base.py&quot;, line 19, in dispatch_request return super(BaseResource, self).dispatch_request(*args, **kwargs) File &quot;/usr/local/lib/python2.7/dist-packages/flask_restful/__init__.py&quot;, line 587, in dispatch_request resp = meth(*args, **kwargs) File &quot;/opt/redash/redash/handlers/users.py&quot;, line 76, in post user.update_instance(**params) File &quot;/opt/redash/redash/models.py&quot;, line 106, in update_instance self.save(only=self.dirty_fields) File &quot;/opt/redash/redash/models.py&quot;, line 93, in save super(BaseModel, self).save(*args, **kwargs) File &quot;/usr/local/lib/python2.7/dist-packages/peewee.py&quot;, line 4146, in save rows = self.update(**field_dict).where(self._pk_expr()).execute() File &quot;/usr/local/lib/python2.7/dist-packages/peewee.py&quot;, line 2751, in execute return self.database.rows_affected(self._execute()) File &quot;/opt/redash/redash/metrics/database.py&quot;, line 50, in metered_execute result = real_execute(self, *args, **kwargs) File &quot;/usr/local/lib/python2.7/dist-packages/peewee.py&quot;, line 2371, in _execute return self.database.execute_sql(sql, params, self.require_commit) File &quot;/opt/redash/redash/metrics/database.py&quot;, line 22, in execute_sql result = super(MeteredPostgresqlExtDatabase, self).execute_sql(*args, **kwargs) File &quot;/usr/local/lib/python2.7/dist-packages/playhouse/postgres_ext.py&quot;, line 369, in execute_sql self.commit() File &quot;/usr/local/lib/python2.7/dist-packages/peewee.py&quot;, line 2922, in __exit__ reraise(new_type, new_type(*exc_value.args), traceback) File &quot;/usr/local/lib/python2.7/dist-packages/playhouse/postgres_ext.py&quot;, line 360, in execute_sql cursor.execute(sql, params or ()) DataError: invalid input syntax for integer: &quot;admin&quot; LINE 1: ...&quot; = E'foo@bar.com', &quot;groups&quot; = ARRAY[2, E'admin'] ... ``` Adding to admin group works.</DESCRIPTION>
  <REPONAME>redash</REPONAME>
  <TIMEDIFFERENCEDAYS>2</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix #792: can't grant admin with CLI</MESSAGE>
    <SHA>fed9d80fdb3a227e89007396f5c964c3186a3cf0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix #785: remove admin check box and direct users to use the groups admin.</MESSAGE>
      <SHA>197bbde7884a8997f6fda1ae61e7b7d1fae13a09</SHA>
      <PATCHEDFILES>
        <FILE>docs/setup.rst</FILE>
        <FILE>rd_ui/app/scripts/controllers/users.js</FILE>
        <FILE>rd_ui/app/views/users/show.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #794 from getredash/hotfixes Fixes for #792, #785, #733 and additional logging for execute_query</MESSAGE>
      <SHA>4e9b60ac8202fc978398f59bfae88d34ddffb292</SHA>
      <PATCHEDFILES>
        <FILE>docs/setup.rst</FILE>
        <FILE>migrations/0003_update_data_source_config.py</FILE>
        <FILE>migrations/0009_add_api_key_to_user.py</FILE>
        <FILE>migrations/0011_migrate_bigquery_to_json.py</FILE>
        <FILE>migrations/0012_add_list_users_permission.py</FILE>
        <FILE>migrations/0014_add_alert_rearm_seconds.py</FILE>
        <FILE>migrations/0014_migrate_existing_es_to_kibana.py</FILE>
        <FILE>migrations/0015_add_schedule_query_permission.py</FILE>
        <FILE>rd_ui/app/scripts/controllers/users.js</FILE>
        <FILE>rd_ui/app/views/users/show.html</FILE>
        <FILE>redash/cli/users.py</FILE>
        <FILE>redash/tasks.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
