<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1039</ISSUENO>
  <ISSUEURL>https://github.com/flowable/flowable-engine/issues/1039</ISSUEURL>
  <TITLE>HttpTask URL not encoded when saved</TITLE>
  <DESCRIPTION>**Description** When using `HTTP Tasks` in the modeler, the `Request URL` is not correctly URL-Encoded when saving the process model. **Problem** This results in errors starting the process (HTTP 500) when there are e.g. not encoded query parameters in the `Request URL`. This can be found in the logs: ``` org.flowable.engine.common.api.FlowableException: Invalid URL exception occurred ... Caused by: java.net.URISyntaxException: Illegal character in query at ... ... ``` **Linked Topics** [Process won't start with HTTP 500 error](https://forum.flowable.org/t/error-starting-new-process-instance-http-500/1956) [Correct URL Encoding for HTTP Task](https://forum.flowable.org/t/http-task-url-encoding/1982)</DESCRIPTION>
  <REPONAME>flowable-engine</REPONAME>
  <TIMEDIFFERENCEDAYS>94</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Async history: add default fallback transformer</MESSAGE>
    <SHA>5b1a0ea5379f5cd2c77d4aad023b10d5bc77ad0b</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix encoding of URL before conversion to URI object (#1039).</MESSAGE>
      <SHA>5bf8ad149e89c4752ad4fb79a0bd468b2323847a</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-http/src/main/java/org/flowable/http/HttpActivityExecutor.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Improve regex to also handle root as application path (#1039).</MESSAGE>
      <SHA>3f64b33e7b212fdf92b5cc8fde73fbaa71f552b1</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-ui-idm/flowable-ui-idm-app/src/main/resources/static/scripts/app-cfg.js</FILE>
        <FILE>modules/flowable-ui-modeler/flowable-ui-modeler-app/src/main/resources/static/scripts/app-cfg.js</FILE>
        <FILE>modules/flowable-ui-task/flowable-ui-task-app/src/main/resources/static/scripts/app-cfg.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Improve regex to also handle root as application path (#1039).</MESSAGE>
      <SHA>ac59bb5b37d714cf7a5256c308a7d57255c5f9c6</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-ui-idm/flowable-ui-idm-app/src/main/resources/static/scripts/app-cfg.js</FILE>
        <FILE>modules/flowable-ui-modeler/flowable-ui-modeler-app/src/main/resources/static/scripts/app-cfg.js</FILE>
        <FILE>modules/flowable-ui-task/flowable-ui-task-app/src/main/resources/static/scripts/app-cfg.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix encoding of URL before conversion to URI object (#1039).</MESSAGE>
      <SHA>22f0d379b3c91391b5c335215e1572358ca3b8f0</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-http/src/main/java/org/flowable/http/HttpActivityExecutor.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Make sure that URL encoding works properly for user defined plus character Do not use parsing to URL then to URI and instead manually replace space and plus characters with their encoded counterparts. This also makes sure that users can use encoded ampersand in request parameters Related to #1039</MESSAGE>
      <SHA>1e56c7de404e72d9df2c78441597f28a1c34ad6c</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-http/pom.xml</FILE>
        <FILE>modules/flowable-http/src/main/java/org/flowable/http/HttpActivityExecutor.java</FILE>
        <FILE>modules/flowable-http/src/test/java/org/flowable/http/bpmn/HttpServiceTaskTest.java</FILE>
        <FILE>modules/flowable-http/src/test/resources/org/flowable/http/bpmn/HttpServiceTaskTest.testGetWithVariableParameters.bpmn20.xml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Make sure that URL encoding works properly for user defined plus character Do not use parsing to URL then to URI and instead manually replace space and plus characters with their encoded counterparts. This also makes sure that users can use encoded ampersand in request parameters Related to #1039</MESSAGE>
      <SHA>0f84c5b731aee0fe5a139919a2d9756d0e67f07a</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-http/pom.xml</FILE>
        <FILE>modules/flowable-http/src/main/java/org/flowable/http/HttpActivityExecutor.java</FILE>
        <FILE>modules/flowable-http/src/test/java/org/flowable/http/bpmn/HttpServiceTaskTest.java</FILE>
        <FILE>modules/flowable-http/src/test/resources/org/flowable/http/bpmn/HttpServiceTaskTest.testGetWithVariableParameters.bpmn20.xml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
