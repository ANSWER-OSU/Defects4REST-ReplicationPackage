<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3894</ISSUENO>
  <ISSUEURL>https://github.com/flowable/flowable-engine/issues/3894</ISSUEURL>
  <TITLE>Process definition id of an async external worker service task job is not updated after direct migration</TITLE>
  <DESCRIPTION>**Describe the bug** When a process instance with an async external worker service task is migrated using direct migration, the process definition id of the external worker service task job is not updated with the process definition id of the new process definition. **Expected behavior** The process definition id of the migrated external worker service task job should contain the process definition id of the new process definition. **Code** I'll add a pull request with a test case. **Additional context** main branch flowable-release-7.0.0 branch flowable-release-7.1.0 branch caused by e82e4d4859a05431489657192f16f49e27f71e1b Add support for direct migration for async service tasks in process migration 9cf6db198f6f0150dd47a1a64c5480e11ac0c3e0 Add support for direct migration for async service tasks in process migration</DESCRIPTION>
  <REPONAME>flowable-engine</REPONAME>
  <TIMEDIFFERENCEDAYS>42</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Added index on task id for historic task log entry (#3892)</MESSAGE>
    <SHA>7683479d8ff8366dff3851b967f9c55f57f36bea</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixed update of a migrated async external worker job with the new process definition id (#3894)</MESSAGE>
      <SHA>d43fb00436facfcb37bd68563af1b071dcfa6069</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/dynamic/AbstractDynamicStateManager.java</FILE>
        <FILE>modules/flowable-engine/src/test/java/org/flowable/engine/test/api/runtime/migration/ProcessInstanceDirectExecutionMigrationExternalWorkerTest.java</FILE>
        <FILE>modules/flowable-engine/src/test/resources/org/flowable/engine/test/api/runtime/migration/one-async-external-worker-simple-process.bpmn20.xml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixed update of a migrated async external worker job with the new process definition id (#3894) (#3895)</MESSAGE>
      <SHA>06881078ba669f2338ddff0a1683c80c9c44a0c3</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/dynamic/AbstractDynamicStateManager.java</FILE>
        <FILE>modules/flowable-engine/src/test/java/org/flowable/engine/test/api/runtime/migration/ProcessInstanceDirectExecutionMigrationExternalWorkerTest.java</FILE>
        <FILE>modules/flowable-engine/src/test/resources/org/flowable/engine/test/api/runtime/migration/one-async-external-worker-simple-process.bpmn20.xml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixed update of a migrated async external worker job with the new process definition id (#3894) (#3895)</MESSAGE>
      <SHA>1d850fc639d839e4d770367b34aeb5878bc869c7</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/dynamic/AbstractDynamicStateManager.java</FILE>
        <FILE>modules/flowable-engine/src/test/java/org/flowable/engine/test/api/runtime/migration/ProcessInstanceDirectExecutionMigrationExternalWorkerTest.java</FILE>
        <FILE>modules/flowable-engine/src/test/resources/org/flowable/engine/test/api/runtime/migration/one-async-external-worker-simple-process.bpmn20.xml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
