<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>15291</ISSUENO>
  <ISSUEURL>https://github.com/TryGhost/Ghost/issues/15291</ISSUEURL>
  <TITLE>Regression: Redirect to signin/re-authenticate modal not shown when logged out</TITLE>
  <DESCRIPTION>We've had a regression with how unauthenticated requests are handled by Admin. Unauthenticated requests could occur if you've logged out in another tab and didn't realise you'd gone back to editing on a tab that looked like it was still logged in. ## Steps to reproduce 1. Open Ghost admin and ensure you're logged in in two different tabs 2. In tab 1, open the editor 3. In tab 2, logout 4. In tab 1, attempt to save ## Previous behaviour - whilst editing - show a re-authentication modal to allow quick sign-in and save - whilst performing any other action - redirect to signin screen ## Current behaviour: - all actions - show a slightly cryptic alert message `Authorization failed Unable to determine the authenticated user or integration. Check that cookies are being passed through if using session authentication.` This is likely happening because we've moved from a `401` to a `403`. The cookie is being sent so the request is not &quot;Unauthenticated&quot; but it no longer matches a valid session so its &quot;Unauthorized&quot;. Admin isn't currently set up to recognise a 403 and trigger the auto-logout/re-authenticate behaviour. There are potential edge cases if we treat 403 and 401 the same when it's a genuine &quot;not permitted&quot; error but Admin shouldn't be making any such requests unless your role is changed by another user whilst you're using it. Note: There is a skipped test for the re-authentication modal here: https://github.com/TryGhost/Ghost/blob/0695f74a653bff85d5a08ee7f97fc9a4a8ddbe63/ghost/admin/tests/acceptance/authentication-test.js#L97 which may have contributed to this regression slipping in. Ideally we'd get this test running again as well to prevent this regressing in future. ### Ghost Version 5.10</DESCRIPTION>
  <REPONAME>Ghost</REPONAME>
  <TIMEDIFFERENCEDAYS>59</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Removed bluebird from `fixture-utils.js` (#15626) refs: https://github.com/TryGhost/Ghost/issues/14882 - Opted to use the in-house `sequence` function when refactoring Bluebird's `Promise.each` to avoid deadlock issues (see https://github.com/TryGhost/Ghost/commit/734ef66e6ce9868fe2143046cb56cdc8e4216ff5). -It's hard to know without tonnes of context if any `Promise.each` are safe to refactor to `Promise.all`.</MESSAGE>
    <SHA>dbad621b91de009d00b05d39cc023c54bd21635c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixed redirect to signin modal not shown when logged out (#15522) fixes: https://github.com/TryGhost/Ghost/issues/15291 - An attempt to improve re-authenticate modal toggle - show re-authenticate modal every time user save (ctrl/cmd + s) - An attempt to fix redirection when user re-login on different tab. Prevent redirection to sign-in page since the user already logged in on another tab. - Re-enable `editor` test on `authentication-test.js`</MESSAGE>
      <SHA>b88a54fb715263e6a663d4556172fd08560ad3df</SHA>
      <PATCHEDFILES>
        <FILE>ghost/admin/app/controllers/editor.js</FILE>
        <FILE>ghost/admin/app/controllers/lexical-editor.js</FILE>
        <FILE>ghost/admin/app/routes/authenticated.js</FILE>
        <FILE>ghost/admin/app/services/session.js</FILE>
        <FILE>ghost/admin/tests/acceptance/authentication-test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge (#1) * Added Tier price and currency data to products table (#15366) refs https://github.com/TryGhost/Team/issues/1765 In order to better handle deleted objects in Stripe we want to decouple Members from Stripe. These changes allow us to have the Tier concept completely independent of the Stripe tables, such that the Stripe data can be generated as/when it's needed - which will help to protect against missing data. * Removed redirects from search engine indexing (#15617) refs https://github.com/TryGhost/Team/issues/2072 Google is indexing our redirects and storign the redirected content against the redirect URL in search results. This seems to be caused by us using a 302 redirect rather than 301. We don't want to switch to a 301 however, so that we can support the ability to update redirects in the future. * Stored price and currency data on Tiers when creating &amp; editing refs https://github.com/TryGhost/Team/issues/2029 This will allow us to start decoupling the Stripe side of things once we've got the core data stored. We've also add some integrity checks on the incoming monthly_price and yearly_price to ensure they are the same currency. * Fixed up more like this and newsletter clicks table at narrower viewports no issue * Updated engagement bar metrics so when no link it doesn't hover no issue * Added the feedback buttons in the emails (#15619) closes TryGhost/Team#2046 closes TryGhost/Team#2045 - Added feedback buttons markup. - Added feedback links generation. * v5.19.0 * Fix newsletter links (#15621) Added a button for editing links in newsletters after sending to the Post analytics page Co-authored-by: Rishabh &lt;zrishabhgarg@gmail.com&gt; * Added ability to handle feedback links from emails (#15622) * Updated test snapshot after bumping Portal (#15623) * Bumped portal package.json to latest version refs https://github.com/TryGhost/Ghost/commit/d381ff87b89285894d7aecd2e2247653ba2c4b8f - portal was bumped to 2.15 but the version in package json didn't get auto-updated * Fixed optional syntax style for jsdoc refs https://jsdoc.app/tags-param.html#optional-parameters-and-default-values - using an equals sign in the type definition is part of the Google Closure syntax but we use the JSDoc syntax in all other places, and tsc detects the different syntax - this commit standardizes the syntax ahead of enforcing a certain style down the line * Bumped `kg-lexical-html-renderer` version no issue - Bumped from 0.0.8 to 0.0.9 * Fixed unnecessary requests with loading comment counts refs https://github.com/TryGhost/Team/issues/2082 - if a site has comments enabled but doesn't use the `comments_count` helper, the comments-count.min.js will still be loaded and it'll send a POST request to Ghost with an empty array of post IDs to fetch - this is unnecessary and we should avoid this extra request for pages that don't need to show comment counts - this commit prevents the comment-counts JS from sending the request if there are no post IDs to fetch * Fixed unnecessary requests with loading comment counts refs https://github.com/TryGhost/Team/issues/2082 - if a site has comments enabled but doesn't use the `comments_count` helper, the comments-count.min.js will still be loaded and it'll send a POST request to Ghost with an empty array of post IDs to fetch - this is unnecessary and we should avoid this extra request for pages that don't need to show comment counts - this commit prevents the comment-counts JS from sending the request if there are no post IDs to fetch * Added handling for unsuccessful comments API requests refs https://github.com/TryGhost/Team/issues/2082 - in the event the API doesn't return a 200 OK, we shouldn't be processing the response from it, as we can end up doing weird things if, for example, an error object is returned * Added handling for unsuccessful comments API requests refs https://github.com/TryGhost/Team/issues/2082 - in the event the API doesn't return a 200 OK, we shouldn't be processing the response from it, as we can end up doing weird things if, for example, an error object is returned * Fixed loading animation for Safari no refs. - the size of the loading animation in Safari wasn't set correctly and didn't always start automatically * Added imageUpload function to Lexical Editor (#15634) no issue - A basic image upload function for testing the image card of the new Lexical Koenig Editor. * Update dependency util to v0.12.5 * Update dependency mocha to v10.1.0 * Fixed 404 collection links for new tags closes https://github.com/TryGhost/Ghost/issues/15608 closes https://github.com/TryGhost/Toolbox/issues/437 refs https://github.com/bookshelf/bookshelf/issues/2111 refs https://github.com/knex/knex/issues/1641 - When new tag was attached to the post the tag collection link returned 404 - instead of a collection with one post - The root cause of the issue and it's flaky behavior (sometimes the collection link was returning correctly) was a race condition between event propagation in routing for &quot;tag.attached&quot; event and the post+tag+relations transaction completion - The race condition was happening as the bookshelf-transaction-events plugin was emitting the 'committed' event BEFORE the transaction was committed! * v5.19.1 * Added conversions count and separate analytics page (#15637) fixes https://github.com/TryGhost/Team/issues/2084 - When audience feedback is enabled, we use a single 'conversions' count instead of having separate ones for signups and paid conversions. - The analytics component is separated so we can change it without breaking the existing page. * Fixed PromiseObject related errors thrown from members activity list (#15641) no issue - the `memberRecord` getter on the members activity controller was returning the direct result of `store.findRecord()` which in reality is a `PromiseObject` that is a type of proxy. Although templates handle this OK, any JS code using the object needs to know that it's not a typical type of object and has to use `.get()` for all property access to avoid errors - switched `memberRecord` from a getter to a resource so we have more control over the returned object and loading lifecycle - added a `MemberFetcher` resource class that awaits the result of the store find and only then sets the value meaning we always have a fully resolved model object - being a resource the fetch will only occur when the `member` id property changes, unlike the getter which performed the fetch every time it was accessed * Added feedback events to activity feed (#15639) fixes https://github.com/TryGhost/Team/issues/2051 fixes https://github.com/TryGhost/Team/issues/2052 * Added support for supplying the foreign key constraint name - this allows us to choose the foreign key constraint name when the auto-generated one would be too long * Allowed `constraintName` in schema column spec refs https://github.com/TryGhost/Ghost/commit/0ba3d6df49dea823e3632be90cf00f6d10c6e914 - this is used to indicate the name of the foreign key constraint and so we should let it through the schema checks * Fixed various code nits with schema command utils - de-duped the exports at the bottom if they export the same name as the function - added types to all functions, or fixed existing ones - renamed `table` to `tableBuilder` to represent it better - these should help with code readability and autocomplete in editors * Dropped nullable status on `subscriptions.tier_id` fixes https://github.com/TryGhost/Team/issues/2102 - this column was added with `nullable: true` but it should never be nullable, so we should drop the nullable status whilst it's easy to * Improved jsdoc for permission migration utils - this helps with readability and editor autocomplete * Fixed large mailgun recipient data (#15638) fixes https://github.com/TryGhost/Team/issues/2096 When generating the recipient data for emails, the email clicks implementation is resulting in a recipient variable being added called replacement_xxx once for each link containing the same UUID. This generates a lot of unnecessary data overhead for emails, and it turns out that mailgun has a 25MB message limit. We wouldn't have come close if we only included the uuid once. * v5.19.2 * Added design for success and error states for editing newsletter links refs https://github.com/TryGhost/Team/issues/2095 refs https://github.com/TryGhost/Team/issues/2098 - Added success state design for editing links in newsletters - Added error state for invalid URL when editing links in newsletters * Fixed broken `ember-svg-jar` asset viewer no issue - downgraded to `2.3.4` because `2.4.0` is missing the asset viewer assets, see https://github.com/voltidev/ember-svg-jar/issues/233 * Update dependency ember-template-lint to v4.16.0 * Added post_id filter and total to activity feed API (#15650) fixes https://github.com/TryGhost/Team/issues/2091 fixes https://github.com/TryGhost/Team/issues/2089 - Added new fixtures to make testing easier for the activity feed - Improved E2E test coverage of activity feed with separate test file - Added data.post_id filter to enable filtering by events related to a given post - Fixed return types in JSDoc of test agents (TypeScript interprets these as `typeof Agent` if we don't add `InstanceType&lt;Agent&gt;`) - Added total pagination metadata to activity feed API (to allow a basic type of pagination using filters) * Fixed alpha feature visible in new newsletters no issue * Added test to check if feedback buttons are hidden if alpha flag is disabled * v5.19.3 * Update dependency ember-template-lint to v4.16.1 * Refactored Tiers logic into separate package refs https://github.com/TryGhost/Team/issues/2078 This pulls the current Tiers logic into its own package, the persistence part of the work has not been done yet, that will be handled in core, so all bookshelf model specific stuff is kept together. * Supported payment URL in Portal refs https://github.com/TryGhost/Team/issues/2078 As part of decoupling Stripe from the members feature, we are going to be using payment URLs rather than Stripe sepcific session ids and publick keys. This prepares Portal to work with the new system, whilst retainign the existing functionality * Made edit link button always visible refs https://github.com/TryGhost/Team/issues/2067 * Added newsletter links editing explanation text refs https://github.com/TryGhost/Team/issues/2067 * Fixed overflow for newsletter links refs https://github.com/TryGhost/Team/issues/2067 * Updated JSDoc and fixed typos * Fixed typo * Fixed typo * Increased test coverage refs https://github.com/TryGhost/Toolbox/issues/430 - The bonus of using the module exports file is that it also gets included in the test coverage statistics ^_^ * Added test coverage for 'subscribed' transform refs https://github.com/TryGhost/Toolbox/issues/430 - Not having any extra logic in the mapper will allow to have a generalized &quot;mapping&quot; concept for CSV input serialization - This is groundwork for stricter header value filtering on the parsing stage * Added JSDoc to members csv parser refs https://github.com/TryGhost/Toolbox/issues/430 - Typings make developer's life nicer * Removed hidden row mapping in csv parser refs https://github.com/TryGhost/Toolbox/issues/430 refs https://github.com/TryGhost/Ghost/issues/14882 - Having an explicit mappings passed into the members CSV parser makes it easier to control and understand the transforms for package clients - Eventually the parser will receive a strict map with the fields it should parse - skipping all unknown &amp; unmapped fields * Extracted MembersCSVImporter to a builder method refs https://github.com/TryGhost/Toolbox/issues/430 refs https://github.com/TryGhost/Ghost/issues/14882 - The MembersCSVImporter constructor is way to complex and needs refactoring. This complexity makes initialization in tests too bulky and makes tests hard to read. - Having a builder method is a stopgap solution to avoid going into MembersCSVImporter refactoring too deep. * Added future investigation note refs https://github.com/TryGhost/Toolbox/issues/430 - This is a strange hardcoded value that seems like some legacy leftover concept we could do without or improve * Removed unused concept of &quot;status&quot; in importer job refs https://github.com/TryGhost/Toolbox/issues/430 - The job &quot;status&quot; is never anything different than &quot;pending&quot; and never leaves the module itself. It's an outdated concept that only takes up lines of code! * Removed cleaned up use of &quot;Job&quot; object refs https://github.com/TryGhost/Toolbox/issues/430 - Importer code was filled with an unnecessarily complex &quot;job&quot; object that was passed around. It had an &quot;id&quot; property, which confusingly was a path to a file at all times. - Simplified the logic significantly by keeping and passing around the path to a &quot;prepared&quot; members CSV. * Added basic test coverage for perform method refs https://github.com/TryGhost/Toolbox/issues/430 - &quot;perform()&quot; is what gets executed by the import job for both immediate import and &quot;inline job&quot; import. Testing it on granular level will allow to change it with more confidence when introducing strict field mapping rules * Moved header mapping configuration to importer refs https://github.com/TryGhost/Toolbox/issues/430 - To be able to introduce strict mapping rules (exclude unknown fields) we need to control the CSV header mapping on the importer level. This change moves the configuration up from CSV parser to the importer - Also adds tests covering correct inserts for specially treated &quot;subscribed_to_emails&quot; field * Cleaned up test case names * Cleaned up csv parse test suite refs https://github.com/TryGhost/Toolbox/issues/430 - Removed unnecessary &quot;readCSV&quot; leftover code. * Added strict header mapping parsing refs https://github.com/TryGhost/Toolbox/issues/430 - Previously the CSV parser had &quot;map whatever you can and pass on unknown properties further&quot; approach to CSV parsing. This logic has led to unwanted fields leaking through CSV imports - messy, dangerous. - The strict mapping rules act as a &quot;validator&quot; to the user input, only passing through the fields we expect explicitly - safer clean cut solution with no unintended side-effects. * Migrated CSV parser tests to 'assert' no issue - Using native 'assert' module in unit tests is a preferred practice. Should is outdated and is phased out of codebase. * Removed unused error message no issue - The job-related code was ripped out form the importer and this message was just an overlooked leftover * Made running the import outside of job on test env - Allows to write tests for the importer easier when there is a &quot;subscription&quot; or a &quot;product&quot; present * Added strict field mapping to member CSV importer closes https://github.com/TryGhost/Toolbox/issues/430 - The members importer used to import all fields present in the uploaded CSV if the headers match, even if they're not mapped in the UI. This behavior has lead to have misleading consequences and &quot;hidden&quot; features. For example, if the field was present but intentionally left as &quot;Not imported&quot; in the UI the field would still get imported. - Having a strict list of supported import fields also allows for manageable long-term maintenance of the CSV Import API and detect/communicate changes when they happen. - The list of the current default field mapping is: email: 'email', name: 'name', note: 'note', subscribed_to_emails: 'subscribed', created_at: 'created_at', complimentary_plan: 'complimentary_plan', stripe_customer_id: 'stripe_customer_id', labels: 'labels', products: 'products' * Fixed broken CSV importer tests refs https://github.com/TryGhost/Ghost/commit/90768e9985e756a2706508beeb5c50e34516a170 - With introduction of strict field mapping the regression test testing for &quot;imports of not mapped fields&quot; failed. * Added tabs component (#15652) closes TryGhost/Team#2086 * Updated feedback buttons url (#15655) closes TryGhost/Team#2080 - If the post was published and emailed the link leads the user to the post. - If the post was just emailed the link leads the user to the home page. * Remove Grunt from `yarn setup` in Ghost core no issue * Added design for edited state of newsletter links refs https://github.com/TryGhost/Team/issues/2111 - Added indicator that the link in a newsletter has been edited after sending * Wired newsletter link success/error states refs https://github.com/TryGhost/Team/issues/2116 - wires handling of success and error messages on editing a newsletter link - has the update api commented out temporarily to mock the changes * Added sentiment ordering and include for posts (#15657) fixes https://github.com/TryGhost/Team/issues/2090 - This changes how sentiment is exposed in the API. Now it is exposed as a `sentiment` relation, directly on the model (no longer in counts). Internally we still use `count.sentiment`. - Content API users (and themes) can include the 'sentiment' relation and order by sentiment. - Updated Admin to use sentiment instead of count.sentiment * Fixed period filter not appearing on smaller screens on dashboard no ref * Added edited state for newsletter links refs https://github.com/TryGhost/Team/issues/2111 - shows edited in UI next to edited newsletter links in post analytics * Handled no empty sources for attribution table - fixes an edge case where if a site has no unavailable sources in a particular period, it broke the table view as the `Others` data doesn't get fetched * Fixed up the more like this event icons as they were too large refs https://github.com/TryGhost/Team/issues/2106 * Update dependency mocha to v10.1.0 * Fixed permissions for links endpoint (#15656) refs https://github.com/TryGhost/Ghost/commit/5fcf5098a84eea5aed82a412718e6dde8d2b725a - links browse endpoint had permissions switched off unintentionally and was also missing the necessary permissions in fixtures. - enables permissions for browse endpoint and adds migration insert permissions in DB * Update dependency ember-svg-jar to v2.4.1 * Update peter-evans/create-or-update-comment digest to 7305482 * Added permissions for link edit endpoints (#15664) refs https://github.com/TryGhost/Team/issues/2104 - adds edit permissions for links endpoints to fixtures - new `bulkEdit` endpoint will use the permissions and allow fixing newsletter links via Admin * Added `ghost_subscription_id` column to `members_stripe_customers_subscriptions` refs https://github.com/TryGhost/Team/issues/2034 - this table will be used to link Stripe subscriptions to Ghost subscriptions via a foreign key that we add at a later point - this also includes `constraintName` as the auto-generated one would be too long for MySQL 8 * Refactored TiersAPI to use core slug generation refs https://github.com/TryGhost/Team/issues/2078 This removes the burden from the Tier object, and allows us to reuse the existing slug generation implementation we have in our bookshelf models. * Fixed visibility property on Tiers refs https://github.com/TryGhost/Team/issues/2078 This property should be settable to either 'public' or 'none' * Updated Tier to use camelCase property names refs https://github.com/TryGhost/Team/issues/2078 Having to map between snake_case and camelCase was becoming confusing, so this updates the Tier object to exclusively use camelCase, and the snake_case for the API can be handled by the serializer/mapper or at the controller level. * Updated Tier welcomePageURL to be a string rather than URL refs https://github.com/TryGhost/Team/issues/2078 We allow passing in relative URLs for the welcome page, so we need to accept a string for this property. * Fixed trialDays validation to default to 0 refs https://github.com/TryGhost/Team/issues/2078 This retains current functionality * Added error messages for monthly &amp; yearly price validation refs https://github.com/TryGhost/Team/issues/2078 These were missing, and will be refactored into the correct tpl(messages.prop) format * Fixed edit method to accept a string refs https://github.com/TryGhost/Team/issues/2078 This fixes a bug with the edit method where we passed a raw string rather than ObjectID * Fixed add method for TiersAPI refs https://github.com/TryGhost/Team/issues/2078 The check for creating free Tiers needs to be explicit, rather than implicit because the type is optional, we only want to error if it is explicitly passed as &quot;free&quot;, not if it is missing as &quot;paid&quot;. * Removed garbage test no issue - This test does nothing but occupy the disc space * Moved the resources to the new style refs https://github.com/TryGhost/Team/issues/2117 * Added 'getDefaultProduct' convenience method to product repo refs https://github.com/TryGhost/Team/issues/1869 - There are multiple places in the codebase fetching &quot;default product&quot;. The code is slightly divergent in each one of them and has been a source of bugs (like the one referenced). Having the logic captured in one place will allow reducing the code duplication, making code less bug prone, and making testing the modules dependent on the &quot;setDefaultProduct&quot; method easier * Fixed comped tier assignment closes https://github.com/TryGhost/Team/issues/1869 - When there were &quot;archived&quot; tiers in the system the importer incorrectly fetched them instead of only taking &quot;active&quot; ones into account. The &quot;getDefaultProduct&quot; on product repository does exactly that. - Additionally, reusing the &quot;getDefaultProduct&quot; makes testing the importer slightly less complex. * Reused getDefaultProduct where possible refs https://github.com/TryGhost/Ghost/commit/82ed10473b0b2afc100a461129b2178557f588ac refs https://github.com/TryGhost/Team/issues/1869 - getDefaultProduct has unified logic across different places (see refed commit). It is recommended to use instead of writing custom queries prone to mistakes. - Also added more readable name to the possible error message thrown by setComplimentarySubscription * Added button for saving changes made to the link refs https://github.com/TryGhost/Team/issues/2125 * Added support for Tier events refs https://github.com/TryGhost/Team/issues/2078 These events are all required for other parts of the Ghost system to stay in sync. The events on each Tier object will be dispatched by the TierRepository once they've been persisted. TierCreatedEvent - generate Stripe Products &amp; Prices TierNameChangeEvent - update Stripe Products TierPriceChangeEvent - update Stripe Products &amp; Prices TierArchivedEvent - update the Portal settings for visible tiers - disable Stripe Products &amp; Prices TierActivatedEvent - enable Stripe Products &amp; Prices * Exported Tier events from tiers package These are required to be exported so that external code can subscribe to the events. * Made default and editing states the same height refs https://github.com/TryGhost/Team/issues/2067 * Added support for filtering email events by post_id (#15666) refs https://github.com/TryGhost/Team/issues/2093 * Moving the post analytics layout closer to new design - Newsletter clicks module has new header and box - Source attribution module has new header and box - Resources have new headers inside the box - New split layout if there are two modules side-by-side refs https://github.com/TryGhost/Team/issues/2119 * Added endpoint for fixing newsletter links refs https://github.com/TryGhost/Team/issues/2104 - adds new bulk edit endpoint for links, updates all matching link with the current redirect url and update to new url * Added reset for link click count on edit refs https://github.com/TryGhost/Team/issues/2104 When a newsletter link is edited, we reset its click count to 0 to show only the clicks on newly edited links. This is done by only counting the member click events for a link which are greater than its last updated at, so that all previous click events are not counted for the link, but are included in the total count of all links on the page. * Wired link update api on Admin refs https://github.com/TryGhost/Team/issues/2116 - wires link update API on post analytics UI page to save edited links for a newsletter - all links matching the edited link are updated by the API in the backend * Added edited property to links api refs https://github.com/TryGhost/Team/issues/2104 - adds a boolean `edited` property to links api that denotes if the link has been edited * Updated success state for link update on Admin refs https://github.com/TryGhost/Team/issues/2116 - removes extra redundant success state handling * Fixed first and last child padding in edit mode refs https://github.com/TryGhost/Team/issues/2067 * Added missing dependencies for link tracking * Improved responsiveness refs https://github.com/TryGhost/Team/issues/2067 * Deemphasized edited state refs https://github.com/TryGhost/Team/issues/2127 * Fixed missing padding in post analytics header refs https://github.com/TryGhost/Team/issues/2127 * Fixed unrelated elements sharing the same CSS class refs https://github.com/TryGhost/Team/issues/2127 * Vertically aligned icons refs https://github.com/TryGhost/Team/issues/2127 * Fixed explanation text not showing when there's no pagination refs https://github.com/TryGhost/Team/issues/2127 * Added retry button in error state refs https://github.com/TryGhost/Team/issues/2127 * Fixed jumping of links on edit in analytics refs https://github.com/TryGhost/Team/issues/2116 - editing a link caused it to jump in the list as its count is reset to 0 - this forces the order of links same after edit, the new order is only visible on refresh or navigating away and coming back * Added filtered events tables to the analytics page (#15669) closes TryGhost/Team#2087 * Updated edited state font weight for better contrast refs https://github.com/TryGhost/Team/issues/2127 * Removed unnecessary padding refs https://github.com/TryGhost/Team/issues/2127 * Updated save button handling for links refs https://github.com/TryGhost/Team/issues/2116 * Fixed row hover effects in dark mode refs https://github.com/TryGhost/Team/issues/2127 * Changed explainer text color and icon to deemphasize it refs https://github.com/TryGhost/Team/issues/2127 * Refined link edit flow on Admin refs https://github.com/TryGhost/Team/issues/2116 * Fixed cached redirects for edited newsletter links refs https://github.com/TryGhost/Team/issues/2135 The email link redirects on Pro are cached as 302 redirects in Varnish, so we're missing further clicks after the first one for each member, until the cache is invalidated. This change invalidates cache on link edits to ensure that we correctly redirect members to updated link everytime * Fixed lint * Improved URL syncing between Admin and Explore (#15640) no issue Improve the route communication between Ghost Admin and Ghost Explore to reflect route changes in the URL and correctly navigate to Explore sub routes * Improved readability of unparse test refs https://github.com/TryGhost/Team/issues/1076 - The column parameter has default behavior attached to it, so it is best to have it mentioned and used in an explicit way. * Migrated unparse test suite to assert refs https://github.com/TryGhost/Team/issues/1076 - The 'should' assertion library is deprecated. Native 'assert' is the recommended lib to use - Migrating this bit of code allows to remove the should's &quot;utils&quot; folder. Less code, yey! * Removed test &quot;utils&quot; folder refs https://github.com/TryGhost/Team/issues/1076 - The members-csv package does not use &quot;should&quot; for assertions anymore, so the accompanying &quot;utils&quot; lib can go away now * Added 100% unit test coverage to unparse refs https://github.com/TryGhost/Team/issues/1076 - 100% is the golden standard. Easy to keep it this way once there * Changed members export to contain tiers refs https://github.com/TryGhost/Team/issues/1076 - The &quot;products&quot; is a legacy term for what is now &quot;tiers&quot; since multiple tiers feature introduction in https://github.com/TryGhost/Ghost/releases/tag/v4.39.0 - Note, the &quot;tiers&quot; is a field meant for informational purposes and cannot be imported back into Ghost site. * Fixed date format for link bulk edit refs https://github.com/TryGhost/Team/issues/2104 - updates date format for `updated_at` to use the right DB date format * Refined link edit cancellation on analytics page refs https://github.com/TryGhost/Team/issues/2116 - ignores blur events when link is edited via keypress * Added e2e tests for `post.edited` webhook (#15625) refs: https://github.com/TryGhost/Ghost/issues/15537 - snapshot test created to add confidence to webhook stability and increase overall test coverage. * Added e2e tests for `member.edited` webhook (#15620) refs: https://github.com/TryGhost/Ghost/issues/15537 - snapshot test created to add confidence to webhook stability and increase overall test coverage. * Added e2e tests for `page.edited` webhook (#15627) refs: https://github.com/TryGhost/Ghost/issues/15537 - snapshot test created to add confidence to webhook stability and increase overall test coverage. * Updated explainer text design refs https://github.com/TryGhost/Team/issues/2127 * Added e2e test for `post.unpublished` webhook (#15628) refs: https://github.com/TryGhost/Ghost/issues/15537 - snapshot test created to add confidence to webhook stability and increase overall test coverage. * Fixed test snapshots refs https://github.com/TryGhost/Ghost/commit/5b283930f065ffcc037eeceadd83455f4d09a731 * Quick tweak to max height when there are columns side-by-side refs https://github.com/TryGhost/Team/issues/2118 * Added e2e tests for `page.unpublished` webhook (#15613) refs: https://github.com/TryGhost/Ghost/issues/15537 - snapshot test created to add confidence to webhook stability and increase overall test coverage. * Updated webhook test snapshots refs: https://github.com/TryGhost/Ghost/commit/717a27c85c340646b6d2042b5a9dcbe7fce6e166 refs: https://github.com/TryGhost/Ghost/commit/6380b82793e759a68999cb342c198d9d38fa68b1 - The snapshots just needed updating * Better matching the pagination styles across modules for post analytics - Careful of flags, having different paginations depending on those - Little stylistic adjustment to how pagination is shown on engagement bar - Quite a few feature flag checks to make sure the right style is showing refs https://github.com/TryGhost/Team/issues/2136 * Added importer for custom theme settings (#15596) closes: https://github.com/TryGhost/Ghost/issues/15542 - custom theme settings were not reinstated on import - importing custom theme settings for the current active theme requires the theme be re-activated * Moved the newsletter settings option for audience feedback based on feedback refs https://github.com/TryGhost/Team/issues/2124 * âœ¨ Allowed fixing newsletter links (#15672) refs https://github.com/TryGhost/Team/issues/2116 - allows site owners to edit a link in a post that has already been sent out, fixing any typos or other mistakes - resets click counter for the edited link back to 0 so site owners can see the clicks on new link, doesn't change the overall click count * v5.20.0 * Changing the metric to positive feedback rather than more like this refs https://github.com/TryGhost/Team/issues/2138 * Making avatar initials smaller in the engagement bar refs https://github.com/TryGhost/Team/issues/2139 * Added new members filters and refactored filters (#15667) fixes https://github.com/TryGhost/Team/issues/2112 - Removed a bit of duplicate code across templates and components that was used to handle filters - Updated filter objects to contain information about the filter - Added resource filters that are able to select a single resource, which can be used in columns - Filters can now define columns by themselves. Not all columns already make use of this functionality, but we can move those over later (cleanup: https://github.com/TryGhost/Team/issues/2133) - The filter definitions became quite long. We should move them to separate files in the future: https://github.com/TryGhost/Team/issues/2134 - Filters can now have custom NQL parsing - Improved support for parsing recursive or grouped NQL queries - Added support for filtering members by feedback * Improved post activity feed table no issue - Fixed counter at the bottom - Fixed forward &gt; backward not working * Add in dummy rows and empty states to the engagement bar refs https://github.com/TryGhost/Team/issues/2130 * Removed bluebird from fixture-manager.js (#15629) refs: https://github.com/TryGhost/Ghost/issues/14882 - Removing bluebird specific methods in favour of the Ghost sequence method so we can remove the bluebird dependency Co-authored-by: Hannah Wolfe &lt;github.erisds@gmail.com&gt; * Added pie chart for activity feed (#15673) closes TryGhost/Team#2088 - Added pie chart to feedback event - Added `negative_feedback` field to response from BE * Removed bluebird from `fixture-utils.js` (#15626) refs: https://github.com/TryGhost/Ghost/issues/14882 - Opted to use the in-house `sequence` function when refactoring Bluebird's `Promise.each` to avoid deadlock issues (see https://github.com/TryGhost/Ghost/commit/734ef66e6ce9868fe2143046cb56cdc8e4216ff5). -It's hard to know without tonnes of context if any `Promise.each` are safe to refactor to `Promise.all`. * Fixed redirect to signin modal not shown when logged out (#15522) fixes: https://github.com/TryGhost/Ghost/issues/15291 - An attempt to improve re-authenticate modal toggle - show re-authenticate modal every time user save (ctrl/cmd + s) - An attempt to fix redirection when user re-login on different tab. Prevent redirection to sign-in page since the user already logged in on another tab. - Re-enable `editor` test on `authentication-test.js` * Fixed missing unsaved changes modal for member newsletters (#15564) closes: https://github.com/TryGhost/Ghost/issues/15507 - manually handle relationship changes detection labels and newsletters - add `dirtyAttributes` controller property - return newsletters and labels dirty attributes status * Lock file maintenance * Update dependency eslint to v8.26.0 * Update dependency ember-auto-import to v2.4.3 * Update dependency inquirer to v8.2.5 * Update dependency concurrently to v7.5.0 * Update dependency @babel/plugin-proposal-decorators to v7.19.6 * Update dependency ember-svg-jar to v2.4.2 * Updated @tryghost dependencies (#15631) Co-authored-by: renovate[bot] &lt;29139614+renovate[bot]@users.noreply.github.com&gt; * Update dependency html-validate to v7.7.0 * Released Portal v2.16.0 * Fixed default feedback enabled when flag is disabled (#15660) fixes https://github.com/TryGhost/Team/issues/2114 fixes https://github.com/TryGhost/Team/issues/2115 When a new newsletter is created, the frontend will send feedback_enabled to true. We'll catch this in the backend and don't allow setting feedback_enabled to true when audience_feedback flag is disabled. This is also handled for editing newsletters. To fix this in existing sites, I added a migration that disables feedback for all sites (since this is an alpha feature). Once we'll release the feature later, it will be disabled for existing newsletters, just like expected. * Added email sent events (#15682) fixes https://github.com/TryGhost/Team/issues/2137 For the analytics page, we need the sent events to show up immediately after sending an email. Otherwise we need to wait for emails to be marked as received (which takes too long) before being able to show them on the analytics page. This adds the email_sent_event, which is hidden by default everywhere and used on the analytics page. * Added dark mode styles to the post analytics table no issue * Rearranged the markup so the empty state shows ok without pie chart refs https://github.com/orgs/TryGhost/projects/60 * Restricted members importer to ignore &quot;products&quot; column refs https://github.com/TryGhost/Team/issues/1076 refs https://github.com/TryGhost/Ghost/commit/70229e4fd328b3890f4cd02246b0ba77b510ff48#diff-b67ecda91b5bd79c598e5c5a9ec2ccf28dbfab6a924b21352273865e07cd7ceaR57 - The &quot;products&quot; column has not been doing any logic anything since at least 5.20.0 (see refed commit). The concept of columns in the export file was mostly there for analytical/data filtering reasons - so the user could analyze their exports. CSV was never a good suite for relational data that &quot;products&quot; (or now tiers) represent - The &quot;tiers&quot; column will still be present in the exported CSV file, but there is not going to be any logic attached to it. - The only columns that can effect the &quot;tiers&quot; state of the member are: &quot;complimentary_plan&quot; (assign default tier to the member) and &quot;stripe_customer_id&quot; (pulls in subscription/tier data from Stripe) * Cleaned up leftover &quot;product&quot; variable naming refs https://github.com/TryGhost/Team/issues/1076 - &quot;product&quot; in the context of members has been deprecated since introduction of &quot;tiers&quot; * Improved the error modals for audience feedback and newsletter unsubscribe - Main goal to improve modal when audience feedback fails - Felt right to also improve the newsletter unsubscribe issue, too - Makes this more pleasing to read and look at, nothing fancy refs https://github.com/TryGhost/Team/issues/2081 * Released Portal v2.17.0 * Released Portal v2.18.0 * Update the portal version number no issue * Fixed snapshot tests refs https://github.com/TryGhost/Ghost/commit/30ecaef329570b49f33284adf8ee0f1d6bb7f72c * Added e2e tests for `post.unscheduled` webhook (#15675) refs: https://github.com/TryGhost/Ghost/issues/15537 - snapshot test created to add confidence to webhook stability and increase overall test coverage. * Added e2e tests for `post.published.edited` webhook (#15642) refs: https://github.com/TryGhost/Ghost/issues/15537 - snapshot test created to add confidence to webhook stability and increase overall test coverage. Co-authored-by: Kritika Sharma &lt;kritikasharma@Kritikas-MacBook-Pro-2.local&gt; * Renamed the member links to be something simpler on Post Analytics page refs https://github.com/TryGhost/Team/issues/2147 * Updated webhook test snapshots refs: https://github.com/TryGhost/Ghost/commit/26d049911c1c3179ed9cbab415b5ec5b9215d78f refs: https://github.com/TryGhost/Ghost/commit/8c2f832573f6e4b38a548c88ca6759e29e0aa38f - snapshots fell behind between the two referenced commits, and needed updating Co-authored-by: Fabien 'egg' O'Carroll &lt;fabien@allou.is&gt; Co-authored-by: James Morris &lt;moreofmorris@users.noreply.github.com&gt; Co-authored-by: Elena Baidakova &lt;lena.baydakova@gmail.com&gt; Co-authored-by: Ghost CI &lt;41898282+github-actions[bot]@users.noreply.github.com&gt; Co-authored-by: Djordje Vlaisavljevic &lt;dzvlais@gmail.com&gt; Co-authored-by: Rishabh &lt;zrishabhgarg@gmail.com&gt; Co-authored-by: Daniel Lockyer &lt;hi@daniellockyer.com&gt; Co-authored-by: Ronald Langeveld &lt;hi@ronaldlangeveld.com&gt; Co-authored-by: Peter Zimon &lt;peter.zimon@gmail.com&gt; Co-authored-by: renovate[bot] &lt;29139614+renovate[bot]@users.noreply.github.com&gt; Co-authored-by: Naz &lt;hi@nazavo.com&gt; Co-authored-by: Simon Backx &lt;simon@ghost.org&gt; Co-authored-by: Kevin Ansfield &lt;kevin@ghost.org&gt; Co-authored-by: Kevin Ansfield &lt;kevin@lookingsideways.co.uk&gt; Co-authored-by: Sam Lord &lt;hello@samlord.me&gt; Co-authored-by: Rishabh Garg &lt;rish@ghost.org&gt; Co-authored-by: Aileen Booker &lt;AileenCGN@gmail.com&gt; Co-authored-by: Shubhadeep Das &lt;dshubhadeep@gmail.com&gt; Co-authored-by: illiteratewriter &lt;manukoshyabraham@gmail.com&gt; Co-authored-by: Shashank Gupta &lt;shaz4194@gmail.com&gt; Co-authored-by: Samprit JC &lt;sampritchaurasiya07@gmail.com&gt; Co-authored-by: Halldor Thorhallsson &lt;halldorbjarni@gmail.com&gt; Co-authored-by: Hannah Wolfe &lt;github.erisds@gmail.com&gt; Co-authored-by: Hakim Razalan &lt;hakim.razalan@gmail.com&gt; Co-authored-by: Dominik Picheta &lt;dominikpicheta@googlemail.com&gt; Co-authored-by: Kritika Sharma &lt;kritikash18@gmail.com&gt; Co-authored-by: Kritika Sharma &lt;kritikasharma@Kritikas-MacBook-Pro-2.local&gt;</MESSAGE>
      <SHA>7f228edd2a9bb39d7110f16d5112aab7594dd3d2</SHA>
      <PATCHEDFILES>
        <FILE>.github/workflows/migration-review.yml</FILE>
        <FILE>ghost/adapter-manager/package.json</FILE>
        <FILE>ghost/admin/app/components/gh-explore-iframe.js</FILE>
        <FILE>ghost/admin/app/components/gh-resource-select.hbs</FILE>
        <FILE>ghost/admin/app/components/gh-resource-select.js</FILE>
        <FILE>ghost/admin/app/components/koenig-lexical-editor.js</FILE>
        <FILE>ghost/admin/app/components/member-attribution/source-attribution-table.js</FILE>
        <FILE>ghost/admin/app/components/member/activity-feed.hbs</FILE>
        <FILE>ghost/admin/app/components/member/activity-feed.js</FILE>
        <FILE>ghost/admin/app/components/members-activity/event-type-filter.js</FILE>
        <FILE>ghost/admin/app/components/members/filter-value.hbs</FILE>
        <FILE>ghost/admin/app/components/members/filter-value.js</FILE>
        <FILE>ghost/admin/app/components/members/filter.hbs</FILE>
        <FILE>ghost/admin/app/components/members/filter.js</FILE>
        <FILE>ghost/admin/app/components/members/list-item-column.hbs</FILE>
        <FILE>ghost/admin/app/components/members/list-item-column.js</FILE>
        <FILE>ghost/admin/app/components/modals/newsletters/edit/settings.hbs</FILE>
        <FILE>ghost/admin/app/components/posts/analytics.hbs</FILE>
        <FILE>ghost/admin/app/components/posts/analytics.js</FILE>
        <FILE>ghost/admin/app/components/posts/feedback-events-chart.hbs</FILE>
        <FILE>ghost/admin/app/components/posts/feedback-events-chart.js</FILE>
        <FILE>ghost/admin/app/components/posts/feedback-events-tooltip-template.hbs</FILE>
        <FILE>ghost/admin/app/components/posts/links-table.hbs</FILE>
        <FILE>ghost/admin/app/components/posts/links-table.js</FILE>
        <FILE>ghost/admin/app/components/posts/old-analytics.hbs</FILE>
        <FILE>ghost/admin/app/components/posts/old-analytics.js</FILE>
        <FILE>ghost/admin/app/components/posts/post-activity-feed.hbs</FILE>
        <FILE>ghost/admin/app/components/posts/post-activity-feed.js</FILE>
        <FILE>ghost/admin/app/components/tabs/tab-panel.hbs</FILE>
        <FILE>ghost/admin/app/components/tabs/tab-panel.js</FILE>
        <FILE>ghost/admin/app/components/tabs/tab.hbs</FILE>
        <FILE>ghost/admin/app/components/tabs/tab.js</FILE>
        <FILE>ghost/admin/app/components/tabs/tabs.hbs</FILE>
        <FILE>ghost/admin/app/components/tabs/tabs.js</FILE>
        <FILE>ghost/admin/app/controllers/editor.js</FILE>
        <FILE>ghost/admin/app/controllers/explore.js</FILE>
        <FILE>ghost/admin/app/controllers/lexical-editor.js</FILE>
        <FILE>ghost/admin/app/controllers/member.js</FILE>
        <FILE>ghost/admin/app/controllers/members-activity.js</FILE>
        <FILE>ghost/admin/app/controllers/members.js</FILE>
        <FILE>ghost/admin/app/helpers/activity-feed-fetcher.js</FILE>
        <FILE>ghost/admin/app/helpers/member-fetcher.js</FILE>
        <FILE>ghost/admin/app/helpers/members-event-filter.js</FILE>
        <FILE>ghost/admin/app/helpers/parse-member-event.js</FILE>
        <FILE>ghost/admin/app/index.html</FILE>
        <FILE>ghost/admin/app/models/post.js</FILE>
        <FILE>ghost/admin/app/routes/authenticated.js</FILE>
        <FILE>ghost/admin/app/routes/explore.js</FILE>
        <FILE>ghost/admin/app/routes/explore/index.js</FILE>
        <FILE>ghost/admin/app/routes/member.js</FILE>
        <FILE>ghost/admin/app/services/member-import-validator.js</FILE>
        <FILE>ghost/admin/app/services/session.js</FILE>
        <FILE>ghost/admin/app/styles/app-dark.css</FILE>
        <FILE>ghost/admin/app/styles/components/power-select.css</FILE>
        <FILE>ghost/admin/app/styles/layouts/content.css</FILE>
        <FILE>ghost/admin/app/styles/layouts/dashboard.css</FILE>
        <FILE>ghost/admin/app/styles/layouts/members.css</FILE>
        <FILE>ghost/admin/app/templates/members.hbs</FILE>
        <FILE>ghost/admin/app/templates/posts/analytics.hbs</FILE>
        <FILE>ghost/admin/app/templates/settings/labs.hbs</FILE>
        <FILE>ghost/admin/ember-cli-build.js</FILE>
        <FILE>ghost/admin/package.json</FILE>
        <FILE>ghost/admin/public/assets/icons/empty-clicked.svg</FILE>
        <FILE>ghost/admin/public/assets/icons/empty-conversion.svg</FILE>
        <FILE>ghost/admin/public/assets/icons/empty-feedback.svg</FILE>
        <FILE>ghost/admin/public/assets/icons/empty-opened.svg</FILE>
        <FILE>ghost/admin/public/assets/icons/empty-sent.svg</FILE>
        <FILE>ghost/admin/public/assets/icons/event-less-like-this--feature-attribution.svg</FILE>
        <FILE>ghost/admin/public/assets/icons/event-less-like-this.svg</FILE>
        <FILE>ghost/admin/public/assets/icons/event-more-like-this--feature-attribution.svg</FILE>
        <FILE>ghost/admin/public/assets/icons/event-more-like-this.svg</FILE>
        <FILE>ghost/admin/tests/acceptance/authentication-test.js</FILE>
        <FILE>ghost/admin/tests/acceptance/members/filter-test.js</FILE>
        <FILE>ghost/admin/tests/integration/components/tabs/tabs-test.js</FILE>
        <FILE>ghost/api-framework/package.json</FILE>
        <FILE>ghost/api-version-compatibility-service/package.json</FILE>
        <FILE>ghost/audience-feedback/lib/AudienceFeedbackService.js</FILE>
        <FILE>ghost/audience-feedback/package.json</FILE>
        <FILE>ghost/audience-feedback/test/AudienceFeedbackService.test.js</FILE>
        <FILE>ghost/audience-feedback/test/hello.test.js</FILE>
        <FILE>ghost/bootstrap-socket/package.json</FILE>
        <FILE>ghost/constants/package.json</FILE>
        <FILE>ghost/core/core/frontend/public/robots.txt</FILE>
        <FILE>ghost/core/core/frontend/src/comment-counts/js/comment-counts.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/links.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/members.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/posts-public.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/posts.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/utils/serializers/input/posts.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/utils/serializers/output/index.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/utils/serializers/output/links.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/utils/serializers/output/mappers/activity-feed-events.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/utils/serializers/output/mappers/emails.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/utils/serializers/output/mappers/posts.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/utils/serializers/output/mappers/snippets.js</FILE>
        <FILE>ghost/core/core/server/api/endpoints/utils/serializers/output/members.js</FILE>
        <FILE>ghost/core/core/server/data/importer/importers/data/custom-theme-settings.js</FILE>
        <FILE>ghost/core/core/server/data/importer/importers/data/data-importer.js</FILE>
        <FILE>ghost/core/core/server/data/migrations/utils/permissions.js</FILE>
        <FILE>ghost/core/core/server/data/migrations/versions/5.19/2022-09-02-20-25-add-columns-to-products-table.js</FILE>
        <FILE>ghost/core/core/server/data/migrations/versions/5.19/2022-09-02-20-52-backfill-new-product-columns.js</FILE>
        <FILE>ghost/core/core/server/data/migrations/versions/5.20/2022-10-18-05-39-drop-nullable-tier-id.js</FILE>
        <FILE>ghost/core/core/server/data/migrations/versions/5.20/2022-10-18-10-13-add-ghost-subscription-id-column-to-mscs.js</FILE>
        <FILE>ghost/core/core/server/data/migrations/versions/5.20/2022-10-19-11-17-add-link-browse-permissions.js</FILE>
        <FILE>ghost/core/core/server/data/migrations/versions/5.20/2022-10-20-02-52-add-link-edit-permissions.js</FILE>
        <FILE>ghost/core/core/server/data/migrations/versions/5.21/2022-10-24-07-23-disable-feedback-enabled.js</FILE>
        <FILE>ghost/core/core/server/data/schema/commands.js</FILE>
        <FILE>ghost/core/core/server/data/schema/fixtures/fixture-manager.js</FILE>
        <FILE>ghost/core/core/server/data/schema/fixtures/fixtures.json</FILE>
        <FILE>ghost/core/core/server/data/schema/schema.js</FILE>
        <FILE>ghost/core/core/server/models/base/plugins/actions.js</FILE>
        <FILE>ghost/core/core/server/models/email-recipient.js</FILE>
        <FILE>ghost/core/core/server/models/email.js</FILE>
        <FILE>ghost/core/core/server/models/member-click-event.js</FILE>
        <FILE>ghost/core/core/server/models/member-paid-subscription-event.js</FILE>
        <FILE>ghost/core/core/server/models/member.js</FILE>
        <FILE>ghost/core/core/server/models/post.js</FILE>
        <FILE>ghost/core/core/server/models/redirect.js</FILE>
        <FILE>ghost/core/core/server/services/audience-feedback/index.js</FILE>
        <FILE>ghost/core/core/server/services/bulk-email/bulk-email-processor.js</FILE>
        <FILE>ghost/core/core/server/services/link-redirection/LinkRedirectRepository.js</FILE>
        <FILE>ghost/core/core/server/services/link-tracking/PostLinkRepository.js</FILE>
        <FILE>ghost/core/core/server/services/link-tracking/index.js</FILE>
        <FILE>ghost/core/core/server/services/mega/email-preview.js</FILE>
        <FILE>ghost/core/core/server/services/mega/feedback-buttons.js</FILE>
        <FILE>ghost/core/core/server/services/mega/post-email-serializer.js</FILE>
        <FILE>ghost/core/core/server/services/mega/template.js</FILE>
        <FILE>ghost/core/core/server/services/members/api.js</FILE>
        <FILE>ghost/core/core/server/services/newsletters/index.js</FILE>
        <FILE>ghost/core/core/server/services/newsletters/service.js</FILE>
        <FILE>ghost/core/core/server/services/url/UrlGenerator.js</FILE>
        <FILE>ghost/core/core/server/web/api/endpoints/admin/routes.js</FILE>
        <FILE>ghost/core/core/shared/config/defaults.json</FILE>
        <FILE>ghost/core/core/shared/labs.js</FILE>
        <FILE>ghost/core/package.json</FILE>
        <FILE>ghost/core/test/e2e-api/admin/__snapshots__/activity-feed.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-api/admin/__snapshots__/email-previews.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-api/admin/__snapshots__/links.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-api/admin/__snapshots__/members-exporter.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-api/admin/__snapshots__/members-newsletters.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-api/admin/__snapshots__/members.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-api/admin/__snapshots__/posts.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-api/admin/__snapshots__/settings.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-api/admin/__snapshots__/stats.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-api/admin/activity-feed.test.js</FILE>
        <FILE>ghost/core/test/e2e-api/admin/links.test.js</FILE>
        <FILE>ghost/core/test/e2e-api/admin/members-exporter.test.js</FILE>
        <FILE>ghost/core/test/e2e-api/admin/members.test.js</FILE>
        <FILE>ghost/core/test/e2e-api/admin/posts-legacy.test.js</FILE>
        <FILE>ghost/core/test/e2e-api/admin/utils.js</FILE>
        <FILE>ghost/core/test/e2e-api/members/__snapshots__/webhooks.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-frontend/default_routes.test.js</FILE>
        <FILE>ghost/core/test/e2e-webhooks/__snapshots__/members.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-webhooks/__snapshots__/pages.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-webhooks/__snapshots__/posts.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-webhooks/__snapshots__/tags.test.js.snap</FILE>
        <FILE>ghost/core/test/e2e-webhooks/members.test.js</FILE>
        <FILE>ghost/core/test/e2e-webhooks/pages.test.js</FILE>
        <FILE>ghost/core/test/e2e-webhooks/posts.test.js</FILE>
        <FILE>ghost/core/test/integration/migrations/migration.test.js</FILE>
        <FILE>ghost/core/test/integration/services/mega.test.js</FILE>
        <FILE>ghost/core/test/regression/api/admin/members-importer.test.js</FILE>
        <FILE>ghost/core/test/regression/api/admin/utils.js</FILE>
        <FILE>ghost/core/test/unit/frontend/helpers/__snapshots__/ghost_head.test.js.snap</FILE>
        <FILE>ghost/core/test/unit/frontend/helpers/helper-test-utils.js</FILE>
        <FILE>ghost/core/test/unit/server/data/schema/fixtures/fixture-manager.test.js</FILE>
        <FILE>ghost/core/test/unit/server/data/schema/integrity.test.js</FILE>
        <FILE>ghost/core/test/unit/server/data/schema/schema.test.js</FILE>
        <FILE>ghost/core/test/unit/server/models/member-click-event.test.js</FILE>
        <FILE>ghost/core/test/unit/server/models/member-paid-subscription-event.test.js</FILE>
        <FILE>ghost/core/test/unit/server/services/link-tracking/PostLinkRepository.test.js</FILE>
        <FILE>ghost/core/test/unit/server/services/mega/post-email-serializer.test.js</FILE>
        <FILE>ghost/core/test/utils/e2e-framework.js</FILE>
        <FILE>ghost/core/test/utils/fixture-utils.js</FILE>
        <FILE>ghost/core/test/utils/fixtures/csv/members-with-mappings.csv</FILE>
        <FILE>ghost/core/test/utils/fixtures/data-generator.js</FILE>
        <FILE>ghost/core/test/utils/fixtures/fixtures.json</FILE>
        <FILE>ghost/custom-theme-settings-service/package.json</FILE>
        <FILE>ghost/domain-events/package.json</FILE>
        <FILE>ghost/email-analytics-provider-mailgun/package.json</FILE>
        <FILE>ghost/email-analytics-service/package.json</FILE>
        <FILE>ghost/email-content-generator/package.json</FILE>
        <FILE>ghost/express-dynamic-redirects/package.json</FILE>
        <FILE>ghost/html-to-plaintext/package.json</FILE>
        <FILE>ghost/job-manager/package.json</FILE>
        <FILE>ghost/link-redirects/lib/LinkRedirect.js</FILE>
        <FILE>ghost/link-redirects/lib/LinkRedirectsService.js</FILE>
        <FILE>ghost/link-redirects/package.json</FILE>
        <FILE>ghost/link-replacer/package.json</FILE>
        <FILE>ghost/link-tracking/lib/LinkClickTrackingService.js</FILE>
        <FILE>ghost/link-tracking/package.json</FILE>
        <FILE>ghost/link-tracking/test/LinkClickTrackingService.test.js</FILE>
        <FILE>ghost/magic-link/lib/MagicLink.js</FILE>
        <FILE>ghost/magic-link/package.json</FILE>
        <FILE>ghost/mailgun-client/lib/mailgun-client.js</FILE>
        <FILE>ghost/mailgun-client/package.json</FILE>
        <FILE>ghost/member-analytics-service/package.json</FILE>
        <FILE>ghost/member-attribution/package.json</FILE>
        <FILE>ghost/member-events/package.json</FILE>
        <FILE>ghost/members-analytics-ingress/package.json</FILE>
        <FILE>ghost/members-api/lib/MembersAPI.js</FILE>
        <FILE>ghost/members-api/lib/repositories/event.js</FILE>
        <FILE>ghost/members-api/lib/repositories/member.js</FILE>
        <FILE>ghost/members-api/lib/repositories/product.js</FILE>
        <FILE>ghost/members-api/package.json</FILE>
        <FILE>ghost/members-api/test/hello.test.js</FILE>
        <FILE>ghost/members-api/test/unit/lib/repositories/member.test.js</FILE>
        <FILE>ghost/members-api/test/unit/lib/repositories/product.test.js</FILE>
        <FILE>ghost/members-csv/lib/parse.js</FILE>
        <FILE>ghost/members-csv/lib/unparse.js</FILE>
        <FILE>ghost/members-csv/package.json</FILE>
        <FILE>ghost/members-csv/test/fixtures/subscribed-to-emails-header.csv</FILE>
        <FILE>ghost/members-csv/test/parse.test.js</FILE>
        <FILE>ghost/members-csv/test/unparse.test.js</FILE>
        <FILE>ghost/members-csv/test/utils/assertions.js</FILE>
        <FILE>ghost/members-csv/test/utils/index.js</FILE>
        <FILE>ghost/members-csv/test/utils/overrides.js</FILE>
        <FILE>ghost/members-events-service/package.json</FILE>
        <FILE>ghost/members-importer/lib/importer.js</FILE>
        <FILE>ghost/members-importer/package.json</FILE>
        <FILE>ghost/members-importer/test/fixtures/member-csv-export.csv</FILE>
        <FILE>ghost/members-importer/test/fixtures/subscribed-to-emails-header.csv</FILE>
        <FILE>ghost/members-importer/test/importer.test.js</FILE>
        <FILE>ghost/members-ssr/package.json</FILE>
        <FILE>ghost/minifier/package.json</FILE>
        <FILE>ghost/mw-api-version-mismatch/package.json</FILE>
        <FILE>ghost/mw-cache-control/package.json</FILE>
        <FILE>ghost/mw-error-handler/package.json</FILE>
        <FILE>ghost/mw-session-from-token/package.json</FILE>
        <FILE>ghost/mw-update-user-last-seen/package.json</FILE>
        <FILE>ghost/mw-vhost/package.json</FILE>
        <FILE>ghost/oembed-service/package.json</FILE>
        <FILE>ghost/offers/package.json</FILE>
        <FILE>ghost/package-json/package.json</FILE>
        <FILE>ghost/payments/package.json</FILE>
        <FILE>ghost/portal/package.json</FILE>
        <FILE>ghost/portal/src/components/pages/FeedbackPage.js</FILE>
        <FILE>ghost/portal/src/components/pages/UnsubscribePage.js</FILE>
        <FILE>ghost/portal/src/utils/api.js</FILE>
        <FILE>ghost/referrers/package.json</FILE>
        <FILE>ghost/security/package.json</FILE>
        <FILE>ghost/session-service/package.json</FILE>
        <FILE>ghost/settings-path-manager/package.json</FILE>
        <FILE>ghost/staff-service/package.json</FILE>
        <FILE>ghost/stats-service/package.json</FILE>
        <FILE>ghost/stripe/lib/StripeAPI.js</FILE>
        <FILE>ghost/stripe/lib/WebhookManager.js</FILE>
        <FILE>ghost/stripe/package.json</FILE>
        <FILE>ghost/tiers/.eslintrc.js</FILE>
        <FILE>ghost/tiers/README.md</FILE>
        <FILE>ghost/tiers/index.js</FILE>
        <FILE>ghost/tiers/lib/InMemoryTierRepository.js</FILE>
        <FILE>ghost/tiers/lib/Tier.js</FILE>
        <FILE>ghost/tiers/lib/TierActivatedEvent.js</FILE>
        <FILE>ghost/tiers/lib/TierArchivedEvent.js</FILE>
        <FILE>ghost/tiers/lib/TierCreatedEvent.js</FILE>
        <FILE>ghost/tiers/lib/TierNameChangeEvent.js</FILE>
        <FILE>ghost/tiers/lib/TierPriceChangeEvent.js</FILE>
        <FILE>ghost/tiers/lib/TiersAPI.js</FILE>
        <FILE>ghost/tiers/package.json</FILE>
        <FILE>ghost/tiers/test/.eslintrc.js</FILE>
        <FILE>ghost/tiers/test/Tier.test.js</FILE>
        <FILE>ghost/tiers/test/TiersAPI.test.js</FILE>
        <FILE>ghost/tiers/test/index.test.js</FILE>
        <FILE>ghost/update-check-service/package.json</FILE>
        <FILE>ghost/verification-trigger/package.json</FILE>
        <FILE>ghost/version-notifications-data-service/package.json</FILE>
        <FILE>package.json</FILE>
        <FILE>yarn.lock</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
