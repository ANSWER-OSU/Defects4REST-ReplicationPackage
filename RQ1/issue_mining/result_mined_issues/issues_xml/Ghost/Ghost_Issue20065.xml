<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>20065</ISSUENO>
  <ISSUEURL>https://github.com/TryGhost/Ghost/issues/20065</ISSUEURL>
  <TITLE>Outdated version of string-width is causing the Docker image entrypoint loading to fail.</TITLE>
  <DESCRIPTION>### Issue Summary The update to fix arm32 architecture (https://github.com/TryGhost/Ghost/commit/c2485af853f7b3b86f7f141b8496439cdc4881b4) introduce a regression in the way the Ghost package is launched. When running `node index.js` there is a module resolution error similar to this issue https://github.com/nrwl/nx/issues/19249. I managed to solve the issue locally by adding `&quot;string-width&quot;: &quot;4.2.3&quot;` to the `resolutions` section. Here is the Docker test showing the error: https://github.com/docker-library/ghost/actions/runs/8756974313/job/24034646549 I would like to contribute this fix but I am not sure which `package.json` to use because the packaged one seems to be generated from the source ones. ### Steps to Reproduce There is probably an more streamlined reproducible but building the Docker image here then running it (https://github.com/docker-library/ghost/tree/master/5/debian) ``` docker build -t ghost . docker run --rm ghost ``` ### Ghost Version 5.82.3 ### Node.js Version 18.*, 20.* ### How did you install Ghost? In Docker using the Ghost CLI ### Database type MySQL 5.7 ### Browser &amp; OS version _No response_ ### Relevant log / error output _No response_ ### Code of Conduct - [X] I agree to be friendly and polite to people in this repository</DESCRIPTION>
  <REPONAME>Ghost</REPONAME>
  <TIMEDIFFERENCEDAYS>16</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Update dependency @types/node to v20.12.11</MESSAGE>
    <SHA>6b144b8f141d247d9155a9ccb29ef0b336044c15</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Added `jackspeak` resolution to fix ESM + CJS compat issue fixes https://github.com/TryGhost/Ghost/issues/20065 refs https://github.com/storybookjs/storybook/issues/22431#issuecomment-1630086092 refs https://github.com/isaacs/jackspeak/issues/5 - this adds a resolution for jackspeak, which is a dependency deep inside storybook - somewhere deep in the dependency tree, we're requiring an ESM package from a CJS package, which is causing issues - this should hopefully avoid that by pinning jackspeak to a working version</MESSAGE>
      <SHA>9c729111dec83176f6887865477bf2a848a38fc6</SHA>
      <PATCHEDFILES>
        <FILE>package.json</FILE>
        <FILE>yarn.lock</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Added `jackspeak` resolution to fix ESM + CJS compat issue fixes https://github.com/TryGhost/Ghost/issues/20065 refs https://github.com/storybookjs/storybook/issues/22431#issuecomment-1630086092 refs https://github.com/isaacs/jackspeak/issues/5 - this adds a resolution for jackspeak, which is a dependency deep inside storybook - somewhere deep in the dependency tree, we're requiring an ESM package from a CJS package, which is causing issues - this should hopefully avoid that by pinning jackspeak to a working version</MESSAGE>
      <SHA>ac660f237ddf7b68f5e6f756e64a7740571e1cf9</SHA>
      <PATCHEDFILES>
        <FILE>package.json</FILE>
        <FILE>yarn.lock</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
