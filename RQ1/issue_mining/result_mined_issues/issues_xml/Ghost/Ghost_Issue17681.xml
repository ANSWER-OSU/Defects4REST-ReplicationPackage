<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>17681</ISSUENO>
  <ISSUEURL>https://github.com/TryGhost/Ghost/issues/17681</ISSUEURL>
  <TITLE>@page object not available in pages created via routes and data property</TITLE>
  <DESCRIPTION>### Issue Summary @page object not available in pages created via routes and data property ### Steps to Reproduce 1. Setting up routes for a custom page, for example `/membership/` ```yaml routes: /membership/: template: membership data: page.membership ``` 2. Inside the membership.hbs template, within `{{#page}} ... {{/page}}`, if I log the following: ```hbs {{log @page}} {{log show_title_and_feature_image}} ``` Result: ```bash undefined true ``` 3. Inside a regular page, the same log will result in: ```bash { show_title_and_feature_image: true } undefined ``` It seems in custom routes/pages, the @page object is not available and instead, the `show_title_and_feature_image` property is directly available. ### Ghost Version 5.58 ### Node.js Version 16.20.1 ### How did you install Ghost? local, macos ### Database type MySQL 8 ### Browser &amp; OS version _No response_ ### Relevant log / error output _No response_ ### Code of Conduct - [X] I agree to be friendly and polite to people in this repository</DESCRIPTION>
  <REPONAME>Ghost</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Convert `getIframeUrl` to a getter and inject as source into iframe component</MESSAGE>
    <SHA>c23480030f74913b5bcab8bbe6f44f3ddaec64a7</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixed missing `@page` object in themes when rendering custom routed page closes https://github.com/TryGhost/Ghost/issues/17681 - updated `prepareContextResource()` to make sure `show_title_and_feature_image` is always removed from pages - updated `formatResponse.entries()` to apply the same `@page` local behaviour when it's passed a `data.page` object to account for custom routed pages</MESSAGE>
      <SHA>011f0bea1980dd240b4c863a4313b17ec0bceb46</SHA>
      <PATCHEDFILES>
        <FILE>ghost/core/core/frontend/services/proxy.js</FILE>
        <FILE>ghost/core/core/frontend/services/rendering/format-response.js</FILE>
        <FILE>ghost/core/core/frontend/services/rendering/render-entries.js</FILE>
        <FILE>ghost/core/core/frontend/services/routing/controllers/static.js</FILE>
        <FILE>ghost/core/test/unit/frontend/services/rendering/format-response.test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixed missing `@page` object in themes when rendering custom routed page (#17693) closes https://github.com/TryGhost/Ghost/issues/17681 - updated `prepareContextResource()` to make sure `show_title_and_feature_image` is always removed from pages - updated `formatResponse.entries()` to apply the same `@page` local behaviour when it's passed a `data.page` object to account for custom routed pages</MESSAGE>
      <SHA>1ebdac399777389b1fec043eed440952a8c75f27</SHA>
      <PATCHEDFILES>
        <FILE>ghost/core/core/frontend/services/data/checks.js</FILE>
        <FILE>ghost/core/core/frontend/services/proxy.js</FILE>
        <FILE>ghost/core/core/frontend/services/rendering/format-response.js</FILE>
        <FILE>ghost/core/core/frontend/services/rendering/render-entries.js</FILE>
        <FILE>ghost/core/core/frontend/services/routing/controllers/static.js</FILE>
        <FILE>ghost/core/test/unit/frontend/services/data/checks.test.js</FILE>
        <FILE>ghost/core/test/unit/frontend/services/rendering/format-response.test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
