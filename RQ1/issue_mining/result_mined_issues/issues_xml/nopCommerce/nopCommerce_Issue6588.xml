<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6588</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/6588</ISSUEURL>
  <TITLE>Error when generating PDF with logo</TITLE>
  <DESCRIPTION>nopCommerce version: 4.60 &gt; I have a custom store logo.png set to print on pdf. &gt; For some reason the thumb file was corrupted and 0 bytes. &gt; `nopCommerce\src\Presentation\Nop.Web\wwwroot\images\thumbs\0000007_Logo_150.png (0bytes)` &gt; &gt; The following is line is throwing because data array is 0. &gt; `\nopCommerce\src\Libraries\Nop.Services\Common\Pdf\InvoiceDocument.cs` &gt; &gt; Current: &gt; ``` &gt; if (Source.LogoData is not null) &gt; logoContainer.Image(Source.LogoData, ImageScaling.FitArea); &gt; ``` &gt; &gt; Proposed Change: (Doesn't solve problem of logo.png not printing) &gt; ``` &gt; if (Source.LogoData is not null &amp;&amp; Source.LogoData.Length != 0) &gt; logoContainer.Image(Source.LogoData, ImageScaling.FitArea); &gt; ``` &gt; &gt; Stack trace: &gt; ``` &gt; System.ArgumentException: The data buffer was empty. &gt; at SkiaSharp.SKImage.FromEncodedData(Byte[] data) &gt; at QuestPDF.Fluent.ImageExtensions.Image(IContainer parent, Byte[] imageData, ImageScaling scaling) &gt; at Nop.Services.Common.Pdf.InvoiceDocument.&lt;ComposeHeader&gt;b__4_1(RowDescriptor row) &gt; at QuestPDF.Fluent.RowExtensions.Row(IContainer element, Action`1 handler) &gt; at Nop.Services.Common.Pdf.InvoiceDocument.ComposeHeader(IContainer container) &gt; at QuestPDF.Fluent.ElementExtensions.Element[TParent](TParent parent, Action`1 handler) &gt; at Nop.Services.Common.Pdf.InvoiceDocument.&lt;Compose&gt;b__11_0(PageDescriptor page) &gt; at QuestPDF.Fluent.PageExtensions.Page(IDocumentContainer document, Action`1 handler) &gt; at Nop.Services.Common.Pdf.InvoiceDocument.Compose(IDocumentContainer container) &gt; at QuestPDF.Drawing.DocumentGenerator.RenderDocument[TCanvas](TCanvas canvas, IDocument document) &gt; at QuestPDF.Drawing.DocumentGenerator.GeneratePdf(Stream stream, IDocument document) &gt; at QuestPDF.Fluent.GenerateExtensions.GeneratePdf(IDocument document, Stream stream) &gt; at Nop.Services.Common.PdfService.PrintOrderToPdfAsync(Stream stream, Order order, Language language, Store store, Vendor vendor) &gt; at Nop.Services.Common.PdfService.PrintOrderToPdfAsync(Stream stream, Order order, Language language, Store store, Vendor vendor) &gt; at Nop.Services.Common.PdfService.PrintOrdersToPdfAsync(Stream stream, IList`1 orders, Language language, Vendor vendor) &gt; at Nop.Services.Common.PdfService.PrintOrdersToPdfAsync(Stream stream, IList`1 orders, Language language, Vendor vendor) &gt; at Nop.Services.Common.PdfService.PrintOrdersToPdfAsync(Stream stream, IList`1 orders, Language language, Vendor vendor) &gt; at Nop.Web.Areas.Admin.Controllers.OrderController.PdfInvoiceSelected(String selectedIds) &gt; ``` &gt; Source: https://www.nopcommerce.com/boards/topic/95950/generate-invoice-pdf-containing-graphical-logo</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>5</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#6592 Use uppercase to use the INFORMATION_SCHEMA.TABLES view</MESSAGE>
    <SHA>101c025329cda554d53a4247b5066dc58ab6f28c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#6588 Added additional check for logo generating in a PDF document</MESSAGE>
      <SHA>c46ffe2e96c365d0256ae5882b435933eba718e4</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/Common/Pdf/InvoiceDocument.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
