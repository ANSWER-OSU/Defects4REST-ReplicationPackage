<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6497</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/6497</ISSUEURL>
  <TITLE>MySqlConnector. Disable &quot;XA Transactions&quot; by default</TITLE>
  <DESCRIPTION>nopCommerce version: 4.60 nopCommerce 4.60 uses the MySqlConnector instead of MySql.Data. TransactionSocpe is used in the EntityRepository.cs: `using var transaction = new TransactionScope(TransactionScopeAsyncFlowOption.Enabled);` The Migrating documentation for MySqlConnector states: &gt; MySqlConnector adds full distributed transaction support (for client code using [System.Transactions.Transaction](https://docs.microsoft.com/en-us/dotnet/api/system.transactions.transaction)), while Connector/NET uses regular database transactions. As a result, code that uses TransactionScope or MySqlConnection.EnlistTransaction may execute differently with MySqlConnector. To get Connector/NET-compatible behavior, set UseXaTransactions=false in your connection string. Also see: https://mysqlconnector.net/tutorials/migrating-from-connector-net/#transactionscope --- We still use nopCommerce 4.50, but have modified it to use MySqlConnector like 4.60 uses it. We do this, because we use Linq2Db with additional features, which are not supported with MySql.Data. In our case it seems that XA Transcations are used. For us this is not the intended behavior. We are still looking into it, to verify this. We will look into it in our case, with the modified version of nopCommerce 4.50. (connection string with UseXaTransactions=false). We were not able to test 4.60 yet. We could not find anything like UseXaTransactions in the 4.60 code. - Does anyone know, if 4.60 uses XA Transactions for queries with TransactionScope? - Is this the intended behavior?</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>155</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge branch '4.60-bug-fixes' into develop</MESSAGE>
    <SHA>2a178f4a1bdfc2b6e7f53406c8ac1c65f37c12fa</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#6497 Disable XA transactions in MySQL connection string by default</MESSAGE>
      <SHA>5064b65bd1eb6d7239b5d02bf6c69af04999b4e7</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Data/DataProviders/MySqlDataProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
