<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>7209</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/7209</ISSUEURL>
  <TITLE>Error when importing Customers</TITLE>
  <DESCRIPTION>nopCommerce version: 4.7 Steps to reproduce the problem: When importing customers, we encountered an error: ![image](https://github.com/nopSolutions/nopCommerce/assets/52314713/e7acc1ac-2b05-4d21-ab19-b076ac910a02) I have checked the code, and the error occurs in the function [ImportManager.ImportCustomersFromXlsxAsync](https://github.com/nopSolutions/nopCommerce/blob/develop/src/Libraries/Nop.Services/ExportImport/ImportManager.cs#L1723) Currently, in the function, the variable [rolesToSave ](https://github.com/nopSolutions/nopCommerce/blob/develop/src/Libraries/Nop.Services/ExportImport/ImportManager.cs#L1743) is declared for each customer, but it is not cleared after each iteration. This causes the error to occur from the second customer onward.</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>8</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#7202 Fixing product attribute combinations stock quantity history when copy a product with combinations (cherry picked from commit 6050d0ca2d566b19b000f9a0e75ed6f749b8fb72)</MESSAGE>
    <SHA>adca6bcd73275b09374a47ce2b309ed01ac192f0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#7209 Fixed saving customer roles when importing</MESSAGE>
      <SHA>4cc31faaf02ee626c532cad58d6a4078ee74533d</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/ExportImport/ImportManager.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
