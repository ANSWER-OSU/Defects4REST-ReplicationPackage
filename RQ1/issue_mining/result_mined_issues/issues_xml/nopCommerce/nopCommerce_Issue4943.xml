<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4943</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/4943</ISSUEURL>
  <TITLE>Estimate Shipping - shipping provider warnings not displayed</TITLE>
  <DESCRIPTION>1. nopCommerce version 4.30 2. Expected behavior - error/warning messages from shipping providers should be displayed 3. Actual behavior - if a shipping provider plugin returns any errors, they are ignored 4. Steps to reproduce the problem - Select &quot;Estimate Shipping&quot; button on the cart page. The dialog pops up. - Enter address information - If the shipping provider plugin reports any errors (like UPS indicating invalid address, or Shipping Director's Error/ErrorExit rule returning a warning message like &quot;call for shipping&quot;), they are not displayed. (Note that if you blank out the zip/postal code field, you do see an error message for &quot;Zip / postal code is required&quot;, so the dialog does support the display of messages) The code does not look right. Only when 'Success' is true does it enter the block where Warnings are set: ```\Presentation\Nop.Web\Factories\ShoppingCartModelFactory.cs``` ```csharp public virtual EstimateShippingResultModel PrepareEstimateShippingResultModel(...) ... var getShippingOptionResponse = _shippingService.GetShippingOptions(...); if (getShippingOptionResponse.Success) { if (getShippingOptionResponse.ShippingOptions.Any()) { foreach (var shippingOption in getShippingOptionResponse.ShippingOptions) {...} } else foreach (var error in getShippingOptionResponse.Errors) model.Warnings.Add(error); } ``` see also: https://www.nopcommerce.com/en/boards/topic/84921/estimate-shipping-on-cart-page-for-430-shipping-provider-warnings-not-displayed</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>87</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#5088 Fix refunds with different currency codes in PayPal plugin</MESSAGE>
    <SHA>d7552a233e5a6f96675d36a1e957fba5bbd78dc0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#4943 Fix displaying of the estimate shipping warnings</MESSAGE>
      <SHA>fc155674bfd7728791a2441fab0aa6627e01b248</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Controllers/ProductController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/ShoppingCartController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Factories/ShoppingCartModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Models/ShoppingCart/EstimateShippingModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/wwwroot/js/public.estimateshipping.popup.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
