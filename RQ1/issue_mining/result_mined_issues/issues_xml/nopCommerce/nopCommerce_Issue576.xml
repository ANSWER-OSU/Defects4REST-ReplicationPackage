<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>576</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/576</ISSUEURL>
  <TITLE>Delay usage of reward points for configurable number of days</TITLE>
  <DESCRIPTION>There is one issue I have: Somebody orders first time for eg. 200 EUR. He gets 20 points. Then he orders a second time using this points. After that he's returning order 1. I saw other shops which offered bonus systems such a way that they delay using of points for a configurable number of days. So in Germany you have to accept returns within min. 14 Days. By law. What should we do? Reduce this points as a new record after a certain number of days - e.g. &quot;Burned&quot;? Other suggestions? We can load all reward points history records in memory to see which one can be used (or not). But it'll significantly affect performance. Let's discuss first</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>281</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#378 Allow a store owner to manage access to plugins per customer role</MESSAGE>
    <SHA>24e3f1a73d5f5c9044aeca79d3557c5fb1a0c788</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#576 Delay usage of reward points</MESSAGE>
      <SHA>3824e00d5b797e305bb7e67c7d01af5888f23281</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Core/Domain/Customers/RewardPointsActivatingDelayPeriod.cs</FILE>
        <FILE>src/Libraries/Nop.Core/Domain/Customers/RewardPointsHistory.cs</FILE>
        <FILE>src/Libraries/Nop.Core/Domain/Customers/RewardPointsSettings.cs</FILE>
        <FILE>src/Libraries/Nop.Core/Nop.Core.csproj</FILE>
        <FILE>src/Libraries/Nop.Services/Installation/CodeFirstInstallationService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/IRewardPointService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/OrderProcessingService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/RewardPointService.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Administration/Controllers/CustomerController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Administration/Controllers/SettingController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Administration/Infrastructure/Mapper/AdminMapperConfiguration.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Administration/Models/Customers/CustomerModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Administration/Models/Settings/RewardPointsSettingsModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Administration/Views/Setting/RewardPoints.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/App_Data/Localization/defaultResources.nopres.xml</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/OrderController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Models/Order/CustomerRewardPointsModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Order/CustomerRewardPoints.cshtml</FILE>
        <FILE>upgradescripts/3.80-the next version/upgrade.sql</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#576 Delete upcoming reward points history after canceling order</MESSAGE>
      <SHA>95127c6799d4ce8ebedddec1d7dae3956eaa3bf5</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Core/Domain/Orders/Order.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/IRewardPointService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/OrderProcessingService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/RewardPointService.cs</FILE>
        <FILE>src/Tests/Nop.Data.Tests/Orders/OrderPersistenceTests.cs</FILE>
        <FILE>upgradescripts/3.80-the next version/upgrade.sql</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
