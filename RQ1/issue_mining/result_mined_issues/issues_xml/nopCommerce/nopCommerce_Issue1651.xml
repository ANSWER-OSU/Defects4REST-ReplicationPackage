<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1651</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/1651</ISSUEURL>
  <TITLE>Export to Excel. Exception is thrown when no data (for dropdownlists) is defined</TITLE>
  <DESCRIPTION>&quot;Validation of G2 failed: Formula1 cannot be empty&quot; For example, we don't have vendors but we try to create dropdownlist for vendors in Excel: new PropertyByName&lt;Product&gt;(&quot;Vendor&quot;, p =&gt; p.VendorId, IgnoreExportPoductProperty(p =&gt; p.Vendor)) { DropDownElements = _vendorService.GetAllVendors().Select(v =&gt; v as BaseEntity).ToSelectList(p =&gt; (p as Vendor).Return(v =&gt; v.Name, String.Empty)), AllowBlank = true }, And store a store have two ways to go: 1. Export in Basic mode only (with &quot;Vendors&quot; disabled) 2. Create at least one sample vendor</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#1652 Export to Excel loaded active vendors only (select list)</MESSAGE>
    <SHA>e2b19679c2467e265bbf920b08290f068a28dc12</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#1651 Export to Excel. Exception is thrown when no data (for dropdownlists) is defined</MESSAGE>
      <SHA>4166ec64622d7f1af61453639621373aa975f6aa</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/ExportImport/Help/PropertyByName.cs</FILE>
        <FILE>src/Libraries/Nop.Services/ExportImport/Help/PropertyManager.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
