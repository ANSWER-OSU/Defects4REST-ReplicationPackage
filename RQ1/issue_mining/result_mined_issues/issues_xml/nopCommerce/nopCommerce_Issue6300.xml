<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6300</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/6300</ISSUEURL>
  <TITLE>Required products bug: Some required products added to cart when add to cart fails.</TITLE>
  <DESCRIPTION>nopCommerce version: 4.2. Haven't tested latest version but looks like bug might still be present. Steps to reproduce the problem: 1. Setup a product with multiple required products and enable 'Automatically add these products to the cart'. 2. Set one of the required products to fail to add to cart. Eg Not stock with no backorder. 3. Set one of the required products to have no issue adding to cart. 4. Click &quot;add to cart&quot; with the product that has multiple required products. Result: The add to cart will fail with an error. Original item will not be added to cart however one of the required items will now be in the cart. Expected result: None of the items would be added to the cart. Looks the issue comes from the GetRequiredProductWarnings in &quot;ShoppingCartService&quot;. It loops through the required products and adds products to the cart but if one of the required product fails it does not remove previously added products.</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>2</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge branch 'issue-6295-copy-ACL-when-copying-product' into 4.50-bug-fixes</MESSAGE>
    <SHA>044617293c8ca9387f0b8afa480f9b5ff07ddb33</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#6300 Cancel adding products to the cart if at least one of the required products has failed validation</MESSAGE>
      <SHA>b6c3bb0ab1b8ee7901eebffda7b36c315f59aaf7</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/Orders/ShoppingCartService.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
