<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1089</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/1089</ISSUEURL>
  <TITLE>There is a security hole in PayPalStandard which can be exploited to trick NopCommerce into thinking an order has been paid in full when in fact only a 5c payment has been made.</TITLE>
  <DESCRIPTION>I run an online store powered by NopCommerce. I am also a full time developer. I am running stock NopCommerce 3.7 with no modifications. I have written various plugins but these do not touch PayPal. A customer placed an order at my store for $237.75 which was showing up as Paid. However the user had only made a payment of 5c. I caught this before sending the order out because I have a plugin which integrates with my accounting/inventory system, and this plugin checks the PayPal IPN for the mc_gross/mc_fee values. You can see from the attached pictures that the order total was $237.75 but the PDT and IPN shows a payment of only 5c. ![order](https://cloud.githubusercontent.com/assets/1049196/12473527/d626431e-c077-11e5-836f-a1732b7e0435.JPG) ![order notes](https://cloud.githubusercontent.com/assets/1049196/12473392/aae54228-c076-11e5-825a-136fb3133c3b.jpg)</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>42</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#1252 Add new widgets to sitemap page - &quot;sitemap_before&quot; and &quot;sitemap_after&quot;</MESSAGE>
    <SHA>3c3f388c69ca9090fb98229f91daaddf34992e21</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#1089 PayPal plugins. We should vlaidate order totals in IPN handler.</MESSAGE>
      <SHA>78c31f8fb9c20195477c05db7267eade734d6584</SHA>
      <PATCHEDFILES>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalDirect/Controllers/PaymentPayPalDirectController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalDirect/Description.txt</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalStandard/Controllers/PaymentPayPalStandardController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalStandard/Description.txt</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
