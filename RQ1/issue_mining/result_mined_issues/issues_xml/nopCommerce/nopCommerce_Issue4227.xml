<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4227</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/4227</ISSUEURL>
  <TITLE>Security warning by security-code-scan</TITLE>
  <DESCRIPTION>nopCommerce version: 4.2 Steps to reproduce the problem: Security Code Scan - static code analyzer for .NET（ https://security-code-scan.github.io/ ） find 682 Security warning： 1、SCS0005 - Weak Random Number Generator 4 2、SCS0005 - Weak Random Number Generator 4 3、SCS0016 - Cross-Site Request Forgery (CSRF) 660 4、SCS0018 - Path Traversal 5 5、SCS0027 - Open Redirect 9</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>59</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fixed upgrade.sql</MESSAGE>
    <SHA>27edb970f802ec899ab43998bf6ef58bc485b4a3</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#4227 Updated prevent Cross-Site Request Forgery (XSRF/CSRF) attacks Added secure random number generator Fixed Cookie without SSL flag Fixed &quot;Open Redirect&quot; Fixed security definition of the current connection Removed redundant tags antiforgery</MESSAGE>
      <SHA>5f24ed618f2e9850f07b2d74dcc278f256d96d45</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Core/CommonHelper.cs</FILE>
        <FILE>src/Libraries/Nop.Core/Domain/Security/SecuritySettings.cs</FILE>
        <FILE>src/Libraries/Nop.Core/SecureRandomNumberGenerator.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Catalog/CompareProductsService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Catalog/RecentlyViewedProductsService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Installation/CodeFirstInstallationService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Media/RoxyFileman/DatabaseRoxyFilemanService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Media/RoxyFileman/FileRoxyFilemanService.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.DiscountRules.CustomerRoles/Controllers/DiscountRulesCustomerRolesController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.DiscountRules.CustomerRoles/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.ExternalAuth.Facebook/Controllers/FacebookAuthenticationController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.ExternalAuth.Facebook/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Misc.SendinBlue/Controllers/SendinBlueController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Misc.SendinBlue/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.CheckMoneyOrder/CheckMoneyOrderPaymentProcessor.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.CheckMoneyOrder/Controllers/PaymentCheckMoneyOrderController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.CheckMoneyOrder/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.Manual/Controllers/PaymentManualController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.Manual/ManualPaymentProcessor.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.Manual/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalStandard/Controllers/PaymentPayPalStandardController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalStandard/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.Qualpay/Controllers/WebhookController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.Qualpay/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.Square/Controllers/PaymentSquareController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.Square/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Pickup.PickupInStore/Controllers/PickupInStoreController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Pickup.PickupInStore/PickupInStoreProvider.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Pickup.PickupInStore/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Shipping.FixedByWeightByTotal/Controllers/FixedByWeightByTotalController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Shipping.FixedByWeightByTotal/FixedByWeightByTotalComputationMethod.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Shipping.FixedByWeightByTotal/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Shipping.UPS/Controllers/UPSShippingController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Shipping.UPS/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.Avalara/Controllers/AddressValidationController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.Avalara/Controllers/AvalaraTaxController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.Avalara/Services/OverriddenOrderTotalCalculationService.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.Avalara/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.FixedOrByCountryStateZip/Controllers/FixedOrByCountryStateZipController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.FixedOrByCountryStateZip/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Widgets.GoogleAnalytics/Controllers/WidgetsGoogleAnalyticsController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Widgets.GoogleAnalytics/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Widgets.NivoSlider/Controllers/WidgetsNivoSliderController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Widgets.NivoSlider/plugin.json</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Mvc/Filters/AdminAntiForgeryAttribute.cs</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Mvc/Filters/CheckLanguageSeoCodeAttribute.cs</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Mvc/Filters/PublicAntiForgeryAttribute.cs</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/WebWorkContext.cs</FILE>
        <FILE>src/Presentation/Nop.Web/App_Data/Install/Fast/create_required_data.sql</FILE>
        <FILE>src/Presentation/Nop.Web/App_Data/Localization/defaultResources.nopres.xml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/BaseAdminController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/DownloadController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/JbimagesController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/PaymentController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/PictureController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/RoxyFilemanController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/SettingController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/ShippingController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Factories/SettingModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Models/Settings/SecuritySettingsModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/CheckoutAttribute/List.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/CustomerRole/List.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/EmailAccount/List.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/ExternalAuthentication/Methods.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Forum/List.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Setting/_GeneralCommon.Security.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Shared/_AdminLayout.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Shared/_AdminPopupLayout.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/BackInStockSubscriptionController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/BlogController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/BoardsController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/CatalogController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/CheckoutController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/CommonController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/CustomerController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/DownloadController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/InstallController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/NewsController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/NewsletterController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/OrderController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/PollController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/PrivateMessagesController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/ProductController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/ReturnRequestController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/ScheduleTaskController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/ShoppingCartController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/TopicController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/VendorController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Infrastructure/Installation/InstallationLocalizationService.cs</FILE>
        <FILE>upgradescripts/4.20-4.30 (under development)/upgrade.sql</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
