<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5662</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/5662</ISSUEURL>
  <TITLE>When you update &quot;Requires coupon code&quot; field of a discount you have to manually clear cache to see the changes</TITLE>
  <DESCRIPTION>nopCommerce version: 4.40 Steps to reproduce the problem: 1. Apply a pre-created discount &quot;Sample discount with coupon code&quot; to some product on the product edit page 2. Click the &quot;Preview&quot; button on the product edit page 3. Make sure there are no changes in the product price (since the discount has the &quot;Requires coupon code&quot; filed checked) 4. On the &quot;Sample discount with coupon code&quot; discount edit page untick the &quot;Requires coupon code&quot; checkbox and save changes 5. Refresh the product page in the public store 6. See that the price is not updated, the discount is not applied 7. Click the &quot;Clear cache&quot; button in the admin area 8. Refresh the product page in the public store 9. Make sure that the price is updated</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>37</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#5730 Don't display pre-order availability message for passed date</MESSAGE>
    <SHA>604375363772ccc8c425861c26db49ccb78feb6a</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#5662 Fixed problem with clearing applied discount when discount is changed</MESSAGE>
      <SHA>958088e9d9193ecfddc59339541a033b19054c42</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/Discounts/Caching/DiscountCacheEventConsumer.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Discounts/NopDiscountDefaults.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
