<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5636</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/5636</ISSUEURL>
  <TITLE>Topics in popups ignore a password</TITLE>
  <DESCRIPTION>nopCommerce version: Steps to reproduce the problem: Enter the administration Go to Contents-&gt; topics Edit ConditionsOfUse select &quot;Password Protected&quot; put a password and save Go to general settings Check &quot;Pop-ups for&quot; terms of service &quot; save Go to the store and buy a product In the terms and conditions click on read I resolve change TopicDetail.cshtml `@if (Model.IsPasswordProtected) { if (isPopup == null || isPopup == false) { &lt;script type=&quot;text/javascript&quot; asp-location=&quot;Footer&quot;&gt; $(document).ready(function () { $('#button-password').click(function () { var postData = { id: $(&quot;#topic-@Model.Id&quot;).val(), password: $('#password').val() }; addAntiForgeryToken(postData); $.ajax({ cache: false, type: 'POST', url: '@Url.RouteUrl(&quot;TopicAuthenticate&quot;)', data: postData, dataType: 'json', success: function (data) { if (data.Authenticated) { $('#ph-topic #ph-title h1').html(data.Title); if ($('#ph-topic #ph-title h1').text().length == 0) { $('#ph-title').hide(); } $('#ph-topic .page-body').html(data.Body); $('#ph-password').hide(); $('#ph-topic').show(); //we need to re-run the validation plugin after the content is loaded after successful authentication $.validator.unobtrusive.parse('#ph-topic'); } else { $('#password-error').text(data.Error).fadeIn(&quot;slow&quot;); $('#ph-password #password').select().focus(); } } }); return false; }); }); $(document).ready(function () { $('#ph-topic').hide(); $('#ph-password #password').select().focus(); }); &lt;/script&gt; } else { //Script for modal mode &lt;script type=&quot;text/javascript&quot;&gt; $(document).ready(function () { $('#button-password').click(function () { var postData = { id: $(&quot;#topic-@Model.Id&quot;).val(), password: $('#password').val() }; addAntiForgeryToken(postData); $.ajax({ cache: false, type: 'POST', url: '@Url.RouteUrl(&quot;TopicAuthenticate&quot;)', data: postData, dataType: 'json', success: function (data) { if (data.Authenticated) { $('#ph-topic #ph-title h1').html(data.Title); if ($('#ph-topic #ph-title h1').text().length == 0) { $('#ph-title').hide(); } $('#ph-topic .page-body').html(data.Body); $('#ph-password').hide(); $('#ph-topic').show(); //we need to re-run the validation plugin after the content is loaded after successful authentication $.validator.unobtrusive.parse('#ph-topic'); } else { $('#password-error').text(data.Error).fadeIn(&quot;slow&quot;); $('#ph-password #password').select().focus(); } } }); return false; }); }); $(document).ready(function () { $('#ph-topic').hide(); $('#ph-password #password').select().focus(); }); &lt;/script&gt; } &lt;div class=&quot;topic-password&quot; id=&quot;ph-password&quot;&gt; &lt;form asp-route=&quot;TopicAuthenticate&quot; method=&quot;post&quot;&gt; &lt;input asp-for=&quot;Id&quot; id=&quot;topic-@Model.Id&quot; type=&quot;hidden&quot; /&gt; &lt;div class=&quot;enter-password-title&quot;&gt; @T(&quot;Topic.EnterPassword&quot;) &lt;/div&gt; &lt;div class=&quot;enter-password-form&quot;&gt; &lt;input name=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; /&gt; &lt;input type=&quot;submit&quot; id=&quot;button-password&quot; value=&quot;@T(&quot;Topic.Button&quot;)&quot; class=&quot;button-1 topic-password-button&quot; /&gt; &lt;/div&gt; &lt;div class=&quot;password-error&quot; id=&quot;password-error&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt; &lt;/form&gt; &lt;/div&gt; }`</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>47</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#5517 Paypal Smart Payment Buttons plugin. Don't round price for each item</MESSAGE>
    <SHA>b9dcb27bb4cf8a1cf0f25edfd68a204715b309cb</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#5636 Fixed access to protected popup topic</MESSAGE>
      <SHA>c77f58edaeab23e492582a83cfe2aed323359a4a</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Views/Topic/TopicDetails.cshtml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
