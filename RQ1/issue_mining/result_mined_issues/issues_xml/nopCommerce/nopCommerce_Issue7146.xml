<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>7146</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/7146</ISSUEURL>
  <TITLE>Subcategory products ignore category display order when displayed in the parent category</TITLE>
  <DESCRIPTION>nopCommerce version: 4.60.2 (and later versions) &gt; Expected behaviour: &gt; &gt; Products sorted by Category.DisplayOrder then ProductCategory.DisplayOrder (this caters for products associated to multiple categories, where the order might be different in each one) &gt; &gt; Actual behaviour: &gt; Products sorted by ProductCategory.DisplayOrder from first/random category &gt; &gt; Steps to reproduce the problem: &gt; &gt; Set catalogsettings.showproductsfromsubcategories to true &gt; &gt; Create a parent Category &gt; ID, Name &gt; 1, Parent &gt; &gt; Create 2 child categories &gt; ID, Name, DisplayOrder &gt; 2, ChildA, 100 &gt; 3, ChildB, 99 &gt; &gt; Create two products &gt; ID, Name &gt; 1, ProductA &gt; 2, ProductB &gt; &gt; Associate products to the categories &gt; CategoryID, ProductID, DisplayOrder &gt; 2,1,1 &gt; 2,2,1 &gt; 3,1,2 &gt; 3,2,1 &gt; &gt; The products should be ordered by the Category.DisplayOrder then the ProductCategory.DisplayOrder, instead they are ordered by the DisplayOrder of the first ProductCategory (which in practice is similar to sorting by CategoryID then the Products DisplayOrder in the first category it is in) Source: https://www.nopcommerce.com/en/boards/topic/98936/searchproductsasync-ordering-ignores-category-order-in-default-sort</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>4</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge branch 'develop' of https://github.com/nopSolutions/nopCommerce into develop</MESSAGE>
    <SHA>016b97a21f650b6f8410438cc05f15b1346288d3</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#7146 Fixed the order of subcategory products</MESSAGE>
      <SHA>509e5239ca4d83b20408c277c3ac39b421dca6aa</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/Catalog/ProductService.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
