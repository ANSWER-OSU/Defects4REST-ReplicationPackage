<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1335</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/1335</ISSUEURL>
  <TITLE>OrderBy Id twice in MessageTemplateService</TITLE>
  <DESCRIPTION>`public virtual MessageTemplate GetMessageTemplateByName(string messageTemplateName, int storeId) { if (string.IsNullOrWhiteSpace(messageTemplateName)) throw new ArgumentException(&quot;messageTemplateName&quot;); ``` string key = string.Format(MESSAGETEMPLATES_BY_NAME_KEY, messageTemplateName, storeId); return _cacheManager.Get(key, () =&gt; { var query = _messageTemplateRepository.Table; query = query.Where(t =&gt; t.Name == messageTemplateName); query = query.OrderBy(t =&gt; t.Id); query = query.OrderBy(t =&gt; t.Id); var templates = query.ToList(); //store mapping if (storeId &gt; 0) { templates = templates .Where(t =&gt; _storeMappingService.Authorize(t, storeId)) .ToList(); } return templates.FirstOrDefault(); }); }` ```</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#34 Re-design of the common views</MESSAGE>
    <SHA>76cc83561e596ff7bb6fd266396cc3e38fa709dd</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#1335 OrderBy Id twice in MessageTemplateService. Removed re-sorting</MESSAGE>
      <SHA>ad76af09adb8e6c5b0097da56978d39062f328e9</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/Messages/MessageTemplateService.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
