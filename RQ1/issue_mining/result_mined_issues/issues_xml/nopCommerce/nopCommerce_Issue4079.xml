<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4079</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/4079</ISSUEURL>
  <TITLE>Major issue with building plugins that ref Nop.Web in VS2019 -&gt; Solution</TITLE>
  <DESCRIPTION>nopCommerce version: 4.00 Steps to reproduce the problem: Build a plugin that references nop.web in VS2017. It will work correctly. Build a plugin that references nop.web in VS2019. It will copy app.config and web.config to the plugin directory which causes duplicate dll errors and basically bricks your entire site until you remove these files. After speaking with microsoft they tracked the problem down. The solution is to change the following in Nop.Web.csproj ``` &lt;ItemGroup&gt; &lt;!-- We copy the entire \App_Data directory. But we ignore JSON files and data protection keys --&gt; &lt;Content Include=&quot;App_Data\**&quot; CopyToPublishDirectory=&quot;PreserveNewest&quot; Exclude=&quot;App_Data\*.json&quot; /&gt; &lt;Content Update=&quot;App_Data\*.json&quot; CopyToPublishDirectory=&quot;Never&quot; /&gt; &lt;Content Update=&quot;App_Data\DataProtectionKeys\*.xml&quot; CopyToPublishDirectory=&quot;Never&quot; /&gt; &lt;Compile Remove=&quot;Plugins\**&quot; /&gt; &lt;EmbeddedResource Remove=&quot;Plugins\**&quot; /&gt; &lt;None Remove=&quot;Plugins\**&quot; /&gt; ``` **Change to this** ``` &lt;ItemGroup&gt; &lt;Content Update=&quot;**\*.config;**\*.json&quot; CopyToOutputDirectory=&quot;Never&quot; CopyToPublishDirectory=&quot;PreserveNewest&quot;/&gt; &lt;!-- We copy the entire \App_Data directory. But we ignore JSON files and data protection keys --&gt; &lt;Content Include=&quot;App_Data\**&quot; CopyToPublishDirectory=&quot;PreserveNewest&quot; Exclude=&quot;App_Data\*.json&quot; /&gt; &lt;Content Update=&quot;App_Data\*.json&quot; CopyToPublishDirectory=&quot;Never&quot; /&gt; &lt;Content Update=&quot;App_Data\DataProtectionKeys\*.xml&quot; CopyToPublishDirectory=&quot;Never&quot; /&gt;&gt; ``` The problem is caused by this change in the websdk in vs2019 https://github.com/aspnet/websdk/commit/7e6b193ddcf1eec5c0a88a9748c626775555273e#diff-edf5a48ed0d4aa5a4289cb857bf46a04 Not sure if you have already fixed this in later commits. edit: Here is the MS bug I raised https://developercommunity.visualstudio.com/content/problem/678789/vs2019-ignores-content-exclude-xml-entries-within.html</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>42</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#3974 Fixed problem with uploading plugin/theme zip file that created by Windows compression feature</MESSAGE>
    <SHA>be8cb252bb8350e1a5cb2508eb94eef72640b76f</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#4079 Fixed issue with building plugins that ref Nop.Web in VS2019</MESSAGE>
      <SHA>7b9f8f0fb6178c40b92167ebdaa049a21a47b1ee</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Nop.Web.csproj</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
