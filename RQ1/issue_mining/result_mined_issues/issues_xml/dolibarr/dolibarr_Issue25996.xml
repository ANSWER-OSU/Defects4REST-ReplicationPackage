<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>25996</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/25996</ISSUEURL>
  <TITLE>odt project document creation crashes when the model does not have a projectfiles section</TITLE>
  <DESCRIPTION>### Bug It is not possible to use odt dcument models wich do not have all sections : 'projectrefs' segment not found in the document. The tag [!-- BEGIN xxx --] or [!-- END xxx --] is not present into content file. ### Environment Version from 15.0 perhaps earlier ### Environment OS all ### Environment Web server all ### Environment PHP all ### Environment Database all ### Environment URL(s) _No response_ ### Expected and actual behavior It should be possible to generate odt documents without sections wich are not used ### Steps to reproduce the behavior made a copy of the standard template delete section (ex projectrefs) try to generate document ### Attached files [template_project1.odt](https://github.com/Dolibarr/dolibarr/files/12701237/template_project1.odt)</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>9</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>CSS</MESSAGE>
    <SHA>2a49ebb1140f7ec5db84e332c58ed24d8512e1dc</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>FIX #25996 FIX #25997</MESSAGE>
      <SHA>2e431468a04bb95093e1750fdbbe48c30e936a10</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/modules/project/doc/doc_generic_project_odt.modules.php</FILE>
        <FILE>htdocs/includes/odtphp/odf.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
