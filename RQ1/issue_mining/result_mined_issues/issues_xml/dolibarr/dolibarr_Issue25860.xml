<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>25860</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/25860</ISSUEURL>
  <TITLE>Can't decrypt encrypted data if instance_unique_id is not defined</TITLE>
  <DESCRIPTION>### Bug [dolEncrypt](https://github.com/Dolibarr/dolibarr/blob/9c903ecf56d3650bcacce4b47eb0e4e26f8f3a1b/htdocs/core/lib/security.lib.php#L122C10-L122C20) function allows to encrypt data even if instance_unique_id is not defined. But [dolDecrypt](https://github.com/Dolibarr/dolibarr/blob/9c903ecf56d3650bcacce4b47eb0e4e26f8f3a1b/htdocs/core/lib/security.lib.php#L177) function fails if it is empty. https://github.com/Dolibarr/dolibarr/blob/9c903ecf56d3650bcacce4b47eb0e4e26f8f3a1b/htdocs/core/lib/security.lib.php#L193C4-L195 I'm not sure what is the best solution: allow to decrypt data even or not allow to encrypt data if instance_unique_id is empty. ### Environment Version 18 ### Environment OS _No response_ ### Environment Web server _No response_ ### Environment PHP _No response_ ### Environment Database _No response_ ### Environment URL(s) _No response_ ### Expected and actual behavior _No response_ ### Steps to reproduce the behavior _No response_ ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>14</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix link to create event, bad date</MESSAGE>
    <SHA>8518aa5d384134c9f86071fa91736de2cf12bad6</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix #25860 not allow encrypt data if key and instance_unique_id are empty</MESSAGE>
      <SHA>1e64a9c067f2806dbda9186301528471b576fdd0</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/lib/security.lib.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #25962 from tuxgasy/avoid_encrypt_data_if_key_empty Fix #25860 not allow encrypt data if key and instance_unique_id are empty</MESSAGE>
      <SHA>c2a91a84450214b2c479a24c985f242eb274e809</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/lib/security.lib.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
