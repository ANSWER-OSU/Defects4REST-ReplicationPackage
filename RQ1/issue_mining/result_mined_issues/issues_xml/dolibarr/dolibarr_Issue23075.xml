<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>23075</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/23075</ISSUEURL>
  <TITLE>Wrong invoice amount when billing Project task spent time</TITLE>
  <DESCRIPTION>### Bug When creating an invoice for project tasks time spent, the amount in the invoice is wrong. ### Environment Version 14-16 ### Environment OS _No response_ ### Environment Web server _No response_ ### Environment PHP _No response_ ### Environment Database _No response_ ### Environment URL(s) _No response_ ### Expected and actual behavior When the task is for 10 hours and the user pay rate is 15 currency/h, the invoice line should be for QTY = 10 and U.P net = 15. In reality, the invoice QTY is correct, but the U.P net is not the hourly rate, but the total for the task (i.e. 150) ### Steps to reproduce the behavior Create a project, create a task, add time spent to this task, and then bill it. ![1](https://user-images.githubusercontent.com/4587305/205131290-09b97066-b0c0-4559-902a-ec8c3ec48f8d.png) ![2](https://user-images.githubusercontent.com/4587305/205131304-e52121f7-d96d-4a1b-b211-c43fdd31fe04.png) ![3](https://user-images.githubusercontent.com/4587305/205131313-0977fd8a-5d5c-4213-aec6-3b5703adf623.png) ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>321</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #23133 from milenmk/16-holidays-list-error-message FIX|Fix[#23117]</MESSAGE>
    <SHA>5573b88df8651c2b40dfb25b0804b3639fe49699</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>FIX|Fix [#23075] Wrong invoice unit price when billing Project task spent time</MESSAGE>
      <SHA>ee7e394ebf8a2b0d68fcf4785746e826822b20e3</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/projet/tasks/time.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>FIX|Fix [#23075] for v17 wrong invoice amount when billing project task spent time</MESSAGE>
      <SHA>509eccb7e97a92134950723691ab750c2d76df9e</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/projet/tasks/time.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>FIX|Fix [#23075] for v17 wrong invoice amount when billing project task spent time</MESSAGE>
      <SHA>55c44e408e0a4911fdc3f1975b3fe823ebd97423</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/projet/tasks/time.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #23159 from milenmk/v16-Wrong-invoice-amount-when-billing-Project-task-spent-time FIX|Fix [#23075]</MESSAGE>
      <SHA>402ff3746585243bbf4d9bd2bce532a6687511fe</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/projet/tasks/time.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
