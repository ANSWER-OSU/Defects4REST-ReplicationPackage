<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>33206</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/33206</ISSUEURL>
  <TITLE>Custom Email profile signature not applied when using USER_SIGNATURE or SENDEREMAIL_SIGNATURE variables</TITLE>
  <DESCRIPTION>### Bug Hello, I've encountered an issue in Dolibarr regarding email signatures set in a custom email profile (_Setup&gt; Emails &gt; Emails sender profiles_). As far as I understand, the email should be sent with the custom signature specific to the selected email profile, but the email is sent with the personal user signature instead.. Thank you for looking into this issue! Please let me know if any further information is needed ### Dolibarr Version 20.0.3-20.0.4 ### Environment PHP 8.3.17 ### Environment Database MariaDB 10.6.18 ### Steps to reproduce the behavior and expected behavior 1. Create a separate email profile in with a custom signature. 2. Attempt to send an email choosing this custom profile. 3. Insert the variable `__USER_SIGNATURE__` (or `__SENDEREMAIL_SIGNATURE__`) in the email content. **Expected behavior** The email should be sent with the custom signature specific to the selected email profile. **Actual behavior** The email is sent with the personal user signature. ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>9</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #33344 from frederic34/patch-11 fix CI</MESSAGE>
    <SHA>0e28df3ba06979f0a6407662715a71473a4b69da</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #33345 from Daoud-mohamed/fix-sendermail-signature FIX #33206 Custom Email profile signature not applied</MESSAGE>
      <SHA>227557b5d47487d641bed37a7d84eab5d5140f02</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/actions_sendmails.inc.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
