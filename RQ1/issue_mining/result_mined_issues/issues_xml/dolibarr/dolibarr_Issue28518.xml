<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>28518</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/28518</ISSUEURL>
  <TITLE>Issue in ticket closing while, Automatically notify thirdparty when closing a ticket, is ON</TITLE>
  <DESCRIPTION>### Bug PHP returning **FATAL ERROR** while closing a open ticket and selecting, ** All related contacts** as the value for **_Contacts to notify while closing the ticket_**. And there should be option, **_Automatically notify thirdparty when closing a ticket_** should be ON. ### Environment Version 18.0.5 ### Environment OS RHEL ### Environment Web server Apache 2.4.58 ### Environment PHP 8.1.25 ### Environment Database _No response_ ### Environment URL(s) htdocs/ticket/card.php?track_id=rz7aw46ihpio2cx5&amp;action=confirm_close&amp;confirm=yes&amp;token=0805b9791c63e4919416ed3bf01adf1f&amp;contactid=-2 ### Expected and actual behavior All related contacts should get an email notification upon closing a ticket. ### Steps to reproduce the behavior 1. Turn on the option, Automatically notify thirdparty when closing a ticket at Ticket SETUP 2. Now close the ticket. 3. Now confirm ticket closing. (Make sure there is no related contact of the ticket.) ### Attached files ![close](https://github.com/Dolibarr/dolibarr/assets/1249577/56b22456-3288-4ffb-b422-73a1141d3ca4) ![confirm](https://github.com/Dolibarr/dolibarr/assets/1249577/e3bd6c32-57ef-4943-a57c-33c97e471f46) ![error](https://github.com/Dolibarr/dolibarr/assets/1249577/904e087c-2275-4eaf-a0f8-3f715f36fa7f)</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>FIX subscription must be editable when accounting isn't reconciled (#28469)</MESSAGE>
    <SHA>d59e3e5bc8da8252bee5d8102f2e7bca21f51638</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>FIX #28518 (#28520) * #28518 * Update interface_50_modTicket_TicketEmail.class.php --------- Co-authored-by: Laurent Destailleur &lt;eldy@destailleur.fr&gt;</MESSAGE>
      <SHA>042ef30a9f88e9a80c6d1631f2c06955d1ee8135</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/triggers/interface_50_modTicket_TicketEmail.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
