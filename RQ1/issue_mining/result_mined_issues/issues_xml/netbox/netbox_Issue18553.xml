<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>18553</ISSUENO>
  <ISSUEURL>https://github.com/netbox-community/netbox/issues/18553</ISSUEURL>
  <TITLE>Virtualization: Modifying a cluster field also modifies member virtual machine sites</TITLE>
  <DESCRIPTION>### Deployment Type NetBox Cloud ### NetBox Version v4.2.2 ### Python Version 3.12 ### Steps to Reproduce 1. Create a cluster with a blank scope 2. Create some VM's, assign them to the cluster and assign them to a site 3. Edit a field on the cluster (eg description) and save ### Expected Behavior Virtual Machines are not modified. ### Observed Behavior Virtual Machine site fields are cleared to match the cluster scope. Note - there is some validation in netbox whereas a cluster is scoped to a site, you cannot add vms within a different site. This is expected given the cluster as been explicitly scoped. However, modifying a field in the cluster should not impact virtual machines. One big use case for this functionality is if the cluster is not scoped to a specific site - for example in an overlay cluster spanning multiple sites in which case virtual machines within a single cluster may be in multiple sites.</DESCRIPTION>
  <REPONAME>netbox</REPONAME>
  <TIMEDIFFERENCEDAYS>62</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Update source translation strings</MESSAGE>
    <SHA>8f5d273f08bf50ebed7cf5c3a6d6464307740f18</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixes #18553: Update site for VMs only if cluster has a site assigned</MESSAGE>
      <SHA>17bbcd4455a1675981ffd5f981cc6e42226b6d51</SHA>
      <PATCHEDFILES>
        <FILE>netbox/virtualization/apps.py</FILE>
        <FILE>netbox/virtualization/signals.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixes #18553: Update site for VMs only if cluster has a site assigned (#19086)</MESSAGE>
      <SHA>426e6439e3d52959a550def56a1ba3cd411ce525</SHA>
      <PATCHEDFILES>
        <FILE>netbox/virtualization/apps.py</FILE>
        <FILE>netbox/virtualization/signals.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
