<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4531</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/4531</ISSUEURL>
  <TITLE>[shell] cmd volume.deleteEmpty deletes newly created volumes</TITLE>
  <DESCRIPTION>**Describe the bug** A clear and concise description of what the bug is. **System Setup** ``` 3.51 ``` **Expected behavior** deletes only old empty volumes **Additional context** logs: ``` | Jun 3, 2023 @ 02:00:06.534 | I0602 21:00:06.534668 raft_server.go:81 max volume id 6796 ==&gt; 6797 | fast-master-0 | Jun 3, 2023 @ 02:00:06.535 | I0602 21:00:06.534957 store.go:166 In dir /data adds volume:6797 collection:monitoring-thanos replicaPlacement:000 ttl: | fast-volume-2 | Jun 3, 2023 @ 02:00:06.538 | I0602 21:00:06.538425 volume_grpc_client_to_master.go:179 volume server fast-volume-2.s3-fast-volume.service.dcvcs.consul:8080 adds volume 6797 | fast-volume-2 | Jun 3, 2023 @ 02:00:06.538 | I0602 21:00:06.538328 store.go:170 add volume 6797 | fast-volume-2 | Jun 3, 2023 @ 02:00:06.539 | I0602 21:00:06.539199 volume_layout.go:393 Volume 6797 becomes writable | fast-master-0 | Jun 3, 2023 @ 02:00:06.539 | I0602 21:00:06.539111 volume_growth.go:244 Created Volume 6797 on topo:dcvcs:pre-paas-k8s-node5-dcvcs:fast-volume-2.s3-fast-volume.service.dcvcs.consul:8080 | fast-master-0 | Jun 3, 2023 @ 02:00:06.539 | I0602 21:00:06.539229 volume_growth.go:257 Registered Volume 6797 on topo:dcvcs:pre-paas-k8s-node5-dcvcs:fast-volume-2.s3-fast-volume.service.dcvcs.consul:8080 | fast-master-0 | Jun 3, 2023 @ 02:00:10.248 | 2023/06/02 21:00:10 deleting empty volume 6797 from fast-volume-2.s3-fast-volume.service.dcvcs.consul:8080 | fast-cronjob-28095660-bkqld | Jun 3, 2023 @ 02:00:10.350 | I0602 21:00:10.350828 volume_grpc_client_to_master.go:210 volume server fast-volume-2.s3-fast-volume.service.dcvcs.consul:8080 deletes volume 6797 | fast-volume-2 | Jun 3, 2023 @ 02:00:10.350 | I0602 21:00:10.342554 store.go:526 DeleteVolume 6797 | fast-volume-2 | Jun 3, 2023 @ 02:00:10.352 | I0602 21:00:10.352070 volume_layout.go:228 volume 6797 remove from writable | fast-master-0 | Jun 3, 2023 @ 02:00:10.352 | I0602 21:00:10.352083 volume_layout.go:380 Volume 6797 becomes unwritable | fast-master-0 | Jun 3, 2023 @ 02:00:10.352 | I0602 21:00:10.352041 volume_layout.go:223 volume 6797 does not have enough copies | fast-master-0 ```</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>4</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>3.52</MESSAGE>
    <SHA>fb4b61036cd6389b18efc5343b766b1c5512ad1c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: deletes newly created volumes https://github.com/seaweedfs/seaweedfs/issues/4531</MESSAGE>
      <SHA>cc36296bd19c21ab96cf1dfd0ed09d101dbc8963</SHA>
      <PATCHEDFILES>
        <FILE>weed/shell/command_volume_delete_empty.go</FILE>
        <FILE>weed/topology/volume_growth.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix: deletes newly created volumes (#4551) https://github.com/seaweedfs/seaweedfs/issues/4531 Co-authored-by: Konstantin Lebedev &lt;9497591+kmlebedev@users.noreply.github.co&gt;</MESSAGE>
      <SHA>5caff2c0f0bf2038b731b1a9ba557f8234ff78ef</SHA>
      <PATCHEDFILES>
        <FILE>weed/shell/command_volume_delete_empty.go</FILE>
        <FILE>weed/topology/volume_growth.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix: deletes newly created volumes (#4551) https://github.com/seaweedfs/seaweedfs/issues/4531 Co-authored-by: Konstantin Lebedev &lt;9497591+kmlebedev@users.noreply.github.co&gt;</MESSAGE>
      <SHA>cb35b9a09149f51c106365331b2281e3b9f39464</SHA>
      <PATCHEDFILES>
        <FILE>weed/shell/command_volume_delete_empty.go</FILE>
        <FILE>weed/topology/volume_growth.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
