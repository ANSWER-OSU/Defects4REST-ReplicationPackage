<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3424</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/3424</ISSUEURL>
  <TITLE>du outputs wrong size</TITLE>
  <DESCRIPTION>Sponsors SeaweedFS via Patreon https://www.patreon.com/seaweedfs Report issues here. Ask questions here https://stackoverflow.com/questions/tagged/seaweedfs Please ask questions in https://github.com/seaweedfs/seaweedfs/discussions example of a good issue report: https://github.com/seaweedfs/seaweedfs/issues/1005 example of a bad issue report: https://github.com/seaweedfs/seaweedfs/issues/1008 Describe the bug If I place some files into a folder then copy the folder to a weed mount when I run `du -sk` on both the original folder and the copy I get different sizes e.g. original is 16K copy on weed mount reports 2K. weed mount is always under reporting by a long way. System Setup OS Ubuntu 22.04 for master, volume and filers. 3 x masters 3 x filers using CockroachDB or leveldb3 (2 different tests and not at the same time, both systems seem to take far too long to restore the meta data) 6 x volume servers filer.toml ``` [filer.options] recursive_delete = false [leveldb3] enabled = false dir = &quot;/var/seaweedfs/filer/filerldb3&quot; ``` ``` /usr/local/bin/weed -logtostderr volume \ -ip xxxx -ip.bind 0.0.0.0 \ -port 8080 -port.grpc 18080 \ -max 0 -index leveldb \ -dir /var/seaweedfs/volume \ -dataCenter=syd1 -rack=rack1 -mserver=xxxx:9333,xxxx:9333,xxxx:9333 ``` Masters: ``` /usr/local/bin/weed -logtostderr master \ -ip xxxx -ip.bind 0.0.0.0 \ -port 9333 -port.grpc 19333 \ -mdir=/var/seaweedfs/master -defaultReplication=001 \ -volumeSizeLimitMB=30000 \ -peers=xxxx:9333,xxxx:9333,xxxx:9333 ``` weed version version 30GB 3.20 0854171d228951b002efd72076c267f852f2cb15 linux amd64 Expected behavior The output of du should match. Thanks.</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Update pull_request_template.md</MESSAGE>
    <SHA>5266d07dad3905a3a2c68372d4999f408b72efd0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>mount: adjust on du stats reporting fix https://github.com/seaweedfs/seaweedfs/issues/3424</MESSAGE>
      <SHA>0fcb8feabd85f554881412420b918a2daba8394b</SHA>
      <PATCHEDFILES>
        <FILE>weed/mount/weedfs_stats.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
