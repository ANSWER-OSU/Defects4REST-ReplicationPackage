<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>952</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/952</ISSUEURL>
  <TITLE>shell failed to keep connected to localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot;</TITLE>
  <DESCRIPTION>Sponsors SeaweedFS via Patreon https://www.patreon.com/seaweedfs **Describe the bug** ``` root@Ubuntu-1804-bionic-64-minimal:~# /opt/go/bin/weed shell I0506 09:55:37 10573 filer_server.go:103] Reading : Config File &quot;security&quot; Not Found in &quot;[/root /root/.seaweedfs /etc/seaweedfs]&quot; I0506 09:55:37 10573 masterclient.go:60] shell failed to keep connected to localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; I0506 09:55:37 10573 masterclient.go:97] shell failed to connect with master localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; I0506 09:55:38 10573 masterclient.go:60] shell failed to keep connected to localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; I0506 09:55:38 10573 masterclient.go:97] shell failed to connect with master localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; I0506 09:55:39 10573 masterclient.go:60] shell failed to keep connected to localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; I0506 09:55:39 10573 masterclient.go:97] shell failed to connect with master localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; I0506 09:55:40 10573 masterclient.go:60] shell failed to keep connected to localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; I0506 09:55:40 10573 masterclient.go:97] shell failed to connect with master localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; I0506 09:55:41 10573 masterclient.go:60] shell failed to keep connected to localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; I0506 09:55:41 10573 masterclient.go:97] shell failed to connect with master localhost:9333: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = &quot;transport: Error while dialing dial tcp 127.0.0.1:19333: connect: connection refused&quot; ``` **System Setup** Ubuntu 18.04 to start the shell ``` /opt/go/bin/weed shell ``` to start master filer ``` /opt/go/bin/weed -v=0 server -filer=true -ip=159.69.136.31 -dir=/storage/new_master -volume.max=3000 -volume.images.fix.orientation=false -pulseSeconds=5 ``` **Expected behavior** It should start the weed shell. **Additional context** All ports are allowed and no firewall is enabled while doing this.</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>shell: volume.balance runs for each collection, and for ALL at the end</MESSAGE>
    <SHA>86561021270afb5dd1c16e6cccaee48502ad36ec</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>use ip.bind to listen for grpc calls help to avoid https://github.com/chrislusf/seaweedfs/issues/952</MESSAGE>
      <SHA>4c392ca7621832d0d8ef11191ddba411d634f865</SHA>
      <PATCHEDFILES>
        <FILE>weed/command/server.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
