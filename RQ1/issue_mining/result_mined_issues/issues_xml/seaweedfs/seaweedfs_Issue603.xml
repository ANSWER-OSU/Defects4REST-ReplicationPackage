<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>603</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/603</ISSUEURL>
  <TITLE>filer.copy error with weed filer setup with redis&amp;cassandra</TITLE>
  <DESCRIPTION>## Question I setup seaweedfs filer with cassandra, I can upload file to seaweedfs by command curl ,but when I use **filer.copy** to upload lots of files , I got errors, see bellow. I got the same result when using redis. **test with curl** ```shell # curl -F &quot;file=@/etc/resolv.conf&quot; &quot;http://10.110.200.37:8888/abc/def/&quot; {&quot;name&quot;:&quot;resolv.conf&quot;,&quot;size&quot;:74,&quot;fid&quot;:&quot;2,3d185d9b1b&quot;,&quot;url&quot;:&quot;http://10.110.200.175:9080/2,3d185 ``` **test with filer.copy** BTW when I use the id (2,3e6e533926) from command filer.copy, seaweedfs cluster got file actually. ```shell # weed filer.copy -master 10.110.200.175:9333 /root/ceph-cluster http://10.110.200.37:8888/1011020037/etc/ Failed to register file /root/ceph-cluster/ceph-deploy-ceph.log on 10.110.200.37:8888: Failed to register path:/1011020037/etc/ceph-cluster/ceph-deploy-ceph.log on filer:10.110.200.37:8888 to file id:2,3e6e533926 Example: weed filer.copy file_or_dir1 [file_or_dir2 file_or_dir3] http://localhost:8888/path/to/a/folder/ Default Usage: -collection string optional collection name ...... [root@ceph-adm ~]# curl http://10.110.200.175:9333/2,3e6e533926 &lt;a href=&quot;http://10.110.200.177:9080/2,3e6e533926&quot;&gt;Moved Permanently&lt;/a&gt;. [root@ceph-adm ~]# curl http://10.110.200.175:9333/**2,3e6e533926** -L [2017-03-04 14:34:42,315][ceph_deploy.conf][DEBUG ] found configuration file at: /root/.cephdeploy.conf [2017-03-04 14:34:42,316][ceph_deploy.cli][INFO ] Invoked (1.5.37): /usr/bin/ceph-deploy new ceph-mon1.skyinno.com ceph-mon2.skyinno.com ceph-mon3.skyinno.com [2017-03-04 14:34:42,316][ceph_deploy.cli][INFO ] ceph-deploy options: [2017-03-04 14:34:42,317][ceph_deploy.cli][INFO ] username : None [2017-03-04 14:34:42,317][ceph_deploy.cli][INFO ] func : &lt;function new at 0x1422410&gt; [2017-03-04 14:34:42,317][ceph_deploy.cli][INFO ] verbose : False [2017-03-04 14:34:42,317][ceph_deploy.cli][INFO ] overwrite_conf : False [2017-03-04 14:34:42,317][ceph_deploy.cli][INFO ] quiet : False ...... ``` ## version OS: centos7 latest seaweedfs: 0.76 cassandra: 3.11.1 redis: 3.2.1 ## Setup **seaweedfs cluster** - node1 10.110.200.175 ```shell # /usr/bin/weed -log_dir=/weed/master/log master -defaultReplication=020 -port=9333 -mdir=/weed/master/mdir -ip=10.110.200.175 # /usr/bin/weed -log_dir=/weed/volume1/log volume -port=9080 -dir=/weed/volume1/dir -mserver=10.110.200.175:9333 -ip=10.110.200.175 -dataCenter=dc1 -rack=rack1 ``` - node2 10.110.200.176 ```shell # /usr/bin/weed -log_dir=/weed/master/log master -defaultReplication=020 -port=9333 -mdir=/weed/master/mdir -ip=10.110.200.176 -peers=10.110.200.175:9333 # /usr/bin/weed -log_dir=/weed/volume1/log volume -port=9080 -dir=/weed/volume1/dir -mserver=10.110.200.175:9333 -ip=10.110.200.176 -dataCenter=dc1 -rack=rack2 ``` - node3 10.110.200.177 ```shell # /usr/bin/weed -log_dir=/weed/master/log master -defaultReplication=020 -port=9333 -mdir=/weed/master/mdir -ip=10.110.200.177 -peers=10.110.200.175:9333 # /usr/bin/weed -log_dir=/weed/volume1/log volume -port=9080 -dir=/weed/volume1/dir -mserver=10.110.200.175:9333 -ip=10.110.200.177 -dataCenter=dc1 -rack=rack3 ``` **cassandra** follow this https://www.howtoforge.com/tutorial/how-to-install-apache-cassandra-on-centos-7/ **filer** - filer 10.110.200.37 ```shell # weed -log_dir=/weed/filer/log filer -dir=/weed/filer/dir -master=10.110.200.175:9333 -ip=10.110.200.37 -port=8888 -defaultReplicaPlacement=020 -cassandra.server=127.0.0.1 ```</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>94</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #581 from vinhhrv/patch-1 Add Haravan to backers.md</MESSAGE>
    <SHA>d8c275306e942cfec9038878666993cb29bb7f7b</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>add debug message display the error message for debugging https://github.com/chrislusf/seaweedfs/issues/603</MESSAGE>
      <SHA>97f757c669ff52d6149138ee5c21f1b6c17bd59a</SHA>
      <PATCHEDFILES>
        <FILE>weed/operation/filer/register.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
