<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1494</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/1494</ISSUEURL>
  <TITLE>hadoop: filesystem cannot create file</TITLE>
  <DESCRIPTION>**背景：** spark-submit指定history时，向seaweedfs写入log，无效，filer查看目录无日志文件 ``` ./spark-submit \ --name spark-pi \ --class org.apache.spark.examples.SparkPi \ --conf spark.jars.ivy=/tmp/.ivy \ --conf spark.eventLog.enabled=true \ --conf spark.hadoop.fs.seaweedfs.impl=seaweed.hdfs.SeaweedFileSystem \ --conf spark.hadoop.fs.defaultFS=seaweedfs://10.0.13.210:8888 \ --conf spark.eventLog.dir=seaweedfs://10.0.13.210:8888/spark2-history/ \ file:///home/spark-3.0.0-bin-hadoop3.2/examples/jars/spark-examples_2.12-3.0.0.jar ``` **分析：** 通过阅读spark3代码，调用的是fs.create方法 **复现：** 通过以下代码测试，hdfs可以创建出内容为空的文件，seaweedfs协议没有创建出文件，也没有抛异常 ``` public static void main(String[] args) throws IOException { Configuration configuration = new Configuration(); // 指定为HDFS configuration.set(&quot;fs.defaultFS&quot;, &quot;hdfs://10.0.13.210:8020&quot;); // 指定为seaweedfs协议 // configuration.set(&quot;fs.defaultFS&quot;, &quot;seaweedfs://10.0.13.210:8888&quot;); // configuration.set(&quot;fs.seaweedfs.impl&quot;, &quot;seaweed.hdfs.SeaweedFileSystem&quot;); FileSystem fs = FileSystem.get(configuration); fs.create(new Path(&quot;/spark2-history/local-1601049699528.inprogress&quot;)); } ```</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>s3: 1.fix spark reading S3 directory wildcard problem 2.fix the problem of the spark history service writing S3 directory reference git revsion number: b41b7ea4d09616b42edbad87ab71ac4f2b0fa08c</MESSAGE>
    <SHA>402aef8f301403f46b702fbbb63d179caa2b72f3</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>hadoop: filesystem cannot create file issues: https://github.com/chrislusf/seaweedfs/issues/1494</MESSAGE>
      <SHA>95bfec4931260eb7b73c97861c4929623c8321d6</SHA>
      <PATCHEDFILES>
        <FILE>other/java/hdfs3/src/main/java/seaweed/hdfs/SeaweedFileSystemStore.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
