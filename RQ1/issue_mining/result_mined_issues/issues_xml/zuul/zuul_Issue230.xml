<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>230</ISSUENO>
  <ISSUEURL>https://github.com/Netflix/zuul/issues/230</ISSUEURL>
  <TITLE>HttpServletRequestWrapper.getRequest returns wrapped request</TITLE>
  <DESCRIPTION>Since #213 has been fixed I've encountered a never ending while loop in Tomcat's [`ApplicationDispatcher`](https://github.com/apache/tomcat/blob/TOMCAT_8_0_0/java/org/apache/catalina/core/ApplicationDispatcher.java#L907-L908). ``` if (!(current instanceof ServletRequestWrapper)) break; ``` The request is always a `ServletRequestWrapper` unless I unwrap it. Prior to #213 `HttpServletRequestWrapper` did not extend `ServletRequestWrapper`, therefor the loop exited. As I tried to integrate zuul 1.2.2 @markt-asf (tomcat committer) noted in https://github.com/spring-cloud/spring-cloud-netflix/pull/1106#discussion_r67402882 that `HttpServletRequestWrapper.getRequest()` returns wrapped request, which is a bug. I [work around](https://github.com/spring-cloud/spring-cloud-netflix/pull/1106) the issue by overriding `getRequest()` and returning the original request.</DESCRIPTION>
  <REPONAME>zuul</REPONAME>
  <TIMEDIFFERENCEDAYS>5</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #225 from Netflix/issues/127 Fix for #127</MESSAGE>
    <SHA>48594dc4c150b2ce6031f2c772a707ccef53e97c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix for #230 As pointed out, the overriden ServletRequestWrapper.getRequest() method should return the original/underlying ServletRequest rather than the wrapped one.</MESSAGE>
      <SHA>ead90a17ed3506ea04994cc376619a0938a451b3</SHA>
      <PATCHEDFILES>
        <FILE>zuul-core/src/main/java/com/netflix/zuul/http/HttpServletRequestWrapper.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
