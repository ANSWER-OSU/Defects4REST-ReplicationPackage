<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>273</ISSUENO>
  <ISSUEURL>https://github.com/HumanSignal/label-studio/issues/273</ISSUEURL>
  <TITLE>absolute paths break reverse proxies (e.g. nginx)</TITLE>
  <DESCRIPTION>When attempting to stand-up running version behind a nginx reverse proxy, absolute path parameters cause failures. **To Reproduce** Steps to reproduce the behavior: 1. Launch labelstudio 2. Broken image and links will result 3. Inspection of the retrieval paths indicates incorrect path specification **Expected behavior** When using the below code for `nginx`, the application should run correctly at the new URL. ``` http { map $http_upgrade $connection_upgrade { default upgrade; '' close; } server { listen 5000; server_name localhost; location /my_prefix/another { rewrite /my_prefix/another/(.*) /$1 break; rewrite /my_prefix/another / break; proxy_pass http://localhost:8200; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection $connection_upgrade; } } } # code originally from https://github.com/streamlit/streamlit/issues/1139 ``` **Screenshots** Broken page and bad requests. ![page_error_01](https://user-images.githubusercontent.com/12480297/80541828-7aa27b80-8971-11ea-9814-d2e855d2fd09.jpg) ![page_error_02](https://user-images.githubusercontent.com/12480297/80541830-7bd3a880-8971-11ea-8d1f-09f45024fc81.jpg)</DESCRIPTION>
  <REPONAME>label-studio</REPONAME>
  <TIMEDIFFERENCEDAYS>19</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix task counter while reading from text file (#271)</MESSAGE>
    <SHA>ef54d0a6cf5c2bce61c02f5e76ad5517a9e6a4c2</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix URL paths for proxy safety - update JS, HTML pages for proxied safety - attempts to fix issue #273</MESSAGE>
      <SHA>eb9315f8470346f819100406521eb043abbb0d9f</SHA>
      <PATCHEDFILES>
        <FILE>label_studio/static/js/lsb.js</FILE>
        <FILE>label_studio/templates/base.html</FILE>
        <FILE>label_studio/templates/export.html</FILE>
        <FILE>label_studio/templates/labeling.html</FILE>
        <FILE>label_studio/templates/model.html</FILE>
        <FILE>label_studio/templates/render_ls.html</FILE>
        <FILE>label_studio/templates/setup.html</FILE>
        <FILE>label_studio/templates/setup_help.html</FILE>
        <FILE>label_studio/templates/tasks.html</FILE>
        <FILE>label_studio/templates/welcome.html</FILE>
        <FILE>label_studio/utils/io.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix URL paths for proxy safety (#274) * fix URL paths for proxy safety - update JS, HTML pages for proxied safety - attempts to fix issue #273 * fix small error for labeler / task redirect Co-authored-by: Eric Z &lt;ezavesky@research.att.com&gt;</MESSAGE>
      <SHA>2a132cab9857f44aeffac07ec304f86c4bc46db0</SHA>
      <PATCHEDFILES>
        <FILE>label_studio/static/js/lsb.js</FILE>
        <FILE>label_studio/templates/base.html</FILE>
        <FILE>label_studio/templates/export.html</FILE>
        <FILE>label_studio/templates/labeling.html</FILE>
        <FILE>label_studio/templates/model.html</FILE>
        <FILE>label_studio/templates/render_ls.html</FILE>
        <FILE>label_studio/templates/setup.html</FILE>
        <FILE>label_studio/templates/setup_help.html</FILE>
        <FILE>label_studio/templates/tasks.html</FILE>
        <FILE>label_studio/templates/welcome.html</FILE>
        <FILE>label_studio/utils/io.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
