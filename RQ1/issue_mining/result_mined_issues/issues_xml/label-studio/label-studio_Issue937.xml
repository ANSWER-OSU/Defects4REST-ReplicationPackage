<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>937</ISSUENO>
  <ISSUEURL>https://github.com/HumanSignal/label-studio/issues/937</ISSUEURL>
  <TITLE>Unable to import file from GCS storage</TITLE>
  <DESCRIPTION>Hello, I've added GCS cloud storage to import files, When I click Sync it says synced 5task(s), but I'm unable to view those images, when I checked the Container logs I see below error: ERROR: [18/May/2021 17:24:31] &quot;PATCH /api/dm/views/4?project=2 HTTP/1.1&quot; 200 499 [2021-05-18 17:24:31,876] [core.utils.common::custom_exception_handler::85] [ERROR] 6e858289-57ad-4238-9bc2-f11b1d7c079f Error calling the IAM signBytes API: b'{\n &quot;error&quot;: {\n &quot;code&quot;: 403,\n &quot;message&quot;: &quot;Request had insufficient authentication scopes.&quot;,\n &quot;status&quot;: &quot;PERMISSION_DENIED&quot;,\n &quot;details&quot;: [ \n {\n &quot;@type&quot;: &quot;type.googleapis.com/google.rpc.ErrorInfo&quot;,\n &quot;reason&quot;: &quot;ACCESS_TOKEN_SCOPE_INSUFFICIENT&quot;,\n &quot;domain&quot;: &quot;googleapis. com&quot;,\n &quot;metadata&quot;: {\n &quot;service&quot;: &quot;iamcredentials.googleapis.com&quot;,\n &quot;method&quot;: &quot;google.iam.credentials.v1.IAMCredentials.SignBlob&quot;\ n }\n }\n ]\n }\n}\n' Traceback (most recent call last): File &quot;/usr/local/lib/python3.8/dist-packages/rest_framework/views.py&quot;, line 506, in dispatch response = handler(request, *args, **kwargs) File &quot;/label-studio/label_studio/data_manager/api.py&quot;, line 132, in tasks return self.get_paginated_response(serializer.data) File &quot;/usr/local/lib/python3.8/dist-packages/rest_framework/serializers.py&quot;, line 745, in data ret = super().data File &quot;/usr/local/lib/python3.8/dist-packages/rest_framework/serializers.py&quot;, line 246, in data self._data = self.to_representation(self.instance) File &quot;/usr/local/lib/python3.8/dist-packages/rest_framework/serializers.py&quot;, line 663, in to_representation return [ File &quot;/usr/local/lib/python3.8/dist-packages/rest_framework/serializers.py&quot;, line 664, in &lt;listcomp&gt; self.child.to_representation(item) for item in iterable File &quot;/label-studio/label_studio/tasks/serializers.py&quot;, line 144, in to_representation instance.data = instance.resolve_uri(instance.data, proxy=self.context.get('proxy', False)) File &quot;/label-studio/label_studio/tasks/models.py&quot;, line 139, in resolve_uri return storage.resolve_task_data_uri(task_data) File &quot;/label-studio/label_studio/io_storages/base_models.py&quot;, line 68, in resolve_task_data_uri resolved_uri = self.resolve_uri(data) File &quot;/label-studio/label_studio/io_storages/gcs/models.py&quot;, line 159, in resolve_uri resolved_uri = self.resolve_gs(uri) File &quot;/label-studio/label_studio/io_storages/gcs/models.py&quot;, line 103, in resolve_gs return self.python_cloud_function_get_signed_url(bucket_name, key) File &quot;/label-studio/label_studio/io_storages/gcs/models.py&quot;, line 151, in python_cloud_function_get_signed_url signed_url = signed_blob_path.generate_signed_url(expires_at_ms, credentials=signing_credentials, version=&quot;v4&quot;) File &quot;/usr/local/lib/python3.8/dist-packages/google/cloud/storage/blob.py&quot;, line 551, in generate_signed_url return helper( File &quot;/usr/local/lib/python3.8/dist-packages/google/cloud/storage/_signing.py&quot;, line 622, in generate_signed_url_v4 signature_bytes = credentials.sign_bytes(string_to_sign.encode(&quot;ascii&quot;)) File &quot;/usr/local/lib/python3.8/dist-packages/google/auth/compute_engine/credentials.py&quot;, line 404, in sign_bytes return self._signer.sign(message) File &quot;/usr/local/lib/python3.8/dist-packages/google/auth/iam.py&quot;, line 99, in sign response = self._make_signing_request(message) File &quot;/usr/local/lib/python3.8/dist-packages/google/auth/iam.py&quot;, line 81, in _make_signing_request raise exceptions.TransportError( google.auth.exceptions.TransportError: Error calling the IAM signBytes API: b'{\n &quot;error&quot;: {\n &quot;code&quot;: 403,\n &quot;message&quot;: &quot;Request had insufficient aut hentication scopes.&quot;,\n &quot;status&quot;: &quot;PERMISSION_DENIED&quot;,\n &quot;details&quot;: [\n {\n &quot;@type&quot;: &quot;type.googleapis.com/google.rpc.ErrorInfo&quot;,\n &quot; reason&quot;: &quot;ACCESS_TOKEN_SCOPE_INSUFFICIENT&quot;,\n &quot;domain&quot;: &quot;googleapis.com&quot;,\n &quot;metadata&quot;: {\n &quot;service&quot;: &quot;iamcredentials.googleapis.com&quot; ,\n &quot;method&quot;: &quot;google.iam.credentials.v1.IAMCredentials.SignBlob&quot;\n }\n }\n ]\n }\n}\n' [2021-05-18 17:24:31,882] [django.request::log_response::224] [ERROR] Internal Server Error: /api/dm/views/4/tasks/ [18/May/2021 17:24:31] &quot;GET /api/dm/views/4/tasks?page=1&amp;page_size=30&amp;project=2 HTTP/1.1&quot; 500 4009 I've added GOOGLE_APPLICATION_CREDENTIALS with the service account which has storage admin permission. I faced similar issue in previous version as well and i've issue created #614 Following is the screenshot of bucket settings, ![image](https://user-images.githubusercontent.com/30555574/118697833-5a1fba80-b82d-11eb-961d-c98f5550318d.png)</DESCRIPTION>
  <REPONAME>label-studio</REPONAME>
  <TIMEDIFFERENCEDAYS>143</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Update manage users and organizations Move organization and workspace content back into managing access and clarifying details about owner role and other elements</MESSAGE>
    <SHA>52b25a4f3f858aa05eedcbbd596379bc8def6aeb</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Update storage.md Adding a role name for clarity/ease of troubleshooting per issue #937</MESSAGE>
      <SHA>fdeda45627f3ed400617e495dc4a57fd286fa025</SHA>
      <PATCHEDFILES>
        <FILE>docs/source/guide/storage.md</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Beta docs for LSE 2 (#967) * Adding reviewing and annotator metric docs LSE docs for: * reviewing annotations * setting ground truth labels * statistical calculations and formulas for IAA and matching scores * Updating layout for LSE Updating docs layout to account for additional user documentation * Adding manageusers.md Adding doc for RBAC/workspaces/orgs * Changing order New doc layout * Clearer title * Updates for LSE Updating landing page Adding content to quality and managing user drafts Updating title for exporting * New files for LSE security, roles table, and what you get * Merge remote-tracking branch 'origin/master' into docs/LSE-2 * Update whatyouget.md Improving formatting * Security doc updates * Security doc updates * updating URL for managing users to be consistent _ * moving workspaces/org content to a dedicated page * started drafting SSO setup content and federated SAML stuff * finalized draft of security doc content * Update docs for label studio Update docs for comparing LSE with label studio * Update federate access docs Make federated access its own page Updating security docs per feedback from Kolya Updating TOC to make more sense with security docs * Update manage_users.md Update RBAC section with guidance and API example * Update install.md Update server requirements to be a bit more detailed * Update for organizations and workspaces Add diagrams and details about organizations and workspaces * Update signup.md Added a reference to RBAC docs for LSE * Add beta docs banner Add a beta docs banner to all net-new LSE pages * Update security.md Adding references to OWASP vulns that we protect against and also making API security its own section * Update quality.md Update reviewing tasks content * Docs for project and labeling setup Start separating managing and setting up projects from the labeling interface, since each one is pretty detailed * Small doc fixes Cross links and references to LSE * Update setup_project.md Adding annotation settings instructions and some review settings instructions * Update setup_project.md Review settings * Update federated access Updated example and included diagram * Update index.md Updated links and tasks, added a mention of Result too to prep for result ID docs * Update stats.md Cleaned up language for where task agreement is visible in LSE * Update storage.md Fixed Redis notes per slack conversation * Update manage_users.md fixing table display oops * Add install docs Initial drafts and structures of LSE install docs and deploy requirements * Update name and order Update name and order of pages * Update deploy.md Add software requirements for postgres and sqlite versions * Update start.md Update order and add example of checking whether or not you set an environment variable * Update install docs Adding content for installing LSE docs, based on the previous docs. * Update tasks.md Adding expander macros and adding an example of multiple tasks in one JSON file, as well as info about why you might/might not want to have multiple tasks in one JSON. * Update page.ejs Updating to fix mentions with &quot;to Label Studio&quot; too * Update header Adding API doc reference to the page and site header * Update main_menu.ejs Adding API to main menu * Update authentication docs Adding LDAP authentication and updating name of SSO doc topic as a result * Update stats.md Making title shorter * Update review stream docs Updating ground truth and review stream info * Update setup_project.md Adding task distribution for labeling settings and making caveats and pitfalls clearer * Update groundtruth.md Update ground truth documentation with details about managing them and more closely matching product terminology * Update tasks.md Add more details about importing text and adding upper bounds for task import * Update order and headers in TOC Update topic orders and header titles * Update install_enterprise.md Fixing typo with pem * Update manage users and organizations Move organization and workspace content back into managing access and clarifying details about owner role and other elements * Update storage.md Adding a role name for clarity/ease of troubleshooting per issue #937 * Update labeling.md Making a couple sections clearer * Adding LSE icons to differentiate documentation Adding icons throughout the documentation to visually distinguish between Enterprise-only documentation pages and sections * Adding enterprise image Adding enterprise image in more spots * Update label_studio_compare.md review feedback * Update review and ground truth docs Combining review and ground truth docs and updating content for both * Update page.ejs Add GitHub issues link to page footer to encourage docs bugs reports in GitHub * Update _settings.styl Adding &quot;enterprise&quot; purple color to CSS shorthand * Update page.styl Create a CSS div class for enterprise-styled blockquotes Increase overall page width to reduce likelihood of code blocks and tables of being cut off Improve color contrast of table headers so that it no longer matches table rows * Update styling and add img height/width To improve performance and also to distinguish enterprise notes, update styling and add image height and widths throughout * Adding explicit width and height to improve performance Per Lighthouse report * Updating images Updating images in stats page * Update user diagrams Updating and adding diagrams in access page * Update label_studio_compare.md Add links and update checkmark emoji styling * Update index.md Update reference to LSE * Update ml.md Spelling out LS * Update stats diagrams Update stats diagrams and specify explicit height/width for perf reasons * Update _sidebar.styl Update sidebar so that it's more obvious what page you currently have selected * Update storage.md * Rewrite for clarity and UI focus * Add links to API docs * Consolidate troubleshooting section * Added to troubleshooting section * Remove pre-1.0.0 guidance specific to the CLI and redundant BLOB storage content * Update storage.md Cleaning up a couple mentions of AWS options * Update tasks.md Adding helpful anchor links * Update storage.md Updating details about presigned URLs for AWS, GCS, and Azure, plus adding some extra Azure xrefs * Update page.ejs Updating slack link to non-expired one * Update tasks.md Improve guidance for cloud storage links in tasks * Update setup_project.md Adding details about how task overlap works * Add details about publishing project Adding details about how to publish a project * Update security.md Removing placeholder for architecture diagram -- will add when I have it * Update quality.md Update dashboard-related documentation with details about the metrics and information on the dashboard * Update labeling.md Add anchor links Update guidance for performing labeling adding info about labeling overlapping regions added details about labeling with collaborators added info about skipping a task * Update tasks.md Removing .tiff since it only works on safari per max * Create api_migrate.md Create migration/update API documentation * Update api_migrate.md Review feedback * Add few fixes * Add page render fix * Change note style Co-authored-by: nik &lt;nik@heartex.net&gt;</MESSAGE>
      <SHA>39a49971a3e824baeed0aeccf6abff9dd034418f</SHA>
      <PATCHEDFILES>
        <FILE>docs/source/guide/api_migrate.md</FILE>
        <FILE>docs/source/guide/auth_setup.md</FILE>
        <FILE>docs/source/guide/export.md</FILE>
        <FILE>docs/source/guide/federate_access.md</FILE>
        <FILE>docs/source/guide/index.md</FILE>
        <FILE>docs/source/guide/install.md</FILE>
        <FILE>docs/source/guide/install_enterprise.md</FILE>
        <FILE>docs/source/guide/install_enterprise_vpc.md</FILE>
        <FILE>docs/source/guide/label_studio_compare.md</FILE>
        <FILE>docs/source/guide/labeling.md</FILE>
        <FILE>docs/source/guide/manage_users.md</FILE>
        <FILE>docs/source/guide/ml.md</FILE>
        <FILE>docs/source/guide/quality.md</FILE>
        <FILE>docs/source/guide/security.md</FILE>
        <FILE>docs/source/guide/setup.md</FILE>
        <FILE>docs/source/guide/setup_project.md</FILE>
        <FILE>docs/source/guide/signup.md</FILE>
        <FILE>docs/source/guide/start.md</FILE>
        <FILE>docs/source/guide/stats.md</FILE>
        <FILE>docs/source/guide/storage.md</FILE>
        <FILE>docs/source/guide/storedata.md</FILE>
        <FILE>docs/source/guide/tasks.md</FILE>
        <FILE>docs/source/includes/deploy.md</FILE>
        <FILE>docs/themes/htx/layout/page.ejs</FILE>
        <FILE>docs/themes/htx/layout/partials/header.ejs</FILE>
        <FILE>docs/themes/htx/layout/partials/main_menu.ejs</FILE>
        <FILE>docs/themes/htx/layout/partials/sidebar.ejs</FILE>
        <FILE>docs/themes/htx/layout/partials/toc.ejs</FILE>
        <FILE>docs/themes/htx/source/css/_settings.styl</FILE>
        <FILE>docs/themes/htx/source/css/_sidebar.styl</FILE>
        <FILE>docs/themes/htx/source/css/page.styl</FILE>
        <FILE>docs/themes/htx/source/images/LSE/LSE-admin-view.jpg</FILE>
        <FILE>docs/themes/htx/source/images/LSE/LSE-annotator-view.jpg</FILE>
        <FILE>docs/themes/htx/source/images/LSE/LSE-federated-access-diagram.png</FILE>
        <FILE>docs/themes/htx/source/images/LSE/LSE-multiple-orgs-workspaces.jpg</FILE>
        <FILE>docs/themes/htx/source/images/LSE/LSE-one-org-many-workspaces.jpg</FILE>
        <FILE>docs/themes/htx/source/images/LSE/en.svg</FILE>
        <FILE>docs/themes/htx/source/images/LSE/en_1x.png</FILE>
        <FILE>docs/themes/htx/source/images/LSE/en_2x.png</FILE>
        <FILE>docs/themes/htx/source/images/LSE/stats-agreement-example.jpg</FILE>
        <FILE>docs/themes/htx/source/images/LSE/stats-complete-linkage.png</FILE>
        <FILE>docs/themes/htx/source/images/LSE/stats-no_grouping.png</FILE>
        <FILE>docs/themes/htx/source/images/LSE/stats-single-linkage.png</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Doc SEO updates (#1010) * Adding reviewing and annotator metric docs LSE docs for: * reviewing annotations * setting ground truth labels * statistical calculations and formulas for IAA and matching scores * Updating layout for LSE Updating docs layout to account for additional user documentation * Adding manageusers.md Adding doc for RBAC/workspaces/orgs * Changing order New doc layout * Clearer title * Updates for LSE Updating landing page Adding content to quality and managing user drafts Updating title for exporting * New files for LSE security, roles table, and what you get * Merge remote-tracking branch 'origin/master' into docs/LSE-2 * Update whatyouget.md Improving formatting * Security doc updates * Security doc updates * updating URL for managing users to be consistent _ * moving workspaces/org content to a dedicated page * started drafting SSO setup content and federated SAML stuff * finalized draft of security doc content * Update docs for label studio Update docs for comparing LSE with label studio * Update federate access docs Make federated access its own page Updating security docs per feedback from Kolya Updating TOC to make more sense with security docs * Update manage_users.md Update RBAC section with guidance and API example * Update install.md Update server requirements to be a bit more detailed * Update for organizations and workspaces Add diagrams and details about organizations and workspaces * Update signup.md Added a reference to RBAC docs for LSE * Add beta docs banner Add a beta docs banner to all net-new LSE pages * Update security.md Adding references to OWASP vulns that we protect against and also making API security its own section * Update quality.md Update reviewing tasks content * Docs for project and labeling setup Start separating managing and setting up projects from the labeling interface, since each one is pretty detailed * Small doc fixes Cross links and references to LSE * Update setup_project.md Adding annotation settings instructions and some review settings instructions * Update setup_project.md Review settings * Update federated access Updated example and included diagram * Update index.md Updated links and tasks, added a mention of Result too to prep for result ID docs * Update stats.md Cleaned up language for where task agreement is visible in LSE * Update storage.md Fixed Redis notes per slack conversation * Update manage_users.md fixing table display oops * Add install docs Initial drafts and structures of LSE install docs and deploy requirements * Update name and order Update name and order of pages * Update deploy.md Add software requirements for postgres and sqlite versions * Update start.md Update order and add example of checking whether or not you set an environment variable * Update install docs Adding content for installing LSE docs, based on the previous docs. * Update tasks.md Adding expander macros and adding an example of multiple tasks in one JSON file, as well as info about why you might/might not want to have multiple tasks in one JSON. * Update page.ejs Updating to fix mentions with &quot;to Label Studio&quot; too * Update header Adding API doc reference to the page and site header * Update main_menu.ejs Adding API to main menu * Update authentication docs Adding LDAP authentication and updating name of SSO doc topic as a result * Update stats.md Making title shorter * Update review stream docs Updating ground truth and review stream info * Update setup_project.md Adding task distribution for labeling settings and making caveats and pitfalls clearer * Update groundtruth.md Update ground truth documentation with details about managing them and more closely matching product terminology * Update tasks.md Add more details about importing text and adding upper bounds for task import * Update order and headers in TOC Update topic orders and header titles * Update install_enterprise.md Fixing typo with pem * Update manage users and organizations Move organization and workspace content back into managing access and clarifying details about owner role and other elements * Update storage.md Adding a role name for clarity/ease of troubleshooting per issue #937 * Update labeling.md Making a couple sections clearer * Adding LSE icons to differentiate documentation Adding icons throughout the documentation to visually distinguish between Enterprise-only documentation pages and sections * Adding enterprise image Adding enterprise image in more spots * Update label_studio_compare.md review feedback * Update review and ground truth docs Combining review and ground truth docs and updating content for both * Update page.ejs Add GitHub issues link to page footer to encourage docs bugs reports in GitHub * Update _settings.styl Adding &quot;enterprise&quot; purple color to CSS shorthand * Update page.styl Create a CSS div class for enterprise-styled blockquotes Increase overall page width to reduce likelihood of code blocks and tables of being cut off Improve color contrast of table headers so that it no longer matches table rows * Update styling and add img height/width To improve performance and also to distinguish enterprise notes, update styling and add image height and widths throughout * Adding explicit width and height to improve performance Per Lighthouse report * Updating images Updating images in stats page * Update user diagrams Updating and adding diagrams in access page * Update label_studio_compare.md Add links and update checkmark emoji styling * Update index.md Update reference to LSE * Update ml.md Spelling out LS * Update stats diagrams Update stats diagrams and specify explicit height/width for perf reasons * Update _sidebar.styl Update sidebar so that it's more obvious what page you currently have selected * Update storage.md * Rewrite for clarity and UI focus * Add links to API docs * Consolidate troubleshooting section * Added to troubleshooting section * Remove pre-1.0.0 guidance specific to the CLI and redundant BLOB storage content * Update storage.md Cleaning up a couple mentions of AWS options * Update tasks.md Adding helpful anchor links * Update storage.md Updating details about presigned URLs for AWS, GCS, and Azure, plus adding some extra Azure xrefs * Update page.ejs Updating slack link to non-expired one * Update tasks.md Improve guidance for cloud storage links in tasks * Update setup_project.md Adding details about how task overlap works * Add details about publishing project Adding details about how to publish a project * Update security.md Removing placeholder for architecture diagram -- will add when I have it * Updating docs for SEO - Improving meta_titles and descriptions - Removing manual scrub of label studio mentions in TOC because it reduces the likelihood of semantic links, lowering the overall SEO score for each documentation page (use a Lighthouse test in the developer console to confirm) - Updating some topic titles to reduce superfluous mentions of Label Studio - Replacing analytics.js reference with gtag.js script per Google Analytics best practices * Update tasks.md Making the title include Label Studio again * merge master merge master into branch * Remove more unnecessary Label Studio mentions Updating topic titles * Add short title. Add badges * Add short title for api_migrate Add short title and fix up note content * Adding more short titles short titles for everyone! Co-authored-by: nik &lt;nik@heartex.net&gt; Co-authored-by: makseq-ubnt &lt;makseq@gmail.com&gt;</MESSAGE>
      <SHA>e7c0642bee79af10a1643c3ca5bb3c0af21e269d</SHA>
      <PATCHEDFILES>
        <FILE>docs/source/guide/FAQ.md</FILE>
        <FILE>docs/source/guide/api.md</FILE>
        <FILE>docs/source/guide/api_migrate.md</FILE>
        <FILE>docs/source/guide/auth_setup.md</FILE>
        <FILE>docs/source/guide/export.md</FILE>
        <FILE>docs/source/guide/federate_access.md</FILE>
        <FILE>docs/source/guide/frontend.md</FILE>
        <FILE>docs/source/guide/frontend_reference.md</FILE>
        <FILE>docs/source/guide/index.md</FILE>
        <FILE>docs/source/guide/install.md</FILE>
        <FILE>docs/source/guide/install_enterprise.md</FILE>
        <FILE>docs/source/guide/install_enterprise_vpc.md</FILE>
        <FILE>docs/source/guide/label_studio_compare.md</FILE>
        <FILE>docs/source/guide/labeling.md</FILE>
        <FILE>docs/source/guide/manage_users.md</FILE>
        <FILE>docs/source/guide/ml.md</FILE>
        <FILE>docs/source/guide/ml_create.md</FILE>
        <FILE>docs/source/guide/ml_troubleshooting.md</FILE>
        <FILE>docs/source/guide/ml_tutorials.html</FILE>
        <FILE>docs/source/guide/predictions.md</FILE>
        <FILE>docs/source/guide/quality.md</FILE>
        <FILE>docs/source/guide/security.md</FILE>
        <FILE>docs/source/guide/setup.md</FILE>
        <FILE>docs/source/guide/setup_project.md</FILE>
        <FILE>docs/source/guide/signup.md</FILE>
        <FILE>docs/source/guide/start.md</FILE>
        <FILE>docs/source/guide/stats.md</FILE>
        <FILE>docs/source/guide/storage.md</FILE>
        <FILE>docs/source/guide/storedata.md</FILE>
        <FILE>docs/source/guide/tasks.md</FILE>
        <FILE>docs/themes/htx/layout/page.ejs</FILE>
        <FILE>docs/themes/htx/layout/partials/google_analytics.ejs</FILE>
        <FILE>docs/themes/htx/layout/partials/toc.ejs</FILE>
        <FILE>docs/themes/htx/source/css/page.styl</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
