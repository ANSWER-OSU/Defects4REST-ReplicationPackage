<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>11313</ISSUENO>
  <ISSUEURL>https://github.com/traefik/traefik/issues/11313</ISSUEURL>
  <TITLE>Middleware of ForwardAuth returns incorrect location header</TITLE>
  <DESCRIPTION>### Welcome! - [x] Yes, I've searched similar issues on [GitHub](https://github.com/traefik/traefik/issues) and didn't find any. - [x] Yes, I've searched similar issues on the [Traefik community forum](https://community.traefik.io) and didn't find any. ### What did you do? I made an auth server that returns a relative url as the Location header in the response. I'm expecting the relative url will be passed to the downstream and then be resolved by the browser or other clients. ### What did you see instead? ForwardAuth middleware resolves the location header and return the resolved url as the location header in the response. While the correct behavior should just return the original location header. https://github.com/traefik/traefik/blob/33c1d700c02ad09ab793673a14674b39d78fe352/pkg/middlewares/auth/forward.go#L193 For example, - Auth server endpoint address: http://forward-auth.server.local:8080/auth - Auth server response Location header: /index.html - Downstream received response Location header: http://forward-auth.server.local:8080/index.html - Expected Location header: /index.html Note, that the location should be resolved at the customer side, like the browser, which should be relative to the original forwarded domain, not the auth server. ### What version of Traefik are you using? v3.1.6 I checked the latest code. It seems it's still the same behavior. ### What is your environment &amp; configuration? Not related. But can provide if being asked. ### If applicable, please paste the log output in DEBUG level _No response_</DESCRIPTION>
  <REPONAME>traefik</REPONAME>
  <TIMEDIFFERENCEDAYS>10</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Configurable path for sticky cookies</MESSAGE>
    <SHA>ec00c4aa428abbf5ced88e15ac37967098aa17ed</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: fixing issue #11313</MESSAGE>
      <SHA>5b091a8179edefbe23e8a2d7542f26dcd8e34562</SHA>
      <PATCHEDFILES>
        <FILE>pkg/middlewares/auth/forward.go</FILE>
        <FILE>pkg/middlewares/auth/forward_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix: fixing issue #11313</MESSAGE>
      <SHA>b3515f60ad32023311d32cbd62396d682acdb19e</SHA>
      <PATCHEDFILES>
        <FILE>pkg/middlewares/auth/forward.go</FILE>
        <FILE>pkg/middlewares/auth/forward_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix: fixing issue #11313</MESSAGE>
      <SHA>59d610ffe9a89eafd0de1d0dc4e763ffa054f9b6</SHA>
      <PATCHEDFILES>
        <FILE>pkg/middlewares/auth/forward.go</FILE>
        <FILE>pkg/middlewares/auth/forward_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix: fixing issue #11313</MESSAGE>
      <SHA>c5f73d74a2ce05b30b27f6509825f4c2ce924db7</SHA>
      <PATCHEDFILES>
        <FILE>pkg/middlewares/auth/forward.go</FILE>
        <FILE>pkg/middlewares/auth/forward_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fixing issue #11313</MESSAGE>
      <SHA>4ea9aaa43c2100c4f9a8744468fba064ae733346</SHA>
      <PATCHEDFILES>
        <FILE>pkg/middlewares/auth/forward.go</FILE>
        <FILE>pkg/middlewares/auth/forward_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fixing issue #11313</MESSAGE>
      <SHA>3d01802aef0025f9e9e2c0d333625327c4e1c4aa</SHA>
      <PATCHEDFILES>
        <FILE>pkg/middlewares/auth/forward.go</FILE>
        <FILE>pkg/middlewares/auth/forward_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
