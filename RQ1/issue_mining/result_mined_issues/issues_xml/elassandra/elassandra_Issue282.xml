<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>282</ISSUENO>
  <ISSUEURL>https://github.com/strapdata/elassandra/issues/282</ISSUEURL>
  <TITLE>Unable to create geo_shape index</TITLE>
  <DESCRIPTION>Elassandra version: 6.2.3.13-14 jvm: openjdk version &quot;1.8.0_212&quot; OS: Linux 631697ed6903 4.9.0-8-amd64 #1 SMP Debian 4.9.144-3.1 (2019-02-19) x86_64 GNU/Linux docker image: strapdata/elassandra:latest Hello, i'm trying to create geo_shape index for field with following request: PUT http://localhost:9200/weather `{ &quot;settings&quot;: { &quot;keyspace&quot;:&quot;weather&quot; }, &quot;mappings&quot;: { &quot;weather_data&quot; : { &quot;_source&quot;: { &quot;enabled&quot;: true }, &quot;properties&quot;: { &quot;geom&quot;: { &quot;type&quot;:&quot;geo_shape&quot; } } } } }` got the error: `{ &quot;error&quot;: { &quot;root_cause&quot;: [ { &quot;type&quot;: &quot;mapper_parsing_exception&quot;, &quot;reason&quot;: &quot;Failed to execute query:null : Existing column [geom] type [text] mismatch with inferred type [list&lt;text&gt;]&quot; } ], &quot;type&quot;: &quot;mapper_parsing_exception&quot;, &quot;reason&quot;: &quot;Failed to execute query:null : Existing column [geom] type [text] mismatch with inferred type [list&lt;text&gt;]&quot;, &quot;caused_by&quot;: { &quot;type&quot;: &quot;configuration_exception&quot;, &quot;reason&quot;: &quot;Existing column [geom] type [text] mismatch with inferred type [list&lt;text&gt;]&quot; } }, &quot;status&quot;: 400 }` The weather table: `CREATE TABLE weather.weather_data ( id text, updated_at timestamp, alt int, created_at timestamp, es_options text, es_query text, geom text, predict tinyint, radius int, time timestamp, type tinyint, version bigint, weather text, x int, y int, PRIMARY KEY (id, updated_at) ) WITH CLUSTERING ORDER BY (updated_at DESC) AND bloom_filter_fp_chance = 0.01 AND caching = {'keys': 'ALL', 'rows_per_partition': 'NONE'} AND comment = '' AND compaction = {'class': 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy', 'max_threshold': '32', 'min_threshold': '4'} AND compression = {'chunk_length_in_kb': '64', 'class': 'org.apache.cassandra.io.compress.LZ4Compressor'} AND crc_check_chance = 1.0 AND dclocal_read_repair_chance = 0.1 AND default_time_to_live = 0 AND gc_grace_seconds = 864000 AND max_index_interval = 2048 AND memtable_flush_period_in_ms = 0 AND min_index_interval = 128 AND read_repair_chance = 0.0 AND speculative_retry = '99PERCENTILE';` Why geo_shape index needs list&lt;text&gt; type? And if add 'cql_collection' parameter to index request: `{ &quot;settings&quot;: { &quot;keyspace&quot;:&quot;weather&quot; }, &quot;mappings&quot;: { &quot;weather_data&quot; : { &quot;_source&quot;: { &quot;enabled&quot;: true }, &quot;properties&quot;: { &quot;geom&quot;: { &quot;type&quot;:&quot;geo_shape&quot;, &quot;cql_collection&quot;:&quot;singleton&quot; } } } } }` I got the following error: `{ &quot;error&quot;: { &quot;root_cause&quot;: [ { &quot;type&quot;: &quot;mapper_parsing_exception&quot;, &quot;reason&quot;: &quot;Mapping definition for [geom] has unsupported parameters: [cql_collection : singleton]&quot; } ], &quot;type&quot;: &quot;mapper_parsing_exception&quot;, &quot;reason&quot;: &quot;Failed to parse mapping [weather_data]: Mapping definition for [geom] has unsupported parameters: [cql_collection : singleton]&quot;, &quot;caused_by&quot;: { &quot;type&quot;: &quot;mapper_parsing_exception&quot;, &quot;reason&quot;: &quot;Mapping definition for [geom] has unsupported parameters: [cql_collection : singleton]&quot; } }, &quot;status&quot;: 400 }` How can I create geo_shape index with field type 'text'?</DESCRIPTION>
  <REPONAME>elassandra</REPONAME>
  <TIMEDIFFERENCEDAYS>62</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>release 6.2.3.14</MESSAGE>
    <SHA>54f169cc5d13aa1e9c1bf3178e044b91a47dee0e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add support cql for attributes for geo_shape (#282)</MESSAGE>
      <SHA>63d13aeb538d83ac15373879977ba4ba187cee9f</SHA>
      <PATCHEDFILES>
        <FILE>server/src/main/java/org/elasticsearch/index/mapper/GeoShapeFieldMapper.java</FILE>
        <FILE>server/src/main/java/org/elasticsearch/index/mapper/TypeParsers.java</FILE>
        <FILE>server/src/test/java/org/elassandra/CqlTypesTests.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
