<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2681</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/2681</ISSUEURL>
  <TITLE>Render status code when failing to parse JSON</TITLE>
  <DESCRIPTION>When throwing [this error](https://github.com/zeit/now-cli/blob/canary/src/util/index.js#L314), we should include the status code in the message, so that it's easier to debug.</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>7</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>[CircleCI] Fix `test/dev-server.unit.js` being run on CI (#2725) For some reason, `ava` was silently skipping these tests on CI because the process was crashing. According to sindre, this is a bug in `ava`, but with some digging I was able to determine that the root cause of the crash was that the `builders.tar.gz` file from the `assets` dir was not being persisted from the previous `build` job in CI. With the `assets` dir being persisted I now see the `dev-server` unit tests being executed once again as expected. Related to: https://twitter.com/sindresorhus/status/1157614353375551493</MESSAGE>
    <SHA>55b132711944c60965ec46fa186486dc0a750816</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add `accept: application/json` header to API HTTP requests All of the APIs already support JSON by default, so this is a no-op for our APIs, however the proxy layer _does_ respect the `Accept` header to send JSON error responses, which is useful for more gracefully handling outage responses (previously they were being returned as plain text, which Now CLI blindfully tries to parse as JSON and fails with an unhelpful error message). Related to #2681.</MESSAGE>
      <SHA>25824b13f3eccd62ee21b78cf6bfbf412a0bbdb0</SHA>
      <PATCHEDFILES>
        <FILE>src/util/index.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Print HTTP status code upon API JSON parse errors Fixes #2681.</MESSAGE>
      <SHA>13b8e66ae490c8cfb75341c2bda0892d12d9b340</SHA>
      <PATCHEDFILES>
        <FILE>src/util/index.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add `accept: application/json` header to API HTTP requests (#2726) All of the APIs already support JSON by default, so this is a no-op for our APIs, however the proxy layer _does_ respect the `Accept` header to send JSON error responses, which is useful for more gracefully handling outage responses (previously they were being returned as plain text, which Now CLI blindfully tries to parse as JSON and fails with an unhelpful error message). Related to #2681.</MESSAGE>
      <SHA>718100fafc5cadef981916c999fc2a0893a4c0d6</SHA>
      <PATCHEDFILES>
        <FILE>src/util/index.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Print HTTP status code upon API JSON parse errors (#2727) Fixes #2681.</MESSAGE>
      <SHA>9e961b479c1ba689c7a1c532544d3c0b6cc07c7e</SHA>
      <PATCHEDFILES>
        <FILE>src/util/index.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add `accept: application/json` header to API HTTP requests (#2726) All of the APIs already support JSON by default, so this is a no-op for our APIs, however the proxy layer _does_ respect the `Accept` header to send JSON error responses, which is useful for more gracefully handling outage responses (previously they were being returned as plain text, which Now CLI blindfully tries to parse as JSON and fails with an unhelpful error message). Related to #2681.</MESSAGE>
      <SHA>2e30bbef7e91c951aa8ecdd0d24fd5de522cb76d</SHA>
      <PATCHEDFILES>
        <FILE>src/util/index.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Print HTTP status code upon API JSON parse errors (#2727) Fixes #2681.</MESSAGE>
      <SHA>031067869af4f8477e3cb885d9a031d05ee5034d</SHA>
      <PATCHEDFILES>
        <FILE>src/util/index.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
