<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>212</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/212</ISSUEURL>
  <TITLE>Version 2.0.0 install broke `now`</TITLE>
  <DESCRIPTION>I got the message: ```bash &gt; UPDATE NEEDED Current: 1.0.0 – Latest 2.0.0 (released 5m ago) &gt; Run `npm install -g now` to update ``` I then ran ```bash npm install -g now ``` This is the output: ``` /usr/bin/now -&gt; /usr/lib/node_modules/now/bin/now - babel-runtime@6.5.0 node_modules/now/node_modules/async-retry/node_modules/babel-runtime - core-js@2.4.1 node_modules/now/node_modules/babel-runtime/node_modules/core-js - exit-hook@1.1.1 node_modules/now/node_modules/exit-hook - regenerator-runtime@0.10.1 node_modules/now/node_modules/regenerator-runtime /usr/lib └─┬ now@2.0.0 ├─┬ async-retry@0.2.1 │ └── babel-runtime@6.5.0 ├─┬ async-to-gen@1.3.0 │ ├── babylon@6.14.1 │ └─┬ magic-string@0.19.0 │ └── vlq@0.2.1 ├─┬ ora@0.4.1 │ └─┬ cli-cursor@2.1.0 │ └─┬ restore-cursor@2.0.0 │ ├─┬ onetime@2.0.0 │ │ └── mimic-fn@1.1.0 │ └── signal-exit@3.0.2 └─┬ update-notifier@1.0.3 ├─┬ boxen@0.6.0 │ ├── ansi-align@1.1.0 │ ├── camelcase@2.1.1 │ ├── cli-boxes@1.0.0 │ ├── filled-array@1.1.0 │ ├─┬ repeating@2.0.1 │ │ └─┬ is-finite@1.0.2 │ │ └── number-is-nan@1.0.1 │ ├─┬ string-width@1.0.2 │ │ ├── code-point-at@1.1.0 │ │ └── is-fullwidth-code-point@1.0.0 │ └── widest-line@1.0.0 ├─┬ configstore@2.1.0 │ ├─┬ dot-prop@3.0.0 │ │ └── is-obj@1.0.1 │ ├── osenv@0.1.4 │ ├── uuid@2.0.3 │ └─┬ write-file-atomic@1.3.1 │ ├── imurmurhash@0.1.4 │ └── slide@1.1.6 ├── is-npm@1.0.0 ├─┬ latest-version@2.0.0 │ └─┬ package-json@2.4.0 │ ├─┬ got@5.7.1 │ │ ├── duplexer2@0.1.4 │ │ ├── node-status-codes@1.0.0 │ │ ├─┬ parse-json@2.2.0 │ │ │ └─┬ error-ex@1.3.0 │ │ │ └── is-arrayish@0.2.1 │ │ ├── read-all-stream@3.1.0 │ │ ├── timed-out@3.1.3 │ │ └── unzip-response@1.0.2 │ ├── registry-auth-token@3.1.0 │ └── registry-url@3.1.0 ├── lazy-req@1.1.0 ├─┬ semver-diff@2.1.0 │ └── semver@5.3.0 └─┬ xdg-basedir@2.0.0 └── os-homedir@1.0.2 ``` This happens when running `now ls` ```bash → now ls /usr/lib/node_modules/now/bin/now-list:72 .then(async token =&gt; { ^^^^^ SyntaxError: missing ) after argument list at Object.exports.runInThisContext (vm.js:76:16) at Module._compile (module.js:542:28) at Module._extensions..js (module.js:579:10) at Object.require.extensions.(anonymous function) [as .js] (/usr/lib/node_modules/now/node_modules/async-to-gen/register.js:40:5) at Module.load (module.js:487:32) at tryModuleLoad (module.js:446:12) at Function.Module._load (module.js:438:3) at Module.require (module.js:497:17) at require (internal/module.js:20:19) at Object.&lt;anonymous&gt; (/usr/lib/node_modules/now/bin/now:83:1) ``` or for `now help`: ```bash /usr/lib/node_modules/now/bin/now-deploy:218 async function sync(token) { ^^^^^^^^ SyntaxError: Unexpected token function at Object.exports.runInThisContext (vm.js:76:16) at Module._compile (module.js:542:28) at Module._extensions..js (module.js:579:10) at Object.require.extensions.(anonymous function) [as .js] (/usr/lib/node_modules/now/node_modules/async-to-gen/register.js:40:5) at Module.load (module.js:487:32) at tryModuleLoad (module.js:446:12) at Function.Module._load (module.js:438:3) at Module.require (module.js:497:17) at require (internal/module.js:20:19) at Object.&lt;anonymous&gt; (/usr/lib/node_modules/now/bin/now:83:1) ```</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Publish - @now/node-bridge@1.0.0-canary.2 - @now/node-server@0.4.27-canary.7 - @now/node@0.4.29-canary.7</MESSAGE>
    <SHA>44c9f3765addcc29cadea84f64549f1aab4ffba3</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[now-node] Migrate to TypeScript and use `@now/node-bridge` v1 (#212) This moves `@now/node` to being implemented in TypeScript. It also updates it to use the latest `@now/node-bridge`, which removes the hard-coded port 3000 that was previously in-place, which was problematic for `now dev`. Now the `http.Server` instance listens on an ephemeral port which is detected by the Now node runtime.</MESSAGE>
      <SHA>8dc0c92c586d7d55e720d96359b8e2741845bb0f</SHA>
      <PATCHEDFILES>
        <FILE>.circleci/build.sh</FILE>
        <FILE>.circleci/config.yml</FILE>
        <FILE>package.json</FILE>
        <FILE>packages/now-node/.gitignore</FILE>
        <FILE>packages/now-node/.npmignore</FILE>
        <FILE>packages/now-node/launcher.js</FILE>
        <FILE>packages/now-node/package.json</FILE>
        <FILE>packages/now-node/src/bridge.d.ts</FILE>
        <FILE>packages/now-node/src/index.ts</FILE>
        <FILE>packages/now-node/src/launcher.ts</FILE>
        <FILE>packages/now-node/tsconfig.json</FILE>
        <FILE>yarn.lock</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
