<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>300</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/300</ISSUEURL>
  <TITLE>Add option to specify .env file in now.json</TITLE>
  <DESCRIPTION>I use 'now -E' to deploy a .env file when deploying Next.js projects to now, which is a really great feature. Sometimes, I irritatingly forget to specify the '-E' flag when running 'now' and have to redeploy. It would great if I could specify the option to also deploy a .env file in in now.json so I don't need to remember to specify '-E' each time - perhaps by file name, for those than might want to have different .env files for different environments. Tagging in @timneutkens after discussing on Slack</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>[now-node] Enable TypeScript `strict` mode (#321)</MESSAGE>
    <SHA>c97ad02acacbab7376c39dc66ff53229ced371d1</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[now-rust] Allow extra static files on the lambda fs `config.includeFiles` (#300) This add the ability to include other files into the filesystem of the lambda. This works by providing an `includeFiles` option in the builder config, and then moving those into the lambda when it's created. The `includeFiles` option is a glob matcher relative to the entrypoint. **Note:** This is the first example I know of that allows a user to add more files to the filesystem through the official now builders. This API is something I came up with, and may not be the best or what y'all are thinking. ## Why? This is helpful for my specific case, where I need extra binaries on the system when the lambda executes (`wget` and `now`). This could also be useful to include large files to parse, or other things one wouldn't want to include in the rust binary itself due to file size, memory allocation, whatever. ## Example **Local file structure** ``` now_lambda/ ├── Cargo.lock ├── Cargo.toml ├── src │ └── main.rs └── static ├── now └── wget ``` **Now config** ```json { &quot;version&quot;: 2, &quot;name&quot;: &quot;now-lambda&quot;, &quot;builds&quot;: [ { &quot;src&quot;: &quot;Cargo.toml&quot;, &quot;use&quot;: &quot;@now/rust&quot;, &quot;config&quot;: { &quot;includeFiles&quot;: &quot;static/*&quot;, &quot;maxLambdaSize&quot;: &quot;50mb&quot; } } ] } ``` **Lambda file structure** ``` /var/task/ ├── bootstrap └── static ├── now └── wget ``` ## Testing You can use `https://mike-now-rust-5shu849in.now.sh` as the builder's `&quot;use&quot;` key to test it out. It's a hosted tarball of this PR with a little extra debugging thrown in.</MESSAGE>
      <SHA>d7f13717994edf650463693844e5ef5d53867a8c</SHA>
      <PATCHEDFILES>
        <FILE>packages/now-rust/index.js</FILE>
        <FILE>packages/now-rust/package.json</FILE>
        <FILE>packages/now-rust/test/fixtures/01-include-files/Cargo.lock</FILE>
        <FILE>packages/now-rust/test/fixtures/01-include-files/Cargo.toml</FILE>
        <FILE>packages/now-rust/test/fixtures/01-include-files/now.json</FILE>
        <FILE>packages/now-rust/test/fixtures/01-include-files/src/main.rs</FILE>
        <FILE>packages/now-rust/test/fixtures/01-include-files/static/sample.txt</FILE>
        <FILE>packages/now-rust/test/test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
