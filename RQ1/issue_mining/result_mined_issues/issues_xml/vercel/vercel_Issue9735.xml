<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>9735</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/9735</ISSUEURL>
  <TITLE>Error: Cannot find module 'path-to-regexp'</TITLE>
  <DESCRIPTION>Looks like `@vercel/node` depends on `path-to-regexp` at runtime, but that dependency is [specified as a dev dependency](https://github.com/vercel/vercel/blob/main/packages/node/package.json#L62) for `@vercel/node`. ``` Require stack: - C:\app\node_modules\@vercel\node\dist\utils.js - C:\app\node_modules\@vercel\node\dist\dev-server.js at Function.Module._resolveFilename (node:internal/modules/cjs/loader:1075:15) at Function.Module._resolveFilename.sharedData.moduleResolveFilenameHook.installedValue [as _resolveFilename] (C:\app\node_modules\@cspotcode\source-map-support\source-map-support.js:811:30) at Function.Module._load (node:internal/modules/cjs/loader:920:27) at Module.require (node:internal/modules/cjs/loader:1141:19) at require (node:internal/modules/cjs/helpers:110:18) at Object.&lt;anonymous&gt; (C:\app\node_modules\@vercel\node\dist\utils.js:5:26) at Module._compile (node:internal/modules/cjs/loader:1254:14) at Module._extensions..js (node:internal/modules/cjs/loader:1308:10) at Object.require.extensions.&lt;computed&gt; [as .js] (C:\app\node_modules\ts-node\src\index.ts:1608:43) at Module.load (node:internal/modules/cjs/loader:1117:32) { code: 'MODULE_NOT_FOUND', requireStack: [ 'C:\\app\\node_modules\\@vercel\\node\\dist\\utils.js', 'C:\\app\\node_modules\\@vercel\\node\\dist\\dev-server.js' ] } ```</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>19</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>[cli] Add `vc deploy --no-wait` and `vc inspect --wait` (#9802) There's a need to allow `vc deploy` to not block and not wait for the deployment to finish, yet return the URL. ``` $ vc deploy --no-wait Vercel CLI 28.18.5 Inspect: https://vercel.com/chrisbarber/next13fun/L8X4oxp5LGcmy51yVptXwMK7n4wt [1s] Note: Deployment is still processing... ✅ Production: https://next13fun-kecpx6za2-chrisbarber.vercel.app [1s] ``` Normally this deployment takes around 30 seconds, but the `--no-wait` flag causes the command to exit in less than 2 seconds. The next step is to add the ability for `vc inspect` to wait as well as specify the maximum time to wait (defaults to 3 minutes, same as `vc rollback`). ``` $ vc inspect --wait --timeout 1m https://next13fun-kecpx6za2-chrisbarber.vercel.app Vercel CLI 28.18.5 &gt; Fetched deployment &quot;next13fun-ov2r4pvdz-chrisbarber.vercel.app&quot; in chrisbarber [23s] General id dpl_9VUuV23EGeoqWf7akEeL8rP1c8cb name next13fun status ● Ready url https://next13fun-ov2r4pvdz-chrisbarber.vercel.app created Thu Apr 13 2023 12:25:07 GMT-0500 (Central Daylight Time) [24s ago] &lt;snip&gt; ``` Also added the ability to pipe the URL into `vc inspect`: ``` echo https://next13fun-ov2r4pvdz-chrisbarber.vercel.app | vc inspect ``` Combined, it allows us to support cool things like: ``` $ vc inspect $(vc deploy --prod --no-wait) --wait ```</MESSAGE>
    <SHA>b52df7a533160f605f5584e2e5401e3701297ade</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[node] Move `path-to-regexp` and `ts-morph` from dev deps to deps (#9823) `@vercel/node` uses `ncc` to bundle the `index.js` spawns the dev server entrypoint which does not bundle the required dependencies, thus `path-to-regexp` and `ts-morph` must be moved from dev dependencies to dependencies. Fixes #9735.</MESSAGE>
      <SHA>2081f10b221fee2c7172ebf1e9f75c3a58de8a2e</SHA>
      <PATCHEDFILES>
        <FILE>packages/node/build.js</FILE>
        <FILE>packages/node/package.json</FILE>
        <FILE>pnpm-lock.yaml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
