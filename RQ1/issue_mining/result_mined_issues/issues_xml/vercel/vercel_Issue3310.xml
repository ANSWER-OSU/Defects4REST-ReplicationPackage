<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3310</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/3310</ISSUEURL>
  <TITLE>[now-client] Missing dist files</TITLE>
  <DESCRIPTION>The published version of `now-client` is missing its distribution files. It started happening after 5.2.1 update. https://unpkg.com/now-client@5.2.1 https://unpkg.com/now-client@5.2.2 https://unpkg.com/now-client@5.2.3</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>[script] Cleanup changelog script (#3306) This script is only used for stable releases so we should filter out canary publish commits.</MESSAGE>
    <SHA>4c8c6ff23683597c3a4fc50a20d4c27de3a78d01</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[now-client] Fix publish output (#3315) Fixes #3310 The root `package.json` file is copied to `dist` by tsc because of a relative import. This causes npm `files` property to be nested and therefore skip publishing most of the files. ```ts import pkg from '../../package.json'; ``` Disabling `resolveJsonModule` and using `require()` instead fixed it. However, this change caused `now-cli` build to fail so I had to change the way `now-client` gets imported.</MESSAGE>
      <SHA>f6fdde816fc1cc258e19371f78cda1faee5a1b01</SHA>
      <PATCHEDFILES>
        <FILE>packages/now-cli/package.json</FILE>
        <FILE>packages/now-cli/src/util/deploy/process-deployment.ts</FILE>
        <FILE>packages/now-client/package.json</FILE>
        <FILE>packages/now-client/src/pkg.ts</FILE>
        <FILE>packages/now-client/src/utils/index.ts</FILE>
        <FILE>packages/now-client/tsconfig.json</FILE>
        <FILE>yarn.lock</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
