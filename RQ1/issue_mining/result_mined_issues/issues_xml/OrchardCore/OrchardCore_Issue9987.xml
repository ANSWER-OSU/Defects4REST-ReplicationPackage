<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>9987</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/9987</ISSUEURL>
  <TITLE>error page from &quot;OrchardCore.Diagnostics&quot; module isn't presented when [ValidateAntiForgeryToken] attribute is used and validation failed</TITLE>
  <DESCRIPTION>### Describe the bug Sometimes, when my &quot;**orchantiforgery_**&quot; cookie expires, and when login page is still opened in browser, I can't log in, because of **[AntiforgeryValidationException](https://github.com/dotnet/aspnetcore/blob/main/src/Antiforgery/src/Internal/DefaultAntiforgery.cs)** which is expected behavior, but instead of seeing error page from 'OrchardCore.Diagnostics' I see default one. ### You can reproduce the issue by removing &quot;**orchantiforgery_**&quot; cookie, or by manipulating with html code. Steps to reproduce the behavior: 1. Make sure 'OrchardCore.Diagnostics' module is enabled, 2. Go to 'https://try.orchardcore.net/Login', 3. Inspect page and change value of '__RequestVerificationToken' input, 4. Click on 'Log in', 5. See default 400 error page. ![image](https://user-images.githubusercontent.com/6403130/127175417-abf4d68c-f20a-4c69-b218-6e7403632915.png) ### Expected behavior This error page should be presented to the user: ![image](https://user-images.githubusercontent.com/6403130/127174996-7c5d6750-0d0d-48a8-9b70-be2359477b9e.png)</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>44</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Add Content-Language HTTP header feature (#10178)</MESSAGE>
    <SHA>742637ecee32ecbeb89c69a85d3af78d4f9cb0f0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Diagnostics module fix (#9987)</MESSAGE>
      <SHA>4be41da724af3d8aa4d605e79e0b8c135edf3690</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Diagnostics/Controllers/DiagnosticsController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Diagnostics/OrchardCore.Diagnostics.csproj</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Diagnostics module fix (#9987)</MESSAGE>
      <SHA>b7ab4df06092a4ba8ea36f5c9dd49e00bd3ca163</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Diagnostics/Controllers/DiagnosticsController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Diagnostics/OrchardCore.Diagnostics.csproj</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Diagnostics module fix (#9987) (#10206)</MESSAGE>
      <SHA>c8484f6be77a5f49c6210e8adaea648b391a82e7</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Diagnostics/Controllers/DiagnosticsController.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
