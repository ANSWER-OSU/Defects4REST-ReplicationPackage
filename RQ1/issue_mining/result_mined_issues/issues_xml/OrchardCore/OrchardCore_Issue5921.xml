<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5921</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/5921</ISSUEURL>
  <TITLE>ShapeTableProvider from feature not recognized</TITLE>
  <DESCRIPTION>When adding an `IShapeTableProvider` as a feature the descriptor is not recognized by the `ShapeTableManager` until the site is hard reset. I think the static Shape Descriptor Dictionary already has an entry for the Feature, that the `IShapeTableProvider` is altering, so the new alteration is skipped on rebuild of the shape table. Clearing the `_shapeDescriptors.Clear()` resolves the issue, but not in a good way. For repro refer https://github.com/OrchardCMS/OrchardCore/pull/5862</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>4</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>typo: Rename meta in resources</MESSAGE>
    <SHA>b48650e1a6054d63e95c9b13e59fdf5476fc6730</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixes #5921 shape table providers</MESSAGE>
      <SHA>61c54503183509acb86d1b4d1f82eca2f0bfe75d</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore/OrchardCore.DisplayManagement/Descriptors/DefaultShapeTableManager.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.DisplayManagement/Descriptors/ShapeTemplateStrategy/ShapeTemplateBindingStrategy.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixes #5921 shape table providers (#5938)</MESSAGE>
      <SHA>86eff6d207da7467164a346ca8486f56fac2db92</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.ContentFields/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.ContentLocalization/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Facebook/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Features/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Forms/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.GitHub/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Lists/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Media.Azure/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Media/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Microsoft.Authentication/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Microsoft.Authentication/Startup.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.OpenId/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Queries/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Templates/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Twitter/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Widgets/Manifest.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.DisplayManagement/Descriptors/DefaultShapeTableManager.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.DisplayManagement/Descriptors/ShapeTemplateStrategy/ShapeTemplateBindingStrategy.cs</FILE>
        <FILE>test/OrchardCore.Tests.Modules/ModuleSample/Manifest.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
