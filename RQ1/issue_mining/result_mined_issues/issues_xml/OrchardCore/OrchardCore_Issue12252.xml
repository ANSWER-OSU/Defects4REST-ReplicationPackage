<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>12252</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/12252</ISSUEURL>
  <TITLE>Unexpected expection thrown when testing the email settings with an invalid email</TITLE>
  <DESCRIPTION>### Describe the bug When testing the email settings with an invalid email format, the SmtpService display the following error ``` An error occurred while sending an email: 'Unexpected 'A' token at offset 5' ``` ### To Reproduce Steps to reproduce the behavior: 1. Enable `OC.Email` feature 2. Click on Configuration &gt;&gt; Settings &gt;&gt; Email 3. Make sure the email settings is configured. then click on &quot;Test settings&quot; button 4. Provide invalid formatted email address in the &quot;sender&quot; field. 5. Provide &quot;To&quot; email, &quot;Subject&quot; and &quot;Body&quot; and click send. ### Expected behavior A clear and concise description of what you expected to happen. ### Screenshots If applicable, add screenshots to help explain your problem.</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>8</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>monacoEditorVersion</MESSAGE>
    <SHA>94a301a6f0fda5488b005071ea316457d624ecaf</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix #12252</MESSAGE>
      <SHA>381f675cff2a7959aa644b2fad62480af6318bbd</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Email/Controllers/AdminController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Email/ViewModels/SmtpSettingsViewModel.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Email.Core/Services/SmtpService.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix SmtpService to validate email address (#12253) * Fix #12252</MESSAGE>
      <SHA>9c2a03b31462423691ede1df528eb2219d1a18f2</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Email/ViewModels/SmtpSettingsViewModel.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Email.Core/Services/SmtpService.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
