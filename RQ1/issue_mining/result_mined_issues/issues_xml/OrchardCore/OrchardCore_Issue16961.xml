<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>16961</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/16961</ISSUEURL>
  <TITLE>SQL Query fails with &quot;ORDER BY random()&quot;</TITLE>
  <DESCRIPTION>### Describe the bug SQL Query with random ordering fails with: ```Syntax error, expected: ASC, DESC, ., ,, ), LIMIT, OFFSET, UNION, ;, WITH, SELECT at line:5, col:15``` ### Orchard Core version Latest 2.0 ### To Reproduce 1. Go to Admin Panel -&gt; Search -&gt; SQL Queries 2. Create/Run query: ``` SELECT DocumentId FROM ContentItemIndex WHERE ContentType='BlogPost' and Published = true ORDER BY random() LIMIT 10 ``` ### Expected behavior Should return random 10 `BlogPost` content items. ### Logs and screenshots ![image](https://github.com/user-attachments/assets/2f26007b-1e62-4045-aa90-e616172b4a09)</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Template content validation (#16944) Co-authored-by: Hisham Bin Ateya &lt;hishamco_2007@yahoo.com&gt;</MESSAGE>
    <SHA>898449b150416bf2223b2a8197b5bab6ae1f98f0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add support for random order in sql queries Fixes #16961</MESSAGE>
      <SHA>3aa6ab8249cc4ecc8b0db6af1efafcc9cd893dd5</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Queries/Sql/SqlGrammar.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Queries/Sql/SqlParser.cs</FILE>
        <FILE>test/OrchardCore.Tests/Orchard.Queries/SqlParserTests.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
