<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>13888</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/13888</ISSUEURL>
  <TITLE>Make 2FA requirement extensible</TITLE>
  <DESCRIPTION>### Is your feature request related to a problem? Please describe. Currently, two factor authentication is decided the settings found in `LoginSettings.RequireTwoFactorAuthentication`. In some case, a user may have additional logic to determine if 2FA should be required or not. Here are some examples - Require authentication after x amount of login. - Require 2FA if the user is on external network. - Require 2FA if the user is not on a known network. ### Describe the solution you'd like Use handler to determine 2FA should be required or not.</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Add @derandre84 as a contributor</MESSAGE>
    <SHA>4c8918398befdf823ec78929ebd203c6b82b8fdf</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Make 2FA requirement extensible. Fix #13888</MESSAGE>
      <SHA>71ca0687975dbc408f891ec514c5040a43f2933c</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Controllers/TwoFactorAuthenticationController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Filters/TwoFactorAuthenticationAuthorizationFilter.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Services/TwoFactorAuthenticationClaimsProvider.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Abstractions/Events/ITwoFactorAuthenticationHandler.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Abstractions/Events/ITwoFactorAuthenticationHandlerCoordinator.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Core/Extensions/UsersServiceCollectionExtensions.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Core/Services/DefaultTwoFactorAuthenticationHandler.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Core/Services/DefaultTwoFactorAuthenticationHandlerCoordinator.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
