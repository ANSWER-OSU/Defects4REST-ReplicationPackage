<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2573</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/2573</ISSUEURL>
  <TITLE>Kubernetes Multi-arch support</TITLE>
  <DESCRIPTION>I am running image: drone/drone:1.0.0-rc.4-linux-arm64 and created a simple build job. Drone creates a new kubernetes job that fails to execute because it uses amd64 docker image: ``` .... &quot;annotations&quot;: { &quot;io.drone.build.id&quot;: &quot;2&quot;, &quot;io.drone.repo.id&quot;: &quot;1&quot;, &quot;io.drone.stage.arch&quot;: &quot;arm64&quot;, &quot;io.drone.stage.created&quot;: &quot;2019-01-12 16:46:49 +0000 UTC&quot;, &quot;io.drone.stage.id&quot;: &quot;2&quot;, &quot;io.drone.stage.number&quot;: &quot;1&quot;, &quot;io.drone.stage.os&quot;: &quot;linux&quot;, .... &quot;spec&quot;: { &quot;containers&quot;: [ { &quot;name&quot;: &quot;drone-controller&quot;, &quot;image&quot;: &quot;drone/controller:linux-amd64&quot;, ``` Setting DRONE_RUNNER_PLATFORM=linux/arm64 did not have any effect. I think it would be best, if the arch would be extracted from the pipeline definition or uses a simple image name to use docker resolution of the right image through multi-arch manifest file.</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>5</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Use repo edit and repo view permissions for space label handling (#2569) * Use repo edit and repo view permissions for space label handling</MESSAGE>
    <SHA>af6e94ba2ce1a9f46c4dd8a45c664955f7194a3f</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: [AH-306c]: fix anonymous flow (#2573) * lint fixes * fix: [AH-306]: fix anonymous flow - address review comments * fix: [AH-306c]: fix anonymous flow - address review comments * fix: [AH-306c]: fix anonymous flow * fix: [AH-306c]: fix anonymous flow * fix: [AH-306c]: fix anonymous flow</MESSAGE>
      <SHA>d52a142cdb4931a54721c7f94eae0e5be4dcc537</SHA>
      <PATCHEDFILES>
        <FILE>registry/app/api/controller/metadata/base.go</FILE>
        <FILE>registry/app/api/controller/metadata/utils.go</FILE>
        <FILE>registry/app/remote/adapter/native/adapter.go</FILE>
        <FILE>registry/app/store/database/artifact.go</FILE>
        <FILE>registry/app/store/database/registry.go</FILE>
        <FILE>registry/app/store/database/tag.go</FILE>
        <FILE>registry/app/store/database/upstream_proxy.go</FILE>
        <FILE>registry/app/store/database/util/utils.go</FILE>
        <FILE>registry/types/upstream_proxy_config.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
