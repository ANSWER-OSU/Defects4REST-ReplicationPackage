<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1222</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/1222</ISSUEURL>
  <TITLE>Running droned produces an panic</TITLE>
  <DESCRIPTION>Hi, I am using a docker container pulled from docker hub, more info here: hub.docker.com/r/drone/drone I have edited the drone.toml contained in /gopath/src/github.com/drone/drone/packaging/root/etc/drone/ to try to configure drone with a gogs webhook. However, the following panic message pops up when running &quot;droned --config=/gopath/src/github.com/drone/drone/packaging/root/etc/drone/droned.toml&quot;: ``` root@6cedb887917c:/gopath/src/github.com/drone/drone/packaging/root/etc/drone# droned --config=/gopath/src/github.com/drone/drone/packaging/root/etc/drone/drone.toml panic: listen tcp :80: bind: address already in use goroutine 1 [running]: main.main() /gopath/src/github.com/drone/drone/server/main.go:157 +0xc37 goroutine 7 [syscall]: os/signal.loop() /usr/local/go/src/os/signal/signal_unix.go:21 +0x1f created by os/signal.init·1 /usr/local/go/src/os/signal/signal_unix.go:27 +0x35 goroutine 10 [runnable]: github.com/drone/drone/server/datastore/database.(*Commitstore).KillCommits(0xc20802b050, 0xc208058500, 0xc20802b050) /gopath/src/github.com/drone/drone/server/datastore/database/commit.go:102 created by main.main /gopath/src/github.com/drone/drone/server/main.go:105 +0x317 goroutine 9 [chan receive]: database/sql.(*DB).connectionOpener(0xc208058500) /usr/local/go/src/database/sql/sql.go:589 +0x4c created by database/sql.Open /usr/local/go/src/database/sql/sql.go:452 +0x31c goroutine 17 [syscall, locked to thread]: runtime.goexit() /usr/local/go/src/runtime/asm_amd64.s:2232 +0x1 ``` The same panic occurs not matter what I do to the drone.toml file (even use the default config), including saving the config file in another location and configuring with an alternative port number. ``` packaging/root/etc/drone# droned panic: listen tcp :80: bind: address already in use goroutine 1 [running]: main.main() /gopath/src/github.com/drone/drone/server/main.go:157 +0xc37 goroutine 7 [syscall]: os/signal.loop() /usr/local/go/src/os/signal/signal_unix.go:21 +0x1f created by os/signal.init·1 /usr/local/go/src/os/signal/signal_unix.go:27 +0x35 goroutine 9 [chan receive]: database/sql.(*DB).connectionOpener(0xc208058500) /usr/local/go/src/database/sql/sql.go:589 +0x4c created by database/sql.Open /usr/local/go/src/database/sql/sql.go:452 +0x31c goroutine 17 [syscall, locked to thread]: runtime.goexit() /usr/local/go/src/runtime/asm_amd64.s:2232 +0x1 goroutine 10 [runnable]: github.com/drone/drone/server/datastore/database.(*Commitstore).KillCommits(0xc2080fd520, 0xc208058500, 0xc2080fd520) /gopath/src/github.com/drone/drone/server/datastore/database/commit.go:102 created by main.main /gopath/src/github.com/drone/drone/server/main.go:105 +0x317 ``` Your thoughts / advice will be greatly appreciated.</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>16</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix: [code-1731] add vulnerabilityScanning behind ff for code and gitness (#1191)</MESSAGE>
    <SHA>b55fce19cdbabbd7eae074e4f132b3439705c1a3</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add closed timestamp to pull req (#1222)</MESSAGE>
      <SHA>9699ec503dee41a87d4732f38373562397508017</SHA>
      <PATCHEDFILES>
        <FILE>app/api/controller/pullreq/pr_state.go</FILE>
        <FILE>app/store/database/migrate/postgres/0049_alter_table_pullreq_add_closed.down.sql</FILE>
        <FILE>app/store/database/migrate/postgres/0049_alter_table_pullreq_add_closed.up.sql</FILE>
        <FILE>app/store/database/migrate/sqlite/0049_alter_table_pullreq_add_closed.down.sql</FILE>
        <FILE>app/store/database/migrate/sqlite/0049_alter_table_pullreq_add_closed.up.sql</FILE>
        <FILE>app/store/database/pullreq.go</FILE>
        <FILE>types/pullreq.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
