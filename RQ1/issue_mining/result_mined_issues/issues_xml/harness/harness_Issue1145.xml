<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1145</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/1145</ISSUEURL>
  <TITLE>Secure environment variables encrypted in Yaml</TITLE>
  <DESCRIPTION>Currently we have the ability to store private environment variables in the database. I'd like to expand this capability to store encrypted environment variables in the yaml itself, similar to travis. ``` yaml secure: docker_user: U2FsdGVkX19g96OdOIRPtVNGzPP1CgGlxRxRVDvlVHZKYrulqPLlYFG3TfUw53Gk docker_pass: U2FsdGVkX18B3tY76uPxLe2tA6UzaBrVMMsArAUS4bo= ``` the secure parameters are decrypted at runtime and injected into your build yaml, similar to how we inject private variables (entered in the UI) or matrix parameters: ``` yaml deploy: docker: email: $$docker_user password: $$docker_pass ``` Unlike travis, injecting the private parameters as environment variables is not sufficient since publish, deploy and notify sections (which are typically the only sections that require such secrets) are executed outside of the build container and expect very specific parameters in the yaml. This is a result of the new 0.4 plugin model. So for now we need to inject using the same syntax as matrix and private variables. I will spend some time, however, thinking up alternate approaches ...</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>20</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>add feed endpoint for wall</MESSAGE>
    <SHA>1cc2e3d4d6605de06e426a4f04bdbcdc4780d95c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>initial implementation and endpoint for #1145</MESSAGE>
      <SHA>06ef899c26cd27c61ceb37b184c415da6bd011a8</SHA>
      <PATCHEDFILES>
        <FILE>cmd/drone-server/drone.go</FILE>
        <FILE>pkg/server/commits.go</FILE>
        <FILE>pkg/server/hooks.go</FILE>
        <FILE>pkg/server/repos.go</FILE>
        <FILE>pkg/yaml/secure/secure.go</FILE>
        <FILE>pkg/yaml/secure/secure_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
