<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>10411</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/10411</ISSUEURL>
  <TITLE>Inventory source first sync error</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Bug Report ##### SUMMARY First inventory source first sync error ##### STEPS TO REPRODUCE 1. Create a new inventory source - Sources - Sourced from a project. &lt;img width=&quot;1456&quot; alt=&quot;image&quot; src=&quot;https://user-images.githubusercontent.com/9053044/121542913-85359e00-c9d6-11eb-81c8-fb33b50f225d.png&quot;&gt; 2. It will be redirect to &lt;img width=&quot;1458&quot; alt=&quot;image&quot; src=&quot;https://user-images.githubusercontent.com/9053044/121543539-fd9c5f00-c9d6-11eb-9cc7-cae122f5f87c.png&quot;&gt; 3. Click `Sync`. 4. Immediately click `Back to Sources` 5. Error - That seems to occur just on the first ever sync of the the sources. &lt;img width=&quot;1345&quot; alt=&quot;image&quot; src=&quot;https://user-images.githubusercontent.com/9053044/121543787-32a8b180-c9d7-11eb-956e-52fe160558ab.png&quot;&gt;</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #10416 from mabashian/10400-search-keys Addresses bug where advanced search by groups wasn't working on host list SUMMARY link #10400 OK so this got a bit more complicated than I wanted it to but I think on the whole this is a nice improvement. In the initial bug report it was noted that we were ignoring the or/not operators when searching on a related key (in this case it was groups). We were also ignoring the modifier at the end (icontains, exact, startswith, etc). Since we were always defaulting to __search for these types of keys this was actually valid. The API doesn't like us attempting to do something like ?or__groups__search=foo or ?groups__search__icontains because they aren't valid. So, I changed the UX a little bit. A user can still do a fuzzy search on a related key but the prefix is disabled in this case: I changed the third dropdown (specifically for related keys) to contain the following options: search, id, name__icontains which I think would be the three most general cases. id and name__icontains do allow for prefixing (or, not, and). This should make searching on related keys a little bit easier and a little bit more flexible since name and id weren't possible in the UI before. Once place where this is a little different is the host filter in the smart inventory form. Using __search currently throws an error when the user attempts to save. I believe this is an API bug and will file it as such but for now I prevent users from attempting to use __search by removing it as an option for this particular list. When this bug gets fixed in the API we can remove this logic. I also noticed that there was a bug where or__ search terms were being converted to and when using the Smart Inventory button on the host list so I fixed that. Here's the fix in action: ISSUE TYPE Bugfix Pull Request COMPONENT NAME UI Reviewed-by: Kersom &lt;None&gt; Reviewed-by: Tiago GÃ³es &lt;tiago.goes2009@gmail.com&gt;</MESSAGE>
    <SHA>63aacd4e38abb0c453d17ba3d5667976bdb8e1ca</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #10417 from mabashian/10411-inv-src-sync-details Fixes bug where source list page would crash if first sync was running SUMMARY link #10411 The ID being passed to the cancel button was incorrect as well. We want to reference current_job not last_job. ISSUE TYPE Bugfix Pull Request COMPONENT NAME UI Reviewed-by: Jake McDermott &lt;yo@jakemcdermott.me&gt; Reviewed-by: Kersom &lt;None&gt; Reviewed-by: Sarah Akus &lt;sarah.akus@gmail.com&gt;</MESSAGE>
      <SHA>8a6656aa90398cebbf18dc62b7682bae496f6a32</SHA>
      <PATCHEDFILES>
        <FILE>awx/ui_next/src/screens/Inventory/InventorySources/InventorySourceList.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/InventorySources/InventorySourceList.test.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/InventorySources/InventorySourceListItem.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/InventorySources/InventorySourceListItem.test.jsx</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
