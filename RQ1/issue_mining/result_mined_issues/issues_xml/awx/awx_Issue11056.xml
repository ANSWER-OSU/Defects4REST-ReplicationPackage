<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>11056</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/11056</ISSUEURL>
  <TITLE>AWX 19.0+ OVIRT Inventory Source Doesn't work</TITLE>
  <DESCRIPTION>### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary I am trying to get AWX to use my OVIRT installation as an inventory, but it is failing to sync the hosts. ### AWX version AWX 19 ### Installation method kubernetes ### Modifications no ### Ansible version What is included in AWX-EE (which is 2.11) ### Operating system CentOS Stream ### Web browser Firefox ### Steps to reproduce 1. Create ovirt credentials 2. Add inventory 3. Add inventory source 4. Select ovirt credential. ### Expected results I should be able to sync inventory ### Actual results ``` config file = None configured module search path = ['/home/runner/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules'] ansible python module location = /usr/local/lib/python3.8/site-packages/ansible ansible collection location = /home/runner/.ansible/collections:/usr/share/ansible/collections:/usr/share/automation-controller/collections executable location = /usr/local/bin/ansible-inventory python version = 3.8.6 (default, Jan 29 2021, 17:38:16) [GCC 8.4.1 20200928 (Red Hat 8.4.1-1)] jinja version = 2.10.3 libyaml = True No config file found; using defaults [WARNING]: * Failed to parse /runner/inventory/ovirt.yml with auto plugin: inventory config '/runner/inventory/ovirt.yml' specifies unknown plugin 'ovirt' File &quot;/usr/local/lib/python3.8/site-packages/ansible/inventory/manager.py&quot;, line 290, in parse_source plugin.parse(self._inventory, self._loader, source, cache=cache) File &quot;/usr/local/lib/python3.8/site-packages/ansible/plugins/inventory/auto.py&quot;, line 53, in parse raise AnsibleParserError(&quot;inventory config '{0}' specifies unknown plugin '{1}'&quot;.format(path, plugin_name)) [WARNING]: Unable to parse /runner/inventory/ovirt.yml as an inventory source ERROR! No inventory was parsed, please check your configuration and options. ``` ### Additional information As far as I can tell, ovirt is included in the container: ``` bash-4.4$ ls -la /usr/share/ansible/collections/ansible_collections/ total 0 drwxr-xr-x. 13 root root 178 Sep 6 12:05 . drwxr-xr-x. 3 root root 33 Sep 6 12:04 .. drwxr-xr-x. 3 root root 17 Sep 6 12:05 amazon drwxr-xr-x. 4 root root 34 Sep 6 12:05 ansible drwxr-xr-x. 3 root root 17 Sep 6 12:05 awx drwxr-xr-x. 3 root root 26 Sep 6 12:05 azure drwxr-xr-x. 3 root root 20 Sep 6 12:05 community drwxr-xr-x. 3 root root 19 Sep 6 12:05 google drwxr-xr-x. 3 root root 18 Sep 6 12:05 kubernetes drwxr-xr-x. 3 root root 19 Sep 6 12:05 openstack drwxr-xr-x. 3 root root 19 Sep 6 12:05 ovirt drwxr-xr-x. 3 root root 22 Sep 6 12:05 redhatinsights drwxr-xr-x. 3 root root 21 Sep 6 12:05 theforeman ``` So it doesn't look like I should rebuild the container. It seems to happen with most awx-ee versions, as I tried: - 0.1.1 - 0.6.0 - devel - latest It seems to be similar to this PR: https://github.com/ansible/awx/issues/9746 Notably, I am able to query the ovirt from within the awx-ee container: ``` bash-4.4$ ansible-inventory -i /runner/inventory/ --host cn01 { &quot;affinity_groups&quot;: [], &quot;affinity_labels&quot;: [], &quot;cluster&quot;: &quot;Default&quot;, &quot;creation_time&quot;: &quot;2021-07-25 01:56:17.680000+00:00&quot;, &quot;creation_time_timestamp&quot;: 1627178177.68, &quot;description&quot;: &quot;&quot;, &quot;devices&quot;: { &quot;enp1s0&quot;: [ &quot;192.168.3.53&quot;, &quot;fe80::6dc4:616d:ce22:a2af&quot; ] }, &quot;fqdn&quot;: &quot;cn01&quot;, &quot;host&quot;: &quot;ovirt04.example.com&quot;, &quot;id&quot;: &quot;b3f12479-0346-453a-848f-93947b7634e5&quot;, &quot;name&quot;: &quot;cn01&quot;, &quot;os&quot;: &quot;other_linux&quot;, &quot;statistics&quot;: { &quot;cpu.current.guest&quot;: 0.48, &quot;cpu.current.hypervisor&quot;: 0.0, &quot;cpu.current.total&quot;: 0.48, &quot;cpu.usage.history&quot;: 0.0, &quot;disks.usage&quot;: null, &quot;elapsed.time&quot;: 1041019.0, &quot;memory.buffered&quot;: 0.0, &quot;memory.cached&quot;: 0.0, &quot;memory.free&quot;: 1481633792.0, &quot;memory.installed&quot;: 2147483648.0, &quot;memory.unused&quot;: 724025344.0, &quot;memory.usage.history&quot;: 31.0, &quot;memory.used&quot;: 665719930.0, &quot;migration.progress&quot;: 100.0, &quot;network.current.total&quot;: 0.0, &quot;network.usage.history&quot;: 0.0 }, &quot;status&quot;: &quot;up&quot;, &quot;tags&quot;: [], &quot;template&quot;: &quot;Blank&quot; } ``` incidentally, this is what my inventory file looks like when I was testing from within the container: ``` --- plugin: ovirt.ovirt.ovirt ovirt_url: https://ovirt-engine.example.com/ovirt-engine/api ovirt_username: admin@internal ovirt_password: mypassword ``` This suggests that the ovirt template was being generated with: ``` plugin: ovirt ``` Rather than: ``` plugin: ovirt.ovirt.ovirt ``` Though it is not clear how I can definitely prove that to be the case. I did try to specify `plugin: ovirt.ovirt.ovirt` in the source variables in an attempt to override the default, with no effects.</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>629</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>[ui] Minor tweak to capitalize GPG properly (#12734) &quot;GPG Public Key&quot;, not &quot;Gpg Public Key&quot; Signed-off-by: Rick Elrod &lt;rick@elrod.me&gt;</MESSAGE>
    <SHA>08124256712f776135dc08e368ffd5eb3939bee9</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix ovirt source fixes #11056</MESSAGE>
      <SHA>e553560d3f666615ff40ae8de5a2ba39b6f65ffa</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/models/inventory.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix ovirt source fixes #11056</MESSAGE>
      <SHA>655286dbc53ffbdff481e776dfdf158269b92f0d</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/models/inventory.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix ovirt source fixes #11056</MESSAGE>
      <SHA>607cabf55b22936dd4fadb56f6cdc47a17fdb5c1</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/models/inventory.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix ovirt source fixes #11056</MESSAGE>
      <SHA>c066ffa033bcef614393e04b89123d10eaa27279</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/models/inventory.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
