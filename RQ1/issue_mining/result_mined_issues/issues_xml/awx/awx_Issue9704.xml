<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>9704</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/9704</ISSUEURL>
  <TITLE>AWX 18.0.0: Inventory Source from a Project not work</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Bug Report ##### SUMMARY Inventory Source from a Project seems not work in AWX 18.0.0 ##### ENVIRONMENT * AWX version: 18.0.0 * AWX install method: AWX Operator * Operating System: Ubuntu 20.04 + k3s v1.20.0+k3s2 (Kubernetes) * EE: Default EE (built-in in AWX 18.0.0) ##### STEPS TO REPRODUCE 1. Add an SCM Project in AWX + sync the project 2. Add an Inventory in AWX 3. Add Inventory Source (Source from a Project type) and set Inventory file field to `hosts` or `hosts.yml` 4. Run sync ##### EXPECTED RESULTS Inventory Sourced from a Project correctly works, as in 17.1.0 ##### ACTUAL RESULTS ``` ansible-inventory [core 2.11.0b2.post0] config file = /tmp/pdd_wrapper_216_g6ozu0ty/awx_216_8ectkurh/project/ansible.cfg configured module search path = ['/home/runner/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules'] ansible python module location = /usr/local/lib/python3.8/site-packages/ansible ansible collection location = /runner/requirements_collections:/tmp/pdd_wrapper_216_g6ozu0ty/awx_216_8ectkurh/project/collections:/home/runner/.ansible/collections:/usr/share/ansible/collections executable location = /usr/local/bin/ansible-inventory python version = 3.8.3 (default, Aug 31 2020, 16:03:14) [GCC 8.3.1 20191121 (Red Hat 8.3.1-5)] jinja version = 2.10.3 libyaml = True Using /tmp/pdd_wrapper_216_g6ozu0ty/awx_216_8ectkurh/project/ansible.cfg as config file host_list declined parsing /runner/project/hosts.yml as it did not pass its verify_file() method Skipping due to inventory source not existing or not being readable by the current user script declined parsing /runner/project/hosts.yml as it did not pass its verify_file() method Skipping due to inventory source not existing or not being readable by the current user auto declined parsing /runner/project/hosts.yml as it did not pass its verify_file() method Skipping due to inventory source not existing or not being readable by the current user yaml declined parsing /runner/project/hosts.yml as it did not pass its verify_file() method Skipping due to inventory source not existing or not being readable by the current user ini declined parsing /runner/project/hosts.yml as it did not pass its verify_file() method Skipping due to inventory source not existing or not being readable by the current user toml declined parsing /runner/project/hosts.yml as it did not pass its verify_file() method [WARNING]: Unable to parse /runner/project/hosts.yml as an inventory source ERROR! No inventory was parsed, please check your configuration and options. ``` ##### ADDITIONAL INFORMATION I checked inside `awx-ee` Pod's container and in private-data-dir (e.g. /tmp/pdd_wrapper_216_g6ozu0ty/awx_216_8ectkurh/) i found a file called `args` with content below: ``` bash-4.4$ more /tmp/pdd_wrapper_216_g6ozu0ty/awx_216_8ectkurh/args ansible-inventory --list --export -i /runner/project/hosts.yml --output /runner/artifacts/output.json --playbook-dir /runner/project -vvvvv ``` It seems wrong 'cause it refers to /runner directory but all project and execution files are placed in /tmp/pdd_wrapper_[...] directories I dunno if problem is related to all hardcoded /runner os.path in file [https://github.com/ansible/awx/blob/9a61c4368784c421e47551e4175020ced116f56e/awx/main/tasks.py](https://github.com/ansible/awx/blob/9a61c4368784c421e47551e4175020ced116f56e/awx/main/tasks.py#L2521) At the moment Inventory Source from Project seems unusable in AWX 18.0.0. I hope this can be analized soon. Thank you</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>13</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #9748 from shanemcd/runner-2-alpha-1 Use Ansible Runner 2.0 alpha 1 Reviewed-by: Yanis Guenane &lt;None&gt;</MESSAGE>
    <SHA>63798df06c153b2cf69dba8db3e63aa817165184</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #9741 from shanemcd/fix-project-inventories Fix inventories-from-projects when running in Kubernetes Related: #9704 Will also require a new release of the operator which will contain ansible/awx-operator#155 Reviewed-by: Elijah DeLee &lt;kdelee@redhat.com&gt; Reviewed-by: Chris Meyers &lt;None&gt; Reviewed-by: Bianca Henderson &lt;beeankha@gmail.com&gt;</MESSAGE>
      <SHA>c16079e5f82950e3a0c6803ce09ed333264e48b4</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/management/commands/create_preload_data.py</FILE>
        <FILE>awx/main/management/commands/inventory_import.py</FILE>
        <FILE>awx/main/models/inventory.py</FILE>
        <FILE>awx/main/models/mixins.py</FILE>
        <FILE>awx/main/tasks.py</FILE>
        <FILE>awx/main/tests/functional/api/test_instance_group.py</FILE>
        <FILE>awx/main/tests/functional/conftest.py</FILE>
        <FILE>awx/main/tests/functional/task_management/test_container_groups.py</FILE>
        <FILE>awx/main/tests/unit/scheduler/test_kubernetes.py</FILE>
        <FILE>awx/main/utils/execution_environments.py</FILE>
        <FILE>awx/settings/defaults.py</FILE>
        <FILE>awx_collection/test/awx/conftest.py</FILE>
        <FILE>awx_collection/test/awx/test_completeness.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
