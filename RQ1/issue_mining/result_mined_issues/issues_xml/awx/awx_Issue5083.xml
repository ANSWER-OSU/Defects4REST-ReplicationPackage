<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5083</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/5083</ISSUEURL>
  <TITLE>if a container group is full, fall back to other instance/container group</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Feature Idea Currently, in certain scenarios jobs can end up getting funneled to Container Groups because they always **seem** to have capacity from the Tower side. Due to this naive concept of capacity, jobs may get less-than-optimally sent to the ContainerGroup where they may end up waiting on resources, while meanwhile resources are free'd up in other instance groups or container groups, leading to the job sitting in pending for longer than it needs to (or in worst case for a very saturated k8s cluster, failing due to time out waiting for resources, while there was other place it could have run). To resolve this, we should do some kind of introspection to find out if the container group is &quot;full&quot; or if the job is schedulable. If so, we can redirect it to another instance group or wait until some other resource is available instead of dispatching it to the container group where it may very well time out and fail before running. ##### SUMMARY &lt;!-- Briefly describe the problem or desired enhancement. --&gt; This RFE replaces the bug report https://github.com/ansible/awx/issues/4990</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>464</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #5060 from sarabrajsingh/release_4.0 backport of #10425 to Tower 4.0 Release</MESSAGE>
    <SHA>aa333af2d250a2a79abb20d7c1d67a743968c319</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #5083 from wenottingham/lacking-in-insights Remove insights_credential from inventory</MESSAGE>
      <SHA>0adb93ed7840908e3d629a5fe89b69437a8e7839</SHA>
      <PATCHEDFILES>
        <FILE>awx/api/serializers.py</FILE>
        <FILE>awx/main/access.py</FILE>
        <FILE>awx/main/migrations/0149_remove_inventory_insights_credential.py</FILE>
        <FILE>awx/main/models/inventory.py</FILE>
        <FILE>awx/main/tests/functional/api/test_credential.py</FILE>
        <FILE>awx/main/tests/functional/api/test_inventory.py</FILE>
        <FILE>awx/main/tests/unit/models/test_inventory.py</FILE>
        <FILE>awx/ui_next/src/screens/Credential/CredentialDetail/CredentialDetail.test.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Credential/CredentialList/CredentialList.test.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/InventoryAdd/InventoryAdd.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/InventoryAdd/InventoryAdd.test.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/InventoryDetail/InventoryDetail.test.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/InventoryEdit/InventoryEdit.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/InventoryEdit/InventoryEdit.test.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/InventoryList/InventoryList.test.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/shared/InventoryForm.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/shared/InventoryForm.test.jsx</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/shared/data.inventory.json</FILE>
        <FILE>awx/ui_next/src/screens/Inventory/shared/data.smart_inventory.json</FILE>
        <FILE>awx/ui_next/src/util/getRelatedResouceDeleteDetails.test.js</FILE>
        <FILE>awx/ui_next/src/util/getRelatedResourceDeleteDetails.js</FILE>
        <FILE>awx_collection/plugins/modules/inventory.py</FILE>
        <FILE>awx_collection/test/awx/test_inventory.py</FILE>
        <FILE>awx_collection/tests/integration/targets/inventory/tasks/main.yml</FILE>
        <FILE>awxkit/awxkit/api/pages/inventory.py</FILE>
        <FILE>awxkit/awxkit/cli/options.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
