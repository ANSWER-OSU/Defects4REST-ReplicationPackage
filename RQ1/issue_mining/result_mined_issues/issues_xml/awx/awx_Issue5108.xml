<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5108</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/5108</ISSUEURL>
  <TITLE>k8s &quot;create django super user if it does not exist&quot; fails if DB migrations are not completed.</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Deployment failure ##### SUMMARY &lt;!-- Briefly describe the problem. --&gt; Deployment fails due to task &quot;create django super user if it does not exist&quot; failing because DB migration are not completed yet. ##### ENVIRONMENT * AWX version: 8.0.0 * AWX install method: kubernetes * Ansible version: 2.8.4 * Operating System: MacOS/Ubuntu * Web Browser: ##### STEPS TO REPRODUCE awx deployment on some kubernetes environments fails due to DB migrations not completed. Specifically the&quot;create django super user if it does not exist&quot; task fails if migrations are not completed. As a temporary fix i had to run the deployment with the --step config option and wait a couple of minutes for the Migrate database task to complete (it can be seen looking at the awx-celery container logs). ##### EXPECTED RESULTS &lt;!-- What did you expect to happen when running the steps above? --&gt; Deployment to complete without issues ##### ACTUAL RESULTS &lt;!-- What actually happened? --&gt; ##### ADDITIONAL INFORMATION &lt;!-- Include any links to sosreport, database dumps, screenshots or other information. --&gt;</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>7</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #5091 from amolgautam25/rename-creds-inv Removed references to tower in InventorySource and Credentials</MESSAGE>
    <SHA>e3e0e11a6cbbf82ab503c7aaa1708b4ed244e5ac</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #5108 from fosterseth/fix_rename_tower_token Rename tower_token to controller_token</MESSAGE>
      <SHA>37f7fd85eade393cfcbe58080ebbf1dfcc7db56a</SHA>
      <PATCHEDFILES>
        <FILE>awx_collection/plugins/modules/token.py</FILE>
        <FILE>awx_collection/tests/integration/targets/token/tasks/main.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
