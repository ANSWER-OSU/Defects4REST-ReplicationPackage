<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>13131</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/13131</ISSUEURL>
  <TITLE>Job failed if Job Slicing and Fact Storage enabled together</TITLE>
  <DESCRIPTION>### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary Job failed if Job Slicing and Fact Storage enabled together `Traceback (most recent call last): File &quot;/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/tasks/jobs.py&quot;, line 504, in run self.instance.start_job_fact_cache( File &quot;/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/models/jobs.py&quot;, line 862, in start_job_fact_cache hosts = hosts.filter(ansible_facts_modified__gte=timeout) AttributeError: 'list' object has no attribute 'filter'` ### AWX version AWX 21.7.0 ### Select the relevant components - [ ] UI - [ ] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method kubernetes ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce 1. Create Job Template. 2. Make sure the Job Slicing &gt;2. 3. Enable Enable Fact Storage flag 4. Launch job ### Expected results Job is done ### Actual results Job failed with error: `Traceback (most recent call last): File &quot;/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/tasks/jobs.py&quot;, line 504, in run self.instance.start_job_fact_cache( File &quot;/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/models/jobs.py&quot;, line 862, in start_job_fact_cache hosts = hosts.filter(ansible_facts_modified__gte=timeout) AttributeError: 'list' object has no attribute 'filter'` ### Additional information _No response_</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>13</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #13082 from AlanCoding/health_check_stdout Include stdout from health check if it is not nothing</MESSAGE>
    <SHA>ed318ea78405a2654d7eb9319f6d373b34e5a7a5</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix traceback on timeout with slicing + facts Slicing a QS with a step parameter forces the QS and returns a list. Fixes #13131 Signed-off-by: Rick Elrod &lt;rick@elrod.me&gt;</MESSAGE>
      <SHA>087ab56965e028348adb942fc6a5d82330adb6b9</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/models/inventory.py</FILE>
        <FILE>awx/main/models/jobs.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix traceback on timeout with slicing + facts (#13139) Slicing a QS with a step parameter forces the QS and returns a list. Fixes #13131 Signed-off-by: Rick Elrod &lt;rick@elrod.me&gt;</MESSAGE>
      <SHA>1bedf32bafa365a890190026c2331abae450acdd</SHA>
      <PATCHEDFILES>
        <FILE>awx/main/models/inventory.py</FILE>
        <FILE>awx/main/models/jobs.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
