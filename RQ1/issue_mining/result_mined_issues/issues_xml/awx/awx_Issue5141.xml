<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5141</ISSUENO>
  <ISSUEURL>https://github.com/ansible/awx/issues/5141</ISSUEURL>
  <TITLE>HashiCorp Vault Secret Lookup: Test requires Sysadmin permissions</TITLE>
  <DESCRIPTION>##### ISSUE TYPE - Bug Report ##### SUMMARY The &quot;HashiCorp Vault Secret Lookup&quot; and &quot;Hashicorp Vault Signed SSH&quot; Credential Types provide both a test option which check if the parameters are working. In both cases the running the test case requires sysadmin permissions. ##### ENVIRONMENT * AWX version: 7.0.0 * AWX install method: docker on linux * Ansible version: 2.7.11 * Operating System: Debian 9 * Web Browser: Firefox 69 ##### STEPS TO REPRODUCE Login to AWX as non-sysadmin user. In the AWX Webinterface go to &quot;Credentials&quot; and create a new Credential of Type &quot;HashiCorp Vault Secret Lookup&quot;. Fill in &quot;Server Url&quot;, &quot;token&quot; and if necessary CA Certificate. Then open the &quot;Test external credential&quot; form by clicking the &quot;Test&quot; Buttion. Fill in &quot;path to secret&quot; and &quot;key name&quot; then click &quot;run&quot;. The Test will fail. If you run the same steps as sysadmin user, then the test will succeed. ##### EXPECTED RESULTS A user which is allowed to create a credential of type &quot;Hashicorp Vault Secret Lookup&quot; should be allowed to run the test. ##### ACTUAL RESULTS Non-sysadmin users are not allowed to test &quot;HashiCorp Vault Secret Lookup&quot; Credentials.</DESCRIPTION>
  <REPONAME>awx</REPONAME>
  <TIMEDIFFERENCEDAYS>113</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #5921 from beeankha/fix_flake8_errors Fix Misc. flake8 Errors Reviewed-by: https://github.com/apps/softwarefactory-project-zuul</MESSAGE>
    <SHA>1a30a0e397b3161a25608c29d3e6eb9d42e57640</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add test method to Credential Add test method to Credential. The inclusion of this one was discovered when testing the following issue. https://github.com/ansible/awx/issues/5141</MESSAGE>
      <SHA>8add9490ff2828f0c8c62fb73e73edd989dc59bc</SHA>
      <PATCHEDFILES>
        <FILE>awxkit/awxkit/api/pages/credentials.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add test method to Credential Add test method to Credential. The inclusion of this one was discovered when testing the following issue. https://github.com/ansible/awx/issues/5141</MESSAGE>
      <SHA>cabd908ecb8d474da697c4f09fa515ea2cc99dab</SHA>
      <PATCHEDFILES>
        <FILE>awxkit/awxkit/api/pages/credentials.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
