<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1885</ISSUENO>
  <ISSUEURL>https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/1885</ISSUEURL>
  <TITLE>IPA analysis error: AttributeError: 'str' object has no attribute 'get'</TITLE>
  <DESCRIPTION>## ENVIRONMENT ``` OS and Version: Kali GNU / 2021.4 Python Version: Python 3.9.9 MobSF Version: v3.4.6 Beta ``` ## EXPLANATION OF THE ISSUE ``` I upload an IPA to MobSF, expect the report, get an immediate crash due to the following bug: `[INFO] 13/Jan/2022 08:55:41 - MIME Type: application/octet-stream FILE: Helios.i.6.0.0.bat.ipa [INFO] 13/Jan/2022 08:55:41 - Performing Static Analysis of iOS IPA [INFO] 13/Jan/2022 08:55:41 - iOS Static Analysis Started [INFO] 13/Jan/2022 08:55:41 - iOS Binary (IPA) Analysis Started [INFO] 13/Jan/2022 08:55:41 - Generating Hashes [INFO] 13/Jan/2022 08:55:41 - Extracting IPA [INFO] 13/Jan/2022 08:55:41 - Unzipping [INFO] 13/Jan/2022 08:55:42 - Get Files, BIN Plist -&gt; XML, and Normalize [WARNING] 13/Jan/2022 08:55:42 - Failed to convert plist [INFO] 13/Jan/2022 08:55:42 - iOS Info.plist Analysis Started [INFO] 13/Jan/2022 08:55:42 - Finding Info.plist in iOS Binary [INFO] 13/Jan/2022 08:55:42 - Checking Permissions [INFO] 13/Jan/2022 08:55:42 - Checking for Insecure Connections [INFO] 13/Jan/2022 08:55:42 - Fetching Details from App Store: tma.com.dhl.test [WARNING] 13/Jan/2022 08:55:42 - Unable to get app details. [INFO] 13/Jan/2022 08:55:42 - Starting Binary Analysis [INFO] 13/Jan/2022 08:55:42 - Running MachO Analysis on DHL eCommerce [INFO] 13/Jan/2022 08:55:43 - Getting Binary Information [INFO] 13/Jan/2022 08:55:43 - Dumping classes [INFO] 13/Jan/2022 08:55:43 - Running jtool against the binary for dumping classes [INFO] 13/Jan/2022 08:55:43 - Running strings against the Binary [INFO] 13/Jan/2022 08:55:43 - Fetching icon path [INFO] 13/Jan/2022 08:55:43 - Starting IPA URL and Email Extraction [INFO] 13/Jan/2022 08:55:45 - Performing Malware Check on extracted Domains [INFO] 13/Jan/2022 08:55:45 - Maltrail Database is up-to-date [INFO] 13/Jan/2022 08:55:49 - Finished URL and Email Extraction [INFO] 13/Jan/2022 08:55:49 - Detecting Firebase URL(s) [INFO] 13/Jan/2022 08:55:49 - Connecting to DB [INFO] 13/Jan/2022 08:55:49 - Saving to Database [ERROR] 13/Jan/2022 08:55:49 - Error Performing Static Analysis Traceback (most recent call last): File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/mobsf/StaticAnalyzer/views/ios/static_analyzer.py&quot;, line 185, in static_analyzer_ios return render(request, template, context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/shortcuts.py&quot;, line 19, in render content = loader.render_to_string(template_name, context, request, using=using) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/loader.py&quot;, line 62, in render_to_string return template.render(context, request) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/backends/django.py&quot;, line 61, in render return self.template.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 176, in render return self._render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 168, in _render return self.nodelist.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 977, in render return SafeString(''.join([ File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 978, in &lt;listcomp&gt; node.render_annotated(context) for node in self File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 938, in render_annotated return self.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/loader_tags.py&quot;, line 153, in render return compiled_parent._render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 168, in _render return self.nodelist.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 977, in render return SafeString(''.join([ File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 978, in &lt;listcomp&gt; node.render_annotated(context) for node in self File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 938, in render_annotated return self.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/loader_tags.py&quot;, line 65, in render result = block.nodelist.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 977, in render return SafeString(''.join([ File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 978, in &lt;listcomp&gt; node.render_annotated(context) for node in self File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 938, in render_annotated return self.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/defaulttags.py&quot;, line 295, in render return nodelist.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 977, in render return SafeString(''.join([ File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 978, in &lt;listcomp&gt; node.render_annotated(context) for node in self File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 938, in render_annotated return self.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/defaulttags.py&quot;, line 214, in render nodelist.append(node.render_annotated(context)) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 938, in render_annotated return self.render(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 1038, in render output = self.filter_expression.resolve(context) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/venv/lib/python3.9/site-packages/django/template/base.py&quot;, line 728, in resolve new_obj = func(obj, *arg_vals) File &quot;/home/kali/mobsf/Mobile-Security-Framework-MobSF/mobsf/StaticAnalyzer/views/android/static_analyzer.py&quot;, line 79, in key return data.get(key_name) AttributeError: 'str' object has no attribute 'get' [ERROR] 13/Jan/2022 08:55:49 - 'str' object has no attribute 'get' [ERROR] 13/Jan/2022 08:55:49 - Internal Server Error: /static_analyzer_ios/` ``` ## STEPS TO REPRODUCE THE ISSUE ``` 1. Cloned latest Git version. 2. Execute setup 3. Execute run.sh 4. Upload IPA ``` &lt;!-- BEFORE POSTING YOUR ISSUE/BUG - These comments won't show up when you submit the issue. - GitHub issues ARE NOT FOR FEATURE REQUESTS, SUPPORT, DISCUSSIONS AND QUESTIONS! - If you have questions, use our slack channel. Join MobSF Slack channel: http://tiny.cc/mobsf - Reproduce issue in the latest master and try to add as much detail as possible. - Search this repository (top of the page) for the issue and it has not been fixed or reported already. - Once you open a bug, you should also provide additional information if requested. - Failure to do so in 25 days will result in closure of the bug without further communication. --&gt;</DESCRIPTION>
  <REPONAME>Mobile-Security-Framework-MobSF</REPONAME>
  <TIMEDIFFERENCEDAYS>10</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Non blocking uploads</MESSAGE>
    <SHA>2bb5a4a2c9ef48c246668c1a64f91d093611343e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixes #1885</MESSAGE>
      <SHA>698321e945fec14194d6c3f09ab91ad2b11c0092</SHA>
      <PATCHEDFILES>
        <FILE>mobsf/StaticAnalyzer/views/ios/plist_analysis.py</FILE>
        <FILE>mobsf/templates/static_analysis/ios_binary_analysis.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Multiple Features on v3.5.0 (#1881) * MobSF Application Security Score Card * Scorecard API * Improved App Security Scoring Mechanism * Improved PDF Report * Disable CVSSv2 by default. * For application security use case, use severity levels High, Warning, Low and Secure across all components applicable. * Non blocking upload flow. * Fixes #1885</MESSAGE>
      <SHA>8c10db74e10439a71f5edb2deb1bba30136d34dd</SHA>
      <PATCHEDFILES>
        <FILE>README.md</FILE>
        <FILE>mobsf/DynamicAnalyzer/views/android/report.py</FILE>
        <FILE>mobsf/MalwareAnalyzer/views/Trackers.py</FILE>
        <FILE>mobsf/MobSF/init.py</FILE>
        <FILE>mobsf/MobSF/settings.py</FILE>
        <FILE>mobsf/MobSF/urls.py</FILE>
        <FILE>mobsf/MobSF/views/api/api_static_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/models.py</FILE>
        <FILE>mobsf/StaticAnalyzer/tests.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/android_manifest_desc.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/cert_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/code_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/find.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/network_security.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/rules/android_rules.yaml</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/source_tree.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/static_analyzer.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/strings.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/view_source.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/android/xapk.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/__init__.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/appsec.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/pdf.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/common/shared_func.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/app_transport_security.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/code_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/db_interaction.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/file_recon.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/plist_analysis.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/rules/ipa_rules.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/ios/static_analyzer.py</FILE>
        <FILE>mobsf/StaticAnalyzer/views/windows/windows.py</FILE>
        <FILE>mobsf/static/chartjs/Chart.bundle.js</FILE>
        <FILE>mobsf/static/chartjs/chartjs-gauge.js</FILE>
        <FILE>mobsf/static/jqueryknob/jquery.knob.min.js</FILE>
        <FILE>mobsf/static/others/css/pdf_report.css</FILE>
        <FILE>mobsf/static/others/js/notify.min.js</FILE>
        <FILE>mobsf/templates/dynamic_analysis/android/dynamic_report.html</FILE>
        <FILE>mobsf/templates/general/apidocs.html</FILE>
        <FILE>mobsf/templates/general/home.html</FILE>
        <FILE>mobsf/templates/general/recent.html</FILE>
        <FILE>mobsf/templates/pdf/android_report.html</FILE>
        <FILE>mobsf/templates/pdf/ios_report.html</FILE>
        <FILE>mobsf/templates/static_analysis/android_binary_analysis.html</FILE>
        <FILE>mobsf/templates/static_analysis/android_source_analysis.html</FILE>
        <FILE>mobsf/templates/static_analysis/appsec_dashboard.html</FILE>
        <FILE>mobsf/templates/static_analysis/ios_binary_analysis.html</FILE>
        <FILE>mobsf/templates/static_analysis/ios_source_analysis.html</FILE>
        <FILE>requirements.txt</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
