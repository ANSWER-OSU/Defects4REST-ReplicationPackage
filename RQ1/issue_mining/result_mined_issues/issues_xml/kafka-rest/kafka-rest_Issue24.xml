<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>24</ISSUENO>
  <ISSUEURL>https://github.com/confluentinc/kafka-rest/issues/24</ISSUEURL>
  <TITLE>Improve handling of 404s for topics</TITLE>
  <DESCRIPTION>Currently all endpoints that will interact with a topic explicitly check for the topics existence. However, for some endpoints, e.g. producing messages, this doesn't produce the expected behavior with auto.topics.create.enable=true. In some cases it probably makes sense to check directly and avoid creation (e.g. GET /topic/foo) whereas others should handle any errors that are generated dynamically (e.g. POST /topic/foo with auto.topics.create.enable=false).</DESCRIPTION>
  <REPONAME>kafka-rest</REPONAME>
  <TIMEDIFFERENCEDAYS>20</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Add a sample config file.</MESSAGE>
    <SHA>cf284eab92f12785af3642c8e3d00010c2980632</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Improve handling of missing topics and producer exceptions, and return per-message information on produce requests. This makes three major changes: 1. Properly handle producer exceptions, returning per-message error information back to the user in the ProduceResponse. We consider the request successful as long as the only error we hit is returned by the producer future, in which case we include that information in the response. 2. Missing topics are now handled properly for either broker setting of auto.create.topics.enable. When auto creation is disabled, Kafka currently generates a timeout exception, which is now handled properly and passed back to the user with an error code. More generally, all Kafka exceptions are converted into an error code indiating either retriable or non-retriable errors, or triggers a 500 for non-Kafka exceptions. 3. As a side effect of these changes, this fixes the data returned on produce requests. It now includes per-message data. Originally the responses only included aggregate information about the last per-partition offset seen in the published messages. However, properly handling errors requires per-message notifications of success. To handle this, each response includes either partition and offset or error_code and error message. This fixes #24. It also fixes the producer half of #29.</MESSAGE>
      <SHA>371496e6992b4ce18f5618293607514eba5ef53b</SHA>
      <PATCHEDFILES>
        <FILE>docs/api.rst</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/AvroRestProducer.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/BinaryRestProducer.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/Errors.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/KafkaRestApplication.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/ProduceTask.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/ProducerPool.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/RecordMetadataOrException.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/entities/PartitionOffset.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/entities/PartitionProduceResponse.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/entities/ProduceResponse.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/resources/PartitionsResource.java</FILE>
        <FILE>src/main/java/io/confluent/kafkarest/resources/TopicsResource.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/TestUtils.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/integration/AbstractProducerTest.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/integration/AvroProducerTest.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/integration/ClusterTestHarness.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/integration/ConsumerBinaryTest.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/integration/ProducerTest.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/integration/ProducerTopicAutoCreationTest.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/integration/TestKafkaRestApplication.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/unit/ConsumerManagerTest.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/unit/PartitionsResourceAvroProduceTest.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/unit/PartitionsResourceBinaryProduceTest.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/unit/TopicsResourceAvroProduceTest.java</FILE>
        <FILE>src/test/java/io/confluent/kafkarest/unit/TopicsResourceBinaryProduceTest.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
