<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>126882</ISSUENO>
  <ISSUEURL>https://github.com/elastic/elasticsearch/issues/126882</ISSUEURL>
  <TITLE>[CI] AddStringKeyStoreCommandTests testStdinWithMultipleValues failing</TITLE>
  <DESCRIPTION>**Build Scans:** - [elasticsearch-periodic-platform-support #7744 / windows-2022_checkpart1_platform-support-windows](https://gradle-enterprise.elastic.co/s/c7hugy7mp5yb2) - [elasticsearch-periodic-platform-support #7738 / windows-2022_checkpart1_platform-support-windows](https://gradle-enterprise.elastic.co/s/pqviqeglgduzk) - [elasticsearch-periodic-platform-support #7732 / windows-2022_checkpart1_platform-support-windows](https://gradle-enterprise.elastic.co/s/gqgrqej6hg3ne) **Reproduction Line:** ``` gradlew &quot;:distribution:tools:keystore-cli:test&quot; --tests &quot;org.elasticsearch.cli.keystore.AddStringKeyStoreCommandTests.testStdinWithMultipleValues&quot; -Dtests.seed=144BEC9F7A965E66 -Dtests.locale=kn -Dtests.timezone=Etc/GMT0 -Druntime.java=24 ``` **Applicable branches:** 9.0 **Reproduces locally?:** N/A **Failure History:** [See dashboard](https://es-delivery-stats.elastic.dev/app/dashboards#/view/dcec9e60-72ac-11ee-8f39-55975ded9e63?_g=(refreshInterval:(pause:!t,value:60000),time:(from:now-7d%2Fd,to:now))&amp;_a=(controlGroupState:(initialChildControlState:('0c0c9cb8-ccd2-45c6-9b13-96bac4abc542':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:task.keyword,order:0,selectedOptions:!(),title:'GradleTask',type:optionsListControl),'4e6ad9d6-6fdc-4fcc-bf1a-aa6ca79e0850':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:className.keyword,order:1,selectedOptions:!(org.elasticsearch.cli.keystore.AddStringKeyStoreCommandTests),title:'Suite',type:optionsListControl),'144933da-5c1b-4257-a969-7f43455a7901':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:name.keyword,order:2,selectedOptions:!(testStdinWithMultipleValues),title:'Test',type:optionsListControl))))) **Failure Message:** ``` org.junit.ComparisonFailure: expected:&lt;[bar2]&gt; but was:&lt;[]&gt; ``` **Issue Reasons:** - [9.0] 3 consecutive failures in step windows-2022_checkpart1_platform-support-windows - [9.0] 3 failures in test testStdinWithMultipleValues (3.8% fail rate in 80 executions) - [9.0] 3 failures in step windows-2022_checkpart1_platform-support-windows (75.0% fail rate in 4 executions) - [9.0] 3 failures in pipeline elasticsearch-periodic-platform-support (75.0% fail rate in 4 executions) **Note:** This issue was created using new test triage automation. Please report issues or feedback to es-delivery.</DESCRIPTION>
  <REPONAME>elasticsearch</REPONAME>
  <TIMEDIFFERENCEDAYS>2</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Bump versions after 8.18.0 release</MESSAGE>
    <SHA>22adfeb9e132871475b7b1b852e0f924a4258183</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Use Terminal.readSecret in add string keystore command As a followon to #126729, the add string keystore command doesn't need to use a reader at all (and it was incorrect for it to close the reader from the terminal). Instead, the Terminal abstraction already handles how to get at line by line secrets. This commit removes that usage of reader and uses readSecret calls instead. closes #126882</MESSAGE>
      <SHA>d33c3a62ea65e911e7b471412eb7982242c1d3bd</SHA>
      <PATCHEDFILES>
        <FILE>distribution/tools/keystore-cli/src/main/java/org/elasticsearch/cli/keystore/AddStringKeyStoreCommand.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Mute org.elasticsearch.cli.keystore.AddStringKeyStoreCommandTests testStdinWithMultipleValues #126882</MESSAGE>
      <SHA>1c9ff3a7280c53b4766162c150ac1d8d4f40205a</SHA>
      <PATCHEDFILES>
        <FILE>muted-tests.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Use Terminal.readSecret in add string keystore command (#126966) As a followon to #126729, the add string keystore command doesn't need to use a reader at all (and it was incorrect for it to close the reader from the terminal). Instead, the Terminal abstraction already handles how to get at line by line secrets. This commit removes that usage of reader and uses readSecret calls instead. closes #126882</MESSAGE>
      <SHA>584b2379f04664595f2dbf61f26713e2727d208b</SHA>
      <PATCHEDFILES>
        <FILE>distribution/tools/keystore-cli/src/main/java/org/elasticsearch/cli/keystore/AddStringKeyStoreCommand.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Use Terminal.readSecret in add string keystore command (#126966) As a followon to #126729, the add string keystore command doesn't need to use a reader at all (and it was incorrect for it to close the reader from the terminal). Instead, the Terminal abstraction already handles how to get at line by line secrets. This commit removes that usage of reader and uses readSecret calls instead. closes #126882</MESSAGE>
      <SHA>0fd829daaa53666232e04117d7360b1f06624858</SHA>
      <PATCHEDFILES>
        <FILE>distribution/tools/keystore-cli/src/main/java/org/elasticsearch/cli/keystore/AddStringKeyStoreCommand.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Use Terminal.readSecret in add string keystore command (#126966) As a followon to #126729, the add string keystore command doesn't need to use a reader at all (and it was incorrect for it to close the reader from the terminal). Instead, the Terminal abstraction already handles how to get at line by line secrets. This commit removes that usage of reader and uses readSecret calls instead. closes #126882</MESSAGE>
      <SHA>6b014939c1ccbf5abcb6d6ca4f963e6d5a0dfa18</SHA>
      <PATCHEDFILES>
        <FILE>distribution/tools/keystore-cli/src/main/java/org/elasticsearch/cli/keystore/AddStringKeyStoreCommand.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Use Terminal.readSecret in add string keystore command (#126966) As a followon to #126729, the add string keystore command doesn't need to use a reader at all (and it was incorrect for it to close the reader from the terminal). Instead, the Terminal abstraction already handles how to get at line by line secrets. This commit removes that usage of reader and uses readSecret calls instead. closes #126882</MESSAGE>
      <SHA>0762e52b8608577e4542db0f282f14752b948fa5</SHA>
      <PATCHEDFILES>
        <FILE>distribution/tools/keystore-cli/src/main/java/org/elasticsearch/cli/keystore/AddStringKeyStoreCommand.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Use Terminal.readSecret in add string keystore command (#126966) (#127069) As a followon to #126729, the add string keystore command doesn't need to use a reader at all (and it was incorrect for it to close the reader from the terminal). Instead, the Terminal abstraction already handles how to get at line by line secrets. This commit removes that usage of reader and uses readSecret calls instead. closes #126882</MESSAGE>
      <SHA>16cd8a296860ffe5c79fae940a0a9a3d3d1843a6</SHA>
      <PATCHEDFILES>
        <FILE>distribution/tools/keystore-cli/src/main/java/org/elasticsearch/cli/keystore/AddStringKeyStoreCommand.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Use Terminal.readSecret in add string keystore command (#126966) (#127070) As a followon to #126729, the add string keystore command doesn't need to use a reader at all (and it was incorrect for it to close the reader from the terminal). Instead, the Terminal abstraction already handles how to get at line by line secrets. This commit removes that usage of reader and uses readSecret calls instead. closes #126882</MESSAGE>
      <SHA>a809fd7cec723b662e9e0ecd133f6fda1f3593d3</SHA>
      <PATCHEDFILES>
        <FILE>distribution/tools/keystore-cli/src/main/java/org/elasticsearch/cli/keystore/AddStringKeyStoreCommand.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Use Terminal.readSecret in add string keystore command (#126966) (#127068) As a followon to #126729, the add string keystore command doesn't need to use a reader at all (and it was incorrect for it to close the reader from the terminal). Instead, the Terminal abstraction already handles how to get at line by line secrets. This commit removes that usage of reader and uses readSecret calls instead. closes #126882</MESSAGE>
      <SHA>57bb5f32fa4203343b311df7847c9a746183909f</SHA>
      <PATCHEDFILES>
        <FILE>distribution/tools/keystore-cli/src/main/java/org/elasticsearch/cli/keystore/AddStringKeyStoreCommand.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
