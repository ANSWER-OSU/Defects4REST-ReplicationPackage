<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>118394</ISSUENO>
  <ISSUEURL>https://github.com/elastic/elasticsearch/issues/118394</ISSUEURL>
  <TITLE>[CI] DockerYmlTestSuiteIT test {p0=/10_info/Info} failing</TITLE>
  <DESCRIPTION>**Build Scans:** - [elasticsearch-intake #14207 / part1](https://gradle-enterprise.elastic.co/s/xhhryxxur2ybs) - [elasticsearch-pull-request #44760 / part-1](https://gradle-enterprise.elastic.co/s/bn37xu57qpyrs) **Reproduction Line:** ``` ./gradlew &quot;:distribution:docker:yamlRestTest&quot; --tests &quot;org.elasticsearch.docker.test.DockerYmlTestSuiteIT.test {p0=/10_info/Info}&quot; -Dtests.seed=BB757771CC1870F2 -Dtests.locale=ms-ID -Dtests.timezone=America/Metlakatla -Druntime.java=23 ``` **Applicable branches:** main **Reproduces locally?:** N/A **Failure History:** [See dashboard](https://es-delivery-stats.elastic.dev/app/dashboards#/view/dcec9e60-72ac-11ee-8f39-55975ded9e63?_g=(refreshInterval:(pause:!t,value:60000),time:(from:now-7d%2Fd,to:now))&amp;_a=(controlGroupState:(initialChildControlState:('0c0c9cb8-ccd2-45c6-9b13-96bac4abc542':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:task.keyword,order:0,selectedOptions:!(),title:'GradleTask',type:optionsListControl),'4e6ad9d6-6fdc-4fcc-bf1a-aa6ca79e0850':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:className.keyword,order:1,selectedOptions:!(org.elasticsearch.docker.test.DockerYmlTestSuiteIT),title:'Suite',type:optionsListControl),'144933da-5c1b-4257-a969-7f43455a7901':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:name.keyword,order:2,selectedOptions:!(test%20%7Bp0%3D%2F10_info%2FInfo%7D),title:'Test',type:optionsListControl))))) **Failure Message:** ``` java.net.ConnectException: Connection refused ``` **Issue Reasons:** - [main] 2 failures in test test {p0=/10_info/Info} (0.2% fail rate in 920 executions) **Note:** This issue was created using new test triage automation. Please report issues or feedback to es-delivery.</DESCRIPTION>
  <REPONAME>elasticsearch</REPONAME>
  <TIMEDIFFERENCEDAYS>15</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Handle all exceptions in data nodes can match (#117469) During the can match phase, prior to the query phase, we may have exceptions that are returned back to the coordinating node, handled gracefully as if the shard returned canMatch=true. During the query phase, we perform an additional rewrite and can match phase to eventually shortcut the query phase for the shard. That needs to handle exceptions as well. Currently, an exception there causes shard failures, while we should rather go ahead and execute the query on the shard. Instead of adding another try catch on consumers code, this commit adds exception handling to the method itself so that it can no longer throw exceptions and similar mistakes can no longer be made in the future. At the same time, this commit makes the can match method more easily testable without requiring a full-blown SearchService instance. Closes #104994</MESSAGE>
    <SHA>730f42a293ca06560deae2dcfdc2c3943662ce2c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Mute org.elasticsearch.docker.test.DockerYmlTestSuiteIT test {p0=/10_info/Info} #118394</MESSAGE>
      <SHA>cca7bb12501475ce967ba8baa8ca0149083119a2</SHA>
      <PATCHEDFILES>
        <FILE>muted-tests.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
