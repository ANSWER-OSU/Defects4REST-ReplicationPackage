<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1756</ISSUENO>
  <ISSUEURL>https://github.com/nocodb/nocodb/issues/1756</ISSUEURL>
  <TITLE>Filter doesn't return correct results on linked record</TITLE>
  <DESCRIPTION>please provide the following details : NocoDB used as docker : true NocoDB version : 0.90.3 Database used in NC_DB URL : sqlite3 Project was created by clicking : New Project Database on which spreadsheet is created : sqlite3 **Steps To Reproduce** 1. Create two new tables, populate with entries. Case 1: 2. In second table, create a &quot;has many&quot; linked record linked to the first table. 3. Populate the linked record with entries from the first table. 4. Go to the first table, filter by the one-many linked record column. 5. Filter returns every entry if any entry matches the condition, returns no entries if no entry matches the condition (i.e., if the linked records in all of the rows are &quot;A&quot;, &quot;B&quot;, and &quot;C&quot;, filtering for &quot;A&quot; will return all entries, including those linked to &quot;B&quot; and &quot;C&quot;, and filtering for &quot;D&quot; will not return anything) Case 2: 6. Now, create a &quot;has many&quot; linked record in the first table which also links to the first table. Populate this with records. 7. Filter by this column. 8. Filter returns the opposite of what is expected -- ie if you filter for &quot;is like&quot; &quot;A&quot;, it will return everything that is not like &quot;A&quot;, if you filter for &quot;is not like&quot; &quot;A&quot;, it will return everything that is like &quot;A&quot;. **Expected behavior** In Case 1, the filter should return only the matching entries, not every entry. In Case 2, the filter should return the opposite of what it currently returns.</DESCRIPTION>
  <REPONAME>nocodb</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>refactor: use SqlFactory from nocodb-sdk package (#1750) Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt;</MESSAGE>
    <SHA>cea2b4ad73480832cab2a89371d75eda7fb13944</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: refer parent table referenced column in filter query(BT) re #1756 Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt;</MESSAGE>
      <SHA>be0ab2c3d1dff98e4bc18e6fbcafe55c797eaac7</SHA>
      <PATCHEDFILES>
        <FILE>packages/nocodb/src/lib/dataMapper/lib/sql/conditionV2.ts</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>0.90.5 Pre-release (#1774) * chore(deps): bump minimist Bumps [minimist](https://github.com/substack/minimist) from 1.2.5 to 1.2.6. - [Release notes](https://github.com/substack/minimist/releases) - [Commits](https://github.com/substack/minimist/compare/1.2.5...1.2.6) --- updated-dependencies: - dependency-name: minimist dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * chore(deps): bump async from 2.6.3 to 2.6.4 in /packages/noco-docs-prev Bumps [async](https://github.com/caolan/async) from 2.6.3 to 2.6.4. - [Release notes](https://github.com/caolan/async/releases) - [Changelog](https://github.com/caolan/async/blob/v2.6.4/CHANGELOG.md) - [Commits](https://github.com/caolan/async/compare/v2.6.3...v2.6.4) --- updated-dependencies: - dependency-name: async dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * chore(deps): bump async from 2.6.3 to 2.6.4 in /packages/noco-docs Bumps [async](https://github.com/caolan/async) from 2.6.3 to 2.6.4. - [Release notes](https://github.com/caolan/async/releases) - [Changelog](https://github.com/caolan/async/blob/v2.6.4/CHANGELOG.md) - [Commits](https://github.com/caolan/async/compare/v2.6.3...v2.6.4) --- updated-dependencies: - dependency-name: async dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * chore(deps): bump async from 2.6.3 to 2.6.4 in /packages/nc-plugin Bumps [async](https://github.com/caolan/async) from 2.6.3 to 2.6.4. - [Release notes](https://github.com/caolan/async/releases) - [Changelog](https://github.com/caolan/async/blob/v2.6.4/CHANGELOG.md) - [Commits](https://github.com/caolan/async/compare/v2.6.3...v2.6.4) --- updated-dependencies: - dependency-name: async dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * chore(deps): bump async from 2.6.3 to 2.6.4 in /packages/nc-cli Bumps [async](https://github.com/caolan/async) from 2.6.3 to 2.6.4. - [Release notes](https://github.com/caolan/async/releases) - [Changelog](https://github.com/caolan/async/blob/v2.6.4/CHANGELOG.md) - [Commits](https://github.com/caolan/async/compare/v2.6.3...v2.6.4) --- updated-dependencies: - dependency-name: async dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * chore(deps): bump async from 2.6.3 to 2.6.4 in /packages/noco-i18n Bumps [async](https://github.com/caolan/async) from 2.6.3 to 2.6.4. - [Release notes](https://github.com/caolan/async/releases) - [Changelog](https://github.com/caolan/async/blob/v2.6.4/CHANGELOG.md) - [Commits](https://github.com/caolan/async/compare/v2.6.3...v2.6.4) --- updated-dependencies: - dependency-name: async dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * chore(deps): bump async from 2.6.3 to 2.6.4 in /packages/noco-blog Bumps [async](https://github.com/caolan/async) from 2.6.3 to 2.6.4. - [Release notes](https://github.com/caolan/async/releases) - [Changelog](https://github.com/caolan/async/blob/v2.6.4/CHANGELOG.md) - [Commits](https://github.com/caolan/async/compare/v2.6.3...v2.6.4) --- updated-dependencies: - dependency-name: async dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * chore(deps): bump async from 2.6.3 to 2.6.4 in /packages/nocodb-sdk Bumps [async](https://github.com/caolan/async) from 2.6.3 to 2.6.4. - [Release notes](https://github.com/caolan/async/releases) - [Changelog](https://github.com/caolan/async/blob/v2.6.4/CHANGELOG.md) - [Commits](https://github.com/caolan/async/compare/v2.6.3...v2.6.4) --- updated-dependencies: - dependency-name: async dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * chore(deps): bump minimist from 1.2.5 to 1.2.6 in /packages/nocodb Bumps [minimist](https://github.com/substack/minimist) from 1.2.5 to 1.2.6. - [Release notes](https://github.com/substack/minimist/releases) - [Commits](https://github.com/substack/minimist/compare/1.2.5...1.2.6) --- updated-dependencies: - dependency-name: minimist dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * refactor: i18n zh_CN corrections Signed-off-by: Raju Udava &lt;86527202+dstala@users.noreply.github.com&gt; * refactor: use SqlFactory from nocodb-sdk package (#1750) Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt; * fix: refer parent table referenced column in filter query(BT) re #1756 Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt; * fix: wrap nested add update query select part to avoid issue when referencing same table Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt; * chore(deps): bump async in /packages/nc-migrator-archived Bumps [async](https://github.com/caolan/async) from 2.6.2 to 2.6.4. - [Release notes](https://github.com/caolan/async/releases) - [Changelog](https://github.com/caolan/async/blob/v2.6.4/CHANGELOG.md) - [Commits](https://github.com/caolan/async/compare/v2.6.2...v2.6.4) --- updated-dependencies: - dependency-name: async dependency-type: indirect ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; * docs: update README.md [skip ci] * docs: update .all-contributorsrc [skip ci] * docs: add info related to {orgs} and swagger ui Signed-off-by: Wing-Kam Wong &lt;wingkwong.code@gmail.com&gt; * Fix - Migration bugs (#1771) * fix: handle formula parse error in formula migration re #1760 Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt; * fix: avoid project user insertion if corresponding project or user is missing re #1760 Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt; * fix: skip shared views if view_name/model_name is empty or missing re #1760 Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt; * fix: migration down statement correction Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt; * fix(migration): split alter table statement into multiple statements to support MSSQL re #1764 Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt; * refactor: add null check in upgrader Signed-off-by: Pranav C &lt;pranavxc@gmail.com&gt; Co-authored-by: dependabot[bot] &lt;49699333+dependabot[bot]@users.noreply.github.com&gt; Co-authored-by: Raju Udava &lt;86527202+dstala@users.noreply.github.com&gt; Co-authored-by: աɨռɢӄաօռɢ &lt;wingkwong.code@gmail.com&gt; Co-authored-by: navi &lt;oof1lab@gmail.com&gt; Co-authored-by: allcontributors[bot] &lt;46447321+allcontributors[bot]@users.noreply.github.com&gt;</MESSAGE>
      <SHA>412053039e84251293557b1b98036437266e61de</SHA>
      <PATCHEDFILES>
        <FILE>.all-contributorsrc</FILE>
        <FILE>README.md</FILE>
        <FILE>packages/nc-cli/package-lock.json</FILE>
        <FILE>packages/nc-gui/components/project/functionTab/functionQuery.vue</FILE>
        <FILE>packages/nc-gui/components/project/spreadsheet/public/xcForm.vue</FILE>
        <FILE>packages/nc-gui/components/project/spreadsheet/public/xcTable.vue</FILE>
        <FILE>packages/nc-gui/components/project/sqlClient.vue</FILE>
        <FILE>packages/nc-gui/components/project/tableTabs/columns.vue</FILE>
        <FILE>packages/nc-gui/helpers/sqlUi/MssqlUi.js</FILE>
        <FILE>packages/nc-gui/helpers/sqlUi/MysqlUi.js</FILE>
        <FILE>packages/nc-gui/helpers/sqlUi/OracleUi.js</FILE>
        <FILE>packages/nc-gui/helpers/sqlUi/PgUi.js</FILE>
        <FILE>packages/nc-gui/helpers/sqlUi/SqlUiFactory.js</FILE>
        <FILE>packages/nc-gui/helpers/sqlUi/SqliteUi.js</FILE>
        <FILE>packages/nc-gui/helpers/sqlUi/index.js</FILE>
        <FILE>packages/nc-gui/lang/zh_CN.json</FILE>
        <FILE>packages/nc-migrator-archived/package-lock.json</FILE>
        <FILE>packages/nc-plugin/package-lock.json</FILE>
        <FILE>packages/noco-blog/package-lock.json</FILE>
        <FILE>packages/noco-docs-prev/package-lock.json</FILE>
        <FILE>packages/noco-docs/content/en/developer-resources/rest-apis.md</FILE>
        <FILE>packages/noco-docs/package-lock.json</FILE>
        <FILE>packages/noco-i18n/package-lock.json</FILE>
        <FILE>packages/nocodb-sdk/package-lock.json</FILE>
        <FILE>packages/nocodb/package-lock.json</FILE>
        <FILE>packages/nocodb/src/__tests__/restv2.test.ts</FILE>
        <FILE>packages/nocodb/src/lib/dataMapper/lib/sql/BaseModelSqlv2.ts</FILE>
        <FILE>packages/nocodb/src/lib/dataMapper/lib/sql/conditionV2.ts</FILE>
        <FILE>packages/nocodb/src/lib/dataMapper/lib/sql/formulav2/formulaQueryBuilderv2.ts</FILE>
        <FILE>packages/nocodb/src/lib/dataMapper/lib/sql/sortV2.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco-models/Column.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco-models/Filter.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco-models/GalleryView.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco-models/HookFilter.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco-models/Model.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/common/BaseApiBuilder.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/meta/NcMetaMgr.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/meta/api/columnApis.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/meta/api/metaDiffApis.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/meta/api/projectApis.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/meta/api/publicApis/publicMetaApis.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/meta/handlersv2/ncCreateLookup.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/migrationsv2/nc_011.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/migrationsv2/nc_012_alter_column_data_types.ts</FILE>
        <FILE>packages/nocodb/src/lib/noco/upgrader/jobs/ncProjectUpgraderV2_0090000.ts</FILE>
        <FILE>packages/nocodb/src/lib/sqlMgr/code/models/xc/BaseModelXcMeta.ts</FILE>
        <FILE>packages/nocodb/src/lib/sqlUi/MssqlUi.ts</FILE>
        <FILE>packages/nocodb/src/lib/sqlUi/MysqlUi.ts</FILE>
        <FILE>packages/nocodb/src/lib/sqlUi/OracleUi.ts</FILE>
        <FILE>packages/nocodb/src/lib/sqlUi/PgUi.ts</FILE>
        <FILE>packages/nocodb/src/lib/sqlUi/SqlUiFactory.ts</FILE>
        <FILE>packages/nocodb/src/lib/sqlUi/SqliteUi.ts</FILE>
        <FILE>packages/nocodb/src/lib/sqlUi/UITypes.ts</FILE>
        <FILE>packages/nocodb/src/lib/sqlUi/index.ts</FILE>
        <FILE>packages/nocodb/src/lib/templateParser/NcTemplateParser.ts</FILE>
        <FILE>scripts/cypress/fixtures/sqlite-sakila/regenFiles/package-lock.json</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
