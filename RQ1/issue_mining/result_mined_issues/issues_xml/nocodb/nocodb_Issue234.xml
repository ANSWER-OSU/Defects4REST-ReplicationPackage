<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>234</ISSUENO>
  <ISSUEURL>https://github.com/nocodb/nocodb/issues/234</ISSUEURL>
  <TITLE>Bug: Unable to drop column of a composite primary key in Postgres</TITLE>
  <DESCRIPTION>Version: 0.9.24 Environment: Docker (x86) When attempting to drop a column of a composite primary key in Postgres, it appears that it's not properly terminating separate SQL statements. To replicate via the UI: 1. Create an empty table with the default columns 2. Add an additional primary key column (e.g. `iduuid` type `uuid`) 3. Try to delete the original `id` column In this error (below) - you can see that there is no semicolon separating the initial column drop and the second constraint drop. In addition, the constraint should be dropped prior to the column being dropped. The error generated is: ``` ╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗ ║ ║ ║ EXCEPTION OCCURED!! in PGClient @ tableUpdate ║ ║ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ║ ║ MESSAGE: ║ ║ ALTER TABLE &quot;xa3__test&quot; DROP COLUMN &quot;id&quot;alter TABLE &quot;xa3__test&quot; drop constraint xa3__test_pkey;alter TABLE &quot;xa3__test&quot; add constraint xa3__test_pkey PRIMARY KEY(tmpid); - syntax error at or near &quot;alter&quot; ║ ║ ║ ║ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ║ ║ CODE: ║ ║ 42601 ║ ║ ║ ║ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ║ ║ STACK: ║ ║ error: ALTER TABLE &quot;xa3__test&quot; DROP COLUMN &quot;id&quot;alter TABLE &quot;xa3__test&quot; drop constraint xa3__test_pkey;alter TABLE &quot;xa3__test&quot; add constraint xa3__test_pkey PRIMARY KEY(tmpid); - syntax error at or near &quot;alter&quot; ║ ║ at Parser.parseErrorMessage (/usr/src/app/node_modules/pg-protocol/dist/parser.js:287:98) ║ ║ at Parser.handlePacket (/usr/src/app/node_modules/pg-protocol/dist/parser.js:126:29) ║ ║ at Parser.parse (/usr/src/app/node_modules/pg-protocol/dist/parser.js:39:38) ║ ║ at Socket.&lt;anonymous&gt; (/usr/src/app/node_modules/pg-protocol/dist/index.js:11:42) ║ ║ at Socket.emit (events.js:314:20) ║ ║ at Socket.EventEmitter.emit (domain.js:483:12) ║ ║ at addChunk (_stream_readable.js:297:12) ║ ║ at readableAddChunk (_stream_readable.js:272:9) ║ ║ at Socket.Readable.push (_stream_readable.js:213:10) ║ ║ at TCP.onStreamRead (internal/stream_base_commons.js:188:23) ║ ║ ║ ║ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ║ ║ ║ ║ ║ ╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝ ```</DESCRIPTION>
  <REPONAME>nocodb</REPONAME>
  <TIMEDIFFERENCEDAYS>250</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix: after project create navigate to new layout url</MESSAGE>
    <SHA>c9d585f56101e2af4cc040952d96be5be3c42ffe</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #234 from nocodb/develop-sync develop sync</MESSAGE>
      <SHA>b0b3737f186a631094f7c89bf7011603e0dda796</SHA>
      <PATCHEDFILES>
        <FILE>README.md</FILE>
        <FILE>packages/nc-cli/package-lock.json</FILE>
        <FILE>packages/nc-cli/package.json</FILE>
        <FILE>packages/nc-gui/components.d.ts</FILE>
        <FILE>packages/nc-gui/components/account/License.vue</FILE>
        <FILE>packages/nc-gui/components/account/SignupSettings.vue</FILE>
        <FILE>packages/nc-gui/components/account/Token.vue</FILE>
        <FILE>packages/nc-gui/components/account/UserList.vue</FILE>
        <FILE>packages/nc-gui/components/account/UsersModal.vue</FILE>
        <FILE>packages/nc-gui/components/cell/Checkbox.vue</FILE>
        <FILE>packages/nc-gui/components/cell/Currency.vue</FILE>
        <FILE>packages/nc-gui/components/cell/DatePicker.vue</FILE>
        <FILE>packages/nc-gui/components/cell/DateTimePicker.vue</FILE>
        <FILE>packages/nc-gui/components/cell/Decimal.vue</FILE>
        <FILE>packages/nc-gui/components/cell/Duration.vue</FILE>
        <FILE>packages/nc-gui/components/cell/Float.vue</FILE>
        <FILE>packages/nc-gui/components/cell/GeoData.vue</FILE>
        <FILE>packages/nc-gui/components/cell/Integer.vue</FILE>
        <FILE>packages/nc-gui/components/cell/MultiSelect.vue</FILE>
        <FILE>packages/nc-gui/components/cell/Rating.vue</FILE>
        <FILE>packages/nc-gui/components/cell/Url.vue</FILE>
        <FILE>packages/nc-gui/components/cell/attachment/utils.ts</FILE>
        <FILE>packages/nc-gui/components/dashboard/TreeView.vue</FILE>
        <FILE>packages/nc-gui/components/dashboard/settings/AuditTab.vue</FILE>
        <FILE>packages/nc-gui/components/dashboard/settings/app-store/AppInstall.vue</FILE>
        <FILE>packages/nc-gui/components/dlg/TableRename.vue</FILE>
        <FILE>packages/nc-gui/components/dlg/ViewCreate.vue</FILE>
        <FILE>packages/nc-gui/components/erd/View.vue</FILE>
        <FILE>packages/nc-gui/components/general/TableIcon.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/ApiSnippet.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/Cell.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/Grid.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/Map.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/SharedMapMarkerPopup.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/column/EditOrAdd.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/expanded-form/index.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/header/VirtualCellIcon.ts</FILE>
        <FILE>packages/nc-gui/components/smartsheet/sidebar/MenuTop.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/toolbar/ColumnFilter.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/toolbar/FilterInput.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/toolbar/MappedBy.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/toolbar/ShareView.vue</FILE>
        <FILE>packages/nc-gui/components/smartsheet/toolbar/SharedViewList.vue</FILE>
        <FILE>packages/nc-gui/components/tabs/auth/UserManagement.vue</FILE>
        <FILE>packages/nc-gui/components/tabs/auth/user-management/ShareBase.vue</FILE>
        <FILE>packages/nc-gui/components/tabs/auth/user-management/UsersModal.vue</FILE>
        <FILE>packages/nc-gui/components/virtual-cell/barcode/Barcode.vue</FILE>
        <FILE>packages/nc-gui/components/webhook/Editor.vue</FILE>
        <FILE>packages/nc-gui/components/webhook/List.vue</FILE>
        <FILE>packages/nc-gui/components/webhook/Test.vue</FILE>
        <FILE>packages/nc-gui/composables/useAttachment.ts</FILE>
        <FILE>packages/nc-gui/composables/useGlobal/actions.ts</FILE>
        <FILE>packages/nc-gui/composables/useKanbanViewStore.ts</FILE>
        <FILE>packages/nc-gui/composables/useMapViewDataStore.ts</FILE>
        <FILE>packages/nc-gui/composables/useMetas.ts</FILE>
        <FILE>packages/nc-gui/composables/useMultiSelect/convertCellData.ts</FILE>
        <FILE>packages/nc-gui/composables/useSharedView.ts</FILE>
        <FILE>packages/nc-gui/composables/useViewFilters.ts</FILE>
        <FILE>packages/nc-gui/context/index.ts</FILE>
        <FILE>packages/nc-gui/lang/ar.json</FILE>
        <FILE>packages/nc-gui/lang/bn_IN.json</FILE>
        <FILE>packages/nc-gui/lang/cs.json</FILE>
        <FILE>packages/nc-gui/lang/da.json</FILE>
        <FILE>packages/nc-gui/lang/de.json</FILE>
        <FILE>packages/nc-gui/lang/en.json</FILE>
        <FILE>packages/nc-gui/lang/es.json</FILE>
        <FILE>packages/nc-gui/lang/eu.json</FILE>
        <FILE>packages/nc-gui/lang/fa.json</FILE>
        <FILE>packages/nc-gui/lang/fi.json</FILE>
        <FILE>packages/nc-gui/lang/fr.json</FILE>
        <FILE>packages/nc-gui/lang/he.json</FILE>
        <FILE>packages/nc-gui/lang/hi.json</FILE>
        <FILE>packages/nc-gui/lang/hr.json</FILE>
        <FILE>packages/nc-gui/lang/id.json</FILE>
        <FILE>packages/nc-gui/lang/it.json</FILE>
        <FILE>packages/nc-gui/lang/ja.json</FILE>
        <FILE>packages/nc-gui/lang/ko.json</FILE>
        <FILE>packages/nc-gui/lang/lv.json</FILE>
        <FILE>packages/nc-gui/lang/nl.json</FILE>
        <FILE>packages/nc-gui/lang/no.json</FILE>
        <FILE>packages/nc-gui/lang/pl.json</FILE>
        <FILE>packages/nc-gui/lang/pt.json</FILE>
        <FILE>packages/nc-gui/lang/pt_BR.json</FILE>
        <FILE>packages/nc-gui/lang/ru.json</FILE>
        <FILE>packages/nc-gui/lang/sk.json</FILE>
        <FILE>packages/nc-gui/lang/sl.json</FILE>
        <FILE>packages/nc-gui/lang/sv.json</FILE>
        <FILE>packages/nc-gui/lang/th.json</FILE>
        <FILE>packages/nc-gui/lang/tr.json</FILE>
        <FILE>packages/nc-gui/lang/uk.json</FILE>
        <FILE>packages/nc-gui/lang/vi.json</FILE>
        <FILE>packages/nc-gui/lang/zh-Hans.json</FILE>
        <FILE>packages/nc-gui/lang/zh-Hant.json</FILE>
        <FILE>packages/nc-gui/lib/types.ts</FILE>
        <FILE>packages/nc-gui/middleware/auth.global.ts</FILE>
        <FILE>packages/nc-gui/package-lock.json</FILE>
        <FILE>packages/nc-gui/package.json</FILE>
        <FILE>packages/nc-gui/pages/[projectType]/[projectId]/index.vue</FILE>
        <FILE>packages/nc-gui/pages/index/index/create-external.vue</FILE>
        <FILE>packages/nc-gui/pages/index/index/create.vue</FILE>
        <FILE>packages/nc-gui/pages/index/index/index.vue</FILE>
        <FILE>packages/nc-gui/store/project.ts</FILE>
        <FILE>packages/nc-gui/store/tab.ts</FILE>
        <FILE>packages/nc-gui/utils/dataUtils.ts</FILE>
        <FILE>packages/nc-gui/utils/filterUtils.ts</FILE>
        <FILE>packages/nc-gui/utils/index.ts</FILE>
        <FILE>packages/nc-gui/utils/parseUtils.ts</FILE>
        <FILE>packages/nc-gui/utils/virtualCell.ts</FILE>
        <FILE>packages/noco-docs/content/en/getting-started/environment-variables.md</FILE>
        <FILE>packages/noco-docs/content/en/setup-and-usages/column-types.md</FILE>
        <FILE>packages/nocodb-sdk/src/lib/Api.ts</FILE>
        <FILE>packages/nocodb-sdk/src/lib/UITypes.ts</FILE>
        <FILE>packages/nocodb-sdk/src/lib/formulaHelpers.ts</FILE>
        <FILE>packages/nocodb-sdk/src/lib/sqlUi/MssqlUi.ts</FILE>
        <FILE>packages/nocodb-sdk/src/lib/sqlUi/MysqlUi.ts</FILE>
        <FILE>packages/nocodb-sdk/src/lib/sqlUi/OracleUi.ts</FILE>
        <FILE>packages/nocodb-sdk/src/lib/sqlUi/PgUi.ts</FILE>
        <FILE>packages/nocodb-sdk/src/lib/sqlUi/SnowflakeUi.ts</FILE>
        <FILE>packages/nocodb-sdk/src/lib/sqlUi/SqliteUi.ts</FILE>
        <FILE>packages/nocodb/src/lib/controllers/project.ctl.ts</FILE>
        <FILE>packages/nocodb/src/lib/controllers/sync/import.ctl.ts</FILE>
        <FILE>packages/nocodb/src/lib/db/sql-data-mapper/lib/sql/conditionV2.ts</FILE>
        <FILE>packages/nocodb/src/lib/services/column.svc.ts</FILE>
        <FILE>packages/nocodb/src/lib/services/project.svc.ts</FILE>
        <FILE>packages/nocodb/src/lib/services/sync/helpers/job.ts</FILE>
        <FILE>packages/nocodb/src/lib/services/sync/helpers/readAndProcessData.ts</FILE>
        <FILE>packages/nocodb/src/lib/version-upgrader/ncFilterUpgrader_0105003.ts</FILE>
        <FILE>packages/nocodb/src/schema/swagger.json</FILE>
        <FILE>tests/playwright/pages/Dashboard/common/Toolbar/Filter.ts</FILE>
        <FILE>tests/playwright/setup/xcdb-records.ts</FILE>
        <FILE>tests/playwright/tests/filters.spec.ts</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
