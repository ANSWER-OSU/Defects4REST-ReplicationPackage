<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4176</ISSUENO>
  <ISSUEURL>https://github.com/nocodb/nocodb/issues/4176</ISSUEURL>
  <TITLE>Bug: error during airtable import (feat/at-import-memory)</TITLE>
  <DESCRIPTION>### Please confirm if bug report does NOT exists already ? - [X] I confirm there is no existing issue for this ### Steps to reproduce ? Xcdb import though got completed - noticed the following error. Do check if its relevant to the change ``` uploadViaURL :: TypeError: undefined is not iterable (cannot read property Symbol(Symbol.iterator)) at Function.all (&lt;anonymous&gt;) at uploadViaURL (/Users/rajuudava/NocoDB/nocodb/packages/nocodb/src/lib/meta/api/attachmentApis.ts:58:37) at /Users/rajuudava/NocoDB/nocodb/packages/nocodb/src/lib/meta/helpers/catchError.ts:6:14 POST /api/v1/db/storage/upload-by-url?path=noco%2Fx%2FShots%2FImage 400 82 - 10.179 ms Error: Request failed with status code 400 at createError (/Users/rajuudava/NocoDB/nocodb/packages/nocodb-sdk/node_modules/axios/lib/core/createError.js:16:15) at settle (/Users/rajuudava/NocoDB/nocodb/packages/nocodb-sdk/node_modules/axios/lib/core/settle.js:17:12) at IncomingMessage.handleStreamEnd (/Users/rajuudava/NocoDB/nocodb/packages/nocodb-sdk/node_modules/axios/lib/adapters/http.js:269:11) at IncomingMessage.emit (node:events:532:35) at IncomingMessage.emit (node:domain:475:12) at endReadableNT (node:internal/streams/readable:1346:12) at processTicksAndRejections (node:internal/process/task_queues:83:21) { config: { url: '/api/v1/db/storage/upload-by-url', method: 'post', headers: { Accept: 'application/json, text/plain, */*', 'Content-Type': 'application/json', 'xc-auth': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAbm9jb2RiLmNvbSIsImZpcnN0bmFtZSI6bnVsbCwibGFzdG5hbWUiOm51bGwsImlkIjoidXNfcnl3Y3FwZmNtbTY4ZnUiLCJyb2xlcyI6InVzZXIsc3VwZXIiLCJ0b2tlbl92ZXJzaW9uIjoiZjA4MTMwOTMzNjUwNDhjYjRmMjdlMGI5Y2E2ZjY5ZjMwY2RjNDU0NWEyZjIyMmI2ZDdkMDY1ZjgwYTAzYTNjOGIxNDZlYTk3NjNhYzA4MWYiLCJpYXQiOjE2NjY3MDI2NTYsImV4cCI6MTY2NjczODY1Nn0.ymEEHLj526QrJgcfNJzJY9fCTBHXlX3GuHeG6U21Vfg', 'User-Agent': 'axios/0.21.4' }, params: { path: 'noco/x/Shots/Image' }, baseURL: 'http://localhost:8080', transformRequest: [ [Function: transformRequest] ], transformResponse: [ [Function: transformResponse] ], timeout: 0, adapter: [Function: httpAdapter], xsrfCookieName: 'XSRF-TOKEN', xsrfHeaderName: 'X-XSRF-TOKEN', maxContentLength: -1, maxBodyLength: -1, validateStatus: [Function: validateStatus], transitional: { silentJSONParsing: true, forcedJSONParsing: true, clarifyTimeoutError: false }, data: undefined }, request: &lt;ref *1&gt; ClientRequest { _events: [Object: null prototype] { abort: [Function (anonymous)], aborted: [Function (anonymous)], connect: [Function (anonymous)], error: [Function (anonymous)], socket: [Function (anonymous)], timeout: [Function (anonymous)], prefinish: [Function: requestOnPrefinish] }, _eventsCount: 7, _maxListeners: undefined, outputData: [], outputSize: 0, writable: true, destroyed: false, _last: true, chunkedEncoding: false, shouldKeepAlive: false, maxRequestsOnConnectionReached: false, _defaultKeepAlive: true, useChunkedEncodingByDefault: true, sendDate: false, _removedConnection: false, _removedContLen: false, _removedTE: false, _contentLength: 0, _hasBody: true, _trailer: '', finished: true, _headerSent: true, _closed: false, socket: Socket { connecting: false, _hadError: false, _parent: null, _host: 'localhost', _readableState: [ReadableState], _events: [Object: null prototype], _eventsCount: 7, _maxListeners: undefined, _writableState: [WritableState], allowHalfOpen: false, _sockname: null, _pendingData: null, _pendingEncoding: '', server: null, _server: null, parser: null, _httpMessage: [Circular *1], [Symbol(async_id_symbol)]: 58920, [Symbol(kHandle)]: [TCP], [Symbol(kSetNoDelay)]: false, [Symbol(lastWriteQueueSize)]: 0, [Symbol(timeout)]: null, [Symbol(kBuffer)]: null, [Symbol(kBufferCb)]: null, [Symbol(kBufferGen)]: null, [Symbol(kCapture)]: false, [Symbol(kBytesRead)]: 0, [Symbol(kBytesWritten)]: 0, [Symbol(RequestTimeout)]: undefined }, _header: 'POST /api/v1/db/storage/upload-by-url?path=noco%2Fx%2FShots%2FImage HTTP/1.1\r\n' + 'Accept: application/json, text/plain, */*\r\n' + 'Content-Type: application/json\r\n' + 'xc-auth: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAbm9jb2RiLmNvbSIsImZpcnN0bmFtZSI6bnVsbCwibGFzdG5hbWUiOm51bGwsImlkIjoidXNfcnl3Y3FwZmNtbTY4ZnUiLCJyb2xlcyI6InVzZXIsc3VwZXIiLCJ0b2tlbl92ZXJzaW9uIjoiZjA4MTMwOTMzNjUwNDhjYjRmMjdlMGI5Y2E2ZjY5ZjMwY2RjNDU0NWEyZjIyMmI2ZDdkMDY1ZjgwYTAzYTNjOGIxNDZlYTk3NjNhYzA4MWYiLCJpYXQiOjE2NjY3MDI2NTYsImV4cCI6MTY2NjczODY1Nn0.ymEEHLj526QrJgcfNJzJY9fCTBHXlX3GuHeG6U21Vfg\r\n' + 'User-Agent: axios/0.21.4\r\n' + 'Host: localhost:8080\r\n' + 'Connection: close\r\n' + 'Content-Length: 0\r\n' + '\r\n', _keepAliveTimeout: 0, _onPendingData: [Function: nop], agent: Agent { _events: [Object: null prototype], _eventsCount: 2, _maxListeners: undefined, defaultPort: 80, protocol: 'http:', options: [Object: null prototype], requests: [Object: null prototype] {}, sockets: [Object: null prototype], freeSockets: [Object: null prototype] {}, keepAliveMsecs: 1000, keepAlive: false, maxSockets: Infinity, maxFreeSockets: 256, scheduling: 'lifo', maxTotalSockets: Infinity, totalSocketCount: 7, [Symbol(kCapture)]: false }, socketPath: undefined, method: 'POST', maxHeaderSize: undefined, insecureHTTPParser: undefined, path: '/api/v1/db/storage/upload-by-url?path=noco%2Fx%2FShots%2FImage', _ended: true, res: IncomingMessage { _readableState: [ReadableState], _events: [Object: null prototype], _eventsCount: 3, _maxListeners: undefined, socket: [Socket], httpVersionMajor: 1, httpVersionMinor: 1, httpVersion: '1.1', complete: true, rawHeaders: [Array], rawTrailers: [], aborted: false, upgrade: false, url: '', method: null, statusCode: 400, statusMessage: 'Bad Request', client: [Socket], _consuming: false, _dumped: false, req: [Circular *1], responseUrl: 'http://localhost:8080/api/v1/db/storage/upload-by-url?path=noco%2Fx%2FShots%2FImage', redirects: [], [Symbol(kCapture)]: false, [Symbol(kHeaders)]: [Object], [Symbol(kHeadersCount)]: 12, [Symbol(kTrailers)]: null, [Symbol(kTrailersCount)]: 0, [Symbol(RequestTimeout)]: undefined }, aborted: false, timeoutCb: null, upgradeOrConnect: false, parser: null, maxHeadersCount: null, reusedSocket: false, host: 'localhost', protocol: 'http:', _redirectable: Writable { _writableState: [WritableState], _events: [Object: null prototype], _eventsCount: 2, _maxListeners: undefined, _options: [Object], _ended: true, _ending: true, _redirectCount: 0, _redirects: [], _requestBodyLength: 0, _requestBodyBuffers: [], _onNativeResponse: [Function (anonymous)], _currentRequest: [Circular *1], _currentUrl: 'http://localhost:8080/api/v1/db/storage/upload-by-url?path=noco%2Fx%2FShots%2FImage', [Symbol(kCapture)]: false }, [Symbol(kCapture)]: false, [Symbol(kNeedDrain)]: false, [Symbol(corked)]: 0, [Symbol(kOutHeaders)]: [Object: null prototype] { accept: [Array], 'content-type': [Array], 'xc-auth': [Array], 'user-agent': [Array], host: [Array] } }, response: { status: 400, statusText: 'Bad Request', headers: { 'access-control-allow-origin': '*', 'access-control-expose-headers': 'xc-db-response', 'content-type': 'application/json; charset=utf-8', 'content-length': '82', date: 'Tue, 25 Oct 2022 12:58:21 GMT', connection: 'close' }, config: { url: '/api/v1/db/storage/upload-by-url', method: 'post', headers: [Object], params: [Object], baseURL: 'http://localhost:8080', transformRequest: [Array], transformResponse: [Array], timeout: 0, adapter: [Function: httpAdapter], xsrfCookieName: 'XSRF-TOKEN', xsrfHeaderName: 'X-XSRF-TOKEN', maxContentLength: -1, maxBodyLength: -1, validateStatus: [Function: validateStatus], transitional: [Object], data: undefined }, request: &lt;ref *1&gt; ClientRequest { _events: [Object: null prototype], _eventsCount: 7, _maxListeners: undefined, outputData: [], outputSize: 0, writable: true, destroyed: false, _last: true, chunkedEncoding: false, shouldKeepAlive: false, maxRequestsOnConnectionReached: false, _defaultKeepAlive: true, useChunkedEncodingByDefault: true, sendDate: false, _removedConnection: false, _removedContLen: false, _removedTE: false, _contentLength: 0, _hasBody: true, _trailer: '', finished: true, _headerSent: true, _closed: false, socket: [Socket], _header: 'POST /api/v1/db/storage/upload-by-url?path=noco%2Fx%2FShots%2FImage HTTP/1.1\r\n' + 'Accept: application/json, text/plain, */*\r\n' + 'Content-Type: application/json\r\n' + 'xc-auth: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAbm9jb2RiLmNvbSIsImZpcnN0bmFtZSI6bnVsbCwibGFzdG5hbWUiOm51bGwsImlkIjoidXNfcnl3Y3FwZmNtbTY4ZnUiLCJyb2xlcyI6InVzZXIsc3VwZXIiLCJ0b2tlbl92ZXJzaW9uIjoiZjA4MTMwOTMzNjUwNDhjYjRmMjdlMGI5Y2E2ZjY5ZjMwY2RjNDU0NWEyZjIyMmI2ZDdkMDY1ZjgwYTAzYTNjOGIxNDZlYTk3NjNhYzA4MWYiLCJpYXQiOjE2NjY3MDI2NTYsImV4cCI6MTY2NjczODY1Nn0.ymEEHLj526QrJgcfNJzJY9fCTBHXlX3GuHeG6U21Vfg\r\n' + 'User-Agent: axios/0.21.4\r\n' + 'Host: localhost:8080\r\n' + 'Connection: close\r\n' + 'Content-Length: 0\r\n' + '\r\n', _keepAliveTimeout: 0, _onPendingData: [Function: nop], agent: [Agent], socketPath: undefined, method: 'POST', maxHeaderSize: undefined, insecureHTTPParser: undefined, path: '/api/v1/db/storage/upload-by-url?path=noco%2Fx%2FShots%2FImage', _ended: true, res: [IncomingMessage], aborted: false, timeoutCb: null, upgradeOrConnect: false, parser: null, maxHeadersCount: null, reusedSocket: false, host: 'localhost', protocol: 'http:', _redirectable: [Writable], [Symbol(kCapture)]: false, [Symbol(kNeedDrain)]: false, [Symbol(corked)]: 0, [Symbol(kOutHeaders)]: [Object: null prototype] }, data: { msg: 'undefined is not iterable (cannot read property Symbol(Symbol.iterator))' } }, isAxiosError: true, toJSON: [Function: toJSON] } ``` ### Desired Behavior Import without error ### Project Details Node: **v16.14.0** Arch: **arm64** Platform: **darwin** Docker: **false** Database: **sqlite3** ProjectOnRootDB: **true** RootDB: **sqlite3** PackageVersion: **0.98.1** ### Attachements _No response_</DESCRIPTION>
  <REPONAME>nocodb</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>feat: EntityMap handle case-sensitive duplicate column names Signed-off-by: mertmit &lt;mertmit99@gmail.com&gt;</MESSAGE>
    <SHA>6e9ea09a6bcad7318e86aaa398e7f0426a48a551</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix(at-import): skip processing empty attachment rows Re #4176 Signed-off-by: mertmit &lt;mertmit99@gmail.com&gt;</MESSAGE>
      <SHA>bc2a937be14e604add344bc8a02875c859e04271</SHA>
      <PATCHEDFILES>
        <FILE>packages/nocodb/src/lib/meta/api/sync/helpers/job.ts</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix(at-import): skip processing empty rows Re #4176 Signed-off-by: mertmit &lt;mertmit99@gmail.com&gt;</MESSAGE>
      <SHA>255d690509968b18192ce30c7602240a852fc8f4</SHA>
      <PATCHEDFILES>
        <FILE>packages/nocodb/src/lib/meta/api/sync/helpers/job.ts</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
