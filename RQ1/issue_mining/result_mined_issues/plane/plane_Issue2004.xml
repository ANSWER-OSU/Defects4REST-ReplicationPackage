<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2004</ISSUENO>
  <ISSUEURL>https://github.com/makeplane/plane/issues/2004</ISSUEURL>
  <TITLE>[bug]: Insecure File Upload leads to XSS</TITLE>
  <DESCRIPTION>### Is there an existing issue for this? - [X] I have searched the existing issues ### Current behavior When I upload an SVG image file into a plane issue, I would assume that it is either blocked or the SVG content is sanitized before being uploaded and available to others. However, uploading an SVG image file with XSS payload is allowed and not sanitized. Therefore, introducing a potential Stored Cross-Site Scripting (XSS) vulnerability. This issue may be linked to https://github.com/makeplane/plane/issues/1988 ### Steps to reproduce 1. Log into plane 2. Create an issue or select a pre-existing one 3. Upload an SVG image file with an XSS payload 4. Open the uploaded SVG image and observe XSS popup An example SVG `svg-xss-xml.svg` file would be: ```` &lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt; &lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt; &lt;script type=&quot;text/javascript&quot;&gt; alert('XSS-Vulnerability-SVG'); &lt;/script&gt; &lt;/svg&gt; ```` After uploading and browsing the file, the XSS payload will popup, yielding the string &quot;XSS-Vulnerability-SVG&quot;. ![image](https://github.com/makeplane/plane/assets/21357789/6d50c239-aeb9-4116-bddf-d758985ba5e9) ![image](https://github.com/makeplane/plane/assets/21357789/203034b9-d30f-43dd-86ae-0140ab2affb8) Either properly sanitize and restrict file uploads or allow attachment downloads only (no rendering in browsers itself). ### Browser Mozilla Firefox ### Version Self-hosted</DESCRIPTION>
  <REPONAME>plane</REPONAME>
  <TIMEDIFFERENCEDAYS>412</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix: build errors after ce sync</MESSAGE>
    <SHA>f17d1deae4f23e3cf485922e5a8df8d161668e35</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #2004 from makeplane/sync/ce-ee Sync: Community Changes</MESSAGE>
      <SHA>56aaa6823e20833401d8932a81fd6a2739aadf1b</SHA>
      <PATCHEDFILES>
        <FILE>live/package.json</FILE>
        <FILE>packages/utils/package.json</FILE>
        <FILE>yarn.lock</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
