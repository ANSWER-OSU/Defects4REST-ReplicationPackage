<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1996</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/1996</ISSUEURL>
  <TITLE>feat: new load balancing algorithm `ewma` for upstream node</TITLE>
  <DESCRIPTION>use the Peak EWMA method for routing. we can take a look at this source file: https://github.com/twitter/finagle/blob/34167989a6dc964e24e20212516fba89fa58bb23/finagle-core/src/main/scala/com/twitter/finagle/loadbalancer/PeakEwma.scala</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>24</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix: wait time is too short it will easy fail in some bad hardware environment (#2127)</MESSAGE>
    <SHA>a3f865aa4bb9aa8324ad5025c46360977aed8bec</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>feature: implement `ewma` balancer for upstream node (#2001) ewma is a different balancing implementation that will generate a weight for every backend IP based on the last server response time, basically it tries to dispatch more requests to the backends that reply faster, supposing that they are less loaded. fix #1996</MESSAGE>
      <SHA>98bb5933d64229ddf8e3dd0fdf1c31f90072c2cb</SHA>
      <PATCHEDFILES>
        <FILE>LICENSE</FILE>
        <FILE>apisix/balancer.lua</FILE>
        <FILE>apisix/balancer/ewma.lua</FILE>
        <FILE>apisix/init.lua</FILE>
        <FILE>apisix/schema_def.lua</FILE>
        <FILE>bin/apisix</FILE>
        <FILE>doc/admin-api.md</FILE>
        <FILE>t/APISIX.pm</FILE>
        <FILE>t/lib/server.lua</FILE>
        <FILE>t/node/ewma.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
