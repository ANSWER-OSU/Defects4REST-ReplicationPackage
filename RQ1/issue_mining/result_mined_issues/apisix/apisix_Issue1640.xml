<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1640</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/1640</ISSUEURL>
  <TITLE>question: passive health check seems never provide a healthy report</TITLE>
  <DESCRIPTION>https://github.com/apache/incubator-apisix/blob/82f85e59465c80e27879d9985461d60fe4f77721/apisix/balancer.lua#L254-L269 Currently we only report the HTTP status in the `test next` stage. However, only unhealthy upstream will trigger a `test next` try. Does the passive health check make any report when an unhealthy upstream goes healthy? Does the `healthy` part of the `passive` health configuration work as expected? https://github.com/apache/incubator-apisix/blob/82f85e59465c80e27879d9985461d60fe4f77721/apisix/schema_def.lua#L159</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>59</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>doc(k8s): removed unnecessary configurations. (#1891)</MESSAGE>
    <SHA>f37a1ddc0097c88ab396586c40c07efe1ac38b2a</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>bugfix: passive health check seems never provide a healthy report (#1918) Fix #1640</MESSAGE>
      <SHA>2ba023114085f85c1ada0a8c54279fad4514fda2</SHA>
      <PATCHEDFILES>
        <FILE>apisix/balancer.lua</FILE>
        <FILE>apisix/init.lua</FILE>
        <FILE>t/node/healthcheck-passive.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
