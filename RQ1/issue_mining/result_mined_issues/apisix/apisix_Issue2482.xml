<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2482</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/2482</ISSUEURL>
  <TITLE>bug: Error putting metadata for plug-in</TITLE>
  <DESCRIPTION>### Issue description ### Environment * apisix version (cmd: `apisix version`): master * OS: centos 7 ### Minimal test code / Steps to reproduce the issue 1. use the latest version from master 2. put metadata for plugin `http-logger` ```shell curl http://127.0.0.1:8080/apisix/admin/plugin_metadata/http-logger -H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -X PUT -d ' { &quot;log_format&quot;: { &quot;host&quot;: &quot;$host&quot;, &quot;@timestamp&quot;: &quot;$time_iso8601&quot;, &quot;server_name&quot;: &quot;$server_name&quot;, &quot;client_ip&quot;: &quot;$remote_addr&quot;, &quot;x_real_ip&quot;: &quot;$http_x_real_ip&quot;, &quot;x_forwarded_for&quot;: &quot;$http_x_forwarded_for&quot;, &quot;x_forwarded_proto&quot;: &quot;$http_x_forwarded_proto&quot;, &quot;resp_len&quot;: &quot;$body_bytes_sent&quot;, &quot;waster_time&quot;: &quot;$request_time&quot;, &quot;status&quot;: &quot;$status&quot;, &quot;domain_name&quot;: &quot;$http_host&quot;, &quot;request_uri&quot;: &quot;$request_uri&quot;, &quot;uri&quot;: &quot;$uri&quot;, &quot;http_user_agent&quot;: &quot;$http_user_agent&quot;, &quot;request_method&quot;: &quot;$request_method&quot;, &quot;upstream&quot;: &quot;$upstream_addr&quot;, &quot;upstream_status&quot;: &quot;$upstream_status&quot;, &quot;ups_resp_time&quot;: &quot;$upstream_response_time&quot;, &quot;localip&quot;: &quot;$server_addr&quot; } }' ``` 3. It is success at first time, and then an error is reported ![image](https://user-images.githubusercontent.com/4413028/96680201-a8f49700-13a7-11eb-9ed8-0e84dd695325.png)</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>doc: we can also use reload after configuration changed (#2460)</MESSAGE>
    <SHA>26e55a3e9c3cf95f11b6bb6584ddf5f17af48464</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: compare if the interceptors are injected by ourselves fix #2482.</MESSAGE>
      <SHA>2cc9dbcf6ce8615e2131baba14f6d81c8b65fdd4</SHA>
      <PATCHEDFILES>
        <FILE>apisix/admin/plugin_metadata.lua</FILE>
        <FILE>apisix/api_router.lua</FILE>
        <FILE>t/admin/plugin-metadata.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix: compare if the interceptors are injected by ourselves (#2484) fix #2482.</MESSAGE>
      <SHA>0f15939a9cc5906cffc58e9963d6e703a576e3d4</SHA>
      <PATCHEDFILES>
        <FILE>apisix/admin/plugin_metadata.lua</FILE>
        <FILE>apisix/api_router.lua</FILE>
        <FILE>t/admin/plugin-metadata.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
