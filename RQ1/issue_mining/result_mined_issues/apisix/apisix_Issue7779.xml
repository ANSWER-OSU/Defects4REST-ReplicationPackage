<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>7779</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/7779</ISSUEURL>
  <TITLE>feat: As a user, I want to support service discovery in the stream subsystem</TITLE>
  <DESCRIPTION>### Description As a user, I want to support service discovery in the stream subsystem, so that we can use it to get L4 upstream dynamically. There is already an unfinished closed PR to add this feature: https://github.com/apache/apisix/pull/4488. However, this PR is closed last year and the code has been changed a lot since that. So we can borrow some code from that PR but can't continue based on it.</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>156</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>feat: support export consumer group schema (#8600)</MESSAGE>
    <SHA>dc6d987d1827be4cd65fdc4cd29feea763897c4d</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>feat: stream subsystem support eureka service discovery (#8583) Fixes https://github.com/apache/apisix/issues/7779</MESSAGE>
      <SHA>93454252a51c7e14c140999532edf6ddd8ce5667</SHA>
      <PATCHEDFILES>
        <FILE>apisix/init.lua</FILE>
        <FILE>docs/en/latest/discovery.md</FILE>
        <FILE>docs/zh/latest/discovery.md</FILE>
        <FILE>t/discovery/stream/eureka.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: stream subsystem support dns service discovery (#8593) Fixes https://github.com/apache/apisix/issues/7779</MESSAGE>
      <SHA>c9ed5d7feb08ffa78212579c779119111b5c38fe</SHA>
      <PATCHEDFILES>
        <FILE>apisix/discovery/dns/init.lua</FILE>
        <FILE>docs/en/latest/discovery/dns.md</FILE>
        <FILE>docs/zh/latest/discovery/dns.md</FILE>
        <FILE>t/discovery/stream/dns.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: stream subsystem support nacos service discovery (#8584) Fixes https://github.com/apache/apisix/issues/7779</MESSAGE>
      <SHA>9e3fd00021c26be38b9d83aee76fa5bc7b6d4501</SHA>
      <PATCHEDFILES>
        <FILE>apisix/cli/ngx_tpl.lua</FILE>
        <FILE>apisix/discovery/nacos/init.lua</FILE>
        <FILE>apisix/init.lua</FILE>
        <FILE>apisix/router.lua</FILE>
        <FILE>conf/config-default.yaml</FILE>
        <FILE>docs/en/latest/discovery/nacos.md</FILE>
        <FILE>docs/zh/latest/discovery/nacos.md</FILE>
        <FILE>t/APISIX.pm</FILE>
        <FILE>t/discovery/stream/nacos.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: stream subsystem support kubernetes service discovery (#8640) Fixes https://github.com/apache/apisix/issues/7779</MESSAGE>
      <SHA>9c899b87648039e2c6c73b087d627aea2df90f55</SHA>
      <PATCHEDFILES>
        <FILE>apisix/cli/ngx_tpl.lua</FILE>
        <FILE>apisix/discovery/kubernetes/init.lua</FILE>
        <FILE>docs/en/latest/discovery/kubernetes.md</FILE>
        <FILE>docs/zh/latest/discovery/kubernetes.md</FILE>
        <FILE>t/APISIX.pm</FILE>
        <FILE>t/kubernetes/discovery/stream/kubernetes.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: stream subsystem support consul_kv service discovery (#8633) Fixes https://github.com/apache/apisix/issues/7779</MESSAGE>
      <SHA>fab68d7c23a7ce11260dac5018a54ae185a633c8</SHA>
      <PATCHEDFILES>
        <FILE>docs/en/latest/discovery/consul_kv.md</FILE>
        <FILE>t/discovery/stream/consul_kv.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>feat: stream subsystem support consul service discovery (#8696) Fixes https://github.com/apache/apisix/issues/7779</MESSAGE>
      <SHA>d019da018ca8c06bf80e363a0512a30808da1b8e</SHA>
      <PATCHEDFILES>
        <FILE>docs/en/latest/discovery/consul.md</FILE>
        <FILE>t/discovery/stream/consul.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
