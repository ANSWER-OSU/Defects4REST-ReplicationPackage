<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2636</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/2636</ISSUEURL>
  <TITLE>chore: sort the request headers output by the _M.uri and _M.old_uri function in 't/lib/server.lua'</TITLE>
  <DESCRIPTION>### Issue description In writing test cases, when the `_M.uri()` method in `t/lib/server.lua` is used, the order of output request headers is unstable, resulting in test cases sometimes failing. We need to sort the headers obtained by `local headers = ngx.req.get_headers()` to make it stable. Need to modify the code: https://github.com/apache/apisix/blob/master/t/lib/server.lua#L103-L106 Modification method reference:: https://github.com/apache/apisix/blob/master/t/plugin/proxy-mirror.t#L40-L49</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>6</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix: upgrade lua-resty-etcd to 1.4.2 (#2701)</MESSAGE>
    <SHA>8c9a0c39a3325cf73ef1ef6d27eb2718fee0773e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>chore: sort the request headers output by the _M.uri and _M.old_uri function in t/lib/server.lua (#2696) fix #2636</MESSAGE>
      <SHA>2ba28ff6a7a1823c3ea37e2cdcd7427d4244f3d9</SHA>
      <PATCHEDFILES>
        <FILE>t/lib/server.lua</FILE>
        <FILE>t/node/merge-route.t</FILE>
        <FILE>t/plugin/hmac-auth.t</FILE>
        <FILE>t/plugin/proxy-mirror.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
