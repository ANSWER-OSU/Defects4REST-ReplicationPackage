<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5233</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/5233</ISSUEURL>
  <TITLE>request help: no host allowed while connecting to upstream</TITLE>
  <DESCRIPTION>### Issue description 从nacos上发现服务. - nacos上的服务ip为主机名`uaa-service`, 一个为ip - 当负载均衡运行时报 `failed to set server peer [uaa-service:20101] err: no host allowed while connecting to upstream` - 造成当负载到为主机名的时候返回网关错误. 负载到ip的时候则正常. ### Environment - apisix version (cmd: `apisix version`): - OS (cmd: `uname -a`): - OpenResty / Nginx version (cmd: `nginx -V` or `openresty -V`): - etcd version, if have (cmd: run `curl http://127.0.0.1:9090/v1/server_info` to get the info from server-info API): - apisix-dashboard version, if have: - the plugin runner version, if the issue is about a plugin runner (cmd: depended on the kind of runner): - luarocks version, if the issue is about installation (cmd: `luarocks --version`):</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>403</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix(openid-connect): return userinfo when use_jwks is true (#8347) Fixes https://github.com/apache/apisix/issues/8133</MESSAGE>
    <SHA>4346b0b2c58f6473d31f6882c6aeabb7084f9c7f</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>feat: add method that parse ip from /etc/hosts in high priority (#8270) Co-authored-by: MaChao &lt;chao.ma@transwarp.io&gt; Fixes https://github.com/apache/apisix/issues/5233</MESSAGE>
      <SHA>6dbf9761e5d8851fef8b2fd8262d6d7cf3000f78</SHA>
      <PATCHEDFILES>
        <FILE>apisix/core/resolver.lua</FILE>
        <FILE>t/core/resolver.t</FILE>
        <FILE>t/node/upstream-node-dns.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
