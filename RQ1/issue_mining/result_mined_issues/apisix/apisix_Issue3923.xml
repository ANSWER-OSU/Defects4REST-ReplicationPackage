<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3923</ISSUENO>
  <ISSUEURL>https://github.com/apache/apisix/issues/3923</ISSUEURL>
  <TITLE>request help: timer enhancement</TITLE>
  <DESCRIPTION>Currently, apisix provides a background timer for logger related plugins, whitch is not universal. See this demand: a plugin may register a timer in `init` function, the timer will be recurring to pull data, and unregister it in `destroy` function, the phase functions may use these pulled data. But the current timer implemention is not possible to do that. How can i do this, any suggestions?</DESCRIPTION>
  <REPONAME>apisix</REPONAME>
  <TIMEDIFFERENCEDAYS>25</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>ci: cancel duplicate workflow to reduce CI queue time (#4050)</MESSAGE>
    <SHA>0a8670041a6e9ea51f808c60bd4f375f656900e8</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: remove unexpected blocking in background timer Previously we actually run background timer each second. And the backgroud timer will be blocked if there is not timer registered To be compatible, now we increase the interval to 1 second. Fix #3923 Signed-off-by: spacewander &lt;spacewanderlzx@gmail.com&gt;</MESSAGE>
      <SHA>5cba5a77462b4ea2a342df53db9605f65e032707</SHA>
      <PATCHEDFILES>
        <FILE>apisix/core/timer.lua</FILE>
        <FILE>apisix/timers.lua</FILE>
        <FILE>t/misc/timers.t</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
