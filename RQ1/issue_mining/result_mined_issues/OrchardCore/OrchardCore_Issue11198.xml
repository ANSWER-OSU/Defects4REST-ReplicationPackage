<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>11198</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/11198</ISSUEURL>
  <TITLE>Recipe import fails with an exception when using an undefined variable</TITLE>
  <DESCRIPTION>### Describe the bug When tying to import a recipe with an undefined variable throws generic exception. The current error is this &gt; ArgumentNullException: Value cannot be null. (Parameter 'value') ### To Reproduce Steps to reproduce the behavior: If you import the following recipe you'll get a generic error that does not help much. Note in the recipe below the variable `someVariableNameThatDoesNotExists` is never defined ``` { &quot;variables&quot;: { &quot;now&quot;: &quot;[js: new Date().toISOString()]&quot; }, &quot;steps&quot;: [ { &quot;name&quot;: &quot;content&quot;, &quot;data&quot;: [ { &quot;ContentItemId&quot;: &quot;[js: variables('someVariableNameThatDoesNotExists')]&quot;, &quot;ContentItemVersionId&quot;: &quot;[js: uuid()]&quot;, &quot;ContentType&quot;: &quot;Test&quot;, &quot;DisplayText&quot;: &quot;Dummy Items&quot;, &quot;Latest&quot;: true, &quot;Published&quot;: true, &quot;ModifiedUtc&quot;: &quot;[js: variables('now')]&quot;, &quot;PublishedUtc&quot;: &quot;[js: variables('now')]&quot;, &quot;CreatedUtc&quot;: &quot;[js: variables('now')]&quot;, &quot;Owner&quot;: &quot;[js: parameters('AdminUserId')]&quot;, &quot;Author&quot;: &quot;[js: parameters('AdminUsername')]&quot;, &quot;LayerMetadata&quot;: { &quot;RenderTitle&quot;: false, &quot;Position&quot;: 1, &quot;Zone&quot;: &quot;Main&quot;, &quot;Layer&quot;: &quot;Home Page&quot; } } ] } ] } ``` ### Expected behavior I would think it would be nice to log something like &gt; The variable &quot;someVariableNameThatDoesNotExists&quot; was not defined. Make sure you define &quot;someVariableNameThatDoesNotExists&quot; variable in the `variables` section of your recipe. ### Screenshots If applicable, add screenshots to help explain your problem. ![image](https://user-images.githubusercontent.com/24724371/154357186-10d810e8-654b-4765-a7b1-0216870b0fbd.png)</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>142</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Adding context to the returned Edit (#11912)</MESSAGE>
    <SHA>98640f2b3c52fb18064acdbded677c4edd0dcff7</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix #11198</MESSAGE>
      <SHA>545184655c68016db087c2efef584ea9f421176e</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore/OrchardCore.Recipes.Core/VariablesMethodProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix exception when a recipe is imported with undefined variable #11198 (#11927)</MESSAGE>
      <SHA>7ca3210638dc6aeeae7814538d7827736d622926</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore/OrchardCore.Recipes.Core/VariablesMethodProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
