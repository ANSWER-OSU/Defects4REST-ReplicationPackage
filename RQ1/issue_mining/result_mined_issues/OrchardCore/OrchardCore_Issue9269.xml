<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>9269</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/9269</ISSUEURL>
  <TITLE>&quot;Buffer has already been rendered&quot; exception</TITLE>
  <DESCRIPTION>I have a `Menu.liquid` where we render the Items in two different lists. ``` {% for item in Model.Items %} {{ item | shape_render }} {% endfor %} ..... {% for item in Model.Items %} {{ item | shape_render }} {% endfor %} ``` This exception occurs. Removing the second for loop fixes the issue. ![image](https://user-images.githubusercontent.com/4681586/115869506-f8c22280-a40b-11eb-8504-eb91143a81cd.png) As requested, moved the issue from https://github.com/sebastienros/fluid/issues/318</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>41</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Properly initialize content fields (#9414)</MESSAGE>
    <SHA>b45dcefcc49ba9ae8882a742c5c38c24d3ace783</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixes #9269 release view buffer at the end of scope</MESSAGE>
      <SHA>301c065806d3dd8fde860a68d9ffb7f8660e1883</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore/OrchardCore.DisplayManagement.Liquid/LiquidViewTemplate.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.DisplayManagement.Liquid/ViewBufferTextWriterContent.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixes #9269 release view buffer at the end of scope (#9509)</MESSAGE>
      <SHA>e5606466540747ccb8fabaf6d1426857521ff6d7</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore/OrchardCore.DisplayManagement.Liquid/LiquidViewTemplate.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.DisplayManagement.Liquid/ViewBufferTextWriterContent.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
