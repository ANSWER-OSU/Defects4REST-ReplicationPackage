<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>13177</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/13177</ISSUEURL>
  <TITLE>OrchardCore_Media_AmazonS3 - BasePath folder name issue with multi-tenant</TITLE>
  <DESCRIPTION>### Describe the bug When configuring the Feature `OrchardCore_Media_AmazonS3` I have configured the `BasePath` value as below: ``` &quot;BasePath&quot;: &quot;{{ ShellSettings.Name }}/Media&quot;, ``` My expectation was that for each Tenant, there would be a subfolder created for each Tenant with a unique name. What is happening though is that the folder in the S3 bucket is actually being generated as below: &lt;img width=&quot;407&quot; alt=&quot;image&quot; src=&quot;https://user-images.githubusercontent.com/63015960/215571718-6c3ec1ab-04af-4b7f-9be4-265269789a48.png&quot;&gt; The Liquid value is never being interpreted. The files still get uploaded, but they all get dropped in that same incorrectly named (and shared) folder. ### Expected behavior If I have 2 tenants named `Tenant01` and `Tenant02` I expect two subfolders be created off of the root of the site. The Media for those tenant sites will be dropped in the relevant folder for the tenant. ### Possible solution I made two changes locally to test a theory - `OrchardCore\OrchardCore.FileSTorage.AmazonS3\AwsFileStorage.cs` : constructor is modified to use `IOptions&lt;AwsStorageOptions&gt; instead of just `AwsStorageOptions` ``` public AwsFileStore(IClock clock, IOptions&lt;AwsStorageOptions&gt; options, IAmazonS3 amazonS3Client) { _options = options.Value; ``` - `OrchardCore.Modules\OrchardCore.Media.AmazonS3\Startup.cs : alter the initialization of the `AwsFileStore` as follows: ``` IOptions&lt;AwsStorageOptions&gt; options = serviceProvider.GetRequiredService&lt;IOptions&lt;AwsStorageOptions&gt;&gt;(); var fileStore = new AwsFileStore(clock, options, amazonS3Client); ```</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>4</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>mkdocs-material 9.0.9</MESSAGE>
    <SHA>e47ac8688b40aebab7c8f155107f7d6a516a48b0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: #13177 - changed AswFileStore initialization - fluid interpreter was not being used to parse options</MESSAGE>
      <SHA>934289d04411827413efa1236b55311718214723</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Media.AmazonS3/Startup.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
