<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>16580</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/16580</ISSUEURL>
  <TITLE>SQL document queries don't work on older existing tenants</TITLE>
  <DESCRIPTION>### Describe the bug The `query` Liquid filter (and `SqlQuerySource` in general) doesn't work with content item queries in certain databases. Only older/legacy databases are affected, for example I was able to reproduce this problem in two DotNest tenants (using the OC 2.0 branch of DotNest) that iirc were created in 2021 and 2022 respectively. Newer tenants are not affected. The problem is that in these databases the document ID column is `int` instead of `bigint`, which is the case for newer tenants: ![image](https://github.com/user-attachments/assets/8c07ad39-f057-4070-ad11-5ee25755e35e) This was fine in 1.8, but became a problem after #16234 where the assumption that the document ID column must be `long` [is hard coded](https://github.com/OrchardCMS/OrchardCore/blob/7d9ba09f95f88210087b6010bffa3c3327db3f72/src/OrchardCore.Modules/OrchardCore.Queries/Sql/SqlQuerySource.cs#L91). ### Orchard Core version Using the latest `main` branch at the time of writing, ### To Reproduce Steps to reproduce the behavior: 1. Find an older tenant or somehow create an SQL Server DB with `int` document IDs. Below for convenience I will also assume the site has BlogPost content items, like when running the Blog recipe. 2. Go to Admin &gt; Serach &gt; Queries &gt; All Queries. 3. &quot;Add Query&quot;, select &quot;SQL&quot; and fill: - Name: `BlogPosts` - Schema: leave empty - Return Documents: checked - Query: `select DocumentId from ContentItemIndex where Published = true and Latest = true and ContentType = 'BlogPost'` 4. Create new content type &quot;Query&quot; with a Liquid part. 5. Create new Query content item with the following Liquid: ```liquid &lt;h1&gt;Query Test&lt;/h1&gt; &lt;code&gt; {% assign posts = Queries.BlogPosts | query %} {% for post in posts %} - {{ post.DisplayText }}&lt;br /&gt; {% endfor %} &lt;code&gt; ``` 6. View the content item, observe that no blog post title is listed. ### Expected behavior The query should return expected results. Note that the same query actually returns results if you uncheck the &quot;Return Documents&quot; box. ### Logs and screenshots If applicable, add log files, browser console logs, and screenshots (or screen recording videos) to help explain your problem.</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>mkdocs-material 9.5.32</MESSAGE>
    <SHA>58e653cf089556ae555929c75722bffec3d62db9</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix int casting in SqlQuerySource Fix #16580</MESSAGE>
      <SHA>7ba66d7c35aa574554bfdff20311d084337d34a8</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Queries/Sql/SqlQuerySource.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
