<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>17048</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/17048</ISSUEURL>
  <TITLE>External Users are being able to register a new account even when DisableNewRegistrations is enabled</TITLE>
  <DESCRIPTION>### Describe the bug When using external authentication feature, users login from external providers still create a new account even when the setting `DisableNewRegistrations` is set to true. ### Orchard Core version v2.1 ### To Reproduce 1. Enable any external authentication provider feature. 2. Set DisableNewRegistrations to true in the External Authentication settings. 3. Try to login using the external provider. ### Expected behavior Users should not be able to register if `DisableNewRegistrations` is set to true.</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>2</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Upgrade GraphQL to 8.2 (#16736)</MESSAGE>
    <SHA>5dc244bf64afb2056939b617885fceb7a0da3607</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Prevent External Users Registration Fix #17048</MESSAGE>
      <SHA>c065fc68979466eae03a6432382a4e528698574d</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.ReCaptcha/Users/Handlers/LoginFormEventEventHandler.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/AuditTrail/Handlers/UserEventHandler.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Controllers/AccountController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Controllers/ExternalAuthenticationsController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Controllers/RegistrationController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Controllers/ResetPasswordController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/DataMigrations/LoginSettingsMigrations.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Drivers/LoginSettingsDisplayDriver.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Drivers/RegistrationSettingsDisplayDriver.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Extensions/ControllerExtensions.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Handlers/EmailConfirmationUserEvent.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Handlers/RegistrationUserEvent.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Models/RegistrationSettings.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Services/ExternalLoginFormEvents.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Services/RegistrationOptionsConfigurations.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Startup.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Views/Items/UserSendConfirmationActionsMenu.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Views/LoginSettings.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Views/RegistrationSettings.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Views/UserFields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Abstractions/Events/ILoginFormEvent.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Abstractions/Events/LoginFormEventBase.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Core/Models/LoginSettings.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Core/Models/RegistrationOptions.cs</FILE>
        <FILE>src/docs/releases/3.0.0.md</FILE>
        <FILE>test/OrchardCore.Tests/OrchardCore.Users/AccountControllerTests.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
