<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>13035</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/13035</ISSUEURL>
  <TITLE>Role permission settings are overwritten if a tenant is started</TITLE>
  <DESCRIPTION>### Describe the bug Whenever a tenant is activated, the `RoleUpdater` reapplies any default permissions to the roles. This overwrites any adjustments made from the admin dashboard. This breaks all permissions assigned to specific content types, because e.g. the anonymous role is always reset. ### To Reproduce Example steps to reproduce the behavior: 1. Go to security -&gt; roles and edit the 'Anonymous' role. 2. Remove 'View' the permission from 'Content' and save. 3. Restart the web app. 4. The removed permission is added back. ### Expected behavior Permission settings on roles are persisted between site restarts. This bug was introduced by PR #12510. See also bug #13024.</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>6</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix UserStore by saving/removing the role from the user (#13066)</MESSAGE>
    <SHA>aa631dd36dd049fae49ada72918f454d152d27f4</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix #13024 and #13035 Roles Updater (#13040)</MESSAGE>
      <SHA>5dbd92cb06cee203b95e0b3bc133d852adf3fbeb</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Recipes/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Roles/Controllers/AdminController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Roles/Manifest.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Roles/Models/RolesDocument.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Roles/Services/RoleStore.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Roles/Services/RoleUpdater.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Roles/Startup.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Users/Manifest.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Infrastructure.Abstractions/Security/IRoleCreatedEventHandler.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Core/Extensions/UsersServiceCollectionExtensions.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Core/Services/NullRoleStore.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Users.Core/Services/UserStore.cs</FILE>
        <FILE>src/docs/reference/modules/Recipes/README.md</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
