<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6008</ISSUENO>
  <ISSUEURL>https://github.com/OrchardCMS/OrchardCore/issues/6008</ISSUEURL>
  <TITLE>Workflow: Content not available when create event is fired</TITLE>
  <DESCRIPTION>I have had a strange problem that straight after a content item is created and the event triggered in a workflow the content item hasn't actually been created and I get the following exception. ``` System.NullReferenceException HResult=0x80004003 Message=Object reference not set to an instance of an object. Source=OrchardCore.ContentManagement.Abstractions StackTrace: at OrchardCore.ContentManagement.ContentItemExtensions.Merge(ContentItem contentItem, Object properties, JsonMergeSettings jsonMergeSettings) in C:\Developement\R&amp;D\OrchardCore\src\OrchardCore\OrchardCore.ContentManagement.Abstractions\ContentItemExtensions.cs:line 88 ``` Tracking the exception up the stack it seem like the event is fired before the content creation is saved. https://github.com/OrchardCMS/OrchardCore/blob/cac3c48ebd21ff03ab44414dceecbd3520ecb34d/src/OrchardCore/OrchardCore.ContentManagement/DefaultContentManager.cs#L383-L392 The sample workflow is as seen below for reproduction steps. ![image](https://user-images.githubusercontent.com/6050438/79906819-cc4e8180-8418-11ea-8787-24ec392cb960.png) I'll add the PR and reference shortly.</DESCRIPTION>
  <REPONAME>OrchardCore</REPONAME>
  <TIMEDIFFERENCEDAYS>106</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Make Login, Logout and ChangePassword paths configurable (#6028) * Make Login, Logout and ChangePassword paths configurable * fix nre * add doc * feedback * feedback update * feedback update update</MESSAGE>
    <SHA>58d79ab3cde297f164a55a146549840c0a34db25</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixes #6008 UpdateContentTask</MESSAGE>
      <SHA>33eec6c6df40e9abbaf1e3fc24c537ca9f62e62a</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/DeleteContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/PublishContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/RetrieveContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/UnpublishContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/UpdateContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/UpdateContentTask.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement/DefaultContentManagerSession.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixes #6008 Update Content Activities (#6054)</MESSAGE>
      <SHA>0e1b3317d1f941245751eddcdfd12997f62aef60</SHA>
      <PATCHEDFILES>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Controllers/AdminController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Controllers/ApiController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Scripting/ContentMethodsProvider.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/ContentDraftSavedEvent.Fields.Design.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/ContentDraftSavedEvent.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/ContentDraftSavedEvent.Fields.Thumbnail.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/DeleteContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/PublishContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/RetrieveContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/UnpublishContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/UpdateContentTask.Fields.Design.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Views/Items/UpdateContentTask.Fields.Edit.cshtml</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/ContentActivity.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/ContentDraftSavedEvent.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/ContentPublishedEvent.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/ContentUpdatedEvent.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/CreateContentTask.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/DeleteContentTask.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/PublishContentTask.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/RetrieveContentTask.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/UnpublishContentTask.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Activities/UpdateContentTask.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Drivers/ContentDraftSavedEventDisplay.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Drivers/UpdateContentTaskDisplay.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Handlers/ContentsHandler.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/Startup.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/ViewModels/ContentDraftSavedEventViewModel.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Contents/Workflows/ViewModels/UpdateContentTaskViewModel.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Lists/RemotePublishing/MetaWeblogHandler.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Menu/Controllers/AdminController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Workflows/Controllers/WorkflowController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Workflows/Controllers/WorkflowTypeController.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Workflows/Services/WorkflowManager.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Workflows/UserTasks/Activities/UserTaskEvent.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Workflows/UserTasks/Drivers/UserTaskEventContentDriver.cs</FILE>
        <FILE>src/OrchardCore.Modules/OrchardCore.Workflows/Views/Content.UserTaskButton.cshtml</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement.Abstractions/Handlers/ContentHandlerBase.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement.Abstractions/Handlers/ContentPartHandler.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement.Abstractions/Handlers/IContentHandler.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement.Abstractions/Handlers/IContentPartHandler.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement.Abstractions/Handlers/SaveDraftContentContext.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement.Abstractions/IContentManager.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement.Abstractions/Workflows/ContentEventConstants.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement.Abstractions/Workflows/ContentEventContext.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement/DefaultContentManager.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement/DefaultContentManagerSession.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.ContentManagement/Handlers/ContentPartHandlerCoordinator.cs</FILE>
        <FILE>src/OrchardCore/OrchardCore.Workflows.Abstractions/Helpers/DictionaryExtensions.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
