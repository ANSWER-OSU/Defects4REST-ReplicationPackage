<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6404</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/6404</ISSUEURL>
  <TITLE>Missing order positions or duplicated order quantities</TITLE>
  <DESCRIPTION>nopCommerce version: 4.50.x Steps to reproduce the problem: &gt; Some order items, are not added to to the final order. So lets say a customer has 2 products in the cart, only one will appear in the placed order. Additionally, sometimes we also experienced, that the quantity of an cart item is duplicated by placing the order. Lets say we have a product with 10 items, in the cart, the final order will have an order item with the quantity set to 20. Source: PS-16684</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#6403 Added missed vendor access check to order invoice</MESSAGE>
    <SHA>e45391d90af6d1cf6a88057fb397ea93bdf3c29a</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#6404 Rejection of List&lt;T&gt;.ForEach due to its incorrect work with Async methods</MESSAGE>
      <SHA>23b68779a2ab3c0e9b1c9988f986210dd211b310</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Core/ComponentModel/GenericDictionaryTypeConverter.cs</FILE>
        <FILE>src/Libraries/Nop.Core/ComponentModel/GenericListTypeConverter.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Catalog/ProductService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/OrderProcessingService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Plugins/PluginService.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/ProductController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/RecurringPaymentController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/VendorController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Factories/OrderModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/ProductController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/VendorController.cs</FILE>
        <FILE>src/Tests/Nop.Tests/Nop.Services.Tests/Orders/OrderTotalCalculationServiceTests.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#6404 Further changes for plugins</MESSAGE>
      <SHA>7168910a71415ccb7eab3658f493dbc7aaff3cdc</SHA>
      <PATCHEDFILES>
        <FILE>src/Plugins/Nop.Plugin.Tax.Avalara/AvalaraTaxProvider.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.Avalara/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Widgets.FacebookPixel/Services/FacebookPixelService.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Widgets.FacebookPixel/plugin.json</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#6404 Further changes</MESSAGE>
      <SHA>985d967b5587db5e248382a1f1b436842093ee78</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Core/ComponentModel/GenericDictionaryTypeConverter.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
