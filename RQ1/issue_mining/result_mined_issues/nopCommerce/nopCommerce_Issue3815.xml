<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3815</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/3815</ISSUEURL>
  <TITLE>Product pages taking too long to complete loading (20+ seconds)</TITLE>
  <DESCRIPTION>nopCommerce version: 4.20 beta There is an issue opening product pages in nopcommerce 4.2 beta for a fresh installation with sample data. When you open a product page (simple or grouped) it loads the top half of the page (header, image, short description, add to cart button, etc) but everything beneath that (full description, related products, footer, etc) takes a while to complete loading. For myself it is taking 20+ seconds to load (running locally on my development machine). After puzzling over this for a while I have found that the problem exists in the following partial call in both `ProductTemplate.Simple.cshtml` and `ProductTemplate.Grouped.cshtml`: `@await Html.PartialAsync(&quot;_ShareButton&quot;, Model)` The code for `_ShareButton.cshtml` is the following: ``` @model ProductDetailsModel @if (!string.IsNullOrWhiteSpace(Model.PageShareCode)) { &lt;div class=&quot;product-share-button&quot;&gt; @Html.Raw(Model.PageShareCode) &lt;/div&gt; } ``` with the problem existing in the call to `@Html.Raw(Model.PageShareCode)`. The code in `Model.PageShareCode` is (formatted here for readability): ``` &lt;!-- AddThis Button BEGIN --&gt; &lt;div class=\&quot;addthis_toolbox addthis_default_style \&quot;&gt; &lt;a class=\&quot;addthis_button_preferred_1\&quot;&gt;&lt;/a&gt; &lt;a class=\&quot;addthis_button_preferred_2\&quot;&gt;&lt;/a&gt; &lt;a class=\&quot;addthis_button_preferred_3\&quot;&gt;&lt;/a&gt; &lt;a class=\&quot;addthis_button_preferred_4\&quot;&gt;&lt;/a&gt; &lt;a class=\&quot;addthis_button_compact\&quot;&gt;&lt;/a&gt; &lt;a class=\&quot;addthis_counter addthis_bubble_style\&quot;&gt;&lt;/a&gt; &lt;/div&gt; &lt;script src=\&quot;http://s7.addcom/js/250/addthis_widget.js#pubid=nopsolutions\&quot;&gt; &lt;/script&gt; &lt;!-- AddThis Button END --&gt; ``` The issue is the call to the script at http://**s7.addcom**/js/250/addthis_widget.js#pubid=nopsolutions\ as this source does not exist and is taking a while to timeout. The link should be http://**s7.addthis.com**/js/250/addthis_widget.js#pubid=nopsolutions\ This link is set in the `CodeFirstInstallationService`. The link was changed to the incorrect link in commit dbf06071 which removed all references to 'this' throughout the code. It seems that a find and replace was performed for the string &quot;this.&quot; to change it to &quot;&quot;. As the commit involved 520 files this change must have got lost among them. The link should be changed back to http://**s7.addthis.com**/js/250/addthis_widget.js#pubid=nopsolutions\ to correct the issue.</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>3</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#3732 Update button design of Facebook authentication plugin</MESSAGE>
    <SHA>9c451fc66a160a8209ade359de491b19945f108e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#3815 Corrected PageShareCode script link from the incorrect http://s7.addcom to the correct http://s7.addthis.com.</MESSAGE>
      <SHA>034b6981065c11ea53843020c7a5b8db30153535</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/Installation/CodeFirstInstallationService.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #3816 from davidandrewpowell/issue-3815-incorrect-page-share-code-link #3815 Corrected PageShareCode script link</MESSAGE>
      <SHA>f5cf9b441522d6c3aa3c577ad1ee7689c741cb0d</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/Installation/CodeFirstInstallationService.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
