<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>475</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/475</ISSUEURL>
  <TITLE>Multi-factor authentication</TITLE>
  <DESCRIPTION>Hi guys. I want to talk about administration access security. A lot of sites started to add another authentication method to increase security. So, I think Nop should follow them. Google Authenticator is a good choice and easy to use. http://www.codeproject.com/Articles/403355/Implementing-Two-Factor-Authentication-in-ASP-NET https://googleauthcsharp.codeplex.com/ The admin area is very critical to all stores. Any unauthorized access could make big losses, hacking or taking some self-advantage changing/reading informations. What do you think? I think to use it only for admin access, not for all customer, but in this case, more development will be required. Thanks! Source: http://www.nopcommerce.com/boards/t/34056/two-factor-authentication-google-authenticator.aspx</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>1717</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#5058 The 'hide/show fields' javascript code moved from _CreateOrUpdate.Info.cshtml to _CreateOrUpdate.Display.cshtml view</MESSAGE>
    <SHA>44f4e4a74bff85849a6425b6707551bf87708ed8</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#475 Rename some files</MESSAGE>
      <SHA>27f4853bfdeece97417a066f2791d03658be8971</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/AuthenticationController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Authentication/ExternalMethods.cshtml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#475 Implemented multi-factor authentication</MESSAGE>
      <SHA>93e3bd67aded86e083cbcef89e682ea17bc0f404</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Core/Domain/Customers/CustomerChangeMultiFactorAuthenticationProviderEvent.cs</FILE>
        <FILE>src/Libraries/Nop.Core/Domain/Customers/CustomerLoginResults.cs</FILE>
        <FILE>src/Libraries/Nop.Core/Domain/Customers/CustomerSettings.cs</FILE>
        <FILE>src/Libraries/Nop.Core/Domain/Customers/MultiFactorAuthenticationSettings.cs</FILE>
        <FILE>src/Libraries/Nop.Core/Domain/Customers/NopCustomerDefaults.cs</FILE>
        <FILE>src/Libraries/Nop.Data/Migrations/UpgradeTo440/DataMigration.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Authentication/External/ExternalAuthenticationService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Authentication/MultiFactor/IMultiFactorAuthenticationMethod.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Authentication/MultiFactor/IMultiFactorAuthenticationPluginManager.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Authentication/MultiFactor/MultiFactorAuthenticationPluginManager.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Authentication/MultiFactor/MultiFactorAuthenticationType.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Customers/CustomerMultiFactorAuthenticationInfo.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Customers/CustomerRegistrationService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Customers/ICustomerRegistrationService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Security/StandardPermissionProvider.cs</FILE>
        <FILE>src/NopCommerce.sln</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Components/GAAuthenticationViewComponent.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Components/GAVerificationViewComponent.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Controllers/AuthenticationController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Controllers/GoogleAuthenticatorController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Domains/GoogleAuthenticatorRecord.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Factories/AuthenticationModelFactory.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/GoogleAuthenticatorDefaults.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/GoogleAuthenticatorMethod.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/GoogleAuthenticatorSettings.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Infrastructure/DependencyRegistrar.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Infrastructure/RouteProvider.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Migrations/GoogleAuthenticatorSchemaMigration.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Models/AuthModel.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Models/ConfigurationModel.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Models/GoogleAuthenticatorListModel.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Models/GoogleAuthenticatorModel.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Models/GoogleAuthenticatorSearchModel.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Models/TokenModel.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator.csproj</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Notes.txt</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Services/GoogleAuthenticatorService.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Validators/AuthModelValidator.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Validators/TokenModelValidator.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Views/Configure.cshtml</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Views/Customer/GAAuthentication.cshtml</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Views/Customer/GAVefification.cshtml</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Views/_ViewImports.cshtml</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/logo.png</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/plugin.json</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Infrastructure/AdminWidgetZones.cs</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Infrastructure/DependencyRegistrar.cs</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Migrations/UpgradeTo440/LocalizationMigration.cs</FILE>
        <FILE>src/Presentation/Nop.Web/App_Data/Localization/defaultResources.nopres.xml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/AuthenticationController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/PluginController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Factories/CommonModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Factories/IMultiFactorAuthenticationMethodModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Factories/MultiFactorAuthenticationMethodModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Factories/PluginModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Infrastructure/Mapper/AdminMapperConfiguration.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Models/ExternalAuthentication/ExternalAuthenticationMethodModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Models/MultiFactorAuthentication/MultiFactorAuthenticationMethodListModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Models/MultiFactorAuthentication/MultiFactorAuthenticationMethodModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Models/MultiFactorAuthentication/MultiFactorAuthenticationMethodSearchModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Models/Settings/CustomerSettingsModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Authentication/ExternalMethods.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Authentication/MultiFactorMethods.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Setting/_CustomerUser.Security.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Shared/_ConfigurePlugin.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/_ViewImports.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/sitemap.config</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/CustomerController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Factories/CustomerModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Factories/ICustomerModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Infrastructure/DependencyRegistrar.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Infrastructure/RouteProvider.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Models/Customer/CustomerNavigationModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Models/Customer/MultiFactorAuthenticationModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Models/Customer/MultiFactorAuthenticationProviderModel.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Customer/ConfigureMultiFactorAuthenticationProvider.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Customer/MultiFactorAuthentication.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Customer/MultiFactorVerification.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Customer/_MultiFactorAuthenticationProviders.cshtml</FILE>
        <FILE>src/Tests/Nop.Tests/BaseNopTest.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#475 Minor code cleanup</MESSAGE>
      <SHA>b4ee07a24f4db1379d05f3484648424f4ad633b7</SHA>
      <PATCHEDFILES>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Factories/AuthenticationModelFactory.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator.csproj</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#475 Added check for active authentication provider</MESSAGE>
      <SHA>4dc97bcd7f2c0c1a09c480940f4a27df45016fc3</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Factories/CustomerModelFactory.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#475 Minor fixing of routing for SEO friendly URLs</MESSAGE>
      <SHA>3602bac0205b6c382cecdbef7aed08dbb55ddab4</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Infrastructure/RouteProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#475 Unlinking the user from the provider when removing the secret key from the plugin configuration</MESSAGE>
      <SHA>48fa0410597aa4ecc3663b1e3baab1f69f4722ca</SHA>
      <PATCHEDFILES>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/Controllers/GoogleAuthenticatorController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.MultiFactorAuth.GoogleAuthenticator/plugin.json</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
