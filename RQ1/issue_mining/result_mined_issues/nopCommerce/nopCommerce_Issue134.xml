<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>134</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/134</ISSUEURL>
  <TITLE>PayPalDirect enable partial refund (contribution)</TITLE>
  <DESCRIPTION>Source: http://www.nopcommerce.com/boards/t/35964/paypaldirect-enable-partial-refund.aspx#148140 (see the latest post by &quot;a.m.&quot;: We should investigate possible scenario when refund is made twice (only on nopCommerce site - plugin and IPN). If it's so we should use &quot;response.RefundTransactionID&quot; ``` if (refundPaymentRequest.IsPartialRefund) { //partial req.RefundTransactionRequest.RefundType = RefundType.PARTIAL; req.RefundTransactionRequest.Amount.currencyID = PaypalHelper.GetPaypalCurrency(_currencyService.GetCurrencyById(_currencySettings.PrimaryStoreCurrencyId)); req.RefundTransactionRequest.Amount.value = refundPaymentRequest.AmountToRefund.ToString(); } else { //full req.RefundTransactionRequest.RefundType = RefundType.FULL; } ```</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>156</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#1334 Fixed issue with Magnific Popup for RTL</MESSAGE>
    <SHA>f4a82e0eb3074d35b8af8a5b5fcb2bf88d6950c4</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#134 PayPalDirect enable partial refund.</MESSAGE>
      <SHA>f998d5db2ca68330a6df37712c7af008bc8fe44d</SHA>
      <PATCHEDFILES>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalDirect/Controllers/PaymentPayPalDirectController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalDirect/PayPalDirectPaymentProcessor.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
