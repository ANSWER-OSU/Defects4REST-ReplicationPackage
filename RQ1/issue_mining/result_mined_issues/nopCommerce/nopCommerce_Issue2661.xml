<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2661</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/2661</ISSUEURL>
  <TITLE>Add support for model events for collections</TITLE>
  <DESCRIPTION>It turned out that the current implementation will not work in many cases when the Model is not exactly NopBaseModel but a collection of NopBaseModels. Here is an example: The HomePageProductsViewComponent returns IEnumerable&lt;ProductOverviewModel&gt; as a Model rather than BaseNopModel. The check in the NopViewComponent will cause no event to be published: if (model is BaseNopModel) You should handle all the other possible Model scenarios in addition to the check above or at least the most common ones. p.s: The same applies for the PublishModelEventsFilter Source: https://www.nopcommerce.com/boards/t/48672/nopcommerce-40-bug-fixes-and-improvements.aspx?p=5#194912</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>4</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Change logo of the Square payment plugin</MESSAGE>
    <SHA>941edf3d9d9ee58c02145afb147f411641c0904a</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#2661 Add support for ModelPrepared event for collections</MESSAGE>
      <SHA>5a8b1fc2750fa66c6e8269295c313ad144bf7388</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web.Framework/Components/NopViewComponent.cs</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Events/EventPublisherExtensions.cs</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Events/ModelPrepared.cs</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Events/ModelReceived.cs</FILE>
        <FILE>src/Presentation/Nop.Web.Framework/Mvc/Filters/PublishModelEventsAttribute.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
