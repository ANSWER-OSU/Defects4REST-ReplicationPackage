<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5592</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/5592</ISSUEURL>
  <TITLE>Routing errors when English is disabled</TITLE>
  <DESCRIPTION>nopCommerce version: 4.40 &gt; Upgraded from v430. &gt; &gt; Example plugin: &gt; PayPalStandard &gt; Controller &gt; Nop.Plugin.Payments.PayPalStandard.Controllers.PaymentPayPalStandardController. &gt; &gt; Issue: &gt; routings work only if English is enabled, if English is disabled this results in &quot;Page not found&quot; &gt; Example routings &gt; RedirectToRoute( &quot;ShoppingCart&quot; ); &gt; RedirectToRoute( &quot;OrderDetails&quot;, new { orderId = order.Id } ); &gt; etc. &gt; &gt; Reproduce: &gt; - Disable English and use other language, in my case it is NL &gt; - Check out with PayPalStandard &gt; - Cancel payment calls this url &gt; http://localhost:65283/Plugins/PaymentPayPalStandard/CancelOrder &gt; - RedirectToRoute( &quot;OrderDetails&quot;, new { orderId = order.Id } ); is called &gt; - context.HttpContext.Request.Path = &quot;/en/orderdetails/123456&quot; (en is default in GetLanguageRoutePattern() ) &gt; - url rewitten to &quot;/nl/en/orderdetails/133169&quot; &gt; - url rewritten to &quot;/page-not-found&quot; &gt; - url rewritten to &quot;/nl/page-not-found&quot; Source: https://www.nopcommerce.com/boards/topic/90678/v440-routing-errors-when-english-is-disabled-tested-with-mutiple-plugins</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#5591 #423 PayPal SmartPaymentButtons plugin. Using of button selector in the payment script</MESSAGE>
    <SHA>073fd12c1243c0ed26efa3bf8ff8d61ae43e37aa</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#5592 Fixed incorrect routing when the english language is disabled</MESSAGE>
      <SHA>1694564c5328e08dbe058c648477c0a9771a88b8</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web.Framework/Mvc/Routing/LanguageParameterTransformer.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#5594 #5592 Further fix of incorrect routing in some cases</MESSAGE>
      <SHA>570d7f77103ff4f1e67d2489128942472f884a37</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web.Framework/Mvc/Routing/LanguageParameterTransformer.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Infrastructure/BaseRouteProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
