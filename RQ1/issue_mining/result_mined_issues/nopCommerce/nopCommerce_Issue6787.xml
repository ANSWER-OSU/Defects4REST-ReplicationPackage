<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6787</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/6787</ISSUEURL>
  <TITLE>DeleteInactiveCustomersTask deletes system records</TITLE>
  <DESCRIPTION>nopCommerce version: 4.60 &gt; After much investigation, the cause of the problem was the account for the built-in system record used for background tasks had been deleted. &gt; Then after a lot more digging around I noticed If I click in scheduled tasks - &quot;Delete inactive customers (GDPR)&quot; it deletes the customer record for the built-in search engine. &gt; I have tried it three times and it definitely does delete the account. Source: https://www.nopcommerce.com/boards/topic/97646/built-in-system-record-used-for-background-tasks We should add a check for customer roles in this scheduled task.</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge remote-tracking branch 'origin/4.60-bug-fixes' into 4.60-bug-fixes</MESSAGE>
    <SHA>fd9c7764e4d312829a5212c64aea6decab2d2682</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#6787 Skip system users when removing inactive customers</MESSAGE>
      <SHA>a146abb6675124a8495d50ed53cb39f598b08b22</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/Gdpr/DeleteInactiveCustomersTask.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
