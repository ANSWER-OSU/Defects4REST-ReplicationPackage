<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3709</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/3709</ISSUEURL>
  <TITLE>RouteProvider improvements (suggestion)</TITLE>
  <DESCRIPTION>SUGGESTION 1: The following 2 routes: ``` routeBuilder.MapLocalizedRoute(&quot;CustomerBackInStockSubscriptions&quot;, &quot;backinstocksubscriptions/manage&quot;, new { controller = &quot;BackInStockSubscription&quot;, action = &quot;CustomerSubscriptions&quot; }); routeBuilder.MapLocalizedRoute(&quot;CustomerBackInStockSubscriptionsPaged&quot;, &quot;backinstocksubscriptions/manage/{pageNumber:regex(\\d*)}&quot;, new { controller = &quot;BackInStockSubscription&quot;, action = &quot;CustomerSubscriptions&quot; }); ``` I believe could be replaced with the following single route: ``` routeBuilder.MapLocalizedRoute(&quot;CustomerBackInStockSubscriptions&quot;, &quot;backinstocksubscriptions/manage/{pageNumber:regex(\\d*)?}&quot;, new { controller = &quot;BackInStockSubscription&quot;, action = &quot;CustomerSubscriptions&quot; }); ``` where the {pagenumber} route segment has now been made optional to match both /backinstocksubscriptions/manage AND /backinstocksubscriptions/manage/1. This would also require the route name in BackInStockSubscriptionController.CustomerSubscriptions to be changed from CustomerBackInStockSubscriptionsPaged to CustomerBackInStockSubscriptions. SUGGESTION 2: The following 2 routes (which map to the same controller and action) have different contraints for id: ``` routeBuilder.MapLocalizedRoute(&quot;CustomerProfile&quot;, &quot;profile/{id:min(0)}&quot;, new { controller = &quot;Profile&quot;, action = &quot;Index&quot; }); routeBuilder.MapLocalizedRoute(&quot;CustomerProfilePaged&quot;, &quot;profile/{id}/page/{pageNumber:min(0)}&quot;, new { controller = &quot;Profile&quot;, action = &quot;Index&quot; }); ``` Should the second route be: ``` routeBuilder.MapLocalizedRoute(&quot;CustomerProfilePaged&quot;, &quot;profile/{id:min(0)}/page/{pageNumber:min(0)}&quot;, new { controller = &quot;Profile&quot;, action = &quot;Index&quot; }); ``` SUGGESTION 3: The following routes contain a regex(\\d*) constraint which I believe intends to restrict the route input to a number: ``` routeBuilder.MapLocalizedRoute(&quot;CheckoutCompleted&quot;, &quot;checkout/completed/{orderId:regex(\\d*)}&quot;, new { controller = &quot;Checkout&quot;, action = &quot;Completed&quot; }); routeBuilder.MapLocalizedRoute(&quot;CustomerBackInStockSubscriptionsPaged&quot;, &quot;backinstocksubscriptions/manage/{pageNumber:regex(\\d*)}&quot;, new { controller = &quot;BackInStockSubscription&quot;, action = &quot;CustomerSubscriptions&quot; }); ``` NOTE: This route may potentially be altered in suggestion 1 above. ``` routeBuilder.MapLocalizedRoute(&quot;CustomerForumSubscriptionsPaged&quot;, &quot;boards/forumsubscriptions/{pageNumber:regex(\\d*)}&quot;, new { controller = &quot;Boards&quot;, action = &quot;CustomerForumSubscriptions&quot; }); routeBuilder.MapLocalizedRoute(&quot;ActiveDiscussionsPaged&quot;, &quot;boards/activediscussions/page/{pageNumber:regex(\\d*)}&quot;, new { controller = &quot;Boards&quot;, action = &quot;ActiveDiscussions&quot; }); routeBuilder.MapLocalizedRoute(&quot;TopicSlugPaged&quot;, &quot;boards/topic/{id:min(0)}/{slug?}/page/{pageNumber:regex(\\d*)}&quot;, new { controller = &quot;Boards&quot;, action = &quot;Topic&quot; }); routeBuilder.MapLocalizedRoute(&quot;ForumSlugPaged&quot;, &quot;boards/forum/{id:min(0)}/{slug?}/page/{pageNumber:regex(\\d*)}&quot;, new { controller = &quot;Boards&quot;, action = &quot;Forum&quot; }); ``` Source: https://www.nopcommerce.com/boards/t/62243/potential-improvements-to-routeprovidercs.aspx</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>14</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#75 Stock history table wasn't properly moved to DataTables. &quot;Created on&quot; column didn't work. Fixed</MESSAGE>
    <SHA>78fcd0bb40c09474e8914b41dc61ca796b978823</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#3709 Merged routes (named CustomerBackInStockSubscriptions and CustomerBackInStockSubscriptionsPaged) into a single route (named CustomerBackInStockSubscriptions) with optional pageNumber custom variable.</MESSAGE>
      <SHA>806c949ac0961ff4b383095512093115ea62159f</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Controllers/BackInStockSubscriptionController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Infrastructure/RouteProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#3709 Changed CustomerProfilePaged id route constraint to be consistent with that of route CustomerProfile.</MESSAGE>
      <SHA>10f07f8726f5e024b4f079821ab2c0d2d603f0d1</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Infrastructure/RouteProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#3709 Corrected bug where incorrect regex constraint was allowing characters other than numbers. Rather than correct the regex, an int route constraint has been used instead.</MESSAGE>
      <SHA>fa3f6fd6a1060d3ee66f5a21251d0a28979f02a5</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Infrastructure/RouteProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#3709 Changed casing of CheckGiftCardBalance route to be consistent with all other routes in RouteProvider.cs.</MESSAGE>
      <SHA>ec153663f0e79b75bca0d3718a25f90855e93239</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Infrastructure/RouteProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>#3709 Merged routes (named CustomerForumSubscriptions and CustomerForumSubscriptionsPaged) into a single route (named CustomerForumSubscriptions) with optional pageNumber custom variable.</MESSAGE>
      <SHA>6f14fef3d069e1794e1d7421ee3cc0f3a5613139</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Factories/ForumModelFactory.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Infrastructure/RouteProvider.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
