<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1337</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/1337</ISSUEURL>
  <TITLE>Ensure that registered customer email is not empty (admin area)</TITLE>
  <DESCRIPTION>If a registered customer is created on admin (via impersonate) and the email address field is not filled in, any orders for that customer cannot view viewed on admin. Steps to reproduce issue: 1. Go to Admin/Customer/List 2. Click &quot;Add New&quot; 3. Check registered, leave email address blank, click &quot;Save and Continue Edit&quot; 4. Click on &quot;Place Order&quot; in the Place Order (impersonate) tab. Proceed to make and order for this customer then return to admin. 5. Find the order just created in the order list, then click the &quot;View&quot; link The order cannot be viewed and an error is generated. In the system log, an error is recorded: System.ArgumentException: Value cannot be null or empty. Parameter name: linkText at System.Web.Mvc.Html.LinkExtensions.ActionLink(HtmlHelper htmlHelper, String linkText, String actionName, String controllerName, RouteValueDictionary routeValues, IDictionary`2 htmlAttributes) This happens because in the \Presentation\Nop.Web\Administration\Views\Order_OrderDetails.Info.cshtml view the linkText (Model.CustomerInfo) cannot be null or empty: @Html.ActionLink(Model.CustomerInfo, &quot;Edit&quot;, &quot;Customer&quot;, new { id = Model.CustomerId }, new { }) A simple fix would be in the OrderController (line 283). If the customer is registed, the customer email is provided, even if the string is null or empty. model.CustomerInfo = customer.IsRegistered() ? customer.Email : _localizationService.GetResource(&quot;Admin.Customers.Guest&quot;); Add check for customer.Email being null or empty (maybe using string.IsNullOrWhiteSpace(customer.Email)) and provide an default value if true would remedy the situation. 1. nopCommerce version: 3.70 2. No modications made to the source 3. MS SQL database: SQL Server 2014 Source: http://www.nopcommerce.com/boards/t/41420/view-order-error-on-admin-when-registed-customer-email-is-null-or-empty.aspx</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>65</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#1482 Renamed &quot;Admin.Configuration.Settings.RewardPoints.PageSize.Hint&quot; locale</MESSAGE>
    <SHA>ba9e43a5549679eeddf7309f918087bdff0f7bbf</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#1337 Ensure that registered customer email is valid (admin area)</MESSAGE>
      <SHA>e052f872c39215a0cefdecf3cb2b70daae1917fc</SHA>
      <PATCHEDFILES>
        <FILE>src/Presentation/Nop.Web/Administration/Controllers/CustomerController.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
