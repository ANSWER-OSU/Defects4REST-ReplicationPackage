<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>6462</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/6462</ISSUEURL>
  <TITLE>Incorrect calculation when product has tier price and attribute price adjustment</TITLE>
  <DESCRIPTION>nopCommerce version: 4.30 &gt; i have a product with tier prices listed below (first value quantity, second price): &gt; all roles 1 34 &gt; all roles 5 24 &gt; all roles 10 23 &gt; all roles 20 21 &gt; all roles 50 20 &gt; all roles 100 19 &gt; all roles 500 14 &gt; all roles 1000 13 &gt; &gt; The product has some attributes and one of this set a 30% discount for renewal services. &gt; Discount is correct for 1-4 quantity (first row) . Return wrong values for other rows. &gt; For 5 quantity , unit price is 13,80 instead of 16,80 &gt; For 11 quantity , unit price is 12,80 instead of 16,10 &gt; For 20 quantity , unit price is 10,80 instead of 14,70 Source: https://www.nopcommerce.com/boards/topic/95664/tier-price-and-prdouct-attribute-percentage-discount-problem</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#6460 Fix redirect error when site navigation for guests is disabled</MESSAGE>
    <SHA>8c63020aa89a987064afa75293f8acab3936acb2</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#6462 Fix incorrect calculation of tier price and attribute price adjustment</MESSAGE>
      <SHA>689116dda2e8708cad5fd2625529770299be09af</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Services/Catalog/IPriceCalculationService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Catalog/PriceCalculationService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/ShoppingCartService.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Factories/ProductModelFactory.cs</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
