<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5288</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/5288</ISSUEURL>
  <TITLE>Check using of IgnoreAntiforgeryToken and AutoValidateAntiforgeryToken attributes</TITLE>
  <DESCRIPTION>nopCommerce version: develop &gt; I'm aware what the [IgnoreAntiforgeryToken] attribute does but I'm little confused of its usage in the NopCommerce source code: &gt; &gt; 1. There are controllers which are decorated with the [AutoValidateAntiforgeryToken] attribute but their GET methods (not decorated with the [HttpPost] attribute) are marked with the [IgnoreAntiforgeryToken]. Such an example is the CheckoutController.cs. As the documentation stated the [AutoValidateAntiforgeryToken] does skip GET methods and it is not checking the antiforgery token, so then why using the [IgnoreAntiforgeryToken] on such methods? &gt; &gt; 2. There are controllers decorated with the [AutoValidateAntiforgeryToken] and some of their methods are decorated with the [IgnoreAntiforgeryToken]. Maybe to allow accessing this methods without an active login session or something else? &gt; &gt; 3. There are controllers not decorated with the [AutoValidateAntiforgeryToken] but only single methods in those controllers are decorated with this attribute. Such an example is PrivateMessagesController.cs Let's check using of out anti-forgery attributes, whether they correctly set everywhere. Source: https://www.nopcommerce.com/en/boards/topic/89920/whats-the-point-of-ignoreantiforgerytoken-attribute</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>301</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>#5700 Changed Action&lt;T, int&gt; to Func&lt;TopicLocalizedModel, int, Task&gt; in PrepareLocalizedModelsAsync method</MESSAGE>
    <SHA>cc086925ff7741c97bf519b4b9e4bf4dc1849834</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#5288 Refactoring of AntiForgeryToken action filters</MESSAGE>
      <SHA>73a5f3a8c63155afd1884787ea9e59f7571a4186</SHA>
      <PATCHEDFILES>
        <FILE>src/Plugins/Nop.Plugin.ExternalAuth.Facebook/Controllers/FacebookAuthenticationController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.ExternalAuth.Facebook/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalStandard/Controllers/PaymentPayPalStandardController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Payments.PayPalStandard/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Shipping.FixedByWeightByTotal/Controllers/FixedByWeightByTotalController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Shipping.FixedByWeightByTotal/Views/Configure.cshtml</FILE>
        <FILE>src/Plugins/Nop.Plugin.Shipping.FixedByWeightByTotal/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.Avalara/Controllers/AddressValidationController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.Avalara/plugin.json</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.FixedOrByCountryStateZip/Controllers/FixedOrByCountryStateZipController.cs</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.FixedOrByCountryStateZip/Views/Configure.cshtml</FILE>
        <FILE>src/Plugins/Nop.Plugin.Tax.FixedOrByCountryStateZip/plugin.json</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Controllers/DownloadController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Areas/Admin/Views/Shared/EditorTemplates/Download.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/BackInStockSubscriptionController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/BoardsController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/CatalogController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/CheckoutController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/CommonController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/InstallController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/NewsController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/NewsletterController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/OrderController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/PollController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/PrivateMessagesController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/ProductController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/ScheduleTaskController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/ShoppingCartController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/TopicController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Controllers/VendorController.cs</FILE>
        <FILE>src/Presentation/Nop.Web/Views/BackInStockSubscription/SubscribePopup.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Boards/Forum.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Boards/Topic.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Checkout/OnePageCheckout.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Product/_ProductReviewHelpfulness.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Shared/Components/EuCookieLaw/Default.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Shared/Components/NewsletterBox/Default.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/Views/Shared/_Poll.cshtml</FILE>
        <FILE>src/Presentation/Nop.Web/wwwroot/js/public.ajaxcart.js</FILE>
        <FILE>src/Presentation/Nop.Web/wwwroot/js/public.menu.js</FILE>
        <FILE>src/Presentation/Nop.Web/wwwroot/js/public.onepagecheckout.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
