<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4734</ISSUENO>
  <ISSUEURL>https://github.com/nopSolutions/nopCommerce/issues/4734</ISSUEURL>
  <TITLE>Issue in Order and reward point mapping</TITLE>
  <DESCRIPTION>Currently, Reward point and order's mapping available in order table by RewardPointsHistoryEntryId with Foreign key. And when reward point functionality is enable then customer two things can be done, - Customer earn reward point based on order total - Customer can use his awarded reward point for payment from payment method in checkout process So currently, when customer earning xx reward point by place order and spend his/her yy reward point, then yy reward point deduct from customer's account and that reward point history map in order table in RewardPointsHistoryEntryId column. Now on order is complete, customer should receive his/her xx reward point, but he/she not receiving this reward point due to there is already entry exist in RewardPointsHistoryEntryId column with that order. So here should be multiple mapping with Order and Reward Point history instead of a single relation. I hope I made it clear.</DESCRIPTION>
  <REPONAME>nopCommerce</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Removed unnecessary commented code</MESSAGE>
    <SHA>747f8d144a688cb58ba13001ac42b13dea9b5998</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>#4734 Fixed reward point mapping</MESSAGE>
      <SHA>1c4aada87236366b1080172fa86cdbea8b09648b</SHA>
      <PATCHEDFILES>
        <FILE>src/Libraries/Nop.Core/Domain/Customers/RewardPointsHistory.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/IRewardPointService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/OrderProcessingService.cs</FILE>
        <FILE>src/Libraries/Nop.Services/Orders/RewardPointService.cs</FILE>
        <FILE>upgradescripts/4.20-4.30 (under development)/upgrade.sql</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
