<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>18887</ISSUENO>
  <ISSUEURL>https://github.com/netbox-community/netbox/issues/18887</ISSUEURL>
  <TITLE>'VMInterface' object has no attribute 'get'</TITLE>
  <DESCRIPTION>### Deployment Type Self-hosted ### NetBox Version 4.2.2 ### Python Version 3.11 ### Steps to Reproduce I am trying to associate a VM interface to a prefix via custom field, using Pynetbox ```python new_prefix.custom_fields['workflow_associated_prefix_to_interface_mapping'] = nb_interface.id new_prefix.save() ``` This is the custom field ![Image](https://github.com/user-attachments/assets/5f52bba8-e55c-4c27-adc0-59d08a5866b5) If I comment out the custom_field statement, save is fine. I also tried saving via UI with the relationship, UI worked fine. ### Expected Behavior Saving works. ### Observed Behavior And I got this error ``` pynetbox.core.query.RequestError: The request failed with code 500 Internal Server Error: {'error': &quot;'VMInterface' object has no attribute 'get'&quot;, 'exception': 'AttributeError', 'netbox_version': '4.2.2', 'python_version': '3.11.2'} ``` It appears this is the line that threw the error: &lt;img width=&quot;1319&quot; alt=&quot;Image&quot; src=&quot;https://github.com/user-attachments/assets/4f99eb14-b4c7-40e2-bbe7-3307f28e11a0&quot; /&gt; ```python def validate(self, data): # Validate many-to-many VLAN assignments virtual_machine = self.instance.virtual_machine if self.instance else data.get('virtual_machine') &lt;----- for vlan in data.get('tagged_vlans', []): if vlan.site not in [virtual_machine.site, None]: raise serializers.ValidationError({ 'tagged_vlans': f&quot;VLAN {vlan} must belong to the same site as the interface's parent virtual &quot; f&quot;machine, or it must be global.&quot; }) ``` Somehow... data is already a VMInterface object</DESCRIPTION>
  <REPONAME>netbox</REPONAME>
  <TIMEDIFFERENCEDAYS>7</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fixes #18884: Handle tag assignments manually within deserialize_object (#18908)</MESSAGE>
    <SHA>f86647dc28d61d77a7f4f8fa946d880c75db6f50</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixes #18887: Allows VMInterface object custom field on Prefix</MESSAGE>
      <SHA>056772a41bc80d9051742a8cbed0f1bb98691822</SHA>
      <PATCHEDFILES>
        <FILE>netbox/virtualization/api/serializers_/virtualmachines.py</FILE>
        <FILE>netbox/virtualization/tests/test_api.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
