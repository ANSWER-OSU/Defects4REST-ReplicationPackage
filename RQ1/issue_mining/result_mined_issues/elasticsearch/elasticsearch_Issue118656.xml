<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>118656</ISSUENO>
  <ISSUEURL>https://github.com/elastic/elasticsearch/issues/118656</ISSUEURL>
  <TITLE>[CI] LogicalPlanOptimizerTests testPlanSanityCheckWithBinaryPlans failing</TITLE>
  <DESCRIPTION>**Build Scans:** - [elasticsearch-periodic #5372 / release-tests](https://gradle-enterprise.elastic.co/s/ghmjceijwpqbq) - [elasticsearch-pull-request #46533 / part-3](https://gradle-enterprise.elastic.co/s/msbxnfbbb35ie) - [elasticsearch-pull-request #46516 / part-3](https://gradle-enterprise.elastic.co/s/g5e6ivwzqh7ia) - [elasticsearch-pull-request #46523 / part-3](https://gradle-enterprise.elastic.co/s/tjwq7ryrba2s6) - [elasticsearch-pull-request #46524 / part-3](https://gradle-enterprise.elastic.co/s/lzfeovhllcizs) - [elasticsearch-pull-request #46516 / part-3](https://gradle-enterprise.elastic.co/s/lut4cbgecuqlw) - [elasticsearch-pull-request #46495 / part-3](https://gradle-enterprise.elastic.co/s/kwbuon5cl4b5u) - [elasticsearch-intake #14464 / part3](https://gradle-enterprise.elastic.co/s/ogfq7aox7s3lk) - [elasticsearch-intake #14462 / part3](https://gradle-enterprise.elastic.co/s/zzexr6zwpmqgk) - [elasticsearch-pull-request #46487 / release-tests](https://gradle-enterprise.elastic.co/s/amdztajyd5xbq) **Reproduction Line:** ``` ./gradlew &quot;:x-pack:plugin:esql:test&quot; --tests &quot;org.elasticsearch.xpack.esql.optimizer.LogicalPlanOptimizerTests.testPlanSanityCheckWithBinaryPlans&quot; -Dtests.seed=70C06520A4D85B86 -Dbuild.snapshot=false -Dtests.jvm.argline=&quot;-Dbuild.snapshot=false&quot; -Dlicense.key=x-pack/license-tools/src/test/resources/public.key -Dtests.locale=de -Dtests.timezone=America/Juneau -Druntime.java=23 ``` **Applicable branches:** 8.x **Reproduces locally?:** N/A **Failure History:** [See dashboard](https://es-delivery-stats.elastic.dev/app/dashboards#/view/dcec9e60-72ac-11ee-8f39-55975ded9e63?_g=(refreshInterval:(pause:!t,value:60000),time:(from:now-7d%2Fd,to:now))&amp;_a=(controlGroupState:(initialChildControlState:('0c0c9cb8-ccd2-45c6-9b13-96bac4abc542':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:task.keyword,order:0,selectedOptions:!(),title:'GradleTask',type:optionsListControl),'4e6ad9d6-6fdc-4fcc-bf1a-aa6ca79e0850':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:className.keyword,order:1,selectedOptions:!(org.elasticsearch.xpack.esql.optimizer.LogicalPlanOptimizerTests),title:'Suite',type:optionsListControl),'144933da-5c1b-4257-a969-7f43455a7901':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:name.keyword,order:2,selectedOptions:!(testPlanSanityCheckWithBinaryPlans),title:'Test',type:optionsListControl))))) **Failure Message:** ``` org.elasticsearch.xpack.esql.parser.ParsingException: line 3:3: mismatched input 'LOOKUP' expecting {'dissect', 'drop', 'enrich', 'eval', 'grok', 'keep', 'limit', 'mv_expand', 'rename', 'sort', 'stats', 'where'} ``` **Issue Reasons:** - [8.x] 2 consecutive failures in step release-tests - [8.x] 2 consecutive failures in step part-3-arm - [8.x] 33 failures in test testPlanSanityCheckWithBinaryPlans (58.9% fail rate in 56 executions) - [8.x] 2 failures in step release-tests (100.0% fail rate in 2 executions) - [8.x] 6 failures in step part3 (54.5% fail rate in 11 executions) - [8.x] 23 failures in step part-3 (69.7% fail rate in 33 executions) - [8.x] 2 failures in step part-3-arm (100.0% fail rate in 2 executions) - [8.x] 6 failures in pipeline elasticsearch-intake (54.5% fail rate in 11 executions) - [8.x] 20 failures in pipeline elasticsearch-pull-request (66.7% fail rate in 30 executions) **Note:** This issue was created using new test triage automation. Please report issues or feedback to es-delivery.</DESCRIPTION>
  <REPONAME>elasticsearch</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>ESQL: Support ST_EXTENT_AGG (#117451) This PR adds support for ST_EXTENT_AGG aggregation, i.e., computing a bounding box over a set of points/shapes (Cartesian or geo). Note the difference between this aggregation and the already implemented scalar function ST_EXTENT. This isn't a very efficient implementation, and future PRs will attempt to read these extents directly from the doc values. We currently always use longitude wrapping, i.e., we may wrap around the dateline for a smaller bounding box. Future PRs will let the user control this behavior. Fixes #104659.</MESSAGE>
    <SHA>2be4cd983fb13a2903ad61ea2c6212aa31e39364</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Mute org.elasticsearch.xpack.esql.optimizer.LogicalPlanOptimizerTests testPlanSanityCheckWithBinaryPlans #118656</MESSAGE>
      <SHA>48c892ceece16fd0f20bcda4659474d338b47842</SHA>
      <PATCHEDFILES>
        <FILE>muted-tests.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
