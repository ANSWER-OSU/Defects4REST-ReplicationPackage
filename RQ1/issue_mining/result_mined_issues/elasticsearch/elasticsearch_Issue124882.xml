<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>124882</ISSUENO>
  <ISSUEURL>https://github.com/elastic/elasticsearch/issues/124882</ISSUEURL>
  <TITLE>[CI] ExplainDataStreamLifecycleIT testExplainLifecycle failing</TITLE>
  <DESCRIPTION>**Build Scans:** - [elasticsearch-periodic #6992 / openjdk24_entitlements_false_checkpart1_java-matrix](https://gradle-enterprise.elastic.co/s/qbzuncf5jmeky) - [elasticsearch-pull-request #62635 / part-1](https://gradle-enterprise.elastic.co/s/65asfbkk6ohvo) - [elasticsearch-periodic-platform-support #7007 / almalinux-8-aarch64_checkpart1_platform-support-arm](https://gradle-enterprise.elastic.co/s/gpsw26mycnayi) **Reproduction Line:** ``` ./gradlew &quot;:modules:data-streams:internalClusterTest&quot; --tests &quot;org.elasticsearch.datastreams.lifecycle.ExplainDataStreamLifecycleIT.testExplainLifecycle&quot; -Dtests.seed=35C798498ADFFBFA -Dtests.jvm.argline=&quot;-Des.entitlements.enabled=false&quot; -Dtests.locale=lag-TZ -Dtests.timezone=US/Mountain -Druntime.java=24 ``` **Applicable branches:** main **Reproduces locally?:** N/A **Failure History:** [See dashboard](https://es-delivery-stats.elastic.dev/app/dashboards#/view/dcec9e60-72ac-11ee-8f39-55975ded9e63?_g=(refreshInterval:(pause:!t,value:60000),time:(from:now-7d%2Fd,to:now))&amp;_a=(controlGroupState:(initialChildControlState:('0c0c9cb8-ccd2-45c6-9b13-96bac4abc542':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:task.keyword,order:0,selectedOptions:!(),title:'GradleTask',type:optionsListControl),'4e6ad9d6-6fdc-4fcc-bf1a-aa6ca79e0850':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:className.keyword,order:1,selectedOptions:!(org.elasticsearch.datastreams.lifecycle.ExplainDataStreamLifecycleIT),title:'Suite',type:optionsListControl),'144933da-5c1b-4257-a969-7f43455a7901':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:name.keyword,order:2,selectedOptions:!(testExplainLifecycle),title:'Test',type:optionsListControl))))) **Failure Message:** ``` org.elasticsearch.index.IndexNotFoundException: no such index [.ds-metrics-foo-2025.03.14-000002] ``` **Issue Reasons:** - [main] 3 failures in test testExplainLifecycle (1.4% fail rate in 207 executions) **Note:** This issue was created using new test triage automation. Please report issues or feedback to es-delivery.</DESCRIPTION>
  <REPONAME>elasticsearch</REPONAME>
  <TIMEDIFFERENCEDAYS>11</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Restore V8 REST compatibility around highlight force_source parameter (#124873) While that was an approved breaking change, the change should have ensured v8 compatibility, so that under v8 compatibility mode the parameter is still accepted, but rejected in v9 compatibility mode (default). This commit ensures compatibility and adds a test for it.</MESSAGE>
    <SHA>6d914a2b8e7360e20801c96fbe932bf2e1228c3c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Mute org.elasticsearch.datastreams.lifecycle.ExplainDataStreamLifecycleIT testExplainLifecycle #124882</MESSAGE>
      <SHA>7023fe994e38b91783f88e828257ce538bed9f82</SHA>
      <PATCHEDFILES>
        <FILE>muted-tests.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix data stream retrieval in `ExplainDataStreamLifecycleIT` These tests had the potential to fail when two consecutive GET data streams requests would hit two different nodes, where one node already had the cluster state that contained the new backing index and the other node didn't yet. Caused by #122852 Fixes #124882 Fixes #124885</MESSAGE>
      <SHA>99e2268e0359ba51be85ef74ef9d52b931d9623d</SHA>
      <PATCHEDFILES>
        <FILE>modules/data-streams/src/internalClusterTest/java/org/elasticsearch/datastreams/lifecycle/ExplainDataStreamLifecycleIT.java</FILE>
        <FILE>muted-tests.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix data stream retrieval in `ExplainDataStreamLifecycleIT` (#125611) These tests had the potential to fail when two consecutive GET data streams requests would hit two different nodes, where one node already had the cluster state that contained the new backing index and the other node didn't yet. Caused by #122852 Fixes #124882 Fixes #124885</MESSAGE>
      <SHA>8b691db4367bf4556cd250fab8becde37fd53d09</SHA>
      <PATCHEDFILES>
        <FILE>modules/data-streams/src/internalClusterTest/java/org/elasticsearch/datastreams/lifecycle/ExplainDataStreamLifecycleIT.java</FILE>
        <FILE>muted-tests.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix data stream retrieval in `ExplainDataStreamLifecycleIT` (#125611) These tests had the potential to fail when two consecutive GET data streams requests would hit two different nodes, where one node already had the cluster state that contained the new backing index and the other node didn't yet. Caused by #122852 Fixes #124882 Fixes #124885</MESSAGE>
      <SHA>014f5ef069ee83a6b4d7f2d28c235f14324037a4</SHA>
      <PATCHEDFILES>
        <FILE>modules/data-streams/src/internalClusterTest/java/org/elasticsearch/datastreams/lifecycle/ExplainDataStreamLifecycleIT.java</FILE>
        <FILE>muted-tests.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
