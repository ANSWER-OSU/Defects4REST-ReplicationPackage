<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>119720</ISSUENO>
  <ISSUEURL>https://github.com/elastic/elasticsearch/issues/119720</ISSUEURL>
  <TITLE>[CI] LocalPhysicalPlanOptimizerTests testSingleMatchFunctionFilterPushdownWithStringValues {default} failing</TITLE>
  <DESCRIPTION>**Build Scans:** - [elasticsearch-periodic #5770 / release-tests](https://gradle-enterprise.elastic.co/s/d74gfgg4lggas) - [elasticsearch-periodic #5765 / release-tests](https://gradle-enterprise.elastic.co/s/dqcgblx23jd7m) - [elasticsearch-periodic #5760 / release-tests](https://gradle-enterprise.elastic.co/s/htpzwsjd7wbby) - [elasticsearch-periodic #5755 / release-tests](https://gradle-enterprise.elastic.co/s/xn5arlbpid752) - [elasticsearch-periodic #5750 / release-tests](https://gradle-enterprise.elastic.co/s/7fzxvwmzt7osi) **Reproduction Line:** ``` ./gradlew &quot;:x-pack:plugin:esql:test&quot; --tests &quot;org.elasticsearch.xpack.esql.optimizer.LocalPhysicalPlanOptimizerTests.testSingleMatchFunctionPushdownWithCasting {default}&quot; -Dtests.seed=7177444548A089EF -Dbuild.snapshot=false -Dtests.jvm.argline=&quot;-Dbuild.snapshot=false&quot; -Dlicense.key=x-pack/license-tools/src/test/resources/public.key -Dtests.locale=en-TV -Dtests.timezone=Indian/Cocos -Druntime.java=23 ``` **Applicable branches:** 8.x **Reproduces locally?:** N/A **Failure History:** [See dashboard](https://es-delivery-stats.elastic.dev/app/dashboards#/view/dcec9e60-72ac-11ee-8f39-55975ded9e63?_g=(refreshInterval:(pause:!t,value:60000),time:(from:now-7d%2Fd,to:now))&amp;_a=(controlGroupState:(initialChildControlState:('0c0c9cb8-ccd2-45c6-9b13-96bac4abc542':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:task.keyword,order:0,selectedOptions:!(),title:'GradleTask',type:optionsListControl),'4e6ad9d6-6fdc-4fcc-bf1a-aa6ca79e0850':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:className.keyword,order:1,selectedOptions:!(org.elasticsearch.xpack.esql.optimizer.LocalPhysicalPlanOptimizerTests),title:'Suite',type:optionsListControl),'144933da-5c1b-4257-a969-7f43455a7901':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:name.keyword,order:2,selectedOptions:!(testSingleMatchFunctionFilterPushdownWithStringValues%20%7Bdefault%7D),title:'Test',type:optionsListControl))))) **Failure Message:** ``` org.elasticsearch.xpack.esql.VerificationException: Found 1 problem line 1:25: Cannot use field [semantic_text] with unsupported type [semantic_text] ``` **Issue Reasons:** - [8.x] 5 failures in test testSingleMatchFunctionFilterPushdownWithStringValues {default} (2.0% fail rate in 248 executions) - [8.x] 5 failures in step release-tests (71.4% fail rate in 7 executions) - [8.x] 5 failures in pipeline elasticsearch-periodic (100.0% fail rate in 5 executions) **Note:** This issue was created using new test triage automation. Please report issues or feedback to es-delivery.</DESCRIPTION>
  <REPONAME>elasticsearch</REPONAME>
  <TIMEDIFFERENCEDAYS>9</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>ESQL: Speed type error testing (#119678) This shaves a few minutes off of the ESQL build: ``` 14m 50s -&gt; 12m 38s ``` It does so by moving the type error testing from parameterized tests to a single, stand alone test per scalar that checks the errors for all unsupported types. It gets the list from the parameterized tests the same way as we were doing. But it's *fast*. AND, this will let us test a huge number of combinations without nearly as much overhead as we had before. In the worse case, unary math functions, this doesn't save any time. Maybe .1 second per function. For binary math functions it saves a *little* time. About a second per function. But for non-math, multivalued functions: wow. IpPrefix is ternary and it's test goes from 56.8 seconds to 2.6 seconds! Here are a few examples. | name | before | after | before| after | | -----------------: | -----: | -----------: | ----: | ----: | | Sin | 2.6s | 2.5s | 400 | 291 | | ATan2 | 17.4s | 16.1s | 8270 | 5961 | | IpPrefix | 56.8s | :tada: 2.6s | 40650 | 191 | | Equals | 69.9s | 50.6s | 30130 | 28131 | | NotEquals | 67.1s | 46.8s | 30100 | 28101 | | GreaterThan | 63.7s | 57.8s | 29940 | 27791 | | GreaterThanOrEqual | 61.1s | 61.6s | 29940 | 27791 | | LessThan | 63.7s | 61.3s | 29940 | 27791 | | LessThanOrEqual | 61.1s | 59.8s | 29940 | 27791 | | Case | 115.3s | :tada: 45.1s | 63756 | 13236 | | DateDiff | 3.4s | 4.0s?| 507 | 271 | | DateExtract | 12.1s | 3.4s | 3406 | 156 | | DateFormat | 8.1s | 2.4s | 2849 | 100 | | DateParse | 10.6s | 2.8s | 2992 | 276 | | DateTrunc | 10.9s | 3.4s | 3320 | 790 | | ByteLength | 5.7s | 4.0s | 520 | 391 | | EndsWith | 13.7s | 7.2s | 3880 | 1411 | | Hash | 30.7s | 17.4s | 3980 | 1511 | | LTrim | 27.1s | 29.0s?| 2840 | 2711| | Locate | 85.3s | :tada: 10.3s | 44310 | 1461 | | Replace | 96.5s | :tada: 10.1s | 42010 | 1711 | | RTrim | 15.6s | 20.0s?| 2840 | 2711 | | Split | 6.6s | 4.0s | 3360 | 397 | | StartsWith | 5.5s | :tada: 0.7s | 2800 | 330 | | Substring | 115.2s | :tada: 2.7s | 85386 | 483 | | Trim | 17.4s | 17.8s | 2840 | 2710 | Gradle Enterprise is also not happy with the raw *number* of tests ESQL runs. So lowering the overall number is important. See the table above. This strategy is *super* effective for that. It takes us ``` 769459 -&gt; 470429 ```</MESSAGE>
    <SHA>f0996583e9daf91bd5a2f03d355fce2ae5fc6698</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Mute org.elasticsearch.xpack.esql.optimizer.LocalPhysicalPlanOptimizerTests testSingleMatchFunctionFilterPushdownWithStringValues {default} #119720</MESSAGE>
      <SHA>8b35fdd08f663d72d784f38798e48780d4e90383</SHA>
      <PATCHEDFILES>
        <FILE>muted-tests.yml</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
