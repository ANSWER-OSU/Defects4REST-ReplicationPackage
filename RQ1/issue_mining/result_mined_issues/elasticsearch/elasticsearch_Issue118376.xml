<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>118376</ISSUENO>
  <ISSUEURL>https://github.com/elastic/elasticsearch/issues/118376</ISSUEURL>
  <TITLE>ReindexDataStreamTransportActionIT tests broken in release mode</TITLE>
  <DESCRIPTION>### CI Link https://gradle-enterprise.elastic.co/s/v5gfwkz2odyg2/tests/task/:x-pack:plugin:migrate:internalClusterTest/details/org.elasticsearch.xpack.migrate.action.ReindexDataStreamTransportActionIT?top-execution=1 ### Repro line ./gradlew &quot;:x-pack:plugin:migrate:internalClusterTest&quot; --tests &quot;org.elasticsearch.xpack.migrate.action.ReindexDataStreamTransportActionIT&quot; -Dtests.seed=77F1BE6B5E97B40 -Dbuild.snapshot=false -Dtests.jvm.argline=&quot;-Dbuild.snapshot=false&quot; -Dlicense.key=x-pack/license-tools/src/test/resources/public.key -Dtests.locale=ko -Dtests.timezone=NST -Druntime.java=23 ### Does it reproduce? Yes ### Applicable branches main ### Failure history _No response_ ### Failure excerpt `testAlreadyUpToDateDataStream` fails with: ``` java.lang.IllegalStateException: failed to find action [indices:admin/data_stream/reindex] to execute ``` `testNonExistentDataStream` fails with: ``` java.lang.AssertionError: unexpected exception type thrown; expected:&lt;org.elasticsearch.ResourceNotFoundException&gt; but was:&lt;java.lang.IllegalStateException&gt; ```</DESCRIPTION>
  <REPONAME>elasticsearch</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>[8.x] Adding get migration reindex status (#118267) (#118361) * Adding get migration reindex status (#118267) This adds a new transport action to get the status of a migration reindex (started via the API at #118109), and a new rest action to use it. The rest action accepts the data stream or index name, and returns the status. For example if the reindex task exists for data stream `my-data-stream`: ``` GET /_migration/reindex/my-data-stream/_status?pretty ``` returns ``` { &quot;start_time&quot; : 1733519098570, &quot;complete&quot; : true, &quot;total_indices&quot; : 1, &quot;total_indices_requiring_upgrade&quot; : 0, &quot;successes&quot; : 0, &quot;in_progress&quot; : 0, &quot;pending&quot; : 0, &quot;errors&quot; : [ ] } ``` If a reindex task does not exist: ``` GET _migration/reindex/my-data-stream/_status?pretty ``` Then a 404 is returned: ``` { &quot;error&quot; : { &quot;root_cause&quot; : [ { &quot;type&quot; : &quot;resource_not_found_exception&quot;, &quot;reason&quot; : &quot;No migration reindex status found for [my-data-stream]&quot; } ], &quot;type&quot; : &quot;resource_not_found_exception&quot;, &quot;reason&quot; : &quot;No migration reindex status found for [my-data-stream]&quot; }, &quot;status&quot; : 404 } ``` * adding migration reindex actions to OperatorPrivilegesIT</MESSAGE>
    <SHA>04d01fee60456774e9e7b96f1581c77b3af089b9</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Disabling ReindexDataStreamTransportActionIT in release mode (#118377) The actions in the migrate plugin are currently behind a feature flag. This disables the integration test for them if the flag is not set. Closes #118376</MESSAGE>
      <SHA>81ade8533ef9ac3ecf81760cfd0c3c838ad93b1f</SHA>
      <PATCHEDFILES>
        <FILE>x-pack/plugin/migrate/src/internalClusterTest/java/org/elasticsearch/xpack/migrate/action/ReindexDataStreamTransportActionIT.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Disabling ReindexDataStreamTransportActionIT in release mode (#118377) The actions in the migrate plugin are currently behind a feature flag. This disables the integration test for them if the flag is not set. Closes #118376</MESSAGE>
      <SHA>5406850abf7a83e8078001dc7d81081fa6e77bc8</SHA>
      <PATCHEDFILES>
        <FILE>x-pack/plugin/migrate/src/internalClusterTest/java/org/elasticsearch/xpack/migrate/action/ReindexDataStreamTransportActionIT.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Disabling ReindexDataStreamTransportActionIT in release mode (#118377) (#118384) The actions in the migrate plugin are currently behind a feature flag. This disables the integration test for them if the flag is not set. Closes #118376</MESSAGE>
      <SHA>0bd64ea455389f27f87ba040c9090ec29c604e09</SHA>
      <PATCHEDFILES>
        <FILE>x-pack/plugin/migrate/src/internalClusterTest/java/org/elasticsearch/xpack/migrate/action/ReindexDataStreamTransportActionIT.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
