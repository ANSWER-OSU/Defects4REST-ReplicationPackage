<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>120094</ISSUENO>
  <ISSUEURL>https://github.com/elastic/elasticsearch/issues/120094</ISSUEURL>
  <TITLE>ESQL: support for buckets larger than 1 year</TITLE>
  <DESCRIPTION>### Description Currently, when BUCKETing, the time interval expressed in years cannot be larger than 1. However, specifying the interval in weeks allows for an arbitrary number. This issue is to look into removing the year restriction (or any other seemingly arbitrary ones)</DESCRIPTION>
  <REPONAME>elasticsearch</REPONAME>
  <TIMEDIFFERENCEDAYS>79</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Mute org.elasticsearch.xpack.security.SecurityRolesMultiProjectIT testUpdatingFileBasedRoleAffectsAllProjects #126223</MESSAGE>
    <SHA>44a74f9fec6e4467d8313c7f1c8080cb9913d952</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>ESQL: Enhanced `DATE_TRUNC` with arbitrary intervals (#120302) Originally, `DATE_TRUNC` only supported 1-month and 3-month intervals for months, and 1-year interval for years, while arbitrary intervals were supported for weeks and days. This PR adds support for `DATE_TRUNC` with arbitrary month and year intervals. Closes #120094</MESSAGE>
      <SHA>30b2a1f72960b9d8734034dc97c4015a79976d82</SHA>
      <PATCHEDFILES>
        <FILE>docs/changelog/120302.yaml</FILE>
        <FILE>docs/reference/query-languages/esql/_snippets/functions/description/date_trunc.md</FILE>
        <FILE>docs/reference/query-languages/esql/_snippets/functions/examples/bucket.md</FILE>
        <FILE>docs/reference/query-languages/esql/kibana/definition/functions/date_trunc.json</FILE>
        <FILE>docs/reference/query-languages/esql/kibana/docs/functions/date_trunc.md</FILE>
        <FILE>server/src/main/java/org/elasticsearch/common/Rounding.java</FILE>
        <FILE>server/src/main/java/org/elasticsearch/common/time/DateUtils.java</FILE>
        <FILE>server/src/test/java/org/elasticsearch/common/time/DateUtilsTests.java</FILE>
        <FILE>x-pack/plugin/esql/qa/testFixtures/src/main/resources/bucket.csv-spec</FILE>
        <FILE>x-pack/plugin/esql/qa/testFixtures/src/main/resources/date.csv-spec</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/action/EsqlCapabilities.java</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/grouping/Bucket.java</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DateTrunc.java</FILE>
        <FILE>x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DateTruncRoundingTests.java</FILE>
        <FILE>x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DateTruncTests.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>ESQL: Enhanced `DATE_TRUNC` with arbitrary intervals (#120302) Originally, `DATE_TRUNC` only supported 1-month and 3-month intervals for months, and 1-year interval for years, while arbitrary intervals were supported for weeks and days. This PR adds support for `DATE_TRUNC` with arbitrary month and year intervals. Closes #120094</MESSAGE>
      <SHA>a92e5aef2b4f2bff7213f6d92cf6f0893227887c</SHA>
      <PATCHEDFILES>
        <FILE>docs/changelog/120302.yaml</FILE>
        <FILE>docs/reference/query-languages/esql/_snippets/functions/description/date_trunc.md</FILE>
        <FILE>docs/reference/query-languages/esql/_snippets/functions/examples/bucket.md</FILE>
        <FILE>docs/reference/query-languages/esql/kibana/definition/functions/date_trunc.json</FILE>
        <FILE>docs/reference/query-languages/esql/kibana/docs/functions/date_trunc.md</FILE>
        <FILE>server/src/main/java/org/elasticsearch/common/Rounding.java</FILE>
        <FILE>server/src/main/java/org/elasticsearch/common/time/DateUtils.java</FILE>
        <FILE>server/src/test/java/org/elasticsearch/common/time/DateUtilsTests.java</FILE>
        <FILE>x-pack/plugin/esql/qa/testFixtures/src/main/resources/bucket.csv-spec</FILE>
        <FILE>x-pack/plugin/esql/qa/testFixtures/src/main/resources/date.csv-spec</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/action/EsqlCapabilities.java</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/grouping/Bucket.java</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DateTrunc.java</FILE>
        <FILE>x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DateTruncRoundingTests.java</FILE>
        <FILE>x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DateTruncTests.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
