<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>118031</ISSUENO>
  <ISSUEURL>https://github.com/elastic/elasticsearch/issues/118031</ISSUEURL>
  <TITLE>[ESQL] Support date nanos on Bucket function</TITLE>
  <DESCRIPTION>Support bucket function on date nanos type. Bucket is just wrapping date trunc here, which we added support for in https://github.com/elastic/elasticsearch/issues/110008, so this should be a pretty small change.</DESCRIPTION>
  <REPONAME>elasticsearch</REPONAME>
  <TIMEDIFFERENCEDAYS>8</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Mute org.elasticsearch.xpack.esql.qa.mixed.MixedClusterEsqlSpecIT test {stats.ByDateAndKeywordAndIntWithAlias SYNC} #118668</MESSAGE>
    <SHA>b1f6311f302d5023db19c9bcfdf2b57da2f77da3</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Esql bucket function for date nanos (#118474) This adds support for running the bucket function over a date nanos field. Code wise, this just delegates to DateTrunc, which already supports date nanos, so most of the PR is just tests and the auto-generated docs. Resolves #118031</MESSAGE>
      <SHA>82946f8cf6deb73455e8f7e06bda8ccd2ada5923</SHA>
      <PATCHEDFILES>
        <FILE>docs/changelog/118474.yaml</FILE>
        <FILE>docs/reference/esql/functions/kibana/definition/bucket.json</FILE>
        <FILE>docs/reference/esql/functions/types/bucket.asciidoc</FILE>
        <FILE>x-pack/plugin/esql/qa/testFixtures/src/main/resources/date_nanos.csv-spec</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/action/EsqlCapabilities.java</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/grouping/Bucket.java</FILE>
        <FILE>x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/grouping/BucketTests.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Esql bucket function for date nanos (#118474) This adds support for running the bucket function over a date nanos field. Code wise, this just delegates to DateTrunc, which already supports date nanos, so most of the PR is just tests and the auto-generated docs. Resolves #118031</MESSAGE>
      <SHA>1e26791515184a965444ea45a300691d17cffb8d</SHA>
      <PATCHEDFILES>
        <FILE>docs/changelog/118474.yaml</FILE>
        <FILE>docs/reference/esql/functions/kibana/definition/bucket.json</FILE>
        <FILE>docs/reference/esql/functions/types/bucket.asciidoc</FILE>
        <FILE>x-pack/plugin/esql/qa/testFixtures/src/main/resources/date_nanos.csv-spec</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/action/EsqlCapabilities.java</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/grouping/Bucket.java</FILE>
        <FILE>x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/grouping/BucketTests.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Esql bucket function for date nanos (#118474) (#118670) This adds support for running the bucket function over a date nanos field. Code wise, this just delegates to DateTrunc, which already supports date nanos, so most of the PR is just tests and the auto-generated docs. Resolves #118031</MESSAGE>
      <SHA>9166cd8d37e5ce23c15cd09b0b6d39b251602e0c</SHA>
      <PATCHEDFILES>
        <FILE>docs/changelog/118474.yaml</FILE>
        <FILE>docs/reference/esql/functions/kibana/definition/bucket.json</FILE>
        <FILE>docs/reference/esql/functions/types/bucket.asciidoc</FILE>
        <FILE>x-pack/plugin/esql/qa/testFixtures/src/main/resources/date_nanos.csv-spec</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/action/EsqlCapabilities.java</FILE>
        <FILE>x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/grouping/Bucket.java</FILE>
        <FILE>x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/grouping/BucketTests.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
