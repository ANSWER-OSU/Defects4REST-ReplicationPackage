<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>120</ISSUENO>
  <ISSUEURL>https://github.com/snarfed/granary/issues/120</ISSUEURL>
  <TITLE>Instagram to HTML conversion should drop the &lt;img&gt; tag in the content</TITLE>
  <DESCRIPTION>Right now each instagram image appears twice in the HTML output. Once inside the e-content element, and again outside with the `u-photo` class. It's enough to have it outside the content with the `u-photo` class since that will make it appear as the `photo` property to mf2 consumers.</DESCRIPTION>
  <REPONAME>granary</REPONAME>
  <TIMEDIFFERENCEDAYS>3</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>mf2 to html: de-dupe image and attachments fixes #120...but by dropping the &lt;img&gt; *outside* content, not the one inside as requested. that may still be the right long term answer, but right now it's reused as atom content, and we're still debating whether we want to move that to an enclosure in #113 and snarfed/instagram-atom#3. reader support seems unclear at best.</MESSAGE>
    <SHA>1191e5afe3b8e4703329d77ac7eeca368313c8b5</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>mf2 to html: de-dupe image and attachments, take 2 skip rendering attachments in json_to_html, not render_content, since we want them in content. still for #120.</MESSAGE>
      <SHA>2b7197a3b08e0c295c210f7b058817bd7ff97ce6</SHA>
      <PATCHEDFILES>
        <FILE>granary/microformats2.py</FILE>
        <FILE>granary/test/testdata/article_with_image_duplicated_as_attachment.mf2.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>mf2 to html: de-dupe image and attachments, take 3 move choice of whether to render attachments back to render_content, as caller param. default to false. override in atom. still for #120.</MESSAGE>
      <SHA>1d4d323206be0149795409998717a497ca9d609d</SHA>
      <PATCHEDFILES>
        <FILE>granary/atom.py</FILE>
        <FILE>granary/microformats2.py</FILE>
        <FILE>granary/test/test_microformats2.py</FILE>
        <FILE>granary/test/testdata/article_with_image_duplicated_as_attachment.mf2.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
