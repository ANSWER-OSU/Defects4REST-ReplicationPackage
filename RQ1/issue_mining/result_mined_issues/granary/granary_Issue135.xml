<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>135</ISSUENO>
  <ISSUEURL>https://github.com/snarfed/granary/issues/135</ISSUEURL>
  <TITLE>possible cache leak</TITLE>
  <DESCRIPTION>granary serves some feeds that are moderately high traffic, e.g. @aaronpk's and @gregorlove's (hi!), so it currently caches responses for 5m to avoid hammering their sites. @aaronpk noticed a possible cache leak: he tried a twitter search for one query, then another, and got the same results as the first. maybe we're excluding search query from the cache key? seems unlikely since we cache the full url, but still.</DESCRIPTION>
  <REPONAME>granary</REPONAME>
  <TIMEDIFFERENCEDAYS>6</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix cache bug that accidentally leaked private items across requests :( fixes #135. bug was that the cache key didn't include query params. wtf was i thinking. :(:(:(</MESSAGE>
    <SHA>21c33262503489f525f4f14e9abb136c2adb1ae8</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>app and API: switch caching to use webutil's @memcache_response for #135</MESSAGE>
      <SHA>11c87db2f8fbf22b22791d839e096696f54ca0c6</SHA>
      <PATCHEDFILES>
        <FILE>api.py</FILE>
        <FILE>app.py</FILE>
        <FILE>granary/instagram.py</FILE>
        <FILE>granary/source.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
