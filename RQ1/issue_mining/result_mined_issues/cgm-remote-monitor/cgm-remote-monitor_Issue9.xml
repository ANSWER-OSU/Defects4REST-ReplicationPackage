<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>9</ISSUENO>
  <ISSUEURL>https://github.com/nightscout/cgm-remote-monitor/issues/9</ISSUEURL>
  <TITLE>/lib/pebble.js</TITLE>
  <DESCRIPTION>Hey there - as I look to modify the cgm-pebble community code for the trend arrow, I started with input from cgm-remote-monitor /lib/pebble.js. A couple of questions to make sure I'm tracking things correctly before I start mod'ing code. 1. The db query for the collection pulls the last 10, but the output via pebble.js is explicitly cgmData.slice(0,6). I am assuming this is for performance to limit the amount of data pulled and processed. Can you confirm? 2. The JS file defines 40 minutes in milliseconds (2400000), but then in the function multiples by 5. So it could go back 200 minutes. But if the output is limited to 6, can you help me understand why the 40 minutes much less the 200 minutes? Could simply be moving parts, but I want to ensure I'm not missing a subtle data control. 3. The file has DIRECTIONS defined [0-9]. Do people have a preference for determining trend? The simplest is to take (now) - (last) / array length. But since you're already looping for direction, I could take the sum of each &quot;direction&quot; and average, and then round. A final model would be to simply show the &quot;direction&quot; for the last BG. Personally, I think the trend needs to be the average to account for ups and downs, but since the direction is already calculated in this file per BG, that may have been the thinking to date. ?? 4. I noticed that when things are forecasted, my dexcom-uploader registers &quot;10&quot; as the BG rather than &quot;???&quot; from my Dexcom. Not having read through Dexcom-uploader yet, are there any business logic rules that need to be accounted for? For example, if &quot;now&quot; is BG 10, then stop b/c the data is bad. Or, if slice 3 is BG 10, then stop the averaging there? Likewise, it looks like direction value 8 and 9 would be cases for exception processing. 5. Rather than having the pebble watch face JS calculate the overall trend, I'm thinking about extending the /lib/pebble.js response to include that after the BGs -- let the appservers do the processing, pass the single value, and let cgm-pebble display. I started with the mindset of modifying the cgm-pebble codebase for everything, but tonight I'm viewing &quot;cgm-pebble&quot; like the View of MVC whereas &quot;cgm-remote-monitor&quot; is the Control in relation to pebble. Thanks for your thoughts! - Greg (greg@waehner.com)</DESCRIPTION>
  <REPONAME>cgm-remote-monitor</REPONAME>
  <TIMEDIFFERENCEDAYS>165</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Update README.md</MESSAGE>
    <SHA>cc2d85d7cfd65be6ba43e0bdb20b15d0f6546328</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #9 from nightscout/feature/base-api Feature/base api</MESSAGE>
      <SHA>7dd24ccc215a6b02dd43fca43813650287c731b8</SHA>
      <PATCHEDFILES>
        <FILE>lib/api.js</FILE>
        <FILE>package.json</FILE>
        <FILE>server.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9 from nightscout/dev Dev</MESSAGE>
      <SHA>aff5f279451716fc7b25060c225b96736bedac05</SHA>
      <PATCHEDFILES>
        <FILE>.nvmrc</FILE>
        <FILE>.travis.yml</FILE>
        <FILE>Dockerfile.example</FILE>
        <FILE>bower.json</FILE>
        <FILE>lib/client/renderer.js</FILE>
        <FILE>lib/language.js</FILE>
        <FILE>lib/plugins/bgnow.js</FILE>
        <FILE>lib/plugins/loop.js</FILE>
        <FILE>lib/profilefunctions.js</FILE>
        <FILE>lib/report_plugins/daytoday.js</FILE>
        <FILE>lib/report_plugins/glucosedistribution.js</FILE>
        <FILE>lib/sandbox.js</FILE>
        <FILE>npm-shrinkwrap.json</FILE>
        <FILE>package.json</FILE>
        <FILE>static/profile/js/profileeditor.js</FILE>
        <FILE>static/report/js/report.js</FILE>
        <FILE>tests/loop.test.js</FILE>
        <FILE>views/bgclock.html</FILE>
        <FILE>views/index.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9 from inventor96/update-virtual-assistants-v2 Update virtual assistants v2</MESSAGE>
      <SHA>bde4750b0e152d4abd5b111a606b7e2cf979f4fa</SHA>
      <PATCHEDFILES>
        <FILE>CONTRIBUTING.md</FILE>
        <FILE>README.md</FILE>
        <FILE>docs/plugins/add-virtual-assistant-support-to-plugin.md</FILE>
        <FILE>docs/plugins/alexa-plugin.md</FILE>
        <FILE>docs/plugins/alexa-templates/en-us.json</FILE>
        <FILE>docs/plugins/google-home-templates/en-us.zip</FILE>
        <FILE>docs/plugins/googlehome-plugin.md</FILE>
        <FILE>docs/plugins/interacting-with-virtual-assistants.md</FILE>
        <FILE>lib/api/alexa/index.js</FILE>
        <FILE>lib/api/googlehome/index.js</FILE>
        <FILE>lib/api/index.js</FILE>
        <FILE>lib/language.js</FILE>
        <FILE>lib/plugins/alexa.js</FILE>
        <FILE>lib/plugins/ar2.js</FILE>
        <FILE>lib/plugins/basalprofile.js</FILE>
        <FILE>lib/plugins/cob.js</FILE>
        <FILE>lib/plugins/googlehome.js</FILE>
        <FILE>lib/plugins/iob.js</FILE>
        <FILE>lib/plugins/loop.js</FILE>
        <FILE>lib/plugins/openaps.js</FILE>
        <FILE>lib/plugins/pump.js</FILE>
        <FILE>lib/plugins/rawbg.js</FILE>
        <FILE>lib/plugins/upbat.js</FILE>
        <FILE>lib/server/bootevent.js</FILE>
        <FILE>tests/ar2.test.js</FILE>
        <FILE>tests/basalprofileplugin.test.js</FILE>
        <FILE>tests/cob.test.js</FILE>
        <FILE>tests/iob.test.js</FILE>
        <FILE>tests/loop.test.js</FILE>
        <FILE>tests/openaps.test.js</FILE>
        <FILE>tests/pump.test.js</FILE>
        <FILE>tests/rawbg.test.js</FILE>
        <FILE>tests/upbat.test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9 from nightscout/master Release 14.0.4 Liquorice</MESSAGE>
      <SHA>3d5afccc096d90e271ed3a8fef8a9febd39e9828</SHA>
      <PATCHEDFILES>
        <FILE>lib/api/devicestatus/index.js</FILE>
        <FILE>lib/api/entries/index.js</FILE>
        <FILE>lib/api/treatments/index.js</FILE>
        <FILE>lib/client/careportal.js</FILE>
        <FILE>lib/constants.json</FILE>
        <FILE>lib/data/dataloader.js</FILE>
        <FILE>lib/data/ddata.js</FILE>
        <FILE>lib/server/bootevent.js</FILE>
        <FILE>lib/server/cache.js</FILE>
        <FILE>lib/server/devicestatus.js</FILE>
        <FILE>lib/server/entries.js</FILE>
        <FILE>lib/server/treatments.js</FILE>
        <FILE>lib/server/websocket.js</FILE>
        <FILE>npm-shrinkwrap.json</FILE>
        <FILE>package.json</FILE>
        <FILE>swagger.json</FILE>
        <FILE>swagger.yaml</FILE>
        <FILE>tests/api.treatments.test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9 from dwyl/letsencrypt-temporary-server How to Renew Let's Encrypt SSL Certificate</MESSAGE>
      <SHA>49bf2331fa458b789530ea13e4e9ee8b3ebf2f13</SHA>
      <PATCHEDFILES>
        <FILE>.well-known/acme-challenge/BPgVqxFMZAg29d7KfHwS2xGvRa79EKblxgWDn_44_N0</FILE>
        <FILE>.well-known/acme-challenge/_-SyF07cuWWE6OgqWRRq-QCWDfG2NOxqm_U5gT-7L8A</FILE>
        <FILE>SSL-certificate-step-by-step-setup-instructions.md</FILE>
        <FILE>index.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9 from sebdei/Indentation-fix Indentation fix</MESSAGE>
      <SHA>fd92712f47dfacfaa5cc52bea3a2f1530e14915c</SHA>
      <PATCHEDFILES>
        <FILE>index.js</FILE>
        <FILE>nightscoutTrendArrows.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9 from nightscout/master My Cloud TD1</MESSAGE>
      <SHA>e743fea7542dd0ed675883d5f022e58b53e669df</SHA>
      <PATCHEDFILES>
        <FILE>.github/ISSUE_TEMPLATE/--bug-report.md</FILE>
        <FILE>.github/ISSUE_TEMPLATE/--feature-request--.md</FILE>
        <FILE>.github/ISSUE_TEMPLATE/--individual-troubleshooting-help.md</FILE>
        <FILE>.github/workflows/main.yml</FILE>
        <FILE>CONTRIBUTING.md</FILE>
        <FILE>README.md</FILE>
        <FILE>app.js</FILE>
        <FILE>app.json</FILE>
        <FILE>assets/fonts/Nightscout Plugin Icons.json</FILE>
        <FILE>assets/fonts/README.md</FILE>
        <FILE>azuredeploy.json</FILE>
        <FILE>bundle/bundle.reports.source.js</FILE>
        <FILE>bundle/bundle.source.js</FILE>
        <FILE>ci.test.env</FILE>
        <FILE>docs/plugins/alexa-plugin.md</FILE>
        <FILE>docs/plugins/alexa-templates/en-us.json</FILE>
        <FILE>docs/plugins/google-home-templates/en-us.zip</FILE>
        <FILE>docs/plugins/googlehome-plugin.md</FILE>
        <FILE>docs/plugins/interacting-with-virtual-assistants.md</FILE>
        <FILE>env.js</FILE>
        <FILE>lib/api/activity/index.js</FILE>
        <FILE>lib/api/alexa/index.js</FILE>
        <FILE>lib/api/devicestatus/index.js</FILE>
        <FILE>lib/api/entries/index.js</FILE>
        <FILE>lib/api/googlehome/index.js</FILE>
        <FILE>lib/api/profile/index.js</FILE>
        <FILE>lib/api/properties.js</FILE>
        <FILE>lib/api/status.js</FILE>
        <FILE>lib/api/treatments/index.js</FILE>
        <FILE>lib/api3/const.json</FILE>
        <FILE>lib/api3/doc/formats.md</FILE>
        <FILE>lib/api3/generic/create/insert.js</FILE>
        <FILE>lib/api3/generic/history/operation.js</FILE>
        <FILE>lib/api3/generic/read/operation.js</FILE>
        <FILE>lib/api3/generic/search/operation.js</FILE>
        <FILE>lib/api3/generic/update/replace.js</FILE>
        <FILE>lib/api3/index.js</FILE>
        <FILE>lib/api3/shared/renderer.js</FILE>
        <FILE>lib/api3/swagger.js</FILE>
        <FILE>lib/api3/swagger.yaml</FILE>
        <FILE>lib/authorization/index.js</FILE>
        <FILE>lib/authorization/storage.js</FILE>
        <FILE>lib/bus.js</FILE>
        <FILE>lib/client/browser-settings.js</FILE>
        <FILE>lib/client/browser-utils.js</FILE>
        <FILE>lib/client/careportal.js</FILE>
        <FILE>lib/client/chart.js</FILE>
        <FILE>lib/client/clock-client.js</FILE>
        <FILE>lib/client/d3locales.js</FILE>
        <FILE>lib/client/index.js</FILE>
        <FILE>lib/client/receiveddata.js</FILE>
        <FILE>lib/client/renderer.js</FILE>
        <FILE>lib/constants.json</FILE>
        <FILE>lib/data/calcdelta.js</FILE>
        <FILE>lib/data/dataloader.js</FILE>
        <FILE>lib/data/ddata.js</FILE>
        <FILE>lib/data/treatmenttocurve.js</FILE>
        <FILE>lib/language.js</FILE>
        <FILE>lib/middleware/express-extension-to-accept.js</FILE>
        <FILE>lib/middleware/index.js</FILE>
        <FILE>lib/notifications.js</FILE>
        <FILE>lib/plugins/alexa.js</FILE>
        <FILE>lib/plugins/ar2.js</FILE>
        <FILE>lib/plugins/bridge.js</FILE>
        <FILE>lib/plugins/careportal.js</FILE>
        <FILE>lib/plugins/dbsize.js</FILE>
        <FILE>lib/plugins/googlehome.js</FILE>
        <FILE>lib/plugins/index.js</FILE>
        <FILE>lib/plugins/loop.js</FILE>
        <FILE>lib/plugins/mmconnect.js</FILE>
        <FILE>lib/plugins/openaps.js</FILE>
        <FILE>lib/plugins/timeago.js</FILE>
        <FILE>lib/plugins/virtAsstBase.js</FILE>
        <FILE>lib/plugins/xdripjs.js</FILE>
        <FILE>lib/profilefunctions.js</FILE>
        <FILE>lib/report/predictions.js</FILE>
        <FILE>lib/report_plugins/daytoday.js</FILE>
        <FILE>lib/report_plugins/glucosedistribution.js</FILE>
        <FILE>lib/report_plugins/loopalyzer.js</FILE>
        <FILE>lib/report_plugins/percentile.js</FILE>
        <FILE>lib/report_plugins/profiles.js</FILE>
        <FILE>lib/report_plugins/treatments.js</FILE>
        <FILE>lib/server/booterror.js</FILE>
        <FILE>lib/server/bootevent.js</FILE>
        <FILE>lib/server/cache.js</FILE>
        <FILE>lib/server/clocks.js</FILE>
        <FILE>lib/server/devicestatus.js</FILE>
        <FILE>lib/server/entries.js</FILE>
        <FILE>lib/server/loop.js</FILE>
        <FILE>lib/server/pebble.js</FILE>
        <FILE>lib/server/profile.js</FILE>
        <FILE>lib/server/treatments.js</FILE>
        <FILE>lib/server/websocket.js</FILE>
        <FILE>lib/settings.js</FILE>
        <FILE>lib/storage/mongo-storage.js</FILE>
        <FILE>npm-shrinkwrap.json</FILE>
        <FILE>package.json</FILE>
        <FILE>server.js</FILE>
        <FILE>static/css/drawer.css</FILE>
        <FILE>static/css/main.css</FILE>
        <FILE>static/css/report.css</FILE>
        <FILE>static/css/translations.css</FILE>
        <FILE>static/images/errorcat.jpg</FILE>
        <FILE>static/profile/js/profileeditor.js</FILE>
        <FILE>static/report/js/predictions.js</FILE>
        <FILE>static/report/js/report.js</FILE>
        <FILE>swagger.json</FILE>
        <FILE>swagger.yaml</FILE>
        <FILE>test</FILE>
        <FILE>testing/populate.js</FILE>
        <FILE>tests/admintools.test.js</FILE>
        <FILE>tests/api.alexa.test.js</FILE>
        <FILE>tests/api.treatments.test.js</FILE>
        <FILE>tests/api3.basic.test.js</FILE>
        <FILE>tests/api3.create.test.js</FILE>
        <FILE>tests/api3.delete.test.js</FILE>
        <FILE>tests/api3.generic.workflow.test.js</FILE>
        <FILE>tests/api3.patch.test.js</FILE>
        <FILE>tests/api3.read.test.js</FILE>
        <FILE>tests/api3.renderer.test.js</FILE>
        <FILE>tests/api3.search.test.js</FILE>
        <FILE>tests/api3.security.test.js</FILE>
        <FILE>tests/api3.socket.test.js</FILE>
        <FILE>tests/api3.update.test.js</FILE>
        <FILE>tests/client.renderer.test.js</FILE>
        <FILE>tests/dbsize.test.js</FILE>
        <FILE>tests/env.test.js</FILE>
        <FILE>tests/expressextensions.test.js</FILE>
        <FILE>tests/mongo-storage.test.js</FILE>
        <FILE>tests/profile.test.js</FILE>
        <FILE>tests/profileeditor.test.js</FILE>
        <FILE>tests/reports.test.js</FILE>
        <FILE>tests/security.test.js</FILE>
        <FILE>tests/settings.test.js</FILE>
        <FILE>tests/timeago.test.js</FILE>
        <FILE>tests/units.test.js</FILE>
        <FILE>views/adminindex.html</FILE>
        <FILE>views/clockviews/bgclock.css</FILE>
        <FILE>views/clockviews/clock-color.css</FILE>
        <FILE>views/clockviews/clock-config.css</FILE>
        <FILE>views/clockviews/clock-config.html</FILE>
        <FILE>views/clockviews/clock-shared.css</FILE>
        <FILE>views/clockviews/clock.css</FILE>
        <FILE>views/clockviews/clock.html</FILE>
        <FILE>views/error.html</FILE>
        <FILE>views/foodindex.html</FILE>
        <FILE>views/frame.html</FILE>
        <FILE>views/index.html</FILE>
        <FILE>views/nightscout.appcache</FILE>
        <FILE>views/partials/authentication-status.ejs</FILE>
        <FILE>views/partials/toolbar.ejs</FILE>
        <FILE>views/profileindex.html</FILE>
        <FILE>views/reportindex.html</FILE>
        <FILE>views/service-worker.js</FILE>
        <FILE>views/translationsindex.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #9 from nightscout/master yes</MESSAGE>
      <SHA>d459303f70a82190fa9887822394868fcc8b8434</SHA>
      <PATCHEDFILES>
        <FILE>.deployment</FILE>
        <FILE>CONTRIBUTING.md</FILE>
        <FILE>README.md</FILE>
        <FILE>bin/azure-deploy.sh</FILE>
        <FILE>bin/prep_repo_release.sh</FILE>
        <FILE>bin/setup.sh</FILE>
        <FILE>database_configuration.json</FILE>
        <FILE>docs/example-template.env</FILE>
        <FILE>docs/plugins/example-profiles.md</FILE>
        <FILE>docs/update.png</FILE>
        <FILE>lib/adminnotifies.js</FILE>
        <FILE>lib/language.js</FILE>
        <FILE>lib/plugins/batteryage.js</FILE>
        <FILE>lib/server/app.js</FILE>
        <FILE>lib/server/bootevent.js</FILE>
        <FILE>lib/server/env.js</FILE>
        <FILE>lib/server/swagger.json</FILE>
        <FILE>lib/server/swagger.yaml</FILE>
        <FILE>lib/settings.js</FILE>
        <FILE>package-lock.json</FILE>
        <FILE>package.json</FILE>
        <FILE>server.js</FILE>
        <FILE>test</FILE>
        <FILE>tests/adminnotifies.test.js</FILE>
        <FILE>tests/ci.test.env</FILE>
        <FILE>translations/ar_SA.json</FILE>
        <FILE>translations/bg_BG.json</FILE>
        <FILE>translations/cs_CZ.json</FILE>
        <FILE>translations/da_DK.json</FILE>
        <FILE>translations/de_DE.json</FILE>
        <FILE>translations/el_GR.json</FILE>
        <FILE>translations/en/en.json</FILE>
        <FILE>translations/es_ES.json</FILE>
        <FILE>translations/fi_FI.json</FILE>
        <FILE>translations/fr_FR.json</FILE>
        <FILE>translations/he_IL.json</FILE>
        <FILE>translations/hi_IN.json</FILE>
        <FILE>translations/hr_HR.json</FILE>
        <FILE>translations/hu_HU.json</FILE>
        <FILE>translations/it_IT.json</FILE>
        <FILE>translations/ja_JP.json</FILE>
        <FILE>translations/ko_KR.json</FILE>
        <FILE>translations/nb_NO.json</FILE>
        <FILE>translations/nl_NL.json</FILE>
        <FILE>translations/pl_PL.json</FILE>
        <FILE>translations/pt_BR.json</FILE>
        <FILE>translations/pt_PT.json</FILE>
        <FILE>translations/ro_RO.json</FILE>
        <FILE>translations/ru_RU.json</FILE>
        <FILE>translations/sk_SK.json</FILE>
        <FILE>translations/sl_SI.json</FILE>
        <FILE>translations/sv_SE.json</FILE>
        <FILE>translations/tr_TR.json</FILE>
        <FILE>translations/zh_CN.json</FILE>
        <FILE>translations/zh_TW.json</FILE>
        <FILE>webpack/webpack.config.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
