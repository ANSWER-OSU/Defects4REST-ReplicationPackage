<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>22</ISSUENO>
  <ISSUEURL>https://github.com/nightscout/cgm-remote-monitor/issues/22</ISSUEURL>
  <TITLE>Question on variable name spaces</TITLE>
  <DESCRIPTION>Hey there - been working on consolidating the db config and the new bg thresholds into a single config file tonight. I modified server.js to suck in the name/value pairs. Where I'm stuck is figuring out how to get the &quot;bgLow&quot; and &quot;bgHigh&quot; variables accessible to /js/client.js... which is still executed on the server-side. In my servlet and JSP days I had page and session and global contexts to place variables, but I can't quite figure out how to do it in this context. I'm new to node.js and searched around but there's a lot about Express, but it doesn't appear to be doing that. Can you point me in the right direction? I'm really trying to get this done in order to make available &quot;step 1&quot; of the improved user configuration. I know discussion included a gui, putting into a db, etc... but I'm trying to take one step at a time. Update 6/25 1pm ET: I went into client.js and replaced the bg values of 80 with &quot;bgLow&quot; and 180 with &quot;bgHigh&quot;. Then I created two new variables within client.js (taking server.js out of the equation) for bgLow (70) and bgHigh (200) to visually confirm the lines on the graph are updated -- but they remain 80 and 180. So I'm trying to understand if I could be getting whacked by the nodeStatic caching? I can hit the /nightscout.appcache and see the cache configuration, and the setting is for 30 days or something. Here's an example of what I'm doing... // add a y-axis line that shows the low bg threshold focus.append('line') .attr('class', 'low-line') .attr('x1', xScale(dataRange[0])) .attr('y1', yScale(bgLow)) .attr('x2', xScale(dataRange[1])) .attr('y2', yScale(bgLow)) // .attr('y2', yScale(80)) .style('stroke-dasharray', ('3, 3')) .attr('stroke', 'grey'); So... 1. Am I editing the correct file (client.js)? 2. Is there a way to force clear the cache (rather than comment out the code)? Thanks - Greg</DESCRIPTION>
  <REPONAME>cgm-remote-monitor</REPONAME>
  <TIMEDIFFERENCEDAYS>31</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #21 from nightscout/feature/settings-ui CSS Fix: time + glucose collision</MESSAGE>
    <SHA>a94b111858db22a658bd595302734982b10cffb1</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Merge pull request #22 from nightscout/feature/settings-ui More UI polish</MESSAGE>
      <SHA>35ed90ed5503397417b7597b407682c88e4a8f2b</SHA>
      <PATCHEDFILES>
        <FILE>static/css/drawer.css</FILE>
        <FILE>static/css/main.css</FILE>
        <FILE>static/index.html</FILE>
        <FILE>static/js/drawer.js</FILE>
        <FILE>static/test.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #22 from nightscout/dev Dev</MESSAGE>
      <SHA>6581bd7c477f8ffb48bc4e19eafe6d738c62ab3e</SHA>
      <PATCHEDFILES>
        <FILE>.nvmrc</FILE>
        <FILE>.travis.yml</FILE>
        <FILE>README.md</FILE>
        <FILE>app.js</FILE>
        <FILE>app.json</FILE>
        <FILE>bower.json</FILE>
        <FILE>bundle/bundle.source.js</FILE>
        <FILE>env.js</FILE>
        <FILE>lib/api/activity/index.js</FILE>
        <FILE>lib/api/entries/index.js</FILE>
        <FILE>lib/api/index.js</FILE>
        <FILE>lib/api/status.js</FILE>
        <FILE>lib/authorization/storage.js</FILE>
        <FILE>lib/client/browser-utils.js</FILE>
        <FILE>lib/client/index.js</FILE>
        <FILE>lib/client/receiveddata.js</FILE>
        <FILE>lib/client/renderer.js</FILE>
        <FILE>lib/data/dataloader.js</FILE>
        <FILE>lib/data/ddata.js</FILE>
        <FILE>lib/language.js</FILE>
        <FILE>lib/plugins/alexa-plugin.md</FILE>
        <FILE>lib/plugins/batteryage.js</FILE>
        <FILE>lib/plugins/careportal.js</FILE>
        <FILE>lib/plugins/direction.js</FILE>
        <FILE>lib/plugins/index.js</FILE>
        <FILE>lib/plugins/iob.js</FILE>
        <FILE>lib/plugins/loop.js</FILE>
        <FILE>lib/plugins/openaps.js</FILE>
        <FILE>lib/plugins/pump.js</FILE>
        <FILE>lib/plugins/treatmentnotify.js</FILE>
        <FILE>lib/report_plugins/glucosedistribution.js</FILE>
        <FILE>lib/report_plugins/profiles.js</FILE>
        <FILE>lib/server/activity.js</FILE>
        <FILE>lib/server/aggregate.js</FILE>
        <FILE>lib/server/booterror.js</FILE>
        <FILE>lib/server/bootevent.js</FILE>
        <FILE>lib/server/devicestatus.js</FILE>
        <FILE>lib/server/entries.js</FILE>
        <FILE>lib/server/food.js</FILE>
        <FILE>lib/server/mqtt.js</FILE>
        <FILE>lib/server/pebble.js</FILE>
        <FILE>lib/server/profile.js</FILE>
        <FILE>lib/server/pushnotify.js</FILE>
        <FILE>lib/server/query.js</FILE>
        <FILE>lib/server/treatments.js</FILE>
        <FILE>lib/server/websocket.js</FILE>
        <FILE>lib/storage/mongo-storage.js</FILE>
        <FILE>lib/utils.js</FILE>
        <FILE>npm-shrinkwrap.json</FILE>
        <FILE>package.json</FILE>
        <FILE>server.js</FILE>
        <FILE>static/api-docs.html</FILE>
        <FILE>static/profile/js/profileeditor.js</FILE>
        <FILE>static/report/compare.html</FILE>
        <FILE>static/report/js/compare.js</FILE>
        <FILE>swagger.json</FILE>
        <FILE>swagger.yaml</FILE>
        <FILE>tests/admintools.test.js</FILE>
        <FILE>tests/api.entries.test.js</FILE>
        <FILE>tests/api.status.test.js</FILE>
        <FILE>tests/api.treatments.test.js</FILE>
        <FILE>tests/api.unauthorized.test.js</FILE>
        <FILE>tests/api.verifyauth.test.js</FILE>
        <FILE>tests/cob.test.js</FILE>
        <FILE>tests/fixtures/headless.js</FILE>
        <FILE>tests/hashauth.test.js</FILE>
        <FILE>tests/loop.test.js</FILE>
        <FILE>tests/mqtt.test.js</FILE>
        <FILE>tests/openaps.test.js</FILE>
        <FILE>tests/pebble.test.js</FILE>
        <FILE>tests/pump.test.js</FILE>
        <FILE>tests/pushnotify.test.js</FILE>
        <FILE>tests/rawbg.test.js</FILE>
        <FILE>tests/security.test.js</FILE>
        <FILE>tests/upbat.test.js</FILE>
        <FILE>tests/verifyauth.test.js</FILE>
        <FILE>views/bgclock.html</FILE>
        <FILE>views/clock.html</FILE>
        <FILE>views/index.html</FILE>
        <FILE>views/reportindex.html</FILE>
        <FILE>webpack.config.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #22 from nightscout/dev Dev sync</MESSAGE>
      <SHA>b12e35a678a8888b8771e72e0ae465640144bd6a</SHA>
      <PATCHEDFILES>
        <FILE>README.md</FILE>
        <FILE>app.js</FILE>
        <FILE>app.json</FILE>
        <FILE>docs/plugins/maker-setup-images/Webhooks_select.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/choose_action_service.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/choose_notification_type.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/choose_trigger.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/choose_trigger1.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/complete_action_field.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/complete_trigger_field.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/completed_applet.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/connecting_notifications.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/maker_key_entry.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/notifications_action.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/that_screen.jpg</FILE>
        <FILE>docs/plugins/maker-setup-images/webhooksettings.jpg</FILE>
        <FILE>docs/plugins/maker-setup.md</FILE>
        <FILE>env.js</FILE>
        <FILE>lib/language.js</FILE>
        <FILE>lib/report_plugins/loopalyzer.js</FILE>
        <FILE>lib/server/bootevent.js</FILE>
        <FILE>lib/settings.js</FILE>
        <FILE>npm-shrinkwrap.json</FILE>
        <FILE>package.json</FILE>
        <FILE>server.js</FILE>
        <FILE>static/profile/js/profileeditor.js</FILE>
        <FILE>tests/env.test.js</FILE>
        <FILE>views/bgclock.html</FILE>
        <FILE>webpack.config.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #22 from nightscout/dev Update Dev</MESSAGE>
      <SHA>10a2e7ba0a6d39c74d014f1fd7f6c77c7ac2b9a7</SHA>
      <PATCHEDFILES>
        <FILE>.github/ISSUE_TEMPLATE/--bug-report.md</FILE>
        <FILE>.github/ISSUE_TEMPLATE/--feature-request--.md</FILE>
        <FILE>.github/ISSUE_TEMPLATE/--individual-troubleshooting-help.md</FILE>
        <FILE>.github/workflows/main.yml</FILE>
        <FILE>CONTRIBUTING.md</FILE>
        <FILE>README.md</FILE>
        <FILE>app.js</FILE>
        <FILE>app.json</FILE>
        <FILE>assets/fonts/Nightscout Plugin Icons.json</FILE>
        <FILE>assets/fonts/README.md</FILE>
        <FILE>azuredeploy.json</FILE>
        <FILE>bundle/bundle.reports.source.js</FILE>
        <FILE>bundle/bundle.source.js</FILE>
        <FILE>ci.test.env</FILE>
        <FILE>docs/plugins/alexa-templates/en-us.json</FILE>
        <FILE>docs/plugins/google-home-templates/en-us.zip</FILE>
        <FILE>docs/plugins/googlehome-plugin.md</FILE>
        <FILE>docs/plugins/interacting-with-virtual-assistants.md</FILE>
        <FILE>env.js</FILE>
        <FILE>lib/api/activity/index.js</FILE>
        <FILE>lib/api/alexa/index.js</FILE>
        <FILE>lib/api/devicestatus/index.js</FILE>
        <FILE>lib/api/entries/index.js</FILE>
        <FILE>lib/api/googlehome/index.js</FILE>
        <FILE>lib/api/profile/index.js</FILE>
        <FILE>lib/api/properties.js</FILE>
        <FILE>lib/api/status.js</FILE>
        <FILE>lib/api/treatments/index.js</FILE>
        <FILE>lib/api3/const.json</FILE>
        <FILE>lib/api3/doc/formats.md</FILE>
        <FILE>lib/api3/generic/create/insert.js</FILE>
        <FILE>lib/api3/generic/history/operation.js</FILE>
        <FILE>lib/api3/generic/read/operation.js</FILE>
        <FILE>lib/api3/generic/search/operation.js</FILE>
        <FILE>lib/api3/generic/update/replace.js</FILE>
        <FILE>lib/api3/index.js</FILE>
        <FILE>lib/api3/shared/renderer.js</FILE>
        <FILE>lib/api3/swagger.js</FILE>
        <FILE>lib/api3/swagger.yaml</FILE>
        <FILE>lib/authorization/index.js</FILE>
        <FILE>lib/authorization/storage.js</FILE>
        <FILE>lib/bus.js</FILE>
        <FILE>lib/client/browser-settings.js</FILE>
        <FILE>lib/client/careportal.js</FILE>
        <FILE>lib/client/chart.js</FILE>
        <FILE>lib/client/clock-client.js</FILE>
        <FILE>lib/client/index.js</FILE>
        <FILE>lib/client/receiveddata.js</FILE>
        <FILE>lib/client/renderer.js</FILE>
        <FILE>lib/constants.json</FILE>
        <FILE>lib/data/calcdelta.js</FILE>
        <FILE>lib/data/dataloader.js</FILE>
        <FILE>lib/data/ddata.js</FILE>
        <FILE>lib/data/treatmenttocurve.js</FILE>
        <FILE>lib/language.js</FILE>
        <FILE>lib/middleware/express-extension-to-accept.js</FILE>
        <FILE>lib/middleware/index.js</FILE>
        <FILE>lib/notifications.js</FILE>
        <FILE>lib/plugins/alexa.js</FILE>
        <FILE>lib/plugins/ar2.js</FILE>
        <FILE>lib/plugins/bridge.js</FILE>
        <FILE>lib/plugins/careportal.js</FILE>
        <FILE>lib/plugins/dbsize.js</FILE>
        <FILE>lib/plugins/googlehome.js</FILE>
        <FILE>lib/plugins/index.js</FILE>
        <FILE>lib/plugins/loop.js</FILE>
        <FILE>lib/plugins/mmconnect.js</FILE>
        <FILE>lib/plugins/openaps.js</FILE>
        <FILE>lib/plugins/pushover.js</FILE>
        <FILE>lib/plugins/virtAsstBase.js</FILE>
        <FILE>lib/plugins/xdripjs.js</FILE>
        <FILE>lib/profilefunctions.js</FILE>
        <FILE>lib/report/predictions.js</FILE>
        <FILE>lib/report_plugins/daytoday.js</FILE>
        <FILE>lib/report_plugins/glucosedistribution.js</FILE>
        <FILE>lib/report_plugins/loopalyzer.js</FILE>
        <FILE>lib/report_plugins/percentile.js</FILE>
        <FILE>lib/report_plugins/profiles.js</FILE>
        <FILE>lib/report_plugins/treatments.js</FILE>
        <FILE>lib/server/booterror.js</FILE>
        <FILE>lib/server/bootevent.js</FILE>
        <FILE>lib/server/cache.js</FILE>
        <FILE>lib/server/clocks.js</FILE>
        <FILE>lib/server/devicestatus.js</FILE>
        <FILE>lib/server/entries.js</FILE>
        <FILE>lib/server/loop.js</FILE>
        <FILE>lib/server/pebble.js</FILE>
        <FILE>lib/server/profile.js</FILE>
        <FILE>lib/server/treatments.js</FILE>
        <FILE>lib/server/websocket.js</FILE>
        <FILE>lib/settings.js</FILE>
        <FILE>lib/storage/mongo-storage.js</FILE>
        <FILE>npm-shrinkwrap.json</FILE>
        <FILE>package.json</FILE>
        <FILE>server.js</FILE>
        <FILE>static/css/drawer.css</FILE>
        <FILE>static/css/main.css</FILE>
        <FILE>static/css/report.css</FILE>
        <FILE>static/css/translations.css</FILE>
        <FILE>static/images/errorcat.jpg</FILE>
        <FILE>static/profile/js/profileeditor.js</FILE>
        <FILE>static/report/js/predictions.js</FILE>
        <FILE>static/report/js/report.js</FILE>
        <FILE>swagger.json</FILE>
        <FILE>swagger.yaml</FILE>
        <FILE>test</FILE>
        <FILE>testing/populate.js</FILE>
        <FILE>tests/admintools.test.js</FILE>
        <FILE>tests/api.alexa.test.js</FILE>
        <FILE>tests/api.treatments.test.js</FILE>
        <FILE>tests/api3.basic.test.js</FILE>
        <FILE>tests/api3.create.test.js</FILE>
        <FILE>tests/api3.delete.test.js</FILE>
        <FILE>tests/api3.generic.workflow.test.js</FILE>
        <FILE>tests/api3.patch.test.js</FILE>
        <FILE>tests/api3.read.test.js</FILE>
        <FILE>tests/api3.renderer.test.js</FILE>
        <FILE>tests/api3.search.test.js</FILE>
        <FILE>tests/api3.security.test.js</FILE>
        <FILE>tests/api3.socket.test.js</FILE>
        <FILE>tests/api3.update.test.js</FILE>
        <FILE>tests/client.renderer.test.js</FILE>
        <FILE>tests/dbsize.test.js</FILE>
        <FILE>tests/env.test.js</FILE>
        <FILE>tests/expressextensions.test.js</FILE>
        <FILE>tests/mongo-storage.test.js</FILE>
        <FILE>tests/profile.test.js</FILE>
        <FILE>tests/profileeditor.test.js</FILE>
        <FILE>tests/reports.test.js</FILE>
        <FILE>tests/security.test.js</FILE>
        <FILE>tests/settings.test.js</FILE>
        <FILE>tests/timeago.test.js</FILE>
        <FILE>tests/units.test.js</FILE>
        <FILE>views/adminindex.html</FILE>
        <FILE>views/clockviews/bgclock.css</FILE>
        <FILE>views/clockviews/clock-color.css</FILE>
        <FILE>views/clockviews/clock-config.css</FILE>
        <FILE>views/clockviews/clock-config.html</FILE>
        <FILE>views/clockviews/clock-shared.css</FILE>
        <FILE>views/clockviews/clock.css</FILE>
        <FILE>views/clockviews/clock.html</FILE>
        <FILE>views/error.html</FILE>
        <FILE>views/foodindex.html</FILE>
        <FILE>views/frame.html</FILE>
        <FILE>views/index.html</FILE>
        <FILE>views/nightscout.appcache</FILE>
        <FILE>views/partials/authentication-status.ejs</FILE>
        <FILE>views/partials/toolbar.ejs</FILE>
        <FILE>views/profileindex.html</FILE>
        <FILE>views/reportindex.html</FILE>
        <FILE>views/service-worker.js</FILE>
        <FILE>views/translationsindex.html</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #22 from timoschlueter/dependabot/npm_and_yarn/follow-redirects-1.14.9 Bump follow-redirects from 1.14.7 to 1.14.9</MESSAGE>
      <SHA>fc6010117a40c9f245afa5b898f144f361b2636e</SHA>
      <PATCHEDFILES>
        <FILE>package-lock.json</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
