<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3089</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/3089</ISSUEURL>
  <TITLE>[now dev] fails with @now/python on Debian/Ubuntu</TITLE>
  <DESCRIPTION>Ubuntu, since Xenial, contains the patched version of `pip` with `--user` and `--ignore-installed` flag active by default. In combination with the `--prefix` option, from the `@now/python` runtime, this always raises an error `distutils.errors.DistutilsOptionError: can't combine user with prefix, exec_prefix/home, or install_(plat)base`. This can be solved by running `now dev` as a superuser or using the non-system version of `pip`. For solving this in the runtime either `--system` or `--no-user` (depends on `pip` version) option must be provided. However, `export PIP_USER=0 PIP_IGNORE_INSTALLED=0` seems more applicable. There are also similar issues: #3023 and #2853</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>25</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>[now-client] Yield an error event if path provided is not absolute (#3173) This adds an `error` event when provided path to `now-client` isn't absolute</MESSAGE>
    <SHA>42ffc2dafb8bf6cf6c44ebb7be15a3f09dce5406</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[now-python] Set PIP_USER environment variable (#3111) Disables `--user` parameter of the `pip` utility, which is forcibly set under the hood on Debian systems and causes an error in the `pipInstall` function: `distutils.errors.DistutilsOptionError: can't combine user with prefix, exec_prefix/home, or install_(plat)base` Fixes #3089</MESSAGE>
      <SHA>37c06c89d02feb0e1a3007cc33355f631de30b98</SHA>
      <PATCHEDFILES>
        <FILE>packages/now-python/src/index.ts</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>[now-python] Set PIP_USER environment variable (#3111) Disables `--user` parameter of the `pip` utility, which is forcibly set under the hood on Debian systems and causes an error in the `pipInstall` function: `distutils.errors.DistutilsOptionError: can't combine user with prefix, exec_prefix/home, or install_(plat)base` Fixes #3089</MESSAGE>
      <SHA>6e1065fde2dbbae910fbef09284fd9d7f98da34f</SHA>
      <PATCHEDFILES>
        <FILE>packages/now-python/src/index.ts</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
