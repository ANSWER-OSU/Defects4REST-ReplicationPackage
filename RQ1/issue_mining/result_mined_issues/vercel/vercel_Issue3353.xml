<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3353</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/3353</ISSUEURL>
  <TITLE>[now dev] Custom runtimes are reinstalled at every build</TITLE>
  <DESCRIPTION>`now dev` should check if a custom runtime already exists before installing it, instead always installs it. This function is probably the problem, it filters out the already installed packages in cache https://github.com/zeit/now/blob/b69f1761439b92e058aa7b9c30be0475073bcf38/packages/now-cli/src/util/dev/builder-cache.ts#L161</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>3</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Publish Canary - @now/routing-utils@1.3.4-canary.5</MESSAGE>
    <SHA>4ff8ab24351af52379ff4c0c658dddd6506f0d65</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[now dev] skip installing already installed versioned runtimes (#3354) Fixes #3353 The current solution might break if a user interrupts `now dev` while yarn wrote the package in the cache package.json but has not yet added to node_modules. This happens in like 20 ms but is possible, so we could execute `yarn` every time to be sure. Tell me if the above is a problem or not</MESSAGE>
      <SHA>023001a8b11512bf1bb5b3129285c709e67cd650</SHA>
      <PATCHEDFILES>
        <FILE>.gitignore</FILE>
        <FILE>packages/now-cli/src/util/dev/builder-cache.ts</FILE>
        <FILE>packages/now-cli/test/dev-builder.unit.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
