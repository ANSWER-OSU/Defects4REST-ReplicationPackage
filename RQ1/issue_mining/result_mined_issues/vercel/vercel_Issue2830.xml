<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2830</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/2830</ISSUEURL>
  <TITLE>[now-python] The lambda function size exceeds the maximum size limit (50mb)</TITLE>
  <DESCRIPTION>Hello fellas. I have problem with deploying my project using now. Deployment of static parts of page goes well, but I have problem with deploying lambda. **I was very suprised that after build the lambda has ridiculous size (246mb)**. Here is the code of the lambda: https://pastebin.com/8SPRxz6y. Any idea what am I doing wrong and how to reduce lambda size? Anyway I am great fan of now and pretty much all zeit projects. Keep it up. Thanks ```import smtplib from email.message import EmailMessage from http.server import BaseHTTPRequestHandler from urllib.parse import urlparse, parse_qs import json class calculationRequestHandler(BaseHTTPRequestHandler): gmail_user = 'xxxxxxx@gmail.com' gmail_password = 'xxxxxxxxx' mail_recipient = 'xxxxxx@gmail.com' def sendGmail(self, sender, sender_pass, recipient, subject, content): msg = EmailMessage() msg['Subject'] = subject msg['From'] = sender msg['To'] = recipient msg.set_content(content) try: server = smtplib.SMTP_SSL('smtp.gmail.com', 465) server.ehlo() server.login(sender, sender_pass) server.sendmail(sender, recipient, msg.as_string()) except Exception as err: print(err) return False return True def end_headers(self): self.send_header('Content-type','text/plain') # comment this line out before deployment # self.send_header('Access-Control-Allow-Origin', '*') BaseHTTPRequestHandler.end_headers(self) def parse_product(self, product): product_dict = json.loads(product) del product_dict[&quot;productImgSrc&quot;] del product_dict[&quot;productHref&quot;] return product_dict def generate_content(self, my_query): parsed_products = [] for product in my_query['productList[]']: parsed_products.append(self.parse_product(product)) return json.dumps({ 'email': my_query['email'][0], 'produkty': parsed_products }, ensure_ascii=False, indent=2) def do_GET(self): parsed_url = urlparse(self.path) my_query = parse_qs(parsed_url.query) content = self.generate_content(my_query) subject = 'ziadost o kalkulaciu - ' + my_query['email'][0] self.sendGmail(self.gmail_user, self.gmail_password, self.mail_recipient, subject, content) self.send_response(200) self.end_headers() return ```</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>897</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Publish Canary - now@17.0.0-canary.30</MESSAGE>
    <SHA>2fe987b5da588693ebc1675c17416542c999e68a</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[now-python] Add `excludeFiles` config option (#3712) This PR adds a `config.excludeFiles` pattern for `@now/python` that defaults to `node_modules/**` for users who are using a Node.js SSG frontend with Python APIs backend. If the user chooses, they can override to any glob pattern such as `{.cache,node_modules}/**`. Related to #2830 Related to #3416</MESSAGE>
      <SHA>340f7db68ac4dc7734d08211e93b734e7945a40d</SHA>
      <PATCHEDFILES>
        <FILE>packages/now-build-utils/src/fs/glob.ts</FILE>
        <FILE>packages/now-build-utils/src/index.ts</FILE>
        <FILE>packages/now-build-utils/src/types.ts</FILE>
        <FILE>packages/now-python/src/index.ts</FILE>
        <FILE>packages/now-python/test/fixtures/25-exclude-files/api/no.py</FILE>
        <FILE>packages/now-python/test/fixtures/25-exclude-files/api/yes.py</FILE>
        <FILE>packages/now-python/test/fixtures/25-exclude-files/ignoreme/first.txt</FILE>
        <FILE>packages/now-python/test/fixtures/25-exclude-files/ignoreme/second.txt</FILE>
        <FILE>packages/now-python/test/fixtures/25-exclude-files/now.json</FILE>
        <FILE>packages/now-python/test/fixtures/25-exclude-files/requirements.txt</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
