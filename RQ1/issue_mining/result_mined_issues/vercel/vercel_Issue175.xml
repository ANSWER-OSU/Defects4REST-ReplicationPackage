<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>175</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/175</ISSUEURL>
  <TITLE>Deploying next.js app fails with UnhandledPromiseRejectionWarning</TITLE>
  <DESCRIPTION>I'm trying to deploy the current GitHub version of next.js. In order to work around the fact the the `dist` folder is missing on GitHub, I have forked the repo and added these files: https://github.com/backflip/next.js/tree/release However, `npm start` fails with a `(node:275) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: EACCES: permission denied, rmdir '/home/nowuser/src/.next'`. Could this be related to the warnings/errors further above regarding `node-pre-gyp` (which is connected to the recent addition of `chokidar` to next.js)? ``` &gt; ▲ npm install &gt; Installing package next@git://github.com/backflip/next.js.git#c5851e07fe5fca8260033987ff82f22b74bd1e72 &gt; Installing package path-match@^1.2.4 &gt; Installing package query-string@^4.2.3 &gt; Installing package restify@^4.3.0 &gt; Installing package url@^0.11.0 &gt; Installing package eslint@^3.10.2 &gt; Installing package eslint-config-standard@^6.2.1 &gt; Installing package eslint-plugin-promise@^3.4.0 &gt; Installing package eslint-plugin-react@^6.8.0 &gt; Installing package eslint-plugin-standard@^2.0.1 &gt; (node:49) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: ENOENT: no such file or directory, readlink '/home/nowuser/src/node_modules/.tmp/6bc0d960-7e74-4d87-92a4-e40e03c29164/node_modules/node-pre-gyp' &gt; (node:49) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code. &gt; node-pre-gyp info it worked if it ends with ok &gt; node-pre-gyp info using node-pre-gyp@0.6.29 &gt; node-pre-gyp info using node@7.0.0 | linux | x64 &gt; node-pre-gyp info check checked for &quot;/home/nowuser/src/node_modules/dc1ba8196115775facd8a7e77d3b9c0387eea5f3/lib/binding/Release/node-v51-linux-x64/fse.node&quot; (not found) &gt; node-pre-gyp http GET https://fsevents-binaries.s3-us-west-2.amazonaws.com/v1.0.15/fse-v1.0.15-node-v51-linux-x64.tar.gz &gt; node-pre-gyp http 404 https://fsevents-binaries.s3-us-west-2.amazonaws.com/v1.0.15/fse-v1.0.15-node-v51-linux-x64.tar.gz &gt; node-pre-gyp ERR! Tried to download: https://fsevents-binaries.s3-us-west-2.amazonaws.com/v1.0.15/fse-v1.0.15-node-v51-linux-x64.tar.gz &gt; node-pre-gyp ERR! Pre-built binaries not found for fsevents@1.0.15 and node@7.0.0 (node-v51 ABI) (falling back to source compile with node-gyp) &gt; node-pre-gyp http Pre-built binary not available for your system, looked for https://fsevents-binaries.s3-us-west-2.amazonaws.com/v1.0.15/fse-v1.0.15-node-v51-linux-x64.tar.gz &gt; gyp info it worked if it ends with ok &gt; gyp info using node-gyp@3.3.1 &gt; gyp info using node@7.0.0 | linux | x64 &gt; gyp info ok &gt; gyp info it worked if it ends with ok &gt; gyp info using node-gyp@3.3.1 &gt; gyp info using node@7.0.0 | linux | x64 &gt; gyp http GET https://nodejs.org/download/release/v7.0.0/node-v7.0.0-headers.tar.gz &gt; gyp http 200 https://nodejs.org/download/release/v7.0.0/node-v7.0.0-headers.tar.gz &gt; gyp http GET https://nodejs.org/download/release/v7.0.0/SHASUMS256.txt &gt; gyp http 200 https://nodejs.org/download/release/v7.0.0/SHASUMS256.txt &gt; gyp info spawn /usr/bin/python2 &gt; gyp info spawn args [ '/usr/lib/node_modules/node-gyp/gyp/gyp_main.py', &gt; gyp info spawn args 'binding.gyp', &gt; gyp info spawn args '-f', &gt; gyp info spawn args 'make', &gt; gyp info spawn args '-I', &gt; gyp info spawn args '/home/nowuser/src/node_modules/dc1ba8196115775facd8a7e77d3b9c0387eea5f3/build/config.gypi', &gt; gyp info spawn args '-I', &gt; gyp info spawn args '/usr/lib/node_modules/node-gyp/addon.gypi', &gt; gyp info spawn args '-I', &gt; gyp info spawn args '/home/nowuser/.node-gyp/7.0.0/include/node/common.gypi', &gt; gyp info spawn args '-Dlibrary=shared_library', &gt; gyp info spawn args '-Dvisibility=default', &gt; gyp info spawn args '-Dnode_root_dir=/home/nowuser/.node-gyp/7.0.0', &gt; gyp info spawn args '-Dnode_gyp_dir=/usr/lib/node_modules/node-gyp', &gt; gyp info spawn args '-Dnode_lib_file=node.lib', &gt; gyp info spawn args '-Dmodule_root_dir=/home/nowuser/src/node_modules/dc1ba8196115775facd8a7e77d3b9c0387eea5f3', &gt; gyp info spawn args '--depth=.', &gt; gyp info spawn args '--no-parallel', &gt; gyp info spawn args '--generator-output', &gt; gyp info spawn args 'build', &gt; gyp info spawn args '-Goutput_dir=.' ] &gt; gyp info ok &gt; gyp info it worked if it ends with ok &gt; gyp info using node-gyp@3.3.1 &gt; gyp info using node@7.0.0 | linux | x64 &gt; gyp info spawn make &gt; make: Entering directory '/home/nowuser/src/node_modules/dc1ba8196115775facd8a7e77d3b9c0387eea5f3/build' &gt; SOLINK_MODULE(target) Release/obj.target/.node &gt; gyp info spawn args [ 'BUILDTYPE=Release', '-C', 'build' ] &gt; COPY Release/.node &gt; make: Leaving directory '/home/nowuser/src/node_modules/dc1ba8196115775facd8a7e77d3b9c0387eea5f3/build' &gt; gyp info ok &gt; node-pre-gyp info ok &gt; ▲ npm run build &gt; build exited with status 0 &gt; ▲ npm start &gt; (node:275) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: EACCES: permission denied, rmdir '/home/nowuser/src/.next' &gt; (node:275) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code. ```</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Publish - @now/node-server@0.4.27-canary.0 - @now/node@0.4.29-canary.0</MESSAGE>
    <SHA>0d8058d062b6c28425f3fd83be0b3a7452d2fbb7</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix broken error link (#175) * Fix broken error link * Added legacy mode error Standard &quot;Next.js&quot; for all citations of Next. Add &quot;Legacy Mode&quot; error. * Update no serverless pages built doc * Update doc on now/next legacy mode * Add link after the error message</MESSAGE>
      <SHA>4d6437d235b28787acc77e07e9b01cd569218b8f</SHA>
      <PATCHEDFILES>
        <FILE>errors/now-next-legacy-mode.md</FILE>
        <FILE>errors/now-next-no-serverless-pages-built.md</FILE>
        <FILE>packages/now-next/index.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
