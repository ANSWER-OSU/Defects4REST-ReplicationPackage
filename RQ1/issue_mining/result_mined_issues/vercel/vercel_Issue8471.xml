<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>8471</ISSUENO>
  <ISSUEURL>https://github.com/vercel/vercel/issues/8471</ISSUEURL>
  <TITLE>[client] createDeployment failing &quot;MODULE_NOT_FOUND&quot;</TITLE>
  <DESCRIPTION>### Discussed in https://github.com/orgs/vercel/discussions/8466 &lt;div type='discussions-op-text'&gt; &lt;sup&gt;Originally posted by **eric-miller2129** August 25, 2022&lt;/sup&gt; Hi there, I'm using `@vercel/client` to run a programmatic deployment to Vercel. Until recently it was working fine however it seems once I bumped the version from `12.1.11` to `12.2.0` it began to fail. ![Screen Shot 2022-08-25 at 17 38 57](https://user-images.githubusercontent.com/1424187/186773899-b9369942-df90-41a6-a486-80015b71c00d.png) ``` node:internal/modules/cjs/loader:936 throw err; ^ Error: Cannot find module 'tar-fs' Require stack: - .../node_modules/@vercel/client/dist/create-deployment.js - .../node_modules/@vercel/client/dist/index.js ``` Switching back to `12.1.11` solves the issue, and just manually installing `tar-fs` also seems to solve the issue, but I don't think either of those things are the correct solution. --- Going through the commit history, it looks like this may be coming from the addition of `tar-fs` here https://github.com/vercel/vercel/blob/603b1256c63e46ad54da28aa7963d737349bec4d/packages/client/src/create-deployment.ts#L13</DESCRIPTION>
  <REPONAME>vercel</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>[fs-detectors] Add a default workspace manager when there's no lock file (#8469) This fixes an issue with this example, https://vercel.com/api/v1/integrations/detect-eligible-projects?url=https%3A%2F%2Fgithub.com%2Fvercel%2Fturborepo%2Ftree%2Fmain%2Fexamples%2Fkitchen-sink Where the repo has no lockfile, and hence our workspace detection fails. This fix is to add a fallback of &quot;npm&quot; in this scenario ### Related Issues Fixes https://github.com/vercel/turbo-internal/issues/232 ### Checklist &lt;!-- Please keep your PR as a Draft until the checklist is complete --&gt; #### Tests - [x] The code changed/added as part of this PR has been covered with tests - [x] All tests pass locally with `yarn test-unit` #### Code Review - [ ] This PR has a concise title and thorough description useful to a reviewer - [ ] Issue from task tracker has a link to this PR</MESSAGE>
    <SHA>b63f444abda495f8593c4ae019f44aa6797c4666</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[client] Add &quot;tar-fs&quot; dependency Fixes #8471.</MESSAGE>
      <SHA>8282c15177f156df1924b475df10dc207119b5eb</SHA>
      <PATCHEDFILES>
        <FILE>packages/client/package.json</FILE>
        <FILE>yarn.lock</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>[client] Add &quot;tar-fs&quot; dependency (#8473) Fixes #8471.</MESSAGE>
      <SHA>6668d6cf2162903fd2d2883d8484a4239fd56cec</SHA>
      <PATCHEDFILES>
        <FILE>packages/client/package.json</FILE>
        <FILE>yarn.lock</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
