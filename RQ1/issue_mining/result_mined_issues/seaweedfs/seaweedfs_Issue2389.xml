<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2389</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/2389</ISSUEURL>
  <TITLE>[s3test] PutObjectTagging, GetObjectTagging and DeleteObjectTagging</TITLE>
  <DESCRIPTION>Nexus Blob Storage requires PutObjectTagging, GetObjectTagging and DeleteObjectTagging https://help.sonatype.com/repomanager3/repository-management/storage-guide/configuring-blob-stores#ConfiguringBlobStores-AWSSimpleStorageService(S3) ``` s3tests_1 | ====================================================================== s3tests_1 | FAIL: s3tests_boto3.functional.test_s3.test_put_obj_with_tags s3tests_1 | ---------------------------------------------------------------------- s3tests_1 | Traceback (most recent call last): s3tests_1 | File &quot;/opt/s3-tests/virtualenv/lib/python3.8/site-packages/nose/case.py&quot;, line 198, in runTest s3tests_1 | self.test(*self.arg) s3tests_1 | File &quot;/opt/s3-tests/s3tests_boto3/functional/test_s3.py&quot;, line 11449, in test_put_obj_with_tags s3tests_1 | eq(response_tagset, tagset) s3tests_1 | AssertionError: [{'Key': 'foo', 'Value': 'bar'}] != [{'Key': 'bar', 'Value': ''}, {'Key': 'foo', 'Value': 'bar'}] s3tests_1 | &gt;&gt; raise AssertionError(None or &quot;%r != %r&quot; % ([{'Key': 'foo', 'Value': 'bar'}], [{'Key': 'bar', 'Value': ''}, {'Key': 'foo', 'Value': 'bar'}])) ``` ``` s3tests_1 | ====================================================================== s3tests_1 | FAIL: s3tests_boto3.functional.test_s3.test_put_delete_tags s3tests_1 | ---------------------------------------------------------------------- s3tests_1 | Traceback (most recent call last): s3tests_1 | File &quot;/opt/s3-tests/virtualenv/lib/python3.8/site-packages/nose/case.py&quot;, line 198, in runTest s3tests_1 | self.test(*self.arg) s3tests_1 | File &quot;/opt/s3-tests/s3tests_boto3/functional/test_s3.py&quot;, line 11323, in test_put_delete_tags s3tests_1 | eq(response['ResponseMetadata']['HTTPStatusCode'], 200) s3tests_1 | AssertionError: 204 != 200 s3tests_1 | &gt;&gt; raise AssertionError(None or &quot;%r != %r&quot; % (204, 200)) ``` ``` s3tests_1 | ====================================================================== s3tests_1 | FAIL: s3tests_boto3.functional.test_s3.test_get_obj_tagging s3tests_1 | ---------------------------------------------------------------------- s3tests_1 | Traceback (most recent call last): s3tests_1 | File &quot;/opt/s3-tests/virtualenv/lib/python3.8/site-packages/nose/case.py&quot;, line 198, in runTest s3tests_1 | self.test(*self.arg) s3tests_1 | File &quot;/opt/s3-tests/s3tests_boto3/functional/test_s3.py&quot;, line 11140, in test_get_obj_tagging s3tests_1 | eq(response['ResponseMetadata']['HTTPStatusCode'], 200) s3tests_1 | AssertionError: 204 != 200 s3tests_1 | &gt;&gt; raise AssertionError(None or &quot;%r != %r&quot; % (204, 200)) ``` ``` E1020 11:37:12 1 s3api_object_tagging_handlers.go:59] PutObjectTaggingHandler Unmarshal /package-cache-nexus-proxy-cache/nexus/cache/content/vol-31/chap-12/aecabacb-1999-47b8-80f7-1dad5b639ed0.bytes?tagging: expected element &lt;Tagging&gt; in name space http://s3.amazonaws.com/doc/2006-03-01/ but have no name space```</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>2.74</MESSAGE>
    <SHA>182f43ae5fa2aed5a2526aaa23390e9b8d376e63</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix object tagging https://github.com/chrislusf/seaweedfs/issues/2389</MESSAGE>
      <SHA>c78220a7f2aa804b4c718642e0ae0b6eaf6836e8</SHA>
      <PATCHEDFILES>
        <FILE>weed/s3api/s3api_object_tagging_handlers.go</FILE>
        <FILE>weed/s3api/s3err/s3api_errors.go</FILE>
        <FILE>weed/server/filer_server_handlers_read.go</FILE>
        <FILE>weed/server/filer_server_handlers_write_autochunk.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
