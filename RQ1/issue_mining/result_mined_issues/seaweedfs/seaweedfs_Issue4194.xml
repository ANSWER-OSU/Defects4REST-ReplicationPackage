<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4194</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/4194</ISSUEURL>
  <TITLE>[filer.remote.sync] Transport connection broken error</TITLE>
  <DESCRIPTION>**Describe the bug** Running `filer.remote.sync` returns an error and does not copy file to the remote (Azure Storage) **System Setup** ``` &gt; lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 20.04.5 LTS Release: 20.04 Codename: focal ``` ``` &gt; weed version version 30GB 3.42 8821d6b1619b7a55b515a98391193297e77cbe52 linux amd64 ``` ``` # Weed server /usr/local/bin/weed server -volume.max=16 -s3 # Adding and mounting the remote echo &quot;remote.configure -name=azure -type=azure -azure.account_name=seaweedsa -azure.account_key=rwexf8T...t4ss9MQ==&quot; | weed shell echo &quot;remote.mount -remote=azure/seaweed -dir=/buckets/seaweed&quot; | weed shell # Weed filer.remote.sync, in a separate cmd tab /usr/local/bin/weed filer.remote.sync -dir=/buckets/seaweed ``` **Expected behavior** Running a simple weed server, with a remote pointing to Azure Storage, and running a filer.remote.sync. Uploading a file to Filer UI (http://localhost:8888/buckets/seaweed) uploads the filer to Filer, but its not being copied to remote **Screenshots** filer.remote.sync logs: ``` Put &quot;https://seaweedsa.blob.core.windows.net/seaweed/13-53.36204a77?timeout=61&quot;: net/http: HTTP/1.x transport connection broken: http: ContentLength=704 with Body length 0 I0209 10:22:04.822710 filer_remote_sync_dir.go:193 create azure/seaweed/13-53.36204a77 I0209 10:22:51.855969 retry.go:25 retry writeFile: err: azure upload to seaweed/13-53.36204a77: -&gt; github.com/Azure/azure-pipeline-go/pipeline.NewError, /go/pkg/mod/github.com/!azure/azure-pipeline-go@v0.2.3/pipeline/error.go:157 HTTP request failed ``` Referencing a similar ticket here https://github.com/seaweedfs/seaweedfs/issues/4180</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>7</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>add some more example</MESSAGE>
    <SHA>a9aa2d581fcb246d01bad603cd1164d992ad2cfc</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix for io.ReaderAt used in filer.remote.sync fix https://github.com/seaweedfs/seaweedfs/issues/4194</MESSAGE>
      <SHA>545d5d0cc39956b5bec0df3ee62e57af4d9c22c6</SHA>
      <PATCHEDFILES>
        <FILE>weed/filer/stream.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
