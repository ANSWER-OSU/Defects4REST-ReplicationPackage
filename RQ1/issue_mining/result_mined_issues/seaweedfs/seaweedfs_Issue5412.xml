<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>5412</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/5412</ISSUEURL>
  <TITLE>git clone into fuse mount fails with `inflate: data stream error`</TITLE>
  <DESCRIPTION>**Describe the bug** A `git clone` of large remote repositories into a SeaweedFS FUSE mount reliably fails with this error: ``` error: inflate: data stream error (unknown compression method) fatal: serious inflate inconsistency ``` Here are a few repos I've found that fail: - https://gitlab.gnome.org/GNOME/glib.git - https://github.com/u-boot/u-boot.git - git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git **System Setup** - List the command line to start &quot;weed master&quot;, &quot;weed volume&quot;, &quot;weed filer&quot;, &quot;weed s3&quot;, &quot;weed mount&quot;. - `weed server -dir=/srv/data/weedvol -master.port=9333 -volume.port=8080 -master.volumeSizeLimitMB=4096 -s3 -filer=true -volume.minFreeSpace=10 -volume.max=0` - `weed mount -filer=weedserver:8888 -dir=/home/satwell/mnt/tmp -filer.path=/` - OS version: Debian 12 on both server and client - output of `weed version`: `version 30GB 3.64 b74e8082bac408138be99e128b8c28fd19eca7a6 linux amd64` - if using filer, show the content of `filer.toml` ``` [filer.options] recursive_delete = false [leveldb2] enabled = true dir = &quot;/srv/data/filerldb2&quot; ``` **Expected behavior** Expected `git clone` to complete successfully. This works fine for smaller git repos that I've tried cloning. **Screenshots** Full git command and output: ``` halo:~/mnt/tmp% git clone --bare https://gitlab.gnome.org/GNOME/glib.git Cloning into bare repository 'glib.git'... remote: Enumerating objects: 211140, done. remote: Counting objects: 100% (2144/2144), done. remote: Compressing objects: 100% (271/271), done. remote: Total 211140 (delta 1941), reused 2064 (delta 1873), pack-reused 208996 Receiving objects: 100% (211140/211140), 92.15 MiB | 6.06 MiB/s, done. error: inflate: data stream error (unknown compression method) fatal: serious inflate inconsistency error: inflate: data stream error (unknown compression method) error: inflate: data stream error (unknown compression method) fatal: fetch-pack: invalid index-pack output ```</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>116</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge branch 'master' into mq-subscribe</MESSAGE>
    <SHA>7482a9883324e3d13273253d857be999be431665</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>log possible racing condition fix https://github.com/seaweedfs/seaweedfs/issues/5412</MESSAGE>
      <SHA>2a4a9c6343ac32e31172f97789715bb1f3ba302a</SHA>
      <PATCHEDFILES>
        <FILE>weed/mount/page_writer/page_chunk_mem.go</FILE>
        <FILE>weed/mount/page_writer/page_chunk_swapfile.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>log possible racing condition fix https://github.com/seaweedfs/seaweedfs/issues/5412</MESSAGE>
      <SHA>d5b2cee34a9555507b59e59824394d707ecbfa3f</SHA>
      <PATCHEDFILES>
        <FILE>weed/mount/page_writer/page_chunk_mem.go</FILE>
        <FILE>weed/mount/page_writer/page_chunk_swapfile.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
