<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1724</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/1724</ISSUEURL>
  <TITLE>One of the two volume servers that contain data returns error: invalid character '\x1f' and MIME type error</TITLE>
  <DESCRIPTION>Hi, I have 3 volume servers and 1 master node, I've created a collection name &quot;Animated_2tacopy_count&quot; with count=1 and replication=001 I upload my file with following command: ``` sweed@dev10:~$./weedfs/weed upload -collection=Animated_2tacopy_count=1 -dir=&quot;/home/sweed/animate.mp4 [{&quot;fileName&quot;:&quot;animate.mp4&quot;,&quot;fileUrl&quot;:&quot;192.168.200.23:8081/22,1d9ff15aa7&quot;,&quot;fid&quot;:&quot;22,1d9ff15aa7&quot;,&quot;size&quot;:178481324}] ``` when I'm asking Master for my file, it return volume servers randomly: ``` sweed@dev10:~$ curl -I 192.168.200.20:9333/22,24dbfea5ed HTTP/1.1 308 Permanent Redirect Content-Type: text/html; charset=utf-8 Location: http://192.168.200.21:8081/22,24dbfea5ed Date: Thu, 31 Dec 2020 15:06:08 GMT sweed@dev10:~$ curl -I 192.168.200.20:9333/22,24dbfea5ed HTTP/1.1 308 Permanent Redirect Content-Type: text/html; charset=utf-8 Location: http://192.168.200.22:8081/22,24dbfea5ed Date: Thu, 31 Dec 2020 15:06:09 GMT ``` But in browser I can't see my file from volume serevr 192.168.200.21 but In another volume server &quot;192.168.200.22&quot; everything is ok, actully when browser returns the ip address of 200.22 I can see my file but when it return 200.21 I have mime type error: ![image](https://user-images.githubusercontent.com/43205944/103415573-0111fb80-4b98-11eb-9c53-568dab440166.png) And in journalctl of server 200.21 I have this error: ``` Dec 31 18:23:50 dev11 seaweedfs-volume[20791]: I1231 18:23:50 20791 volume_server_handlers_read.go:187] load chunked manifest (/22,24dbfea5ed) error: invalid character '\x1f' looking for beginning of value Dec 31 18:25:30 dev11 seaweedfs-volume[20791]: I1231 18:25:30 20791 volume_server_handlers_read.go:187] load chunked manifest (/22,24dbfea5ed) error: invalid character '\x1f' looking for beginning of value Dec 31 18:25:37 dev11 seaweedfs-volume[20791]: I1231 18:25:37 20791 volume_server_handlers_read.go:187] load chunked manifest (/22,24dbfea5ed) error: invalid character '\x1f' looking for beginning of value Dec 31 18:25:48 dev11 seaweedfs-volume[20791]: I1231 18:25:48 20791 volume_server_handlers_read.go:187] load chunked manifest (/22,24dbfea5ed) error: invalid character '\x1f' looking for beginning of value Dec 31 18:26:29 dev11 seaweedfs-volume[20791]: I1231 18:26:29 20791 volume_server_handlers_read.go:187] load chunked manifest (/22,24dbfea5ed) error: invalid character '\x1f' looking for beginning of value Dec 31 18:26:40 dev11 seaweedfs-volume[20791]: I1231 18:26:40 20791 volume_server_handlers_read.go:187] load chunked manifest (/22,24dbfea5ed) error: invalid character '\x1f' looking for beginning of value Dec 31 18:26:42 dev11 seaweedfs-volume[20791]: I1231 18:26:42 20791 volume_server_handlers_read.go:187] load chunked manifest (/22,24dbfea5ed) error: invalid character '\x1f' looking for beginning of value Dec 31 18:26:43 dev11 seaweedfs-volume[20791]: I1231 18:26:43 20791 volume_server_handlers_read.go:187] load chunked manifest (/22,24dbfea5ed) error: invalid character '\x1f' looking for beginning of value Dec 31 18:27:03 dev11 seaweedfs-volume[20791]: I1231 18:27:03 20791 volume_server_handlers_read.go:187] load chunked manifest (/22,24dbfea5ed) error: invalid character '\x1f' looking for beginning of value ```</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>2</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>separate prefix from namePattern fix https://github.com/chrislusf/seaweedfs/issues/1722</MESSAGE>
    <SHA>2c3c2c27d7a900838734fac5c7cb3f4cc7340ea1</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>upload: add read default collection from master fix https://github.com/chrislusf/seaweedfs/issues/1724#issuecomment-753576071</MESSAGE>
      <SHA>4250a3a67510dda9fe9d6e38d4ea617c97c4c214</SHA>
      <PATCHEDFILES>
        <FILE>weed/command/upload.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>manifest file also need to detect compression fix https://github.com/chrislusf/seaweedfs/issues/1724#issuecomment-753585046</MESSAGE>
      <SHA>039ad101b18e71fd8f0fb0006702678d11fc54fd</SHA>
      <PATCHEDFILES>
        <FILE>weed/storage/needle/needle_parse_upload.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
