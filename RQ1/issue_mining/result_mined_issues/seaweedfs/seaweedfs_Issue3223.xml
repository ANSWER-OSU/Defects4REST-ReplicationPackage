<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3223</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/3223</ISSUEURL>
  <TITLE>Master logs cause panic in the program, resulting in abnormal services</TITLE>
  <DESCRIPTION>panic stacks as follows: I0623 17:58:56 8 volume_growth.go:235] Created Volume 9050 on topo:idc1:rack1:172.24.10.131:32592 I0623 17:58:56 8 volume_layout.go:222] volume 9050 does not have enough copies I0623 17:58:56 8 volume_layout.go:227] volume 9050 remove from writable I0623 17:58:56 8 volume_layout.go:391] Volume 9050 becomes writable I0623 17:58:56 8 volume_growth.go:235] Created Volume 9050 on topo:idc1:rack2:172.24.10.132:32594 panic: runtime error: slice bounds out of range [18446744073709551615:200] goroutine 33054527 [running]: github.com/chrislusf/raft.(*Log).compact(0xc000534f50, 0x106c, 0x0) /Users/zhouzhuqun/文档/soft/goworkspace/src/github.com/zhuqunzhou/seaweedfs/vendor/github.com/chrislusf/raft/log.go:592 +0x4a7 github.com/chrislusf/raft.(*server).TakeSnapshot(0xc000899c20) /Users/zhouzhuqun/文档/soft/goworkspace/src/github.com/zhuqunzhou/seaweedfs/vendor/github.com/chrislusf/raft/server.go:1279 +0x591 github.com/chrislusf/raft.(*server).maybeTakeSnapshot.func1() /Users/zhouzhuqun/文档/soft/goworkspace/src/github.com/zhuqunzhou/seaweedfs/vendor/github.com/chrislusf/raft/server.go:1221 +0x66 created by github.com/chrislusf/raft.(*server).maybeTakeSnapshot /Users/zhouzhuqun/文档/soft/goworkspace/src/github.com/zhuqunzhou/seaweedfs/vendor/github.com/chrislusf/raft/server.go:1219 +0x96</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>java: fix data encryption fix https://github.com/chrislusf/seaweedfs/issues/3211</MESSAGE>
    <SHA>28f615dcae3972abb1cd25ce66de8c0b4c31c752</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>upgrade github.com/chrislusf/raft fix https://github.com/chrislusf/seaweedfs/issues/3223</MESSAGE>
      <SHA>46ae28d64cc9296e76d2c61350708e0765476d0c</SHA>
      <PATCHEDFILES>
        <FILE>go.mod</FILE>
        <FILE>go.sum</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
