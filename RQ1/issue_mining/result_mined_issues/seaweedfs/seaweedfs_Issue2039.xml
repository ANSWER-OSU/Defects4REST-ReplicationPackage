<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2039</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/2039</ISSUEURL>
  <TITLE>Unexpected response to s3 GET call on non-existent bucket</TITLE>
  <DESCRIPTION>**Describe the bug** Running a &quot;GET /nonexistent-bucket?acl&quot; - which is what a number of libraries use for &quot;does this bucket exist&quot; call, returns a ListBucketResult. According to S3 api docs, it should return a 'AccessControlPolicy' or at least a 404 for the nonexistent resource. **System Setup** docker run -p 8333:8333 chrislusf/seaweedfs server -s3 ``` nneul@optic:~ $ curl http://localhost:8333/nonexistent-bucket?acl &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;ListBucketResult xmlns=&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;&gt;&lt;Name&gt;nonexistent-bucket&lt;/Name&gt;&lt;Prefix&gt;&lt;/Prefix&gt;&lt;Marker&gt;&lt;/Marker&gt;&lt;MaxKeys&gt;10000&lt;/MaxKeys&gt;&lt;IsTruncated&gt;false&lt;/IsTruncated&gt;&lt;/ListBucketResult&gt; ``` **Expected behavior** AccessControlPolicy in response - even if it's a dummy/empty policy document, or a 404 or other error indicating it couldn't handle the request due to the bucket not being there.</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>add debug info</MESSAGE>
    <SHA>8cbd858dd922c1177fcdf8f5e6dab868460480ad</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>s3: return 404 if bucket does not exist fix https://github.com/chrislusf/seaweedfs/issues/2039</MESSAGE>
      <SHA>5f6b4cb6c8e5b4f8e03b3c419f9e072b8c34dc86</SHA>
      <PATCHEDFILES>
        <FILE>weed/s3api/s3api_objects_list_handlers.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
