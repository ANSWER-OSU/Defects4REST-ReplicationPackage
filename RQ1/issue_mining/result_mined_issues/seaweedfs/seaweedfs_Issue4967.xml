<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>4967</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/4967</ISSUEURL>
  <TITLE>webdav bug creates directories in wrong folder</TITLE>
  <DESCRIPTION>**Describe the bug** When using `weed webdav -filer.path` for a non `/` path, folders get created on the `/` of the filer instance the `weed webdav` is connected to **System Setup** weed 3.58 on seaweedfs docker container, arguments used for webdav: ``` -logtostderr webdav -collection=arman -replication=010 -port=${NOMAD_PORT_webdav} -filer=seaweedfs-filer-http.nomad:8888.18888 -filer.path=/buckets/arman -cacheDir=/alloc/data/ -cacheCapacityMB=1024 ``` on seaweedfs docker container, arguments used for filer: ``` -logtostderr filer -ip=${NOMAD_IP_http} -ip.bind=0.0.0.0 -master=seaweedfs-master-http.nomad:${var.master_port_http}.${var.master_port_grpc} -port=${NOMAD_PORT_http} -port.grpc=${NOMAD_PORT_grpc} -metricsPort=${NOMAD_PORT_metrics} -webdav -webdav.collection= -webdav.replication=020 -webdav.port=${NOMAD_PORT_webdav} ``` (so as you can see I am running a normal webdav instance with filer, and I am trying to set up a new one on a different container that points to a different path) **Expected behavior** When creating a folder in `weed webdav -filer.path=/buckets/arman` directory gets created under `/buckets/arman` in filer (for the example above). **Actual Behaviour** It gets created under the top-level `/` instead</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Bump github.com/prometheus/procfs from 0.11.1 to 0.12.0 (#4966) Bumps [github.com/prometheus/procfs](https://github.com/prometheus/procfs) from 0.11.1 to 0.12.0. - [Release notes](https://github.com/prometheus/procfs/releases) - [Commits](https://github.com/prometheus/procfs/compare/v0.11.1...v0.12.0) --- updated-dependencies: - dependency-name: github.com/prometheus/procfs dependency-type: direct:production update-type: version-update:semver-minor ... Signed-off-by: dependabot[bot] &lt;support@github.com&gt; Co-authored-by: dependabot[bot] &lt;49699333+dependabot[bot]@users.noreply.github.com&gt;</MESSAGE>
    <SHA>4bb3911fde1b73ef096dbe9d3a91a56c983d8c80</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>refactor webdav subdirectory, fixes #4967</MESSAGE>
      <SHA>48d18d6e69a6239eaaf16abf689b0fdbcc7ccaf7</SHA>
      <PATCHEDFILES>
        <FILE>weed/server/webdav_server.go</FILE>
        <FILE>weed/server/wrapped_webdav_fs.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>refactor webdav subdirectory, fixes #4967 (#4969) * refactor webdav subdirectory, fixes #4967 * fix bug where Name() was not called on delegate wrappedFileInfo</MESSAGE>
      <SHA>f99afc362c216abd7e725c842c1e60aaf6265cb8</SHA>
      <PATCHEDFILES>
        <FILE>weed/server/webdav_server.go</FILE>
        <FILE>weed/server/wrapped_webdav_fs.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>refactor webdav subdirectory, fixes #4967 (#4969) * refactor webdav subdirectory, fixes #4967 * fix bug where Name() was not called on delegate wrappedFileInfo</MESSAGE>
      <SHA>0fa25de2f3650457b375733824d35004b09aae0f</SHA>
      <PATCHEDFILES>
        <FILE>weed/server/webdav_server.go</FILE>
        <FILE>weed/server/wrapped_webdav_fs.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>refactor webdav subdirectory, fixes #4967 (#4969) * refactor webdav subdirectory, fixes #4967 * fix bug where Name() was not called on delegate wrappedFileInfo</MESSAGE>
      <SHA>3834ad5c486906f183a5ab8f71083682f2e14677</SHA>
      <PATCHEDFILES>
        <FILE>weed/server/webdav_server.go</FILE>
        <FILE>weed/server/wrapped_webdav_fs.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
