<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1983</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/1983</ISSUEURL>
  <TITLE>&quot;lock&quot; command would hang out the shell for using &quot;volume.fix.replication&quot;</TITLE>
  <DESCRIPTION>Hi, I've 5 volume servers with 3 disk and 8TB each of them Last night I format one 8 TB disk and use volume.fix.replication to repair deleted volumes, it worked good for repairing half of the volumes but after that it started to show following error and exited the shell continuously when I commit volume.fix.replication: ``` error: copying from weed-volume-005.s02.test.local:8080 =&gt; weed-volume-002.s02.test.local:8080 : rpc error: code = Unknown desc = failed to copy /srv/node/sdb/Group_40_208.dat file: receiving /srv/node/sdb/Group_40_208.dat: rpc error: code = Unknown desc = read /srv/node/sdd/Group_40_208.dat: input/output error ``` I entered again volume.fix.replication but it shows error and exit from shell again: ``` error: copying from weed-volume-005.s02.test.local:8080 =&gt; weed-volume-002.s02.test.local:8080 : rpc error: code = Unknown desc = failed to copy /srv/node/sdb/User_10_124.dat file: receiving /srv/node/sdb/User_10_124.dat: rpc error: code = Unknown desc = read /srv/node/sdd/User_10_124.dat: input/output error ``` today when I wanted to repair it again it couldn't lock the shell and it waits for lock command without donig anything: ![image](https://user-images.githubusercontent.com/43205944/114296403-81fa6080-9ac0-11eb-9b98-e5d27340b483.png) I restart all masters but still it is not working!!! What should I do?</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>11</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>clean up .uploads directory in mysql and postgres tables fix https://github.com/chrislusf/seaweedfs/issues/1957 When no uploads are running, you can run this SQL to clean up. delete from &lt;bucket_name&gt; where directory like '/.uploads/%'</MESSAGE>
    <SHA>f304287e99c6e960e3cae445a647400884e2a563</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>shell: show which server holds the lock fix https://github.com/chrislusf/seaweedfs/issues/1983</MESSAGE>
      <SHA>e732beff1ede3405c8e00be783aeea933a9593f8</SHA>
      <PATCHEDFILES>
        <FILE>weed/pb/master.proto</FILE>
        <FILE>weed/pb/master_pb/master.pb.go</FILE>
        <FILE>weed/server/master_grpc_server_admin.go</FILE>
        <FILE>weed/shell/command_fs_lock_unlock.go</FILE>
        <FILE>weed/wdclient/exclusive_locks/exclusive_locker.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
