<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1846</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/1846</ISSUEURL>
  <TITLE>[shell] fixUnderReplicatedVolumes</TITLE>
  <DESCRIPTION>For a large cluster, the replication process can take hours And during this time, the state of the cluster can change more than once. Get actual information for each replication action ``` replicating volume 507 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 560 100 from fast-volume-6.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 340 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 602 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 628 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 584 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 492 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 673 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 508 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 535 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 415 100 from fast-volume-6.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 506 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 385 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 448 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 453 100 from fast-volume-1.dc1:8080 to dataNode fast-volume-5.dc2:8080 ... replicating volume 359 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 680 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 382 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 317 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 497 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 398 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 629 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 607 100 from fast-volume-1.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 641 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 342 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 418 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 336 100 from fast-volume-0.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 402 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 473 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 464 100 from fast-volume-0.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 568 100 from fast-volume-1.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 651 100 from fast-volume-1.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 625 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 396 100 from fast-volume-6.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 515 100 from fast-volume-0.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 422 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 417 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 326 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 444 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 344 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 138 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 514 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 491 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 139 100 from fast-volume-1.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 587 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 505 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 571 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 499 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 339 100 from fast-volume-1.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 519 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 660 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 374 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 554 100 from fast-volume-0.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 427 100 from fast-volume-1.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 410 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 624 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 657 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 475 100 from fast-volume-1.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 403 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 308 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 513 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 349 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 494 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 323 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 663 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 633 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 579 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 364 100 from fast-volume-0.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 472 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 443 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 361 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 694 100 from fast-volume-6.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 338 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 632 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 564 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 290 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 688 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 656 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 523 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 691 100 from fast-volume-0.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 550 100 from fast-volume-6.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 682 100 from fast-volume-0.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 511 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 668 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 452 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 397 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 390 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 652 100 from fast-volume-7.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 434 100 from fast-volume-6.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 481 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 442 100 from fast-volume-4.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 532 100 from fast-volume-0.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 590 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 593 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 558 100 from fast-volume-1.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... replicating volume 621 100 from fast-volume-2.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 377 100 from fast-volume-3.dc2:8080 to dataNode fast-volume-0.dc1:8080 ... replicating volume 405 100 from fast-volume-5.dc2:8080 to dataNode fast-volume-1.dc1:8080 ... failed to place volume 407 replica as 100, existing:1 failed to place volume 640 replica as 100, existing:1 failed to place volume 645 replica as 100, existing:1 failed to place volume 544 replica as 100, existing:1 failed to place volume 605 replica as 100, existing:1 failed to place volume 27 replica as 010, existing:1 failed to place volume 531 replica as 100, existing:1 failed to place volume 493 replica as 100, existing:1 failed to place volume 432 replica as 100, existing:1 failed to place volume 466 replica as 100, existing:1 failed to place volume 627 replica as 100, existing:1 failed to place volume 421 replica as 100, existing:1 failed to place volume 341 replica as 100, existing:1 failed to place volume 363 replica as 100, existing:1 failed to place volume 462 replica as 100, existing:1 failed to place volume 404 replica as 100, existing:1 failed to place volume 479 replica as 100, existing:1 failed to place volume 580 replica as 100, existing:1 failed to place volume 597 replica as 100, existing:1 failed to place volume 591 replica as 100, existing:1 failed to place volume 555 replica as 100, existing:1 failed to place volume 18 replica as 010, existing:1 failed to place volume 569 replica as 100, existing:1 failed to place volume 615 replica as 100, existing:1 failed to place volume 22 replica as 010, existing:1 failed to place volume 313 replica as 100, existing:1 failed to place volume 261 replica as 100, existing:1 failed to place volume 522 replica as 100, existing:1 failed to place volume 263 replica as 100, existing:1 failed to place volume 520 replica as 100, existing:1 failed to place volume 420 replica as 100, existing:1 failed to place volume 379 replica as 100, existing:1 failed to place volume 144 replica as 010, existing:1 failed to place volume 578 replica as 100, existing:1 failed to place volume 646 replica as 100, existing:1 failed to place volume 525 replica as 100, existing:1 failed to place volume 581 replica as 100, existing:1 failed to place volume 463 replica as 100, existing:1 failed to place volume 696 replica as 100, existing:1 failed to place volume 563 replica as 100, existing:1 failed to place volume 357 replica as 100, existing:1 failed to place volume 365 replica as 100, existing:1 failed to place volume 260 replica as 100, existing:1 failed to place volume 527 replica as 100, existing:1 failed to place volume 373 replica as 100, existing:1 failed to place volume 316 replica as 100, existing:1 failed to place volume 604 replica as 100, existing:1 failed to place volume 529 replica as 100, existing:1 failed to place volume 408 replica as 100, existing:1 failed to place volume 423 replica as 100, existing:1 failed to place volume 565 replica as 100, existing:1 failed to place volume 351 replica as 100, existing:1 failed to place volume 140 replica as 100, existing:1 failed to place volume 388 replica as 100, existing:1 failed to place volume 510 replica as 100, existing:1 failed to place volume 146 replica as 010, existing:1 failed to place volume 23 replica as 010, existing:1 failed to place volume 501 replica as 100, existing:1 failed to place volume 329 replica as 100, existing:1 failed to place volume 517 replica as 100, existing:1 failed to place volume 661 replica as 100, existing:1 failed to place volume 467 replica as 100, existing:1 failed to place volume 380 replica as 100, existing:1 failed to place volume 588 replica as 100, existing:1 failed to place volume 468 replica as 100, existing:1 failed to place volume 658 replica as 100, existing:1 failed to place volume 647 replica as 100, existing:1 failed to place volume 332 replica as 100, existing:1 failed to place volume 360 replica as 100, existing:1 failed to place volume 353 replica as 100, existing:1 failed to place volume 343 replica as 100, existing:1 failed to place volume 667 replica as 100, existing:1 failed to place volume 387 replica as 100, existing:1 failed to place volume 618 replica as 100, existing:1 failed to place volume 488 replica as 100, existing:1 failed to place volume 533 replica as 100, existing:1 failed to place volume 616 replica as 100, existing:1 failed to place volume 474 replica as 100, existing:1 failed to place volume 6 replica as 010, existing:1 failed to place volume 690 replica as 100, existing:1 failed to place volume 476 replica as 100, existing:1 failed to place volume 686 replica as 100, existing:1 failed to place volume 498 replica as 100, existing:1 failed to place volume 391 replica as 100, existing:1 failed to place volume 376 replica as 100, existing:1 failed to place volume 543 replica as 100, existing:1 failed to place volume 419 replica as 100, existing:1 ``` https://github.com/chrislusf/seaweedfs/blob/6a4546d2c088b5d71f8b2200b758a82f1aad08c6/weed/shell/command_volume_fix_replication.go#L184</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>9</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #2348 from kmlebedev/fix/security trivy: security fix</MESSAGE>
    <SHA>dad88a452fec896ef16cbac348a280c72b765de7</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>https://github.com/chrislusf/seaweedfs/issues/1846</MESSAGE>
      <SHA>fc51ffce2b2e07145e6c7144781a40491febd6cb</SHA>
      <PATCHEDFILES>
        <FILE>weed/shell/command_volume_fix_replication.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
