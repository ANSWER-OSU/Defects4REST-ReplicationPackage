<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2387</ISSUENO>
  <ISSUEURL>https://github.com/seaweedfs/seaweedfs/issues/2387</ISSUEURL>
  <TITLE>[s3] FAILED tests</TITLE>
  <DESCRIPTION>``` 2.72 ``` ``` ====================================================================== FAIL: s3tests_boto3.functional.test_s3.test_copy_object_ifnonematch_failed ---------------------------------------------------------------------- Traceback (most recent call last): File &quot;/opt/s3-tests/virtualenv/lib/python3.8/site-packages/nose/case.py&quot;, line 198, in runTest self.test(*self.arg) File &quot;/opt/s3-tests/s3tests_boto3/functional/test_s3.py&quot;, line 13028, in test_copy_object_ifnonematch_failed eq(body, 'bar') AssertionError: 'bar\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' != 'bar' ``` ``` ====================================================================== FAIL: s3tests_boto3.functional.test_s3.test_object_write_check_etag ---------------------------------------------------------------------- Traceback (most recent call last): File &quot;/opt/s3-tests/virtualenv/lib/python3.8/site-packages/nose/case.py&quot;, line 198, in runTest self.test(*self.arg) File &quot;/opt/s3-tests/s3tests_boto3/functional/test_s3.py&quot;, line 2094, in test_object_write_check_etag eq(response['ETag'], '&quot;37b51d194a7513e45b56f6524f2d51f2&quot;') AssertionError: '&quot;9997a36a88a451df9f4c4552f8e884fa&quot;' != '&quot;37b51d194a7513e45b56f6524f2d51f2&quot;' &gt;&gt; raise AssertionError(None or &quot;%r != %r&quot; % ('&quot;9997a36a88a451df9f4c4552f8e884fa&quot;', '&quot;37b51d194a7513e45b56f6524f2d51f2&quot;')) ``` ``` ====================================================================== FAIL: s3tests_boto3.functional.test_s3.test_object_head_zero_bytes ---------------------------------------------------------------------- Traceback (most recent call last): File &quot;/opt/s3-tests/virtualenv/lib/python3.8/site-packages/nose/case.py&quot;, line 198, in runTest self.test(*self.arg) File &quot;/opt/s3-tests/s3tests_boto3/functional/test_s3.py&quot;, line 2083, in test_object_head_zero_bytes eq(response['ContentLength'], 0) AssertionError: 512 != 0 &gt;&gt; raise AssertionError(None or &quot;%r != %r&quot; % (512, 0)) ```</DESCRIPTION>
  <REPONAME>seaweedfs</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>1.6.9</MESSAGE>
    <SHA>8cd7a0365b93dc3fcecfe252536c5024d19b508f</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix https://github.com/chrislusf/seaweedfs/issues/2387</MESSAGE>
      <SHA>dd2cc1acaf37efa7a58ce9df7cdc2d756ecfd473</SHA>
      <PATCHEDFILES>
        <FILE>weed/s3api/s3api_object_handlers.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
