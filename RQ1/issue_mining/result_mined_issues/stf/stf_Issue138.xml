<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>138</ISSUENO>
  <ISSUEURL>https://github.com/openstf/stf/issues/138</ISSUEURL>
  <TITLE>ports allocated to device are not returned to main pool</TITLE>
  <DESCRIPTION>lib/units/provider/index.js function spawn(){ var allocatedPorts = ports.splice(0, 2) , proc = options.fork(device, allocatedPorts) , resolver = Promise.defer() ... } after options.fork(...), allocatedPorts become empty, so that the allocated ports can not be returned. to fix it, we should pass value of allocatedPorts, not its reference. proc = options.fork(device, allocatedPorts.slice())</DESCRIPTION>
  <REPONAME>stf</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix AAB installation fails when /tmp is on different mountpoint than storage-temp save directory (#139) Signed-off-by: nghia.viminh &lt;nghia.viminh@gameloft.com&gt;</MESSAGE>
    <SHA>6b38be2b145eea2a139c07493f9cda8fb5d4b1c6</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Update Dockerfile for Debian armhf (#138) - update &quot;LABEL Url&quot; from openstf to devicefarmer - install &quot;cmake&quot; package Co-authored-by: Karol Wr√≥tniak &lt;karol.wrotniak@droidsonroids.pl&gt;</MESSAGE>
      <SHA>f677fababf906e4ec24af997ed32ff71732bfe09</SHA>
      <PATCHEDFILES>
        <FILE>Dockerfile-debian-armhf</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Allocated ports were not being released properly due to fork() now consuming the ports. Additionally fixes port pool grouping. Fixes #138.</MESSAGE>
      <SHA>396cfbad7fb8a87bb8ef08d7c27ffc26232e661e</SHA>
      <PATCHEDFILES>
        <FILE>lib/units/provider/index.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
