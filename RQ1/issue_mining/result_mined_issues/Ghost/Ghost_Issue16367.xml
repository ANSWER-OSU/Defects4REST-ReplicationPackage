<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>16367</ISSUENO>
  <ISSUEURL>https://github.com/TryGhost/Ghost/issues/16367</ISSUEURL>
  <TITLE>Generation of schemaorg according to the specification</TITLE>
  <DESCRIPTION>### Issue Summary It all started with a discussion on the forum: https://forum.ghost.org/t/schema-org-generate/36772/7 Apparently, schemaorg is not being generated correctly at the moment. Take, for example, a page https://ghost.org/changelog/vscode-extension/ Here's her json-id ``` &lt;script type=&quot;application/ld+json&quot;&gt; { &quot;@context&quot;: &quot;https://schema.org&quot;, &quot;@type&quot;: &quot;Article&quot;, &quot;publisher&quot;: { ... }, &quot;author&quot;: { .... }, &quot;headline&quot;: &quot;Ghost VS Code extension&quot;, &quot;url&quot;: &quot;https://ghost.org/changelog/vscode-extension/&quot;, &quot;datePublished&quot;: &quot;2023-01-30T16:51:03.000Z&quot;, &quot;dateModified&quot;: &quot;2023-01-30T16:51:03.000Z&quot;, &quot;image&quot;: { ... }, &quot;keywords&quot;: &quot;New&quot;, &quot;description&quot;: &quot;....&quot;, &quot;mainEntityOfPage&quot;: { &quot;@type&quot;: &quot;WebPage&quot;, &quot;@id&quot;: &quot;https://ghost.org/changelog/&quot; } } &lt;/script&gt; ``` mainEntityOfPage [according to the explanation of the developers schemaorg](https://github.com/schemaorg/schemaorg/discussions/3274) should contain a link to the article page, not a link to the blog. ### Steps to Reproduce Run ghost :) ### Ghost Version 5.36+ ### Node.js Version - ### How did you install Ghost? docker ### Database type MySQL 8 ### Browser &amp; OS version _No response_ ### Relevant log / error output _No response_ ### Code of Conduct - [X] I agree to be friendly and polite to people in this repository</DESCRIPTION>
  <REPONAME>Ghost</REPONAME>
  <TIMEDIFFERENCEDAYS>10</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fixed posts and email wrappers in worker threads refs https://ghost.slack.com/archives/C02G9E68C/p1679055933852679 - The posts api is used in the update-check job. This also uses the email wrapper, which needs the email-service - The email service is not initalized in the worker threads, this causes an error - Adds a check, because this part is optional in worker threads</MESSAGE>
    <SHA>f67b38daf414ec1de884644f5ce0c5ebd243e4e0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixed `mainEntityOfPage` property within page metadata fixes https://github.com/TryGhost/Ghost/issues/16367 refs https://github.com/schemaorg/schemaorg/discussions/3274 - after a discussion with the schemaorg maintainers, it looks like `mainEntityOfPage` should refer to the entity itself vs the parent entity - this commit updates the code to use the entity URL and fixes the associated tests</MESSAGE>
      <SHA>f13072d4de5b504bc83738a88888d3d10d8ab306</SHA>
      <PATCHEDFILES>
        <FILE>ghost/core/core/frontend/meta/schema.js</FILE>
        <FILE>ghost/core/test/unit/frontend/helpers/__snapshots__/ghost_head.test.js.snap</FILE>
        <FILE>ghost/core/test/unit/frontend/meta/schema.test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixed `mainEntityOfPage` property within page metadata fixes https://github.com/TryGhost/Ghost/issues/16367 refs https://github.com/schemaorg/schemaorg/discussions/3274 - after a discussion with the schemaorg maintainers, it looks like `mainEntityOfPage` should refer to the entity itself vs the parent entity - this commit updates the code to use the entity URL and fixes the associated tests</MESSAGE>
      <SHA>b7a03ca7655297efc5638707968317672f2dc900</SHA>
      <PATCHEDFILES>
        <FILE>ghost/core/core/frontend/meta/schema.js</FILE>
        <FILE>ghost/core/test/unit/frontend/helpers/__snapshots__/ghost_head.test.js.snap</FILE>
        <FILE>ghost/core/test/unit/frontend/meta/schema.test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
