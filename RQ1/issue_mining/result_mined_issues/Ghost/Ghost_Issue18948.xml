<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>18948</ISSUENO>
  <ISSUEURL>https://github.com/TryGhost/Ghost/issues/18948</ISSUEURL>
  <TITLE>Lexical kg-cards missing on website after ghost update with zip</TITLE>
  <DESCRIPTION>### Issue Summary I updated my custom Ghost to version 5.71.2. It runs fine in development via `yarn dev`, but upgrading the 5.70 docker with an .tgz file from `yarn archive` brings up some problems. When editing existing posts (mobiledoc) and saving them with the new editor (lexical) ALL images and other kg-cards will not show up anymore on the website of this post. There is not a single error in webconsole or `docker-compose logs -f` during/saving editing or while upgrading ghost. When running the original 5.71 docker image or `yarn dev` everything runs fine without this issue. ~Looking into the sqlite database, I'll found that the lexical code is complete with the image.~ So it seems like an update problem, that I cant narrow down without some help. Any idea how to fix this? ### Steps to Reproduce 1. create the following DOCKERFILE ``` FROM ghost:5.71.0-alpine WORKDIR /var/lib/ghost COPY ./ghost-5.71.2.tgz /var/lib RUN apk add --no-cache git USER node RUN yarn --version RUN yarn cache clean RUN rm -rf node_modules RUN yarn RUN chmod -R 00775 /var/lib/ghost/content &amp;&amp;\ ghost update --force --zip /var/lib/ghost-5.71.2.tgz RUN chmod -R 00775 /var/lib/ghost/content ``` 2. create the docker-compose.yml ``` version: '3.1' services: lfg-ghost: build: . container_name: lfg-ghost restart: always ports: - 2368:2368 volumes: - ./content:/var/lib/ghost/content - ./.env:/var/lib/ghost/.env environment: NODE_ENV: development database__client: sqlite3 database__connection__filename: /var/lib/ghost/content/data/ghost.db url: mail__transport: SMTP mail__from: mail__options__service: SMTP mail__options__host: mail__options__port: 587 mail__options__auth__user: mail__options__auth__pass: ``` 3. Download the release file from [here](https://github.com/ASAMedia/Ghost-LFG/releases/tag/5.71.2-lfg.19) 4. run `sudo docker-compose build`, `sudo docker-compose up -d` ### Ghost Version 5.71.2 ### Node.js Version 18 ### How did you install Ghost? docker-compose ### Database type SQLite3 ### Browser &amp; OS version Win 11/Ubuntu 20/Chrome/Firefox/Edge ### Relevant log / error output _No response_ ### Code of Conduct - [X] I agree to be friendly and polite to people in this repository</DESCRIPTION>
  <REPONAME>Ghost</REPONAME>
  <TIMEDIFFERENCEDAYS>191</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Added support for GET /inbox/:owner ref https://linear.app/tryghost/issue/MOM-127 We're gonna want auth &amp; filtering on this long term, but for now whilst in development it's fine as is.</MESSAGE>
    <SHA>fd8bbeebcf8fee63da381377ce19f4407ce3550c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixed certain snippets not inserting correctly (#20129) ref https://linear.app/tryghost/issue/ONC-26/support-escalation-template-bug ref https://github.com/TryGhost/Ghost/issues/18948 - bumps `@tryghost/koenig-lexical` to version that doesn't crash during snippet insertion when last node doesn't match expectations for inserting a trailing paragraph - bumps all Koenig packages to ensure internal dependencies are pinned to prevent potential issues from mixed versions caused by yarn resolution</MESSAGE>
      <SHA>239b5b636949f08dd79ca0a8b316f1661b626067</SHA>
      <PATCHEDFILES>
        <FILE>ghost/admin/package.json</FILE>
        <FILE>ghost/core/package.json</FILE>
        <FILE>ghost/email-service/package.json</FILE>
        <FILE>ghost/importer-revue/package.json</FILE>
        <FILE>yarn.lock</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
