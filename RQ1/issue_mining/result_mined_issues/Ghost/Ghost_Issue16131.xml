<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>16131</ISSUENO>
  <ISSUEURL>https://github.com/TryGhost/Ghost/issues/16131</ISSUEURL>
  <TITLE>Ghost Newsletter email includes ALL text when a paid-members newsletter is sent to free members, in plaintext only</TITLE>
  <DESCRIPTION>### Issue Summary When an email is sent to all members with the access set to 'paid members only', the expected behavior is that free members would see only the preview text, followed by a CTA to subscribe. That's exactly what happens for HTML email. However, plain text email reveals the FULL text. See images here: https://cathy.sarisky.link/newsletters-public-previews-and-more/ (post is not finished, but I think the images are revealing!) ### Steps to Reproduce 1- Create a post, add a public preview, put text above and below it. Set it to paid members only. 2. Email the newsletter to both free and paid members. Check the PLAIN TEXT of what free users receive. (In Gmail, 'show original'.) ### Ghost Version 5.30.0 ### Node.js Version Ghost Pro. ### How did you install Ghost? Ghost Pro. ### Database type MySQL 8 ### Browser &amp; OS version Ghost Pro / tested with a Gmail and Outlook addresses ### Relevant log / error output _No response_ ### Code of Conduct - [X] I agree to be friendly and polite to people in this repository</DESCRIPTION>
  <REPONAME>Ghost</REPONAME>
  <TIMEDIFFERENCEDAYS>163</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Bumped Koenig packages no issue</MESSAGE>
    <SHA>08e1bcd50c0410d9e3f671706ffb23127f41e4f0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixed members-only content incorrectly showing in plaintext email (#17137) fixes https://github.com/TryGhost/Ghost/issues/16131 Members only content was incorrectly being shown in a plaintext email due to the email `preheader` using the post model `plaintext` field directly (which contained the members-only content). This changes this behaviour so that the post html content is utilised for the `preheader` but has all members-only content (post-preview content + segmented content) removed</MESSAGE>
      <SHA>576fba05688135d1247764e348315ebe05569995</SHA>
      <PATCHEDFILES>
        <FILE>ghost/email-service/lib/EmailRenderer.js</FILE>
        <FILE>ghost/email-service/test/email-renderer.test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
