<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>15267</ISSUENO>
  <ISSUEURL>https://github.com/TryGhost/Ghost/issues/15267</ISSUEURL>
  <TITLE>Links with cyrillic characters are not being redirected</TITLE>
  <DESCRIPTION>### Issue Summary I added some redirects through `Ghost admin panel → Settings → Labs → Redirects`. But the redirects with Cyrillic characters are not working - it just shows the 404 page. Here's the content of a YAML file I uploaded: ``` 301: /joloonii-surgaltuud/b-angilal/: /joloonii-angilal/#в-ангилал /joloonii-surgaltuud/c-angilal/: /joloonii-angilal/#с-ангилал /joloonii-surgaltuud/а-ангилал/: /joloonii-angilal/#а-ангилал /joloonii-surgaltuud/м-ангилал: /joloonii-angilal/#м-ангилал ``` The first two works fine, but not the last two (I assume it's because they contain Cyrillic characters like `л, г, н`, etc) ### Steps to Reproduce 1. Upload a `.yaml` file containing redirects with Cyrillic characters on `Ghost admin panel → Settings → Labs → Redirects` 2. Check if the redirect works ### Ghost Version 5.9.4 ### Node.js Version v16.14.2 ### How did you install Ghost? Ubuntu 20.04.4 LTS ### Database type MySQL 8 ### Browser &amp; OS version _No response_ ### Relevant log / error output _No response_ ### Code of Conduct - [X] I agree to be friendly and polite to people in this repository</DESCRIPTION>
  <REPONAME>Ghost</REPONAME>
  <TIMEDIFFERENCEDAYS>55</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Added e2e tests for `page.scheduled` webhook (#15609) refs: https://github.com/TryGhost/Ghost/issues/15537 - snapshot test created to add confidence to webhook stability and increase overall test coverage.</MESSAGE>
    <SHA>e2124314ede4b41dcf508ea9f048bd393e66a9a1</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixed redirects with special characters (#15533) closes: https://github.com/TryGhost/Ghost/issues/15267 - This was because the URLs were not being encoded and matched correctly - it is solved by encoding the URL before adding to the router.</MESSAGE>
      <SHA>3424222597346fbedc1b832e095eecdc53edc3bd</SHA>
      <PATCHEDFILES>
        <FILE>ghost/express-dynamic-redirects/lib/DynamicRedirectManager.js</FILE>
        <FILE>ghost/express-dynamic-redirects/test/DynamicRedirectManager.test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixed redirects with special characters (#15533) closes: https://github.com/TryGhost/Ghost/issues/15267 - This was because the URLs were not being encoded and matched correctly - it is solved by encoding the URL before adding to the router.</MESSAGE>
      <SHA>1e8e38f8fb33a8c79d76fbf57a373660c727368a</SHA>
      <PATCHEDFILES>
        <FILE>ghost/express-dynamic-redirects/lib/DynamicRedirectManager.js</FILE>
        <FILE>ghost/express-dynamic-redirects/test/DynamicRedirectManager.test.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
