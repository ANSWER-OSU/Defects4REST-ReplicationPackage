<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>16120</ISSUENO>
  <ISSUEURL>https://github.com/TryGhost/Ghost/issues/16120</ISSUEURL>
  <TITLE>scriptUrl.includes is not a function when SodoSearch has url:false</TITLE>
  <DESCRIPTION>### Issue Summary Hi Ghost Team, When you want to disable the loading of SodoSearch library on Ghost using url:false described in the documentation : ` &quot;sodoSearch&quot;: { &quot;url&quot;: false } ` Ghost returns this message in the error log : ` &quot;ScriptUrl.includes is not a function at getFrontendAppConfig (/data/www/www.xxxx.org/versions/5.30.0/core/frontend/utils/frontend-apps.js:7:19) ` The code : ` let scriptUrl = config.get(`${app}:url`); let stylesUrl = config.get(`${app}:styles`); if (scriptUrl.includes('{version}')) { scriptUrl = scriptUrl.replace('{version}', appVersion); } if (stylesUrl?.includes('{version}')) { stylesUrl = stylesUrl.replace('{version}', appVersion); } ` Its look like a merge error : style.include and stylesUrl?.include are present twice in the function ? https://github.com/TryGhost/Ghost/blob/main/ghost/core/core/frontend/utils/frontend-apps.js ### Steps to Reproduce 1. Disable SodoSearch in the config file. 2. Check the Ghost error log ### Ghost Version v5.30.0 ### Node.js Version v16.19.0 ### How did you install Ghost? Ghost CLI + Ghost Update ### Database type MySQL 8 ### Browser &amp; OS version _No response_ ### Relevant log / error output ```shell {&quot;name&quot;:&quot;Log&quot;,&quot;hostname&quot;:&quot;sd-130779&quot;,&quot;pid&quot;:1942748,&quot;level&quot;:50,&quot;version&quot;:&quot;5.30.0&quot;,&quot;err&quot;:{&quot;domain&quot;:&quot;https://www.xxx.org&quot;,&quot;message&quot;:&quot;scriptUrl.includes is not a function&quot;,&quot;stack&quot;:&quot;TypeError: scriptUrl.includes is not a function\n at getFrontendAppConfig (/data/www/www.xxx.org/versions/5.30.0/core/frontend/utils/frontend-apps.js:7:19)\n at getSearchHelper (/data/www/www.xxx.org/versions/5.30.0/core/frontend/helpers/ghost_head.js:74:36)\n at Object.ghost_head (/data/www/www.xxx.org/versions/5.30.0/core/frontend/helpers/ghost_head.js:217:23)\n at async Object.returnAsync (/data/www/www.xxx.org/versions/5.30.0/core/frontend/services/helpers/handlebars.js:16:30)&quot;},&quot;msg&quot;:&quot;scriptUrl.includes is not a function&quot;,&quot;time&quot;:&quot;2023-01-14T15:22:33.637Z&quot;,&quot;v&quot;:0} ``` ### Code of Conduct - [X] I agree to be friendly and polite to people in this repository</DESCRIPTION>
  <REPONAME>Ghost</REPONAME>
  <TIMEDIFFERENCEDAYS>159</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Added tests for AdminX navigation settings (#17109) - Updated test request records to be distinct per API call - Updated design tests to check preview data - Added tests for navigation settings refs https://github.com/TryGhost/Team/issues/3349</MESSAGE>
    <SHA>2d6e988017974ab47cda28bc21abb43e92ac98be</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fixed disabling search via config fixes https://github.com/TryGhost/Ghost/issues/16120 - if you set `sodoSearch.url` to `false` in config, it'll currently crash because we're not correctly handling the types correctly - the first part of the fix is ensuring the value is a string so we can call `.includes` on it - second, the `false` value is passed into the output as a string, so we should detect if we passed a false value and early return with an empty string if so</MESSAGE>
      <SHA>c9e15faf4fc34a78f2eebd2bec379c007b40d8c3</SHA>
      <PATCHEDFILES>
        <FILE>ghost/core/core/frontend/helpers/ghost_head.js</FILE>
        <FILE>ghost/core/core/frontend/utils/frontend-apps.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixed disabling search via config fixes https://github.com/TryGhost/Ghost/issues/16120 - if you set `sodoSearch.url` to `false` in config, it'll currently crash because we're not correctly handling the types correctly - the first part of the fix is ensuring the value is a string so we can call `.includes` on it - second, the `false` value is passed into the output as a string, so we should detect if we passed a false value and early return with an empty string if so - credits to https://github.com/ltoinel for the fix inspiration</MESSAGE>
      <SHA>41c54b44a21967db5e96a26e749cf38e971a6b7b</SHA>
      <PATCHEDFILES>
        <FILE>ghost/core/core/frontend/helpers/ghost_head.js</FILE>
        <FILE>ghost/core/core/frontend/utils/frontend-apps.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fixed disabling search via config fixes https://github.com/TryGhost/Ghost/issues/16120 - if you set `sodoSearch.url` to `false` in config, it'll currently crash because we're not correctly handling the types correctly - the first part of the fix is ensuring the value is a string so we can call `.includes` on it - second, the `false` value is passed into the output as a string, so we should detect if we passed a false value and early return with an empty string if so - credits to https://github.com/ltoinel for the fix inspiration</MESSAGE>
      <SHA>55b7bef9addbdee043e7db383ff27b733f57b497</SHA>
      <PATCHEDFILES>
        <FILE>ghost/core/core/frontend/helpers/ghost_head.js</FILE>
        <FILE>ghost/core/core/frontend/utils/frontend-apps.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
