<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>26342</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/26342</ISSUEURL>
  <TITLE>Sort by payment type in the table dolibarr/compta/payment/list.php</TITLE>
  <DESCRIPTION>### Bug When I modify the file dolibarr/compta/payment/list.php by adding 'c.libelle' to the query: // DISTINCT is to avoid duplicate when there is a link to sales representatives $sql = &quot;SELECT DISTINCT p.rowid, p.ref, p.datep, p.fk_bank, p.amount, p.statut, p.num_paiement, c.libelle&quot;; $sql .= &quot;, c.code as paiement_code&quot;; $sql .= &quot;, ba.rowid as bid, ba.ref as bref, ba.label as blabel, ba.number, ba.account_number as account_number, ba.fk_accountancy_journal as accountancy_journal&quot;; $sql .= &quot;, s.rowid as socid, s.nom as name, s.email&quot;; The sorting is done correctly, and I no longer encounter any errors. ### Environment Version 18.0.1 ### Environment OS _No response_ ### Environment Web server _No response_ ### Environment PHP _No response_ ### Environment Database _No response_ ### Environment URL(s) _No response_ ### Expected and actual behavior When I click on 'type' in the payments table to sort it in ascending or descending order, I expect the data to be sorted correctly. However, instead, I receive the following error: Requested URL: /dolibarr/compta/payment/list.php?sortfield=c.libelle&amp;sortorder=asc&amp;begin=&amp;contextpage=paymentlist Referer: http://localhost/dolibarr/compta/payment/list.php?sortfield=c.libelle&amp;sortorder=desc&amp;begin=&amp;contextpage=paymentlist Menu Handler: eldy_menu.php Modules/Applications: syslog, user, api, contract, ficheinter, supplier_proposal, incoterm, tax, loan, propal, productbatch, stock, product, expedition, project, mailing, workflow, import, export, bookmark, fckeditor, gravatar, paypal, notification, clicktodial, blockedlog, agenda, bank, barcode, cron, order, donation, ecm, expensereport, supplier, holiday, margin, opensurvey, paybox, printing, resource, salaries, service, company, modulebuilder, webhook, emailcollector, debugbar, knowledgemanagement, externalids, ticket, invoice, direct_debit, recovery Database Manager Type: mysqli Error in the last database access: SELECT DISTINCT p.rowid, p.ref, p.datep, p.fk_bank, p.amount, p.statut, p.num_paiement, c.code as payment_code, ba.rowid as bid, ba.ref as bref, ba.label as blabel, ba.number, ba.account_number as account_number, ba.fk_accountancy_journal as accountancy_journal, s.rowid as socid, s.nom as name, s.email FROM llx_paiement as p LEFT JOIN llx_c_paiement as c ON p.fk_paiement = c.id LEFT JOIN llx_bank as b ON p.fk_bank = b.rowid LEFT JOIN llx_bank_account as ba ON b.fk_account = ba.rowid LEFT JOIN llx_payment_invoice as pf ON p.rowid = pf.fk_payment LEFT JOIN llx_invoice as f ON pf.fk_invoice = f.rowid LEFT JOIN llx_company as s ON f.fk_soc = s.rowid WHERE p.entity IN (1) ORDER BY c.libelle ASC LIMIT 26 Last database access return code in error: DB_ERROR_3065 Information on the last database access error: Expression #1 of ORDER BY clause is not in SELECT list, references column 'dolibarr18.0.1.c.libelle' which is not in SELECT list; this is incompatible with DISTINCT.&quot; ### Steps to reproduce the behavior &quot;The error occurs when I click on the 'type' column in the payment table dolibarr/compta/payment/list.php. ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>86</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge branch '17.0' of git@github.com:Dolibarr/dolibarr.git into 18.0</MESSAGE>
    <SHA>d9858d9bb7a1145937a1d39d05cf4d485cd1e0e1</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>FIX avoid sql error (issue #26342)</MESSAGE>
      <SHA>afda2429682d6bcb9e75089de98fb4c9b23c0092</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/compta/paiement/list.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #27643 from hregis/fix_syntax_error FIX avoid sql error (issue #26342)</MESSAGE>
      <SHA>9e23700a50a0475fd5212334bc833412f95b50fa</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/compta/paiement/list.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>FIX avoid sql error (issue #26342)</MESSAGE>
      <SHA>12aa205a960445505da50cc826014ac3384f96b3</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/compta/paiement/list.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
