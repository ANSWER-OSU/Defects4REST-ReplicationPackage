<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>30819</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/30819</ISSUEURL>
  <TITLE>Adherent address update crashes when LDAP sync is active</TITLE>
  <DESCRIPTION>### Bug If I try to update a postal address, I get a blank page and the address isnâ€™t changed. The error log is in the filed at the end of the form. ### Dolibarr Version 19.0.2 ### Environment PHP 8.2 ### Environment Database 5.5.5-10.6.14-MariaDB-log ### Steps to reproduce the behavior and expected behavior Update a postal address from adherents/card.php ### Attached files ``` 2024/08/31 20:03:56 [error] 13069#13069: *3417218 FastCGI sent in stderr: &quot;PHP message: PHP Warning: Undefined array key &quot;&quot; in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1359; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1359; PHP message: PHP Warning: Undefined array key &quot;&quot; in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1360; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1360; PHP message: PHP Warning: Undefined array key &quot;&quot; in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1362; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1362; PHP message: PHP Warning: Undefined array key &quot;useraccountcontrol&quot; in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1364; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1364; PHP message: PHP Warning: Undefined array key &quot;badpasswordtime&quot; in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1373; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1373&quot; while reading response header from upstream, client: 172.17.0.2, server: dolibarr.grif, request: &quot;POST /index.php?mainmenu=home HTTP/2.0&quot;, upstream: &quot;fastcgi://unix:/var/run/php-fpm-dolibarr.sock:&quot;, host: &quot;dolibarr.grif&quot;, referrer: &quot;https://dolibarr.grif/&quot; 2024/08/31 20:04:27 [error] 13069#13069: *3417218 FastCGI sent in stderr: &quot;PHP message: PHP Warning: Attempt to read property &quot;rowid&quot; on null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/lib/functions.lib.php(9788) : eval()'d code on line 1&quot; while reading upstream, client: 172.17.0.2, server: dolibarr.grif, request: &quot;GET /adherents/card.php?rowid=350&amp;save_lastsearch_values=1 HTTP/2.0&quot;, upstream: &quot;fastcgi://unix:/var/run/php-fpm-dolibarr.sock:&quot;, host: &quot;dolibarr.grif&quot;, referrer: &quot;https://dolibarr.grif/&quot; 2024/08/31 20:04:59 [error] 13069#13069: *3417218 FastCGI sent in stderr: &quot;PHP message: PHP Warning: Attempt to read property &quot;rowid&quot; on null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/lib/functions.lib.php(9788) : eval()'d code on line 1; PHP message: PHP Fatal error: Uncaught Error: Call to undefined method stdClass::_load_ldap_info() in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/triggers/interface_50_modLdap_Ldapsynchro.class.php:514 Stack trace: #0 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/interfaces.class.php(187): InterfaceLdapsynchro-&gt;runTrigger() #1 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/commonobject.class.php(6025): Interfaces-&gt;run_triggers() #2 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/adherents/class/adherent.class.php(949): CommonObject-&gt;call_trigger() #3 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/adherents/card.php(373): Adherent-&gt;update() #4 {main} thrown in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/triggers/interface_50_modLdap_Ldapsynchro.class.php on line 514&quot; while reading response header from upstream, client: 172.17.0.2, server: dolibarr.grif, request: &quot;POST /adherents/card.php HTTP/2.0&quot;, upstream: &quot;fastcgi://unix:/var/run/php-fpm-dolibarr.sock:&quot;, host: &quot;dolibarr.grif&quot;, referrer: &quot;https://dolibarr.grif/&quot; ```</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>79</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>FIX: invoice: revenue stamp wrongly converted to int (#31840)</MESSAGE>
    <SHA>7e9919e6b356929a9a89840e36d002197c510603</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add new check for ldap sync Closes: https://github.com/Dolibarr/dolibarr/issues/30819 Signed-off-by: Alarig Le Lay &lt;alarig@swordarmor.fr&gt;</MESSAGE>
      <SHA>3ef1f9ee65cbea59cb0e7e4aa78a502f42479365</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/triggers/interface_50_modLdap_Ldapsynchro.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add new check for ldap sync (#31925) Closes: https://github.com/Dolibarr/dolibarr/issues/30819 Signed-off-by: Alarig Le Lay &lt;alarig@swordarmor.fr&gt;</MESSAGE>
      <SHA>206570dac5e68caa1b11b4be3d8b96ff9f6ad15e</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/triggers/interface_50_modLdap_Ldapsynchro.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
