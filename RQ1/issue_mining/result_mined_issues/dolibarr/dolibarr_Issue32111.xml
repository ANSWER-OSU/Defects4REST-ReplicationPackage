<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>32111</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/32111</ISSUEURL>
  <TITLE>Impossible to set the date of a payment using API</TITLE>
  <DESCRIPTION>### Bug At `htdocs/compta/facture/class/api_invoices.class.php` you have: `$paymentobj-&gt;datepaye = dol_stringtotime($datepaye);` So the code expects a date string: 2024/11/26 (instead timestamp) but if I try to give a date string I get a response (from DOLIBARR API): Message: Bad Request: Invalid value specified for `datepaye`. Expecting unix timestamp, such as 1732638616 It is not possible to workaround this in my code, so I patched the code to be: `$paymentobj-&gt;datepaye = (int) $datepaye;` I don't know/have not checked if other part code of the code is sending date string instead of a timestamp Whatever is the write way to fix this (date string or timestamp), I will use it when this is addressed in a future release, thanks ### Dolibarr Version 20.0.1 ### Environment PHP 8.2 ### Environment Database _No response_ ### Steps to reproduce the behavior and expected behavior Use API to created/update a payment ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>3</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>add phpdoc (#32139) * add phpdoc * clean baseline</MESSAGE>
    <SHA>63e5e0ab77685234ff32f61f2b9bdda7b2c0f020</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Allow various format of dates on API paiement https://github.com/Dolibarr/dolibarr/issues/32111</MESSAGE>
      <SHA>ddf3431b81078a32b04319984e3771e7a4e2c998</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/compta/facture/class/api_invoices.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>FIX #32111, disable timestamp validator to allow various format https://github.com/Dolibarr/dolibarr/issues/32111</MESSAGE>
      <SHA>3f61d72036b9d3c80529f7cc20201b941e840865</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/compta/facture/class/api_invoices.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
