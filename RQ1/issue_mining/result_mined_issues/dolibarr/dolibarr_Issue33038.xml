<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>33038</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/33038</ISSUEURL>
  <TITLE>Drag and drop files are not prefixed with object reference</TITLE>
  <DESCRIPTION>### Bug Uploaded files are not prefixed with object reference even if const MAIN_DISABLE_SUGGEST_REF_AS_PREFIX is not enabled - when you drag and drop a file on supplier invoice card, the file uploaded is not prefixed with the object reference - and if the file name is not prefixed with object reference, when you want to export in accountancy (for example : using &quot;Quadratus&quot; format), you haven't the supplier invoices pieces (joined files) in archived file (ZIP) ### Dolibarr Version 18.0 until develop ### Environment PHP 7.4 ### Environment Database Mysql ### Steps to reproduce the behavior and expected behavior The const MAIN_DISABLE_SUGGEST_REF_AS_PREFIX is not enabled. Since v18 of Dolibarr, you can drag and drop directly from supplier invoice card : ![Image](https://github.com/user-attachments/assets/3fb80be7-a6d3-4ffd-9d2f-1147cb230648) **-&gt; the uploaded file name is not prefixed with reference of this card** And if you upload a file from document tab : ![Image](https://github.com/user-attachments/assets/86be8f0b-fc0c-428e-a330-f4662824106f) **-&gt; the uploaded file name is prefixed with the reference of this card** ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>4</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #32616 from rycks/18.0_fix_zero_is_a_value_into_dictionnary zero could be a value</MESSAGE>
    <SHA>09df62600e06ffda59f12114bbdb4bbb9f624e14</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>FIX #33038 drag and drop files are not prefixed with object reference</MESSAGE>
      <SHA>f7bd03fb751d611aee6e8483e29c1b8eaaa779e2</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/class/fileupload.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #33039 from Easya-Solutions/18.0_fix-fileupload-with-ref-as-prefix FIX #33038 drag and drop files are not prefixed with object reference</MESSAGE>
      <SHA>9516f9bbd2d6037a03b167de493c1be768b269f5</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/class/fileupload.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
