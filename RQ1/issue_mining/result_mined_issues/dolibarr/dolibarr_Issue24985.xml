<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>24985</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/24985</ISSUEURL>
  <TITLE>Thirdparty merging doesn't work if Donation module or Ticket module is not activated</TITLE>
  <DESCRIPTION>### Bug When trying to merge two thirdparties: - if Donation module is not activated then Dolibarr throws an error message stating that table `dolibarr.llx_don` doesn't exist. - if Ticket module is not activated then Dolibarr throws an error message stating that table `dolibarr.llx_ticket` doesn't exist. Activating both modules solves the issue but is probably not the right behaviour. Refer also to this message on the French Dolibarr forum: [Fusion de tiers table don’t exist](https://www.dolibarr.fr/forum/t/fusion-de-tiers-table-dont-exist/41814). ### Environment Version 16.0.5 ### Environment OS Linux ### Environment Web server Apache ### Environment PHP 7.4 ### Environment Database MariaDB ### Environment URL(s) _No response_ ### Expected and actual behavior Thirdparties shall merge flawlessly, with no error message prompted. ### Steps to reproduce the behavior ### Step 1 - Go to a thirdparty card (/societe/card.php?socid=n) - Click &quot;Merge&quot;. - Select the thirdparty to be merged with. - Click “Yes”. Dolibarr prompts an error message: ``` Table 'dolibarr.llx_don' doesn't exist Echec de la fusion de 2 enregistrements. Demande annulée. ``` (please also note that the first sentence of the error message is not translated). ### Step 2 - Activate the Donation module. - Repeat Step 1. Dolibarr prompts another error message: ``` Table 'dolibarr.llx_ticket' doesn't exist Echec de la fusion de 2 enregistrements. Demande annulée. » ``` ### Step 3 - Activate the Ticket module. - Repeat Step 1. Now Dolibarr prompts an OK message: `Les tiers ont été fusionnés`. ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #24934 from ATM-Consulting/FIX_Update_required_modules FIX : Add/Update required modules for thirdparties (by categ) &amp; partnership</MESSAGE>
    <SHA>4458b27c0961b74c86560457073b14f2fcaeb27e</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>FIX #24985 Societe - Function thirdparty merging not working with module whose tables are not deployed by default</MESSAGE>
      <SHA>0aaf7988b14f6abed5e484134735d5f9176e0cd3</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/societe/card.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #25001 from aspangaro/16p14 FIX #24985 Societe - Function thirdparty merging not working with module whose tables are not deployed by default</MESSAGE>
      <SHA>f73862b3bdfc4802a9a984c6733b9930ba2c1975</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/societe/card.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
