<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>28533</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/28533</ISSUEURL>
  <TITLE>BUG: Mo::deleteLine removes the &quot;main&quot; MoLine if consumed line is delete + GETPOST in class</TITLE>
  <DESCRIPTION>### Bug At MoLine with Product type &quot;Services&quot;: Delete consumed line... ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/8e675231-bcd6-4a43-a12a-4a7882e783b5) The result... the parent MoLine is deleted: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/6a71fe01-e1ac-41fc-8713-c28b71b190a8) In the database is the main MoLine deleted, but the linked MoLine is existing! ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/4f976b08-02aa-404b-9c64-856f54bca170) ### Environment Version 19 ### Environment OS _No response_ ### Environment Web server _No response_ ### Environment PHP _No response_ ### Environment Database _No response_ ### Environment URL(s) _No response_ ### Expected and actual behavior _No response_ ### Steps to reproduce the behavior _No response_ ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>381</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Prevent infinite loop with add notrigger parameter to the functions create, update &amp; setMultiLangs (#28530)</MESSAGE>
    <SHA>e6c4583bc46ed07aba68066517c32f4aa3a09117</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix #28533</MESSAGE>
      <SHA>161552e6fbe3f1605410b596d3e3adf73ae0c848</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/mrp/class/mo.class.php</FILE>
        <FILE>htdocs/mrp/mo_production.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>FIX #28533 Mo::deleteLine removes the &quot;main&quot; MoLine if consumed line is delete (#28535) * fix #28533 * qual for github actions * fix use $this-&gt;db in classes --------- Co-authored-by: christian.humpel &lt;christian.humpel@gmail.com&gt;</MESSAGE>
      <SHA>c069f3f161afe7dd811b836a244566ecdb46cd65</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/mrp/class/mo.class.php</FILE>
        <FILE>htdocs/mrp/mo_production.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Revert &quot;FIX #28533 Mo::deleteLine removes the &quot;main&quot; MoLine if consumed line …&quot; This reverts commit c069f3f161afe7dd811b836a244566ecdb46cd65.</MESSAGE>
      <SHA>ba78a7fce8e7054df23100f91447622503c1a74a</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/mrp/class/mo.class.php</FILE>
        <FILE>htdocs/mrp/mo_production.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Revert &quot;FIX #28533 Mo::deleteLine removes the &quot;main&quot; MoLine if consumed line …&quot; (#28564) This reverts commit c069f3f161afe7dd811b836a244566ecdb46cd65.</MESSAGE>
      <SHA>6e7263a04756399d5283f2fcdf8df9d906507c29</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/mrp/class/mo.class.php</FILE>
        <FILE>htdocs/mrp/mo_production.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge branch '#28533-BUG-ModeleteLine-19.0' into #28481-REST-API-MOS_19.0</MESSAGE>
      <SHA>3b2d8adc6318a5ba0515505c66b2d7a986ef46d7</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/mrp/mo_production.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge branch '#28533-BUG-MoDeleteLine-19-v3' into #28533-BUG-MoDeleteLine-19-v2</MESSAGE>
      <SHA>ce8c06faca53191e291d34db3dd64565bf1b8e98</SHA>
      <PATCHEDFILES>
        <FILE>ChangeLog</FILE>
        <FILE>htdocs/comm/card.php</FILE>
        <FILE>htdocs/compta/facture/class/facture.class.php</FILE>
        <FILE>htdocs/compta/sociales/list.php</FILE>
        <FILE>htdocs/core/class/commoninvoice.class.php</FILE>
        <FILE>htdocs/core/lib/functions.lib.php</FILE>
        <FILE>htdocs/filefunc.inc.php</FILE>
        <FILE>htdocs/fourn/class/fournisseur.facture.class.php</FILE>
        <FILE>htdocs/fourn/facture/list.php</FILE>
        <FILE>htdocs/mrp/class/mo.class.php</FILE>
        <FILE>htdocs/mrp/mo_production.php</FILE>
        <FILE>htdocs/takepos/pay.php</FILE>
        <FILE>test/phpunit/SecurityTest.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge branch '19.0' into #28533-BUG-MoDeleteLine-19-v3</MESSAGE>
      <SHA>b5fd64648febb636a4fdb46889fe823c42d07844</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/lib/security.lib.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
