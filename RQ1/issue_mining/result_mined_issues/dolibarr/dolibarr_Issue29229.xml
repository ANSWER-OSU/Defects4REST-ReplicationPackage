<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>29229</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/29229</ISSUEURL>
  <TITLE>PHP warning on updating html type extrafield</TITLE>
  <DESCRIPTION>### Bug On the update() function of extrafields.class.php file, when we update extrafield as html type, the variable $lengthdb is not set. It generate a php warning. This error doesn't appear on extrafield edit page (like &quot;/societe/admin/societe_extrafields.php&quot; page or others) because when we update, we reload the page but it is still present even if we can't see it. This is not a problem on these pages but if we update an extrafield from module descriptor, the page isn't reloaded and we can see this warning : ![Capture d’écran 2024-04-04 à 09 56 51](https://github.com/Dolibarr/dolibarr/assets/9167207/37a56e82-3aca-449f-9830-faf06058f162) The page can't be loaded because of the warning. The probleme comes from extrafields.class.php, in update() function l.606 : ![Capture d’écran 2024-04-04 à 14 26 04](https://github.com/Dolibarr/dolibarr/assets/9167207/3a53a311-bb5b-48fb-97d7-91c994d3d52e) ### Dolibarr Version 19.0.01 ### Environment PHP 8.2.10 ### Environment Database MySQL or MariaDB 8.0.31-0ubuntu0.20.04.2 ### Steps to reproduce the behavior and expected behavior Update an extrafield in module descriptor : $extrafields = new Extrafields($this-&gt;db); $res = $extrafields-&gt;update(&quot;extrafieldtest&quot;, &quot;Test&quot;, &quot;html&quot;, 2000, societe); Activate the module. ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>3</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix bug in translation (zh-cn) (#29264) &quot;由%s验证&quot; is in correctly written as &quot;由%验证s&quot;, causing failure in sprintf function in translate.class.php:743. [client 172.23.0.4:47410] PHP Fatal error: Uncaught ValueError: Unknown format specifie r &quot;\xe9&quot; in /var/www/html/core/class/translate.class.php:743\nStack trace:\n#0 /var/www/html/core/class/translate.class.php(743): sprintf()\n#1 /var/www/html/core/actions_massactions.inc.php(1638): Translate-&gt;transnoentitiesnoconv()\n#2 /var/www/html/holiday/list.php(221): include('... ')\n#3 {main}\n thrown in /var/www/html/core/class/translate.class.php on line 743</MESSAGE>
    <SHA>bab1694cfcc2e6f2dd806bb8b00217c4d79dabb9</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>PHP warning on updating html type extrafield (#29260) FIX: #29229</MESSAGE>
      <SHA>01d82614b650e5115f8d10810aa86156a56b4f1c</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/class/extrafields.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
