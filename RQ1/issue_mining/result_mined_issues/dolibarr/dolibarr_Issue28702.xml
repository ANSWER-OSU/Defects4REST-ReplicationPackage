<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>28702</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/28702</ISSUEURL>
  <TITLE>Send email from module Project fail</TITLE>
  <DESCRIPTION>### Bug Error 500 apear while sending email to Project participants. There is no error in Dolibarr log file, even debug is selected (there are only SQL queries). Error apears in the Nginx log as missing variable: ``` 2024/03/08 08:05:34 [error] 1057296#1057296: *368268 FastCGI sent in stderr: &quot;PHP message: PHP Fatal error: Uncaught Error: Call to a member function contact_get_property() on null in /var/www/dolibarr/htdocs/core/actions_sendmails.inc.php:207 Stack trace: #0 /var/www/dolibarr/htdocs/projet/card.php(520): include() #1 {main} thrown in /var/www/dolibarr/htdocs/core/actions_sendmails.inc.php on line 207&quot; while reading response header from upstream, client: 94.241.90.97, server: is.#####.cz, request: &quot;POST /projet/card.php?id=12 HTTP/2.0&quot;, upstream: &quot;fastcgi://unix:/run/php/php7.4-fpm.sock:&quot;, host: &quot;is.eglearn.cz&quot;, referrer: &quot;https://is.#####.cz/projet/card.php?action=presend&amp;token=c2d6efe671c9c87e402ba5bc8e79eadc&amp;id=12&amp;mode=init&quot; ``` It looks like there are missing email addresses. Send email from other modules works well. ### Dolibarr Version 19.0.0 ### Environment PHP 7.2 ### Environment Database MariaDB ### Steps to reproduce the behavior and expected behavior Current behaviour: 1. Navigate to project 2. Select &quot;Email&quot; 3. Choose contact from Project contacts list 4. Send email 5. Blank page apears with 500 error and no email is sent to participants Expected behaviour: Email is sent to participants ### Attached files Here screenshots from browser: ![Screenshot1](https://github.com/Dolibarr/dolibarr/assets/60854082/142bb068-9a8a-48fd-bdc4-fc2d7161aebc) ![Screnshot2](https://github.com/Dolibarr/dolibarr/assets/60854082/6e94a3c6-24be-4ca1-8fac-e767f58e2896) ![Screenshot3](https://github.com/Dolibarr/dolibarr/assets/60854082/f0f25ad7-dc6e-42f5-a6a9-3bfdb272c940)</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>301</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #32425 from hregis/fix_19_cannot_convert_if_prov FIX backport from develop to avoid php warning</MESSAGE>
    <SHA>8991dcb3eb8a9a0d0f5cdf00a1911e3b6534b801</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>FIX #28702</MESSAGE>
      <SHA>da7679dfda069a69040d904cee968f0c3feec87d</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/actions_sendmails.inc.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #32468 from hregis/fix_19_cannot_convert_if_prov FIX #28702</MESSAGE>
      <SHA>9e8fcba04ac6287ac2f18387b0888fcf042bc208</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/actions_sendmails.inc.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
