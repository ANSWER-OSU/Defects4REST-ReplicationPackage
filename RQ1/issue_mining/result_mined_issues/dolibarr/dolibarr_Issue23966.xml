<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>23966</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/23966</ISSUEURL>
  <TITLE>Error &quot;Param dbt_keyfield is required but not defined&quot; when external user clicks on &quot;show all events&quot; in contrat/card.php</TITLE>
  <DESCRIPTION>### Bug Error Message: Das System hat einen technischen Fehler festgestellt. Diese Informationen können für Diagnosezwecke nützlich sein (Sie können die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230220123606 Dolibarr: 16.0.4 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache/2.4.55 (Unix) PHP/7.4.33 OS: Darwin MacBook-gl.fritz.box 22.2.0 Darwin Kernel Version 22.2.0: Fri Nov 11 02:03:51 PST 2022; root:xnu-8792.61.2~4/RELEASE_ARM64_T6000 arm64 UserAgent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 Angefragte URL: /contrat/agenda.php?id=131 Referer: http://localhost:8000/contrat/card.php?id=131&amp;save_lastsearch_values=1 Menüverwaltung: eldy_menu.php Module/Anwendungen: api, syslog, propal, contrat, supplier_proposal, product, projet, bookmark, categorie, export, import, workflow, externalrss, fckeditor, notification, blockedlog, emailcollector, mailing, ldap, customizeforms, kawagencytodolistforcustomer, dolicalc, quicknotes, paymentbybanktransfer, prelevement, stock, reception, loan, tax, comptabilite, socialnetworks, clicktodial, multicurrency, ficheinter, productbatch, expedition, searcheverywhere, anexum, agenda, banque, cron, ecm, expensereport, holiday, margin, opensurvey, recruitment, resource, salaries, service, variants, societe, commande, ticket, facture, fournisseur, knowledgemanagement, advancedrules, user, fastsearchlists Message: Param dbt_keyfield is required but not defined XDebug informations: File: /Users/gl/Code/GitHub/doli-priv/htdocs/core/lib/security.lib.php Line: 617 Function: checkUserAccessToObject ### Environment Version 16.0.x ### Environment OS _No response_ ### Environment Web server _No response_ ### Environment PHP 7.4 ### Environment Database _No response_ ### Environment URL(s) contrat/card.php ### Expected and actual behavior _No response_ ### Steps to reproduce the behavior 1. Create and login as external user 2. Activate agenda (Events) module 3. Open a contract contrat/card.php 4. Click on &quot;Shwo all events&quot; on the right bottom corner of the page ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>update</MESSAGE>
    <SHA>3a8fbd3aa8dfbb8847abbe5e162a29ddbcb633ab</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>FIX:#23966 Error &quot;Param dbt_keyfield is required but not defined&quot;</MESSAGE>
      <SHA>36e73280bf50d85e5503131d5fc3ba81bb0f91aa</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/lib/security.lib.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>FIX: #23966 Error &quot;Param dbt_keyfield is required but not defined&quot;</MESSAGE>
      <SHA>9d43d51888111d944232af3180c364eff8e82ede</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/lib/security.lib.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Merge pull request #23967 from glu000/16.0-issue-23966 FIX: #23966 Error &quot;Param dbt_keyfield is required but not defined&quot;</MESSAGE>
      <SHA>d2125806435a233493df2a37181fe3699373617d</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/lib/security.lib.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
