<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>30516</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/30516</ISSUEURL>
  <TITLE>Error: When creating an invoice for a supplier order with a negative value</TITLE>
  <DESCRIPTION>### Bug &lt;h2&gt;Guide to reproduce the error:&lt;/h2&gt; When you try to create an invoice for an order with a negative value, an error occurs: ![image](https://github.com/user-attachments/assets/2c9f231c-5f90-4218-9fb0-8556486cd991) I proceed to create the invoice: ![image](https://github.com/user-attachments/assets/a1117247-af72-4409-b3b7-23396d3a86e0) I create the invoice: ![image](https://github.com/user-attachments/assets/4527f897-e343-485a-b36d-5e74d025aa9c) &lt;h2&gt; the error:&lt;/h2&gt; ![image](https://github.com/user-attachments/assets/647d964c-c626-4ed3-9878-50127ec9fa2f) &lt;h2&gt;Cause of the error&lt;/h2&gt; The error occurs when using instantiate the DiscountAbsolute object on line 471 of the htdocs/fourn/commande/list.php file. &lt;h2&gt;The solution:&lt;/h2&gt; To fix the error, you must import the class file of the instance that initially produces the error. (require_once DOL_DOCUMENT_ROOT.'/core/class/discount.class.php';) ### Dolibarr Version 19.2 ### Environment PHP 8.1.29 ### Environment Database 10.2.44-MariaDB ### Steps to reproduce the behavior and expected behavior ![image](https://github.com/user-attachments/assets/2c9f231c-5f90-4218-9fb0-8556486cd991) I proceed to create the invoice: ![image](https://github.com/user-attachments/assets/a1117247-af72-4409-b3b7-23396d3a86e0) I create the invoice: ![image](https://github.com/user-attachments/assets/4527f897-e343-485a-b36d-5e74d025aa9c) Error: ![image](https://github.com/user-attachments/assets/647d964c-c626-4ed3-9878-50127ec9fa2f) ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>28</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix var_dump</MESSAGE>
    <SHA>a17cb8aa423f75bf11c161c410fdf5721b6eb5ac</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Error: When creating an invoice for a supplier order with a negative value #30516 Error: When creating an invoice for a supplier order with a negative value #30516</MESSAGE>
      <SHA>5f85f914940ac76c50c527516d87c20132360863</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/fourn/commande/list.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
