<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>31228</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/31228</ISSUEURL>
  <TITLE>llx_receptiondet_batch_rowid_seq does not exist when creating reception</TITLE>
  <DESCRIPTION>### Bug When creating a new reception from a purchase order I get an error since update to 20.0.0 from version 19.0.3: ERROR: 42P01: relation &quot;llx_receptiondet_batch_rowid_seq&quot; does not exist LINE 1: SELECT currval('llx_receptiondet_batch_rowid_seq') ^ LOCATION: RangeVarGetRelidExtended, namespace.c:433 ### Dolibarr Version 20.0.0 ### Environment PHP 8.2 ### Environment Database postgresql 15 ### Steps to reproduce the behavior and expected behavior 1) Create purchase order and make that order 2) Create a reception and force to a specific warehouse ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>180</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Fix POS has some product unvisible when using smartphone</MESSAGE>
    <SHA>f7145ea4d3f0241ae7e7c5e5db2026e8ea148aba</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>migration: 19.0→20.0: rename llx_commande_fournisseur_dispatch sequences #31228 Fix an issue after upgrading to 20.0.x with the backend saying that the sequences llx_expeditiondet_batch_rowid_seq doesn't exist. The table was somehow renamed, and migration fixed for PostgreSQL in the following commits: - 3670ba75ba4f1172ea50c1f266af78e141402965: rename the table to match the intent of the table. - 9913778da0cd573c2f95718c4cb7a8370503918a: using VPGSQL comments to use a different RENAME function for PostgreSQL. - d73d27466bbd4a8592173d683f95fb861e8e63c7: Using RENAME TO which is compatible with both PostgreSQL and MySQL. But the sequence was still a leftover after those migrations. Pointed-out-by: Alexis Thietard Pointed-out-by: Geoffrey Mellar Fixes #31228</MESSAGE>
      <SHA>20d3b8fda4573a7ca0f08b95e01ec86eab7554bb</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/install/mysql/migration/19.0.0-20.0.0.sql</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>migration: 19.0→20.0: rename llx_commande_fournisseur_dispatch sequences #31228 Fix an issue after upgrading to 20.0.x with the backend saying that the sequences llx_expeditiondet_batch_rowid_seq doesn't exist. The table was somehow renamed, and migration fixed for PostgreSQL in the following commits: - 3670ba75ba4f1172ea50c1f266af78e141402965: rename the table to match the intent of the table. - 9913778da0cd573c2f95718c4cb7a8370503918a: using VPGSQL comments to use a different RENAME function for PostgreSQL. - d73d27466bbd4a8592173d683f95fb861e8e63c7: Using RENAME TO which is compatible with both PostgreSQL and MySQL. But the sequence was still a leftover after those migrations. Co-authored-by: Alexis Thietard Co-authored-by: Geoffrey Mellar Fixes #31228</MESSAGE>
      <SHA>d54ca258d5f8025ef8a2c1ecbbc5cd99747e8b8b</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/install/mysql/migration/19.0.0-20.0.0.sql</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>migration: 19.0→20.0: rename llx_commande_fournisseur_dispatch sequences #31228 (#33542) Fix an issue after upgrading to 20.0.x with the backend saying that the sequences llx_expeditiondet_batch_rowid_seq doesn't exist. The table was somehow renamed, and migration fixed for PostgreSQL in the following commits: - 3670ba75ba4f1172ea50c1f266af78e141402965: rename the table to match the intent of the table. - 9913778da0cd573c2f95718c4cb7a8370503918a: using VPGSQL comments to use a different RENAME function for PostgreSQL. - d73d27466bbd4a8592173d683f95fb861e8e63c7: Using RENAME TO which is compatible with both PostgreSQL and MySQL. But the sequence was still a leftover after those migrations. Co-authored-by: Alexis Thietard Co-authored-by: Geoffrey Mellar Fixes #31228</MESSAGE>
      <SHA>f7c9d4ecfc101bb9af9bb4167c5d83e0a5c67b25</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/install/mysql/migration/19.0.0-20.0.0.sql</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
