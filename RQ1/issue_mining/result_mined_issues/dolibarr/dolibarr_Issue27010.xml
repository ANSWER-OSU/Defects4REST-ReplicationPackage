<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>27010</ISSUENO>
  <ISSUEURL>https://github.com/Dolibarr/dolibarr/issues/27010</ISSUEURL>
  <TITLE>Possible to bill several times lines of an order already billed</TITLE>
  <DESCRIPTION>### Bug This is between a bug and a feature request Example : you create an invoice from an order, but you bill only some lines Some time after, you create an invoice from the same order : you'll see a warning that an invoice already exists for this order, but all the lines of the original order will be pre-selected, ignoring those that are already billed... This is true with both client invoices and supplier_invoices I will propose a PR to resolve this ### Environment Version all ### Environment OS All ### Environment Web server _No response_ ### Environment PHP _No response_ ### Environment Database _No response_ ### Environment URL(s) _No response_ ### Expected and actual behavior _No response_ ### Steps to reproduce the behavior _No response_ ### Attached files _No response_</DESCRIPTION>
  <REPONAME>dolibarr</REPONAME>
  <TIMEDIFFERENCEDAYS>376</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Debug v19</MESSAGE>
    <SHA>7ede5d8f8285c9dfe57c57b6911c887a3b4aedec</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix Possible to bill several times lines of an order already billed #27010</MESSAGE>
      <SHA>7f7c669138e81432d58343439b1e9a652cb3255f</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/compta/facture/card.php</FILE>
        <FILE>htdocs/core/class/commoninvoice.class.php</FILE>
        <FILE>htdocs/fourn/facture/card.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix Possible to bill several times lines of an order already billed #27010</MESSAGE>
      <SHA>904edcef96ea0d20c08ab0ed034b9fdb803c75c3</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/class/commoninvoice.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix Possible to bill several times lines of an order already billed #27010</MESSAGE>
      <SHA>4255a426927d43ce6e41ff7e181890c51e7deb74</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/class/commoninvoice.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix Possible to bill several times lines of an order already billed #27010</MESSAGE>
      <SHA>de00212cd68de96c7ad067deddf4be12a827b454</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/class/commoninvoice.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix Possible to bill several times lines of an order already billed #27010</MESSAGE>
      <SHA>ff3bef8a78b7f30793f06d34e5ab48b9a44ff218</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/compta/facture/card.php</FILE>
        <FILE>htdocs/core/class/commoninvoice.class.php</FILE>
        <FILE>htdocs/fourn/facture/card.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix Possible to bill several times lines of an order already billed #27010</MESSAGE>
      <SHA>8d99afbd84a5771c2cf529c0ed0ccca10fdf3cf3</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/class/commoninvoice.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix Possible to bill several times lines of an order already billed #27010</MESSAGE>
      <SHA>611e4e346bc4b4eb9706351171da9f230d687a3a</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/class/commoninvoice.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix Possible to bill several times lines of an order already billed #27010</MESSAGE>
      <SHA>55ca6a55a552140c065f6daf3dd3128e60a8d6a6</SHA>
      <PATCHEDFILES>
        <FILE>htdocs/core/class/commoninvoice.class.php</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
