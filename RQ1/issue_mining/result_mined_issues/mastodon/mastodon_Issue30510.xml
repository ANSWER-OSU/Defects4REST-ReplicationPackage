<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>30510</ISSUENO>
  <ISSUEURL>https://github.com/mastodon/mastodon/issues/30510</ISSUEURL>
  <TITLE>Capture Doorkeeper Application used to create the Report via the API</TITLE>
  <DESCRIPTION>### Pitch Currently there's an issue relating to the data quality of reports, where some clients just aren't sending useful information via the API to moderators. To help rectify this situation, I'd like to collect from which client a report was made, much like we collect the application used to create a status via the API. This would mean a migration to add an `application_id` column to reports, which would be nullable, and modifying the controller / ReportService to pass through that context from the controller: `application: doorkeeper_token.application` ### Motivation This will hopefully highlight which applications are producing low-quality reports, such that community pressure can build to drive better trust and safety practices in these applications.</DESCRIPTION>
  <REPONAME>mastodon</REPONAME>
  <TIMEDIFFERENCEDAYS>45</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Support multiple redirect_uris when creating OAuth 2.0 Applications (#29192)</MESSAGE>
    <SHA>2da2a1dae984f4083d1cc2f55642811c696955e6</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add optional application to reports This allows moderators to see the OAuth Application that was used to create the report, helping to identify applications that are not implementing the reports API fully, causing low-quality reports Fixes #30510</MESSAGE>
      <SHA>bbf07d5a800f16cd10bf0521c164eefdb0a92ea7</SHA>
      <PATCHEDFILES>
        <FILE>app/controllers/api/v1/reports_controller.rb</FILE>
        <FILE>app/models/report.rb</FILE>
        <FILE>app/services/report_service.rb</FILE>
        <FILE>app/views/admin/reports/_header_details.html.haml</FILE>
        <FILE>config/locales/en.yml</FILE>
        <FILE>db/migrate/20240603204215_add_application_to_reports.rb</FILE>
        <FILE>db/migrate/20240603211357_validate_add_application_to_reports.rb</FILE>
        <FILE>db/schema.rb</FILE>
        <FILE>spec/lib/activitypub/activity/flag_spec.rb</FILE>
        <FILE>spec/requests/api/v1/reports_spec.rb</FILE>
        <FILE>spec/services/report_service_spec.rb</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add optional application to reports This allows moderators to see the OAuth Application that was used to create the report, helping to identify applications that are not implementing the reports API fully, causing low-quality reports Fixes #30510</MESSAGE>
      <SHA>b050eb6cdb7d120ea3db20db945556b44d15e56d</SHA>
      <PATCHEDFILES>
        <FILE>app/controllers/api/v1/reports_controller.rb</FILE>
        <FILE>app/models/report.rb</FILE>
        <FILE>app/services/report_service.rb</FILE>
        <FILE>app/views/admin/reports/_header_details.html.haml</FILE>
        <FILE>config/locales/en.yml</FILE>
        <FILE>db/migrate/20240603204215_add_application_to_reports.rb</FILE>
        <FILE>db/migrate/20240603211357_validate_add_application_to_reports.rb</FILE>
        <FILE>db/schema.rb</FILE>
        <FILE>spec/lib/activitypub/activity/flag_spec.rb</FILE>
        <FILE>spec/requests/api/v1/reports_spec.rb</FILE>
        <FILE>spec/services/report_service_spec.rb</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add optional application to reports This allows moderators to see the OAuth Application that was used to create the report, helping to identify applications that are not implementing the reports API fully, causing low-quality reports Fixes #30510</MESSAGE>
      <SHA>e674747e980dcf210657e199258805ff14a4fcca</SHA>
      <PATCHEDFILES>
        <FILE>app/controllers/api/v1/reports_controller.rb</FILE>
        <FILE>app/models/report.rb</FILE>
        <FILE>app/services/report_service.rb</FILE>
        <FILE>app/views/admin/reports/_header_details.html.haml</FILE>
        <FILE>config/locales/en.yml</FILE>
        <FILE>db/migrate/20240603204215_add_application_to_reports.rb</FILE>
        <FILE>db/migrate/20240603211357_validate_add_application_to_reports.rb</FILE>
        <FILE>db/schema.rb</FILE>
        <FILE>spec/lib/activitypub/activity/flag_spec.rb</FILE>
        <FILE>spec/requests/api/v1/reports_spec.rb</FILE>
        <FILE>spec/services/report_service_spec.rb</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add optional application to reports This allows moderators to see the OAuth Application that was used to create the report, helping to identify applications that are not implementing the reports API fully, causing low-quality reports Fixes #30510</MESSAGE>
      <SHA>819746642051e27de0f1884018757623bf4fce53</SHA>
      <PATCHEDFILES>
        <FILE>app/controllers/api/v1/reports_controller.rb</FILE>
        <FILE>app/models/report.rb</FILE>
        <FILE>app/services/report_service.rb</FILE>
        <FILE>app/views/admin/reports/_header_details.html.haml</FILE>
        <FILE>config/locales/en.yml</FILE>
        <FILE>db/migrate/20240603204215_add_application_to_reports.rb</FILE>
        <FILE>db/migrate/20240603211357_validate_add_application_to_reports.rb</FILE>
        <FILE>db/schema.rb</FILE>
        <FILE>spec/lib/activitypub/activity/flag_spec.rb</FILE>
        <FILE>spec/requests/api/v1/reports_spec.rb</FILE>
        <FILE>spec/services/report_service_spec.rb</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add optional application to reports This allows moderators to see the OAuth Application that was used to create the report, helping to identify applications that are not implementing the reports API fully, causing low-quality reports Fixes #30510</MESSAGE>
      <SHA>8e60af3cb7acb7038f68fbb7c10c11107df7802f</SHA>
      <PATCHEDFILES>
        <FILE>app/controllers/api/v1/reports_controller.rb</FILE>
        <FILE>app/models/report.rb</FILE>
        <FILE>app/services/report_service.rb</FILE>
        <FILE>app/views/admin/reports/_header_details.html.haml</FILE>
        <FILE>config/locales/en.yml</FILE>
        <FILE>db/migrate/20240603204215_add_application_to_reports.rb</FILE>
        <FILE>db/migrate/20240603211357_validate_add_application_to_reports.rb</FILE>
        <FILE>db/schema.rb</FILE>
        <FILE>spec/lib/activitypub/activity/flag_spec.rb</FILE>
        <FILE>spec/requests/api/v1/reports_spec.rb</FILE>
        <FILE>spec/services/report_service_spec.rb</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add optional application to reports This allows moderators to see the OAuth Application that was used to create the report, helping to identify applications that are not implementing the reports API fully, causing low-quality reports Fixes #30510</MESSAGE>
      <SHA>cbec52be01739398d26c7c7db9e4992dfd165642</SHA>
      <PATCHEDFILES>
        <FILE>app/controllers/api/v1/reports_controller.rb</FILE>
        <FILE>app/models/report.rb</FILE>
        <FILE>app/services/report_service.rb</FILE>
        <FILE>app/views/admin/reports/_header_details.html.haml</FILE>
        <FILE>config/locales/en.yml</FILE>
        <FILE>db/migrate/20240713171841_add_application_to_reports.rb</FILE>
        <FILE>db/migrate/20240713171909_validate_add_application_to_reports.rb</FILE>
        <FILE>db/schema.rb</FILE>
        <FILE>spec/lib/activitypub/activity/flag_spec.rb</FILE>
        <FILE>spec/requests/api/v1/reports_spec.rb</FILE>
        <FILE>spec/services/report_service_spec.rb</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
