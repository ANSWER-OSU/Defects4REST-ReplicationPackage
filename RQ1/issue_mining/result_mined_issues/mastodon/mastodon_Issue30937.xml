<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>30937</ISSUENO>
  <ISSUEURL>https://github.com/mastodon/mastodon/issues/30937</ISSUEURL>
  <TITLE>LinkCrawlWorker NoMethodError: undefined method `encode' for an instance of Array</TITLE>
  <DESCRIPTION>### Steps to reproduce the problem Seen on these pages: https://www.smithsonianmag.com/history/how-the-rise-of-the-camera-launched-a-fight-to-protect-gilded-age-americans-privacy-180984656/ https://www.bostonglobe.com/2024/07/05/metro/wampanoag-plymouth-dei-cape-cod/ ![CleanShot 2024-07-05 at 17 51 00@2x](https://github.com/mastodon/mastodon/assets/3002053/e05b590b-ccb5-4866-9bba-ee020283d867) ### Expected behaviour No error ### Actual behaviour Error ### Detailed description I seems like these are triggered from the author details on the page being listed in an array. ### Mastodon instance vmst.io ### Mastodon version v4.3.0-alpha.5 ### Technical details Latest `main`</DESCRIPTION>
  <REPONAME>mastodon</REPONAME>
  <TIMEDIFFERENCEDAYS>2</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>New Crowdin Translations (automated) (#30940) Co-authored-by: GitHub Actions &lt;noreply@github.com&gt;</MESSAGE>
    <SHA>1a37862a7606058026b1e55b767f38a6f82da504</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix author names as arrays in linked data. See #30937 for examples. Some web sites seem to wrap author names in arrays in their json-ld metadata. This used to result in &quot;ugly&quot; author names in link previews (e.g. `[&quot;Test Author&quot;]`) and raises since #30929. This fixes both issues.</MESSAGE>
      <SHA>828a7ce57a3ed0697a08c25e4e924b9d9a98d3a1</SHA>
      <PATCHEDFILES>
        <FILE>app/lib/link_details_extractor.rb</FILE>
        <FILE>spec/lib/link_details_extractor_spec.rb</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix author names as arrays in linked data. See #30937 for examples. Some web sites seem to wrap author names in arrays in their json-ld metadata. This used to result in &quot;ugly&quot; author names in link previews (e.g. `[&quot;Test Author&quot;]`) and raises since #30929. This fixes both issues.</MESSAGE>
      <SHA>a65ba9dbe138f1402cd112dfe0af668b8f50f268</SHA>
      <PATCHEDFILES>
        <FILE>app/lib/link_details_extractor.rb</FILE>
        <FILE>spec/lib/link_details_extractor_spec.rb</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
