<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>1426</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/1426</ISSUEURL>
  <TITLE>Docker base image up for change?</TITLE>
  <DESCRIPTION>Hi All, I wanted to ask if the community would be open to changing the base Docker image from &quot;scratch&quot; to alpine or busybox. I really like scratch, I do, but it limits extendability when the tools inside have an external dependency. For instance, if I need to wait for the existence of a configuration file that will contain all of my environment variables, I have no way to extend without making my own image because there is no shell. By creating a configuration container, that will generate the file with confd and share a new entrypoint script to source it, I could alter the behavior _WITHOUT_ modifying the upstream container and all of its goodness. By injecting configuration and alternate scripts, one does not need to worry about disturbing the core dependencies of the app. something like: ``` drone: image: drone/drone:0.4 entrypoint: /opt/scripts/entry volumes_from: - drone-config ... drone-config: image: cloudnautique/drone-config:0.4 volumes: - /opt/scripts ``` with a script in `/opt/scripts/` that looks like ``` #!/bin/bash while [ ! -e /etc/drone/dronerc ]; do sleep 1 done source /etc/drone/dronerc exec /drone_static ``` Currently, something like this fails because there is no shell in drone:0.4. Alternatively, if the binary was placed in a folder instead of `/` the relationship could be flipped. So if /drone/bin/drone_static was where the binary lived, the container could be launched with `-v /drone` and picked up with volumes-from in the conf container. In general, I like the idea of having a shell for troubleshooting purposes, but I certainly see the benefits of `scratch`. Thoughts? Alternate approaches? I will be happy to put in a PR one way or another.</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>616</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #1306 from thomasf/master Add /etc/nsswitch.conf to docker container</MESSAGE>
    <SHA>cd6ad9d9dc522c03e0f5898f7fb1520397d291ab</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Change docker base image to busybox This changes the base image to busy box so that it can be extended for use with /bin/sh scripts, and basic troubleshooting. Discussed in #1426</MESSAGE>
      <SHA>80f86b40c6cfcae1435a6559d38c3c4c688455f6</SHA>
      <PATCHEDFILES>
        <FILE>Dockerfile</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Change docker base image to busybox This changes the base image to busy box so that it can be extended for use with /bin/sh scripts, and basic troubleshooting. Discussed in #1426</MESSAGE>
      <SHA>17752276a9e1c2f707ffabb08e7c3097c35214b0</SHA>
      <PATCHEDFILES>
        <FILE>Dockerfile</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
