<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>982</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/982</ISSUEURL>
  <TITLE>nil pointer dereference on Rebuild</TITLE>
  <DESCRIPTION>Im running [Drone in a container](https://www.digitalocean.com/community/tutorials/how-to-perform-continuous-integration-testing-with-drone-io-on-coreos-and-docker) and I was having network issues so I was adding and removing the drone server. Got this after I clicked &quot;Rebuild&quot;. ``` 2015/04/18 09:37:27 http: panic serving 172.17.8.1:53133: runtime error: invalid memory address or nil pointer dereference goroutine 31 [running]: net/http.func·011() /usr/local/go/src/pkg/net/http/server.go:1100 +0xb7 runtime.panic(0xb3afc0, 0x11ad913) /usr/local/go/src/pkg/runtime/panic.c:248 +0x18d github.com/drone/drone/server/handler.PostCommit(0xc2081815f0, 0xc2081812f0, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/drone/drone/server/handler/commit.go:104 +0x5e3 github.com/zenazn/goji/web.handlerFuncWrap.ServeHTTPC(0xd52dd0, 0xc2081815f0, 0xc2081812f0, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/zenazn/goji/web/handler.go:25 +0x54 github.com/zenazn/goji/web.(*router).route(0xc208028b28, 0xc2081dc630, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/zenazn/goji/web/router.go:119 +0x143 github.com/zenazn/goji/web.func·002(0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/zenazn/goji/web/middleware.go:88 +0x5f net/http.HandlerFunc.ServeHTTP(0xc2081c7900, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1235 +0x40 github.com/drone/drone/server/middleware.func·005(0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/drone/drone/server/middleware/repo.go:104 +0x45b net/http.HandlerFunc.ServeHTTP(0xc2081c7920, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1235 +0x40 github.com/drone/drone/server/middleware.func·004(0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/drone/drone/server/middleware/repo.go:62 +0x21d net/http.HandlerFunc.ServeHTTP(0xc2081c7940, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1235 +0x40 github.com/drone/drone/server/middleware.func·003(0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/drone/drone/server/middleware/repo.go:36 +0x5dc net/http.HandlerFunc.ServeHTTP(0xc2081c7960, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1235 +0x40 github.com/zenazn/goji/web.(*cStack).ServeHTTPC(0xc2081dc630, 0xc2081815f0, 0xc2081812f0, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/zenazn/goji/web/middleware.go:50 +0x69 github.com/zenazn/goji/web.(*Mux).ServeHTTPC(0xc208028af0, 0xc2081815f0, 0xc2081812f0, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/zenazn/goji/web/mux.go:53 +0x73 github.com/zenazn/goji/web.(*router).route(0xc208028348, 0xc2081b76e0, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/zenazn/goji/web/router.go:119 +0x143 github.com/zenazn/goji/web.func·002(0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/zenazn/goji/web/middleware.go:88 +0x5f net/http.HandlerFunc.ServeHTTP(0xc2081c7c40, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1235 +0x40 github.com/drone/drone/server/middleware.func·006(0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/drone/drone/server/middleware/user.go:21 +0x1a6 net/http.HandlerFunc.ServeHTTP(0xc2081c7c60, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1235 +0x40 github.com/drone/drone/server/middleware.func·001(0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/drone/drone/server/middleware/header.go:28 +0x4e9 net/http.HandlerFunc.ServeHTTP(0xc208176860, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1235 +0x40 main.func·002(0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/drone/drone/server/main.go:176 +0x721 net/http.HandlerFunc.ServeHTTP(0xc2081c7c80, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1235 +0x40 github.com/drone/drone/server/middleware.func·002(0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/drone/drone/server/middleware/options.go:22 +0x261 net/http.HandlerFunc.ServeHTTP(0xc208176890, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1235 +0x40 github.com/zenazn/goji/web.(*cStack).ServeHTTP(0xc2081b76e0, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/zenazn/goji/web/middleware.go:46 +0x7f github.com/zenazn/goji/web.(*Mux).ServeHTTP(0xc208028310, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /var/cache/drone/src/github.com/zenazn/goji/web/mux.go:45 +0x5f net/http.(*ServeMux).ServeHTTP(0xc208022930, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1511 +0x1a3 net/http.serverHandler.ServeHTTP(0xc2080059e0, 0x7fabe81609f0, 0xc2081b9400, 0xc2081f4c30) /usr/local/go/src/pkg/net/http/server.go:1673 +0x19f net/http.(*conn).serve(0xc208051100) /usr/local/go/src/pkg/net/http/server.go:1174 +0xa7e created by net/http.(*Server).Serve /usr/local/go/src/pkg/net/http/server.go:1721 +0x313 ```</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix:[code-1347]: add null check (#984)</MESSAGE>
    <SHA>6938ed79e8cdb6f402f146f46fa003a677eb8079</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>[fix] internal error should be always logged in error level (#982)</MESSAGE>
      <SHA>f39852dc622fbb8f6b16554198827db309a4d57e</SHA>
      <PATCHEDFILES>
        <FILE>app/api/controller/repo/commit.go</FILE>
        <FILE>app/api/controller/repo/content_get.go</FILE>
        <FILE>app/api/render/render.go</FILE>
        <FILE>errors/status.go</FILE>
        <FILE>git/adapter/blame.go</FILE>
        <FILE>git/adapter/blame_test.go</FILE>
        <FILE>git/adapter/errors.go</FILE>
        <FILE>git/adapter/http.go</FILE>
        <FILE>git/adapter/shared_repo.go</FILE>
        <FILE>git/branch.go</FILE>
        <FILE>git/operations.go</FILE>
        <FILE>git/push_remote.go</FILE>
        <FILE>git/repo.go</FILE>
        <FILE>git/tag.go</FILE>
        <FILE>git/upload.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
