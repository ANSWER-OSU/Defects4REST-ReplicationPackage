<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2656</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/2656</ISSUEURL>
  <TITLE>Timeout not honored sometimes</TITLE>
  <DESCRIPTION>We have configured a timeout of 1 hour for jobs: ![Bildschirmfoto 2019-04-10 um 13 54 05](https://user-images.githubusercontent.com/245432/55876646-62aa5f00-5b98-11e9-87fd-5fed2f14b700.png) Sometimes it happens that one step is running longer than the specified timeout and thus causing a never finishing job (especially bad with the autoscaler we are currently testing, because then pending-jobs are counted in as still running processes that never get into the worker scale downs): ![Bildschirmfoto 2019-04-10 um 13 53 46](https://user-images.githubusercontent.com/245432/55876793-c5035f80-5b98-11e9-9382-4141cfd011ed.png) ![Bildschirmfoto 2019-04-10 um 13 53 40](https://user-images.githubusercontent.com/245432/55876792-c5035f80-5b98-11e9-829e-172ab66f7b28.png) Any further idea what this could have caused and what data is needed here? Currently I clean them up by a hacky SQL update, but this should not really be needed to accomplish this and also requires that you know the maximum timeout of all the repos: ```sql UPDATE stages SET stage_status = 'killed' WHERE stage_status IN ('pending', 'running') AND UNIX_TIMESTAMP() - stage_updated &gt; 3600; ``` I also checked all workers and there are no dangling containers or something suspicious.</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>feat: [CODE-2338]: Add dry run rules param to create branch API (#2680) * addressed review comments * Merge branch 'main' of https://git0.harness.io/l7B_kbSEQD2wjrM7PShm5w/PROD/Harness_Commons/gitness into CODE-2346 * feat: [CODE-2346]: Add an option to restore branch for merged/closed PR * feat: [CODE-2338]: Add dry run rules param to create branch API</MESSAGE>
    <SHA>2f4b0036d19cbe81d11e5ae78ee75012af49bb4d</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add two new settings to branch rules: block merge and force push to branch (#2656) * Fix rule naming, warn log and use switch case for ref update * Fix tests * Refactor isForcePush to remove post-receive only related msg * Add two new settings to branch rules: block merge and force push to branch</MESSAGE>
      <SHA>060d9774333e1c0b5837ea836b15f681e16022b1</SHA>
      <PATCHEDFILES>
        <FILE>app/api/controller/githook/controller.go</FILE>
        <FILE>app/api/controller/githook/post_receive.go</FILE>
        <FILE>app/api/controller/githook/pre_receive.go</FILE>
        <FILE>app/services/migrate/rule.go</FILE>
        <FILE>app/services/protection/verify_lifecycle.go</FILE>
        <FILE>app/services/protection/verify_lifecycle_test.go</FILE>
        <FILE>app/services/protection/verify_pullreq.go</FILE>
        <FILE>app/services/protection/verify_pullreq_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
