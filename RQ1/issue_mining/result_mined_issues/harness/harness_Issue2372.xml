<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2372</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/2372</ISSUEURL>
  <TITLE>[Feature] Proposal: sub-directory projects</TITLE>
  <DESCRIPTION>Hi there! A lot of people lately have switched to using monolithic repositories, especially for microservice-based architectures. I developed a build / script runner that is fairly similar to a drone-agent. I'd love to move the functionality into Drone, and this would definitely bring something unique for Drone to the table. Here's what I propose: Let's say I have a single repository with multiple projects: ``` . ├── admin ├── errors.go ├── identity.go ├── internal ├── multicheck.go ├── models.go ├── sites ├── users └── vendor ``` Where `users` and `admin` are totally separate projects. They are kept in the same repository, though, because changes to one will almost always include changes to the other. If they were separate, multiple PRs would be involved. There's also some shared code in `.` and `internal`, which needs to be tested. Example `.drone.yml`: ```yaml workspace: base: /go path: src/github.com/kminehart/drone services: database: image: cockroachdb/cockroach:v1.1.2 commands: - /cockroach/cockroach start --insecure pipeline: test: image: golang:1.10 commands: - make test publish: image: plugins/docker # These projects are individual directories in the source tree which will be tested by the pipeline # Any information like &quot;commands&quot;, &quot;image&quot;, &quot;environment&quot;, etc. overrides what's defined by the pipeline. # If left blank, then it assumes whatever information was provided by the original pipeline definition. projects: root: path: &quot;.&quot; pipeline: test: commands: - go test . admin: path: &quot;./admin&quot; pipeline: test: image: node:9.8 commands: - yarn install - yarn test publish: image: node:9.8 secrets: [ ssh_key, deploy_target ] commands: - yarn deploy internal: path: &quot;./internal&quot; users: path: &quot;./users&quot; ``` What does everyone think of this? Some potential issues I see: * Artifacts * Caching</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>16</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Add pullreq label activities (#2296) * Add colors to label activity info * Refactor FindValueByLabelID query * Simplify more label activity assign logic * Simplify label activity assign logic * Add pullreq label activities</MESSAGE>
    <SHA>bb77a835cf32e6758ffa849365bc05a1054c3473</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add list labels per pr to pr list (#2372) * Refactor to pullreq(s) backfill funcs * Add list labels per pr to pr list</MESSAGE>
      <SHA>497c426a016457ea923e00dc5e03ed36ab83ce1c</SHA>
      <PATCHEDFILES>
        <FILE>app/api/controller/pullreq/pr_find.go</FILE>
        <FILE>app/api/controller/pullreq/pr_list.go</FILE>
        <FILE>app/services/label/label_pullreq.go</FILE>
        <FILE>app/store/database.go</FILE>
        <FILE>app/store/database/label_pullreq.go</FILE>
        <FILE>types/label.go</FILE>
        <FILE>types/pullreq.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add list labels per pr to pr list (#2372) (#2387) * Add list labels per pr to pr list (#2372) * Refactor to pullreq(s) backfill funcs * Add list labels per pr to pr list</MESSAGE>
      <SHA>b1ac141460c0ac697fa1d42ce1e41d364b0ca2b9</SHA>
      <PATCHEDFILES>
        <FILE>app/api/openapi/pullreq.go</FILE>
        <FILE>app/api/request/common.go</FILE>
        <FILE>app/api/request/pullreq.go</FILE>
        <FILE>app/store/database/pullreq.go</FILE>
        <FILE>types/pullreq.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
