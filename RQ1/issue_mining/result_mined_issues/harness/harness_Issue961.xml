<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>961</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/961</ISSUEURL>
  <TITLE>Database: User Repo Index</TITLE>
  <DESCRIPTION>We need to be able to get a list of repositories for a user: https://github.com/drone/drone/blob/bolt/datastore/bolt/user.go#L53 This means we need to manually maintain an index that associates repositories to a user. So we store a key/value where the key is the username and the value is an array of keys (`[][]byte`): There is code in place that expects this index to exist: ``` Go key := []byte(login) raw := t.Bucket(bucketUserRepos).Get(key) keys := [][]byte{} err = decode(raw, &amp;keys) if err != nil { return repos, err } ``` The problem is that we are not currently maintaining this index when creating a repository: https://github.com/drone/drone/blob/bolt/datastore/bolt/repo.go#L45 We should also maintain a reverse index. A list of user keys that have access to a particular repository (in the `bucketRepoUsers` bucket).</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>133</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Add repo and space store funcs for repo size and repo count (#957)</MESSAGE>
    <SHA>38a2d43cbcb0e35b74a8a1667332ca6d8c042894</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: [code-1298]: Remove Pipeline import option from harness code (#961)</MESSAGE>
      <SHA>182e6bb1740a8e317f1064fca78ddd5a4df646a4</SHA>
      <PATCHEDFILES>
        <FILE>web/src/components/NewRepoModalButton/ImportReposForm/ImportReposForm.tsx</FILE>
        <FILE>web/src/components/NewRepoModalButton/NewRepoModalButton.tsx</FILE>
        <FILE>web/src/components/NewSpaceModalButton/ImportSpaceForm/ImportSpaceForm.tsx</FILE>
        <FILE>web/src/components/NewSpaceModalButton/NewSpaceModalButton.tsx</FILE>
        <FILE>web/src/utils/GitUtils.ts</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
