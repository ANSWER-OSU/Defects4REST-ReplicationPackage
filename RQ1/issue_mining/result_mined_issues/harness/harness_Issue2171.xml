<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2171</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/2171</ISSUEURL>
  <TITLE>Add Drone Agent build filtering</TITLE>
  <DESCRIPTION>Particularly in cloud environments with instance-based IAM systems, it's important to make sure that builds run on the instance with the most appropriate IAM profiles relative to the build. For example: * If repo1 requires pushing artifacts to an S3 or GS bucket, it'll need to run on an instance that has the correct IAM profile. * If repo2 does not require elevated privs, it should not run on an instance with IAM privs that it does not need. While this could be managed with .drone.yaml labels, doing this at the agent level for critical/sensitive builds would lessen the likelihood of external change. For example: * I set some labels in my .drone.yaml, pointing at a particular subset of my cluster that is only for this build. * Someone sneaks a label change into one of my hundreds of other repos, thus giving the malicious party an open avenue for messing with whatever privs my IAM profile grants. I won't be very prescriptive about implementation details, but here are the things that would be great to be able to do: * Glob org and/or repo names: `myorg/some*`, `my*/someprefix-*`. This can be potentially dangerous in environments without strict control over repo creation, so we may consider including a note warning as such. * Set multiple patterns to match: `myorg/repo1,myorg/repo2`</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>23</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>feat: [CDE-92]: Container orchestrator and IDE service * feat: [CDE-92]: Removing Client method from infraprovider interface and using DockerClientFactory to generate docker clients. Using go templates to substitute values in gitspace scripts. Setting a default base path for gitspaces if not provided. * Rebasing * feat: [CDE-92]: Addressing review comments. * Rebasing * Rebasing * feat: [CDE-92]: Addressing review comments * Rebasing * feat: [CDE-92]: Using port from config for code-server installation * feat: [CDE-92]: Initial commit * Rebasing</MESSAGE>
    <SHA>3acded8ed8987ced7fdacf2e0df205887b503de7</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>feat: [CDE-126]: Addressing review comments. (#2171) * feat: [CDE-126]: Addressing review comments. * feat: [CDE-126]: Addressing review comments. * feat: [CDE-126]: Addressing review comments. * feat: [CDE-126]: Addressing review comments.</MESSAGE>
      <SHA>3ccd39df0159e5d586ef6a98d2601ec4ce1fe8e4</SHA>
      <PATCHEDFILES>
        <FILE>app/events/gitspace/category.go</FILE>
        <FILE>app/events/gitspace/events.go</FILE>
        <FILE>app/events/gitspace/reader.go</FILE>
        <FILE>app/events/gitspace/reporter.go</FILE>
        <FILE>app/events/gitspace/wire.go</FILE>
        <FILE>app/services/gitspaceevent/handler.go</FILE>
        <FILE>app/services/gitspaceevent/service.go</FILE>
        <FILE>app/services/gitspaceevent/wire.go</FILE>
        <FILE>app/store/database.go</FILE>
        <FILE>app/store/database/gitspace_event.go</FILE>
        <FILE>cli/operations/server/config.go</FILE>
        <FILE>types/config.go</FILE>
        <FILE>types/enum/gitspace_entity_type.go</FILE>
        <FILE>types/enum/gitspace_event_type.go</FILE>
        <FILE>types/gitspace_event.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
