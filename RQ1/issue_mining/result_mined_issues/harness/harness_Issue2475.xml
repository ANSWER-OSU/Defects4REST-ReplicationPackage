<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2475</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/2475</ISSUEURL>
  <TITLE>BUG: Gitea integration sending wrong URLs to Gitea</TITLE>
  <DESCRIPTION>First of all this is a copy of my bug report which got automaticly closed (https://github.com/drone/drone/issues/2470). Secondly @bradrydzewski said I should report this on https://discourse.drone.io/ - Since then my account didn't get approved so I'm opening this issue a second time. I am running a drone ci instance using the following docker-compose.yml ``` version: '2' networks: drone: external: false proxy: external: name: proxy services: drone-server: image: drone/drone:0.8 expose: - 8000 - 9000 volumes: - ./drone:/var/lib/drone/ restart: always networks: - proxy - drone environment: - DRONE_OPEN=true - DRONE_HOST={{REMOVED}} - DRONE_SECRET={{REMOVED}}D - DRONE_GITEA=true - DRONE_GITEA_URL={{REMOVED}} - DRONE_GITEA_GIT_USERNAME=Drone - DRONE_GITEA_GIT_PASSWORD={{REMOVED}} - DRONE_GITEA_PRIVATE_MODE=true drone-agent: image: drone/agent:0.8 command: agent restart: always networks: - drone depends_on: - drone-server volumes: - /var/run/docker.sock:/var/run/docker.sock environment: - DRONE_SERVER=drone-server:9000 - DRONE_SECRET={{REMOVED}} ``` After pushing into a activated repository Gitea shows the build status. ![Example image](https://user-images.githubusercontent.com/11004008/44058996-32bb097a-9f50-11e8-9d06-65a1e2cc26cb.png &quot;Example image&quot;) If the build succeeded the URL is working as expected (Redirecting to the defined DRONE_HOST) But if a build is still pending or fails the URL redirects to http://drone-server:8000/ I don't think this is an intended behavior. If you need any other details or configuration, let me know.</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix: [CDE-192]: correctly set resources for infraprovider config. (#2524) * fix: [CDE-192]: correctly set resources for infraprovider config.</MESSAGE>
    <SHA>eccb57fffe9372e462d5c703007a30a95c5d294d</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>feat: instrumentation, intitial work (#2475) * requested changes * requested changes * feat: instrumentation, intitial work</MESSAGE>
      <SHA>6d0db9512e569763ac6c049669098b5ad12d3366</SHA>
      <PATCHEDFILES>
        <FILE>app/api/controller/pullreq/comment_apply_suggestions.go</FILE>
        <FILE>app/api/controller/pullreq/comment_create.go</FILE>
        <FILE>app/api/controller/pullreq/controller.go</FILE>
        <FILE>app/api/controller/pullreq/merge.go</FILE>
        <FILE>app/api/controller/pullreq/pr_create.go</FILE>
        <FILE>app/api/controller/pullreq/review_submit.go</FILE>
        <FILE>app/api/controller/pullreq/wire.go</FILE>
        <FILE>app/api/controller/repo/controller.go</FILE>
        <FILE>app/api/controller/repo/create.go</FILE>
        <FILE>app/api/controller/repo/create_branch.go</FILE>
        <FILE>app/api/controller/repo/create_commit_tag.go</FILE>
        <FILE>app/api/controller/repo/import.go</FILE>
        <FILE>app/api/controller/repo/rule_create.go</FILE>
        <FILE>app/api/controller/repo/wire.go</FILE>
        <FILE>app/api/controller/space/controller.go</FILE>
        <FILE>app/api/controller/space/import.go</FILE>
        <FILE>app/api/controller/space/import_repositories.go</FILE>
        <FILE>app/api/controller/space/wire.go</FILE>
        <FILE>app/services/instrument/git_consumer.go</FILE>
        <FILE>app/services/instrument/instrument.go</FILE>
        <FILE>app/services/instrument/noop.go</FILE>
        <FILE>app/services/instrument/tasks.go</FILE>
        <FILE>app/services/instrument/wire.go</FILE>
        <FILE>app/services/pullreq/service.go</FILE>
        <FILE>app/services/pullreq/wire.go</FILE>
        <FILE>app/services/wire.go</FILE>
        <FILE>app/store/database.go</FILE>
        <FILE>app/store/database/repo.go</FILE>
        <FILE>cli/operations/server/server.go</FILE>
        <FILE>cmd/gitness/wire.go</FILE>
        <FILE>cmd/gitness/wire_gen.go</FILE>
        <FILE>types/config.go</FILE>
        <FILE>types/repo.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
