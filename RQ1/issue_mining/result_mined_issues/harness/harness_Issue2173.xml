<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2173</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/2173</ISSUEURL>
  <TITLE>add ping message to event secret and log stream</TITLE>
  <DESCRIPTION>We should add ping messages to the event stream and log stream. This will ensure a 200 response code is written with the correct content-type. This in turn _should_ ensure the browser automatically re-connects in the event of a gateway timeout. ```diff flusher, ok := rw.(http.Flusher) if !ok { c.String(500, &quot;Streaming not supported&quot;) return } + io.WriteString(rw, &quot;: ping\n\n&quot;) + flusher.Flush() ``` We may also consider periodically pinging the client to keep the connection alive. This might be helpful when running drone behind a load balancer or reverse proxy, which may decide to close connections after periods of inactivity. ```diff for { select { case &lt;-rw.CloseNotify(): return case &lt;-ctx.Done(): return + case &lt;-time.After(30*time.Second): + io.WriteString(rw, &quot;: ping\n\n&quot;) + flusher.Flush() case buf, ok := &lt;-eventc: if ok { io.WriteString(rw, &quot;data: &quot;) rw.Write(buf) io.WriteString(rw, &quot;\n\n&quot;) flusher.Flush() } } } ```</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>feat: [CDE-126]: Addressing review comments. (#2171) * feat: [CDE-126]: Addressing review comments. * feat: [CDE-126]: Addressing review comments. * feat: [CDE-126]: Addressing review comments. * feat: [CDE-126]: Addressing review comments.</MESSAGE>
    <SHA>3ccd39df0159e5d586ef6a98d2601ec4ce1fe8e4</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>feat: [CDE-83]: Added scaffolding for APIs for gitspaces (#2173) * feat: [CDE-83]: Added scaffolding for APIs * feat: [CDE-83]: Added scaffolding for APIs</MESSAGE>
      <SHA>728a4192673586082d1f3809a9420311430b2712</SHA>
      <PATCHEDFILES>
        <FILE>app/api/auth/gitspace.go</FILE>
        <FILE>app/api/controller/gitspace/action.go</FILE>
        <FILE>app/api/controller/gitspace/controller.go</FILE>
        <FILE>app/api/controller/gitspace/create.go</FILE>
        <FILE>app/api/controller/gitspace/delete.go</FILE>
        <FILE>app/api/controller/gitspace/find.go</FILE>
        <FILE>app/api/controller/gitspace/update.go</FILE>
        <FILE>app/api/controller/gitspace/wire.go</FILE>
        <FILE>app/api/controller/infraprovider/controller.go</FILE>
        <FILE>app/api/controller/infraprovider/wire.go</FILE>
        <FILE>app/api/controller/space/controller.go</FILE>
        <FILE>app/api/controller/space/list_gitspaces.go</FILE>
        <FILE>app/api/controller/space/wire.go</FILE>
        <FILE>app/api/handler/gitspace/action.go</FILE>
        <FILE>app/api/handler/gitspace/create.go</FILE>
        <FILE>app/api/handler/gitspace/delete.go</FILE>
        <FILE>app/api/handler/gitspace/find.go</FILE>
        <FILE>app/api/handler/gitspace/update.go</FILE>
        <FILE>app/api/handler/space/list_gitspaces.go</FILE>
        <FILE>app/api/openapi/gitspace.go</FILE>
        <FILE>app/api/openapi/openapi.go</FILE>
        <FILE>app/api/request/gitspace.go</FILE>
        <FILE>app/auth/authz/membership.go</FILE>
        <FILE>app/router/api.go</FILE>
        <FILE>app/router/wire.go</FILE>
        <FILE>app/store/database.go</FILE>
        <FILE>app/store/database/gitspace_config.go</FILE>
        <FILE>app/store/database/gitspace_instance.go</FILE>
        <FILE>app/store/database/infra_provider_config.go</FILE>
        <FILE>app/store/database/infra_provider_resource.go</FILE>
        <FILE>app/store/database/wire.go</FILE>
        <FILE>cmd/gitness/wire.go</FILE>
        <FILE>cmd/gitness/wire_gen.go</FILE>
        <FILE>types/gitspace.go</FILE>
        <FILE>types/infra_provider.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
