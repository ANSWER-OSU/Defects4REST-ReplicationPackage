<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2652</ISSUENO>
  <ISSUEURL>https://github.com/harness/harness/issues/2652</ISSUEURL>
  <TITLE>Autoscaler debug output recursively adds &quot;id&quot;</TITLE>
  <DESCRIPTION>I tested today the autoscaler and realized, that when debug output is enabled then the logs for the capacity check have a growing number of `id` values on each output: ```json {&quot;level&quot;:&quot;debug&quot;,&quot;id&quot;:&quot;86by2xKgAZkECILr&quot;,&quot;min-pool&quot;:0,&quot;max-pool&quot;:10,&quot;server-capacity&quot;:20,&quot;server-count&quot;:10,&quot;pending-builds&quot;:373,&quot;running-builds&quot;:57,&quot;time&quot;:&quot;2019-04-08T20:28:51Z&quot;,&quot;message&quot;:&quot;check capacity&quot;} {&quot;level&quot;:&quot;debug&quot;,&quot;id&quot;:&quot;86by2xKgAZkECILr&quot;,&quot;time&quot;:&quot;2019-04-08T20:28:51Z&quot;,&quot;message&quot;:&quot;allocate 0 servers&quot;} {&quot;level&quot;:&quot;debug&quot;,&quot;id&quot;:&quot;86by2xKgAZkECILr&quot;,&quot;time&quot;:&quot;2019-04-08T20:28:51Z&quot;,&quot;message&quot;:&quot;check capacity complete&quot;} {&quot;level&quot;:&quot;debug&quot;,&quot;id&quot;:&quot;86by2xKgAZkECILr&quot;,&quot;id&quot;:&quot;t7Aj3IoVotZMSB0l&quot;,&quot;min-pool&quot;:0,&quot;max-pool&quot;:10,&quot;server-capacity&quot;:20,&quot;server-count&quot;:10,&quot;pending-builds&quot;:323,&quot;running-builds&quot;:58,&quot;time&quot;:&quot;2019-04-08T20:33:51Z&quot;,&quot;message&quot;:&quot;check capacity&quot;} {&quot;level&quot;:&quot;debug&quot;,&quot;id&quot;:&quot;86by2xKgAZkECILr&quot;,&quot;id&quot;:&quot;t7Aj3IoVotZMSB0l&quot;,&quot;time&quot;:&quot;2019-04-08T20:33:51Z&quot;,&quot;message&quot;:&quot;allocate 0 servers&quot;} {&quot;level&quot;:&quot;debug&quot;,&quot;id&quot;:&quot;86by2xKgAZkECILr&quot;,&quot;id&quot;:&quot;t7Aj3IoVotZMSB0l&quot;,&quot;time&quot;:&quot;2019-04-08T20:33:51Z&quot;,&quot;message&quot;:&quot;check capacity complete&quot;} {&quot;level&quot;:&quot;debug&quot;,&quot;id&quot;:&quot;86by2xKgAZkECILr&quot;,&quot;id&quot;:&quot;t7Aj3IoVotZMSB0l&quot;,&quot;id&quot;:&quot;P5Jvlq79YaGGs42d&quot;,&quot;min-pool&quot;:0,&quot;max-pool&quot;:10,&quot;server-capacity&quot;:20,&quot;server-count&quot;:10,&quot;pending-builds&quot;:268,&quot;running-builds&quot;:57,&quot;time&quot;:&quot;2019-04-08T20:38:51Z&quot;,&quot;message&quot;:&quot;check capacity&quot;} {&quot;level&quot;:&quot;debug&quot;,&quot;id&quot;:&quot;86by2xKgAZkECILr&quot;,&quot;id&quot;:&quot;t7Aj3IoVotZMSB0l&quot;,&quot;id&quot;:&quot;P5Jvlq79YaGGs42d&quot;,&quot;time&quot;:&quot;2019-04-08T20:38:51Z&quot;,&quot;message&quot;:&quot;allocate 0 servers&quot;} {&quot;level&quot;:&quot;debug&quot;,&quot;id&quot;:&quot;86by2xKgAZkECILr&quot;,&quot;id&quot;:&quot;t7Aj3IoVotZMSB0l&quot;,&quot;id&quot;:&quot;P5Jvlq79YaGGs42d&quot;,&quot;time&quot;:&quot;2019-04-08T20:38:51Z&quot;,&quot;message&quot;:&quot;check capacity complete&quot;} ``` It's originating in https://github.com/drone/autoscaler/blob/87b0e621fa0a8b2679bbf8d9ee2c8b5e329ea156/engine/planner.go#L58-L65 and seem to be added in https://github.com/drone/autoscaler/blob/87b0e621fa0a8b2679bbf8d9ee2c8b5e329ea156/engine/planner.go#L42 Unfortunately I can't spot where this duplication is happening. Any further idea what is going on here?</DESCRIPTION>
  <REPONAME>harness</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>feat: [CODE-2232]: Branch Rules: UserGroup support: Create and List (#2636) * feat: [CODE-2312]: annotate error * feat: [CODE-2312]: name change and todo removal * feat: [CODE-2312]: Annotate errors * feat: [CODE-2232]: Branch Rules: UserGroup support: Create and List</MESSAGE>
    <SHA>905d027cc311718741d59c83fbc3640a0ca09657</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>feat: [ML-338]: APIs for Harness Intelligence (#2667) * Return empty summary/branch for now * Fix Lint Issues * feat: [ML-288]: API skeletons for Harness Intelligence * fix ai pipelines (#2659) * fix ai pipelines * Update pipeline name (#2658) * Update pipeline name * fix: [ML-288]: update remediation prompt and suggestions (#2652) * fix: [ML-288]: update remediation prompt and suggestions * fix: [ML-288]: update url for artifact registry (#2651) * fix: [ML-288]: update url for artifact registry * Add snippet to mark code as written by Harness Intelligence (#2628) * Add snippet to mark code as written by Harness Intelligence * Add snippet to mark code as written by Harness Intelligence (#2626) * Add snippet to mark code as written by Harness Intelligence * feat: [ML-288]: link to harness artifact registry (#2619) * some linting fixes * feat: [ML-288]: link to harness artifact registry * feat: [ML-286]: updating pipeline suggestions (#2620) * updating suggestions * feat: [ML-286]: updating pipeline suggestions * feat: [ML-288]: adding slackbot (#2603) * updating slack responses * prevent responding to any bot messages * feat: [ML-288]: adding slackbot * throw error for commit * commit stubbed * feat: [ML-286]: moving stubbed response earlier in execution (#2602) * feat: [ML-286]: moving stubbed response earlier in execution * feat: [ML-286]: adding stubbed response for analyze execution (#2600) * updating branch name * adding updated-main for analyse-execution endpoint * feat: [ML-286]: adding stubbed response for analyze execution * Update AnalyseExecutionOutput to contain multi file diff (#2592) * Create branch and commit changes on analyse * Simplify AnalyseExecutionOutput to contain only high level summary and branch * Update AnalyseExecutionOutput to contain multi file diff * updating endpoints for unscripted demo (#2594) * cleaning up code, adding suggested pipeline response * updating suggestions api * updating endpoints for unscripted demo * Stub out generate pipeline yaml</MESSAGE>
      <SHA>0af264d09f7f65b50b53a7a917667e936ee0f300</SHA>
      <PATCHEDFILES>
        <FILE>app/api/controller/aiagent/analyse_execution.go</FILE>
        <FILE>app/api/controller/aiagent/controller.go</FILE>
        <FILE>app/api/controller/aiagent/generate_pipeline.go</FILE>
        <FILE>app/api/controller/aiagent/slackbot.go</FILE>
        <FILE>app/api/controller/aiagent/suggest_pipelines.go</FILE>
        <FILE>app/api/controller/aiagent/update_pipeline.go</FILE>
        <FILE>app/api/controller/aiagent/wire.go</FILE>
        <FILE>app/api/controller/execution/analyse.go</FILE>
        <FILE>app/api/handler/aiagent/generate_pipeline.go</FILE>
        <FILE>app/api/handler/aiagent/slackbot.go</FILE>
        <FILE>app/api/handler/aiagent/update_pipeline.go</FILE>
        <FILE>app/router/api.go</FILE>
        <FILE>app/services/aiagent/aiagent.go</FILE>
        <FILE>app/services/messaging/slack.go</FILE>
        <FILE>app/services/messaging/wire.go</FILE>
        <FILE>cmd/gitness/wire.go</FILE>
        <FILE>cmd/gitness/wire_gen.go</FILE>
        <FILE>go.mod</FILE>
        <FILE>go.sum</FILE>
        <FILE>types/execution_analysis.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
