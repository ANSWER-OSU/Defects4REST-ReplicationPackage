<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>18180</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/18180</ISSUEURL>
  <TITLE>podman rm --all not working with containers that have dependencies</TITLE>
  <DESCRIPTION>### Issue Description Try to use `podman rm -fa` when you have containers with dependencies, e.g. `--network container:xxx` or any other namespace flag which supports `container:`. ### Steps to reproduce the issue 1. `podman run --name test1 -d alpine top` 2. `podman run --network container:test1 -d alpine top` 3. `podman rm -fa` ### Describe the results you received ``` a32636dc3e18c522d3f16340801ffb76d4e8acad8f02b32723ce91721dbc50a0 Error: container 8c9cbe82f02577e166187ec899afc6497e3bd551fae1b05df5a437b8ef90d081 has dependent containers which must be removed before it: a32636dc3e18c522d3f16340801ffb76d4e8acad8f02b32723ce91721dbc50a0: container already exists ``` ### Describe the results you expected All containers removed without errors. ### podman info output ```yaml tested with latest main ``` ### Podman in a container No ### Privileged Or Rootless None ### Upstream Latest Release Yes ### Additional environment details _No response_ ### Additional information This is causing issues in the e2e integration tests because we only do `rm -fa` as cleanup thus some processes are leaked.</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>60</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>test/e2e: fix &quot;podman run ipcns ipcmk container test&quot; The test will leak processes because the rm -fa in the cleanup failed. This happens because podman tried to remove the contianers in the wrong order and thus ppodman failed with: `contianer XXX has dependent containers which must be removed before it` For now I patch the test but it should be much better if we can fix it in podman to remove in the correct order. `--all` should mean all I do not care if there is a dependent container, just get rid of it. Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
    <SHA>cac521dac962a4cc357496f41aaeac15a0704e74</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>test/e2e: fix Cleanup() Only check exit codes last, othwerwise in case of errors it will return early and miss other commands. Also explicitly stop before rm, rm is not working in all cases (#18180). Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>cfd9f74a2a539cf7d1f5fe3022fdf80e281098f0</SHA>
      <PATCHEDFILES>
        <FILE>test/e2e/common_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
