<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>20661</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/20661</ISSUEURL>
  <TITLE>Support subpath paths for -v or --mount</TITLE>
  <DESCRIPTION>### Feature request description I'm glad that support for subpath mounts in pod manifests was added in https://github.com/containers/podman/pull/16803. I'd like to see the same capability exposed via `podman run`, either by extending the syntax of `--volume`, so that we can write: podman run -v somevolume/internal/path:/container/path ... Or by adding an additional `subpath` keyword to `--mount`, so that we can write: podman run --mount type=volume,subpath=internal/path,destination=/container/path ### Suggest potential solution I think the reasons for wanting to do this are covered in &lt;https://github.com/containers/podman/issues/12929&gt;. I just want to be able to do it from the command line because in many situations a simple `podman run ...` invocation is both faster and more effective than setting up a pod manifest. I think adding the `subpath` keyword to `--mount` would be the cleanest and least disruptive way of implementing this feature. ### Have you considered any alternatives? While it's possible to do this using a pod manifest, the behavior of `podman kube play` is different from the behavior of `podman run`; in particular, it's not really designed for running a container interactively from the command line. ### Additional context Add any other context or screenshots about the feature request here.</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>366</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #24526 from edsantiago/buildah-vendor-update Buildah treadmill tweaks</MESSAGE>
    <SHA>50714d245548e83d8c47b9848946331efb2876f7</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add subpath support to volumes in `--mount` option All the backend work was done a while back for image volumes, so this is effectively just plumbing the option in for volumes in the parser logic. It's a little uglier than I'd like because our volume mount parser produces an OCI Spec mount struct, which doesn't have a field for subpath, so we have to pass through the options array and parse it back out after, which is a little gross. But not gross enough to rewrite that parsing logic. Fixes #20661 Signed-off-by: Matt Heon &lt;mheon@redhat.com&gt;</MESSAGE>
      <SHA>c5340f65ba34b465c269650affc963058a23dbb0</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container.go</FILE>
        <FILE>pkg/specgenutil/volumes.go</FILE>
        <FILE>test/e2e/run_volume_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add subpath support to volumes in `--mount` option All the backend work was done a while back for image volumes, so this is effectively just plumbing the option in for volumes in the parser logic. It's a little uglier than I'd like because our volume mount parser produces an OCI Spec mount struct, which doesn't have a field for subpath, so we have to pass through the options array and parse it back out after, which is a little gross. But not gross enough to rewrite that parsing logic. Fixes #20661 Signed-off-by: Matt Heon &lt;mheon@redhat.com&gt;</MESSAGE>
      <SHA>f7bdadf9a5b186a9cc9be89b55f00016c2efc412</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container.go</FILE>
        <FILE>pkg/specgenutil/volumes.go</FILE>
        <FILE>test/e2e/run_volume_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add subpath support to volumes in `--mount` option All the backend work was done a while back for image volumes, so this is effectively just plumbing the option in for volumes in the parser logic. It's a little uglier than I'd like because our volume mount parser produces an OCI Spec mount struct, which doesn't have a field for subpath, so we have to pass through the options array and parse it back out after, which is a little gross. But not gross enough to rewrite that parsing logic. Fixes #20661 Signed-off-by: Matt Heon &lt;mheon@redhat.com&gt;</MESSAGE>
      <SHA>61e5275923764ecb333465c2ac62a5575c9d3874</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container.go</FILE>
        <FILE>pkg/specgenutil/volumes.go</FILE>
        <FILE>test/e2e/run_volume_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add subpath support to volumes in `--mount` option All the backend work was done a while back for image volumes, so this is effectively just plumbing the option in for volumes in the parser logic. We do need to change the return type of the volume parser as it only worked on spec.Mount before (which does not have subpath support, so we'd have to pass it as an option and parse it again) but that is cleaner than the alternative. Fixes #20661 Signed-off-by: Matt Heon &lt;mheon@redhat.com&gt;</MESSAGE>
      <SHA>482795f17a29cedee21421ad442388308ab5410c</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container.go</FILE>
        <FILE>pkg/specgenutil/volumes.go</FILE>
        <FILE>test/e2e/run_volume_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add subpath support to volumes in `--mount` option All the backend work was done a while back for image volumes, so this is effectively just plumbing the option in for volumes in the parser logic. We do need to change the return type of the volume parser as it only worked on spec.Mount before (which does not have subpath support, so we'd have to pass it as an option and parse it again) but that is cleaner than the alternative. Fixes #20661 Signed-off-by: Matt Heon &lt;mheon@redhat.com&gt;</MESSAGE>
      <SHA>8a192c84034e4ef427bbb95ef6080a9dcd7be432</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container.go</FILE>
        <FILE>pkg/specgenutil/volumes.go</FILE>
        <FILE>test/e2e/run_volume_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
