<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>21874</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/21874</ISSUEURL>
  <TITLE>podman system reset speedup: Imply --time 0 or provide option for it</TITLE>
  <DESCRIPTION>### Feature request description I'm currently [trying to clean up cockpit-podman's test setup/cleanup](https://github.com/cockpit-project/cockpit-podman/issues/1591), after a quick [inquiry](https://github.com/containers/podman/pull/21592#issuecomment-1968282971). In some ideal world, calling `podman system reset --force` would clean up *everything*. It doesn't yet, but I'd like to gradually get rid of our extra hacks. An easy one is to make it faster: ``` podman run -d docker.io/busybox sleep infinity time podman system reset --force ``` shows: ``` WARN[0010] StopSignal SIGTERM failed to stop container lucid_jones in 10 seconds, resorting to SIGKILL real 0m10.324s user 0m0.134s sys 0m0.152s ``` This is annoying for many tests, as it quickly piles up, is often slower than the actual test, and completely unnecessary. ### Suggest potential solution Given the hammer size and intent of `system reset`, it'd would make sense to me if it didn't bother with the 10s timeout, and just immediately kill everything. Alternatively, it could grow a `--time 0` option like `podman rm` has. ### Have you considered any alternatives? We currently do an extra `podman rm --force --time 0 --all; podman pod rm --force --time 0 --all` (conditionalized, as e.g. Ubuntu 22.04's podman doesn't yet understand the `--time` option). This works, but it's one more step to keep track of. ### Additional context This is on current Fedora 40: podman-5.0.0~rc1-3.fc40.x86_64</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>1</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #21900 from containers/renovate/github.com-shirou-gopsutil-v3-3.x fix(deps): update module github.com/shirou/gopsutil/v3 to v3.24.2</MESSAGE>
    <SHA>032cd5b40228b03e70c301c13d332ae6475d0130</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Use stop timeout of zero for system reset when performing a system reset with containers that run somewhere where a soft kill wont work (like sleep), containers will wait 10 seconds before terminating with a sigkill. But for a forceful action like system reset, we should outright set no timeout so containers stop quickly and are not waiting on a timeout Fixes #21874 Signed-off-by: Brent Baude &lt;bbaude@redhat.com&gt;</MESSAGE>
      <SHA>0898b338b0eb25b10e0b565324887690bdb5cc30</SHA>
      <PATCHEDFILES>
        <FILE>libpod/reset.go</FILE>
        <FILE>test/e2e/system_reset_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
