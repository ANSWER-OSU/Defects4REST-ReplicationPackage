<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>22657</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/22657</ISSUEURL>
  <TITLE>when host has podman from podman-next and podman-remote is run inside a toolbox : unmarshalling error</TITLE>
  <DESCRIPTION>### Issue Description I was trying to reproduce the issue https://github.com/containers/podman/issues/21974 which is valid for podman &lt; 5 (did not bisect, take this with a grain of salt). I realized that having podman installed from podman next leads to an error. ### Steps to reproduce the issue Steps to reproduce the issue 1. Install podman from the podman-next copr on the host 2. Follow the reproducer of https://github.com/containers/podman/issues/21974 until `podman-remote run` 3. Run the step `podman-remote run --cidfile /var/tmp/cidfile fedora:latest true` in the toolbox ### Describe the results you received ``` Error: unmarshalling into &amp;define.InspectContainerData{ID:&quot;221aadce464435e1eed931dffe7326d8524e40139614e4c1ce0877463f064816&quot;, Created:time.Date(2024, time.May, 9, 15, 37, 24, 363282572, time .Local), Path:&quot;true&quot;, Args:[]string{&quot;true&quot;}, State:(*define.InspectContainerState)(0x4000532000), Image:&quot;a3b2e2a9704e6b54b78f4924f5b1318dbd7aa2553736944dd966cef32da5e37a&quot;, ImageDigest:&quot;sha25 6:a4a66434bd361d9c80cd6fd5b0ee3112a0347aed794141b372ce0c4f09afb791&quot;, ImageName:&quot;registry.fedoraproject.org/fedora:latest&quot;, Rootfs:&quot;&quot;, Pod:&quot;&quot;, ResolvConfPath:&quot;&quot;, HostnamePath:&quot;&quot;, HostsPath:&quot;&quot; , StaticDir:&quot;/home/nsella/.local/share/containers/storage/overlay-containers/221aadce464435e1eed931dffe7326d8524e40139614e4c1ce0877463f064816/userdata&quot;, OCIConfigPath:&quot;&quot;, OCIRuntime:&quot;crun&quot;, ConmonPidFile:&quot;/run/user/1000/containers/overlay-containers/221aadce464435e1eed931dffe7326d8524e40139614e4c1ce0877463f064816/userdata/conmon.pid&quot;, PidFile:&quot;/run/user/1000/containers/overlay- containers/221aadce464435e1eed931dffe7326d8524e40139614e4c1ce0877463f064816/userdata/pidfile&quot;, Name:&quot;nifty_clarke&quot;, RestartCount:0, Driver:&quot;overlay&quot;, MountLabel:&quot;system_u:object_r:container_ file_t:s0:c139,c898&quot;, ProcessLabel:&quot;system_u:system_r:container_t:s0:c139,c898&quot;, AppArmorProfile:&quot;&quot;, EffectiveCaps:[]string{&quot;CAP_CHOWN&quot;, &quot;CAP_DAC_OVERRIDE&quot;, &quot;CAP_FOWNER&quot;, &quot;CAP_FSETID&quot;, &quot;CAP_ KILL&quot;, &quot;CAP_NET_BIND_SERVICE&quot;, &quot;CAP_SETFCAP&quot;, &quot;CAP_SETGID&quot;, &quot;CAP_SETPCAP&quot;, &quot;CAP_SETUID&quot;, &quot;CAP_SYS_CHROOT&quot;}, BoundingCaps:[]string{&quot;CAP_CHOWN&quot;, &quot;CAP_DAC_OVERRIDE&quot;, &quot;CAP_FOWNER&quot;, &quot;CAP_FSETID&quot;, &quot;CAP_KILL&quot;, &quot;CAP_NET_BIND_SERVICE&quot;, &quot;CAP_SETFCAP&quot;, &quot;CAP_SETGID&quot;, &quot;CAP_SETPCAP&quot;, &quot;CAP_SETUID&quot;, &quot;CAP_SYS_CHROOT&quot;}, ExecIDs:[]string{}, GraphDriver:(*define.DriverData)(0x40006b8978), SizeRw:( *int64)(nil), SizeRootFs:0, Mounts:[]define.InspectMount{}, Dependencies:[]string{}, NetworkSettings:(*define.InspectNetworkSettings)(0x40002bf680), Namespace:&quot;&quot;, IsInfra:false, IsService:fa lse, KubeExitCodePropagation:&quot;invalid&quot;, LockNumber:0x1, Config:(*define.InspectContainerConfig)(0x4000636600), HostConfig:(*define.InspectContainerHostConfig)(0x40006c0400)}, data &quot;{\&quot;Id\&quot;:\ &quot;221aadce464435e1eed931dffe7326d8524e40139614e4c1ce0877463f064816\&quot;,\&quot;Created\&quot;:\&quot;2024-05-09T15:37:24.363282572+02:00\&quot;,\&quot;Path\&quot;:\&quot;true\&quot;,\&quot;Args\&quot;:[\&quot;true\&quot;],\&quot;State\&quot;:{\&quot;OciVersion\&quot;:\&quot;1.2. 0\&quot;,\&quot;Status\&quot;:\&quot;created\&quot;,\&quot;Running\&quot;:false,\&quot;Paused\&quot;:false,\&quot;Restarting\&quot;:false,\&quot;OOMKilled\&quot;:false,\&quot;Dead\&quot;:false,\&quot;Pid\&quot;:0,\&quot;ExitCode\&quot;:0,\&quot;Error\&quot;:\&quot;\&quot;,\&quot;StartedAt\&quot;:\&quot;0001-01-01T00:00 :00Z\&quot;,\&quot;FinishedAt\&quot;:\&quot;0001-01-01T00:00:00Z\&quot;,\&quot;CheckpointedAt\&quot;:\&quot;0001-01-01T00:00:00Z\&quot;,\&quot;RestoredAt\&quot;:\&quot;0001-01-01T00:00:00Z\&quot;},\&quot;Image\&quot;:\&quot;a3b2e2a9704e6b54b78f4924f5b1318dbd7aa255373694 4dd966cef32da5e37a\&quot;,\&quot;ImageDigest\&quot;:\&quot;sha256:a4a66434bd361d9c80cd6fd5b0ee3112a0347aed794141b372ce0c4f09afb791\&quot;,\&quot;ImageName\&quot;:\&quot;registry.fedoraproject.org/fedora:latest\&quot;,\&quot;Rootfs\&quot;:\&quot;\&quot;,\&quot; Pod\&quot;:\&quot;\&quot;,\&quot;ResolvConfPath\&quot;:\&quot;\&quot;,\&quot;HostnamePath\&quot;:\&quot;\&quot;,\&quot;HostsPath\&quot;:\&quot;\&quot;,\&quot;StaticDir\&quot;:\&quot;/home/nsella/.local/share/containers/storage/overlay-containers/221aadce464435e1eed931dffe7326d852 4e40139614e4c1ce0877463f064816/userdata\&quot;,\&quot;OCIRuntime\&quot;:\&quot;crun\&quot;,\&quot;ConmonPidFile\&quot;:\&quot;/run/user/1000/containers/overlay-containers/221aadce464435e1eed931dffe7326d8524e40139614e4c1ce0877463f0 64816/userdata/conmon.pid\&quot;,\&quot;PidFile\&quot;:\&quot;/run/user/1000/containers/overlay-containers/221aadce464435e1eed931dffe7326d8524e40139614e4c1ce0877463f064816/userdata/pidfile\&quot;,\&quot;Name\&quot;:\&quot;nifty_cl arke\&quot;,\&quot;RestartCount\&quot;:0,\&quot;Driver\&quot;:\&quot;overlay\&quot;,\&quot;MountLabel\&quot;:\&quot;system_u:object_r:container_file_t:s0:c139,c898\&quot;,\&quot;ProcessLabel\&quot;:\&quot;system_u:system_r:container_t:s0:c139,c898\&quot;,\&quot;AppArmor Profile\&quot;:\&quot;\&quot;,\&quot;EffectiveCaps\&quot;:[\&quot;CAP_CHOWN\&quot;,\&quot;CAP_DAC_OVERRIDE\&quot;,\&quot;CAP_FOWNER\&quot;,\&quot;CAP_FSETID\&quot;,\&quot;CAP_KILL\&quot;,\&quot;CAP_NET_BIND_SERVICE\&quot;,\&quot;CAP_SETFCAP\&quot;,\&quot;CAP_SETGID\&quot;,\&quot;CAP_SETPCAP\&quot;,\&quot;CAP_ SETUID\&quot;,\&quot;CAP_SYS_CHROOT\&quot;],\&quot;BoundingCaps\&quot;:[\&quot;CAP_CHOWN\&quot;,\&quot;CAP_DAC_OVERRIDE\&quot;,\&quot;CAP_FOWNER\&quot;,\&quot;CAP_FSETID\&quot;,\&quot;CAP_KILL\&quot;,\&quot;CAP_NET_BIND_SERVICE\&quot;,\&quot;CAP_SETFCAP\&quot;,\&quot;CAP_SETGID\&quot;,\&quot;CAP_SET PCAP\&quot;,\&quot;CAP_SETUID\&quot;,\&quot;CAP_SYS_CHROOT\&quot;],\&quot;ExecIDs\&quot;:[],\&quot;GraphDriver\&quot;:{\&quot;Name\&quot;:\&quot;overlay\&quot;,\&quot;Data\&quot;:{\&quot;LowerDir\&quot;:\&quot;/home/nsella/.local/share/containers/storage/overlay/e46c7a886cbfe1e67 41a81b494cf8f025358b9e74f625b1a930960d1974e7387/diff\&quot;,\&quot;UpperDir\&quot;:\&quot;/home/nsella/.local/share/containers/storage/overlay/45eb3c184e2e64464f1cdc979ca8c5f4b9beca07d7cad9eb911cd889bfab54c6/di ff\&quot;,\&quot;WorkDir\&quot;:\&quot;/home/nsella/.local/share/containers/storage/overlay/45eb3c184e2e64464f1cdc979ca8c5f4b9beca07d7cad9eb911cd889bfab54c6/work\&quot;}},\&quot;Mounts\&quot;:[],\&quot;Dependencies\&quot;:[],\&quot;NetworkS ettings\&quot;:{\&quot;EndpointID\&quot;:\&quot;\&quot;,\&quot;Gateway\&quot;:\&quot;\&quot;,\&quot;IPAddress\&quot;:\&quot;\&quot;,\&quot;IPPrefixLen\&quot;:0,\&quot;IPv6Gateway\&quot;:\&quot;\&quot;,\&quot;GlobalIPv6Address\&quot;:\&quot;\&quot;,\&quot;GlobalIPv6PrefixLen\&quot;:0,\&quot;MacAddress\&quot;:\&quot;\&quot;,\&quot;Bridge\&quot;: \&quot;\&quot;,\&quot;SandboxID\&quot;:\&quot;\&quot;,\&quot;HairpinMode\&quot;:false,\&quot;LinkLocalIPv6Address\&quot;:\&quot;\&quot;,\&quot;LinkLocalIPv6PrefixLen\&quot;:0,\&quot;Ports\&quot;:{},\&quot;SandboxKey\&quot;:\&quot;\&quot;,\&quot;Networks\&quot;:{\&quot;pasta\&quot;:{\&quot;EndpointID\&quot;:\&quot;\&quot;,\&quot;Gatew ay\&quot;:\&quot;\&quot;,\&quot;IPAddress\&quot;:\&quot;\&quot;,\&quot;IPPrefixLen\&quot;:0,\&quot;IPv6Gateway\&quot;:\&quot;\&quot;,\&quot;GlobalIPv6Address\&quot;:\&quot;\&quot;,\&quot;GlobalIPv6PrefixLen\&quot;:0,\&quot;MacAddress\&quot;:\&quot;\&quot;,\&quot;NetworkID\&quot;:\&quot;pasta\&quot;,\&quot;DriverOpts\&quot;:null,\&quot;IPA MConfig\&quot;:null,\&quot;Links\&quot;:null}}},\&quot;Namespace\&quot;:\&quot;\&quot;,\&quot;IsInfra\&quot;:false,\&quot;IsService\&quot;:false,\&quot;KubeExitCodePropagation\&quot;:\&quot;invalid\&quot;,\&quot;lockNumber\&quot;:1,\&quot;Config\&quot;:{\&quot;Hostname\&quot;:\&quot;221aadce4644\&quot;,\ &quot;Domainname\&quot;:\&quot;\&quot;,\&quot;User\&quot;:\&quot;\&quot;,\&quot;AttachStdin\&quot;:false,\&quot;AttachStdout\&quot;:false,\&quot;AttachStderr\&quot;:false,\&quot;Tty\&quot;:false,\&quot;OpenStdin\&quot;:false,\&quot;StdinOnce\&quot;:false,\&quot;Env\&quot;:[\&quot;FGC=f39\&quot;,\&quot;PATH=/usr/lo cal/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\&quot;,\&quot;container=oci\&quot;,\&quot;DISTTAG=f39container\&quot;],\&quot;Cmd\&quot;:[\&quot;true\&quot;],\&quot;Image\&quot;:\&quot;registry.fedoraproject.org/fedora:latest\&quot;,\&quot;Volumes\&quot;:null ,\&quot;WorkingDir\&quot;:\&quot;/\&quot;,\&quot;Entrypoint\&quot;:null,\&quot;OnBuild\&quot;:null,\&quot;Labels\&quot;:{\&quot;license\&quot;:\&quot;MIT\&quot;,\&quot;name\&quot;:\&quot;fedora\&quot;,\&quot;vendor\&quot;:\&quot;Fedora Project\&quot;,\&quot;version\&quot;:\&quot;39\&quot;},\&quot;Annotations\&quot;:{\&quot;io.podman. annotations.cid-file\&quot;:\&quot;/var/tmp/cidfile\&quot;},\&quot;StopSignal\&quot;:\&quot;SIGTERM\&quot;,\&quot;HealthcheckOnFailureAction\&quot;:\&quot;none\&quot;,\&quot;CreateCommand\&quot;:[\&quot;podman-remote\&quot;,\&quot;run\&quot;,\&quot;--cidfile\&quot;,\&quot;/var/tmp/cidfile\ &quot;,\&quot;fedora:latest\&quot;,\&quot;true\&quot;],\&quot;Umask\&quot;:\&quot;0022\&quot;,\&quot;Timeout\&quot;:0,\&quot;StopTimeout\&quot;:10,\&quot;Passwd\&quot;:true,\&quot;sdNotifyMode\&quot;:\&quot;container\&quot;},\&quot;HostConfig\&quot;:{\&quot;Binds\&quot;:[],\&quot;CgroupManager\&quot;:\&quot;systemd\&quot;,\ &quot;CgroupMode\&quot;:\&quot;private\&quot;,\&quot;ContainerIDFile\&quot;:\&quot;/var/tmp/cidfile\&quot;,\&quot;LogConfig\&quot;:{\&quot;Type\&quot;:\&quot;journald\&quot;,\&quot;Config\&quot;:null,\&quot;Path\&quot;:\&quot;\&quot;,\&quot;Tag\&quot;:\&quot;\&quot;,\&quot;Size\&quot;:\&quot;0B\&quot;},\&quot;NetworkMode\&quot;:\&quot;pasta\&quot;, \&quot;PortBindings\&quot;:{},\&quot;RestartPolicy\&quot;:{\&quot;Name\&quot;:\&quot;no\&quot;,\&quot;MaximumRetryCount\&quot;:0},\&quot;AutoRemove\&quot;:false,\&quot;Annotations\&quot;:{\&quot;io.podman.annotations.cid-file\&quot;:\&quot;/var/tmp/cidfile\&quot;},\&quot;VolumeDriver\ &quot;:\&quot;\&quot;,\&quot;VolumesFrom\&quot;:null,\&quot;CapAdd\&quot;:[],\&quot;CapDrop\&quot;:[],\&quot;Dns\&quot;:[],\&quot;DnsOptions\&quot;:[],\&quot;DnsSearch\&quot;:[],\&quot;ExtraHosts\&quot;:[],\&quot;GroupAdd\&quot;:[],\&quot;IpcMode\&quot;:\&quot;shareable\&quot;,\&quot;Cgroup\&quot;:\&quot;\&quot;,\&quot;Cgroups\&quot; :\&quot;default\&quot;,\&quot;Links\&quot;:null,\&quot;OomScoreAdj\&quot;:0,\&quot;PidMode\&quot;:\&quot;private\&quot;,\&quot;Privileged\&quot;:false,\&quot;PublishAllPorts\&quot;:false,\&quot;ReadonlyRootfs\&quot;:false,\&quot;SecurityOpt\&quot;:[],\&quot;Tmpfs\&quot;:{},\&quot;UTSMode\&quot;:\&quot;pr ivate\&quot;,\&quot;UsernsMode\&quot;:\&quot;\&quot;,\&quot;ShmSize\&quot;:65536000,\&quot;Runtime\&quot;:\&quot;oci\&quot;,\&quot;ConsoleSize\&quot;:[0,0],\&quot;Isolation\&quot;:\&quot;\&quot;,\&quot;CpuShares\&quot;:0,\&quot;Memory\&quot;:0,\&quot;NanoCpus\&quot;:0,\&quot;CgroupParent\&quot;:\&quot;user.slice\&quot;,\&quot;Bl kioWeight\&quot;:0,\&quot;BlkioWeightDevice\&quot;:null,\&quot;BlkioDeviceReadBps\&quot;:null,\&quot;BlkioDeviceWriteBps\&quot;:null,\&quot;BlkioDeviceReadIOps\&quot;:null,\&quot;BlkioDeviceWriteIOps\&quot;:null,\&quot;CpuPeriod\&quot;:0,\&quot;CpuQuota\&quot;:0,\&quot; CpuRealtimePeriod\&quot;:0,\&quot;CpuRealtimeRuntime\&quot;:0,\&quot;CpusetCpus\&quot;:\&quot;\&quot;,\&quot;CpusetMems\&quot;:\&quot;\&quot;,\&quot;Devices\&quot;:[],\&quot;DiskQuota\&quot;:0,\&quot;KernelMemory\&quot;:0,\&quot;MemoryReservation\&quot;:0,\&quot;MemorySwap\&quot;:0,\&quot;MemorySwap piness\&quot;:0,\&quot;OomKillDisable\&quot;:false,\&quot;PidsLimit\&quot;:2048,\&quot;Ulimits\&quot;:[],\&quot;CpuCount\&quot;:0,\&quot;CpuPercent\&quot;:0,\&quot;IOMaximumIOps\&quot;:0,\&quot;IOMaximumBandwidth\&quot;:0,\&quot;CgroupConf\&quot;:null}}\n&quot;: json: cannot unma rshal string into Go struct field InspectContainerConfig.Config.StopSignal of type uint ``` ### Describe the results you expected Command should work ### podman info output ```yaml $ podman -v podman version 5.1.0-dev-63ab9275b ``` ``` $ cat /etc/fedora-release Fedora Asahi Remix release 39 (Thirty Nine) ``` ``` $ uname -a Linux applem1 6.8.8-400.asahi.fc39.aarch64+16k #1 SMP PREEMPT_DYNAMIC Tue Apr 30 02:30:34 UTC 2024 aarch64 GNU/Linux ``` ``` ### Podman in a container Yes ### Privileged Or Rootless Rootless ### Upstream Latest Release Yes ### Additional environment details _No response_ ### Additional information I am aware that I am running this on `aarch64` did not try to run it on `x86_64` or other architectures yet.</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>12</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #22689 from lsm5/packit-podman-next [skip-ci] Packit: use only one value for `packages` key for `trigger: commit` copr builds</MESSAGE>
    <SHA>ef6619019f436bf38abce5dfbdbfa019e548ef87</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>remote API: restore v4 payload in container inspect The v5 API made a breaking change for podman inspect, this means that an old client could not longer parse the result from the new 5.X server. The other way around new client and old server already worked. As it turned out there were several users that run into this, one case to hit this is using an old 4.X podman machine wich now pulls a newer coreos with podman 5.0. But there are also other users running into it. In order to keep the API working we now have a version check and return the old v4 compatible payload so the old remote client can still work against a newer server thus removing any major breaking change for an old client. Fixes #22657 Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>bcb7edfded9c9bbed283baf7e13c4db71f44e823</SHA>
      <PATCHEDFILES>
        <FILE>libpod/define/container_inspect.go</FILE>
        <FILE>pkg/api/handlers/libpod/containers.go</FILE>
        <FILE>test/apiv2/25-containersMore.at</FILE>
        <FILE>test/apiv2/test-apiv2</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>remote API: restore v4 payload in container inspect The v5 API made a breaking change for podman inspect, this means that an old client could not longer parse the result from the new 5.X server. The other way around new client and old server already worked. As it turned out there were several users that run into this, one case to hit this is using an old 4.X podman machine wich now pulls a newer coreos with podman 5.0. But there are also other users running into it. In order to keep the API working we now have a version check and return the old v4 compatible payload so the old remote client can still work against a newer server thus removing any major breaking change for an old client. Fixes #22657 Signed-off-by: Paul Holzinger &lt;pholzing@redhat.com&gt;</MESSAGE>
      <SHA>65d26b0cdec786af19c8d7b8acb88003d576f96f</SHA>
      <PATCHEDFILES>
        <FILE>libpod/define/container_inspect.go</FILE>
        <FILE>pkg/api/handlers/libpod/containers.go</FILE>
        <FILE>test/apiv2/25-containersMore.at</FILE>
        <FILE>test/apiv2/test-apiv2</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
