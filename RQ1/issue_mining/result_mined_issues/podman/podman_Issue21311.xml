<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>21311</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/21311</ISSUEURL>
  <TITLE>Network connect/disconnect events don't include network ID/name</TITLE>
  <DESCRIPTION>### Issue Description Podman network events as emitted by `podman events` (connect, disconnect) don't include the network name or ID, making it impossible to use events to watch for changes to a specific network. Looking at the source code, the network name is included in the low level event data, but seems to be lost when converting between libpod Events and Docker compatible events via [ConvertToEntitiesEvent](https://github.com/containers/podman/blob/815ae77ab26cea3a5430116db682d9df46fc8845/pkg/domain/entities/events.go#L62) and [ConvertToLibpodEvent](https://github.com/containers/podman/blob/815ae77ab26cea3a5430116db682d9df46fc8845/pkg/domain/entities/events.go#L21). ### Steps to reproduce the issue Steps to reproduce the issue 1. Run `podman events --format json` 2. In another terminal window, connect or disconnect a container to any networks `podman network connect &lt;network&gt; &lt;container&gt;` or `podman network disconenct &lt;network&gt; &lt;container&gt;` 3. Check the contents of the `Connect` and `Disconnect` events emitted ### Describe the results you received I see events like this emitted: ```json {&quot;ID&quot;:&quot;3d9d442dab9029e5e1b5d82307972ce3ff9b9f49d0473b4b762f256bdee1f96f&quot;,&quot;Status&quot;:&quot;disconnect&quot;,&quot;Time&quot;:&quot;2024-01-19T13:48:43.873758119-08:00&quot;,&quot;Type&quot;:&quot;network&quot;,&quot;Attributes&quot;:{&quot;podId&quot;:&quot;&quot;}} {&quot;ID&quot;:&quot;3d9d442dab9029e5e1b5d82307972ce3ff9b9f49d0473b4b762f256bdee1f96f&quot;,&quot;Status&quot;:&quot;connect&quot;,&quot;Time&quot;:&quot;2024-01-19T14:10:31.823991946-08:00&quot;,&quot;Type&quot;:&quot;network&quot;,&quot;Attributes&quot;:{&quot;podId&quot;:&quot;&quot;}} ``` Each network event includes the ID of the relevant container, but not the ID or name of the network the container was connected to (or disconnected from). ### Describe the results you expected I expect to see events like: ```json {&quot;ID&quot;:&quot;3d9d442dab9029e5e1b5d82307972ce3ff9b9f49d0473b4b762f256bdee1f96f&quot;,&quot;Status&quot;:&quot;disconnect&quot;,&quot;Time&quot;:&quot;2024-01-19T13:48:43.873758119-08:00&quot;,&quot;Type&quot;:&quot;network&quot;,&quot;Network&quot;:&quot;test&quot;,&quot;Attributes&quot;:{&quot;podId&quot;:&quot;&quot;}} {&quot;ID&quot;:&quot;3d9d442dab9029e5e1b5d82307972ce3ff9b9f49d0473b4b762f256bdee1f96f&quot;,&quot;Status&quot;:&quot;connect&quot;,&quot;Time&quot;:&quot;2024-01-19T14:10:31.823991946-08:00&quot;,&quot;Type&quot;:&quot;network&quot;,&quot;Network&quot;:&quot;test&quot;,&quot;Attributes&quot;:{&quot;podId&quot;:&quot;&quot;}} ``` ### podman info output ```yaml host: arch: arm64 buildahVersion: 1.33.2 cgroupControllers: - cpuset - cpu - io - memory - pids - rdma - misc cgroupManager: systemd cgroupVersion: v2 conmon: package: conmon-2.1.8-2.fc39.aarch64 path: /usr/bin/conmon version: 'conmon version 2.1.8, commit: ' cpuUtilization: idlePercent: 99.54 systemPercent: 0.22 userPercent: 0.24 cpus: 2 databaseBackend: sqlite distribution: distribution: fedora variant: coreos version: &quot;39&quot; eventLogger: journald freeLocks: 2045 hostname: localhost.localdomain idMappings: gidmap: null uidmap: null kernel: 6.6.8-200.fc39.aarch64 linkmode: dynamic logDriver: journald memFree: 616837120 memTotal: 3795222528 networkBackend: netavark networkBackendInfo: backend: netavark dns: package: aardvark-dns-1.9.0-1.fc39.aarch64 path: /usr/libexec/podman/aardvark-dns version: aardvark-dns 1.9.0 package: netavark-1.9.0-1.fc39.aarch64 path: /usr/libexec/podman/netavark version: netavark 1.9.0 ociRuntime: name: crun package: crun-1.12-1.fc39.aarch64 path: /usr/bin/crun version: |- crun version 1.12 commit: ce429cb2e277d001c2179df1ac66a470f00802ae rundir: /run/crun spec: 1.0.0 +SYSTEMD +SELINUX +APPARMOR +CAP +SECCOMP +EBPF +CRIU +LIBKRUN +WASM:wasmedge +YAJL os: linux pasta: executable: /usr/bin/pasta package: passt-0^20231204.gb86afe3-1.fc39.aarch64 version: | pasta 0^20231204.gb86afe3-1.fc39.aarch64-pasta Copyright Red Hat GNU General Public License, version 2 or later &lt;https://www.gnu.org/licenses/old-licenses/gpl-2.0.html&gt; This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. remoteSocket: exists: true path: /run/podman/podman.sock security: apparmorEnabled: false capabilities: CAP_CHOWN,CAP_DAC_OVERRIDE,CAP_FOWNER,CAP_FSETID,CAP_KILL,CAP_NET_BIND_SERVICE,CAP_SETFCAP,CAP_SETGID,CAP_SETPCAP,CAP_SETUID,CAP_SYS_CHROOT rootless: false seccompEnabled: true seccompProfilePath: /usr/share/containers/seccomp.json selinuxEnabled: true serviceIsRemote: true slirp4netns: executable: /usr/bin/slirp4netns package: slirp4netns-1.2.2-1.fc39.aarch64 version: |- slirp4netns version 1.2.2 commit: 0ee2d87523e906518d34a6b423271e4826f71faf libslirp: 4.7.0 SLIRP_CONFIG_VERSION_MAX: 4 libseccomp: 2.5.3 swapFree: 0 swapTotal: 0 uptime: 36h 19m 18.00s (Approximately 1.50 days) variant: v8 plugins: authorization: null log: - k8s-file - none - passthrough - journald network: - bridge - macvlan - ipvlan volume: - local registries: search: - docker.io store: configFile: /usr/share/containers/storage.conf containerStore: number: 1 paused: 0 running: 1 stopped: 0 graphDriverName: overlay graphOptions: overlay.mountopt: nodev,metacopy=on graphRoot: /var/lib/containers/storage graphRootAllocated: 99252940800 graphRootUsed: 4171116544 graphStatus: Backing Filesystem: xfs Native Overlay Diff: &quot;false&quot; Supports d_type: &quot;true&quot; Supports shifting: &quot;true&quot; Supports volatile: &quot;true&quot; Using metacopy: &quot;true&quot; imageCopyTmpDir: /var/tmp imageStore: number: 6 runRoot: /run/containers/storage transientStore: false volumePath: /var/lib/containers/storage/volumes version: APIVersion: 4.8.2 Built: 1702300963 BuiltTime: Mon Dec 11 05:22:43 2023 GitCommit: &quot;&quot; GoVersion: go1.21.4 Os: linux OsArch: linux/arm64 Version: 4.8.2 ``` ### Podman in a container No ### Privileged Or Rootless Privileged ### Upstream Latest Release Yes ### Additional environment details Podman Desktop (v1.6.4) on ARM64 MacOS ### Additional information _No response_</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>19</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #21530 from Luap99/netavark-skip test/e2e: unskip netavark macvlan/ipvlan tests</MESSAGE>
    <SHA>22b1650619070e529ea176c13ab0e6767862ce7d</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Show network name network events with podman -remote events Fixes: https://github.com/containers/podman/issues/21311 Signed-off-by: Daniel J Walsh &lt;dwalsh@redhat.com&gt;</MESSAGE>
      <SHA>c7910e75e35a5d9d44ebd3204d4f58769ae077b4</SHA>
      <PATCHEDFILES>
        <FILE>pkg/domain/entities/events.go</FILE>
        <FILE>test/e2e/events_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
