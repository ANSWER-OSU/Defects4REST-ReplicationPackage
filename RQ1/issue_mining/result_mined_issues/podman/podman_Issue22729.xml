<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>22729</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/22729</ISSUEURL>
  <TITLE>Hostname written to /etc/hostname does not include new-line at end</TITLE>
  <DESCRIPTION>As noted in [docker](https://github.com/docker-library/docker/issues/496), the hostname written to `/etc/hostname` does not include a new-line at the end. As per debian's [hostname (5)](https://manpages.debian.org/bookworm/systemd/hostname.5.en.html) man page: &gt; The file should contain a single newline-terminated hostname string. Comments (lines starting with a &quot;#&quot;) are ignored. The hostname should be composed of up to 64 7-bit ASCII lower-case alphanumeric characters or hyphens forming a valid DNS domain name. It is recommended that this name contains only a single label, i.e. without any dots. Invalid characters will be filtered out in an attempt to make the name valid, but obviously it is recommended to use a valid name and not rely on this filtering. The code in question: is here https://github.com/containers/podman/blob/f7a30461e06f6786b02fc44b5c48525d2ebbc482/libpod/container_internal_linux.go#L667 This should be amended to read ```go hostnamePath, err := c.writeStringToRundir(&quot;hostname&quot;, fmt.Sprintf(&quot;%s\n&quot;, c.Hostname())) ```</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>18</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #22858 from containers/renovate/common-image-and-storage-deps fix(deps): update github.com/containers/image/v5 digest to 2343e81</MESSAGE>
    <SHA>301e7f2c85b83729e31ae7db8353df55e63029b7</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fix: correct creation of container /etc/hostname file As noted in #22729: As per debian's hostname (5) man page: &gt; The file should contain a single newline-terminated hostname string. Comments (lines starting with a &quot;#&quot;) are ignored. The hostname should be composed of up to 64 7-bit ASCII lower-case alphanumeric characters or hyphens forming a valid DNS domain name. It is recommended that this name contains only a single label, i.e. without any dots. Invalid characters will be filtered out in an attempt to make the name valid, but obviously it is recommended to use a valid name and not rely on this filtering. I have made the change noted in the issue and provided a unit test to ensure that the value written is correct. Signed-off-by: David Graff &lt;dagraff@cisco.com&gt;</MESSAGE>
      <SHA>44071ee558f17c8c90b6e8f5451798ee1dcf74ac</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container_internal_linux.go</FILE>
        <FILE>libpod/container_internal_linux_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>fix(libpod): add newline character to the end of container's hostname file debian's man (5) hostname page states &quot;The file should contain a single newline-terminated hostname string.&quot; [NO NEW TESTS NEEDED] fix #22729 Signed-off-by: Bo Wang &lt;wangbob@uniontech.com&gt;</MESSAGE>
      <SHA>7243c7109c69520cdd22d80e5a1f15da8d31ada4</SHA>
      <PATCHEDFILES>
        <FILE>libpod/container_internal_linux.go</FILE>
        <FILE>test/e2e/run_dns_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
