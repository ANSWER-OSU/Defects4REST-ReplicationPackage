<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>18397</ISSUENO>
  <ISSUEURL>https://github.com/containers/podman/issues/18397</ISSUEURL>
  <TITLE>e2e: login/logout tests: error, not logged in</TITLE>
  <DESCRIPTION>Infrequent test flakes in login/logout tests, looking something like: ``` podman login and logout without registry parameter ... # podman [options] login -u podmantest -p test Login Succeeded! # podman [options] logout Error: not logged into localhost:35847 ``` or ``` podman login and logout with --tls-verify ... # podman-remote [options] login --username podmantest --password test --tls-verify=false localhost:34245 Login Succeeded! # podman-remote [options] push quay.io/libpod/alpine:latest localhost:34245/test-alpine Getting image source signatures Copying blob sha256:ETC Error: trying to reuse blob sha256:ETC at destination: checking whether a blob sha256:ETC exists in localhost:34245/test-alpine: authentication required ``` I suspect a collision in `authfile`. Should be simple to add `--authfile` param or set `$REGISTRY_AUTH_FILE` in affected tests. * debian-12 : int podman debian-12 root host sqlite * [04-27 13:28](https://api.cirrus-ci.com/v1/artifact/task/5953352937242624/html/int-podman-debian-12-root-host-sqlite.log.html#t--podman-login-and-logout-without-registry-parameter--1) in Podman login and logout [It] podman login and logout without registry parameter * fedora-37 : int remote fedora-37 root host boltdb [remote] * [03-29-2023 17:17](https://api.cirrus-ci.com/v1/artifact/task/4600898236710912/html/int-remote-fedora-37-root-host-boltdb.log.html#t--podman-login-and-logout-without-registry-parameter--1) in Podman login and logout [It] podman login and logout without registry parameter * fedora-37 : int remote fedora-37 root host sqlite [remote] * [03-29-2023 08:05](https://api.cirrus-ci.com/v1/artifact/task/5843065559056384/html/int-remote-fedora-37-root-host-sqlite.log.html#t--podman-login-and-logout-with---tls-verify--1) in Podman login and logout [It] podman login and logout with --tls-verify</DESCRIPTION>
  <REPONAME>podman</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Merge pull request #18388 from ashley-cui/uid Fix clashing subuid</MESSAGE>
    <SHA>a9a3b81ac260301e5a979fefaf139849e5735abf</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>e2e: login_logout: use unique authfile for each test Set REGISTRY_AUTH_FILE to unique path for each subtest. This should eliminate collisions where one test runs &quot;podman logout&quot; just after another does &quot;podman login&quot;. Also, add a test to confirm that the authfile gets written as expected. Also, add actual tests for expected error messages, instead of just ExitWithError() Fixes: #18397 Signed-off-by: Ed Santiago &lt;santiago@redhat.com&gt;</MESSAGE>
      <SHA>7b25f362e688d041e6bf94ba53ea604e946bd836</SHA>
      <PATCHEDFILES>
        <FILE>test/e2e/login_logout_test.go</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
