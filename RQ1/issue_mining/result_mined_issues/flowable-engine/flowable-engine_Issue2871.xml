<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2871</ISSUENO>
  <ISSUEURL>https://github.com/flowable/flowable-engine/issues/2871</ISSUEURL>
  <TITLE>&quot;FlowableException: Index: 1, Size: 1&quot; on webservice invocation</TITLE>
  <DESCRIPTION>The following error occurs at Apache CXF level when invoking a webservice returning 3 or more parameters. The problem does not occur if the webservice return 0, 1 or 2 parameters. ``` org.flowable.common.engine.api.FlowableException: Index: 1, Size: 1 at org.flowable.engine.impl.webservice.CxfWebServiceClient.send(CxfWebServiceClient.java:84) at org.flowable.engine.impl.webservice.WSOperation.safeSend(WSOperation.java:83) at org.flowable.engine.impl.webservice.WSOperation.sendFor(WSOperation.java:63) at org.flowable.engine.impl.bpmn.webservice.Operation.sendMessage(Operation.java:54) at org.flowable.engine.impl.bpmn.behavior.WebServiceActivityBehavior.execute(WebServiceActivityBehavior.java:136) ... Caused by: java.lang.IndexOutOfBoundsException: Index: 1, Size: 1 at java.util.ArrayList.rangeCheck(ArrayList.java:659) at java.util.ArrayList.get(ArrayList.java:435) at org.apache.cxf.jaxws.interceptors.HolderInInterceptor.handleMessage(HolderInInterceptor.java:67) at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308) at org.apache.cxf.endpoint.ClientImpl.onMessage(ClientImpl.java:826) at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponseInternal(HTTPConduit.java:1693) at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponse(HTTPConduit.java:1570) at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1371) at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56) at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:671) at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:63) at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308) at org.apache.cxf.endpoint.ClientImpl.doInvoke(ClientImpl.java:531) at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:440) at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:355) at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:313) at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:333) at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:319) at org.flowable.engine.impl.webservice.CxfWebServiceClient.send(CxfWebServiceClient.java:78) ... 85 more ``` The CXF API `org.apache.cxf.endpoint.Client#invoke(methodName, arguments)` **must be called with `arguments` initialized also with expected output parameters as `null`** that is missing. For example for 2 input parameters and 3 output parameters: `client.invoke(methodName, new Object[] {inParam1, inParam2, null, null, null} )`. This problem occurs on all versions of Flowable.</DESCRIPTION>
  <REPONAME>flowable-engine</REPONAME>
  <TIMEDIFFERENCEDAYS>125</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Move to version 6.6.0</MESSAGE>
    <SHA>ed4261edeb1a8dde8fcd786afd9072d54e766452</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Add an unit test to make issue #2871 evident</MESSAGE>
      <SHA>95e5c1998f3b84ad5f7b6f05f3d17f07183f91a5</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMock.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMockImpl.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceTaskTest.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParams.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParamsResponse.java</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/WebServiceTaskTest.testWebServiceInvocationReturningSeveralParams.bpmn20.xml</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/webservicemock.wsdl</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix issue #2871: 'FlowableException: Index: 1, Size: 1' on webservice invocation</MESSAGE>
      <SHA>028b49875243b1a5d8695a6233b4ced7e8898f24</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/webservice/WSOperation.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add an unit test to make issue #2871 evident</MESSAGE>
      <SHA>2496942a0a6c598196d30cb3e0aa07f8abfdc12b</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMock.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMockImpl.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceTaskTest.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParams.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParamsResponse.java</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/WebServiceTaskTest.testWebServiceInvocationReturningSeveralParams.bpmn20.xml</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/webservicemock.wsdl</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix issue #2871: 'FlowableException: Index: 1, Size: 1' on webservice invocation</MESSAGE>
      <SHA>a650a75b74859adca1df6451812ccb82863f52af</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/webservice/WSOperation.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add an unit test to make issue #2871 evident</MESSAGE>
      <SHA>863d97586675d6425b4739b224dfdaa135bd0441</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMock.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMockImpl.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceTaskTest.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParams.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParamsResponse.java</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/WebServiceTaskTest.testWebServiceInvocationReturningSeveralParams.bpmn20.xml</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/webservicemock.wsdl</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix issue #2871: 'FlowableException: Index: 1, Size: 1' on webservice invocation</MESSAGE>
      <SHA>2a9bbc31f21ab1cabcb28cb75634dd12ca1763d8</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/webservice/WSOperation.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Add an unit test to make issue #2871 evident</MESSAGE>
      <SHA>084bca37938b8050f35305d209a712c41a344f90</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMock.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMockImpl.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceTaskTest.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParams.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParamsResponse.java</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/WebServiceTaskTest.testWebServiceInvocationReturningSeveralParams.bpmn20.xml</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/webservicemock.wsdl</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix issue #2871: 'FlowableException: Index: 1, Size: 1' on webservice invocation</MESSAGE>
      <SHA>2d7b82fbfd42a0b86ae26016cd116c3573919025</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/webservice/WSOperation.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>issue #2871: error on ws invocation with 3 or more output parameters (#2880) * Add an unit test to make issue #2871 evident * Fix issue #2871: 'FlowableException: Index: 1, Size: 1' on webservice invocation</MESSAGE>
      <SHA>41650393d179e3e73b95f0c0228d707b65be8ff4</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMock.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMockImpl.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceTaskTest.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParams.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParamsResponse.java</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/WebServiceTaskTest.testWebServiceInvocationReturningSeveralParams.bpmn20.xml</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/webservicemock.wsdl</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/webservice/WSOperation.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>issue #2871: error on ws invocation with 3 or more output parameters (#2880) * Add an unit test to make issue #2871 evident * Fix issue #2871: 'FlowableException: Index: 1, Size: 1' on webservice invocation</MESSAGE>
      <SHA>60508bb8f1171a56e3cd0b40b12c43eda1615a34</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMock.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceMockImpl.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/WebServiceTaskTest.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParams.java</FILE>
        <FILE>modules/flowable-cxf/src/test/java/org/flowable/engine/impl/webservice/wrappers/ReturnsSeveralParamsResponse.java</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/WebServiceTaskTest.testWebServiceInvocationReturningSeveralParams.bpmn20.xml</FILE>
        <FILE>modules/flowable-cxf/src/test/resources/org/flowable/engine/impl/webservice/webservicemock.wsdl</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/webservice/WSOperation.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
