<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>2343</ISSUENO>
  <ISSUEURL>https://github.com/flowable/flowable-engine/issues/2343</ISSUEURL>
  <TITLE>MailActivityBehavior with SSL not setting port correctly</TITLE>
  <DESCRIPTION>**Describe the bug** When SSL is enabled for email sending, `org.flowable.engine.impl.bpmn.behavior.MailActivityBehavior` is not setting the SMTP port properly. This causes the default SSL port of `465` to be used regardless of other settings. NOTE: same problem needs to be fixed in `org.activiti.engine.impl.bpmn.behavior.MailActivityBehavior` **Expected behavior** In `MailActivityBehavior`'s `setMailServerProperties` function, when the call to `isMailServerUseSSL()` returns `true`, the code needs to set the port using the `setSslSmtpPort` function on `org.apache.commons.mail.Email`. Currently it incorrectly uses `setSmtpPort`. Question remains whether an additional configuration property should be exposed to set this explicitly. **Additional context** - Flowable 6.5.0 - `org.apache.commons:commons-email` version `1.5`</DESCRIPTION>
  <REPONAME>flowable-engine</REPONAME>
  <TIMEDIFFERENCEDAYS>21</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Make sure that the acquire timer runnable does not block the thread if an exception occurs when unlocking the timer jobs + expand the default ResetExpiredJobsRunnable to include the TimerJobs</MESSAGE>
    <SHA>8d7c0fff6a0be060958fc20dd43074d004c5002c</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>MailActivityBehavior now sets SSL SMTP port when SSL is enabled for email server connections (fixes #2343)</MESSAGE>
      <SHA>5420e73f1b198f0e9a15c8dd414b7f05d18dd767</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-cmmn-engine/src/main/java/org/flowable/cmmn/engine/impl/behavior/impl/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable5-engine/src/main/java/org/activiti/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>MailActivityBehavior now sets SSL SMTP port when SSL is enabled for email server connections (fixes #2343)</MESSAGE>
      <SHA>67a1c8c17fadb0227cf094fbc1fed0c9474a75eb</SHA>
      <PATCHEDFILES>
        <FILE>modules/flowable-cmmn-engine/src/main/java/org/flowable/cmmn/engine/impl/behavior/impl/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable5-engine/src/main/java/org/activiti/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Set SSL SMTP port when SSL is enabled for email server connections (fixes #2343)</MESSAGE>
      <SHA>4b575ef65c84ab5d2c96093f847a80bdb5c50603</SHA>
      <PATCHEDFILES>
        <FILE>docs/docusaurus/docs/bpmn/ch05a-Spring-Boot.md</FILE>
        <FILE>docs/docusaurus/docs/bpmn/ch14-Applications.md</FILE>
        <FILE>docs/userguide/src/en/bpmn/ch05a-Spring-Boot.adoc</FILE>
        <FILE>docs/userguide/src/en/bpmn/ch14-Applications.adoc</FILE>
        <FILE>docs/userguide/src/zh_CN/bpmn/ch05a-Spring-Boot.adoc</FILE>
        <FILE>docs/userguide/src/zh_CN/bpmn/ch13-UI.adoc</FILE>
        <FILE>docs/userguide/src/zh_CN/bpmn/ch14-Applications.adoc</FILE>
        <FILE>modules/flowable-cmmn-engine/src/main/java/org/flowable/cmmn/engine/CmmnEngineConfiguration.java</FILE>
        <FILE>modules/flowable-cmmn-engine/src/main/java/org/flowable/cmmn/engine/impl/behavior/impl/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable-engine-common/src/main/java/org/flowable/common/engine/impl/cfg/mail/MailServerInfo.java</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/ProcessEngineConfiguration.java</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable-spring-boot/flowable-spring-boot-starters/flowable-spring-boot-autoconfigure/src/main/java/org/flowable/spring/boot/FlowableMailProperties.java</FILE>
        <FILE>modules/flowable-spring-boot/flowable-spring-boot-starters/flowable-spring-boot-autoconfigure/src/main/java/org/flowable/spring/boot/ProcessEngineAutoConfiguration.java</FILE>
        <FILE>modules/flowable-spring-boot/flowable-spring-boot-starters/flowable-spring-boot-autoconfigure/src/main/resources/META-INF/additional-spring-configuration-metadata.json</FILE>
        <FILE>modules/flowable5-compatibility/src/main/java/org/flowable/compatibility/DefaultProcessEngineFactory.java</FILE>
        <FILE>modules/flowable5-engine/src/main/java/org/activiti/engine/ProcessEngineConfiguration.java</FILE>
        <FILE>modules/flowable5-engine/src/main/java/org/activiti/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Set SSL SMTP port when SSL is enabled for email server connections (fixes #2343)</MESSAGE>
      <SHA>fa174ec48b9245320c099b8dad38a01659d37557</SHA>
      <PATCHEDFILES>
        <FILE>docs/docusaurus/docs/bpmn/ch05a-Spring-Boot.md</FILE>
        <FILE>docs/docusaurus/docs/bpmn/ch14-Applications.md</FILE>
        <FILE>docs/userguide/src/en/bpmn/ch05a-Spring-Boot.adoc</FILE>
        <FILE>docs/userguide/src/en/bpmn/ch14-Applications.adoc</FILE>
        <FILE>docs/userguide/src/zh_CN/bpmn/ch05a-Spring-Boot.adoc</FILE>
        <FILE>docs/userguide/src/zh_CN/bpmn/ch13-UI.adoc</FILE>
        <FILE>docs/userguide/src/zh_CN/bpmn/ch14-Applications.adoc</FILE>
        <FILE>modules/flowable-cmmn-engine/src/main/java/org/flowable/cmmn/engine/CmmnEngineConfiguration.java</FILE>
        <FILE>modules/flowable-cmmn-engine/src/main/java/org/flowable/cmmn/engine/impl/behavior/impl/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable-engine-common/src/main/java/org/flowable/common/engine/impl/cfg/mail/MailServerInfo.java</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/ProcessEngineConfiguration.java</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable-spring-boot/flowable-spring-boot-starters/flowable-spring-boot-autoconfigure/src/main/java/org/flowable/spring/boot/FlowableMailProperties.java</FILE>
        <FILE>modules/flowable-spring-boot/flowable-spring-boot-starters/flowable-spring-boot-autoconfigure/src/main/java/org/flowable/spring/boot/ProcessEngineAutoConfiguration.java</FILE>
        <FILE>modules/flowable-spring-boot/flowable-spring-boot-starters/flowable-spring-boot-autoconfigure/src/main/resources/META-INF/additional-spring-configuration-metadata.json</FILE>
        <FILE>modules/flowable5-compatibility/src/main/java/org/flowable/compatibility/DefaultProcessEngineFactory.java</FILE>
        <FILE>modules/flowable5-engine/src/main/java/org/activiti/engine/ProcessEngineConfiguration.java</FILE>
        <FILE>modules/flowable5-engine/src/main/java/org/activiti/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Set SSL SMTP port when SSL is enabled for email server connections (fixes #2343) (#2373)</MESSAGE>
      <SHA>7eda57d1bbdc2e14ffc3b78c718322d70f88b573</SHA>
      <PATCHEDFILES>
        <FILE>docs/docusaurus/docs/bpmn/ch05a-Spring-Boot.md</FILE>
        <FILE>docs/docusaurus/docs/bpmn/ch14-Applications.md</FILE>
        <FILE>docs/userguide/src/en/bpmn/ch05a-Spring-Boot.adoc</FILE>
        <FILE>docs/userguide/src/en/bpmn/ch14-Applications.adoc</FILE>
        <FILE>docs/userguide/src/zh_CN/bpmn/ch05a-Spring-Boot.adoc</FILE>
        <FILE>docs/userguide/src/zh_CN/bpmn/ch13-UI.adoc</FILE>
        <FILE>docs/userguide/src/zh_CN/bpmn/ch14-Applications.adoc</FILE>
        <FILE>modules/flowable-cmmn-engine/src/main/java/org/flowable/cmmn/engine/CmmnEngineConfiguration.java</FILE>
        <FILE>modules/flowable-cmmn-engine/src/main/java/org/flowable/cmmn/engine/impl/behavior/impl/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable-engine-common/src/main/java/org/flowable/common/engine/impl/cfg/mail/MailServerInfo.java</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/ProcessEngineConfiguration.java</FILE>
        <FILE>modules/flowable-engine/src/main/java/org/flowable/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
        <FILE>modules/flowable-spring-boot/flowable-spring-boot-starters/flowable-spring-boot-autoconfigure/src/main/java/org/flowable/spring/boot/FlowableMailProperties.java</FILE>
        <FILE>modules/flowable-spring-boot/flowable-spring-boot-starters/flowable-spring-boot-autoconfigure/src/main/java/org/flowable/spring/boot/ProcessEngineAutoConfiguration.java</FILE>
        <FILE>modules/flowable-spring-boot/flowable-spring-boot-starters/flowable-spring-boot-autoconfigure/src/main/resources/META-INF/additional-spring-configuration-metadata.json</FILE>
        <FILE>modules/flowable5-compatibility/src/main/java/org/flowable/compatibility/DefaultProcessEngineFactory.java</FILE>
        <FILE>modules/flowable5-engine/src/main/java/org/activiti/engine/ProcessEngineConfiguration.java</FILE>
        <FILE>modules/flowable5-engine/src/main/java/org/activiti/engine/impl/bpmn/behavior/MailActivityBehavior.java</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
