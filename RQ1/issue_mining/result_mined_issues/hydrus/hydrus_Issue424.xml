<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>424</ISSUENO>
  <ISSUEURL>https://github.com/HTTP-APIs/hydrus/issues/424</ISSUEURL>
  <TITLE>General refactoring</TITLE>
  <DESCRIPTION>### Current Behaviour: A lot of functions have many if-else branches and the procedures implemented by these branches have too much code in them. This makes readability and testability hard. For example the branch in this [chunk of code](https://github.com/HTTP-APIs/hydrus/blob/42205ab4d4984f591310b19f3b5d6c1610e95e4d/hydrus/resources.py#L108) should be ported into a function like: ``` if checkClassOp(class_path, &quot;GET&quot;): items_get_check_support() abort(405) ``` Into a dedicated module called `itemshelpers.py` the above functions should be defined by incorporating the current code: ``` def items_get_check_support(...): &quot;&quot;&quot; Check if class_type supports GET operation try: # Try getting the Item based on ID and Class type response = crud.get( id_, class_type, api_name=get_api_name(), session=get_session()) response = finalize_response(class_path, response) return set_response_headers( jsonify(hydrafy(response, path=path))) except (ClassNotFound, InstanceNotFound) as e: error = e.get_HTTP() return set_response_headers(jsonify(error.generate()), status_code=error.code) ``` Each of these helpers functions should be tested separately. ### Expected Behaviour: All functions should perform well-scoped units of work and have their own tests. Handlers in endpoints classes should be much more concise, all the units of work for each branch should be moved into helpers functions. Main functions should look something like this: ``` def post(...): &quot;&quot;&quot; Docstring &quot;&quot;&quot; ... some code ... if condition_1: run_helper_1(...) elif condition_2: run_helper_2(...) else: run_helper_3(...) ... rest of the code ... ```</DESCRIPTION>
  <REPONAME>hydrus</REPONAME>
  <TIMEDIFFERENCEDAYS>375</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>fix startup error in docker</MESSAGE>
    <SHA>72b4cda49ab9cfe0fb775146e8d5113f5d6869e0</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Refactor checkClassOp() in resources.py related to #424</MESSAGE>
      <SHA>c22ea3108f784a27bc4a955ff3b31b115f04b585</SHA>
      <PATCHEDFILES>
        <FILE>hydrus/itemhelpers.py</FILE>
        <FILE>hydrus/resources.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Refactor checkClassOp() in resources.py related to #424</MESSAGE>
      <SHA>9497205e059294cfdfd5a423a325a6e77319c630</SHA>
      <PATCHEDFILES>
        <FILE>hydrus/itemhelpers.py</FILE>
        <FILE>hydrus/resources.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Refactor Item class in resources.py (#435) * Refactor checkClassOp() in resources.py related to #424 * Fix failing imports * Fix pep8 compliance * Fix build errors * Refactor post method in Item class * Refactor put method in item class * Refactor delete method in Item class * Fix PEP8 issues</MESSAGE>
      <SHA>963290c200b337a190259435f5f99b53ab099caa</SHA>
      <PATCHEDFILES>
        <FILE>hydrus/itemhelpers.py</FILE>
        <FILE>hydrus/resources.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
