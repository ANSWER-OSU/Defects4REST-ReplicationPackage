<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>3570</ISSUENO>
  <ISSUEURL>https://github.com/getredash/redash/issues/3570</ISSUEURL>
  <TITLE>ElasticSearch: schema refresh failed</TITLE>
  <DESCRIPTION>### Issue Summary When I try to create a new query using a ES data source I get an error: schema refresh failed. ### Steps to Reproduce 1. Created a ES datasource successfully 2. When creating a new query and selecting the ES data source a message appears: Schema refresh failed. Please try again later. ### Technical details: * Redash Version: 6.0.0+b8537 (4780bd9c) * Browser/OS: MacOS 10.14.1, Chrome 72.0.3626.121 * How did you install Redash: Docker * ElasticSearch version: 5.6.4</DESCRIPTION>
  <REPONAME>redash</REPONAME>
  <TIMEDIFFERENCEDAYS>0</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Bolder markdown in textbox (#3686)</MESSAGE>
    <SHA>1babd01f38e85e0de81b2440b0f05024015713fb</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>fixes #3570: when elasticsearch indexes contains '_default_', it will raise error due to lack of key 'properties'</MESSAGE>
      <SHA>999ab5a4421580a02c9fa64875a77e84b9b401f2</SHA>
      <PATCHEDFILES>
        <FILE>redash/handlers/data_sources.py</FILE>
        <FILE>redash/query_runner/elasticsearch.py</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
