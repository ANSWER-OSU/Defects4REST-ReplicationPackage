<?xml version="1.0" ?>
<ISSUE>
  <ISSUENO>779</ISSUENO>
  <ISSUEURL>https://github.com/getredash/redash/issues/779</ISSUEURL>
  <TITLE>regression: some of the bar graphs in plotly sometimes appear as line graphs when ::filter annotation present</TITLE>
  <DESCRIPTION>Example: (visualization tab) https://demo.redash.io/queries/1050 When selecting options from the second ::filter (drop-down), some of the bar graphs are showing up as line graphs (looks like it's mistakenly using a scatterlayer instead of using a barlayer). If the above query is lost, here is the example sql. Just make a bar graph using retrieved_at_month as the x-axis, data_length as series/group, and total_runtime as y-axis: select data_source_id as &quot;id::filter&quot;, cast(trunc(log(length(query) + 1)) as int) as &quot;query_length::filter&quot;, to_char(retrieved_at, 'YYYY-MM') retrieved_at_month, cast(trunc(log(length(data) + 1)) as int) data_length, sum(runtime) total_runtime from query_results where retrieved_at &gt;= '2015-10-01' group by 1, 2, 3, 4;</DESCRIPTION>
  <REPONAME>redash</REPONAME>
  <TIMEDIFFERENCEDAYS>87</TIMEDIFFERENCEDAYS>
  <BUGGYCOMMIT>
    <MESSAGE>Remove angular-plotly and use Plotly's autoresize</MESSAGE>
    <SHA>c51779708e6f77bf505dbbc36fd7de36bdb81369</SHA>
  </BUGGYCOMMIT>
  <PATCHCOMMITS>
    <COMMIT>
      <MESSAGE>Fix #779: use the default chart type for new series</MESSAGE>
      <SHA>cf2407b69be959609edacca6f2d65cec100fdcd7</SHA>
      <PATCHEDFILES>
        <FILE>rd_ui/app/scripts/directives/plotly.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
    <COMMIT>
      <MESSAGE>Fix #779: use the default chart type for new series</MESSAGE>
      <SHA>0f20f8d5f9b5eae65cc5a2d645ee5de3506c9bbb</SHA>
      <PATCHEDFILES>
        <FILE>rd_ui/app/scripts/directives/plotly.js</FILE>
      </PATCHEDFILES>
    </COMMIT>
  </PATCHCOMMITS>
</ISSUE>
