issue_no,repo,issue_url,title,description,patched_file_types,text_for_topic_modeling,prediction,confidence
3032,DSpace,https://github.com/DSpace/DSpace/issues/3032,pagination for eperson/groups/search/byMetadata method doesn't work properly,"**Describe the bug** If I make a request to `api/eperson/groups/search/byMetadata` the pagination works properly only for the first page. Indeed if I make a request for a page after the first I get a number of results which are twice as many as required **To Reproduce** It can be verified directly on the demo server: 1. login as admin through hal browser https://dspace7.4science.cloud/server 2. make a new request for the first page, and verify the server return 10 results : https://dspace7.4science.cloud/server/#https://dspace7.4science.cloud/server/api/eperson/groups/search/byMetadata?page=0&size=10&query= 3. make a new request for the second page, and verify the server return 20 results instead of 10 : https://dspace7.4science.cloud/server/#https://dspace7.4science.cloud/server/api/eperson/groups/search/byMetadata?page=1&size=10&query= **Expected behavior** It should return the exact number of results for every page requested",config-file,"pagination for eperson/groups/search/byMetadata method doesn't work properly **Describe the bug** If I make a request to `api/eperson/groups/search/byMetadata` the pagination works properly only for the first page. Indeed if I make a request for a page after the first I get a number of results which are twice as many as required **To Reproduce** It can be verified directly on the demo server: 1. login as admin through hal browser https://dspace7.4science.cloud/server 2. make a new request for the first page, and verify the server return 10 results : https://dspace7.4science.cloud/server/#https://dspace7.4science.cloud/server/api/eperson/groups/search/byMetadata?page=0&size=10&query= 3. make a new request for the second page, and verify the server return 20 results instead of 10 : https://dspace7.4science.cloud/server/#https://dspace7.4science.cloud/server/api/eperson/groups/search/byMetadata?page=1&size=10&query= **Expected behavior** It should return the exact number of results for every page requested config-file",bug,0.9
3694,DSpace,https://github.com/DSpace/DSpace/issues/3694,[DS-319] Replace '/dspace/bin/dsrun org.dspace.browse.ItemCounter' with /dspace/bin/itemcounter,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-319"">[DS-319]</a> created by stuartlewis</i> <p>At present, to update the collection and community strengths you must run 'dsrun org.dspace.browse.ItemCounter'. This has been replaced with a new script in <span class=""error"">&#91;dspace&#93;</span>/bin/ called itemcounter.</p> <p>dspace.cfg has been updated accordingly. </p> <p>All other documentation will need updating.</p>",source-file,"[DS-319] Replace '/dspace/bin/dsrun org.dspace.browse.ItemCounter' with /dspace/bin/itemcounter <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-319"">[DS-319]</a> created by stuartlewis</i> <p>At present, to update the collection and community strengths you must run 'dsrun org.dspace.browse.ItemCounter'. This has been replaced with a new script in <span class=""error"">&#91;dspace&#93;</span>/bin/ called itemcounter.</p> <p>dspace.cfg has been updated accordingly. </p> <p>All other documentation will need updating.</p> source-file",no-bug,0.9
8494,DSpace,https://github.com/DSpace/DSpace/issues/8494,Deleting bitstreams via the 6.x REST API leaves empty bundles,"Deleting the last bitstreams in a bundle via the REST API on DSpace 6.4 (including on demo.dspace.org) from either the `DELETE /items/{item id}/bitstreams/{bitstream id}` or `DELETE /bitstreams/{bitstream id}` endpoints leaves the bundle itself and the link between the bundle and the item, which results an empty bundle in the item bitstreams. This is mostly harmless but causes XMLUI to show a broken thumbnail. To reproduce the bug, add a bitstream in a bundle, then delete it through the REST API (all the item bitstreams in a bundle must be deleted): bash curl -X DELETE '{DOMAIN}/rest/bitstreams/{BITSTREAM_ID}' -H 'Cookie:JSESSIONID={JSESSIONID}'  The behavior can be confirmed by either looking at the `item2bundle` table in the database, which will show that the bundle is still there or from the XMLUI bitstreams edit form. **After deleting the last ORIGINAL bitstream (XMLUI edit bitstreams form):** <img width=""868"" alt=""Screen Shot 2022-09-29 at 2 23 21 PM"" src=""https://user-images.githubusercontent.com/20943086/193020060-8d05988e-d785-4ddc-80c6-f8352d27aa46.png""> **After deleting the last THUMBNAIL bitstream (XMLUI edit bitstreams form):** <img width=""855"" alt=""Screen Shot 2022-09-29 at 2 27 41 PM"" src=""https://user-images.githubusercontent.com/20943086/193020084-a00b1837-c924-4fb2-8d7a-3e0dd779baea.png""> **After deleting the last THUMBNAIL bitstream (XMLUI item view):** <img width=""824"" alt=""Screen Shot 2022-09-29 at 2 28 19 PM"" src=""https://user-images.githubusercontent.com/20943086/193020118-a963c951-12c7-40bd-b0f3-bdc26d527d15.png""> The suggested fix is to delete the bundle when there are no remaining bitstreams. https://github.com/DSpace/DSpace/pull/8497",source-file | source-file,"Deleting bitstreams via the 6.x REST API leaves empty bundles Deleting the last bitstreams in a bundle via the REST API on DSpace 6.4 (including on demo.dspace.org) from either the `DELETE /items/{item id}/bitstreams/{bitstream id}` or `DELETE /bitstreams/{bitstream id}` endpoints leaves the bundle itself and the link between the bundle and the item, which results an empty bundle in the item bitstreams. This is mostly harmless but causes XMLUI to show a broken thumbnail. To reproduce the bug, add a bitstream in a bundle, then delete it through the REST API (all the item bitstreams in a bundle must be deleted): bash curl -X DELETE '{DOMAIN}/rest/bitstreams/{BITSTREAM_ID}' -H 'Cookie:JSESSIONID={JSESSIONID}'  The behavior can be confirmed by either looking at the `item2bundle` table in the database, which will show that the bundle is still there or from the XMLUI bitstreams edit form. **After deleting the last ORIGINAL bitstream (XMLUI edit bitstreams form):** <img width=""868"" alt=""Screen Shot 2022-09-29 at 2 23 21 PM"" src=""https://user-images.githubusercontent.com/20943086/193020060-8d05988e-d785-4ddc-80c6-f8352d27aa46.png""> **After deleting the last THUMBNAIL bitstream (XMLUI edit bitstreams form):** <img width=""855"" alt=""Screen Shot 2022-09-29 at 2 27 41 PM"" src=""https://user-images.githubusercontent.com/20943086/193020084-a00b1837-c924-4fb2-8d7a-3e0dd779baea.png""> **After deleting the last THUMBNAIL bitstream (XMLUI item view):** <img width=""824"" alt=""Screen Shot 2022-09-29 at 2 28 19 PM"" src=""https://user-images.githubusercontent.com/20943086/193020118-a963c951-12c7-40bd-b0f3-bdc26d527d15.png""> The suggested fix is to delete the bundle when there are no remaining bitstreams. https://github.com/DSpace/DSpace/pull/8497 source-file source-file",bug,0.95
8549,DSpace,https://github.com/DSpace/DSpace/issues/8549,ImageMagick produces a strange two-page thumbnail layout for certain PDFs,"ImageMagick uses the PDF `MediaBox` by default when rasterizing PDFs. In certain PDFs this can lead to an unexpected layout in the resulting thumbnail, for example (open the following image in a new tab to see the blank white page): <p align=""center""> <img width=""400"" src=""https://user-images.githubusercontent.com/191754/198264352-29be6a14-5387-4fb7-b94b-1355af98d3db.jpg""> </p> This happens because certain PDFs have different sizes for their `MediaBox` (which is the parent container for all page content) and their `CropBox`. In many PDFs these two boxes are the same, but PDFs meant for print often set one content area size for print and one for displaying on screen. The source PDF for the thumbnail above has the following page boxes according to `pdfinfo` (from the poppler package): console $ pdfinfo -box 10568-116598.pdf  MediaBox: 0.00 0.00 1190.55 841.89 CropBox: 594.38 0.00 1190.55 839.18 BleedBox: 594.38 0.00 1190.55 839.18 TrimBox: 594.38 0.00 1190.55 839.18 ArtBox: 594.38 0.00 1190.55 839.18  Notice the `MediaBox` and `CropBox` are different sizes. We have hundreds (thousands?) of PDFs with this issue in our repository. **Related work** 1. See this [bug report and response from the Ghostscript developers](https://bugs.ghostscript.com/show_bug.cgi?id=705994) (ImageMagick uses Ghostscript for rasterization under the hood).",source-file | source-file,"ImageMagick produces a strange two-page thumbnail layout for certain PDFs ImageMagick uses the PDF `MediaBox` by default when rasterizing PDFs. In certain PDFs this can lead to an unexpected layout in the resulting thumbnail, for example (open the following image in a new tab to see the blank white page): <p align=""center""> <img width=""400"" src=""https://user-images.githubusercontent.com/191754/198264352-29be6a14-5387-4fb7-b94b-1355af98d3db.jpg""> </p> This happens because certain PDFs have different sizes for their `MediaBox` (which is the parent container for all page content) and their `CropBox`. In many PDFs these two boxes are the same, but PDFs meant for print often set one content area size for print and one for displaying on screen. The source PDF for the thumbnail above has the following page boxes according to `pdfinfo` (from the poppler package): console $ pdfinfo -box 10568-116598.pdf  MediaBox: 0.00 0.00 1190.55 841.89 CropBox: 594.38 0.00 1190.55 839.18 BleedBox: 594.38 0.00 1190.55 839.18 TrimBox: 594.38 0.00 1190.55 839.18 ArtBox: 594.38 0.00 1190.55 839.18  Notice the `MediaBox` and `CropBox` are different sizes. We have hundreds (thousands?) of PDFs with this issue in our repository. **Related work** 1. See this [bug report and response from the Ghostscript developers](https://bugs.ghostscript.com/show_bug.cgi?id=705994) (ImageMagick uses Ghostscript for rasterization under the hood). source-file source-file",no-bug,0.95
3130,DSpace,https://github.com/DSpace/DSpace/issues/3130,Group2group cache is not updated by the REST endpoint,"**Describe the bug** The `org.dspace.app.rest.GroupRestController` doesn't call the update method of the group service that is responsible from the other things to rethink the group cache. This imply that if an user is member of the childGroup that is added as children to the parentGroup the subsequent calls to `GroupService.allMemberGroups(Context, EPerson)` would fail to get the parentGroup **To Reproduce** Steps to reproduce the behavior: 1. login as admin 2. create a ""children group"" 3. add the children group as member of a collection/community admin group 4. add a normal user to the children group 5. login with such user 6. verify that such user is not seen as administrator of the community/collection, this because it is an indirect member of the admin group. Alternatively you can check the content of the group2groupcache table This bugs also invalidate several scenario related to the security, discovery and workflow if the involved user get rights/tasks due to his membership to a sub-group **Expected behavior** The group2groupcache table is updated when a group is added or removed as a member of another group via the REST endpoints",test-file | source-file | source-file,"Group2group cache is not updated by the REST endpoint **Describe the bug** The `org.dspace.app.rest.GroupRestController` doesn't call the update method of the group service that is responsible from the other things to rethink the group cache. This imply that if an user is member of the childGroup that is added as children to the parentGroup the subsequent calls to `GroupService.allMemberGroups(Context, EPerson)` would fail to get the parentGroup **To Reproduce** Steps to reproduce the behavior: 1. login as admin 2. create a ""children group"" 3. add the children group as member of a collection/community admin group 4. add a normal user to the children group 5. login with such user 6. verify that such user is not seen as administrator of the community/collection, this because it is an indirect member of the admin group. Alternatively you can check the content of the group2groupcache table This bugs also invalidate several scenario related to the security, discovery and workflow if the involved user get rights/tasks due to his membership to a sub-group **Expected behavior** The group2groupcache table is updated when a group is added or removed as a member of another group via the REST endpoints test-file source-file source-file",bug,0.9
8134,DSpace,https://github.com/DSpace/DSpace/issues/8134,RequestItemHelpdeskStrategy missing autowire attribute,"**Describe the bug** A clear and concise description of what the bug is. Include the version(s) of DSpace where you've seen this problem. Link to examples if they are public. In DSpace v7.x, the RequestItemMetadataStrategy Spring bean found in https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/requestitem.xml had the `autowire-candidate='true'` attribute added (which works fine). For those preferring to use the Helpdesk Strategy, the commented out RequestItemHelpdeskStrategy is missing the `autowire-candidate='true'` attribute, so uncommenting it and attempting to use it as-is does not work. **To Reproduce** Attempt to configure DSpace to use the RequestItemHelpdeskStrategy rather than RequestItemMetadataStrategy using the beans as currently defined. **To Fix** The obvious fix for this is to add `autowire-candidate='true'` to the commented out RequestItemHelpdeskStrategy, so that when used, it will work.",config-file,"RequestItemHelpdeskStrategy missing autowire attribute **Describe the bug** A clear and concise description of what the bug is. Include the version(s) of DSpace where you've seen this problem. Link to examples if they are public. In DSpace v7.x, the RequestItemMetadataStrategy Spring bean found in https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/requestitem.xml had the `autowire-candidate='true'` attribute added (which works fine). For those preferring to use the Helpdesk Strategy, the commented out RequestItemHelpdeskStrategy is missing the `autowire-candidate='true'` attribute, so uncommenting it and attempting to use it as-is does not work. **To Reproduce** Attempt to configure DSpace to use the RequestItemHelpdeskStrategy rather than RequestItemMetadataStrategy using the beans as currently defined. **To Fix** The obvious fix for this is to add `autowire-candidate='true'` to the commented out RequestItemHelpdeskStrategy, so that when used, it will work. config-file",no-bug,0.9
8963,DSpace,https://github.com/DSpace/DSpace/issues/8963,"Cannot delete an EPerson via the commandline ""Groomer"" tool when EPerson is referenced elsewhere.","**Describe the bug** Are the constraints for deletion of EPersons still up to date to the possibility of EPerson deletion in DSpace 7, as I thought we could delete EPersons regardless of their involvement in Items/Workspace-Items/Workflow-Items now? Those restrictions seem to be applied, when trying to delete EPersons e.g. from the Groomer Tool, but seem not to be applied when deleting the same EPerson from the Angular User Interface. `getDeleteConstraints` in `EPersonServiceImpl` lists the following restrictions:  public List<String> getDeleteConstraints(Context context, EPerson ePerson) throws SQLException { List<String> tableList = new ArrayList<>(); // check for eperson in item table Iterator<Item> itemsBySubmitter = itemService.findBySubmitter(context, ePerson, true); if (itemsBySubmitter.hasNext()) { tableList.add(""item""); } WorkspaceItemService workspaceItemService = ContentServiceFactory.getInstance().getWorkspaceItemService(); List<WorkspaceItem> workspaceBySubmitter = workspaceItemService.findByEPerson(context, ePerson); if (workspaceBySubmitter.size() > 0) { tableList.add(""workspaceitem""); } ResourcePolicyService resourcePolicyService = AuthorizeServiceFactory.getInstance().getResourcePolicyService(); if (resourcePolicyService.find(context, ePerson).size() > 0) { tableList.add(""resourcepolicy""); } WorkflowService workflowService = WorkflowServiceFactory.getInstance().getWorkflowService(); List<String> workflowConstraints = workflowService.getEPersonDeleteConstraints(context, ePerson); tableList.addAll(workflowConstraints); // the list of tables can be used to construct an error message // explaining to the user why the eperson cannot be deleted. return tableList;  **To Reproduce** Steps to reproduce the behavior: 1. Try to delete an EPerson that has one of the listed restrictions via e.g. the Groomer tool -> it fails 2. Try to delete the same EPerson via the Angular UI -> it succeeds **Expected behavior** Either the restrictions are valid, then the EPerson should not be deletable in both ways, or they are invalid, then they should be deletable both ways.",source-file | source-file | source-file | source-file,"Cannot delete an EPerson via the commandline ""Groomer"" tool when EPerson is referenced elsewhere. **Describe the bug** Are the constraints for deletion of EPersons still up to date to the possibility of EPerson deletion in DSpace 7, as I thought we could delete EPersons regardless of their involvement in Items/Workspace-Items/Workflow-Items now? Those restrictions seem to be applied, when trying to delete EPersons e.g. from the Groomer Tool, but seem not to be applied when deleting the same EPerson from the Angular User Interface. `getDeleteConstraints` in `EPersonServiceImpl` lists the following restrictions:  public List<String> getDeleteConstraints(Context context, EPerson ePerson) throws SQLException { List<String> tableList = new ArrayList<>(); // check for eperson in item table Iterator<Item> itemsBySubmitter = itemService.findBySubmitter(context, ePerson, true); if (itemsBySubmitter.hasNext()) { tableList.add(""item""); } WorkspaceItemService workspaceItemService = ContentServiceFactory.getInstance().getWorkspaceItemService(); List<WorkspaceItem> workspaceBySubmitter = workspaceItemService.findByEPerson(context, ePerson); if (workspaceBySubmitter.size() > 0) { tableList.add(""workspaceitem""); } ResourcePolicyService resourcePolicyService = AuthorizeServiceFactory.getInstance().getResourcePolicyService(); if (resourcePolicyService.find(context, ePerson).size() > 0) { tableList.add(""resourcepolicy""); } WorkflowService workflowService = WorkflowServiceFactory.getInstance().getWorkflowService(); List<String> workflowConstraints = workflowService.getEPersonDeleteConstraints(context, ePerson); tableList.addAll(workflowConstraints); // the list of tables can be used to construct an error message // explaining to the user why the eperson cannot be deleted. return tableList;  **To Reproduce** Steps to reproduce the behavior: 1. Try to delete an EPerson that has one of the listed restrictions via e.g. the Groomer tool -> it fails 2. Try to delete the same EPerson via the Angular UI -> it succeeds **Expected behavior** Either the restrictions are valid, then the EPerson should not be deletable in both ways, or they are invalid, then they should be deletable both ways. source-file source-file source-file source-file",no-bug,0.8
6661,DSpace,https://github.com/DSpace/DSpace/issues/6661,[DS-3306] bin/dspace create-administrator needs a --help option,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3306"">[DS-3306]</a> created by mwood</i> <p>create-administrator doesn't respond well to any of the usual methods of asking how to use it. It should be made to understand -h, --help, and -?</p> <p>While the code is open, also it should not require -c if webui.supported.locales is empty.</p> <p>Oh, one more thing: we should just prompt for the password if it isn't specified but there are enough other options to create the user.</p>",source-file,"[DS-3306] bin/dspace create-administrator needs a --help option <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3306"">[DS-3306]</a> created by mwood</i> <p>create-administrator doesn't respond well to any of the usual methods of asking how to use it. It should be made to understand -h, --help, and -?</p> <p>While the code is open, also it should not require -c if webui.supported.locales is empty.</p> <p>Oh, one more thing: we should just prompt for the password if it isn't specified but there are enough other options to create the user.</p> source-file",no-bug,0.9
3446,DSpace,https://github.com/DSpace/DSpace/issues/3446,[DS-69] DatabaseManager updates for HSQL - ID: 2035028,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-69"">[DS-69]</a> created by kipkorir2008</i> <p>This patch updates the 1.5.x DatabaseManager, allowing it to work with<br/> HSQL.</p> <p>It adds some additional JDBC 3.0 type mappings, fixes a bug in the max<br/> table name check, and adds some additional database properties:</p> <p>db.validateOnBorrow (defaults true, unchanged)<br/> db.validationQuery (defaults unchanged)</p>",source-file,"[DS-69] DatabaseManager updates for HSQL - ID: 2035028 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-69"">[DS-69]</a> created by kipkorir2008</i> <p>This patch updates the 1.5.x DatabaseManager, allowing it to work with<br/> HSQL.</p> <p>It adds some additional JDBC 3.0 type mappings, fixes a bug in the max<br/> table name check, and adds some additional database properties:</p> <p>db.validateOnBorrow (defaults true, unchanged)<br/> db.validationQuery (defaults unchanged)</p> source-file",no-bug,0.9
3714,DSpace,https://github.com/DSpace/DSpace/issues/3714,[DS-339] Cleanup Dependencies and POM files prior to release. Upgrade Servlet API to 2.4 across all projects,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-339"">[DS-339]</a> created by mdiggory</i> <p>Cleaning up pom files and isolating dependencies into dependency Management where appropriate. </p> <p>Consolidate web.xml filter into profile where dspace.config is actually set, otherwise filtering is unnecessary.</p> <p>Move dspace-shared-ui project to dspace-common-webapp.</p>",source-file,"[DS-339] Cleanup Dependencies and POM files prior to release. Upgrade Servlet API to 2.4 across all projects <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-339"">[DS-339]</a> created by mdiggory</i> <p>Cleaning up pom files and isolating dependencies into dependency Management where appropriate. </p> <p>Consolidate web.xml filter into profile where dspace.config is actually set, otherwise filtering is unnecessary.</p> <p>Move dspace-shared-ui project to dspace-common-webapp.</p> source-file",no-bug,0.9
3530,DSpace,https://github.com/DSpace/DSpace/issues/3530,[DS-155] Maven war plugin changes cause war to include libraries as well,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-155"">[DS-155]</a> created by mdiggory</i> <p>Maven War Plugin had changed name of property for excluding resources from the packaged war artifact.</p>",config-file,"[DS-155] Maven war plugin changes cause war to include libraries as well <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-155"">[DS-155]</a> created by mdiggory</i> <p>Maven War Plugin had changed name of property for excluding resources from the packaged war artifact.</p> config-file",no-bug,0.9
8099,DSpace,https://github.com/DSpace/DSpace/issues/8099,Converge all use of EHcache to v3,"**Describe the bug** As I write this, DSpace v7 depends on both EHcache v2 (for Hibernate and general caching) and v3 (in the dspace-server-webapp). We should converge on a single version. While we are working on caching, we should also consider moving all of our own code to use the Jcache/JSR107 API, which EHcache supports, rather than the proprietary EHcache API, and to configure Hibernate to use it as well. Hibernate recommends its own Jcache adapter over its own native-EHcache adapter: https://hibernate.atlassian.net/browse/HHH-12441 **To Reproduce** Search for ehcache*.jar in the install target tree (`dspace/target/dspace-installer`). You will find v2 in `lib/` and v3 in `webapps/server/`. **Expected behavior** We should find only one version of the EHcache JARs.",config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file,"Converge all use of EHcache to v3 **Describe the bug** As I write this, DSpace v7 depends on both EHcache v2 (for Hibernate and general caching) and v3 (in the dspace-server-webapp). We should converge on a single version. While we are working on caching, we should also consider moving all of our own code to use the Jcache/JSR107 API, which EHcache supports, rather than the proprietary EHcache API, and to configure Hibernate to use it as well. Hibernate recommends its own Jcache adapter over its own native-EHcache adapter: https://hibernate.atlassian.net/browse/HHH-12441 **To Reproduce** Search for ehcache*.jar in the install target tree (`dspace/target/dspace-installer`). You will find v2 in `lib/` and v3 in `webapps/server/`. **Expected behavior** We should find only one version of the EHcache JARs. config-file config-file config-file config-file config-file config-file config-file config-file config-file",no-bug,0.9
3478,DSpace,https://github.com/DSpace/DSpace/issues/3478,[DS-101] Impossible to complete Registration in JSPUI,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-101"">[DS-101]</a> created by cjuergen</i> <p>It is impossible to complete a registration in the jspui, fails with a NPE.<br/> Due to changes in revision 3575 of RegisterServlet, revision 2571 worked ok.</p>",source-file,"[DS-101] Impossible to complete Registration in JSPUI <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-101"">[DS-101]</a> created by cjuergen</i> <p>It is impossible to complete a registration in the jspui, fails with a NPE.<br/> Due to changes in revision 3575 of RegisterServlet, revision 2571 worked ok.</p> source-file",no-bug,0.9
7126,DSpace,https://github.com/DSpace/DSpace/issues/7126,[DS-3779] REST 7 BistreamFormats endpoint throws error when searching based on id,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3779"">[DS-3779]</a> created by JonasVg</i> <p>Currently, the calls done to the bitstreamformats that use the id return an error, even if the actual id exists<br/> eg:<br/> As we can see in this call, there are actually bitstreamformats present<br/> <a href=""https://tinyurl.com/yby4vkco"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://tinyurl.com/yby4vkco</a><br/> BUT, for example, the endpoint bitstreamformats/1<br/> <a href=""https://tinyurl.com/yawmpdej"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://tinyurl.com/yawmpdej</a><br/> throws an error</p>",other-file | config-file | other-file,"[DS-3779] REST 7 BistreamFormats endpoint throws error when searching based on id <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3779"">[DS-3779]</a> created by JonasVg</i> <p>Currently, the calls done to the bitstreamformats that use the id return an error, even if the actual id exists<br/> eg:<br/> As we can see in this call, there are actually bitstreamformats present<br/> <a href=""https://tinyurl.com/yby4vkco"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://tinyurl.com/yby4vkco</a><br/> BUT, for example, the endpoint bitstreamformats/1<br/> <a href=""https://tinyurl.com/yawmpdej"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://tinyurl.com/yawmpdej</a><br/> throws an error</p> other-file config-file other-file",bug,0.9
8018,DSpace,https://github.com/DSpace/DSpace/issues/8018,Rely on https handle.net urls instead of http ones,"**Describe the bug** In all DSpace versions, we use and advertise http handle.net links. However, handle.net fully supports https urls and may even implement future auto-redirects from http to https. HTTPS link usage is already a ranking signal for many years. https://developers.google.com/search/blog/2014/08/https-as-ranking-signal **To Reproduce** Steps to reproduce the behavior: 1. Visit any DSpace item page 2. Look for the hdl.handle.net link 3. Check if it's http or https **Expected behavior** It should be https, but http is currently observed everywhere **Related work** Place in the code to update, not sure if it's the only place: https://github.com/DSpace/DSpace/blob/34c1e82275dbbc42010b79cd5872a86d861d9827/dspace-api/src/main/java/org/dspace/handle/HandleServiceImpl.java#L131",source-file | source-file | source-file | other-file | other-file,"Rely on https handle.net urls instead of http ones **Describe the bug** In all DSpace versions, we use and advertise http handle.net links. However, handle.net fully supports https urls and may even implement future auto-redirects from http to https. HTTPS link usage is already a ranking signal for many years. https://developers.google.com/search/blog/2014/08/https-as-ranking-signal **To Reproduce** Steps to reproduce the behavior: 1. Visit any DSpace item page 2. Look for the hdl.handle.net link 3. Check if it's http or https **Expected behavior** It should be https, but http is currently observed everywhere **Related work** Place in the code to update, not sure if it's the only place: https://github.com/DSpace/DSpace/blob/34c1e82275dbbc42010b79cd5872a86d861d9827/dspace-api/src/main/java/org/dspace/handle/HandleServiceImpl.java#L131 source-file source-file source-file other-file other-file",no-bug,0.9
8479,DSpace,https://github.com/DSpace/DSpace/issues/8479,Regular search can contain private & withdrawn items,"**Describe the bug** Regular search contains withdrawn and private items (if logged in as admin), these should probably only appear in the admin search. This is I think blocked for regular users with because of the lack of `read:g{AnonGroup}` solr field in the docs for private/withdrawn items. Since if fix/migrate from https://github.com/DSpace/DSpace/pull/8438 is not applied, then withdrawn items are visible for all/anon. **To Reproduce** Logged in as admin: - [[regular search for withdrawn item](https://demo7.dspace.org/search?query=cce2a443-c792-465e-9fd5-2cbf9aec2e68)](https://demo7.dspace.org/search?query=cce2a443-c792-465e-9fd5-2cbf9aec2e68) => Contains withdrawn item [[Ancient Greece](https://demo7.dspace.org/items/cce2a443-c792-465e-9fd5-2cbf9aec2e68)](https://demo7.dspace.org/items/cce2a443-c792-465e-9fd5-2cbf9aec2e68) in regular search result - Idem [[regular search for private item](https://demo7.dspace.org/search?query=68e9ec51-38cf-4549-937d-fb8ea8194551)](https://demo7.dspace.org/search?query=68e9ec51-38cf-4549-937d-fb8ea8194551) => Contains private item [[Testing Example.](https://demo7.dspace.org/items/68e9ec51-38cf-4549-937d-fb8ea8194551)](https://demo7.dspace.org/items/68e9ec51-38cf-4549-937d-fb8ea8194551) in regular search result **Expected behavior** Private or withdrawn items should not appear in regular search regardless of which user sees results. They should only appear in admin search (where there are sidebar filters/facets for them) **Proposed solution** Easiest solution: add `-withdrawn:true AND -discoverable:false` filter in default `DiscoveryConfiguration` in `defaultFilterQueries` property [[here](https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L202-L207)](https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L202-L207) Since there is a separate ""unDiscoverableItems"" config which contains the opposite [[here](https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L480)](https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L480) I think it is assumed that this functionality is default. **Related** If fix/migrate from https://github.com/DSpace/DSpace/pull/8438 is not applied, then withdrawn items are visible for all users.",config-file | config-file | config-file,"Regular search can contain private & withdrawn items **Describe the bug** Regular search contains withdrawn and private items (if logged in as admin), these should probably only appear in the admin search. This is I think blocked for regular users with because of the lack of `read:g{AnonGroup}` solr field in the docs for private/withdrawn items. Since if fix/migrate from https://github.com/DSpace/DSpace/pull/8438 is not applied, then withdrawn items are visible for all/anon. **To Reproduce** Logged in as admin: - [[regular search for withdrawn item](https://demo7.dspace.org/search?query=cce2a443-c792-465e-9fd5-2cbf9aec2e68)](https://demo7.dspace.org/search?query=cce2a443-c792-465e-9fd5-2cbf9aec2e68) => Contains withdrawn item [[Ancient Greece](https://demo7.dspace.org/items/cce2a443-c792-465e-9fd5-2cbf9aec2e68)](https://demo7.dspace.org/items/cce2a443-c792-465e-9fd5-2cbf9aec2e68) in regular search result - Idem [[regular search for private item](https://demo7.dspace.org/search?query=68e9ec51-38cf-4549-937d-fb8ea8194551)](https://demo7.dspace.org/search?query=68e9ec51-38cf-4549-937d-fb8ea8194551) => Contains private item [[Testing Example.](https://demo7.dspace.org/items/68e9ec51-38cf-4549-937d-fb8ea8194551)](https://demo7.dspace.org/items/68e9ec51-38cf-4549-937d-fb8ea8194551) in regular search result **Expected behavior** Private or withdrawn items should not appear in regular search regardless of which user sees results. They should only appear in admin search (where there are sidebar filters/facets for them) **Proposed solution** Easiest solution: add `-withdrawn:true AND -discoverable:false` filter in default `DiscoveryConfiguration` in `defaultFilterQueries` property [[here](https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L202-L207)](https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L202-L207) Since there is a separate ""unDiscoverableItems"" config which contains the opposite [[here](https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L480)](https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L480) I think it is assumed that this functionality is default. **Related** If fix/migrate from https://github.com/DSpace/DSpace/pull/8438 is not applied, then withdrawn items are visible for all users. config-file config-file config-file",bug,0.9
3440,DSpace,https://github.com/DSpace/DSpace/issues/3440,[DS-62] Not right encoding for license and extracted texts - ID: 2234532,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-62"">[DS-62]</a> created by bollini</i> <p>This cyrillic text displaed in ISO-8859-5 but need in UTF-8 (looked on<br/> server - this texts in right UTF-8).<br/> This in Firefox 3.0.1<br/> Tested also with browsers IE 6, Amaya - also wrong.</p> <p>Maybe problem with right encoding in header</p> <p>Followups:<br/> &#8212;<br/> Date: 2009-03-04 12:18<br/> Sender: bollini<br/> Hi,<br/> DSpace doesn't set explicity an header for the license so the<br/> configuration of your Apache enviroments drives the browser behaviour.<br/> Anyway, because the license files are written by DSpace, and DSpace doc<br/> requires Tomcat to run with the jdk option file.encoding=UTF-8 I think that<br/> should be appropriate to force the utf8 encoding in license content-type.<br/> So you can fix this issue editing the content-type in bitstream format<br/> registry appending ""; charset=utf-8"" to the MIME Type of the second row<br/> (License)</p>",config-file | other-file,"[DS-62] Not right encoding for license and extracted texts - ID: 2234532 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-62"">[DS-62]</a> created by bollini</i> <p>This cyrillic text displaed in ISO-8859-5 but need in UTF-8 (looked on<br/> server - this texts in right UTF-8).<br/> This in Firefox 3.0.1<br/> Tested also with browsers IE 6, Amaya - also wrong.</p> <p>Maybe problem with right encoding in header</p> <p>Followups:<br/> &#8212;<br/> Date: 2009-03-04 12:18<br/> Sender: bollini<br/> Hi,<br/> DSpace doesn't set explicity an header for the license so the<br/> configuration of your Apache enviroments drives the browser behaviour.<br/> Anyway, because the license files are written by DSpace, and DSpace doc<br/> requires Tomcat to run with the jdk option file.encoding=UTF-8 I think that<br/> should be appropriate to force the utf8 encoding in license content-type.<br/> So you can fix this issue editing the content-type in bitstream format<br/> registry appending ""; charset=utf-8"" to the MIME Type of the second row<br/> (License)</p> config-file other-file",bug,0.85
3891,DSpace,https://github.com/DSpace/DSpace/issues/3891,[DS-517] Versions missing in dspace/pom.xml,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-517"">[DS-517]</a> created by caryn.n</i> <p>Here is the main error message from Eclipse:</p> <p><span class=""error"">&#91;WARNING&#93;</span> Some problems were encountered while building the effective model for org.dspace:modules:pom:1.5.2<br/> <span class=""error"">&#91;WARNING&#93;</span> 'reporting.plugins.plugin.version' is missing for org.apache.maven.plugins:maven-javadoc-plugin @ org.dspace:dspace-parent:1.5.2, U:\Docs\Projects - Eclipse\DSpaceX\dspace-1.5.2\pom.xml<br/> <span class=""error"">&#91;WARNING&#93;</span> 'reporting.plugins.plugin.version' is missing for org.apache.maven.plugins:maven-jxr-plugin @ org.dspace:dspace-parent:1.5.2, U:\Docs\Projects - Eclipse\DSpaceX\dspace-1.5.2\pom.xml<br/> <span class=""error"">&#91;WARNING&#93;</span> 'reporting.plugins.plugin.version' is missing for org.apache.maven.plugins:maven-site-plugin @ org.dspace:dspace-parent:1.5.2, U:\Docs\Projects - Eclipse\DSpaceX\dspace-1.5.2\pom.xml</p> <p>This also causes some issues downstream, but the attached patch resolves the main versioning issue. </p> <p>Note: Used versions listed at <a href=""http://maven.apache.org/plugins/"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://maven.apache.org/plugins/</a></p>",source-file,"[DS-517] Versions missing in dspace/pom.xml <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-517"">[DS-517]</a> created by caryn.n</i> <p>Here is the main error message from Eclipse:</p> <p><span class=""error"">&#91;WARNING&#93;</span> Some problems were encountered while building the effective model for org.dspace:modules:pom:1.5.2<br/> <span class=""error"">&#91;WARNING&#93;</span> 'reporting.plugins.plugin.version' is missing for org.apache.maven.plugins:maven-javadoc-plugin @ org.dspace:dspace-parent:1.5.2, U:\Docs\Projects - Eclipse\DSpaceX\dspace-1.5.2\pom.xml<br/> <span class=""error"">&#91;WARNING&#93;</span> 'reporting.plugins.plugin.version' is missing for org.apache.maven.plugins:maven-jxr-plugin @ org.dspace:dspace-parent:1.5.2, U:\Docs\Projects - Eclipse\DSpaceX\dspace-1.5.2\pom.xml<br/> <span class=""error"">&#91;WARNING&#93;</span> 'reporting.plugins.plugin.version' is missing for org.apache.maven.plugins:maven-site-plugin @ org.dspace:dspace-parent:1.5.2, U:\Docs\Projects - Eclipse\DSpaceX\dspace-1.5.2\pom.xml</p> <p>This also causes some issues downstream, but the attached patch resolves the main versioning issue. </p> <p>Note: Used versions listed at <a href=""http://maven.apache.org/plugins/"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://maven.apache.org/plugins/</a></p> source-file",no-bug,0.95
3110,DSpace,https://github.com/DSpace/DSpace/issues/3110,Poor URL matching causes improper failure with confusing message,"**400 Bad Request** while rendering the initial page server-side. The underlying error made no sense: `java.lang.IllegalArgumentException: the supplied uri is not valid: http://ds7.wood.net/server/api/core/sites/2510e895-db7e-46b2-9a9e-b4fd92026156`. The string *is* a valid HTTP URI, and fetching it with `curl` succeeds. I traced the problem to the way that URIs are validated in `org.dspace.app.rest.utils.Utils.getBaseObjectRestFromUri`. The problem was revealed because I had configured `dspace.server.url` with an explicit port 80, which is useless (for protocol `http`) but not incorrect. This failure is incorrect, surprising, and time-consuming to understand. The ultimate cause of the failure is that `getBaseObjectRestFromUri` compares URLs as strings rather than as serializations of complex structured objects (which is what URLs are). I suggest that, to discover whether URL A is a prefix of URL B, one must compare protocol, host, port, and path separately. **To Reproduce** Steps to reproduce the behavior: 1. Configure `dspace.server.url` explicitly with the default port for its protocol. 2. Start up front end and back end, and browse to the front end. **Expected behavior** For example: the URL `http://example.com:80/foo` should be recognized as a prefix of `http://example.com/foo/bar`.",source-file | source-file | test-file | source-file | source-file | other-file | source-file | source-file | test-file | source-file,"Poor URL matching causes improper failure with confusing message **400 Bad Request** while rendering the initial page server-side. The underlying error made no sense: `java.lang.IllegalArgumentException: the supplied uri is not valid: http://ds7.wood.net/server/api/core/sites/2510e895-db7e-46b2-9a9e-b4fd92026156`. The string *is* a valid HTTP URI, and fetching it with `curl` succeeds. I traced the problem to the way that URIs are validated in `org.dspace.app.rest.utils.Utils.getBaseObjectRestFromUri`. The problem was revealed because I had configured `dspace.server.url` with an explicit port 80, which is useless (for protocol `http`) but not incorrect. This failure is incorrect, surprising, and time-consuming to understand. The ultimate cause of the failure is that `getBaseObjectRestFromUri` compares URLs as strings rather than as serializations of complex structured objects (which is what URLs are). I suggest that, to discover whether URL A is a prefix of URL B, one must compare protocol, host, port, and path separately. **To Reproduce** Steps to reproduce the behavior: 1. Configure `dspace.server.url` explicitly with the default port for its protocol. 2. Start up front end and back end, and browse to the front end. **Expected behavior** For example: the URL `http://example.com:80/foo` should be recognized as a prefix of `http://example.com/foo/bar`. source-file source-file test-file source-file source-file other-file source-file source-file test-file source-file",bug,0.95
7992,DSpace,https://github.com/DSpace/DSpace/issues/7992,Scripts and processes bug,"The REST code for the scripts and processes does not take into account the ""hasArg"" value of the configured script options. Instead, the REST API only exposes the option type. I believe angular will then use this option type to force an argument or not depending on the type. When the type is a String, which is the default type, an argument will be forced. As a consequence, when no argument needs to be provided, the type needs to be changed to a boolean as is done [here](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/app/bulkedit/MetadataImportScriptConfiguration.java#L62). This is very unintuitive when adding configuration for new scripts. This bug was noticed in the [review of the harvest script](https://github.com/DSpace/dspace-angular/pull/1328#pullrequestreview-775425176). **Expected behavior** Ideally, the converter should set the type to boolean when no other type is provided and when there should be no argument provided for the parameter instead of having to set the type manually for every parameter. **Related work** This issue was noticed when reviewing the [Control collection harvest from the UI PR](https://github.com/DSpace/dspace-angular/pull/1328).",source-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file,"Scripts and processes bug The REST code for the scripts and processes does not take into account the ""hasArg"" value of the configured script options. Instead, the REST API only exposes the option type. I believe angular will then use this option type to force an argument or not depending on the type. When the type is a String, which is the default type, an argument will be forced. As a consequence, when no argument needs to be provided, the type needs to be changed to a boolean as is done [here](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/app/bulkedit/MetadataImportScriptConfiguration.java#L62). This is very unintuitive when adding configuration for new scripts. This bug was noticed in the [review of the harvest script](https://github.com/DSpace/dspace-angular/pull/1328#pullrequestreview-775425176). **Expected behavior** Ideally, the converter should set the type to boolean when no other type is provided and when there should be no argument provided for the parameter instead of having to set the type manually for every parameter. **Related work** This issue was noticed when reviewing the [Control collection harvest from the UI PR](https://github.com/DSpace/dspace-angular/pull/1328). source-file test-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file test-file test-file test-file test-file test-file test-file",bug,0.85
3548,DSpace,https://github.com/DSpace/DSpace/issues/3548,[DS-173] Lanugauge_multilingual issues,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-173"">[DS-173]</a> created by kipkorir2008</i> <p>Community/collection descriptions in more than one language, metadata input in more than one language</p>",source-file | test-file,"[DS-173] Lanugauge_multilingual issues <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-173"">[DS-173]</a> created by kipkorir2008</i> <p>Community/collection descriptions in more than one language, metadata input in more than one language</p> source-file test-file",no-bug,0.7
3227,DSpace,https://github.com/DSpace/DSpace/issues/3227,Sort options are not reported in the proper order,"**Describe the bug** The `discovery.xml` file allows to configure which sortOptions are available for each configuration and set also a default sorting see https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L160 https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L157-L159 The structure is not efficient as having the default sort set in a separate property can lead to different scenarios that need to be managed - the default sort option is included in the list of available options - the default sort option is an additional one Moreover, in the current implementation the default sort is always appended as last options in the REST response, see https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/main/java/org/dspace/app/rest/converter/DiscoverConfigurationConverter.java#L39 and there is no explicit mention of the default sort in the REST response, instead the example of the default configuration seems to indicate that the order of sort options matter (using the blame link as I haven't found a different way to link directly the line) https://github.com/DSpace/RestContract/blame/main/search-endpoint.md#L151 **To Reproduce** Steps to reproduce the behavior: 1. https://api7.dspace.org/server/#https://api7.dspace.org/server/api/discover/search 2. look to the sortOptions  ""sortOptions"": [ { ""name"": ""dc.title"" }, { ""name"": ""dc.date.issued"" }, { ""name"": ""dc.date.accessioned"" }, { ""name"": ""score"" }  **Expected behavior** We propose to simplify the discovery.xml configuration revisiting the sortOption bean definition to include a defaultDirection property that can be used to set the default direction of the sort option (i.e. DESC for score and date, ASC for title). We suggest to don't include any restriction about the directions that can be manually applied to the sort, i.e. it will be possible for the user to ask for result in score ASC, this is currently supported by solr and the REST API so we should introduce this constraint only if we get an explicit motivated request from our users as it would lead obviously to extra complexity (in configuration and validation) `discovery.xml`  <bean id=""defaultConfiguration"" class=""org.dspace.discovery.configuration.DiscoveryConfiguration"" scope=""prototype"">  <property name=""searchSortConfiguration""> <bean class=""org.dspace.discovery.configuration.DiscoverySortConfiguration""> <property name=""sortFields""> <list> <ref bean=""sortScore"" /> <ref bean=""sortTitle"" /> <ref bean=""sortDateIssued"" /> <ref bean=""sortDateAccessioned""/> </list> </property> </bean> </property>  </bean>  <bean id=""sortScore"" class=""org.dspace.discovery.configuration.DiscoverySortFieldConfiguration""> <!-- no metadataField specified to represent the score or a different implementation of the sortFieldConfiguration. TBD during implementation --> <property name=""defaultSortOrder"" value=""desc""/> </bean> <bean id=""sortTitle"" class=""org.dspace.discovery.configuration.DiscoverySortFieldConfiguration""> <property name=""metadataField"" value=""dc.title""/> <property name=""defaultSortOrder"" value=""desc""/> </bean>  **Related work** This is related to https://github.com/DSpace/dspace-angular/issues/1071 and the corresponding PR https://github.com/DSpace/dspace-angular/pull/1086",source-file | test-file | test-file,"Sort options are not reported in the proper order **Describe the bug** The `discovery.xml` file allows to configure which sortOptions are available for each configuration and set also a default sorting see https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L160 https://github.com/DSpace/DSpace/blob/main/dspace/config/spring/api/discovery.xml#L157-L159 The structure is not efficient as having the default sort set in a separate property can lead to different scenarios that need to be managed - the default sort option is included in the list of available options - the default sort option is an additional one Moreover, in the current implementation the default sort is always appended as last options in the REST response, see https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/main/java/org/dspace/app/rest/converter/DiscoverConfigurationConverter.java#L39 and there is no explicit mention of the default sort in the REST response, instead the example of the default configuration seems to indicate that the order of sort options matter (using the blame link as I haven't found a different way to link directly the line) https://github.com/DSpace/RestContract/blame/main/search-endpoint.md#L151 **To Reproduce** Steps to reproduce the behavior: 1. https://api7.dspace.org/server/#https://api7.dspace.org/server/api/discover/search 2. look to the sortOptions  ""sortOptions"": [ { ""name"": ""dc.title"" }, { ""name"": ""dc.date.issued"" }, { ""name"": ""dc.date.accessioned"" }, { ""name"": ""score"" }  **Expected behavior** We propose to simplify the discovery.xml configuration revisiting the sortOption bean definition to include a defaultDirection property that can be used to set the default direction of the sort option (i.e. DESC for score and date, ASC for title). We suggest to don't include any restriction about the directions that can be manually applied to the sort, i.e. it will be possible for the user to ask for result in score ASC, this is currently supported by solr and the REST API so we should introduce this constraint only if we get an explicit motivated request from our users as it would lead obviously to extra complexity (in configuration and validation) `discovery.xml`  <bean id=""defaultConfiguration"" class=""org.dspace.discovery.configuration.DiscoveryConfiguration"" scope=""prototype"">  <property name=""searchSortConfiguration""> <bean class=""org.dspace.discovery.configuration.DiscoverySortConfiguration""> <property name=""sortFields""> <list> <ref bean=""sortScore"" /> <ref bean=""sortTitle"" /> <ref bean=""sortDateIssued"" /> <ref bean=""sortDateAccessioned""/> </list> </property> </bean> </property>  </bean>  <bean id=""sortScore"" class=""org.dspace.discovery.configuration.DiscoverySortFieldConfiguration""> <!-- no metadataField specified to represent the score or a different implementation of the sortFieldConfiguration. TBD during implementation --> <property name=""defaultSortOrder"" value=""desc""/> </bean> <bean id=""sortTitle"" class=""org.dspace.discovery.configuration.DiscoverySortFieldConfiguration""> <property name=""metadataField"" value=""dc.title""/> <property name=""defaultSortOrder"" value=""desc""/> </bean>  **Related work** This is related to https://github.com/DSpace/dspace-angular/issues/1071 and the corresponding PR https://github.com/DSpace/dspace-angular/pull/1086 source-file test-file test-file",no-bug,0.9
10405,DSpace,https://github.com/DSpace/DSpace/issues/10405,log4j2-cli.xml throws error when DefaultRolloverStrategy is uncommented in DSpace 8.1,"## Describe the bug In DSpace 8.1, when you use the `DefaultRolloverStrategy` for the A1 Appender in `log4j2-cli.xml`, there are error messages as soon as you execute cli commands:  main ERROR RollingFileAppender 'A1': When no file name is provided a DirectFileRolloverStrategy must be configured main ERROR Null object returned for RollingFile in Appenders. main ERROR Unable to locate appender ""A1"" for logger config ""root"" main ERROR Unable to locate appender ""A1"" for logger config org.dspace""  ## To Reproduce Steps to reproduce the behavior: 1. In `log4j2-cli.xml` uncomment the `DefaultRolloverStrategy` for the A1 Appender 2. Build and deploy DSpace 3. Call a command like for example `dspace database info` 4. Observe the error messages listed above ## Expected behavior No error messages ## Related work It is enough to add `fileName='${log.dir}/dspace-cli.log`. Ill open a pull request",config-file | config-file | config-file | config-file | config-file | config-file,"log4j2-cli.xml throws error when DefaultRolloverStrategy is uncommented in DSpace 8.1 ## Describe the bug In DSpace 8.1, when you use the `DefaultRolloverStrategy` for the A1 Appender in `log4j2-cli.xml`, there are error messages as soon as you execute cli commands:  main ERROR RollingFileAppender 'A1': When no file name is provided a DirectFileRolloverStrategy must be configured main ERROR Null object returned for RollingFile in Appenders. main ERROR Unable to locate appender ""A1"" for logger config ""root"" main ERROR Unable to locate appender ""A1"" for logger config org.dspace""  ## To Reproduce Steps to reproduce the behavior: 1. In `log4j2-cli.xml` uncomment the `DefaultRolloverStrategy` for the A1 Appender 2. Build and deploy DSpace 3. Call a command like for example `dspace database info` 4. Observe the error messages listed above ## Expected behavior No error messages ## Related work It is enough to add `fileName='${log.dir}/dspace-cli.log`. Ill open a pull request config-file config-file config-file config-file config-file config-file",no-bug,0.95
3737,DSpace,https://github.com/DSpace/DSpace/issues/3737,[DS-363] JSPUI tags/views for @mire Solr statistics module,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-363"">[DS-363]</a> created by kshepherd</i> <p>Task to create JSPUI tags/views for @mire Solr statistics module<br/> Port existing XMLUI demonstration/prototype statistics views to JSPUI, using jsptags (happy to be overruled on the use of jsptags if someone has a better way)</p>",source-file | test-file,"[DS-363] JSPUI tags/views for @mire Solr statistics module <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-363"">[DS-363]</a> created by kshepherd</i> <p>Task to create JSPUI tags/views for @mire Solr statistics module<br/> Port existing XMLUI demonstration/prototype statistics views to JSPUI, using jsptags (happy to be overruled on the use of jsptags if someone has a better way)</p> source-file test-file",no-bug,0.9
9669,DSpace,https://github.com/DSpace/DSpace/issues/9669,OpenAIRE v4: DSpace exposes more and other date types than the ones supported in the OpenAIRE date type vocabulary,"**Describe the bug** https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/vocab_datetype.html#vocab-datetype-datetype indicates that the supported values are: Accepted, Available, Issued https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/field_embargoenddate.html states that Accepted should be used to indicate embargo period start date, and Available should indicate embargo end date The crosswalk here https://github.com/DSpace/DSpace/blob/main/dspace/config/crosswalks/oai/metadataFormats/oai_openaire.xsl#L1082 exposes following date types, that are not in the OpenAIRE vocabulary: * Collected * Copyrighted * Created * Submitted * Updated * Valid **Resolution path** Either these dates are supported and OpenAIRE needs an update to their documentation. Or they are not supported and we should stop crosswalking these. In both cases, it would be really good to have good definitions of what these dates exactly mean.",other-file,"OpenAIRE v4: DSpace exposes more and other date types than the ones supported in the OpenAIRE date type vocabulary **Describe the bug** https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/vocab_datetype.html#vocab-datetype-datetype indicates that the supported values are: Accepted, Available, Issued https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/field_embargoenddate.html states that Accepted should be used to indicate embargo period start date, and Available should indicate embargo end date The crosswalk here https://github.com/DSpace/DSpace/blob/main/dspace/config/crosswalks/oai/metadataFormats/oai_openaire.xsl#L1082 exposes following date types, that are not in the OpenAIRE vocabulary: * Collected * Copyrighted * Created * Submitted * Updated * Valid **Resolution path** Either these dates are supported and OpenAIRE needs an update to their documentation. Or they are not supported and we should stop crosswalking these. In both cases, it would be really good to have good definitions of what these dates exactly mean. other-file",no-bug,0.85
8342,DSpace,https://github.com/DSpace/DSpace/issues/8342,Allow setting bundle when creating a bitstream in item with REST (DSpace 6.x),"**Is your feature request related to a problem? Please describe.** Currently, adding bitstream to item with REST API sets it to ORIGINAL bundle. However, in customized installations different bundles may be used with different access settings or shown in different way. **Describe the solution you'd like** Proposed solution for DSpace 6: extend the endpoint `POST /items/{item id}/bitstreams (Add a bitstream to the specified item)` with a new optional bundleName parameter that allows setting a custom bundle. ORIGINAL is used as default so the change is backwards-compatible. **Describe alternatives or workarounds you've considered** A workaround is to create the bitstream in original bundle first and then change it - either using the UI or with another REST extension #8339 (DS-2983) that allows setting bundle of an existing bitstream. However, if a custom bundle is expected it is more straightforward to place the item there in the first place. **Additional context** Custom bundles have been used as part of JYU repository https://jyx.jyu.fi/ in at least two use cases: - CONTRACT bundle to store thesis-related contracts (submitted by a non-DSpace form application with REST). These are not shown publicly. - DATASET bundle to show individual files related to a dataset in a compressed list separate from files in ORIGINAL bundle (=that in the case of datasets contains zip package containing all the files), visually somewhat similar to solution used in Edinburgh Datashare https://datashare.ed.ac.uk/ . As with theses, dataset files and metadata are submitted from a non-DSpace application using REST. One should also note that this proposal deliberately negates an older issue DS-2348 REST Bitstreams should be only in original bundle. #777",source-file | source-file | source-file,"Allow setting bundle when creating a bitstream in item with REST (DSpace 6.x) **Is your feature request related to a problem? Please describe.** Currently, adding bitstream to item with REST API sets it to ORIGINAL bundle. However, in customized installations different bundles may be used with different access settings or shown in different way. **Describe the solution you'd like** Proposed solution for DSpace 6: extend the endpoint `POST /items/{item id}/bitstreams (Add a bitstream to the specified item)` with a new optional bundleName parameter that allows setting a custom bundle. ORIGINAL is used as default so the change is backwards-compatible. **Describe alternatives or workarounds you've considered** A workaround is to create the bitstream in original bundle first and then change it - either using the UI or with another REST extension #8339 (DS-2983) that allows setting bundle of an existing bitstream. However, if a custom bundle is expected it is more straightforward to place the item there in the first place. **Additional context** Custom bundles have been used as part of JYU repository https://jyx.jyu.fi/ in at least two use cases: - CONTRACT bundle to store thesis-related contracts (submitted by a non-DSpace form application with REST). These are not shown publicly. - DATASET bundle to show individual files related to a dataset in a compressed list separate from files in ORIGINAL bundle (=that in the case of datasets contains zip package containing all the files), visually somewhat similar to solution used in Edinburgh Datashare https://datashare.ed.ac.uk/ . As with theses, dataset files and metadata are submitted from a non-DSpace application using REST. One should also note that this proposal deliberately negates an older issue DS-2348 REST Bitstreams should be only in original bundle. #777 source-file source-file source-file",no-bug,0.9
8129,DSpace,https://github.com/DSpace/DSpace/issues/8129,Prefix Solr core names to facilitate multiple DSpace instances on a single Solr instance,"When running multiple DSpace instances, it is often convenient to gather all of their Solr cores under a single Solr instance. This requires distinct names for Solr cores across DSpace instances. The core names are configured in various places scattered through DSpace's configuration files, making management of the core names more error-prone. To reduce the chance of error, and keep things neatly organized, I propose defining a new configuration property `solr.core.prefix` which, when set, adds a single prefix to all configured core names. The prefixing takes place entirely within the assembly of the runtime configuration -- no Java code changes are required. The relevant properties extracted from a sample instance:  mwood@barn ~/dspaces/ds7/config $ grep solr.core.prefix . -r ./modules/solr-statistics.cfg:solr-statistics.server = ${solr.server}/${solr.core.prefix}statistics ./modules/oai.cfg:oai.solr.url=${solr.server}/${solr.core.prefix}oai ./modules/discovery.cfg:discovery.search.server = ${solr.server}/${solr.core.prefix}search ./local.cfg:solr.core.prefix = dspace7- ./local.cfg:solr.authority.server = ${solr.server}/${solr.core.prefix}authority mwood@barn ~/dspaces/ds7/config $  Thus, this DSpace instance's Solr cores will be named `dspace7-search`, `dspace7-authority`, `dspace7-oai`, and `dspace7-statistics`. By default the prefix property will be unset, causing the un-prefixed names to be used, as is the case now.",other-file | other-file | other-file | other-file | other-file | other-file,"Prefix Solr core names to facilitate multiple DSpace instances on a single Solr instance When running multiple DSpace instances, it is often convenient to gather all of their Solr cores under a single Solr instance. This requires distinct names for Solr cores across DSpace instances. The core names are configured in various places scattered through DSpace's configuration files, making management of the core names more error-prone. To reduce the chance of error, and keep things neatly organized, I propose defining a new configuration property `solr.core.prefix` which, when set, adds a single prefix to all configured core names. The prefixing takes place entirely within the assembly of the runtime configuration -- no Java code changes are required. The relevant properties extracted from a sample instance:  mwood@barn ~/dspaces/ds7/config $ grep solr.core.prefix . -r ./modules/solr-statistics.cfg:solr-statistics.server = ${solr.server}/${solr.core.prefix}statistics ./modules/oai.cfg:oai.solr.url=${solr.server}/${solr.core.prefix}oai ./modules/discovery.cfg:discovery.search.server = ${solr.server}/${solr.core.prefix}search ./local.cfg:solr.core.prefix = dspace7- ./local.cfg:solr.authority.server = ${solr.server}/${solr.core.prefix}authority mwood@barn ~/dspaces/ds7/config $  Thus, this DSpace instance's Solr cores will be named `dspace7-search`, `dspace7-authority`, `dspace7-oai`, and `dspace7-statistics`. By default the prefix property will be unset, causing the un-prefixed names to be used, as is the case now. other-file other-file other-file other-file other-file other-file",no-bug,0.9
3190,DSpace,https://github.com/DSpace/DSpace/issues/3190,New uses of Log4J v1 are appearing,"Since we converted from Log4J v1 to v2, some new code has been importing v1 packages again. This leaves us with confusing dependencies, and if it works, it does so in a roundabout and wasteful fashion. **To Reproduce** 1. Build DSpace 2. See v1 JARs in various `**target/**/lib/` directories. **Expected behavior** Only Log4J v2 artifacts should be included in the build.",config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file,"New uses of Log4J v1 are appearing Since we converted from Log4J v1 to v2, some new code has been importing v1 packages again. This leaves us with confusing dependencies, and if it works, it does so in a roundabout and wasteful fashion. **To Reproduce** 1. Build DSpace 2. See v1 JARs in various `**target/**/lib/` directories. **Expected behavior** Only Log4J v2 artifacts should be included in the build. config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file",no-bug,0.95
3461,DSpace,https://github.com/DSpace/DSpace/issues/3461,"[DS-84] Improve API for ""IgnoreAuthorization"" blocks - ID: 1687783","<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-84"">[DS-84]</a> created by bollini</i> <p>The bug fix 1480496 (Cannot turn off ""ignore authorization"" flag!)<br/> has shown that the authorization method setIgnoreAuthorization() is not<br/> friendly. In fact if we have two blocks that require authorization check<br/> to false and these blocks are nested, as in the following example:<br/> <span class=""error"">&#91;some java code here&#93;</span><br/> setIgnoreAuthorization(true) // start of first block<br/> my first block without authorization check<br/> my first block without authorization check<br/> my first block without authorization check<br/> setIgnoreAuthorization(true) // start of second block<br/> my second block without authorization check<br/> my second block without authorization check<br/> my second block without authorization check<br/> setIgnoreAuthorization(false) // end of second block<br/> other code in first block<br/> setIgnoreAuthorization(false) // end of first block<br/> <br/> the ""other code in first block"" is executed with authorization check and<br/> does not work. It will be really too easy to come up with this situation<br/> (actually possible for my patch automapper) with the new code called by<br/> the Event System, so it should be fixed.<br/> The simple solution, implemented in this patch, is to store the previous<br/> state of authorization check<br/> before changing it, and to restore it at the end of the ""special"" block.<br/> This patch:<br/> 1) add two methods: TurnOffAuthorizationSystem /<br/> RestoreAuthorizationSystem, with some code that can also be useful when the<br/> debug is on to see ""malformed"" (XML-like) authorization blocks (thanks to<br/> James Rutherford for some useful suggestions);<br/> 2) set the setIgnoreAuthoritation methods to deprecated.<br/> 3) refactor any call to setIgnoreAuthorization in dspace code to use the<br/> new methods</p>",other-file,"[DS-84] Improve API for ""IgnoreAuthorization"" blocks - ID: 1687783 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-84"">[DS-84]</a> created by bollini</i> <p>The bug fix 1480496 (Cannot turn off ""ignore authorization"" flag!)<br/> has shown that the authorization method setIgnoreAuthorization() is not<br/> friendly. In fact if we have two blocks that require authorization check<br/> to false and these blocks are nested, as in the following example:<br/> <span class=""error"">&#91;some java code here&#93;</span><br/> setIgnoreAuthorization(true) // start of first block<br/> my first block without authorization check<br/> my first block without authorization check<br/> my first block without authorization check<br/> setIgnoreAuthorization(true) // start of second block<br/> my second block without authorization check<br/> my second block without authorization check<br/> my second block without authorization check<br/> setIgnoreAuthorization(false) // end of second block<br/> other code in first block<br/> setIgnoreAuthorization(false) // end of first block<br/> <br/> the ""other code in first block"" is executed with authorization check and<br/> does not work. It will be really too easy to come up with this situation<br/> (actually possible for my patch automapper) with the new code called by<br/> the Event System, so it should be fixed.<br/> The simple solution, implemented in this patch, is to store the previous<br/> state of authorization check<br/> before changing it, and to restore it at the end of the ""special"" block.<br/> This patch:<br/> 1) add two methods: TurnOffAuthorizationSystem /<br/> RestoreAuthorizationSystem, with some code that can also be useful when the<br/> debug is on to see ""malformed"" (XML-like) authorization blocks (thanks to<br/> James Rutherford for some useful suggestions);<br/> 2) set the setIgnoreAuthoritation methods to deprecated.<br/> 3) refactor any call to setIgnoreAuthorization in dspace code to use the<br/> new methods</p> other-file",no-bug,0.9
8514,DSpace,https://github.com/DSpace/DSpace/issues/8514,ImageMagick PDF thumbnails are blurry,"**Describe the bug** A side effect of many image resizing processes is that the resulting image is less sharp than the original. This is visible in PDF thumbnails generated by ImageMagick. DSpace has been able to use ImageMagick since 5.x, so this currently affects DSpace 5.x, 6.x, and 7.x. **To Reproduce** Steps to reproduce the behavior: 1. Have an item with a PDF bitstream in the `ORIGINAL` bundle 2. Enable ImageMagick [media filter](https://wiki.lyrasis.org/display/DSDOC6x/Mediafilters+for+Transforming+DSpace+Content) for PDFs 3. Generate a thumbnail using `dspace filter-media ` 4. Resulting thumbnail is slightly blurry, dull, and less crisp than the the original item **Expected behavior** Thumbnail should look nicer. **Related work** This likely applies to the _normal_ image thumbnailer as well if ImageMagick is configured there too. I don't use it so I haven't noticed.",source-file | source-file | other-file | source-file | other-file | source-file | other-file,"ImageMagick PDF thumbnails are blurry **Describe the bug** A side effect of many image resizing processes is that the resulting image is less sharp than the original. This is visible in PDF thumbnails generated by ImageMagick. DSpace has been able to use ImageMagick since 5.x, so this currently affects DSpace 5.x, 6.x, and 7.x. **To Reproduce** Steps to reproduce the behavior: 1. Have an item with a PDF bitstream in the `ORIGINAL` bundle 2. Enable ImageMagick [media filter](https://wiki.lyrasis.org/display/DSDOC6x/Mediafilters+for+Transforming+DSpace+Content) for PDFs 3. Generate a thumbnail using `dspace filter-media ` 4. Resulting thumbnail is slightly blurry, dull, and less crisp than the the original item **Expected behavior** Thumbnail should look nicer. **Related work** This likely applies to the _normal_ image thumbnailer as well if ImageMagick is configured there too. I don't use it so I haven't noticed. source-file source-file other-file source-file other-file source-file other-file",no-bug,0.95
3330,DSpace,https://github.com/DSpace/DSpace/issues/3330,Packager does not retain UUIDs on restore,"**Describe the bug** As has historically been the case with handles, the `-r` packager option should also re-use the UUID of the original item. Item UUIDs are intended to be immutable references to items that exist in DSpace. For example, people's bookmarks and spiders will have those old UUIDs in their URLs. Therefore, when an item is being restored into DSpace (e.g. due to disaster recovery), it is important to have the ability to retain the original UUID and thus URL references. **To Reproduce** Steps to reproduce the behavior: 1. Do a packager export 2. Run a packager import 3. Notice how the UUID is different **Expected behavior** The UUID should be retained. **Related work** Addressed by this PR: https://github.com/DSpace/DSpace/pull/3329",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file,"Packager does not retain UUIDs on restore **Describe the bug** As has historically been the case with handles, the `-r` packager option should also re-use the UUID of the original item. Item UUIDs are intended to be immutable references to items that exist in DSpace. For example, people's bookmarks and spiders will have those old UUIDs in their URLs. Therefore, when an item is being restored into DSpace (e.g. due to disaster recovery), it is important to have the ability to retain the original UUID and thus URL references. **To Reproduce** Steps to reproduce the behavior: 1. Do a packager export 2. Run a packager import 3. Notice how the UUID is different **Expected behavior** The UUID should be retained. **Related work** Addressed by this PR: https://github.com/DSpace/DSpace/pull/3329 source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file",no-bug,0.9
3023,DSpace,https://github.com/DSpace/DSpace/issues/3023,A user with submission rights over a collection cannot import from an external source,**Describe the bug** A non-admin user with submission rights over a collection cannot import from an external source due to a permission error. **To Reproduce** Steps to reproduce the behavior: 1. Login with user dspacedemo+submit@gmail.com 2. Go to MySpace -> Import metadata from an external source 3. Search from an external source (Ex. Pubmed) 4. Select an item and start a submission 5. Choose a collection on which the user has submission permission (ex. Publications 2) ![IssueScreenshot](https://user-images.githubusercontent.com/63857/96841604-44d7de80-144c-11eb-9991-1c64c3f0199b.PNG) **Expected behavior** The workspaceitem should be created with a non-admin user with permission rights over the collection.,config-file,A user with submission rights over a collection cannot import from an external source **Describe the bug** A non-admin user with submission rights over a collection cannot import from an external source due to a permission error. **To Reproduce** Steps to reproduce the behavior: 1. Login with user dspacedemo+submit@gmail.com 2. Go to MySpace -> Import metadata from an external source 3. Search from an external source (Ex. Pubmed) 4. Select an item and start a submission 5. Choose a collection on which the user has submission permission (ex. Publications 2) ![IssueScreenshot](https://user-images.githubusercontent.com/63857/96841604-44d7de80-144c-11eb-9991-1c64c3f0199b.PNG) **Expected behavior** The workspaceitem should be created with a non-admin user with permission rights over the collection. config-file,no-bug,0.8
3744,DSpace,https://github.com/DSpace/DSpace/issues/3744,[DS-370] E Mail Sent On Item Export Error Message,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-370"">[DS-370]</a> created by mhardik</i> <p>Recently I was exporting Communities.I got message ""The task is complete, and notification has been sent to the appropriate people."" Return to MyDspace""</p> <p>But On ""MyDspace"" , I did not found anything. So, I checked log files which was stating error and saying ""An error occurred during item export, the user will be notified.""</p> <p>I got email stating Item Exported is ready and then showing Error:</p> <p>While examining ItemExport.java , i came to know that it is choosing wrong file.</p> <p>I have attached function from ItemExport.java </p> <p>I think In code --> Email email = ConfigurationManager.getEmail(I18nUtil.getEmailFilename(supportedLocale, ""export_success""));<br/> It should be export_error</p>",source-file | source-file,"[DS-370] E Mail Sent On Item Export Error Message <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-370"">[DS-370]</a> created by mhardik</i> <p>Recently I was exporting Communities.I got message ""The task is complete, and notification has been sent to the appropriate people."" Return to MyDspace""</p> <p>But On ""MyDspace"" , I did not found anything. So, I checked log files which was stating error and saying ""An error occurred during item export, the user will be notified.""</p> <p>I got email stating Item Exported is ready and then showing Error:</p> <p>While examining ItemExport.java , i came to know that it is choosing wrong file.</p> <p>I have attached function from ItemExport.java </p> <p>I think In code --> Email email = ConfigurationManager.getEmail(I18nUtil.getEmailFilename(supportedLocale, ""export_success""));<br/> It should be export_error</p> source-file source-file",no-bug,0.8
3418,DSpace,https://github.com/DSpace/DSpace/issues/3418,[DS-40] SubmissionController is not thread safe,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-40"">[DS-40]</a> created by bollini</i> <p>The SubmissionController servlet uses a local field to maintain request related value (currentStepConfig). Concurrent access to the servlet can change the value of the field interfering with request processing</p>",source-file | database-file | test-file | test-file,"[DS-40] SubmissionController is not thread safe <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-40"">[DS-40]</a> created by bollini</i> <p>The SubmissionController servlet uses a local field to maintain request related value (currentStepConfig). Concurrent access to the servlet can change the value of the field interfering with request processing</p> source-file database-file test-file test-file",no-bug,0.9
3888,DSpace,https://github.com/DSpace/DSpace/issues/3888,[DS-514] Need to remove all release repository and pluginRepository entries from Maven poms.,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-514"">[DS-514]</a> created by mdiggory</i> <p>1.) We will be wanting to work to remove all 3rd party repository references to SAKAI and JAVA.NET before our next release. This may mean centralizing and re-releasing third party artifacts present in those repositories under our own repository space. Or lobbying/working with SAKAI community to get their repository properly mirrored into central via the sonatype forge.</p> <p>2.) Migrate DSpace maven repositories to Sonatype to meet new requirements for syncing to central.</p> <p>See also:<br/> <a href=""http://fedora-commons.org/confluence/display/~cwilper/Merging+DuraSpace+Maven+Repositories"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://fedora-commons.org/confluence/display/~cwilper/Merging+DuraSpace+Maven+Repositories</a></p>",other-file,"[DS-514] Need to remove all release repository and pluginRepository entries from Maven poms. <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-514"">[DS-514]</a> created by mdiggory</i> <p>1.) We will be wanting to work to remove all 3rd party repository references to SAKAI and JAVA.NET before our next release. This may mean centralizing and re-releasing third party artifacts present in those repositories under our own repository space. Or lobbying/working with SAKAI community to get their repository properly mirrored into central via the sonatype forge.</p> <p>2.) Migrate DSpace maven repositories to Sonatype to meet new requirements for syncing to central.</p> <p>See also:<br/> <a href=""http://fedora-commons.org/confluence/display/~cwilper/Merging+DuraSpace+Maven+Repositories"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://fedora-commons.org/confluence/display/~cwilper/Merging+DuraSpace+Maven+Repositories</a></p> other-file",no-bug,0.95
2967,DSpace,https://github.com/DSpace/DSpace/issues/2967,DSpaceBeanPostProcessor duplicates Spring features,"`DSpaceBeanPostProcessor` is responsible for calling methods on implementations of `InitializedService` and `ShutdownService`, which are intended to initialize an instance after dependency injection and to clean up resources no longer used when we are done with the instance. These actions duplicate the standard `@PostContstruct` and `@PreDestroy` methods defined in `javax.annotation`. Spring understands the standard annotations. The duplication is confusing and wasteful. We should remove the post processor and the duplicative interfaces.",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | test-file,"DSpaceBeanPostProcessor duplicates Spring features `DSpaceBeanPostProcessor` is responsible for calling methods on implementations of `InitializedService` and `ShutdownService`, which are intended to initialize an instance after dependency injection and to clean up resources no longer used when we are done with the instance. These actions duplicate the standard `@PostContstruct` and `@PreDestroy` methods defined in `javax.annotation`. Spring understands the standard annotations. The duplication is confusing and wasteful. We should remove the post processor and the duplicative interfaces. source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file test-file test-file test-file test-file",no-bug,0.9
8023,DSpace,https://github.com/DSpace/DSpace/issues/8023,DSpace 7.0: Bitstream download filename lose non-latin characters,"**Describe the bug** When download a bitstream having filename with character other than latin, those characters will be missing in file save dialog. For example, file named "" File.pdf"", will be saved as "" File.pdf"" This happen only on 7.0, 6.x and earlier handle this properly. **To Reproduce** Steps to reproduce the behavior: 1. Running DSpace 7.0 on Tomcat 9.0 2. Upload a file to and item with non-latin character in file name, e.g. "" File.pdf"" 2. Download the file from DSpace 7.0 UI 3. Browser will suggest save file name "" File.pdf"" instead of the correct "" File.pdf"" **More Information** This happen because HttpHeadersInitializer does not encode filename in Content-Disposition header. It just use the file name as is. Since HTTP header (or Tomcat?) does not support UTF8, all non-latin characters become ""?"" in the header. In contrast, DSpace 6.x encode filename in Content-Disposition header by using MimeUtility.encodeText(name, ""UTF8"", ""B""); **Discussion** Although encoding filename work fine in earlier version of DSpace, I am wondering if the proper solution should be using filename* which can indicate character encoding?",source-file | test-file,"DSpace 7.0: Bitstream download filename lose non-latin characters **Describe the bug** When download a bitstream having filename with character other than latin, those characters will be missing in file save dialog. For example, file named "" File.pdf"", will be saved as "" File.pdf"" This happen only on 7.0, 6.x and earlier handle this properly. **To Reproduce** Steps to reproduce the behavior: 1. Running DSpace 7.0 on Tomcat 9.0 2. Upload a file to and item with non-latin character in file name, e.g. "" File.pdf"" 2. Download the file from DSpace 7.0 UI 3. Browser will suggest save file name "" File.pdf"" instead of the correct "" File.pdf"" **More Information** This happen because HttpHeadersInitializer does not encode filename in Content-Disposition header. It just use the file name as is. Since HTTP header (or Tomcat?) does not support UTF8, all non-latin characters become ""?"" in the header. In contrast, DSpace 6.x encode filename in Content-Disposition header by using MimeUtility.encodeText(name, ""UTF8"", ""B""); **Discussion** Although encoding filename work fine in earlier version of DSpace, I am wondering if the proper solution should be using filename* which can indicate character encoding? source-file test-file",bug,0.9
10188,DSpace,https://github.com/DSpace/DSpace/issues/10188,usage of MockSolrSearchCore in IT,"## Describe the bug The `VersioningWithRelationshipsIT` uses the solrSearchCore and not the MockSolrSearchCore. https://github.com/DSpace/DSpace/blob/c39822a2e8f68af09b386d4d3d1b945add9efe84/dspace-api/src/test/java/org/dspace/content/VersioningWithRelationshipsIT.java#L82 https://github.com/DSpace/DSpace/blob/c39822a2e8f68af09b386d4d3d1b945add9efe84/dspace-api/src/test/java/org/dspace/content/VersioningWithRelationshipsIT.java#L83 ## To Reproduce Steps to reproduce the behavior: quite hard to reproduce: 1. add another test case which uses the solr core, e.g. in DiscoveryIT. 2. Other tests might fail as noticed in https://github.com/DSpace/DSpace/pull/9690#discussion_r1907942056 . There the `BulkAccessControlIT` was failing because in DiscoveryIT i falsly used the SolrSearchcore directly. 3. After the run of the test the SolrSearchCore did not reset or destroy the core for the next test. This is only performed by the MockSolrSearchCore. ## Expected behavior We would like all tests to use the `MockSolrSearchCore`. The `VersioningWithRelationshipsIT` and all upfollowing tests should still run and succeed if we switch to the `MockSolrSearchCore`. ## Related work",test-file | test-file | test-file,"usage of MockSolrSearchCore in IT ## Describe the bug The `VersioningWithRelationshipsIT` uses the solrSearchCore and not the MockSolrSearchCore. https://github.com/DSpace/DSpace/blob/c39822a2e8f68af09b386d4d3d1b945add9efe84/dspace-api/src/test/java/org/dspace/content/VersioningWithRelationshipsIT.java#L82 https://github.com/DSpace/DSpace/blob/c39822a2e8f68af09b386d4d3d1b945add9efe84/dspace-api/src/test/java/org/dspace/content/VersioningWithRelationshipsIT.java#L83 ## To Reproduce Steps to reproduce the behavior: quite hard to reproduce: 1. add another test case which uses the solr core, e.g. in DiscoveryIT. 2. Other tests might fail as noticed in https://github.com/DSpace/DSpace/pull/9690#discussion_r1907942056 . There the `BulkAccessControlIT` was failing because in DiscoveryIT i falsly used the SolrSearchcore directly. 3. After the run of the test the SolrSearchCore did not reset or destroy the core for the next test. This is only performed by the MockSolrSearchCore. ## Expected behavior We would like all tests to use the `MockSolrSearchCore`. The `VersioningWithRelationshipsIT` and all upfollowing tests should still run and succeed if we switch to the `MockSolrSearchCore`. ## Related work test-file test-file test-file",no-bug,0.9
8437,DSpace,https://github.com/DSpace/DSpace/issues/8437,Solr search core initialization is fragile,"**Describe the bug** If `discovery.search.server` is incorrect, `org.dspace.discovery.SolrSearchCore#initSolr` just logs an error but leaves the class uninitialized, causing obscure errors later. At time of writing, it causes the server Context to fail to start. This is because the SolrClient reference held by the class is still null. **To Reproduce** Steps to reproduce the behavior: 1. Set `discovery.search.server` to a valid URL that won't connect to Solr. 2. Try to start `webapps/server`. **Expected behavior** There's no good way to recover, but perhaps `initSolr` could throw a more informative exception instead of silently failing.",source-file,"Solr search core initialization is fragile **Describe the bug** If `discovery.search.server` is incorrect, `org.dspace.discovery.SolrSearchCore#initSolr` just logs an error but leaves the class uninitialized, causing obscure errors later. At time of writing, it causes the server Context to fail to start. This is because the SolrClient reference held by the class is still null. **To Reproduce** Steps to reproduce the behavior: 1. Set `discovery.search.server` to a valid URL that won't connect to Solr. 2. Try to start `webapps/server`. **Expected behavior** There's no good way to recover, but perhaps `initSolr` could throw a more informative exception instead of silently failing. source-file",no-bug,0.9
9606,DSpace,https://github.com/DSpace/DSpace/issues/9606,"Method ""isHierarchical"" of ""org.dspace.content.authority.DSpaceControlledVocabulary.java"" should not always return true","**Describe the bug** The method ""isHierarchical"" of "" org.dspace.content.authority.DSpaceControlledVocabulary.java"" always returns the value true. It should instead return the ""storeHierarchy"" value configured for the actual controlled vocabulary. **To Reproduce** view source code **Expected behavior** return ""storeHierarchy"" field instead of true. **Related work** Link to any related tickets or PRs here.",source-file,"Method ""isHierarchical"" of ""org.dspace.content.authority.DSpaceControlledVocabulary.java"" should not always return true **Describe the bug** The method ""isHierarchical"" of "" org.dspace.content.authority.DSpaceControlledVocabulary.java"" always returns the value true. It should instead return the ""storeHierarchy"" value configured for the actual controlled vocabulary. **To Reproduce** view source code **Expected behavior** return ""storeHierarchy"" field instead of true. **Related work** Link to any related tickets or PRs here. source-file",no-bug,0.95
8055,DSpace,https://github.com/DSpace/DSpace/issues/8055,DSpace 6: Item move operation can accidentally delete items,"**Describe the bug** When an item is moved from one collection to another, the back end does not validate the collections that the item is being moved from and to. Normally, this is not an issue because the admin UI will filter the appropriate collections for the user to choose from. However, there is an easily reproducible scenario where this results in the accidental deletion of the item and all of its bitstreams. **To Reproduce** Steps to reproduce the behavior: 1. Find an item, X, **belonging to a single collection**, Collection A, and move it through the Edit Item admin page to Collection B. 2. After the move completes successfully and you are taken back to the Edit Item page, refresh the page and agree to resubmit the form. (In practice, users may be working quickly and not notice what the form submission notice says; the consequences should not be as dire as an item being accidentally deleted.) 3. After the move request is processed the second time, the item becomes orphaned and all bitstreams for the item are deleted. This seems to happen because the item already belongs to Collection B after the first move, so the second time we attempt to move it from Collection A to Collection B, adding B to its collections has no effect. However, the logic in [CollectionServiceImpl](https://github.com/DSpace/DSpace/blob/97d0a1f12855b3451c77435591368c4c224b5138/dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java#L646) erroneously determines that the item has now been orphaned, since it is only part of one collection when removeItem is called. **Expected behavior** Moving an item should be an idempotent operation. If the item already belongs to the collection it is being moved to, it should not become orphaned as a result of a move operation.",source-file | test-file | source-file | test-file | source-file | test-file,"DSpace 6: Item move operation can accidentally delete items **Describe the bug** When an item is moved from one collection to another, the back end does not validate the collections that the item is being moved from and to. Normally, this is not an issue because the admin UI will filter the appropriate collections for the user to choose from. However, there is an easily reproducible scenario where this results in the accidental deletion of the item and all of its bitstreams. **To Reproduce** Steps to reproduce the behavior: 1. Find an item, X, **belonging to a single collection**, Collection A, and move it through the Edit Item admin page to Collection B. 2. After the move completes successfully and you are taken back to the Edit Item page, refresh the page and agree to resubmit the form. (In practice, users may be working quickly and not notice what the form submission notice says; the consequences should not be as dire as an item being accidentally deleted.) 3. After the move request is processed the second time, the item becomes orphaned and all bitstreams for the item are deleted. This seems to happen because the item already belongs to Collection B after the first move, so the second time we attempt to move it from Collection A to Collection B, adding B to its collections has no effect. However, the logic in [CollectionServiceImpl](https://github.com/DSpace/DSpace/blob/97d0a1f12855b3451c77435591368c4c224b5138/dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java#L646) erroneously determines that the item has now been orphaned, since it is only part of one collection when removeItem is called. **Expected behavior** Moving an item should be an idempotent operation. If the item already belongs to the collection it is being moved to, it should not become orphaned as a result of a move operation. source-file test-file source-file test-file source-file test-file",no-bug,0.9
3761,DSpace,https://github.com/DSpace/DSpace/issues/3761,"[DS-387] Add ability for various Packager plugins to report their custom ""options"" via command line","<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-387"">[DS-387]</a> created by tdonohue</i> <p>Currently, the various packager plugins (METS & PDF) have no way to report to users what options are available to be passed to the plugin (via the 'packager -o <span class=""error"">&#91;option&#93;</span>=<span class=""error"">&#91;value&#93;</span>' flag).</p> <p>It'd be nice to allow a user to get a brief description of the valid options for each plugin via the commandline interface. I've implemented a simple patch (see attached) which lets users do this as follows:</p> <p>(1) running 'dspace packager -h' will output the normal Help information, including a list of all currently configured packager plugins (this feature already existed)</p> <p>(2) running 'dspace packager -h -t METS' will report normal Help information, but will <b>also</b> output some additional options which are specific to the METS packager plugin. Similarly, 'dspace packager -h -t PDF' would report any additional options which are specific to the PDF packager plugin.</p> <p>The way this is implemented is to add a ""getParameterHelp()"" method to both the PackageIngester and PackageDisseminator interfaces. Each implementing packager plugin is responsible for reporting any custom options in this ""getParameterHelp()"" method.</p> <p>See the attached patch for further details. (NOTE: This patch is very slightly dependent on <a href=""https://jira.lyrasis.org/browse/DS-386"" title=""Allow user to specify which <dmdSec> is used by the METS Ingester when importing METS from Packager script"" class=""issue-link"" data-issue-key=""DS-386""><del>DS-386</del></a> in that some of the line numbers in the patch are only correct if you already have installed <a href=""https://jira.lyrasis.org/browse/DS-386"" title=""Allow user to specify which <dmdSec> is used by the METS Ingester when importing METS from Packager script"" class=""issue-link"" data-issue-key=""DS-386""><del>DS-386</del></a>.)</p>",source-file,"[DS-387] Add ability for various Packager plugins to report their custom ""options"" via command line <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-387"">[DS-387]</a> created by tdonohue</i> <p>Currently, the various packager plugins (METS & PDF) have no way to report to users what options are available to be passed to the plugin (via the 'packager -o <span class=""error"">&#91;option&#93;</span>=<span class=""error"">&#91;value&#93;</span>' flag).</p> <p>It'd be nice to allow a user to get a brief description of the valid options for each plugin via the commandline interface. I've implemented a simple patch (see attached) which lets users do this as follows:</p> <p>(1) running 'dspace packager -h' will output the normal Help information, including a list of all currently configured packager plugins (this feature already existed)</p> <p>(2) running 'dspace packager -h -t METS' will report normal Help information, but will <b>also</b> output some additional options which are specific to the METS packager plugin. Similarly, 'dspace packager -h -t PDF' would report any additional options which are specific to the PDF packager plugin.</p> <p>The way this is implemented is to add a ""getParameterHelp()"" method to both the PackageIngester and PackageDisseminator interfaces. Each implementing packager plugin is responsible for reporting any custom options in this ""getParameterHelp()"" method.</p> <p>See the attached patch for further details. (NOTE: This patch is very slightly dependent on <a href=""https://jira.lyrasis.org/browse/DS-386"" title=""Allow user to specify which <dmdSec> is used by the METS Ingester when importing METS from Packager script"" class=""issue-link"" data-issue-key=""DS-386""><del>DS-386</del></a> in that some of the line numbers in the patch are only correct if you already have installed <a href=""https://jira.lyrasis.org/browse/DS-386"" title=""Allow user to specify which <dmdSec> is used by the METS Ingester when importing METS from Packager script"" class=""issue-link"" data-issue-key=""DS-386""><del>DS-386</del></a>.)</p> source-file",no-bug,0.95
3413,DSpace,https://github.com/DSpace/DSpace/issues/3413,[DS-35] Enable Google Sitemaps for XMLUI - ID: 2462293,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-35"">[DS-35]</a> created by kipkorir2008</i> <p>This patch adds Sitemaps to the XMLUI for DSpace 1.5.x. It's based on the<br/> Sitemap code for the DSpace 1.5.x JSPUI.</p> <p>Essentially, it just adds a ""SitemapReader"" class which can read the<br/> sitemaps generated by running the script:<br/> <span class=""error"">&#91;dspace&#93;</span>/bin/generate-sitemaps.</p> <p>Attached are two patches:</p> <p>(1) dspace-xmlui-webapp-sitemap.patch</p> <p>Patch for sitemap.xmap in DSpace XMLUI Webapp located in<br/> <span class=""error"">&#91;dspace-src&#93;</span>/dspace-xmlui/dspace-xmlui-webapp/src/main/webapp/sitemap.xmap</p> <p>(2) dspace-xmlui-api.patch</p> <p>This patch just adds the org.dspace.app.xmlui.cocoon.SitemapReader class to<br/> the XMLUI API.</p> <p>These patches were made based on the lastest SVN dspace-1.5.x branch. They<br/> will be committed to that branch shortly.</p> <p>After these patches are applied the sitemaps are available at:</p> <p><a href=""http://localhost/xmlui/sitemap"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://localhost/xmlui/sitemap</a> (Sitemaps.org sitemap)<br/> <a href=""http://localhost/xmlui/htmlmap"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://localhost/xmlui/htmlmap</a> (HTML sitemap)</p>",other-file | config-file | config-file,"[DS-35] Enable Google Sitemaps for XMLUI - ID: 2462293 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-35"">[DS-35]</a> created by kipkorir2008</i> <p>This patch adds Sitemaps to the XMLUI for DSpace 1.5.x. It's based on the<br/> Sitemap code for the DSpace 1.5.x JSPUI.</p> <p>Essentially, it just adds a ""SitemapReader"" class which can read the<br/> sitemaps generated by running the script:<br/> <span class=""error"">&#91;dspace&#93;</span>/bin/generate-sitemaps.</p> <p>Attached are two patches:</p> <p>(1) dspace-xmlui-webapp-sitemap.patch</p> <p>Patch for sitemap.xmap in DSpace XMLUI Webapp located in<br/> <span class=""error"">&#91;dspace-src&#93;</span>/dspace-xmlui/dspace-xmlui-webapp/src/main/webapp/sitemap.xmap</p> <p>(2) dspace-xmlui-api.patch</p> <p>This patch just adds the org.dspace.app.xmlui.cocoon.SitemapReader class to<br/> the XMLUI API.</p> <p>These patches were made based on the lastest SVN dspace-1.5.x branch. They<br/> will be committed to that branch shortly.</p> <p>After these patches are applied the sitemaps are available at:</p> <p><a href=""http://localhost/xmlui/sitemap"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://localhost/xmlui/sitemap</a> (Sitemaps.org sitemap)<br/> <a href=""http://localhost/xmlui/htmlmap"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://localhost/xmlui/htmlmap</a> (HTML sitemap)</p> other-file config-file config-file",no-bug,0.9
2893,DSpace,https://github.com/DSpace/DSpace/issues/2893,Make some testing infrastructure available to more of our projects.,"`dspace-server-webapp` contains some nice Builder classes for testing, which would be useful in other projects. They should move to `dspace-api` so that they can be shared more widely. Both projects contain `org.dspace.statistics.MockSolrLoggerServiceImpl` and `org.dspace.solr.MockSolrServer`. The one in `dspace-server-webapp` spins up an embedded Solr instance while the other does not. This would be useful in both places (and maybe more). Plus, it's hard to understand what is going on with the identically-named classes without pondering some obscure classpath magic. These should be consolidated in `dspace-api` so that a single fully-featured pair can be shared.",test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | test-file | test-file | config-file | source-file | source-file | test-file | test-file | test-file | config-file | config-file | documentation-file | config-file | test-file | config-file | test-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | source-file | source-file | config-file | other-file | config-file | config-file | config-file | config-file | test-file | test-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | documentation-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | config-file | config-file,"Make some testing infrastructure available to more of our projects. `dspace-server-webapp` contains some nice Builder classes for testing, which would be useful in other projects. They should move to `dspace-api` so that they can be shared more widely. Both projects contain `org.dspace.statistics.MockSolrLoggerServiceImpl` and `org.dspace.solr.MockSolrServer`. The one in `dspace-server-webapp` spins up an embedded Solr instance while the other does not. This would be useful in both places (and maybe more). Plus, it's hard to understand what is going on with the identically-named classes without pondering some obscure classpath magic. These should be consolidated in `dspace-api` so that a single fully-featured pair can be shared. test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file test-file test-file config-file source-file source-file test-file test-file test-file config-file config-file documentation-file config-file test-file config-file test-file config-file test-file test-file test-file test-file test-file test-file config-file config-file config-file config-file config-file config-file config-file documentation-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file source-file source-file config-file other-file config-file config-file config-file config-file test-file test-file source-file test-file test-file test-file test-file test-file test-file config-file documentation-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file config-file config-file",no-bug,0.95
9457,DSpace,https://github.com/DSpace/DSpace/issues/9457,NotifyServiceRestRepositoryIT has two tests which do not succeed in GitHub CI,"**Describe the bug** The `NotifyServiceRestRepositoryIT` has two tests which are consistently failing in GitHub CI. * `NotifyServiceInboundPatternConstraintRemoveOperationTest` * `NotifyServiceInboundPatternConstraintRemoveOperationBadRequestTest` However, these tests are *always* succeeding for me when I run them locally. My suspicion is that they are failing in GitHub CI because the tests are running in a different order and encountering _unexpected_ data. This most often occurs when other tests are not sufficiently cleaning up their own data. (It's also worth noting that the order of tests sometimes *does change* in GitHub CII suspect that has occurred recently, causing these tests to fail consistently.) I've attempted to resolve these failures twice: * #9444 (merged as it seemed successful at the time. But the failures have appeared again.) * #9456 (closed without merging. This might be worth referencing to see what fixes I attempted, but I was unable to get the tests to succeed.) **These tests have been temporarily disabled in #9458** They will require more investigation before they can be reenabled.",test-file,"NotifyServiceRestRepositoryIT has two tests which do not succeed in GitHub CI **Describe the bug** The `NotifyServiceRestRepositoryIT` has two tests which are consistently failing in GitHub CI. * `NotifyServiceInboundPatternConstraintRemoveOperationTest` * `NotifyServiceInboundPatternConstraintRemoveOperationBadRequestTest` However, these tests are *always* succeeding for me when I run them locally. My suspicion is that they are failing in GitHub CI because the tests are running in a different order and encountering _unexpected_ data. This most often occurs when other tests are not sufficiently cleaning up their own data. (It's also worth noting that the order of tests sometimes *does change* in GitHub CII suspect that has occurred recently, causing these tests to fail consistently.) I've attempted to resolve these failures twice: * #9444 (merged as it seemed successful at the time. But the failures have appeared again.) * #9456 (closed without merging. This might be worth referencing to see what fixes I attempted, but I was unable to get the tests to succeed.) **These tests have been temporarily disabled in #9458** They will require more investigation before they can be reenabled. test-file",no-bug,0.9
8192,DSpace,https://github.com/DSpace/DSpace/issues/8192,DSpace startup clutters the log with Velocity deprecation warnings,"**Describe the bug** At startup, DSpace logs: 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'string.resource.loader.class' has been deprecated in favor of 'resource.loader.string.class' 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'string.resource.loader.description' has been deprecated in favor of 'resource.loader.string.description' 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'string.resource.loader.repository.name' has been deprecated in favor of 'resource.loader.string.repository.name' 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'resource.loader' has been deprecated in favor of 'resource.loaders' 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'string.resource.loader.repository.static' has been deprecated in favor of 'resource.loader.string.repository.static' **To Reproduce** Steps to reproduce the behavior: 1. Start a DSpace process. **Expected behavior** Velocity does not warn about deprecated configuration keys. We should update the configuration to use the current keys. I think that this started when we adopted Velocity v2.",config-file | source-file | config-file,"DSpace startup clutters the log with Velocity deprecation warnings **Describe the bug** At startup, DSpace logs: 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'string.resource.loader.class' has been deprecated in favor of 'resource.loader.string.class' 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'string.resource.loader.description' has been deprecated in favor of 'resource.loader.string.description' 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'string.resource.loader.repository.name' has been deprecated in favor of 'resource.loader.string.repository.name' 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'resource.loader' has been deprecated in favor of 'resource.loaders' 2022-02-28 08:38:10,477 WARN unknown unknown org.apache.velocity.deprecation @ configuration key 'string.resource.loader.repository.static' has been deprecated in favor of 'resource.loader.string.repository.static' **To Reproduce** Steps to reproduce the behavior: 1. Start a DSpace process. **Expected behavior** Velocity does not warn about deprecated configuration keys. We should update the configuration to use the current keys. I think that this started when we adopted Velocity v2. config-file source-file config-file",no-bug,0.95
8920,DSpace,https://github.com/DSpace/DSpace/issues/8920,LDAP authentication is broken if groupmaps are enabled,"**Describe the bug** LDAP authentication is broken if groupmaps are enabled in `dspace/config/modules/authentication-ldap.cfg`. DSpace version is 7.6. **To Reproduce** Steps to reproduce the behavior: 1. Configure and enable LDAP authentication in `dspace/config/modules/authentication-ldap.cfg` 2. Test that LDAP login is working 3. Enable at least one groupmap, for example: `authentication-ldap.login.groupmap.1 = OU=MYORG:MYORG_LDAP_USERS` 4. Test LDAP login again 5. DSpace frontend displays ""Invalid email or password"" message and the following error and stack trace are shown in dspace.log: <details> <summary>dspace.log</summary> <pre><code>2023-06-26 19:42:56,476 INFO unknown unknown org.dspace.authenticate.LDAPAuthentication @ anonymous::auth:attempting trivial auth of user=jsmith 2023-06-26 19:42:57,326 ERROR unknown unknown org.springframework.boot.web.servlet.support.ErrorPageFilter @ Forwarding to error page from request [/api/authn/login] due to exception [Cannot invoke ""java.util.ArrayList.iterator()"" because ""group"" is null] java.lang.NullPointerException: Cannot invoke ""java.util.ArrayList.iterator()"" because ""group"" is null at org.dspace.authenticate.LDAPAuthentication.assignGroups(LDAPAuthentication.java:730) ~[dspace-api-7.6.jar:7.6] at org.dspace.authenticate.LDAPAuthentication.authenticate(LDAPAuthentication.java:273) ~[dspace-api-7.6.jar:7.6] at org.dspace.authenticate.AuthenticationServiceImpl.authenticateInternal(AuthenticationServiceImpl.java:108) ~[dspace-api-7.6.jar:7.6] at org.dspace.authenticate.AuthenticationServiceImpl.authenticate(AuthenticationServiceImpl.java:80) ~[dspace-api-7.6.jar:7.6] at org.dspace.app.rest.security.EPersonRestAuthenticationProvider.authenticateNewLogin(EPersonRestAuthenticationProvider.java:130) ~[classes/:7.6] </code></pre> </details> **Expected behavior** Login should succeed. **Related work** This seems to be a regression from: - https://github.com/DSpace/DSpace/pull/8814 I have tested reverting that patch, both with groupmaps enabled and disabled, and LDAP login works in both cases.",source-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file,"LDAP authentication is broken if groupmaps are enabled **Describe the bug** LDAP authentication is broken if groupmaps are enabled in `dspace/config/modules/authentication-ldap.cfg`. DSpace version is 7.6. **To Reproduce** Steps to reproduce the behavior: 1. Configure and enable LDAP authentication in `dspace/config/modules/authentication-ldap.cfg` 2. Test that LDAP login is working 3. Enable at least one groupmap, for example: `authentication-ldap.login.groupmap.1 = OU=MYORG:MYORG_LDAP_USERS` 4. Test LDAP login again 5. DSpace frontend displays ""Invalid email or password"" message and the following error and stack trace are shown in dspace.log: <details> <summary>dspace.log</summary> <pre><code>2023-06-26 19:42:56,476 INFO unknown unknown org.dspace.authenticate.LDAPAuthentication @ anonymous::auth:attempting trivial auth of user=jsmith 2023-06-26 19:42:57,326 ERROR unknown unknown org.springframework.boot.web.servlet.support.ErrorPageFilter @ Forwarding to error page from request [/api/authn/login] due to exception [Cannot invoke ""java.util.ArrayList.iterator()"" because ""group"" is null] java.lang.NullPointerException: Cannot invoke ""java.util.ArrayList.iterator()"" because ""group"" is null at org.dspace.authenticate.LDAPAuthentication.assignGroups(LDAPAuthentication.java:730) ~[dspace-api-7.6.jar:7.6] at org.dspace.authenticate.LDAPAuthentication.authenticate(LDAPAuthentication.java:273) ~[dspace-api-7.6.jar:7.6] at org.dspace.authenticate.AuthenticationServiceImpl.authenticateInternal(AuthenticationServiceImpl.java:108) ~[dspace-api-7.6.jar:7.6] at org.dspace.authenticate.AuthenticationServiceImpl.authenticate(AuthenticationServiceImpl.java:80) ~[dspace-api-7.6.jar:7.6] at org.dspace.app.rest.security.EPersonRestAuthenticationProvider.authenticateNewLogin(EPersonRestAuthenticationProvider.java:130) ~[classes/:7.6] </code></pre> </details> **Expected behavior** Login should succeed. **Related work** This seems to be a regression from: - https://github.com/DSpace/DSpace/pull/8814 I have tested reverting that patch, both with groupmaps enabled and disabled, and LDAP login works in both cases. source-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file",bug,0.9
3554,DSpace,https://github.com/DSpace/DSpace/issues/3554,[DS-179] Streaming Media,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-179"">[DS-179]</a> created by kipkorir2008</i> <p>Don't want in code base, ""how to"" guide might generate issues. There have been many requests for hints/tips on integrating streaming audio/video into DSpace (on listservs). But, as of yet, there have been no references written up. The Challenge of Audio and Video - Collection point for thoughts on approaching the problem.<br/> <a href=""http://wiki.dspace.org/index.php/The_Challenge_of_Audio_and_Video"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://wiki.dspace.org/index.php/The_Challenge_of_Audio_and_Video</a></p>",source-file | test-file | test-file,"[DS-179] Streaming Media <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-179"">[DS-179]</a> created by kipkorir2008</i> <p>Don't want in code base, ""how to"" guide might generate issues. There have been many requests for hints/tips on integrating streaming audio/video into DSpace (on listservs). But, as of yet, there have been no references written up. The Challenge of Audio and Video - Collection point for thoughts on approaching the problem.<br/> <a href=""http://wiki.dspace.org/index.php/The_Challenge_of_Audio_and_Video"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://wiki.dspace.org/index.php/The_Challenge_of_Audio_and_Video</a></p> source-file test-file test-file",no-bug,0.9
9476,DSpace,https://github.com/DSpace/DSpace/issues/9476,Embedded Tomcat not starting up,"# Bug In the latest DSpace version, I am not able to startup the spring-boot with Embedded Tomcat environment, i.e. `server-boot` project. I tried to run it, accordingly to the [wiki](https://wiki.lyrasis.org/display/DSDOC8x/Installing+DSpace), but i get some errors in console and event inside the `dspace.log` file. ## Steps to Reproduce 1. Clone the main repo 2. Run the `mvn` command to build and package the environment powershell $ mvn clean package -U  3. Open the target folder that has been generated inside the `dspace/modules/server-boot/target` 4. Try to execute the `jar` using the `java` runtime (You should use a 17+ version) powershell $ java -jar server-boot-8.0-SNAPSHOT.jar --dspace.dir=""{dspace8-installdir}"" --logging.config-file=""file://{dspace8-installdir}/config/log4j2.xml""  ## Errors  The first message I can see inside the console after the `spring-boot` logo comes in is the following:  ANTLR Tool version 4.13.0 used for code generation does not match the current runtime version 4.5.1ANTLR Runtime version 4.13.0 used for parser compilation does not match the current runtime version 4.5.1(base)  And this is due to a wrong version of ANTLR used by the project. In fact, inside `hibernate-core` we are using the `antlr4-runtime:4.13.0` meanwhile inside the `solr-core` we are using the version `4.5.1-1`. This latest one is marked with `runtime` target, so it will be used during runtime. After replacing it with the right version, the errors inside the log are still there: <details><summary>Log Errors</summary> <p> <pre> 2024-04-15 12:28:25,284 ERROR unknown unknown org.springframework.boot.SpringApplication @ Application run failed org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'authenticationRestController': Unsatisfied dependency expressed through field 'converter': Error creating bean with name 'converterService': Unsatisfied dependency expressed through field 'converters': Error creating bean with name 'workflowItemConverter' defined in file [/home/vins/dev/projects/DSpace7/dspace/dspace-server-webapp/target/classes/org/dspace/app/rest/converter/WorkflowItemConverter.class]: Failed to instantiate [org.dspace.app.rest.converter.WorkflowItemConverter]: Constructor threw exception at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:787) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:962) ~[spring-context-6.1.5.jar:6.1.5] at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624) ~[spring-context-6.1.5.jar:6.1.5] at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.2.4.jar:3.2.4] at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754) [spring-boot-3.2.4.jar:3.2.4] at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456) [spring-boot-3.2.4.jar:3.2.4] at org.springframework.boot.SpringApplication.run(SpringApplication.java:334) [spring-boot-3.2.4.jar:3.2.4] at org.springframework.boot.builder.SpringApplicationBuilder.run(SpringApplicationBuilder.java:149) [spring-boot-3.2.4.jar:3.2.4] at org.dspace.app.ServerBootApplication.main(ServerBootApplication.java:30) [classes/:?] Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'converterService': Unsatisfied dependency expressed through field 'converters': Error creating bean with name 'workflowItemConverter' defined in file [/home/vins/dev/projects/DSpace7/dspace/dspace-server-webapp/target/classes/org/dspace/app/rest/converter/WorkflowItemConverter.class]: Failed to instantiate [org.dspace.app.rest.converter.WorkflowItemConverter]: Constructor threw exception at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:787) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5]  19 more Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'workflowItemConverter' defined in file [/home/vins/dev/projects/DSpace7/dspace/dspace-server-webapp/target/classes/org/dspace/app/rest/converter/WorkflowItemConverter.class]: Failed to instantiate [org.dspace.app.rest.converter.WorkflowItemConverter]: Constructor threw exception at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1317) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1202) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1689) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1653) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeanCollection(DefaultListableBeanFactory.java:1543) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1511) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1392) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5]  19 more Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.dspace.app.rest.converter.WorkflowItemConverter]: Constructor threw exception at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:221) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:88) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1311) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1202) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1689) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1653) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeanCollection(DefaultListableBeanFactory.java:1543) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1511) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1392) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5]  19 more Caused by: java.lang.NullPointerException: Cannot invoke ""org.dspace.submit.factory.SubmissionServiceFactory.getSubmissionConfigService()"" because the return value of ""org.dspace.submit.factory.SubmissionServiceFactory.getInstance()"" is null at org.dspace.app.rest.converter.AInprogressItemConverter.<init>(AInprogressItemConverter.java:63) ~[classes/:?] at org.dspace.app.rest.converter.WorkflowItemConverter.<init>(WorkflowItemConverter.java:29) ~[classes/:?] at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:?] at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[?:?] at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[?:?] at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499) ~[?:?] at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480) ~[?:?] at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:195) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:88) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1311) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1202) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1689) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1653) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeanCollection(DefaultListableBeanFactory.java:1543) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1511) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1392) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5]  19 more </pre> </p> </details> ## Possibly related issues - [spring-jpa issue](https://github.com/spring-projects/spring-data-jpa/issues/3262) - [spring-boot migration](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Migration-Guide#hibernate-61) ## Related Work on `DSpace` - [Start DSpace with embedded tomcat](https://github.com/DSpace/DSpace/pull/8797)",source-file,"Embedded Tomcat not starting up # Bug In the latest DSpace version, I am not able to startup the spring-boot with Embedded Tomcat environment, i.e. `server-boot` project. I tried to run it, accordingly to the [wiki](https://wiki.lyrasis.org/display/DSDOC8x/Installing+DSpace), but i get some errors in console and event inside the `dspace.log` file. ## Steps to Reproduce 1. Clone the main repo 2. Run the `mvn` command to build and package the environment powershell $ mvn clean package -U  3. Open the target folder that has been generated inside the `dspace/modules/server-boot/target` 4. Try to execute the `jar` using the `java` runtime (You should use a 17+ version) powershell $ java -jar server-boot-8.0-SNAPSHOT.jar --dspace.dir=""{dspace8-installdir}"" --logging.config-file=""file://{dspace8-installdir}/config/log4j2.xml""  ## Errors  The first message I can see inside the console after the `spring-boot` logo comes in is the following:  ANTLR Tool version 4.13.0 used for code generation does not match the current runtime version 4.5.1ANTLR Runtime version 4.13.0 used for parser compilation does not match the current runtime version 4.5.1(base)  And this is due to a wrong version of ANTLR used by the project. In fact, inside `hibernate-core` we are using the `antlr4-runtime:4.13.0` meanwhile inside the `solr-core` we are using the version `4.5.1-1`. This latest one is marked with `runtime` target, so it will be used during runtime. After replacing it with the right version, the errors inside the log are still there: <details><summary>Log Errors</summary> <p> <pre> 2024-04-15 12:28:25,284 ERROR unknown unknown org.springframework.boot.SpringApplication @ Application run failed org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'authenticationRestController': Unsatisfied dependency expressed through field 'converter': Error creating bean with name 'converterService': Unsatisfied dependency expressed through field 'converters': Error creating bean with name 'workflowItemConverter' defined in file [/home/vins/dev/projects/DSpace7/dspace/dspace-server-webapp/target/classes/org/dspace/app/rest/converter/WorkflowItemConverter.class]: Failed to instantiate [org.dspace.app.rest.converter.WorkflowItemConverter]: Constructor threw exception at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:787) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:962) ~[spring-context-6.1.5.jar:6.1.5] at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624) ~[spring-context-6.1.5.jar:6.1.5] at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.2.4.jar:3.2.4] at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754) [spring-boot-3.2.4.jar:3.2.4] at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456) [spring-boot-3.2.4.jar:3.2.4] at org.springframework.boot.SpringApplication.run(SpringApplication.java:334) [spring-boot-3.2.4.jar:3.2.4] at org.springframework.boot.builder.SpringApplicationBuilder.run(SpringApplicationBuilder.java:149) [spring-boot-3.2.4.jar:3.2.4] at org.dspace.app.ServerBootApplication.main(ServerBootApplication.java:30) [classes/:?] Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'converterService': Unsatisfied dependency expressed through field 'converters': Error creating bean with name 'workflowItemConverter' defined in file [/home/vins/dev/projects/DSpace7/dspace/dspace-server-webapp/target/classes/org/dspace/app/rest/converter/WorkflowItemConverter.class]: Failed to instantiate [org.dspace.app.rest.converter.WorkflowItemConverter]: Constructor threw exception at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:787) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5]  19 more Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'workflowItemConverter' defined in file [/home/vins/dev/projects/DSpace7/dspace/dspace-server-webapp/target/classes/org/dspace/app/rest/converter/WorkflowItemConverter.class]: Failed to instantiate [org.dspace.app.rest.converter.WorkflowItemConverter]: Constructor threw exception at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1317) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1202) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1689) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1653) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeanCollection(DefaultListableBeanFactory.java:1543) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1511) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1392) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5]  19 more Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.dspace.app.rest.converter.WorkflowItemConverter]: Constructor threw exception at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:221) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:88) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1311) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1202) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1689) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1653) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeanCollection(DefaultListableBeanFactory.java:1543) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1511) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1392) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5]  19 more Caused by: java.lang.NullPointerException: Cannot invoke ""org.dspace.submit.factory.SubmissionServiceFactory.getSubmissionConfigService()"" because the return value of ""org.dspace.submit.factory.SubmissionServiceFactory.getInstance()"" is null at org.dspace.app.rest.converter.AInprogressItemConverter.<init>(AInprogressItemConverter.java:63) ~[classes/:?] at org.dspace.app.rest.converter.WorkflowItemConverter.<init>(WorkflowItemConverter.java:29) ~[classes/:?] at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[?:?] at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~[?:?] at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[?:?] at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499) ~[?:?] at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480) ~[?:?] at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:195) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:88) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1311) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1202) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1689) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1653) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeanCollection(DefaultListableBeanFactory.java:1543) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1511) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1392) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:767) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:508) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1419) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353) ~[spring-beans-6.1.5.jar:6.1.5] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:784) ~[spring-beans-6.1.5.jar:6.1.5]  19 more </pre> </p> </details> ## Possibly related issues - [spring-jpa issue](https://github.com/spring-projects/spring-data-jpa/issues/3262) - [spring-boot migration](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Migration-Guide#hibernate-61) ## Related Work on `DSpace` - [Start DSpace with embedded tomcat](https://github.com/DSpace/DSpace/pull/8797) source-file",no-bug,0.95
3269,DSpace,https://github.com/DSpace/DSpace/issues/3269,Improve ServiceManager BeanException Logging,"**Describe the bug** When the DSpace Service Manager fails to find a bean for any reason, details are not logged by default, making problems difficult to track down. A good example is that reported in https://github.com/DSpace/DSpace/issues/3163 , where @mspalti was able to see the cause of a problem only by temporarily adding a `System.out.println` line in the `DSpaceServiceManager` code. Instead of this, failures to find beans should be logged in the DSpace log so the cause can be tracked down more easily. **Expected behavior** In these situations, a log of at least at WARN level should appear in the DSpace log, with details.",source-file | config-file | source-file | source-file | config-file,"Improve ServiceManager BeanException Logging **Describe the bug** When the DSpace Service Manager fails to find a bean for any reason, details are not logged by default, making problems difficult to track down. A good example is that reported in https://github.com/DSpace/DSpace/issues/3163 , where @mspalti was able to see the cause of a problem only by temporarily adding a `System.out.println` line in the `DSpaceServiceManager` code. Instead of this, failures to find beans should be logged in the DSpace log so the cause can be tracked down more easily. **Expected behavior** In these situations, a log of at least at WARN level should appear in the DSpace log, with details. source-file config-file source-file source-file config-file",no-bug,0.9
7969,DSpace,https://github.com/DSpace/DSpace/issues/7969,Bibtex import does not parse multiple authors into different fields,"**Description** In the DSpace 7 demo area I wanted to import a Bibtex file from the MyDSpace area. However, the authors were not parsed separately, but as one big block. **Reproduce** Steps to reproduce the behavior: 1. Get a bibtex file with multiple authors 2. Go to MyDSpace 3. Select the bibtex file to import 4. Check the author field on the new item submission **Expected behavior** Multiple authors to be parsed into different fields **Example Bibtex** @article{Moreno-ParedesSantiago2021Fpae, author = {Moreno-Paredes, Santiago and Rodriguez-Alcala, Laura and Martin-Lagos Martinez, Juan and Muller Locatelli, Nicolas and Vazquez Lopez, Cristina and Vargas Fernandez, Jose Luis and Cabrera Peea, Alvaro}, address = {England}, copyright = {COPYRIGHT 2021 BioMed Central Ltd.}, issn = {1471-2377}, journal = {BMC neurology}, keywords = {Adult ; Cardiovascular agents ; Case studies ; Complications and side effects ; Embolism - chemically induced ; Embolization ; Embolization, Therapeutic - adverse effects ; Embolization, Therapeutic - methods ; Endovascular Procedures - adverse effects ; Endovascular Procedures - methods ; Ethylene-vinyl alcohol copolymer ; Facial Palsy ; Facial Paralysis - etiology ; Female ; Head and Neck Neoplasms - therapy ; Humans ; Magnetic Resonance Imaging ; Neck paraganglioma ; Paraganglioma - therapy ; Paralysis, Facial ; Polyvinyls - adverse effects ; Squid 12 ; Therapeutic embolization}, language = {eng}, number = {1}, pages = {45-4}, publisher = {BioMed Central Ltd}, title = {Facial palsy after embolization with Squid 12}, volume = {21}, year = {2021}, }",source-file | source-file,"Bibtex import does not parse multiple authors into different fields **Description** In the DSpace 7 demo area I wanted to import a Bibtex file from the MyDSpace area. However, the authors were not parsed separately, but as one big block. **Reproduce** Steps to reproduce the behavior: 1. Get a bibtex file with multiple authors 2. Go to MyDSpace 3. Select the bibtex file to import 4. Check the author field on the new item submission **Expected behavior** Multiple authors to be parsed into different fields **Example Bibtex** @article{Moreno-ParedesSantiago2021Fpae, author = {Moreno-Paredes, Santiago and Rodriguez-Alcala, Laura and Martin-Lagos Martinez, Juan and Muller Locatelli, Nicolas and Vazquez Lopez, Cristina and Vargas Fernandez, Jose Luis and Cabrera Peea, Alvaro}, address = {England}, copyright = {COPYRIGHT 2021 BioMed Central Ltd.}, issn = {1471-2377}, journal = {BMC neurology}, keywords = {Adult ; Cardiovascular agents ; Case studies ; Complications and side effects ; Embolism - chemically induced ; Embolization ; Embolization, Therapeutic - adverse effects ; Embolization, Therapeutic - methods ; Endovascular Procedures - adverse effects ; Endovascular Procedures - methods ; Ethylene-vinyl alcohol copolymer ; Facial Palsy ; Facial Paralysis - etiology ; Female ; Head and Neck Neoplasms - therapy ; Humans ; Magnetic Resonance Imaging ; Neck paraganglioma ; Paraganglioma - therapy ; Paralysis, Facial ; Polyvinyls - adverse effects ; Squid 12 ; Therapeutic embolization}, language = {eng}, number = {1}, pages = {45-4}, publisher = {BioMed Central Ltd}, title = {Facial palsy after embolization with Squid 12}, volume = {21}, year = {2021}, } source-file source-file",no-bug,0.9
3849,DSpace,https://github.com/DSpace/DSpace/issues/3849,[DS-475] create a new group,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-475"">[DS-475]</a> created by fabien</i> <p>For me it is impossible to create a new group with XMLUI. With JSPUI, it is possible.<br/> How to reproduce :<br/> Login as administrator of Dspace.<br/> Use menu ""Administrative > Access Control > Groups"".<br/> Use the link "" Click here to add a new Group.""<br/> Here i get a message about ""Insufficent privileges"" :<br/> Your account has insufficent privileges to perform the requested action. </p> <p>But my account was create with the command create-administrator.</p>",other-file | config-file,"[DS-475] create a new group <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-475"">[DS-475]</a> created by fabien</i> <p>For me it is impossible to create a new group with XMLUI. With JSPUI, it is possible.<br/> How to reproduce :<br/> Login as administrator of Dspace.<br/> Use menu ""Administrative > Access Control > Groups"".<br/> Use the link "" Click here to add a new Group.""<br/> Here i get a message about ""Insufficent privileges"" :<br/> Your account has insufficent privileges to perform the requested action. </p> <p>But my account was create with the command create-administrator.</p> other-file config-file",no-bug,0.9
3184,DSpace,https://github.com/DSpace/DSpace/issues/3184,workflow discovery configuration query with query parameter set with free text returns no results,"**Describe the bug** If a discovery search with configuration param set as ""workflow"" and a query param does not return any result. **To Reproduce** Steps to reproduce the behavior: 1. login on dspace 7 demo 2. go to ""MyDSpace"" 3. select ""all tasks"" 4. enter a query string in search input box (i.e. title of an item that appears among ""all tasks"") 5. Search won't return results The same search can be made against REST api as logged in user, by calling /server/api/discover/search/objects?configuration=workflow&query=<query parameter> **Expected behavior** Results according to query content should be returned **Related work** We (4Science) can take this in charge, right after other beta5 tasks that we already have in charge. our estimation is 4 hours of work. Work that consists in the item indexing into task's solr documents (PooledTask and ClaimedTask resource types) and the creation of a specific test that proves the provided solution. ![Screenshot from 2021-03-12 15-17-16](https://user-images.githubusercontent.com/70699836/110952059-0e8cf400-8346-11eb-93ca-5366f572c08f.png) ![Screenshot from 2021-03-12 15-16-34](https://user-images.githubusercontent.com/70699836/110952063-0f258a80-8346-11eb-9b8b-ac90f0b96900.png)",config-file,"workflow discovery configuration query with query parameter set with free text returns no results **Describe the bug** If a discovery search with configuration param set as ""workflow"" and a query param does not return any result. **To Reproduce** Steps to reproduce the behavior: 1. login on dspace 7 demo 2. go to ""MyDSpace"" 3. select ""all tasks"" 4. enter a query string in search input box (i.e. title of an item that appears among ""all tasks"") 5. Search won't return results The same search can be made against REST api as logged in user, by calling /server/api/discover/search/objects?configuration=workflow&query=<query parameter> **Expected behavior** Results according to query content should be returned **Related work** We (4Science) can take this in charge, right after other beta5 tasks that we already have in charge. our estimation is 4 hours of work. Work that consists in the item indexing into task's solr documents (PooledTask and ClaimedTask resource types) and the creation of a specific test that proves the provided solution. ![Screenshot from 2021-03-12 15-17-16](https://user-images.githubusercontent.com/70699836/110952059-0e8cf400-8346-11eb-93ca-5366f572c08f.png) ![Screenshot from 2021-03-12 15-16-34](https://user-images.githubusercontent.com/70699836/110952063-0f258a80-8346-11eb-9b8b-ac90f0b96900.png) config-file",bug,0.9
3385,DSpace,https://github.com/DSpace/DSpace/issues/3385,[DS-7] HTML tags not stripped in statistics display - ID: 1896225,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-7"">[DS-7]</a> created by kipkorir2008</i> <p>HTML tags are not stripped in the statistics display of searches that have<br/> taken place.</p> <p>E.g. search for '<table' (without the quotes).</p> <p>Make sure 'search.floor' is set to 1 in dstat.cfg, and run the stats.<br/> You'll see the effect it has on the page, near the bottom where it shows<br/> searches that have taken place.</p>",config-file | source-file | source-file | test-file | test-file | test-file,"[DS-7] HTML tags not stripped in statistics display - ID: 1896225 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-7"">[DS-7]</a> created by kipkorir2008</i> <p>HTML tags are not stripped in the statistics display of searches that have<br/> taken place.</p> <p>E.g. search for '<table' (without the quotes).</p> <p>Make sure 'search.floor' is set to 1 in dstat.cfg, and run the stats.<br/> You'll see the effect it has on the page, near the bottom where it shows<br/> searches that have taken place.</p> config-file source-file source-file test-file test-file test-file",no-bug,0.9
9404,DSpace,https://github.com/DSpace/DSpace/issues/9404,search facets openByDefault by configuration,"**Is your feature request related to a problem? Please describe.** The sidebar facets are initially not `openByDefault`. ![Screenshot 2024-03-08 at 12-55-36 DSpace Repository Search](https://github.com/DSpace/dspace-angular/assets/33422716/3489e525-3cc8-40bd-973c-2d48833a05ab) There is some Configuration on the filterfacet, e.g. on author which is set to true ` <property name=""isOpenByDefault"" value=""true""/>` https://github.com/DSpace/DSpace/blob/eee0bfd2b1ec5995f582b98b92c40b903eed9746/dspace/config/spring/api/discovery.xml#L2567 **Describe the solution you'd like** We would like the sidebar facets to be opened initially by the `openByDefault` parameter. This is currently only exposed to the search filter endpoint, but not on the request to the single facet. ![Screenshot 2024-03-08 at 12-42-07 DSpace Repository Search](https://github.com/DSpace/dspace-angular/assets/33422716/869cc753-b4f9-4dcf-854d-a092d6ba2ea1) **Describe alternatives or workarounds you've considered** - use the opened state from the filters endpoint. This endpoint exposes the `openByDefault` information in some previous request but it seems to be unused or overwritten by the result of the facet endpoint - move the isOpenByDefault property from `DiscoverySearchFilter` to `DiscoverySearchfilterFacet` and adjust the usages (a lot (>100) in discovery.xml - not a real alternative) **Additional context** - I've search the issue board but could not find any matching issue - if it is some duplicate, Pardon - I'm currently unsure at which point any filter will be opened on DSpace by the setting. Maybe it is some legacy from dspace5? It is also not mentioned in the Docs https://wiki.lyrasis.org/display/DSDOC7x/Discovery#Discovery-Searchfilters&sidebarfacetsCustomization but appears in the example configuration - this feature will impact the appearance of most DSpace instances which align to the default discovery configuration beans We can provide some PR adressing this: Shortly summarized: - extend the search facet endpoint https://github.com/DSpace/RestContract/blob/02764cbedc66706ab1747edfc8656039e99e0172/search-endpoint.md?plain=1#L421 - to expose the isOpenByDefault property to the `SearchFacetEntryRest` representation. This property has to be added in the `DiscoverFacetResultsConverter` and `DiscoverFacetConfigurationConverter`. - extend RestContract - possible adjust the autoserialization https://github.com/DSpace/dspace-angular/blob/a9c58a1d5ae4537f0355c78acf37827c1d94abb2/src/app/shared/search/models/search-filter-config.model.ts#L51 , because there seems to be some problem to expose rest objects starting with `is` (= boolean getter)",source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | source-file,"search facets openByDefault by configuration **Is your feature request related to a problem? Please describe.** The sidebar facets are initially not `openByDefault`. ![Screenshot 2024-03-08 at 12-55-36 DSpace Repository Search](https://github.com/DSpace/dspace-angular/assets/33422716/3489e525-3cc8-40bd-973c-2d48833a05ab) There is some Configuration on the filterfacet, e.g. on author which is set to true ` <property name=""isOpenByDefault"" value=""true""/>` https://github.com/DSpace/DSpace/blob/eee0bfd2b1ec5995f582b98b92c40b903eed9746/dspace/config/spring/api/discovery.xml#L2567 **Describe the solution you'd like** We would like the sidebar facets to be opened initially by the `openByDefault` parameter. This is currently only exposed to the search filter endpoint, but not on the request to the single facet. ![Screenshot 2024-03-08 at 12-42-07 DSpace Repository Search](https://github.com/DSpace/dspace-angular/assets/33422716/869cc753-b4f9-4dcf-854d-a092d6ba2ea1) **Describe alternatives or workarounds you've considered** - use the opened state from the filters endpoint. This endpoint exposes the `openByDefault` information in some previous request but it seems to be unused or overwritten by the result of the facet endpoint - move the isOpenByDefault property from `DiscoverySearchFilter` to `DiscoverySearchfilterFacet` and adjust the usages (a lot (>100) in discovery.xml - not a real alternative) **Additional context** - I've search the issue board but could not find any matching issue - if it is some duplicate, Pardon - I'm currently unsure at which point any filter will be opened on DSpace by the setting. Maybe it is some legacy from dspace5? It is also not mentioned in the Docs https://wiki.lyrasis.org/display/DSDOC7x/Discovery#Discovery-Searchfilters&sidebarfacetsCustomization but appears in the example configuration - this feature will impact the appearance of most DSpace instances which align to the default discovery configuration beans We can provide some PR adressing this: Shortly summarized: - extend the search facet endpoint https://github.com/DSpace/RestContract/blob/02764cbedc66706ab1747edfc8656039e99e0172/search-endpoint.md?plain=1#L421 - to expose the isOpenByDefault property to the `SearchFacetEntryRest` representation. This property has to be added in the `DiscoverFacetResultsConverter` and `DiscoverFacetConfigurationConverter`. - extend RestContract - possible adjust the autoserialization https://github.com/DSpace/dspace-angular/blob/a9c58a1d5ae4537f0355c78acf37827c1d94abb2/src/app/shared/search/models/search-filter-config.model.ts#L51 , because there seems to be some problem to expose rest objects starting with `is` (= boolean getter) source-file source-file source-file source-file test-file source-file source-file source-file source-file test-file source-file source-file source-file source-file test-file source-file",no-bug,0.95
9806,DSpace,https://github.com/DSpace/DSpace/issues/9806,Rewrite integration tests to use Builders for [DSpace]Object creation wherever possible,"WIP PR: #9807 There are still a handful of cases where integration tests are directly using services (ItemService, CollectionService, GroupService, etc) to create new objects for use in testing, instead of using the AbstractBuilders which maintain a list of created objects (and cache) for thorough destruction and cleanup at the end of tests. I am working on a pull request to rewrite these ""create object"" operations to use Builders, where possible. This mostly applies to `AbstractIntegrationTestWithDatabase` classes as that is where `AbstractBuilder.cleanupObjects()` is called, and could mean some tests should be refactored to extend `AbstractIntegrationTestWithDatabase`, or extend their own `destroy()` methods to do something similar. I am hoping this can help to resolve or mitigate cases where ITs fail depending on the order and re-run count, where some data is not cleaned up properly. I will try to get a WIP PR created as soon as possible for others to comment on, review, assist with, and avoid any duplicate work since we are currently looking at failing IT issues (as at 2024-09-06)",test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file,"Rewrite integration tests to use Builders for [DSpace]Object creation wherever possible WIP PR: #9807 There are still a handful of cases where integration tests are directly using services (ItemService, CollectionService, GroupService, etc) to create new objects for use in testing, instead of using the AbstractBuilders which maintain a list of created objects (and cache) for thorough destruction and cleanup at the end of tests. I am working on a pull request to rewrite these ""create object"" operations to use Builders, where possible. This mostly applies to `AbstractIntegrationTestWithDatabase` classes as that is where `AbstractBuilder.cleanupObjects()` is called, and could mean some tests should be refactored to extend `AbstractIntegrationTestWithDatabase`, or extend their own `destroy()` methods to do something similar. I am hoping this can help to resolve or mitigate cases where ITs fail depending on the order and re-run count, where some data is not cleaned up properly. I will try to get a WIP PR created as soon as possible for others to comment on, review, assist with, and avoid any duplicate work since we are currently looking at failing IT issues (as at 2024-09-06) test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file",no-bug,0.95
2883,DSpace,https://github.com/DSpace/DSpace/issues/2883,Creating new Relationships/Entities via SAF Import,From release plan spreadsheet Estimate from release plan: 48 hours Expressing interest: none Loosely related to AIP Backup & Restore #2882 (as may be similar to that implementation).,source-file | source-file | source-file | source-file | source-file | source-file | test-file | other-file | config-file | other-file,Creating new Relationships/Entities via SAF Import From release plan spreadsheet Estimate from release plan: 48 hours Expressing interest: none Loosely related to AIP Backup & Restore #2882 (as may be similar to that implementation). source-file source-file source-file source-file source-file source-file test-file other-file config-file other-file,no-bug,0.3
3185,DSpace,https://github.com/DSpace/DSpace/issues/3185,Facet entries in the discover/facets/{facet} endpoint does not return the authority key,"**Describe the bug** When calling the {dspace.url}/api/discover/facets/{facet} endpoint, the results won't include the authority key, even though it should be there. **To Reproduce** 1. Set up a discovery core that has authority values for facets in the config 2. Try to retrieve the values through the call above 3. The resulting facet entries won't include the authority key **Expected behavior** The authority keys should be present in the response **Related work** This was discovered due to the failing tests in this PR: https://github.com/DSpace/DSpace/pull/3176",config-file,"Facet entries in the discover/facets/{facet} endpoint does not return the authority key **Describe the bug** When calling the {dspace.url}/api/discover/facets/{facet} endpoint, the results won't include the authority key, even though it should be there. **To Reproduce** 1. Set up a discovery core that has authority values for facets in the config 2. Try to retrieve the values through the call above 3. The resulting facet entries won't include the authority key **Expected behavior** The authority keys should be present in the response **Related work** This was discovered due to the failing tests in this PR: https://github.com/DSpace/DSpace/pull/3176 config-file",bug,0.9
3545,DSpace,https://github.com/DSpace/DSpace/issues/3545,[DS-170] Embargo by @mire,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-170"">[DS-170]</a> created by kipkorir2008</i> <p>Bram Luyten shared this video of their DSpace embargo function: <a href=""http://screencast.com/t/hinfBuq3fU"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://screencast.com/t/hinfBuq3fU</a>.</p>",other-file | other-file,"[DS-170] Embargo by @mire <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-170"">[DS-170]</a> created by kipkorir2008</i> <p>Bram Luyten shared this video of their DSpace embargo function: <a href=""http://screencast.com/t/hinfBuq3fU"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://screencast.com/t/hinfBuq3fU</a>.</p> other-file other-file",no-bug,0.9
3546,DSpace,https://github.com/DSpace/DSpace/issues/3546,[DS-171] Embargo_on_Bitstream_(JSP),"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-171"">[DS-171]</a> created by kipkorir2008</i> <p>Bitstreams all have a resource policy. Most of the time this is a anonymous read policy. If a bitstream has no anonymous read policy then it cannot be read, so effectively it is under embargo.Now if you could set an end date for that embargo, it would be so much nicer. But this is already possible: DSpace allows resource policies to have a start date and an end date: so if you set an anonymous read policy with a start date of januari 1 2009, it is effectively under embargo until januari 1 2009. Now all this change does, is: * allow a submitter to set an embargo date when uploading a new file (optional) * allow an administrator to set the start and end dates of a resource policy for bitstreams * display the embargo date in a nice way when displaying an item with bitstream information, and disabling the link to that bitstream if it is under embargo (an administrator can always link to the bitstream) <br/> <a href=""https://openaccess.leidenuniv.nl/handle/1887/12291"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://openaccess.leidenuniv.nl/handle/1887/12291</a><br/> <a href=""http://wiki.dspace.org/index.php/Embargo_on_Bitstream_(JSP"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://wiki.dspace.org/index.php/Embargo_on_Bitstream_(JSP</a>)</p>",other-file | other-file,"[DS-171] Embargo_on_Bitstream_(JSP) <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-171"">[DS-171]</a> created by kipkorir2008</i> <p>Bitstreams all have a resource policy. Most of the time this is a anonymous read policy. If a bitstream has no anonymous read policy then it cannot be read, so effectively it is under embargo.Now if you could set an end date for that embargo, it would be so much nicer. But this is already possible: DSpace allows resource policies to have a start date and an end date: so if you set an anonymous read policy with a start date of januari 1 2009, it is effectively under embargo until januari 1 2009. Now all this change does, is: * allow a submitter to set an embargo date when uploading a new file (optional) * allow an administrator to set the start and end dates of a resource policy for bitstreams * display the embargo date in a nice way when displaying an item with bitstream information, and disabling the link to that bitstream if it is under embargo (an administrator can always link to the bitstream) <br/> <a href=""https://openaccess.leidenuniv.nl/handle/1887/12291"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://openaccess.leidenuniv.nl/handle/1887/12291</a><br/> <a href=""http://wiki.dspace.org/index.php/Embargo_on_Bitstream_(JSP"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://wiki.dspace.org/index.php/Embargo_on_Bitstream_(JSP</a>)</p> other-file other-file",no-bug,0.9
2873,DSpace,https://github.com/DSpace/DSpace/issues/2873,Type-bind submission,From release plan spreadsheet Estimate from release plan: 36 Hours Expressing interest: none Some metadata should be included only for specific value of dc.type https://wiki.duraspace.org/display/DSDOC6x/Submission+User+Interface#SubmissionUserInterface-ItemtypeBasedMetadataCollection * Related dspace-angular issue: https://github.com/DSpace/dspace-angular/issues/806 * Related RestContract PR: https://github.com/DSpace/RestContract/pull/179 * Related DSpace PR: https://github.com/DSpace/DSpace/pull/8175 * Related dspace-angular PR: https://github.com/DSpace/dspace-angular/pull/1529,source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file,Type-bind submission From release plan spreadsheet Estimate from release plan: 36 Hours Expressing interest: none Some metadata should be included only for specific value of dc.type https://wiki.duraspace.org/display/DSDOC6x/Submission+User+Interface#SubmissionUserInterface-ItemtypeBasedMetadataCollection * Related dspace-angular issue: https://github.com/DSpace/dspace-angular/issues/806 * Related RestContract PR: https://github.com/DSpace/RestContract/pull/179 * Related DSpace PR: https://github.com/DSpace/DSpace/pull/8175 * Related dspace-angular PR: https://github.com/DSpace/dspace-angular/pull/1529 source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file,no-bug,0.7
7113,DSpace,https://github.com/DSpace/DSpace/issues/7113,[DS-3766] Error submitting an item into a collection without approval workflow via SWORD,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3766"">[DS-3766]</a> created by olli_gold</i> <p>Whenever I try to submit an item via SWORD into a collection, which is publicly available to anyone without a submission workflow behind it, I get an error. The submitting user has ADD rights for the target collection, but obviously this is not enough. I get the following error messages:</p> <p>2017-11-25 14:37:31,620 ERROR org.dspace.sword.SWORDMETSIngester @ caught exception: <br/> org.dspace.authorize.AuthorizeException: Authorization denied for action WRITE on ITEM:be542a71-e668-45c6-93f5-762cc422d504 by user 4de0100f-3636-4614-8761-8d83e4b05db5<br/> at org.dspace.authorize.AuthorizeServiceImpl.authorizeAction(AuthorizeServiceImpl.java:157)<br/> at org.dspace.authorize.AuthorizeServiceImpl.authorizeAction(AuthorizeServiceImpl.java:95)<br/> at org.dspace.authorize.AuthorizeServiceImpl.authorizeAction(AuthorizeServiceImpl.java:89)<br/> at org.dspace.content.ItemServiceImpl.update(ItemServiceImpl.java:435)<br/> at org.dspace.content.ItemServiceImpl.update(ItemServiceImpl.java:61)<br/> at org.dspace.content.packager.PackageUtils.updateDSpaceObject(PackageUtils.java:567)<br/> at org.dspace.content.packager.AbstractMETSIngester.ingestObject(AbstractMETSIngester.java:565)<br/> at org.dspace.content.packager.AbstractMETSIngester.ingest(AbstractMETSIngester.java:243)<br/> at org.dspace.sword.SWORDMETSIngester.ingest(SWORDMETSIngester.java:107)<br/> at org.dspace.sword.CollectionDepositor.doDeposit(CollectionDepositor.java:139)<br/> at org.dspace.sword.DepositManager.deposit(DepositManager.java:168)<br/> at org.dspace.sword.DSpaceSWORDServer.doDeposit(DSpaceSWORDServer.java:133)<br/> at org.purl.sword.server.DepositServlet.doPost(DepositServlet.java:313)<br/> at javax.servlet.http.HttpServlet.service(HttpServlet.java:650)<br/> at javax.servlet.http.HttpServlet.service(HttpServlet.java:731)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.catalina.filters.RequestFilter.process(RequestFilter.java:205)<br/> at org.apache.catalina.filters.RemoteAddrFilter.doFilter(RemoteAddrFilter.java:71)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:221)<br/> at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)<br/> at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:614)<br/> at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:169)<br/> at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)<br/> at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:956)<br/> at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)<br/> at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)<br/> at org.apache.coyote.ajp.AjpProcessor.process(AjpProcessor.java:190)<br/> at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:625)<br/> at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)<br/> at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)<br/> at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)<br/> at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)<br/> at java.lang.Thread.run(Thread.java:748)<br/> 2017-11-25 14:37:31,637 ERROR org.dspace.sword.DSpaceSWORDServer @ caught exception:<br/> org.dspace.sword.DSpaceSWORDException: org.dspace.authorize.AuthorizeException: Authorization denied for action WRITE on ITEM:be542a71-e668-45c6-93f5-762cc422d504 by user 4de0100f-3636-4614-8761-8d83e4b05db5<br/> at org.dspace.sword.SWORDMETSIngester.ingest(SWORDMETSIngester.java:183)<br/> at org.dspace.sword.CollectionDepositor.doDeposit(CollectionDepositor.java:139)<br/> at org.dspace.sword.DepositManager.deposit(DepositManager.java:168)<br/> at org.dspace.sword.DSpaceSWORDServer.doDeposit(DSpaceSWORDServer.java:133)<br/> at org.purl.sword.server.DepositServlet.doPost(DepositServlet.java:313)<br/> at javax.servlet.http.HttpServlet.service(HttpServlet.java:650)<br/> at javax.servlet.http.HttpServlet.service(HttpServlet.java:731)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.catalina.filters.RequestFilter.process(RequestFilter.java:205)<br/> at org.apache.catalina.filters.RemoteAddrFilter.doFilter(RemoteAddrFilter.java:71)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:221)<br/> at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)<br/> at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:614)<br/> at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:169)<br/> at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)<br/> at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:956)<br/> at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)<br/> at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)<br/> at org.apache.coyote.ajp.AjpProcessor.process(AjpProcessor.java:190)<br/> at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:625)<br/> at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)<br/> at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)<br/> at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)<br/> at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)<br/> at java.lang.Thread.run(Thread.java:748)</p> <p>As far as I understood it, the ADD permission should be enough to submit into a collection, no matter, if it was protected by a submission workflow or not. If I add WRITE permission to the user for the collection, the submission works, though</p> <p>As far as I saw that, the behaviour is the same on DSpace 5, but I haven't double checked that.</p> <p>Is this a bug or expected behavior as its probably not a good idea to accept submissions into an open collection via SWORD?</p>",source-file | source-file | source-file | config-file | source-file | source-file | source-file,"[DS-3766] Error submitting an item into a collection without approval workflow via SWORD <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3766"">[DS-3766]</a> created by olli_gold</i> <p>Whenever I try to submit an item via SWORD into a collection, which is publicly available to anyone without a submission workflow behind it, I get an error. The submitting user has ADD rights for the target collection, but obviously this is not enough. I get the following error messages:</p> <p>2017-11-25 14:37:31,620 ERROR org.dspace.sword.SWORDMETSIngester @ caught exception: <br/> org.dspace.authorize.AuthorizeException: Authorization denied for action WRITE on ITEM:be542a71-e668-45c6-93f5-762cc422d504 by user 4de0100f-3636-4614-8761-8d83e4b05db5<br/> at org.dspace.authorize.AuthorizeServiceImpl.authorizeAction(AuthorizeServiceImpl.java:157)<br/> at org.dspace.authorize.AuthorizeServiceImpl.authorizeAction(AuthorizeServiceImpl.java:95)<br/> at org.dspace.authorize.AuthorizeServiceImpl.authorizeAction(AuthorizeServiceImpl.java:89)<br/> at org.dspace.content.ItemServiceImpl.update(ItemServiceImpl.java:435)<br/> at org.dspace.content.ItemServiceImpl.update(ItemServiceImpl.java:61)<br/> at org.dspace.content.packager.PackageUtils.updateDSpaceObject(PackageUtils.java:567)<br/> at org.dspace.content.packager.AbstractMETSIngester.ingestObject(AbstractMETSIngester.java:565)<br/> at org.dspace.content.packager.AbstractMETSIngester.ingest(AbstractMETSIngester.java:243)<br/> at org.dspace.sword.SWORDMETSIngester.ingest(SWORDMETSIngester.java:107)<br/> at org.dspace.sword.CollectionDepositor.doDeposit(CollectionDepositor.java:139)<br/> at org.dspace.sword.DepositManager.deposit(DepositManager.java:168)<br/> at org.dspace.sword.DSpaceSWORDServer.doDeposit(DSpaceSWORDServer.java:133)<br/> at org.purl.sword.server.DepositServlet.doPost(DepositServlet.java:313)<br/> at javax.servlet.http.HttpServlet.service(HttpServlet.java:650)<br/> at javax.servlet.http.HttpServlet.service(HttpServlet.java:731)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.catalina.filters.RequestFilter.process(RequestFilter.java:205)<br/> at org.apache.catalina.filters.RemoteAddrFilter.doFilter(RemoteAddrFilter.java:71)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:221)<br/> at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)<br/> at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:614)<br/> at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:169)<br/> at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)<br/> at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:956)<br/> at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)<br/> at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)<br/> at org.apache.coyote.ajp.AjpProcessor.process(AjpProcessor.java:190)<br/> at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:625)<br/> at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)<br/> at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)<br/> at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)<br/> at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)<br/> at java.lang.Thread.run(Thread.java:748)<br/> 2017-11-25 14:37:31,637 ERROR org.dspace.sword.DSpaceSWORDServer @ caught exception:<br/> org.dspace.sword.DSpaceSWORDException: org.dspace.authorize.AuthorizeException: Authorization denied for action WRITE on ITEM:be542a71-e668-45c6-93f5-762cc422d504 by user 4de0100f-3636-4614-8761-8d83e4b05db5<br/> at org.dspace.sword.SWORDMETSIngester.ingest(SWORDMETSIngester.java:183)<br/> at org.dspace.sword.CollectionDepositor.doDeposit(CollectionDepositor.java:139)<br/> at org.dspace.sword.DepositManager.deposit(DepositManager.java:168)<br/> at org.dspace.sword.DSpaceSWORDServer.doDeposit(DSpaceSWORDServer.java:133)<br/> at org.purl.sword.server.DepositServlet.doPost(DepositServlet.java:313)<br/> at javax.servlet.http.HttpServlet.service(HttpServlet.java:650)<br/> at javax.servlet.http.HttpServlet.service(HttpServlet.java:731)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.catalina.filters.RequestFilter.process(RequestFilter.java:205)<br/> at org.apache.catalina.filters.RemoteAddrFilter.doFilter(RemoteAddrFilter.java:71)<br/> at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)<br/> at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)<br/> at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:221)<br/> at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)<br/> at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:614)<br/> at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:169)<br/> at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)<br/> at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:956)<br/> at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)<br/> at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:436)<br/> at org.apache.coyote.ajp.AjpProcessor.process(AjpProcessor.java:190)<br/> at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:625)<br/> at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)<br/> at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)<br/> at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)<br/> at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)<br/> at java.lang.Thread.run(Thread.java:748)</p> <p>As far as I understood it, the ADD permission should be enough to submit into a collection, no matter, if it was protected by a submission workflow or not. If I add WRITE permission to the user for the collection, the submission works, though</p> <p>As far as I saw that, the behaviour is the same on DSpace 5, but I haven't double checked that.</p> <p>Is this a bug or expected behavior as its probably not a good idea to accept submissions into an open collection via SWORD?</p> source-file source-file source-file config-file source-file source-file source-file",no-bug,0.8
9311,DSpace,https://github.com/DSpace/DSpace/issues/9311,CLI dspace stats-log-converter is failing with undefined configFile,"**Describe the bug** We are currently leaving legacy DSpace 5.X in favor of DS7 with completely new infrastructures. We had some statistical stored as logs that we want to recover and ingest it on the new system. But for the tests running so far, we can execute `stats-log-converter` command on DS5, but that same exact command doesn't work for DS7. **To Reproduce** Steps to reproduce the behavior: 1. Perform a  /dspace/bin/dspace stats-log-converter -n -v -i dspace.2015-12-17.log-20151222 -o dspace-converted  An exception occurs:  Exception: null java.lang.NullPointerException at java.base/java.io.FileInputStream.<init>(FileInputStream.java:149) at java.base/java.io.FileInputStream.<init>(FileInputStream.java:112) at java.base/java.io.FileReader.<init>(FileReader.java:60) at org.dspace.app.statistics.LogAnalyser.readConfig(LogAnalyser.java:986) at org.dspace.app.statistics.LogAnalyser.readConfig(LogAnalyser.java:956) at org.dspace.statistics.util.ClassicDSpaceLogConverter.main(ClassicDSpaceLogConverter.java:338) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:566) at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:283) at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:134) at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:99)  **Expected behavior** Digging a little bit, the error is related with configFile that is set as null.  /** * the configuration file from which to configure the analyser */ private static String configFile;  and this call: public static void readConfig() throws IOException { readConfig(configFile); } when configFile is undefined. The expected result was a csv file with the extracted content ready to be used with:  [dspace]/bin/dspace stats-log-importer  for ingesting log data into Solr. **Related work** [Link to any related tickets or PRs here](https://github.com/DSpace/DSpace/issues/2852)",source-file | source-file | source-file,"CLI dspace stats-log-converter is failing with undefined configFile **Describe the bug** We are currently leaving legacy DSpace 5.X in favor of DS7 with completely new infrastructures. We had some statistical stored as logs that we want to recover and ingest it on the new system. But for the tests running so far, we can execute `stats-log-converter` command on DS5, but that same exact command doesn't work for DS7. **To Reproduce** Steps to reproduce the behavior: 1. Perform a  /dspace/bin/dspace stats-log-converter -n -v -i dspace.2015-12-17.log-20151222 -o dspace-converted  An exception occurs:  Exception: null java.lang.NullPointerException at java.base/java.io.FileInputStream.<init>(FileInputStream.java:149) at java.base/java.io.FileInputStream.<init>(FileInputStream.java:112) at java.base/java.io.FileReader.<init>(FileReader.java:60) at org.dspace.app.statistics.LogAnalyser.readConfig(LogAnalyser.java:986) at org.dspace.app.statistics.LogAnalyser.readConfig(LogAnalyser.java:956) at org.dspace.statistics.util.ClassicDSpaceLogConverter.main(ClassicDSpaceLogConverter.java:338) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:566) at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:283) at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:134) at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:99)  **Expected behavior** Digging a little bit, the error is related with configFile that is set as null.  /** * the configuration file from which to configure the analyser */ private static String configFile;  and this call: public static void readConfig() throws IOException { readConfig(configFile); } when configFile is undefined. The expected result was a csv file with the extracted content ready to be used with:  [dspace]/bin/dspace stats-log-importer  for ingesting log data into Solr. **Related work** [Link to any related tickets or PRs here](https://github.com/DSpace/DSpace/issues/2852) source-file source-file source-file",no-bug,0.9
8636,DSpace,https://github.com/DSpace/DSpace/issues/8636,"Request a Copy's ""helpdesk"" strategy requires authentication to respond","**Describe the bug** Discovered while testing #8319 In DSpace 6, selecting the ""helpdesk"" strategy for Request a Copy allowed anyone receiving the helpdesk email to respond to the request _without authenticating into DSpace._ This is currently not possible in DSpace 7. **To Reproduce** Steps to reproduce the behavior: 1. Activate request a copy with Helpdesk Strategy: https://wiki.lyrasis.org/display/DSDOC7x/Request+a+Copy#RequestaCopy-(Optional)RequestingacopywithHelpDeskworkflow 2. As anonymous user, look at an embargoed item, click on the file to display the request a copy form. 3. Complete and send the request a copy form 4. As helpdesk staff, look at the email inbox 5. Open the Request a copy email and click on the link to respond to it. 6. **You are now required to login to DSpace** in order to respond. Previously this was available anonymously. 7. After logging in, you can approve or decline the request. **Expected behavior** You should be able to approve or deny the request without authenticating. The link sent to the helpdesk staff includes a unique token which is all that is necessary to respond to the request. **Related work** Related to #8319 and originally reported in #8304",source-file | source-file | source-file | test-file,"Request a Copy's ""helpdesk"" strategy requires authentication to respond **Describe the bug** Discovered while testing #8319 In DSpace 6, selecting the ""helpdesk"" strategy for Request a Copy allowed anyone receiving the helpdesk email to respond to the request _without authenticating into DSpace._ This is currently not possible in DSpace 7. **To Reproduce** Steps to reproduce the behavior: 1. Activate request a copy with Helpdesk Strategy: https://wiki.lyrasis.org/display/DSDOC7x/Request+a+Copy#RequestaCopy-(Optional)RequestingacopywithHelpDeskworkflow 2. As anonymous user, look at an embargoed item, click on the file to display the request a copy form. 3. Complete and send the request a copy form 4. As helpdesk staff, look at the email inbox 5. Open the Request a copy email and click on the link to respond to it. 6. **You are now required to login to DSpace** in order to respond. Previously this was available anonymously. 7. After logging in, you can approve or decline the request. **Expected behavior** You should be able to approve or deny the request without authenticating. The link sent to the helpdesk staff includes a unique token which is all that is necessary to respond to the request. **Related work** Related to #8319 and originally reported in #8304 source-file source-file source-file test-file",no-bug,0.85
8490,DSpace,https://github.com/DSpace/DSpace/issues/8490,"Solr query exception on workspace submission save due to ORCID ""will be generated::orcid::"" authority key syntax","**Describe the bug** DSpace 7.3: When adding a new ORCID authority author (dc.contributor.author) to a submission workspace item, a temporary authority key is created with the syntax ""will be generated::orcid::ID"" (where ID is the ORCID ID). If you select Save, or Save for later, a Solr authority query is performed with this temporary key and results in a server-side Solr org.apache.solr.search.SyntaxError exception. The exception also occurs when first loading a previously saved submission that has any such temporary authority keys. See [solr-exception.txt](https://github.com/DSpace/DSpace/files/9627022/solr-exception.txt) for full stack trace. **To Reproduce** Steps to reproduce the behavior: 1. Enable ORCID authority for dc.contributor.author 2. Start a new submission that accepts dc.contributor.author in the input form 3. Search for and add an ORCID author 4. Select Save or Save for later 5. Check dspace.log file for exception **Expected behavior** Solr queries for ""will be generated::orcid::"" keys should be skipped since they will not be in the Solr authority core. Or, the Solr query should be transformed into an acceptable syntax to avoid the exception. **Related work** First discovered while investigating issue #8436",source-file | source-file | source-file,"Solr query exception on workspace submission save due to ORCID ""will be generated::orcid::"" authority key syntax **Describe the bug** DSpace 7.3: When adding a new ORCID authority author (dc.contributor.author) to a submission workspace item, a temporary authority key is created with the syntax ""will be generated::orcid::ID"" (where ID is the ORCID ID). If you select Save, or Save for later, a Solr authority query is performed with this temporary key and results in a server-side Solr org.apache.solr.search.SyntaxError exception. The exception also occurs when first loading a previously saved submission that has any such temporary authority keys. See [solr-exception.txt](https://github.com/DSpace/DSpace/files/9627022/solr-exception.txt) for full stack trace. **To Reproduce** Steps to reproduce the behavior: 1. Enable ORCID authority for dc.contributor.author 2. Start a new submission that accepts dc.contributor.author in the input form 3. Search for and add an ORCID author 4. Select Save or Save for later 5. Check dspace.log file for exception **Expected behavior** Solr queries for ""will be generated::orcid::"" keys should be skipped since they will not be in the Solr authority core. Or, the Solr query should be transformed into an acceptable syntax to avoid the exception. **Related work** First discovered while investigating issue #8436 source-file source-file source-file",no-bug,0.9
8143,DSpace,https://github.com/DSpace/DSpace/issues/8143,"Refactor DSpace 6.x to use reload4j, slf4j-reload4j (log4j12 replacements with active security maintenance)","@misilot reported a new drop-in replacement for log4j 1.2.*, created by the original author of log4j 1.x, which is actively maintained for security and critical fixes. I have a branch successfully building and running. Would love some help with testing! PR at #8144 I'm adding this as a public security / feature issue as this is not an active vulnerability, just some proactive maintenance related to security which we could do for future 6.x releases. I've tentatively added a milestone of 6.5 to avoid stalling 6.4 but if others are happy with it, perhaps we can squeeze it in for 6.4? The project is called reload4j: https://reload4j.qos.ch SLF4J has also published a replacement for slf4j-log4j12 called slf4j-reload4j: https://www.slf4j.org/news.html These are meant to work **exactly** like log4j 1.2 and use the same java package path, so no logging code or import statements need to be changed, just dependency and exclusion configuration in our Maven POMs. As noted when the log4j 2.x security vulnerabilities were being discussed and mitigated in many Java projects, DSpace versions prior to v7 were not affected as they use log4j 1.2.* (1.2.14-1.2.17 depending on exact transitive dependencies). Although not vulnerable to the latest critical issue, there are several other security vulnerabilities out there which affect log4j 1.2.* and it does not get actively maintained. There will likely be more vulnerabilities discovered in the future. reload4j and slf4j-reload4j were created to address the need for an exact replacement of log4j 1.2.17 with no changes apart from security maintenance. A full list of the CVE references to fixed issues in reload4j can be found [at its webpage](https://reload4j.qos.ch/index.html).",config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file,"Refactor DSpace 6.x to use reload4j, slf4j-reload4j (log4j12 replacements with active security maintenance) @misilot reported a new drop-in replacement for log4j 1.2.*, created by the original author of log4j 1.x, which is actively maintained for security and critical fixes. I have a branch successfully building and running. Would love some help with testing! PR at #8144 I'm adding this as a public security / feature issue as this is not an active vulnerability, just some proactive maintenance related to security which we could do for future 6.x releases. I've tentatively added a milestone of 6.5 to avoid stalling 6.4 but if others are happy with it, perhaps we can squeeze it in for 6.4? The project is called reload4j: https://reload4j.qos.ch SLF4J has also published a replacement for slf4j-log4j12 called slf4j-reload4j: https://www.slf4j.org/news.html These are meant to work **exactly** like log4j 1.2 and use the same java package path, so no logging code or import statements need to be changed, just dependency and exclusion configuration in our Maven POMs. As noted when the log4j 2.x security vulnerabilities were being discussed and mitigated in many Java projects, DSpace versions prior to v7 were not affected as they use log4j 1.2.* (1.2.14-1.2.17 depending on exact transitive dependencies). Although not vulnerable to the latest critical issue, there are several other security vulnerabilities out there which affect log4j 1.2.* and it does not get actively maintained. There will likely be more vulnerabilities discovered in the future. reload4j and slf4j-reload4j were created to address the need for an exact replacement of log4j 1.2.17 with no changes apart from security maintenance. A full list of the CVE references to fixed issues in reload4j can be found [at its webpage](https://reload4j.qos.ch/index.html). config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file",no-bug,0.95
8765,DSpace,https://github.com/DSpace/DSpace/issues/8765,Reset Password does not work from the Admin Panel when Captcha verification enabled,"**Describe the bug** When I am logged in as admin and try to reset a password for another eperson, it will throw an error: Error when trying to reset password An error occured when attempting to reset the password for the account associated with the following email address: 213523@ids.upchiapas.edu.mx. The same behavior encountered also in the DSpace 7.5 DEMO website. **To Reproduce** Steps to reproduce the behavior: 1. MUST have [Google Recaptcha](https://wiki.lyrasis.org/display/DSDOC7x/CAPTCHA+Verification) enabled to reproduce this bug. 2. Log in as Admin 3. Go to Access Control -> People -> Edit a Person -> Reset Password Related: The Bug was first described in #https://github.com/DSpace/DSpace/issues/8670 However, the angular fix (#2107) did not resolve the problem. In the Network Tab, I see how the request is sent properly (with the correct parameter =forgot), but the Backend responds with 403 Forbidden. Maybe is something in the backend that should be changed as well?",source-file,"Reset Password does not work from the Admin Panel when Captcha verification enabled **Describe the bug** When I am logged in as admin and try to reset a password for another eperson, it will throw an error: Error when trying to reset password An error occured when attempting to reset the password for the account associated with the following email address: 213523@ids.upchiapas.edu.mx. The same behavior encountered also in the DSpace 7.5 DEMO website. **To Reproduce** Steps to reproduce the behavior: 1. MUST have [Google Recaptcha](https://wiki.lyrasis.org/display/DSDOC7x/CAPTCHA+Verification) enabled to reproduce this bug. 2. Log in as Admin 3. Go to Access Control -> People -> Edit a Person -> Reset Password Related: The Bug was first described in #https://github.com/DSpace/DSpace/issues/8670 However, the angular fix (#2107) did not resolve the problem. In the Network Tab, I see how the request is sent properly (with the correct parameter =forgot), but the Backend responds with 403 Forbidden. Maybe is something in the backend that should be changed as well? source-file",bug,0.9
2871,DSpace,https://github.com/DSpace/DSpace/issues/2871,Manage Subscriptions,From the release plan spreadsheet Estimate from release plan: 16 hours Expressing interest: none Allow users to subscribe to Collections for daily emails. Extra subscription endpoint (subscription resource) which maps to the subscription table. May be a subresource of user. UNCERTAIN,test-file | test-file | other-file,Manage Subscriptions From the release plan spreadsheet Estimate from release plan: 16 hours Expressing interest: none Allow users to subscribe to Collections for daily emails. Extra subscription endpoint (subscription resource) which maps to the subscription table. May be a subresource of user. UNCERTAIN test-file test-file other-file,no-bug,0.9
9312,DSpace,https://github.com/DSpace/DSpace/issues/9312,CLI dspace stats-log-importer is failing with undefined configFile,"**Describe the bug** We are currently leaving legacy DSpace 5.X in favor of DS7 with completely new infrastructures. We had some statistical stored as logs that we want to recover and ingest it on the new system. But for the tests running so far, we can execute stats-log-importer command on DS5, but that same exact command doesn't work for DS7. **To Reproduce** Steps to reproduce the behavior: 1. You can simply execute `stats-log-importer` command with an already converted file (csv format)  dspace/bin/dspace stats-log-importer -v -i dspace.2015-12-17.log-20151222`  An exception occurs:  Exception: null java.lang.NullPointerException at org.dspace.statistics.util.StatisticsImporter.load(StatisticsImporter.java:290) at org.dspace.statistics.util.StatisticsImporter.main(StatisticsImporter.java:516) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:566) at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:283) at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:134) at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:99)  **Expected behavior** Digging a little bit, the error is related with geoipLookup that is set as null object. [dspace-api/src/main/java/org/dspace/statistics/util/StatisticsImporter.java](https://github.com/DSpace/DSpace/blob/4bc95a31982831a04aad33f20b2a6e720aa7ff02/dspace-api/src/main/java/org/dspace/statistics/util/StatisticsImporter.java#L97)  private static DatabaseReader geoipLookup;   CityResponse cityResponse = geoipLookup.city(ipAddress);  that isn't defined when called. We were hopping to have that content ingested in Solr. **Related work** https://github.com/DSpace/DSpace/issues/9311",source-file | source-file | source-file,"CLI dspace stats-log-importer is failing with undefined configFile **Describe the bug** We are currently leaving legacy DSpace 5.X in favor of DS7 with completely new infrastructures. We had some statistical stored as logs that we want to recover and ingest it on the new system. But for the tests running so far, we can execute stats-log-importer command on DS5, but that same exact command doesn't work for DS7. **To Reproduce** Steps to reproduce the behavior: 1. You can simply execute `stats-log-importer` command with an already converted file (csv format)  dspace/bin/dspace stats-log-importer -v -i dspace.2015-12-17.log-20151222`  An exception occurs:  Exception: null java.lang.NullPointerException at org.dspace.statistics.util.StatisticsImporter.load(StatisticsImporter.java:290) at org.dspace.statistics.util.StatisticsImporter.main(StatisticsImporter.java:516) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:566) at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:283) at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:134) at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:99)  **Expected behavior** Digging a little bit, the error is related with geoipLookup that is set as null object. [dspace-api/src/main/java/org/dspace/statistics/util/StatisticsImporter.java](https://github.com/DSpace/DSpace/blob/4bc95a31982831a04aad33f20b2a6e720aa7ff02/dspace-api/src/main/java/org/dspace/statistics/util/StatisticsImporter.java#L97)  private static DatabaseReader geoipLookup;   CityResponse cityResponse = geoipLookup.city(ipAddress);  that isn't defined when called. We were hopping to have that content ingested in Solr. **Related work** https://github.com/DSpace/DSpace/issues/9311 source-file source-file source-file",no-bug,0.9
3843,DSpace,https://github.com/DSpace/DSpace/issues/3843,"[DS-469] DCDate.displayDate(false,*) displays only year","<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-469"">[DS-469]</a> created by mwood</i> <p>While investigating another bug I wanted to see what DCDate makes of a particular date string, and noticed a couple of peculiar results. If granularity is TIME but time is not requested, the logic falls through to a catch-all case that formats only the year (since TIME != DAY and TIME != MONTH).</p> <p>The patch overturns the chain of 'if's, picking out YEAR and MONTH explicitly so that both DAY and TIME will fall into the catch-all 'else' and be formatted with DAY granularity.</p>",config-file | config-file | config-file | config-file | other-file | container-file | container-file | container-file | test-file | other-file | documentation-file | config-file | config-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | database-file | database-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | source-file | source-file | source-file | source-file | other-file | test-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | source-file | test-file | test-file | test-file | config-file | config-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | other-file | config-file | config-file | config-file | config-file | other-file | other-file | other-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | source-file | config-file | documentation-file | config-file | config-file | config-file | documentation-file | container-file | container-file | container-file | container-file | config-file,"[DS-469] DCDate.displayDate(false,*) displays only year <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-469"">[DS-469]</a> created by mwood</i> <p>While investigating another bug I wanted to see what DCDate makes of a particular date string, and noticed a couple of peculiar results. If granularity is TIME but time is not requested, the logic falls through to a catch-all case that formats only the year (since TIME != DAY and TIME != MONTH).</p> <p>The patch overturns the chain of 'if's, picking out YEAR and MONTH explicitly so that both DAY and TIME will fall into the catch-all 'else' and be formatted with DAY granularity.</p> config-file config-file config-file config-file other-file container-file container-file container-file test-file other-file documentation-file config-file config-file config-file config-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file database-file database-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file source-file source-file source-file source-file other-file test-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file source-file test-file test-file test-file config-file config-file other-file other-file other-file other-file other-file other-file other-file config-file other-file config-file config-file config-file config-file other-file other-file other-file other-file config-file config-file config-file config-file config-file config-file config-file source-file config-file documentation-file config-file config-file config-file documentation-file container-file container-file container-file container-file config-file",no-bug,0.9
3609,DSpace,https://github.com/DSpace/DSpace/issues/3609,[DS-234] Configurable passing of Javamail parameter settings,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-234"">[DS-234]</a> created by stuartlewis</i> <p>At present, if you want to configure DSpace to send emails via a security protected server (e.g. gmail) then you have to edit the DSpace java class to add in some extra parameter settings. It would be good if additional parameters and values can be passed from dspace.cfg</p> <p>(see: <a href=""http://www.mail-archive.com/dspace-devel@lists.sourceforge.net/msg01098.html"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://www.mail-archive.com/dspace-devel@lists.sourceforge.net/msg01098.html</a>)</p>",source-file | source-file | source-file | source-file | test-file | test-file | config-file | config-file,"[DS-234] Configurable passing of Javamail parameter settings <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-234"">[DS-234]</a> created by stuartlewis</i> <p>At present, if you want to configure DSpace to send emails via a security protected server (e.g. gmail) then you have to edit the DSpace java class to add in some extra parameter settings. It would be good if additional parameters and values can be passed from dspace.cfg</p> <p>(see: <a href=""http://www.mail-archive.com/dspace-devel@lists.sourceforge.net/msg01098.html"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://www.mail-archive.com/dspace-devel@lists.sourceforge.net/msg01098.html</a>)</p> source-file source-file source-file source-file test-file test-file config-file config-file",no-bug,0.9
3414,DSpace,https://github.com/DSpace/DSpace/issues/3414,[DS-36] DSpace 1.5 XMLUI - Enable METS <amdSec> using crosswalks - ID: 2477820,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-36"">[DS-36]</a> created by kipkorir2008</i> <p>By default, the Item-level METS files which the DSpace 1.5.x XMLUI<br/> auto-generates contain only descriptive metadata (<dmdSec>), file<br/> (<fileSec>) and structure mapping (<structMap>) sections.</p> <p>This patch allows you to also generate the METS administrative metadata<br/> (<amdSec>) section, based on the request made. This patch itself doesn't<br/> create the administrative metadata. Rather, it provides you a way to<br/> utilize DSpace Crosswalks to generate the adminstrative metadata for the<br/> <amdSec>.</p> <p>As an example, you can now make requests similar to the following:</p> <p><a href=""http://localhost/xmlui/metadata/handle/123456789/1/mets.xml?techMDTypes=PRE"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://localhost/xmlui/metadata/handle/123456789/1/mets.xml?techMDTypes=PRE</a><br/> MIS</p> <p>Notice the ""techMDTypes"" is specified as ""PREMIS"". This tells the XMLUI<br/> that you want to run the ""PREMIS"" crosswalk to generate metadata to be<br/> placed in the <techMD> subsection of <amdSec>. So, the result would<br/> include the following <amdSec>:</p> <p><mets:amdSec><br/> <mets:techMD><br/> <mets:mdWrap MDTYPE=""PREMIS""><br/> <mets:xmlData><br/> <span class=""error"">&#91;..PREMIS Crosswalk-generated metadata..&#93;</span><br/> </mets:xmlData><br/> </mets:mdWrap><br/> </mets:techMD><br/> </mets:amdSec></p> <p>By default, normal requests to ""metadata/handle/<b>/</b>/mets.xml"" will NOT<br/> generate this <amdSec> section. This ensures that the default METS files<br/> are still kept small.</p> <p>However, this ability to request administrative metadata now allows more<br/> flexibility to XMLUI Themes. It also opens up more opportunities for<br/> Crosswalks which generate administrative metadata. Finally, it also begins<br/> to allow one to utilize the XMLUI as a ""pseudo-Web-Service"" interface for<br/> dissemination of Item-level METS representations (including administrative<br/> metadata)</p> <p>The attached patch was built against the latest DSpace 1.5.x branch (as of<br/> 30-Dec-2008).</p>",other-file,"[DS-36] DSpace 1.5 XMLUI - Enable METS <amdSec> using crosswalks - ID: 2477820 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-36"">[DS-36]</a> created by kipkorir2008</i> <p>By default, the Item-level METS files which the DSpace 1.5.x XMLUI<br/> auto-generates contain only descriptive metadata (<dmdSec>), file<br/> (<fileSec>) and structure mapping (<structMap>) sections.</p> <p>This patch allows you to also generate the METS administrative metadata<br/> (<amdSec>) section, based on the request made. This patch itself doesn't<br/> create the administrative metadata. Rather, it provides you a way to<br/> utilize DSpace Crosswalks to generate the adminstrative metadata for the<br/> <amdSec>.</p> <p>As an example, you can now make requests similar to the following:</p> <p><a href=""http://localhost/xmlui/metadata/handle/123456789/1/mets.xml?techMDTypes=PRE"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://localhost/xmlui/metadata/handle/123456789/1/mets.xml?techMDTypes=PRE</a><br/> MIS</p> <p>Notice the ""techMDTypes"" is specified as ""PREMIS"". This tells the XMLUI<br/> that you want to run the ""PREMIS"" crosswalk to generate metadata to be<br/> placed in the <techMD> subsection of <amdSec>. So, the result would<br/> include the following <amdSec>:</p> <p><mets:amdSec><br/> <mets:techMD><br/> <mets:mdWrap MDTYPE=""PREMIS""><br/> <mets:xmlData><br/> <span class=""error"">&#91;..PREMIS Crosswalk-generated metadata..&#93;</span><br/> </mets:xmlData><br/> </mets:mdWrap><br/> </mets:techMD><br/> </mets:amdSec></p> <p>By default, normal requests to ""metadata/handle/<b>/</b>/mets.xml"" will NOT<br/> generate this <amdSec> section. This ensures that the default METS files<br/> are still kept small.</p> <p>However, this ability to request administrative metadata now allows more<br/> flexibility to XMLUI Themes. It also opens up more opportunities for<br/> Crosswalks which generate administrative metadata. Finally, it also begins<br/> to allow one to utilize the XMLUI as a ""pseudo-Web-Service"" interface for<br/> dissemination of Item-level METS representations (including administrative<br/> metadata)</p> <p>The attached patch was built against the latest DSpace 1.5.x branch (as of<br/> 30-Dec-2008).</p> other-file",no-bug,0.9
7988,DSpace,https://github.com/DSpace/DSpace/issues/7988,DSpace 6.3/7.0 metadata-export includes items more than once,"**Describe the bug** The `metadata-export` feature includes duplicate items, once for every collection they are mapped to. This bug seems to have been exposed after the fix for empty subcommunities causing NullPointerExceptions (DS-4211, #2396). It occurs in DSpace 6.3 and DSpace 7.0. **To Reproduce** Export a community and extract only the `id` column using `csvcut` to check the total number of IDs and the unique number of IDs in the CSV: console $ ~/dspace7/bin/dspace metadata-export -f /tmp/community.csv -i 10568/1 $ csvcut -c id /tmp/community.csv | sed 1d | wc -l 32070 $ csvcut -c id /tmp/community.csv | sed 1d | sort -u | wc -l 19315  Further investigation using `csvcut`: console $ csvcut -c id,collection /tmp/community.csv | sed 1d | sort | uniq -c | sort -n | tail 5 e714bdf9-cc0f-4d9a-a808-d572e25c9238,10568/3||10568/27660||10568/80011||10568/79345||10568/79347 6 037b6d3f-76d0-4000-9846-6fd6c3512f2e,10568/69153||10568/80104||10568/79345||10568/111707||10568/79349||10568/41914||10568/79346 6 7dfd1c61-9e8c-4677-8d41-e1c4b11d867d,10568/53||10568/80011||10568/33431||10568/79165||10568/617||10568/79346 6 96ed7d8f-8264-431a-a67d-0725e5a6d9ad,10568/69153||10568/80104||10568/79345||10568/111707||10568/79349||10568/41914||10568/79346 6 a352c559-42d7-4369-91d0-c62b8521ada1,10568/69153||10568/80104||10568/79345||10568/111707||10568/79349||10568/41914||10568/79346 6 ce599c54-2809-48db-9a57-ceb8b3d128c5,10568/69153||10568/80104||10568/79345||10568/111707||10568/79349||10568/41914||10568/79346 6 e9afa7e7-cbb2-4c69-bc1a-c1dff089cc58,10568/53||10568/80012||10568/79345||10568/87893||10568/83349||10568/105597 6 fb76888c-03ae-4d53-b27d-87d7ca91371a,10568/89918||10568/79345||10568/79165||10568/79349||10568/41914||10568/79346||10568/841 6 ff42d1e6-c489-492c-a40a-803cabd901ed,10568/3||10568/97116||10568/80101||10568/89918||10568/80012||10568/79345||10568/79346||10568/34356||10568/602 7 094e9e1d-09ff-40ca-a6b9-eca580936147,10568/66||10568/80108||10568/79345||10568/698||10568/61||10568/79349||10568/41914||10568/79347  The explanation of the shell commands is: 1. `csvcut` extracts the `id` and `collection` columns of the CSV 2. `sed` deletes the CSV header 3. `sort` sorts the lines in the file (required before using `uniq`) 4. `uniq -c` lists each id/collection pair with a count of the number of times they occur 5. `sort -n` sorts the count numerically 6. `tail` shows the last ten lines of `sort -n` You can clearly see that each item appears in the CSV _at least once_ for every collection it is mapped to. **Expected behavior** Items should only appear once in the CSV. The `collection` column lists the collections the item is mapped to so we should not be listing the item more than once. **Related work** - [Empty subcommunity causes NullPointerException when exporting metadata (DS-4211)](https://jira.lyrasis.org/browse/DS-4211), merged in 6.4 and DSpace 7 `main` branch",source-file | test-file | source-file | test-file | source-file | test-file,"DSpace 6.3/7.0 metadata-export includes items more than once **Describe the bug** The `metadata-export` feature includes duplicate items, once for every collection they are mapped to. This bug seems to have been exposed after the fix for empty subcommunities causing NullPointerExceptions (DS-4211, #2396). It occurs in DSpace 6.3 and DSpace 7.0. **To Reproduce** Export a community and extract only the `id` column using `csvcut` to check the total number of IDs and the unique number of IDs in the CSV: console $ ~/dspace7/bin/dspace metadata-export -f /tmp/community.csv -i 10568/1 $ csvcut -c id /tmp/community.csv | sed 1d | wc -l 32070 $ csvcut -c id /tmp/community.csv | sed 1d | sort -u | wc -l 19315  Further investigation using `csvcut`: console $ csvcut -c id,collection /tmp/community.csv | sed 1d | sort | uniq -c | sort -n | tail 5 e714bdf9-cc0f-4d9a-a808-d572e25c9238,10568/3||10568/27660||10568/80011||10568/79345||10568/79347 6 037b6d3f-76d0-4000-9846-6fd6c3512f2e,10568/69153||10568/80104||10568/79345||10568/111707||10568/79349||10568/41914||10568/79346 6 7dfd1c61-9e8c-4677-8d41-e1c4b11d867d,10568/53||10568/80011||10568/33431||10568/79165||10568/617||10568/79346 6 96ed7d8f-8264-431a-a67d-0725e5a6d9ad,10568/69153||10568/80104||10568/79345||10568/111707||10568/79349||10568/41914||10568/79346 6 a352c559-42d7-4369-91d0-c62b8521ada1,10568/69153||10568/80104||10568/79345||10568/111707||10568/79349||10568/41914||10568/79346 6 ce599c54-2809-48db-9a57-ceb8b3d128c5,10568/69153||10568/80104||10568/79345||10568/111707||10568/79349||10568/41914||10568/79346 6 e9afa7e7-cbb2-4c69-bc1a-c1dff089cc58,10568/53||10568/80012||10568/79345||10568/87893||10568/83349||10568/105597 6 fb76888c-03ae-4d53-b27d-87d7ca91371a,10568/89918||10568/79345||10568/79165||10568/79349||10568/41914||10568/79346||10568/841 6 ff42d1e6-c489-492c-a40a-803cabd901ed,10568/3||10568/97116||10568/80101||10568/89918||10568/80012||10568/79345||10568/79346||10568/34356||10568/602 7 094e9e1d-09ff-40ca-a6b9-eca580936147,10568/66||10568/80108||10568/79345||10568/698||10568/61||10568/79349||10568/41914||10568/79347  The explanation of the shell commands is: 1. `csvcut` extracts the `id` and `collection` columns of the CSV 2. `sed` deletes the CSV header 3. `sort` sorts the lines in the file (required before using `uniq`) 4. `uniq -c` lists each id/collection pair with a count of the number of times they occur 5. `sort -n` sorts the count numerically 6. `tail` shows the last ten lines of `sort -n` You can clearly see that each item appears in the CSV _at least once_ for every collection it is mapped to. **Expected behavior** Items should only appear once in the CSV. The `collection` column lists the collections the item is mapped to so we should not be listing the item more than once. **Related work** - [Empty subcommunity causes NullPointerException when exporting metadata (DS-4211)](https://jira.lyrasis.org/browse/DS-4211), merged in 6.4 and DSpace 7 `main` branch source-file test-file source-file test-file source-file test-file",no-bug,0.9
8304,DSpace,https://github.com/DSpace/DSpace/issues/8304,"Unable to answer a request a copy using ""helpdesk"" strategy in DSpace 7.2","**Describe the bug** When request a copy is enabled with helpdesk settings, if we try to either approve or reject a request for a copy by anonymous user, an error 500 occurs (see log file for details: - [dspace.log](https://github.com/DSpace/DSpace/files/8763897/dspace.log)). Our resquest a copy are configurations are as follow: request.item.type = all mail.helpdesk = (valid email of our Helpdesk) request.item.helpdesk.override = true The error occurs even if the user have admin permissions on the collection to which the item requested belongs. **To Reproduce** 1. Activate request a copy with Helpdesk Strategy: https://wiki.lyrasis.org/display/DSDOC7x/Request+a+Copy#RequestaCopy-(Optional)RequestingacopywithHelpDeskworkflow 2. As anonymous user, look at an embargoed item, click on the file to display the request a copy form. 3. Complete and send the request a copy form 4. As helpdesk staff, look at the email inbox 5. Open the Request a copy email and click on the link to respond to it. 6. Use your DSpace Credentials to connect (_First problem, as previously this was available anonymously_) 7. On the response form try to approve or decline the request. 8. An error message appears. (_Second problem, as it's not possible to submit the request when HelpDesk strategy is enabled_) **Expected behavior** No error messages, the database is updated to reflect if the request has been approved or rejected and the user received the email response and, if the request has been accepted, the item file(s). **Related work** Don't know if this problem could relate to #8199",source-file | source-file | source-file | test-file | test-file | source-file | test-file,"Unable to answer a request a copy using ""helpdesk"" strategy in DSpace 7.2 **Describe the bug** When request a copy is enabled with helpdesk settings, if we try to either approve or reject a request for a copy by anonymous user, an error 500 occurs (see log file for details: - [dspace.log](https://github.com/DSpace/DSpace/files/8763897/dspace.log)). Our resquest a copy are configurations are as follow: request.item.type = all mail.helpdesk = (valid email of our Helpdesk) request.item.helpdesk.override = true The error occurs even if the user have admin permissions on the collection to which the item requested belongs. **To Reproduce** 1. Activate request a copy with Helpdesk Strategy: https://wiki.lyrasis.org/display/DSDOC7x/Request+a+Copy#RequestaCopy-(Optional)RequestingacopywithHelpDeskworkflow 2. As anonymous user, look at an embargoed item, click on the file to display the request a copy form. 3. Complete and send the request a copy form 4. As helpdesk staff, look at the email inbox 5. Open the Request a copy email and click on the link to respond to it. 6. Use your DSpace Credentials to connect (_First problem, as previously this was available anonymously_) 7. On the response form try to approve or decline the request. 8. An error message appears. (_Second problem, as it's not possible to submit the request when HelpDesk strategy is enabled_) **Expected behavior** No error messages, the database is updated to reflect if the request has been approved or rejected and the user received the email response and, if the request has been accepted, the item file(s). **Related work** Don't know if this problem could relate to #8199 source-file source-file source-file test-file test-file source-file test-file",no-bug,0.8
7611,DSpace,https://github.com/DSpace/DSpace/issues/7611,"[DS-4271] Discovery ""contains"" filter does not perform a phrase query","<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-4271"">[DS-4271]</a> created by cwilper</i> <p>When doing a ""contains"" filter query, if the value entered for the field contains spaces, the behavior is to return documents where the individual words are present in any order the field.</p> <p>A typical user would expect ""contains"" to do a phrase query, where the entire phrase occurs somewhere in the field's value.</p> <p>This is a long-standing issue that stems from the following line in SolrServiceImpl, which has remained untouched since the original Discovery implementation, and is present in versions 4.x through 7.0 Preview 1:</p> <p><a href=""https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-api/src/main/java/org/dspace/discovery/SolrServiceImpl.java#L2110"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-api/src/main/java/org/dspace/discovery/SolrServiceImpl.java#L2110</a></p> <p>Notice how it surrounds the text sent to solr with ""("" and "")"". <em>This has specific meaning in solr, which differs from surrounding the text with double quotes.</em> Surrounding with double quotes would have the expected effect of doing a phrase query. Surrounding with parentheses is equivalent to entering multiple fielded search tearms, one for each word. For example, a the solr query:</p> <p><tt>title:(introduction to dspace)</tt></p> <p>is the same as the solr query:</p> <p><tt>title:introduction title:to title:dspace</tt></p> <p>which is not the expected effect.</p> <p>The solution, which we have tested, is to replace the surrounding parentheses in the code referenced above, with double quotes.</p>",source-file,"[DS-4271] Discovery ""contains"" filter does not perform a phrase query <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-4271"">[DS-4271]</a> created by cwilper</i> <p>When doing a ""contains"" filter query, if the value entered for the field contains spaces, the behavior is to return documents where the individual words are present in any order the field.</p> <p>A typical user would expect ""contains"" to do a phrase query, where the entire phrase occurs somewhere in the field's value.</p> <p>This is a long-standing issue that stems from the following line in SolrServiceImpl, which has remained untouched since the original Discovery implementation, and is present in versions 4.x through 7.0 Preview 1:</p> <p><a href=""https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-api/src/main/java/org/dspace/discovery/SolrServiceImpl.java#L2110"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-api/src/main/java/org/dspace/discovery/SolrServiceImpl.java#L2110</a></p> <p>Notice how it surrounds the text sent to solr with ""("" and "")"". <em>This has specific meaning in solr, which differs from surrounding the text with double quotes.</em> Surrounding with double quotes would have the expected effect of doing a phrase query. Surrounding with parentheses is equivalent to entering multiple fielded search tearms, one for each word. For example, a the solr query:</p> <p><tt>title:(introduction to dspace)</tt></p> <p>is the same as the solr query:</p> <p><tt>title:introduction title:to title:dspace</tt></p> <p>which is not the expected effect.</p> <p>The solution, which we have tested, is to replace the surrounding parentheses in the code referenced above, with double quotes.</p> source-file",no-bug,0.9
7107,DSpace,https://github.com/DSpace/DSpace/issues/7107,[DS-3760] Searching with quotation marks within the Browse by Titles function,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3760"">[DS-3760]</a> created by alcurnow</i> <p>Dspace searching with quotation marks within the Browse by Titles function</p> <p>ERROR message:<br/> org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException: org.apache.solr.search.SyntaxError: Cannot parse 'bi_sort_1_sort: [* TO ""brief communication""""}': Encountered "" <RANGE_GOOP> ""\"" """" at line 1, column 43.<br/> Was expecting one of:<br/> ""]"" <br/> ""}"" </p> <p>Steps to reproduce<br/> 1. go to <a href=""https://mro.massey.ac.nz"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://mro.massey.ac.nz</a><br/> 2. then Any collection eg: Theses and Dissertations <a href=""https://mro.massey.ac.nz/handle/10179/296"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://mro.massey.ac.nz/handle/10179/296</a><br/> 3. Click on Browse by Title<br/> 4. In search box, search for ""doctor of science"" using the quotation marks or any phrase with double quotes</p> <p>have attached screenshot of error<br/> have experienced same error in both Firefox and Chrome</p>",other-file,"[DS-3760] Searching with quotation marks within the Browse by Titles function <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3760"">[DS-3760]</a> created by alcurnow</i> <p>Dspace searching with quotation marks within the Browse by Titles function</p> <p>ERROR message:<br/> org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException: org.apache.solr.search.SyntaxError: Cannot parse 'bi_sort_1_sort: [* TO ""brief communication""""}': Encountered "" <RANGE_GOOP> ""\"" """" at line 1, column 43.<br/> Was expecting one of:<br/> ""]"" <br/> ""}"" </p> <p>Steps to reproduce<br/> 1. go to <a href=""https://mro.massey.ac.nz"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://mro.massey.ac.nz</a><br/> 2. then Any collection eg: Theses and Dissertations <a href=""https://mro.massey.ac.nz/handle/10179/296"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://mro.massey.ac.nz/handle/10179/296</a><br/> 3. Click on Browse by Title<br/> 4. In search box, search for ""doctor of science"" using the quotation marks or any phrase with double quotes</p> <p>have attached screenshot of error<br/> have experienced same error in both Firefox and Chrome</p> other-file",no-bug,0.8
2844,DSpace,https://github.com/DSpace/DSpace/issues/2844,Create new Item Version (basic Items only),"From release plan spreadsheet Estimate from release plan: 72 hours Expressing interest: none https://wiki.duraspace.org/display/DSDOC6x/Item+Level+Versioning In JSPUI, possible for submitters to version own items. In XMLUI, only Admins or Com/Col Admins can version. Related to https://github.com/DSpace/DSpace/issues/2847 Corresponding UI ticket: https://github.com/DSpace/dspace-angular/issues/776",source-file | test-file | test-file | test-file | test-file | config-file,"Create new Item Version (basic Items only) From release plan spreadsheet Estimate from release plan: 72 hours Expressing interest: none https://wiki.duraspace.org/display/DSDOC6x/Item+Level+Versioning In JSPUI, possible for submitters to version own items. In XMLUI, only Admins or Com/Col Admins can version. Related to https://github.com/DSpace/DSpace/issues/2847 Corresponding UI ticket: https://github.com/DSpace/dspace-angular/issues/776 source-file test-file test-file test-file test-file config-file",no-bug,0.9
3730,DSpace,https://github.com/DSpace/DSpace/issues/3730,[DS-355] Metadata label is not displayed in user's selected language,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-355"">[DS-355]</a> created by tonijpj</i> <p>Metadata label, in item display, is always displayed using the default browser language and not the user's selected language.</p>",source-file | test-file | test-file | source-file | config-file,"[DS-355] Metadata label is not displayed in user's selected language <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-355"">[DS-355]</a> created by tonijpj</i> <p>Metadata label, in item display, is always displayed using the default browser language and not the user's selected language.</p> source-file test-file test-file source-file config-file",no-bug,0.8
3286,DSpace,https://github.com/DSpace/DSpace/issues/3286,Thumbnail resolution should happen on the rest side,"**Is your feature request related to a problem? Please describe.** Finding the correct thumbnail for an item or a bitstream is every slow at the moment, because it is done client side. The UI has to download the entire thumbnail bundle, ignoring pagination, to compare filenames with bitstreams in the ORIGINAL bundle and find a match. We've never had much issues with this because we've never used DSpace 7 in a situation where we had a lot of items with a lot of bitstreams and thumbnails. If you do the performance becomes very poor in situations where you need to resolve multiple thumbnails quickly, e.g. the search result grid view. **Describe the solution you'd like** I propose we add an optional thumbnail link to bitstreams. If a bitstream is in the ORIGINAL bundle, rest should check if there's a matching thumbnail. If there is, add a `thumbnail` link to the links section of the ORIGINAL bitstream, with the self link to the THUMBNAIL bitstream (or to a new `/bitstreams/:uuid/thumbnail` alias if that's preferable) Items should get a thumbnail link as well, for the default thumbnail that should be used for that item (best to check dspace 6 for the exact logic to determine which one that is, because as it stands the UI just picks the first one it finds). We should get that both for items retrieved directly, as well as discovery results. For performance it would be probably good if this would happen using a projection: by default the links aren't added, but if you ask for the thumbnail projection they are. However I don't think we've used projections that way before, so if this adds a significant amount of extra effort we can drop that requirement for now.",source-file | source-file | source-file | source-file | source-file,"Thumbnail resolution should happen on the rest side **Is your feature request related to a problem? Please describe.** Finding the correct thumbnail for an item or a bitstream is every slow at the moment, because it is done client side. The UI has to download the entire thumbnail bundle, ignoring pagination, to compare filenames with bitstreams in the ORIGINAL bundle and find a match. We've never had much issues with this because we've never used DSpace 7 in a situation where we had a lot of items with a lot of bitstreams and thumbnails. If you do the performance becomes very poor in situations where you need to resolve multiple thumbnails quickly, e.g. the search result grid view. **Describe the solution you'd like** I propose we add an optional thumbnail link to bitstreams. If a bitstream is in the ORIGINAL bundle, rest should check if there's a matching thumbnail. If there is, add a `thumbnail` link to the links section of the ORIGINAL bitstream, with the self link to the THUMBNAIL bitstream (or to a new `/bitstreams/:uuid/thumbnail` alias if that's preferable) Items should get a thumbnail link as well, for the default thumbnail that should be used for that item (best to check dspace 6 for the exact logic to determine which one that is, because as it stands the UI just picks the first one it finds). We should get that both for items retrieved directly, as well as discovery results. For performance it would be probably good if this would happen using a projection: by default the links aren't added, but if you ask for the thumbnail projection they are. However I don't think we've used projections that way before, so if this adds a significant amount of extra effort we can drop that requirement for now. source-file source-file source-file source-file source-file",no-bug,0.9
8732,DSpace,https://github.com/DSpace/DSpace/issues/8732,Default filter always applies in Register DOI via Item status page in UI,"**Describe the bug** It was my understanding that the functionality of registering doi via the item status page should always bypass any default filter defiened in the DOIIdentifierProvider bean (identifier-service.xml config) by applying the TrueFilter. I am seeing something very odd when trying this functionality and looking at the logs (I have added some additional logging). It looks like Truefilter is being checked twice, and an additional check is run that uses the default filter:  Before request [POST /server/api/pid/identifiers] originated from /items/69a962a1-0af5-4323-94f2-646fd500d8c5/edit/register-doi org.dspace.identifier.DOIIdentifierProvider @ Check filter: class org.dspace.content.logic.TrueFilter org.dspace.identifier.DOIIdentifierProvider @ Result of filter for 1810/347135 is true  org.dspace.identifier.DOIIdentifierProvider @ Check filter: class org.dspace.content.logic.TrueFilter org.dspace.identifier.DOIIdentifierProvider @ Result of filter for 1810/347135 is true org.dspace.identifier.DOIIdentifierProvider @ Check filter: class org.dspace.content.logic.DefaultFilter org.dspace.content.logic.condition.IsArchivedCondition @ Result of isArchived is true org.dspace.content.logic.condition.IsWithdrawnCondition @ Result of isWithdrawn is false org.dspace.content.logic.condition.InCollectionCondition @ item 1810/347135 is in collection 1810/294790, returning true org.dspace.identifier.DOIIdentifierProvider @ Result of filter for 1810/347135 is false org.dspace.app.rest.exception.DSpaceApiExceptionControllerAdvice @ An exception has occurred (status:500) java.lang.IllegalStateException: Failed to register identifier: null at org.dspace.app.rest.repository.IdentifierRestRepository.registerDOI(IdentifierRestRepository.java:248)  In the UI, I get the error message banner twice, and I can see two API calls in the developer tools. Is the method somehow being called multiple times? **To Reproduce** Steps to reproduce the behavior: 1. Log in as admin and choose an archived item without a DOI 2. Go to Edit item > Item status 3. Click on Register DOI 4. Confirm DOI registration **Expected behavior** The registration always takes place, bypassing any default identifier filters **Related work** Link to any related tickets or PRs here.",source-file | source-file | source-file,"Default filter always applies in Register DOI via Item status page in UI **Describe the bug** It was my understanding that the functionality of registering doi via the item status page should always bypass any default filter defiened in the DOIIdentifierProvider bean (identifier-service.xml config) by applying the TrueFilter. I am seeing something very odd when trying this functionality and looking at the logs (I have added some additional logging). It looks like Truefilter is being checked twice, and an additional check is run that uses the default filter:  Before request [POST /server/api/pid/identifiers] originated from /items/69a962a1-0af5-4323-94f2-646fd500d8c5/edit/register-doi org.dspace.identifier.DOIIdentifierProvider @ Check filter: class org.dspace.content.logic.TrueFilter org.dspace.identifier.DOIIdentifierProvider @ Result of filter for 1810/347135 is true  org.dspace.identifier.DOIIdentifierProvider @ Check filter: class org.dspace.content.logic.TrueFilter org.dspace.identifier.DOIIdentifierProvider @ Result of filter for 1810/347135 is true org.dspace.identifier.DOIIdentifierProvider @ Check filter: class org.dspace.content.logic.DefaultFilter org.dspace.content.logic.condition.IsArchivedCondition @ Result of isArchived is true org.dspace.content.logic.condition.IsWithdrawnCondition @ Result of isWithdrawn is false org.dspace.content.logic.condition.InCollectionCondition @ item 1810/347135 is in collection 1810/294790, returning true org.dspace.identifier.DOIIdentifierProvider @ Result of filter for 1810/347135 is false org.dspace.app.rest.exception.DSpaceApiExceptionControllerAdvice @ An exception has occurred (status:500) java.lang.IllegalStateException: Failed to register identifier: null at org.dspace.app.rest.repository.IdentifierRestRepository.registerDOI(IdentifierRestRepository.java:248)  In the UI, I get the error message banner twice, and I can see two API calls in the developer tools. Is the method somehow being called multiple times? **To Reproduce** Steps to reproduce the behavior: 1. Log in as admin and choose an archived item without a DOI 2. Go to Edit item > Item status 3. Click on Register DOI 4. Confirm DOI registration **Expected behavior** The registration always takes place, bypassing any default identifier filters **Related work** Link to any related tickets or PRs here. source-file source-file source-file",bug,0.9
8167,DSpace,https://github.com/DSpace/DSpace/issues/8167,"For controlled vocabularies, XSD specifies `id` attribute `optional`, but UI does not work without `id` attributes","**Describe the bug** In DSpace 7.2 the `controlledvocabulary.xsd` specifies the `id` attribute for each `node` as optional: `<xs:attribute name=""id"" type=""xs:ID"" use=""optional""/>`. Yet, if you provide a controlled vocabulary without `id`s, the hierarchical tree view in the Angular UI does not work correctly (only shows one element repeatedly, does not show any hierarchy) **To Reproduce** Steps to reproduce the behavior: 1. Produce a controlled vocabulary without `id` attribute for `node`s 2. Use the vocabulary in a submission form 3. Open the hierarchical tree view in the Angular UI **Expected behaviour** There are several possibilities: 1. If `id` attributes should indeed be required, change the `controlledvocabulary.xsd` accordingly. Or 2. If the UI needs distinct IDs to work, but their value is not significant, the backend could generate random unique IDs if none are specified in the vocabulary. Or 3. Make the UI work without IDs.",other-file | other-file,"For controlled vocabularies, XSD specifies `id` attribute `optional`, but UI does not work without `id` attributes **Describe the bug** In DSpace 7.2 the `controlledvocabulary.xsd` specifies the `id` attribute for each `node` as optional: `<xs:attribute name=""id"" type=""xs:ID"" use=""optional""/>`. Yet, if you provide a controlled vocabulary without `id`s, the hierarchical tree view in the Angular UI does not work correctly (only shows one element repeatedly, does not show any hierarchy) **To Reproduce** Steps to reproduce the behavior: 1. Produce a controlled vocabulary without `id` attribute for `node`s 2. Use the vocabulary in a submission form 3. Open the hierarchical tree view in the Angular UI **Expected behaviour** There are several possibilities: 1. If `id` attributes should indeed be required, change the `controlledvocabulary.xsd` accordingly. Or 2. If the UI needs distinct IDs to work, but their value is not significant, the backend could generate random unique IDs if none are specified in the vocabulary. Or 3. Make the UI work without IDs. other-file other-file",no-bug,0.8
3401,DSpace,https://github.com/DSpace/DSpace/issues/3401,[DS-23] DSQuery invalid check for empty query string - ID: 2343849,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-23"">[DS-23]</a> created by kipkorir2008</i> <p>in org.dspace.search.DSQuery</p> <p>the check for empty query Strings<br/> static String checkEmptyQuery(String myquery)<br/> {<br/> if (myquery.equals(""""))<br/> {<br/> myquery = ""empty_query_string"";<br/> }<br/> return myquery;<br/> }</p> <p>does not ""catch"" empty query strings as these are ""()"".</p>",test-file | test-file | test-file | config-file,"[DS-23] DSQuery invalid check for empty query string - ID: 2343849 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-23"">[DS-23]</a> created by kipkorir2008</i> <p>in org.dspace.search.DSQuery</p> <p>the check for empty query Strings<br/> static String checkEmptyQuery(String myquery)<br/> {<br/> if (myquery.equals(""""))<br/> {<br/> myquery = ""empty_query_string"";<br/> }<br/> return myquery;<br/> }</p> <p>does not ""catch"" empty query strings as these are ""()"".</p> test-file test-file test-file config-file",no-bug,0.8
3734,DSpace,https://github.com/DSpace/DSpace/issues/3734,[DS-359] Add alternate file appender for log4j,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-359"">[DS-359]</a> created by grahamtriggs</i> <p>Add alternate appender for Log4J, that allows it to write to files based on the current date.</p> <p>This avoids the need to rotate log files, which can be an issue when multiple applications (dspace, dspace-oai, etc.) are writing to one file.</p>",source-file | test-file | test-file | source-file | config-file,"[DS-359] Add alternate file appender for log4j <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-359"">[DS-359]</a> created by grahamtriggs</i> <p>Add alternate appender for Log4J, that allows it to write to files based on the current date.</p> <p>This avoids the need to rotate log files, which can be an issue when multiple applications (dspace, dspace-oai, etc.) are writing to one file.</p> source-file test-file test-file source-file config-file",no-bug,0.95
3549,DSpace,https://github.com/DSpace/DSpace/issues/3549,[DS-174] LDAP_Support for hierarchical LDAP servers,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-174"">[DS-174]</a> created by kipkorir2008</i> <p>The LDAP support currently in DSpace only supports a flat authentication structure. Many institutions use a hierarchical strcture which is slightly more complex. There is a patch on the queue that addresses this, but also tries to do a few other things so this needs teasing out. Robin from Edinburgh has also written a patch for this. Stuart Lewis will volunteer to look into this. Some LDAP-enabled applications also allow the setting of multiple LDAP servers with different settings. Is this a requirement for DSpace?</p>",source-file | test-file,"[DS-174] LDAP_Support for hierarchical LDAP servers <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-174"">[DS-174]</a> created by kipkorir2008</i> <p>The LDAP support currently in DSpace only supports a flat authentication structure. Many institutions use a hierarchical strcture which is slightly more complex. There is a patch on the queue that addresses this, but also tries to do a few other things so this needs teasing out. Robin from Edinburgh has also written a patch for this. Stuart Lewis will volunteer to look into this. Some LDAP-enabled applications also allow the setting of multiple LDAP servers with different settings. Is this a requirement for DSpace?</p> source-file test-file",no-bug,0.9
3710,DSpace,https://github.com/DSpace/DSpace/issues/3710,[DS-335] Minho Statistics Database Manager additions.,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-335"">[DS-335]</a> created by mdiggory</i> <p>Adding DatabaseMnager ""namespace"" support to create tables in other namespaces than the dspace default namespace</p> <p>Modified: dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseManager.java<br/> <br/> &#8212; dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseManager.java (original)<br/>  dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseManager.java Sat Oct 3 02:30:56 2009<br/> @@ -110,7 +110,7 @@</p> <ul> <li>type attacks because we are unable to determine where the input came from. Instead</li> <li>we could pass in static integer constants which are then mapped to their sql name.<br/> */</li> </ul> <ul class=""alternate"" type=""square""> <li>private static final Pattern DB_SAFE_NAME = Pattern.compile(""^<span class=""error"">&#91;a-zA-Z_1-9&#93;</span>+$"");<br/> + private static final Pattern DB_SAFE_NAME = Pattern.compile(""^<span class=""error"">&#91;a-zA-Z_1-9.&#93;</span>+$"");</li> </ul> <p> /**</p> <ul> <li>A map of database column information. The key is the table name, a<br/> @@ -1190,6 +1190,10 @@ { row.setColumn(name, results.getLong(i)); } <p>+ else if (jdbctype == Types.DOUBLE)<br/> + </p> { +row.setColumn(name, results.getDouble(i)); + } <p> else if (jdbctype == Types.CLOB && ""oracle"".equals(dbName))<br/> {<br/> // Support CLOBs in place of TEXT columns in Oracle<br/> @@ -1484,6 +1488,17 @@<br/> try<br/> {<br/> String schema = ConfigurationManager.getProperty(""db.schema"");<br/> + String catalog = null;<br/> +<br/> + int dotIndex = table.indexOf(""."");<br/> + if (dotIndex > 0)<br/> + </p> { +catalog = table.substring(0, dotIndex); +table = table.substring(dotIndex + 1, table.length()); +log.warn(""catalog: "" + catalog); +log.warn(""table: "" + table); + } <p>+<br/> connection = getConnection();</p></li> </ul> <p> DatabaseMetaData metadata = connection.getMetaData();<br/> @@ -1492,14 +1507,15 @@<br/> int max = metadata.getMaxTableNameLength();<br/> String tname = (table.length() >= max) ? table<br/> .substring(0, max - 1) : table;<br/> -</p> <ul class=""alternate"" type=""square""> <li>pkcolumns = metadata.getPrimaryKeys(null, schema, tname);<br/> +<br/> + pkcolumns = metadata.getPrimaryKeys(catalog, schema, tname);<br/> +<br/> Set pks = new HashSet();</li> </ul> <p> while (pkcolumns.next())<br/> pks.add(pkcolumns.getString(4));</p> <ul class=""alternate"" type=""square""> <li>columns = metadata.getColumns(null, schema, tname, null);<br/> + columns = metadata.getColumns(catalog, schema, tname, null);</li> </ul> <p> while (columns.next())</p> { Modified: dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/TableRow.java   dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/TableRow.java(original)  dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/TableRow.javaSat Oct 3 02:30:56 2009 @@ -230,6 +230,47 @@ } <p> /**<br/> + * Return the double value of column.<br/> + *<br/> + * If the column's type is not an float, or the column does not exist, an<br/> + * IllegalArgumentException is thrown.<br/> + *<br/> + * @param column<br/> + * The column name (case-insensitive)<br/> + * @return The double value of the column, or -1 if the column is an SQL null.<br/> + */<br/> + public double getDoubleColumn(String column)<br/> + {<br/> +if (!hasColumn(column))<br/> +</p> { + throw new IllegalArgumentException(""No such column "" + column); +}<br/> +<br/> +String name = canonicalize(column);<br/> +<br/> +if (isColumnNull(name))<br/> +{ + return -1; +}<br/> +<br/> +Object value = data.get(name);<br/> +<br/> +if (value == null)<br/> +{ + throw new IllegalArgumentException(""Column "" + column + + "" not present""); +}<br/> +<br/> +if (!(value instanceof Double))<br/> +{ + throw new IllegalArgumentException(""Value for "" + column + + "" is not a double""); +}<br/> +<br/> +return ((Double) value).doubleValue();<br/> + }<br/> +<br/> + /**<br/> * Return the String value of column.<br/> *<br/> * If the column's type is not a String, or the column does not exist, an<br/> @@ -504,6 +545,32 @@<br/> }<br/> <br/> /**<br/> + * Set column to the double d.<br/> + *<br/> + * If the column does not exist, an IllegalArgumentException is thrown.<br/> + *<br/> + * @param column<br/> + * The column name (case-insensitive)<br/> + * @param l<br/> + * The double value<br/> + */<br/> + public void setColumn(String column, double d)<br/> + {<br/> +if (!hasColumn(column))<br/> +{+ throw new IllegalArgumentException(""No such column "" + column);+} <p>+<br/> +String canonName = canonicalize(column);<br/> +Double value = new Double(d);<br/> +if (!value.equals(data.get(canonName<br/> +</p> { + data.put(canonName, value); + changed.put(canonName, Boolean.TRUE); +} <p>+ }<br/> +<br/> + /**</p> <ul> <li>Set column to the date d. If the date is null, the column is set to NULL</li> <li>as well.<br/> *</li> </ul>",other-file,"[DS-335] Minho Statistics Database Manager additions. <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-335"">[DS-335]</a> created by mdiggory</i> <p>Adding DatabaseMnager ""namespace"" support to create tables in other namespaces than the dspace default namespace</p> <p>Modified: dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseManager.java<br/> <br/> &#8212; dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseManager.java (original)<br/>  dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseManager.java Sat Oct 3 02:30:56 2009<br/> @@ -110,7 +110,7 @@</p> <ul> <li>type attacks because we are unable to determine where the input came from. Instead</li> <li>we could pass in static integer constants which are then mapped to their sql name.<br/> */</li> </ul> <ul class=""alternate"" type=""square""> <li>private static final Pattern DB_SAFE_NAME = Pattern.compile(""^<span class=""error"">&#91;a-zA-Z_1-9&#93;</span>+$"");<br/> + private static final Pattern DB_SAFE_NAME = Pattern.compile(""^<span class=""error"">&#91;a-zA-Z_1-9.&#93;</span>+$"");</li> </ul> <p> /**</p> <ul> <li>A map of database column information. The key is the table name, a<br/> @@ -1190,6 +1190,10 @@ { row.setColumn(name, results.getLong(i)); } <p>+ else if (jdbctype == Types.DOUBLE)<br/> + </p> { +row.setColumn(name, results.getDouble(i)); + } <p> else if (jdbctype == Types.CLOB && ""oracle"".equals(dbName))<br/> {<br/> // Support CLOBs in place of TEXT columns in Oracle<br/> @@ -1484,6 +1488,17 @@<br/> try<br/> {<br/> String schema = ConfigurationManager.getProperty(""db.schema"");<br/> + String catalog = null;<br/> +<br/> + int dotIndex = table.indexOf(""."");<br/> + if (dotIndex > 0)<br/> + </p> { +catalog = table.substring(0, dotIndex); +table = table.substring(dotIndex + 1, table.length()); +log.warn(""catalog: "" + catalog); +log.warn(""table: "" + table); + } <p>+<br/> connection = getConnection();</p></li> </ul> <p> DatabaseMetaData metadata = connection.getMetaData();<br/> @@ -1492,14 +1507,15 @@<br/> int max = metadata.getMaxTableNameLength();<br/> String tname = (table.length() >= max) ? table<br/> .substring(0, max - 1) : table;<br/> -</p> <ul class=""alternate"" type=""square""> <li>pkcolumns = metadata.getPrimaryKeys(null, schema, tname);<br/> +<br/> + pkcolumns = metadata.getPrimaryKeys(catalog, schema, tname);<br/> +<br/> Set pks = new HashSet();</li> </ul> <p> while (pkcolumns.next())<br/> pks.add(pkcolumns.getString(4));</p> <ul class=""alternate"" type=""square""> <li>columns = metadata.getColumns(null, schema, tname, null);<br/> + columns = metadata.getColumns(catalog, schema, tname, null);</li> </ul> <p> while (columns.next())</p> { Modified: dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/TableRow.java   dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/TableRow.java(original)  dspace/trunk/dspace-api/src/main/java/org/dspace/storage/rdbms/TableRow.javaSat Oct 3 02:30:56 2009 @@ -230,6 +230,47 @@ } <p> /**<br/> + * Return the double value of column.<br/> + *<br/> + * If the column's type is not an float, or the column does not exist, an<br/> + * IllegalArgumentException is thrown.<br/> + *<br/> + * @param column<br/> + * The column name (case-insensitive)<br/> + * @return The double value of the column, or -1 if the column is an SQL null.<br/> + */<br/> + public double getDoubleColumn(String column)<br/> + {<br/> +if (!hasColumn(column))<br/> +</p> { + throw new IllegalArgumentException(""No such column "" + column); +}<br/> +<br/> +String name = canonicalize(column);<br/> +<br/> +if (isColumnNull(name))<br/> +{ + return -1; +}<br/> +<br/> +Object value = data.get(name);<br/> +<br/> +if (value == null)<br/> +{ + throw new IllegalArgumentException(""Column "" + column + + "" not present""); +}<br/> +<br/> +if (!(value instanceof Double))<br/> +{ + throw new IllegalArgumentException(""Value for "" + column + + "" is not a double""); +}<br/> +<br/> +return ((Double) value).doubleValue();<br/> + }<br/> +<br/> + /**<br/> * Return the String value of column.<br/> *<br/> * If the column's type is not a String, or the column does not exist, an<br/> @@ -504,6 +545,32 @@<br/> }<br/> <br/> /**<br/> + * Set column to the double d.<br/> + *<br/> + * If the column does not exist, an IllegalArgumentException is thrown.<br/> + *<br/> + * @param column<br/> + * The column name (case-insensitive)<br/> + * @param l<br/> + * The double value<br/> + */<br/> + public void setColumn(String column, double d)<br/> + {<br/> +if (!hasColumn(column))<br/> +{+ throw new IllegalArgumentException(""No such column "" + column);+} <p>+<br/> +String canonName = canonicalize(column);<br/> +Double value = new Double(d);<br/> +if (!value.equals(data.get(canonName<br/> +</p> { + data.put(canonName, value); + changed.put(canonName, Boolean.TRUE); +} <p>+ }<br/> +<br/> + /**</p> <ul> <li>Set column to the date d. If the date is null, the column is set to NULL</li> <li>as well.<br/> *</li> </ul> other-file",no-bug,0.9
3291,DSpace,https://github.com/DSpace/DSpace/issues/3291,Scripts & processes error handling,"**Describe the bug** The command line script contains [System.exit(1)](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/scripts/handler/impl/CommandLineDSpaceRunnableHandler.java#L61), this ensures the script stops immediately The REST script in the [same method](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/main/java/org/dspace/app/rest/scripts/handler/impl/RestDSpaceRunnableHandler.java#L136) doesn't stop the script This implies the `handleException` method works differently when used as a REST script, and the script will simply continue **Expected behavior** The [RestDSpaceRunnableHandler.handleException](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/main/java/org/dspace/app/rest/scripts/handler/impl/RestDSpaceRunnableHandler.java#L136) should at least throw an exception so it stops from being executed",other-file,"Scripts & processes error handling **Describe the bug** The command line script contains [System.exit(1)](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/scripts/handler/impl/CommandLineDSpaceRunnableHandler.java#L61), this ensures the script stops immediately The REST script in the [same method](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/main/java/org/dspace/app/rest/scripts/handler/impl/RestDSpaceRunnableHandler.java#L136) doesn't stop the script This implies the `handleException` method works differently when used as a REST script, and the script will simply continue **Expected behavior** The [RestDSpaceRunnableHandler.handleException](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/main/java/org/dspace/app/rest/scripts/handler/impl/RestDSpaceRunnableHandler.java#L136) should at least throw an exception so it stops from being executed other-file",no-bug,0.7
3090,DSpace,https://github.com/DSpace/DSpace/issues/3090,Bitstream format cannot be retrieved if you don't have read rights on the file,"**Describe the bug** When you make a file private (or add an embargo to it) and you aren't logged in (or if you are logged in but without read rights to the file) the format of the file isn't displayed on the full item view page. This is because the format endpoint doesn't allow you to retrieve the format if you don't have read rights to the file. The url that is being used for that request is: > /server/api/core/bitstreams/{id}/format **To Reproduce** Steps to reproduce the behavior: 1. Upload a file to an item 2. Add an embargo to it, or make it admin only by removing the anonymous read rights 3. Go to the full item view page & the format won't be there **Expected behavior** The format should be able to be displayed even if you don't have read rights to the actual file.",other-file | config-file | config-file | other-file | database-file | other-file,"Bitstream format cannot be retrieved if you don't have read rights on the file **Describe the bug** When you make a file private (or add an embargo to it) and you aren't logged in (or if you are logged in but without read rights to the file) the format of the file isn't displayed on the full item view page. This is because the format endpoint doesn't allow you to retrieve the format if you don't have read rights to the file. The url that is being used for that request is: > /server/api/core/bitstreams/{id}/format **To Reproduce** Steps to reproduce the behavior: 1. Upload a file to an item 2. Add an embargo to it, or make it admin only by removing the anonymous read rights 3. Go to the full item view page & the format won't be there **Expected behavior** The format should be able to be displayed even if you don't have read rights to the actual file. other-file config-file config-file other-file database-file other-file",bug,0.9
9716,DSpace,https://github.com/DSpace/DSpace/issues/9716,OpenAIRE v4 default crosswalk: Revised mapping for Available date,"## Context The piece of code that requires revision is: https://github.com/DSpace/DSpace/blob/main/dspace/config/crosswalks/oai/metadataFormats/oai_openaire.xsl#L1082-L1084 dc.date.available and dc.date.embargo are both exposed as ""Available"". According to the [OpenAIRE guidance](https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/field_embargoenddate.html) the ""Available"" date should be used to indicate the end of the embargo period ## Proposed change Only dc.date.embargo should be crosswalked out to ""Available"", the field OpenAIRE uses to indicate the end of an embargo date. dc.date.available is only set on items that are going into live into the repository without embargo, and is currently not set automatically upon expiry of the embargo. Overall, the proposed guidance is that the embargo end date is managed on the item level, in dc.date.embargo, for the purpose of OpenAIRE compliance, because OpenAIRE has no explicit support for the data model where one item could contain multiple files/bitstreams, each with their own access policies and embargo periods. It does not seem like a sensible or correct mapping to use values of dc.date.available, especially the automatically generated DSpace ones, to indicate the end of an embargo period. Because in the case where they (automatically) appear, there never was an embargo period in the first place. ## To Reproduce Steps to reproduce the behavior: 1. Submit an item that has values for both dc.date.available and dc.date.embargo 2. run oai import to ensure the metadata of the item is visible in the OpenAIRE OAI endpoint. ## Expected behavior Only the value of dc.date.embargo should be crosswalked out as ""Available"".",other-file,"OpenAIRE v4 default crosswalk: Revised mapping for Available date ## Context The piece of code that requires revision is: https://github.com/DSpace/DSpace/blob/main/dspace/config/crosswalks/oai/metadataFormats/oai_openaire.xsl#L1082-L1084 dc.date.available and dc.date.embargo are both exposed as ""Available"". According to the [OpenAIRE guidance](https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/field_embargoenddate.html) the ""Available"" date should be used to indicate the end of the embargo period ## Proposed change Only dc.date.embargo should be crosswalked out to ""Available"", the field OpenAIRE uses to indicate the end of an embargo date. dc.date.available is only set on items that are going into live into the repository without embargo, and is currently not set automatically upon expiry of the embargo. Overall, the proposed guidance is that the embargo end date is managed on the item level, in dc.date.embargo, for the purpose of OpenAIRE compliance, because OpenAIRE has no explicit support for the data model where one item could contain multiple files/bitstreams, each with their own access policies and embargo periods. It does not seem like a sensible or correct mapping to use values of dc.date.available, especially the automatically generated DSpace ones, to indicate the end of an embargo period. Because in the case where they (automatically) appear, there never was an embargo period in the first place. ## To Reproduce Steps to reproduce the behavior: 1. Submit an item that has values for both dc.date.available and dc.date.embargo 2. run oai import to ensure the metadata of the item is visible in the OpenAIRE OAI endpoint. ## Expected behavior Only the value of dc.date.embargo should be crosswalked out as ""Available"". other-file",no-bug,0.9
9867,DSpace,https://github.com/DSpace/DSpace/issues/9867,"OpenAIRE crosswalk: Bitstream metadata: objectType mapping that always says ""fulltext"" should be removed","## Context Bitstream metadata is being crosswalked to the ""File Location"" in the OpenAIRE crosswalk, for which you can find the spec here: https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/field_filelocation.html Note that there is an attribute that is called ""objectType"", which is recommended, not mandatory. ## Describe the bug DSpace has no way to identify whether a specific bitstream is: * fulltext * dataset * software * other The crosswalk ""addresses"" this by just always exposing ""fulltext"", which will be incorrect for all files that are not actually fulltext: https://github.com/DSpace/DSpace/blob/main/dspace/config/crosswalks/oai/metadataFormats/oai_openaire.xsl#L923-L928 The optional solution would be a bitstream level metadata field, where this objectType can be stored. But until we have that, we should probably remove that default mapping to ""fulltext"" all together and stop exposing this objectType attribute. ## To Reproduce Steps to reproduce the behavior: 1. create a dspace item with a dataset in a zipfile as bitstream 2. In the openaire crosswalk, look at the value for ""file location"", and check what is exposed as objectType ## Expected behavior It should either say dataset for objectType or not have an objectType at all. It is incorrect if ""fulltext"" is exposed in this case.",other-file,"OpenAIRE crosswalk: Bitstream metadata: objectType mapping that always says ""fulltext"" should be removed ## Context Bitstream metadata is being crosswalked to the ""File Location"" in the OpenAIRE crosswalk, for which you can find the spec here: https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/field_filelocation.html Note that there is an attribute that is called ""objectType"", which is recommended, not mandatory. ## Describe the bug DSpace has no way to identify whether a specific bitstream is: * fulltext * dataset * software * other The crosswalk ""addresses"" this by just always exposing ""fulltext"", which will be incorrect for all files that are not actually fulltext: https://github.com/DSpace/DSpace/blob/main/dspace/config/crosswalks/oai/metadataFormats/oai_openaire.xsl#L923-L928 The optional solution would be a bitstream level metadata field, where this objectType can be stored. But until we have that, we should probably remove that default mapping to ""fulltext"" all together and stop exposing this objectType attribute. ## To Reproduce Steps to reproduce the behavior: 1. create a dspace item with a dataset in a zipfile as bitstream 2. In the openaire crosswalk, look at the value for ""file location"", and check what is exposed as objectType ## Expected behavior It should either say dataset for objectType or not have an objectType at all. It is incorrect if ""fulltext"" is exposed in this case. other-file",no-bug,0.8
9151,DSpace,https://github.com/DSpace/DSpace/issues/9151,authentication-ldap.login.groupmap.attribute does not search operational attributes,"**Describe the bug** `authentication-ldap.login.groupmap.attribute` configuration setting does not search ""operational attributes"". This causes it to get a NullReferenceException when attempting to search for the `memberOf` attribute which is an operational attribute and not a normal user attribute. The LDAP search therefore needs to be modified to retrieve both user and operational attributes instead of the default which just retrieves the user attributes. **To Reproduce** Steps to reproduce the behavior: 1. Configure `authentication-ldap.login.groupmap.attribute = memberOf` when using a LDAP server that uses the `memberOf` overlay. Example:  authentication-ldap.login.groupmap.attribute = memberOf authentication-ldap.login.groupmap.1 = cn=dspace-administrators\,ou=DSpace\,ou=Groups\,dc=example\,dc=com:Administrator  **Expected behavior** DSpace should assign the Administrator group to any user dn that is a member of the `DN:cn=dspace-administrators,ou=DSpace,ou=Groups,dc=example,dc=com` group (and the user dn will have a `memberOf` attribute with a value of `cn=dspace-administrators,ou=DSpace,ou=Groups,dc=example,dc=com`) **Related work** https://github.com/DSpace/DSpace/pull/9148",source-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | test-file | test-file | other-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | other-file | other-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | config-file | other-file | other-file | config-file | other-file | other-file | other-file | config-file | config-file | other-file | other-file | other-file | other-file | config-file | other-file | config-file | config-file | config-file | container-file | other-file | other-file | other-file | config-file | config-file | config-file | test-file | test-file | config-file | config-file | config-file | config-file | config-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | database-file | database-file | database-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | source-file | config-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | other-file | other-file | config-file | test-file | test-file | config-file,"authentication-ldap.login.groupmap.attribute does not search operational attributes **Describe the bug** `authentication-ldap.login.groupmap.attribute` configuration setting does not search ""operational attributes"". This causes it to get a NullReferenceException when attempting to search for the `memberOf` attribute which is an operational attribute and not a normal user attribute. The LDAP search therefore needs to be modified to retrieve both user and operational attributes instead of the default which just retrieves the user attributes. **To Reproduce** Steps to reproduce the behavior: 1. Configure `authentication-ldap.login.groupmap.attribute = memberOf` when using a LDAP server that uses the `memberOf` overlay. Example:  authentication-ldap.login.groupmap.attribute = memberOf authentication-ldap.login.groupmap.1 = cn=dspace-administrators\,ou=DSpace\,ou=Groups\,dc=example\,dc=com:Administrator  **Expected behavior** DSpace should assign the Administrator group to any user dn that is a member of the `DN:cn=dspace-administrators,ou=DSpace,ou=Groups,dc=example,dc=com` group (and the user dn will have a `memberOf` attribute with a value of `cn=dspace-administrators,ou=DSpace,ou=Groups,dc=example,dc=com`) **Related work** https://github.com/DSpace/DSpace/pull/9148 source-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file test-file test-file other-file source-file test-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file other-file other-file other-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file other-file config-file other-file other-file config-file other-file other-file other-file config-file config-file other-file other-file other-file other-file config-file other-file config-file config-file config-file container-file other-file other-file other-file config-file config-file config-file test-file test-file config-file config-file config-file config-file config-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file database-file database-file database-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file source-file config-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file other-file other-file other-file other-file other-file other-file other-file other-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file other-file other-file config-file test-file test-file config-file",no-bug,0.9
3661,DSpace,https://github.com/DSpace/DSpace/issues/3661,[DS-286] Remove dspace/bin/dspace_migrate script,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-286"">[DS-286]</a> created by stuartlewis</i> <p>I propose that we remove the /dspace/bin/dspace_migrate script. </p> <p>Reasons:</p> <p>1) It is a bash script, and we would prefer DSpace to be 100% java<br/> 2) The item exporter now has a -m (migrate) option that will perform the same function during the export</p> <p>Would anyone have a problem with this script being removed?</p> <p>(If it is removed, it needs removing from the PDF manual, and the -migrate export option needs documenting)</p>",source-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | config-file | config-file | other-file | other-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | other-file,"[DS-286] Remove dspace/bin/dspace_migrate script <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-286"">[DS-286]</a> created by stuartlewis</i> <p>I propose that we remove the /dspace/bin/dspace_migrate script. </p> <p>Reasons:</p> <p>1) It is a bash script, and we would prefer DSpace to be 100% java<br/> 2) The item exporter now has a -m (migrate) option that will perform the same function during the export</p> <p>Would anyone have a problem with this script being removed?</p> <p>(If it is removed, it needs removing from the PDF manual, and the -migrate export option needs documenting)</p> source-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file other-file config-file config-file other-file other-file other-file config-file config-file config-file config-file config-file config-file config-file other-file",no-bug,0.9
3447,DSpace,https://github.com/DSpace/DSpace/issues/3447,[DS-70] Browse Re-Retrieves Items Unnecessarily? - ID: 2031535,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-70"">[DS-70]</a> created by kipkorir2008</i> <p>It appears the BrowseInfo.getBrowseItemResults( Context ) re-retrieves all<br/> of the Items the browse retrieved previously.<br/> BrowseInfo.getBrowseItemResults(), however, does not. The attached patch<br/> simply wires them both to behave the same, and not retrieve Items twice<br/> unnecessarily.</p> <p>It has been pointed out that it is feasible that there may be some<br/> situations in which the BrowseInfo is kept in memory for long enough that<br/> re-creating this cache is desirable. Perhaps if this is the case, some form<br/> of aging would be a desirable addition (e.g. if the cached data is more<br/> than 1 minute old, re-retrieve all of the Items).</p>",source-file,"[DS-70] Browse Re-Retrieves Items Unnecessarily? - ID: 2031535 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-70"">[DS-70]</a> created by kipkorir2008</i> <p>It appears the BrowseInfo.getBrowseItemResults( Context ) re-retrieves all<br/> of the Items the browse retrieved previously.<br/> BrowseInfo.getBrowseItemResults(), however, does not. The attached patch<br/> simply wires them both to behave the same, and not retrieve Items twice<br/> unnecessarily.</p> <p>It has been pointed out that it is feasible that there may be some<br/> situations in which the BrowseInfo is kept in memory for long enough that<br/> re-creating this cache is desirable. Perhaps if this is the case, some form<br/> of aging would be a desirable addition (e.g. if the cached data is more<br/> than 1 minute old, re-retrieve all of the Items).</p> source-file",no-bug,0.9
3745,DSpace,https://github.com/DSpace/DSpace/issues/3745,[DS-371] Maven package should be improved,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-371"">[DS-371]</a> created by mhardik</i> <p>When ever we change in java code we need to re-package it by using mvn package.</p> <p>I suggest it should be in way that java files are gets complied and jars are generated and placed in respective directories.</p>",source-file | source-file | source-file,"[DS-371] Maven package should be improved <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-371"">[DS-371]</a> created by mhardik</i> <p>When ever we change in java code we need to re-package it by using mvn package.</p> <p>I suggest it should be in way that java files are gets complied and jars are generated and placed in respective directories.</p> source-file source-file source-file",no-bug,0.95
8557,DSpace,https://github.com/DSpace/DSpace/issues/8557,DSpace 5 and 6 handle server doesn't start after JDK 8 update,"**Describe the bug** After updating to  openjdk version ""1.8.0_352"" OpenJDK Runtime Environment (build 1.8.0_352-b08) OpenJDK 64-Bit Server VM (build 25.352-b08, mixed mode)  or  openjdk version ""1.8.0_352"" OpenJDK Runtime Environment Corretto-8.352.08.1 (build 1.8.0_352-b08) OpenJDK 64-Bit Server VM Corretto-8.352.08.1 (build 25.352-b08, mixed mode)  The handle-server script no longer starts, probably due to [JDK-8287132 - Retire Runtime.runFinalizersOnExit so that it always throws UOE](https://bugs.openjdk.org/browse/JDK-8287132) **To Reproduce** Steps to reproduce the behavior: 1. Update the system packaged JDK 8 (Coretto and RHEL-packaged openjdk confirmed) 2. Try to start handle-server script 3. (Startup error message)  2022/10/26 03:04:46 CEST"" 25 Started new run. java.lang.UnsupportedOperationException at java.lang.Runtime.runFinalizersOnExit(Runtime.java:287) at java.lang.System.runFinalizersOnExit(System.java:1059) at net.handle.server.Main.initialize(Main.java:124) at net.handle.server.Main.main(Main.java:75) Shutting down  The reported errors in the mailing lists looks like DSpace 5 installations, but the handle server dependency looks the same in the DSpace 6 pom.xml, so probably also applies there? **Expected behavior** Normal startup of handle-server **KNOWN WORKAROUNDS** Either of these options will work, but neither is ideal: * Downgrade OpenJDK 8 to a version _prior to_ 1.8.0.352 (which is where this change was made) * Use OpenJDK 7 (which is no longer supported) **Related work** https://bugs.openjdk.org/browse/JDK-8287132 https://groups.google.com/g/dspace-community/c/B-865GtF93A",config-file | source-file | source-file | config-file | other-file | config-file | config-file | source-file | config-file | other-file | config-file,"DSpace 5 and 6 handle server doesn't start after JDK 8 update **Describe the bug** After updating to  openjdk version ""1.8.0_352"" OpenJDK Runtime Environment (build 1.8.0_352-b08) OpenJDK 64-Bit Server VM (build 25.352-b08, mixed mode)  or  openjdk version ""1.8.0_352"" OpenJDK Runtime Environment Corretto-8.352.08.1 (build 1.8.0_352-b08) OpenJDK 64-Bit Server VM Corretto-8.352.08.1 (build 25.352-b08, mixed mode)  The handle-server script no longer starts, probably due to [JDK-8287132 - Retire Runtime.runFinalizersOnExit so that it always throws UOE](https://bugs.openjdk.org/browse/JDK-8287132) **To Reproduce** Steps to reproduce the behavior: 1. Update the system packaged JDK 8 (Coretto and RHEL-packaged openjdk confirmed) 2. Try to start handle-server script 3. (Startup error message)  2022/10/26 03:04:46 CEST"" 25 Started new run. java.lang.UnsupportedOperationException at java.lang.Runtime.runFinalizersOnExit(Runtime.java:287) at java.lang.System.runFinalizersOnExit(System.java:1059) at net.handle.server.Main.initialize(Main.java:124) at net.handle.server.Main.main(Main.java:75) Shutting down  The reported errors in the mailing lists looks like DSpace 5 installations, but the handle server dependency looks the same in the DSpace 6 pom.xml, so probably also applies there? **Expected behavior** Normal startup of handle-server **KNOWN WORKAROUNDS** Either of these options will work, but neither is ideal: * Downgrade OpenJDK 8 to a version _prior to_ 1.8.0.352 (which is where this change was made) * Use OpenJDK 7 (which is no longer supported) **Related work** https://bugs.openjdk.org/browse/JDK-8287132 https://groups.google.com/g/dspace-community/c/B-865GtF93A config-file source-file source-file config-file other-file config-file config-file source-file config-file other-file config-file",no-bug,0.9
8355,DSpace,https://github.com/DSpace/DSpace/issues/8355,Enable all MetadataExportSearchIT tests (which were disabled in 7.3),"**Describe the bug** Follow-up work to #8037. In #8037, we found that the integration tests added in [`MetadataExportSearchIT`](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/test/java/org/dspace/app/bulkedit/MetadataExportSearchIT.java) reliably _succeeded_ when run locally, but always _failed_ when run in our GitHub CI environment. We were unable to find a way to solve the consistent failures in GitHub CI, but decided to move this feature forward with the ITs disabled (especially since the ITs succeeded for all developers locally). This ticket is a reminder that we **must** find a way to enable these ITs & determine the cause of the failures in GitHub CI. It likely is an environment-specific issue, but it's unclear if that environment-specific issue is in the main code or in the ITs themselves.",test-file | test-file,"Enable all MetadataExportSearchIT tests (which were disabled in 7.3) **Describe the bug** Follow-up work to #8037. In #8037, we found that the integration tests added in [`MetadataExportSearchIT`](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/test/java/org/dspace/app/bulkedit/MetadataExportSearchIT.java) reliably _succeeded_ when run locally, but always _failed_ when run in our GitHub CI environment. We were unable to find a way to solve the consistent failures in GitHub CI, but decided to move this feature forward with the ITs disabled (especially since the ITs succeeded for all developers locally). This ticket is a reminder that we **must** find a way to enable these ITs & determine the cause of the failures in GitHub CI. It likely is an environment-specific issue, but it's unclear if that environment-specific issue is in the main code or in the ITs themselves. test-file test-file",no-bug,0.9
3713,DSpace,https://github.com/DSpace/DSpace/issues/3713,[DS-338] Bitstream download allows caching of content that requires authorization to read,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-338"">[DS-338]</a> created by lcs</i> <p>The XMLUI requests to retrieve the contents of a Bitstream set an ""Expires"" header in the response with a very long time, which itself looks like a bug (the time is 60 hours, when the intent appears to be 1 hour). The other problem with this is that it sets ""Expires:"" even when the content is only accessible through authorization, which results in the following bug caused by aggressive browser caching: (this works best with a Bitstream that renders in the browser, such as an image or plain text)</p> <p>1. Clear browser history (in Firefox 3, use Tools->Clear private data dialog)<br/> 2. Logout of DSpace UI if logged in.<br/> 3. Attempt to view a Bitstream that does not have anonymous READ access; you'll be redirected to the Login page.<br/> 4. Login, get redirected to the Bitstream. Observe that its URL is the DSpace home page, however, e.g.<br/> <a href=""http://dspace.my.edu/xmlui"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://dspace.my.edu/xmlui</a><br/> 5. If you check your browser's cache at this point (visit URL about:cache?device=disk in Firefox3) observe that the content of this page is cached with an expiry time of 60 hours from now.<br/> 6. Now go to another page such as <a href=""http://dspace.my.edu/xmlui/community-list"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://dspace.my.edu/xmlui/community-list</a> and click ""Logout"".<br/> 7. Visit the home page (without trailing /) <a href=""http://dspace.my.edu/xmlui"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://dspace.my.edu/xmlui</a> and observe you're looking at the protected Bitstream. </p> <p>The attached patch fixes this behavior by skipping the ""Expires:"" response header completely when the Bitstream is not anonymously readable. It also shortens the cache time to 1 hour, which will still prevent frequent reloads from loading the server.</p>",source-file,"[DS-338] Bitstream download allows caching of content that requires authorization to read <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-338"">[DS-338]</a> created by lcs</i> <p>The XMLUI requests to retrieve the contents of a Bitstream set an ""Expires"" header in the response with a very long time, which itself looks like a bug (the time is 60 hours, when the intent appears to be 1 hour). The other problem with this is that it sets ""Expires:"" even when the content is only accessible through authorization, which results in the following bug caused by aggressive browser caching: (this works best with a Bitstream that renders in the browser, such as an image or plain text)</p> <p>1. Clear browser history (in Firefox 3, use Tools->Clear private data dialog)<br/> 2. Logout of DSpace UI if logged in.<br/> 3. Attempt to view a Bitstream that does not have anonymous READ access; you'll be redirected to the Login page.<br/> 4. Login, get redirected to the Bitstream. Observe that its URL is the DSpace home page, however, e.g.<br/> <a href=""http://dspace.my.edu/xmlui"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://dspace.my.edu/xmlui</a><br/> 5. If you check your browser's cache at this point (visit URL about:cache?device=disk in Firefox3) observe that the content of this page is cached with an expiry time of 60 hours from now.<br/> 6. Now go to another page such as <a href=""http://dspace.my.edu/xmlui/community-list"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://dspace.my.edu/xmlui/community-list</a> and click ""Logout"".<br/> 7. Visit the home page (without trailing /) <a href=""http://dspace.my.edu/xmlui"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://dspace.my.edu/xmlui</a> and observe you're looking at the protected Bitstream. </p> <p>The attached patch fixes this behavior by skipping the ""Expires:"" response header completely when the Bitstream is not anonymously readable. It also shortens the cache time to 1 hour, which will still prevent frequent reloads from loading the server.</p> source-file",bug,0.9
3762,DSpace,https://github.com/DSpace/DSpace/issues/3762,[DS-388] Item importer - new option to enable workflow notification emails,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-388"">[DS-388]</a> created by stuartlewis</i> <p>When importing items using the item importer, no notification emails are sent if importing with the -w 'workflow' option.</p>",source-file,"[DS-388] Item importer - new option to enable workflow notification emails <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-388"">[DS-388]</a> created by stuartlewis</i> <p>When importing items using the item importer, no notification emails are sent if importing with the -w 'workflow' option.</p> source-file",no-bug,0.8
8661,DSpace,https://github.com/DSpace/DSpace/issues/8661,Warning xsl:stylesheet when doing OAI import -c,"**Describe the bug** When performing a `oai import -c` action, an warning is shown. I had the same issue when reviewing this PR: https://github.com/DSpace/DSpace/pull/2756#issuecomment-852967636 and the same still occurs today with DS 7.5-snapshot with a migrated repository.  OAI 2.0 manager action started Clearing index Index cleared Using full import. Full import Warning at xsl:stylesheet on line 14 column 35 Unrecognized version 1.1: treated as 1.0 Total: 984 items Total: 1 items Purging cached OAI responses. OAI 2.0 manager action ended. It took 75 seconds.  **To Reproduce** Steps to reproduce the behavior: 1. I just did a `[dspace]/bin/dspace oai import -c` with migrated content. 2. I've also tried docker `docker-compose -f cli.yml run --rm dspace-cli oai import -c` According to https://github.com/DSpace/DSpace/pull/2756#issuecomment-852967636 this issue started occurring with this PR. **Expected behavior** No warning shown. **Related work** This issue has been around: https://github.com/DSpace/DSpace/pull/2756#issuecomment-852967636 https://github.com/DSpace/DSpace/pull/2856#issuecomment-933701753",other-file | other-file,"Warning xsl:stylesheet when doing OAI import -c **Describe the bug** When performing a `oai import -c` action, an warning is shown. I had the same issue when reviewing this PR: https://github.com/DSpace/DSpace/pull/2756#issuecomment-852967636 and the same still occurs today with DS 7.5-snapshot with a migrated repository.  OAI 2.0 manager action started Clearing index Index cleared Using full import. Full import Warning at xsl:stylesheet on line 14 column 35 Unrecognized version 1.1: treated as 1.0 Total: 984 items Total: 1 items Purging cached OAI responses. OAI 2.0 manager action ended. It took 75 seconds.  **To Reproduce** Steps to reproduce the behavior: 1. I just did a `[dspace]/bin/dspace oai import -c` with migrated content. 2. I've also tried docker `docker-compose -f cli.yml run --rm dspace-cli oai import -c` According to https://github.com/DSpace/DSpace/pull/2756#issuecomment-852967636 this issue started occurring with this PR. **Expected behavior** No warning shown. **Related work** This issue has been around: https://github.com/DSpace/DSpace/pull/2756#issuecomment-852967636 https://github.com/DSpace/DSpace/pull/2856#issuecomment-933701753 other-file other-file",no-bug,0.9
3415,DSpace,https://github.com/DSpace/DSpace/issues/3415,[DS-37] Submission Forms don't preserve order of values - ID: 2541285,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-37"">[DS-37]</a> created by kipkorir2008</i> <p>This bug occurs in 1.5.x XMLUI and JSPUI.</p> <p>Essentially the Describe (metadata entry) page of the submission process<br/> doesn't preserve the order that values are entered in multi-valued fields.</p> <p>This is especially problematic for Author names. During a submission<br/> author names are reordered such that the <b>first</b> author listed is that<br/> <b>last</b> one that you enter during the submission process.</p> <p>This patch modifies the org.dspace.submit.step.DescribeStep class (the<br/> processing class) in the dspace-api module, so that it will preserve the<br/> order in which values are entered. This way the <b>first</b> author listed will<br/> always be the <b>first</b> author entered, etc.</p> <p>This patch works for both the XMLUI and JSPUI since both of these<br/> interfaces utilize this same backend prorcessing class to save all values<br/> entered during the Describe step.</p> <p>This patch was built off the latest code in the dspace-1_5_x branch of SVN<br/> (as of 2009-Jan-27).</p>",other-file,"[DS-37] Submission Forms don't preserve order of values - ID: 2541285 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-37"">[DS-37]</a> created by kipkorir2008</i> <p>This bug occurs in 1.5.x XMLUI and JSPUI.</p> <p>Essentially the Describe (metadata entry) page of the submission process<br/> doesn't preserve the order that values are entered in multi-valued fields.</p> <p>This is especially problematic for Author names. During a submission<br/> author names are reordered such that the <b>first</b> author listed is that<br/> <b>last</b> one that you enter during the submission process.</p> <p>This patch modifies the org.dspace.submit.step.DescribeStep class (the<br/> processing class) in the dspace-api module, so that it will preserve the<br/> order in which values are entered. This way the <b>first</b> author listed will<br/> always be the <b>first</b> author entered, etc.</p> <p>This patch works for both the XMLUI and JSPUI since both of these<br/> interfaces utilize this same backend prorcessing class to save all values<br/> entered during the Describe step.</p> <p>This patch was built off the latest code in the dspace-1_5_x branch of SVN<br/> (as of 2009-Jan-27).</p> other-file",no-bug,0.9
3074,DSpace,https://github.com/DSpace/DSpace/issues/3074,openaire4.xsl has wrong ISO 639-3 code for Japanese,"**Describe the bug** openaire4.xsl has wrong ISO 639-3 code for Japan ([link to source code](https://github.com/DSpace/DSpace/blob/0c5e68c5e3db788cd0e88a9bd5461469500f3952/dspace/config/crosswalks/oai/transformers/openaire4.xsl#L57)). dc.language.iso conversion from 'ja' should be to 'jpn', not 'jap'. **Expected behavior** dc.language.iso value of 'ja' should be converted to 'jpn'",other-file | other-file,"openaire4.xsl has wrong ISO 639-3 code for Japanese **Describe the bug** openaire4.xsl has wrong ISO 639-3 code for Japan ([link to source code](https://github.com/DSpace/DSpace/blob/0c5e68c5e3db788cd0e88a9bd5461469500f3952/dspace/config/crosswalks/oai/transformers/openaire4.xsl#L57)). dc.language.iso conversion from 'ja' should be to 'jpn', not 'jap'. **Expected behavior** dc.language.iso value of 'ja' should be converted to 'jpn' other-file other-file",no-bug,0.9
8935,DSpace,https://github.com/DSpace/DSpace/issues/8935,webui.browse.link CrossLinks fails when multiple exact matches with different indexes are configured,"**Describe the bug** This bug occurs in DSpace 7.5 and 7.6. The ""dspace/config/dspace.cfg"" file allows multiple ""webui.browse.link"" entries to be added of the form:  webui.browse.link.<n> = <index name>:<display column metadata>  The `<display column metadata>` can be specified exactly (""dc.genre"") or in a wildcard format (""dc.contributor.*"") When there are multiple entries using different indexes with ""exact"" names, for example:  webui.browse.link.1 = author:dc.contributor.author webui.browse.link.2 = type:dc.genre  the correct index is not returned for one of the metadata types. **To Reproduce** 1) Checkout the DSpace 7.6 codebase:  $ git clone https://github.com/DSpace/DSpace.git $ cd DSpace $ git checkout dspace-7.6  2) Create a ""dspace-api/src/test/java/org/dspace/browse/CrossLinksTest.java"" file  $ mkdir dspace-api/src/test/java/org/dspace/browse/ $ vi dspace-api/src/test/java/org/dspace/browse/CrossLinksTest.java  with the following contents:  package org.dspace.browse; import static org.junit.Assert.assertEquals; import org.dspace.AbstractDSpaceTest; import org.dspace.services.ConfigurationService; import org.dspace.utils.DSpace; import org.junit.Test; public class CrossLinksTest extends AbstractDSpaceTest { @Test public void testFindLinkType_MultipleExactMatches() throws Exception { ConfigurationService configurationService = new DSpace().getConfigurationService(); configurationService.setProperty(""webui.browse.link.1"", ""author:dc.contributor.author""); configurationService.setProperty(""webui.browse.link.2"", ""type:dc.genre""); CrossLinks crossLinks = new CrossLinks(); assertEquals(""author"",crossLinks.findLinkType(""dc.contributor.author"")); assertEquals(""type"",crossLinks.findLinkType(""dc.genre"")); } }  3) Run the unit test:  $ mvn package -Ptest-environment -DfailIfNoTests=false -DskipUnitTests=false -Dtest=org.dspace.browse.CrossLinksTest  This test will fail in one of two ways: 1) The first ""assertEquals"" fails, because the actual value ""type"" does not match the expected value ""author"" or 2) The second ""assertEquals"" fails, because the actual value ""author"" does not match the expected value ""type"" Both tests are needed (and either could fail), because the failure is triggered by the order in which the keys in the HashMap used by the ""org.dspace.browse.CrossLinks"" class are returned from the ""keySet()"" method, which is non-deterministic. **Expected behavior** That the above JUnit test will pass successfully. The above unit test is equivalent to add the following lines to the ""dspace/config/dspace.cfg"":  webui.browse.link.1 = author:dc.contributor.author webui.browse.link.2 = type:dc.genre  where ""author"" and ""type"" are defined in the ""webui.browse.index"" entries. When displaying item metadata on the ""simple"" item page, the ""Author"" and ""Type"" entries will be hyperlinked, but one of the hyperlinks will be to the wrong index. **Related work** Pull Request #8936 This bug appears to be a caused by a line 111 in the ""org.dspace.browse.CrossLinks"" class: https://github.com/DSpace/DSpace/blob/5a43e6bcf1adb1e053be4dd46b566c604923c8a9/dspace-api/src/main/java/org/dspace/browse/CrossLinks.java#L110-L112 where the `return links.get(key);` should likely be `return links.get(metadata);` **Possible Workaround** For some use cases, it might be possible to workaround this bug by using a wildcard match instead of an exact match. For example, for the above configuration, using:  webui.browse.link.1 = author:dc.contributor.author.* webui.browse.link.2 = type:dc.genre.*  enables the correct linking to be performed. This workaround, however, risks generating links more metadata fields than intended, as a wildcard match is now being used.",source-file | test-file | source-file | test-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | test-file | test-file | other-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | other-file | other-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | config-file | other-file | other-file | config-file | other-file | other-file | other-file | config-file | config-file | other-file | other-file | other-file | other-file | config-file | other-file | config-file | config-file | config-file | container-file | other-file | other-file | other-file | config-file | config-file | config-file | test-file | test-file | config-file | config-file | config-file | config-file | config-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | database-file | database-file | database-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | source-file | config-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | other-file | other-file | config-file | test-file | test-file | config-file,"webui.browse.link CrossLinks fails when multiple exact matches with different indexes are configured **Describe the bug** This bug occurs in DSpace 7.5 and 7.6. The ""dspace/config/dspace.cfg"" file allows multiple ""webui.browse.link"" entries to be added of the form:  webui.browse.link.<n> = <index name>:<display column metadata>  The `<display column metadata>` can be specified exactly (""dc.genre"") or in a wildcard format (""dc.contributor.*"") When there are multiple entries using different indexes with ""exact"" names, for example:  webui.browse.link.1 = author:dc.contributor.author webui.browse.link.2 = type:dc.genre  the correct index is not returned for one of the metadata types. **To Reproduce** 1) Checkout the DSpace 7.6 codebase:  $ git clone https://github.com/DSpace/DSpace.git $ cd DSpace $ git checkout dspace-7.6  2) Create a ""dspace-api/src/test/java/org/dspace/browse/CrossLinksTest.java"" file  $ mkdir dspace-api/src/test/java/org/dspace/browse/ $ vi dspace-api/src/test/java/org/dspace/browse/CrossLinksTest.java  with the following contents:  package org.dspace.browse; import static org.junit.Assert.assertEquals; import org.dspace.AbstractDSpaceTest; import org.dspace.services.ConfigurationService; import org.dspace.utils.DSpace; import org.junit.Test; public class CrossLinksTest extends AbstractDSpaceTest { @Test public void testFindLinkType_MultipleExactMatches() throws Exception { ConfigurationService configurationService = new DSpace().getConfigurationService(); configurationService.setProperty(""webui.browse.link.1"", ""author:dc.contributor.author""); configurationService.setProperty(""webui.browse.link.2"", ""type:dc.genre""); CrossLinks crossLinks = new CrossLinks(); assertEquals(""author"",crossLinks.findLinkType(""dc.contributor.author"")); assertEquals(""type"",crossLinks.findLinkType(""dc.genre"")); } }  3) Run the unit test:  $ mvn package -Ptest-environment -DfailIfNoTests=false -DskipUnitTests=false -Dtest=org.dspace.browse.CrossLinksTest  This test will fail in one of two ways: 1) The first ""assertEquals"" fails, because the actual value ""type"" does not match the expected value ""author"" or 2) The second ""assertEquals"" fails, because the actual value ""author"" does not match the expected value ""type"" Both tests are needed (and either could fail), because the failure is triggered by the order in which the keys in the HashMap used by the ""org.dspace.browse.CrossLinks"" class are returned from the ""keySet()"" method, which is non-deterministic. **Expected behavior** That the above JUnit test will pass successfully. The above unit test is equivalent to add the following lines to the ""dspace/config/dspace.cfg"":  webui.browse.link.1 = author:dc.contributor.author webui.browse.link.2 = type:dc.genre  where ""author"" and ""type"" are defined in the ""webui.browse.index"" entries. When displaying item metadata on the ""simple"" item page, the ""Author"" and ""Type"" entries will be hyperlinked, but one of the hyperlinks will be to the wrong index. **Related work** Pull Request #8936 This bug appears to be a caused by a line 111 in the ""org.dspace.browse.CrossLinks"" class: https://github.com/DSpace/DSpace/blob/5a43e6bcf1adb1e053be4dd46b566c604923c8a9/dspace-api/src/main/java/org/dspace/browse/CrossLinks.java#L110-L112 where the `return links.get(key);` should likely be `return links.get(metadata);` **Possible Workaround** For some use cases, it might be possible to workaround this bug by using a wildcard match instead of an exact match. For example, for the above configuration, using:  webui.browse.link.1 = author:dc.contributor.author.* webui.browse.link.2 = type:dc.genre.*  enables the correct linking to be performed. This workaround, however, risks generating links more metadata fields than intended, as a wildcard match is now being used. source-file test-file source-file test-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file test-file test-file other-file source-file test-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file other-file other-file other-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file other-file config-file other-file other-file config-file other-file other-file other-file config-file config-file other-file other-file other-file other-file config-file other-file config-file config-file config-file container-file other-file other-file other-file config-file config-file config-file test-file test-file config-file config-file config-file config-file config-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file database-file database-file database-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file source-file config-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file other-file other-file other-file other-file other-file other-file other-file other-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file other-file other-file config-file test-file test-file config-file",no-bug,0.9
9202,DSpace,https://github.com/DSpace/DSpace/issues/9202,Crossref import: empty ImportRecords for failing searches,"**Describe the bug** On the current `main` branch, attempting to import a nonexistent DOI (or a DataCite DOI) via Crossref results in a spurious phantom item without a title or metadata. **To Reproduce** Steps to reproduce the behavior: 1. Install DSpace from the git repos (I used docker to setup an empty DB) 2. Add an administrator, community and collection 3. Attempt to import DOI 10.34785/j014.2022.357 (a DataCite DOI) using the Crossref importer. ![image](https://github.com/DSpace/DSpace/assets/42467687/8f30e980-bfc1-4987-93ae-8a4923dd58be) **Expected behavior** A ""No Search Results"" message, like this: ![image](https://github.com/DSpace/DSpace/assets/42467687/ea27aa79-8f02-4bf4-baf1-bcf1bb16ea0a) **Related work** This is related to #9132 : without fixing this issue, there will be extra results produced by the multiple importer. I have a fix here for this issue and will submit a PR.",source-file | source-file,"Crossref import: empty ImportRecords for failing searches **Describe the bug** On the current `main` branch, attempting to import a nonexistent DOI (or a DataCite DOI) via Crossref results in a spurious phantom item without a title or metadata. **To Reproduce** Steps to reproduce the behavior: 1. Install DSpace from the git repos (I used docker to setup an empty DB) 2. Add an administrator, community and collection 3. Attempt to import DOI 10.34785/j014.2022.357 (a DataCite DOI) using the Crossref importer. ![image](https://github.com/DSpace/DSpace/assets/42467687/8f30e980-bfc1-4987-93ae-8a4923dd58be) **Expected behavior** A ""No Search Results"" message, like this: ![image](https://github.com/DSpace/DSpace/assets/42467687/ea27aa79-8f02-4bf4-baf1-bcf1bb16ea0a) **Related work** This is related to #9132 : without fixing this issue, there will be extra results produced by the multiple importer. I have a fix here for this issue and will submit a PR. source-file source-file",no-bug,0.8
3094,DSpace,https://github.com/DSpace/DSpace/issues/3094,Poor support for IPv6,**Describe the bug** `org.dspace.statistics.util.DnsLookup` explicitly does not handle IPv6 addresses. This was filling up the log with error messages and throwing `NullPointerException`s when recording access events. `org.dspace.statistics.util.IPTable` also explicitly does not handle IPv6 addresses. It was throwing `IPFormatException`s when an IPv6 address was added or checked. All of this was obscuring the cause of a problem with logging in from a dual-stacked host (which is a separate issue). **To Reproduce** Steps to reproduce the behavior: 1. Ensure that `jwt.login.token.include.ip = true` 2. Log in via IPv6. **Expected behavior** IPv6 addresses are accepted without problems.,source-file | source-file | test-file | test-file | test-file | source-file,Poor support for IPv6 **Describe the bug** `org.dspace.statistics.util.DnsLookup` explicitly does not handle IPv6 addresses. This was filling up the log with error messages and throwing `NullPointerException`s when recording access events. `org.dspace.statistics.util.IPTable` also explicitly does not handle IPv6 addresses. It was throwing `IPFormatException`s when an IPv6 address was added or checked. All of this was obscuring the cause of a problem with logging in from a dual-stacked host (which is a separate issue). **To Reproduce** Steps to reproduce the behavior: 1. Ensure that `jwt.login.token.include.ip = true` 2. Log in via IPv6. **Expected behavior** IPv6 addresses are accepted without problems. source-file source-file test-file test-file test-file source-file,no-bug,0.9
8792,DSpace,https://github.com/DSpace/DSpace/issues/8792,Exporting search results via CSV using a *very* long search query fails,"**Describe the bug** Exporting search results via CSV using a *very* long search query fails without specifying the problem. Searching itself works, but when trying to export the reults an error is shown. The query (like all process parameters) is inserted into the `public.process` table, into the column `parameters`. This column is limited to 512 characters, causing the process creation to fail. **To Reproduce** Steps to reproduce the behavior: 1. Open the search page: https://demo7.dspace.org/search 2. Enter a llong search query (> 512 characters) 3. Click search 4. Search results are shown 5. Click the CSV export button 6. The export fails with the error message ""Starting the export has failed"" **Expected behavior** The export should export the results as usual or document and display the limitation to users. **Related work** This is similar to the issue: #8730, fixed in #8755",source-file | database-file | source-file | database-file | database-file | database-file,"Exporting search results via CSV using a *very* long search query fails **Describe the bug** Exporting search results via CSV using a *very* long search query fails without specifying the problem. Searching itself works, but when trying to export the reults an error is shown. The query (like all process parameters) is inserted into the `public.process` table, into the column `parameters`. This column is limited to 512 characters, causing the process creation to fail. **To Reproduce** Steps to reproduce the behavior: 1. Open the search page: https://demo7.dspace.org/search 2. Enter a llong search query (> 512 characters) 3. Click search 4. Search results are shown 5. Click the CSV export button 6. The export fails with the error message ""Starting the export has failed"" **Expected behavior** The export should export the results as usual or document and display the limitation to users. **Related work** This is similar to the issue: #8730, fixed in #8755 source-file database-file source-file database-file database-file database-file",bug,0.9
8585,DSpace,https://github.com/DSpace/DSpace/issues/8585,Submitter information missing in provenance metadata,"Items that are submitted to collections that allow immediate archiving are missing ""Submitted by"" text from provenance metadata. This is closely related to https://github.com/DSpace/DSpace/issues/7667 **Describe the solution you'd like** Similar to items that go through a workflow, there should be provenance metadata that contains this text along with the -person who submitted the item. **Describe alternatives or workarounds you've considered** This was seemingly fixed in version 6.4, but not in version 7.x **Additional context** In XmlWorkflowServiceImpl.java, this is accomplished in the method recordStart(). However, this method is never reached when there is not a valid workflow step -- the item goes directly to the archive and the desired text is not added to provenance.",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | other-file | other-file | other-file | config-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | test-file | test-file | other-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | other-file | other-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | config-file | other-file | other-file | config-file | other-file | other-file | other-file | config-file | config-file | other-file | other-file | other-file | other-file | config-file | other-file | config-file | config-file | config-file | container-file | other-file | other-file | other-file | config-file | config-file | config-file | test-file | test-file | config-file | source-file | test-file,"Submitter information missing in provenance metadata Items that are submitted to collections that allow immediate archiving are missing ""Submitted by"" text from provenance metadata. This is closely related to https://github.com/DSpace/DSpace/issues/7667 **Describe the solution you'd like** Similar to items that go through a workflow, there should be provenance metadata that contains this text along with the -person who submitted the item. **Describe alternatives or workarounds you've considered** This was seemingly fixed in version 6.4, but not in version 7.x **Additional context** In XmlWorkflowServiceImpl.java, this is accomplished in the method recordStart(). However, this method is never reached when there is not a valid workflow step -- the item goes directly to the archive and the desired text is not added to provenance. source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file test-file test-file test-file test-file other-file other-file other-file config-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file test-file test-file other-file source-file test-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file other-file other-file other-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file other-file config-file other-file other-file config-file other-file other-file other-file config-file config-file other-file other-file other-file other-file config-file other-file config-file config-file config-file container-file other-file other-file other-file config-file config-file config-file test-file test-file config-file source-file test-file",no-bug,0.9
9636,DSpace,https://github.com/DSpace/DSpace/issues/9636,import projects by doi from DataCite,"**Is your feature request related to a problem? Please describe.** DataCite support some resourceType for Projects. `https://api.datacite.org/dois?query=types.resourceTypeGeneral:Other%20AND%20types.resourceType:Project` Currently there are a handful of universities populating this type of doi's; According to the datacite [FAQ](https://datacite.org/raid/)'s the upcoming `RAid`-identifier aims to use this resourceSubType and may have some own GeneralType in some of the upcoming versions. **Describe the solution you'd like** We would like some importer for doi's from datacite allowing to import projects from some doi source. **Describe alternatives or workarounds you've considered** Currently (OR2024) there are only 554 projects doi's in datacite, but this number could increase in the next years. This feature could help to increase the acceptance of project identifiers. Directly accessing the Raid identifier and it's id (https://datacite.org/raid/) could be some option. But currently (OR2024) there is no open released API available. Also researchers might directly recognize the structure of some raid which is aligned to the doi schema. So in future it might be needed to name the import source `doi/raid`. The work necessary would be a copy and modification of the current datacite import implementation and some additional filterquery mechanism for the resource-type. **Additional context** Also by now these Projects can be imported as Publication which is slightly wrong. Update 2024-12-11: The current datacite schema 4.6 as released on 2024-12-05 contains some new resourceTypeGeneral:Project . `https://api.datacite.org/dois?query=types.resourceTypeGeneral:Project` `https://api.datacite.org/dois?query=(types.resourceTypeGeneral:Other%20AND%20types.resourceType:Project)%20OR%20types.resourceTypeGeneral:Project`",other-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | other-file | config-file | config-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | other-file | config-file | config-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | other-file | config-file | config-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | test-file | test-file | other-file | config-file | config-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | test-file | test-file | other-file | config-file | config-file,"import projects by doi from DataCite **Is your feature request related to a problem? Please describe.** DataCite support some resourceType for Projects. `https://api.datacite.org/dois?query=types.resourceTypeGeneral:Other%20AND%20types.resourceType:Project` Currently there are a handful of universities populating this type of doi's; According to the datacite [FAQ](https://datacite.org/raid/)'s the upcoming `RAid`-identifier aims to use this resourceSubType and may have some own GeneralType in some of the upcoming versions. **Describe the solution you'd like** We would like some importer for doi's from datacite allowing to import projects from some doi source. **Describe alternatives or workarounds you've considered** Currently (OR2024) there are only 554 projects doi's in datacite, but this number could increase in the next years. This feature could help to increase the acceptance of project identifiers. Directly accessing the Raid identifier and it's id (https://datacite.org/raid/) could be some option. But currently (OR2024) there is no open released API available. Also researchers might directly recognize the structure of some raid which is aligned to the doi schema. So in future it might be needed to name the import source `doi/raid`. The work necessary would be a copy and modification of the current datacite import implementation and some additional filterquery mechanism for the resource-type. **Additional context** Also by now these Projects can be imported as Publication which is slightly wrong. Update 2024-12-11: The current datacite schema 4.6 as released on 2024-12-05 contains some new resourceTypeGeneral:Project . `https://api.datacite.org/dois?query=types.resourceTypeGeneral:Project` `https://api.datacite.org/dois?query=(types.resourceTypeGeneral:Other%20AND%20types.resourceType:Project)%20OR%20types.resourceTypeGeneral:Project` other-file source-file source-file source-file config-file test-file test-file test-file other-file config-file config-file source-file source-file source-file config-file test-file test-file test-file other-file config-file config-file source-file source-file source-file config-file test-file test-file test-file other-file config-file config-file source-file source-file source-file config-file test-file test-file test-file test-file test-file other-file config-file config-file source-file source-file source-file config-file test-file test-file test-file test-file test-file other-file config-file config-file",no-bug,0.9
8736,DSpace,https://github.com/DSpace/DSpace/issues/8736,MetadataValues' list doesn't respect ordering after been modified,"**Description** The bug occurs whenever we modify the `metadata` list inside a `DspaceObject`. If we add or remove some elements, the remaining ones won't be re-ordered. Moreover, fot the `ItemServiceImpl` the order of the `metadata` depends on the method used: - `ItemServiceImpl#getMetadata` if used without `boolean` parameter will always return an ordered list - `ItemServiceImpl#getMetadata` if used with `boolean` parameter the returned list order depens on this value: - `true` The list will be ordered by `MetadataField` and then `Place` - `false` The list won't have a defined ordering. **To Reproduce** After adding a `metadata`, without saving and then reloading the list, the `DspaceObject#getMetadata` will return a filtered list with wrong order. If a `MetadataValue` has been added, without taking in count its place, it will be returned as last value. **Expected behavior** A filtered list by `MetadataField` should always be returned with the same order, and its order should be compatible with the one expected and declared by the _JPA Annotation_ `@OrderBy` here `DspaceObject#metadata`. **Related Work** [Here is](https://github.com/4Science/DSpace/actions/runs/4513210596/jobs/7947734088) a failing test with the expected behavior of the `ItemServiceImpl`.",test-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file,"MetadataValues' list doesn't respect ordering after been modified **Description** The bug occurs whenever we modify the `metadata` list inside a `DspaceObject`. If we add or remove some elements, the remaining ones won't be re-ordered. Moreover, fot the `ItemServiceImpl` the order of the `metadata` depends on the method used: - `ItemServiceImpl#getMetadata` if used without `boolean` parameter will always return an ordered list - `ItemServiceImpl#getMetadata` if used with `boolean` parameter the returned list order depens on this value: - `true` The list will be ordered by `MetadataField` and then `Place` - `false` The list won't have a defined ordering. **To Reproduce** After adding a `metadata`, without saving and then reloading the list, the `DspaceObject#getMetadata` will return a filtered list with wrong order. If a `MetadataValue` has been added, without taking in count its place, it will be returned as last value. **Expected behavior** A filtered list by `MetadataField` should always be returned with the same order, and its order should be compatible with the one expected and declared by the _JPA Annotation_ `@OrderBy` here `DspaceObject#metadata`. **Related Work** [Here is](https://github.com/4Science/DSpace/actions/runs/4513210596/jobs/7947734088) a failing test with the expected behavior of the `ItemServiceImpl`. test-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file",no-bug,0.9
3544,DSpace,https://github.com/DSpace/DSpace/issues/3544,[DS-169] Eliminate the need for server restarts,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-169"">[DS-169]</a> created by kipkorir2008</i> <p>desired features from salo discussion</p>",config-file | config-file,"[DS-169] Eliminate the need for server restarts <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-169"">[DS-169]</a> created by kipkorir2008</i> <p>desired features from salo discussion</p> config-file config-file",no-bug,0.9
3454,DSpace,https://github.com/DSpace/DSpace/issues/3454,[DS-77] Extract AbstractBrowseDAO superclass - ID: 1991551,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-77"">[DS-77]</a> created by kipkorir2008</i> <p>This patch removes duplicate code from BrowseDAOOracle and<br/> BrowseDAOPostgres by extracting common code elements to an abstract<br/> superclass AbstractBrowseDAO.</p> <p>More work could be done with this patch to make the concrete impls even<br/> more simple, but this is a good enough start.</p> <p>This patch should apply cleanly to r2959 of the 1.5.x branch.</p>",config-file | config-file,"[DS-77] Extract AbstractBrowseDAO superclass - ID: 1991551 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-77"">[DS-77]</a> created by kipkorir2008</i> <p>This patch removes duplicate code from BrowseDAOOracle and<br/> BrowseDAOPostgres by extracting common code elements to an abstract<br/> superclass AbstractBrowseDAO.</p> <p>More work could be done with this patch to make the concrete impls even<br/> more simple, but this is a good enough start.</p> <p>This patch should apply cleanly to r2959 of the 1.5.x branch.</p> config-file config-file",no-bug,0.9
9664,DSpace,https://github.com/DSpace/DSpace/issues/9664,Conflicts between default DSpace OpenAIREv4 and Creative Commons integrations,"**Describe the bug** If you enable OpenAIREv4 support (including the submission forms) out of the box, together with the DSpace Creative Commons integration, there is a conflict out of the box. **Metadata schema difference/conflict** The creative commons integration stores the CC url into dc.rights.uri The OpenAIRE integration integration stores the CC url into oaire.license.condition **CC URI values difference/conflict** The creative commons integration allows the user to define a license based on answering questions, where a license URL is provided by the creative commons API, as the output to store in the metadata. The OpenAIRE integration however, relies on a subset of what's possible to configure with creative commons, as a fixed set of values offered by a dropdown selector as openaire_license_types: https://github.com/DSpace/DSpace/blob/main/dspace/config/submission-forms.xml#L1542C40-L1542C62 **dc.rights** Both features use dc.rights, but OpenAIRE supplies a very specific vocabulary here that uses purl urls as the values: https://github.com/DSpace/DSpace/blob/main/dspace/config/submission-forms.xml#L1909 **Solution path 1: Just clarify this in the documentation** One option could be to just make it clear that you can't just enable both features, but that you'll have to configure one of the two to be compatible with the other. **Solution path 2: make the creative commons integration a mandatory piece of OpenAIRE** Another option that I can think of, is that the docs should clearly state that the creative commons integration has to be enabled & that the OpenAIRE crosswalk would read from dc.rights.uri, and not anymore from oaire.license.condition.",config-file | config-file,"Conflicts between default DSpace OpenAIREv4 and Creative Commons integrations **Describe the bug** If you enable OpenAIREv4 support (including the submission forms) out of the box, together with the DSpace Creative Commons integration, there is a conflict out of the box. **Metadata schema difference/conflict** The creative commons integration stores the CC url into dc.rights.uri The OpenAIRE integration integration stores the CC url into oaire.license.condition **CC URI values difference/conflict** The creative commons integration allows the user to define a license based on answering questions, where a license URL is provided by the creative commons API, as the output to store in the metadata. The OpenAIRE integration however, relies on a subset of what's possible to configure with creative commons, as a fixed set of values offered by a dropdown selector as openaire_license_types: https://github.com/DSpace/DSpace/blob/main/dspace/config/submission-forms.xml#L1542C40-L1542C62 **dc.rights** Both features use dc.rights, but OpenAIRE supplies a very specific vocabulary here that uses purl urls as the values: https://github.com/DSpace/DSpace/blob/main/dspace/config/submission-forms.xml#L1909 **Solution path 1: Just clarify this in the documentation** One option could be to just make it clear that you can't just enable both features, but that you'll have to configure one of the two to be compatible with the other. **Solution path 2: make the creative commons integration a mandatory piece of OpenAIRE** Another option that I can think of, is that the docs should clearly state that the creative commons integration has to be enabled & that the OpenAIRE crosswalk would read from dc.rights.uri, and not anymore from oaire.license.condition. config-file config-file",no-bug,0.9
3428,DSpace,https://github.com/DSpace/DSpace/issues/3428,[DS-50] LDAP+Active Directory authentication patch - ID: 2100378,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-50"">[DS-50]</a> created by kipkorir2008</i> <p>Thanks, Stuart -</p> <p>I'll submit the patch to the queue.<br/> You can grab a zip file that includes only the<br/> changed files here:<br/> <a href=""http://erwg.lib.auburn.edu/dspace-ldap_20080828.zip"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://erwg.lib.auburn.edu/dspace-ldap_20080828.zip</a></p> <p>The main changes were:</p> <p>*. Our A.D. setup does not allow anonymous bind,<br/> and also has user info scattered around the LDAP tree.<br/> To bind an arbitrary user, we pass a distinguished name<br/> of:<br/> DOMAIN\USER-ID<br/> rather than some LDAP path like cn=USER&ou=People&dc=<br/> We detect this case by allowing the admin<br/> to specify<br/> windows_domain:domain-name<br/> (something like that) as the LDAP object-context in dspace.cfg.</p> <p>*. Since our user info is scattered through an LDAP tree -<br/> I patched the ""lookup user info"" part of the code<br/> to specify a recursive JNDI search.<br/> Your last patch may have done the same thing.</p> <p>*. We would like a user that successfully authenticates against A.D.<br/> to automatically be given certain privileges.<br/> I setup the getSpecialGroups function to accept a list of group-ids in<br/> the<br/> ""ldap.dspace.autogroup""<br/> dspace.cfg parameter.</p> <p>*. I wanted to be able to run a standalone test case against the LDAP<br/> authenticate and search code, so I split out the 'DataFromLDAP'<br/> nested class to an external interface, and include a junit test case.<br/> Also added a few lines to pom.xml to help run the test with verbose<br/> logging, etc.</p> <p>Cheers,<br/> Reuben</p> <p Stuart Lewis <sdl@aber.ac.uk> 9/6/2008 7:57 AM <br/> Hi Reuben,</p> <p>Thanks for getting in touch. Ive got that email sitting in my inbox<br/> waiting<br/> for me to get around to replying to it - sorry it has taken a little<br/> while.</p> <p>What changes have you made to make it work with Active Directory?</p> <p>It would be great if you could formally submit your patch to the DSpace<br/> patch queue<br/> (<a href=""http://sourceforge.net/tracker/?atid=319984&group_id=19984&func=browse"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://sourceforge.net/tracker/?atid=319984&group_id=19984&func=browse</a>).<br/> There are a few of us working on a generic LDAP authenticator which will<br/> hopefully work with any AD / LDAP system, so it would be good to see what<br/> changes youve made to see if we can incorporate them too.</p> <p>Thanks,</p> <p>Stuart</p> <p>On 28/08/2008 16:14, ""Reuben Pasquini"" <rdp0004@auburn.edu> wrote:</p> <p>> Hello!<br/> ><br/> > I've put together a set of patches to the LDAPAuthentication<br/> > code to get it working against Active Directory at Auburn<br/> > University, support implicit-group member-ids in dspace.cfg,<br/> > and add a JUnit regression test.<br/> > I think the changes are backward compatable and generic,<br/> > but I've only tested the code in my environment.<br/> ><br/> > I hope that we can check this patch into the dspace repository.<br/> > An overview and svn diff follow, and a zip file with<br/> > the modified files is available here:<br/> > <a href=""http://erwg.lib.auburn.edu/dspace-ldap_20080828.zip"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://erwg.lib.auburn.edu/dspace-ldap_20080828.zip</a><br/> > Please take a look, and let me know what you think.<br/> ><br/> > Cheers,<br/> > Reuben<br/> ><br/> > <br/> ><br/> > Changes under dspace-api org.dspace.authentication.<br/> ><br/> > *. Moved the<br/> > LDAPAuthentication.SpeakerToLDAP<br/> > nested class out to its own non-nested interface<br/> > with a DefaultSpeakerToLDAP implementation.<br/> ><br/> > *. Refactored SpeakerToLDAP#ldapAuthenticate()<br/> > to return a DataFromLDAP POJO data object<br/> > rather than set object member variables.<br/> ><br/> > *. Implemented SpeakerToLDAPCase JUnit test-case<br/> > and PackageTestSuite classes to support simple<br/> > regression tests against SpeakerToLDAP implementations.<br/> > Modified pom.xml so that<br/> > 'mvn test'<br/> > runs with a verbose log4j setting.<br/> ><br/> > *. Modified the way SpeakToLDAP handles the<br/> > ldap.object_context<br/> > dspace.cfg configuration property so that<br/> > if the ldap.object_context matches<br/> > 'WINDOWS_DOMAIN:DOMAIN_NAME',<br/> > then LDAP attempts to bind with<br/> > 'DOMAIN_NAME\NETID'<br/> > rather than<br/> > 'cn=NETID,ldap.object_context'<br/> > . This change allows us to configure LDAP<br/> > to bind with Active Directory out of the box.<br/> ><br/> > *. Modifed the LDAP search for user-info to take a SearchControls<br/> > parameter that specifies a recursive tree-search under the<br/> > ldap.search_context<br/> > tree for a single user-object result.<br/> > Once again - this allows LDAPAuthenticate to work<br/> > with an Active Directory tree that has user objects<br/> > organized into different folders under a tree.<br/> ><br/> > *. Modified LDAPAuthentication.getSpecialGroups<br/> > to access the<br/> > ldap.dspace.autogroup<br/> > dspace.cfg configuration property<br/> > to get the group-ids that an LDAP-authenticated<br/> > user should be an implicit member of.<br/> > This makes it easy to configure a system where<br/> > every user that can authenticate can also<br/> > submit material to some collections.<br/> ><br/> > *. Changed some of the if/else nesting in<br/> > LDAPAuthentication.authenticate<br/> > so that instead of having something like<br/> > if () </p> { >  > return bla; > } else {<br/> > we have<br/> > if () {> > return bla;> } <p>>  // no else<br/> > and instead of<br/> > } else {<br/> > if () </p> { > return goo > } <p>> }<br/> > we just have<br/> > } else if () {<br/> > just to make the control flow a little<br/> > easier to look at.<br/> ><br/> > <br/> ><br/> > $ svn diff pom.xml src/test src/main/java/org/dspace/authenticate ><br/> > /tmp/bla<br/> ><br/> > Index: pom.xml<br/> > <br/> > &#8212; pom.xml (revision 2942)<br/> >  pom.xml (working copy)<br/> > @@ -61,6 +61,7 @@<br/> ><br/> ><br/> <url><a href=""http://dspace.svn.sourceforge.net/viewvc/dspace/branches/dspace-1_5_x/"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://dspace.svn.sourceforge.net/viewvc/dspace/branches/dspace-1_5_x/</a><br/> dsp<br/> > ace</url><br/> > </scm><br/> ><br/> > +<br/> > <!--<br/> > Runtime and Compile Time dependencies for DSpace.<br/> > --><br/> > @@ -188,6 +189,23 @@<br/> > <groupId>com.ibm.icu</groupId><br/> > <artifactId>icu4j</artifactId><br/> > </dependency><br/> > + <dependency><br/> > + <groupId>junit</groupId><br/> > + <artifactId>junit</artifactId><br/> > + <version>3.8.1</version><br/> > + <scope>test</scope><br/> > + </dependency><br/> > </dependencies><br/> ><br/> > -</project><br/> > \ No newline at end of file<br/> > +<build><br/> > + <testResources><br/> > + <testResource><br/> > + <directory>src/test/resources</directory><br/> > + <includes><br/> > + <include>log4j.properties</include><br/> > + </includes><br/> > + </testResource><br/> > + </testResources><br/> > + </build><br/> > +<br/> > +</project><br/> > Index: src/test/java/org/dspace/authenticate/SpeakerToLDAPCase.java<br/> > <br/> > &#8212;<br/> > src/test/java/org/dspace/authenticate/SpeakerToLDAPCase.java (revision<br/> > 0)<br/> > <br/> > src/test/java/org/dspace/authenticate/SpeakerToLDAPCase.java (revision<br/> > 0)<br/> > @@ -0,0 +1,56 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +<br/> > +import junit.framework.TestCase;<br/> > +<br/> > +import org.apache.log4j.Logger;<br/> > +<br/> > +/**<br/> > + * Generic test runner for SpeakerToLDAP implementations.<br/> > + */<br/> > +public class SpeakerToLDAPCase extends TestCase {<br/> > + private static final Logger olog = Logger.getLogger(<br/> > SpeakerToLDAPCase.class );<br/> > +<br/> > + private SpeakerToLDAP oldap;<br/> > + private String os_netid;<br/> > + private String os_password;<br/> > +<br/> > +<br/> > + /**<br/> > + * Inject the test dependencies - initializes test properties<br/> > + *<br/> > + * @param s_name of test - pass to super<br/> > + * @param ldap instance to authenticate agains<br/> > + * @param s_netid user-id to authenticate as<br/> > + * @param s_password for s_netid<br/> > + */<br/> > + public SpeakerToLDAPCase ( String s_name, SpeakerToLDAP ldap,<br/> > + String s_netid, String s_password<br/> > + ) </p> { > + super( s_name ); > + oldap = ldap; > + os_netid = s_netid; > + os_password = s_password; > + } <p>> +<br/> > + /**<br/> > + * Try to authenticate against the constructor-supplied<br/> > + * (SpeakerToLDAP, s_netid, s_password)<br/> > + */<br/> > + public void testAuthenticate() {<br/> > + try </p> { > + DataFromLDAP ldap_info = oldap.ldapAuthenticate( os_netid, > os_password ); > + assertTrue( ""Test user logged in ok: "" + os_netid, > + null != ldap_info > + ); > + // need e-mail to key into eperson database > + olog.info( ""Got e-mail for "" + os_netid + "": "" + > ldap_info.getEmail () ); > + assertTrue( ""Got e-mail info for "" + os_netid + "" from > ldap"", > + null != ldap_info.getEmail () > + ); > + } <p> catch ( Exception e ) </p> { > + olog.info( ""Failed to authenticate user: "" + os_netid, e > ); > + assertTrue( ""Failed to authenticate user: "" + os_netid + > "", caught: "" + e, false ); > + } <p>> + }<br/> > +}<br/> > Index: src/test/java/org/dspace/authenticate/PackageTest.java<br/> > <br/> > &#8212;<br/> > src/test/java/org/dspace/authenticate/PackageTest.java (revision<br/> > 0)<br/> > <br/> > src/test/java/org/dspace/authenticate/PackageTest.java (revision<br/> > 0)<br/> > @@ -0,0 +1,40 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +<br/> > +import junit.framework.TestCase;<br/> > +import junit.framework.TestSuite;<br/> > +<br/> > +import org.apache.log4j.Logger;<br/> > +<br/> > +/**<br/> > + * Specialization of AbstactSpeakerToLDAPTest configured<br/> > + * to run a DefaultSpeakerToLDAPTest through a test.<br/> > + */<br/> > +public class PackageTest extends TestCase {<br/> > + private static final Logger olog = Logger.getLogger(<br/> > PackageTest.class );<br/> > +<br/> > +<br/> > + /**<br/> > + * Build up the batch of tests to run for the<br/> > org.dspace.authenticate<br/> > + * package. You'll have to modify the properties injected into<br/> > the<br/> > + * test SpeakerToLDAP to work with your environment<br/> > + */<br/> > + public static TestSuite suite () </p> { > + TestSuite suite = new TestSuite( PackageTest.class.getName > () ); > + SpeakerToLDAP ldap = new DefaultSpeakerToLDAP ( > ""ldap://ldaps.university.edu"", > + ""cn"", > + > ""OU=People,OU=AUMain,DC=auburn,DC=edu"", > + > ""WINDOWS_DOMAIN:AUBURN"", > + ""mail"", > + ""givenName"", > + ""sn"", > + > ""telephoneNumber"" > + ); > + suite.addTest ( new SpeakerToLDAPCase( ""testAuthenticate"", > ldap, > + ""USER"", ""PASSWORD"" > + ) > + ); > + return suite; > + } <p>> +<br/> > +}<br/> > Index: src/test/resources/log4j.properties<br/> > <br/> > &#8212; src/test/resources/log4j.properties (revision 0)<br/> >  src/test/resources/log4j.properties (revision 0)<br/> > @@ -0,0 +1,9 @@<br/> > +# Set root logger level to DEBUG and its only appender to A1.<br/> > +log4j.rootLogger=DEBUG, A1<br/> > +<br/> > +# A1 is set to be a ConsoleAppender.<br/> > +log4j.appender.A1=org.apache.log4j.ConsoleAppender<br/> > +<br/> > +# A1 uses PatternLayout.<br/> > +log4j.appender.A1.layout=org.apache.log4j.PatternLayout<br/> > +log4j.appender.A1.layout.ConversionPattern=%-4r <span class=""error"">&#91;%t&#93;</span> %-5p %c %x -<br/> > %m%n<br/> > Index: src/main/java/org/dspace/authenticate/LDAPAuthentication.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/LDAPAuthentication.java (revision<br/> > 3054)<br/> > <br/> > src/main/java/org/dspace/authenticate/LDAPAuthentication.java (working<br/> > copy)<br/> > @@ -40,17 +40,11 @@<br/> > package org.dspace.authenticate;<br/> ><br/> > import java.sql.SQLException;<br/> > +import java.util.ArrayList;<br/> > +import java.util.List;<br/> > import java.util.Hashtable;<br/> ><br/> > -import javax.naming.NamingEnumeration;<br/> > import javax.naming.NamingException;<br/> > -import javax.naming.directory.Attribute;<br/> > -import javax.naming.directory.Attributes;<br/> > -import javax.naming.directory.BasicAttribute;<br/> > -import javax.naming.directory.BasicAttributes;<br/> > -import javax.naming.directory.DirContext;<br/> > -import javax.naming.directory.InitialDirContext;<br/> > -import javax.naming.directory.SearchResult;<br/> > import javax.servlet.http.HttpServletRequest;<br/> > import javax.servlet.http.HttpServletResponse;<br/> ><br/> > @@ -60,6 +54,7 @@<br/> > import org.dspace.core.Context;<br/> > import org.dspace.core.LogManager;<br/> > import org.dspace.eperson.EPerson;<br/> > +import org.dspace.eperson.Group;<br/> ><br/> > /**<br/> > * Authentication module to authenticate against a flat LDAP tree<br/> > where<br/> > @@ -72,9 +67,66 @@<br/> > implements AuthenticationMethod {<br/> ><br/> > /** log4j category */<br/> > - private static Logger log =<br/> > Logger.getLogger(LDAPAuthentication.class);<br/> > + private static final Logger olog =<br/> > Logger.getLogger(LDAPAuthentication.class);<br/> ><br/> > + private final SpeakerToLDAP oldap;<br/> > +<br/> > /**<br/> > + * Constructor injects SpeakerToLDAP dependency<br/> > + *<br/> > + * @param ldap SpeakerToLDAP knows how to authenticate<br/> > + * against and query the LDAP directory<br/> > + * @param b_autoregister set true to auto-register an eperson<br/> > + * for a new user that succesfully authenticates<br/> > + * with LDAP<br/> > + * @param v_special_group ids of user groups that an<br/> > LDAP-authenticated<br/> > + * user should be considered an implicit member of<br/> > + */<br/> > + public LDAPAuthentication ( SpeakerToLDAP ldap,<br/> > + boolean b_autoregister,<br/> > + int[] v_special_group<br/> > + ) </p> { > + oldap = ldap; > + ob_autoregister = b_autoregister; > + ov_special_group = v_special_group; > + } <p>> +<br/> > + /**<br/> > + * Constructor invoked by dspace.cfg based configuration<br/> > + * engine sets up DefaultSpeakerToLDAP,<br/> > + * checks ldap.autoregister and ldap.dspace.autogroup<br/> > + * configuration values to determine canSelfRegister<br/> > + * and getSpecialGroups property values.<br/> > + */<br/> > + public LDAPAuthentication () {<br/> > + String s_groups =<br/> > ConfigurationManager.getProperty(""ldap.dspace.autogroup"");<br/> > +<br/> > + List<Integer> v_group_id = new ArrayList<Integer>();<br/> > + if ( null != s_groups ) {<br/> > + String[] v_group_name = s_groups.trim ().split(<br/> > "",<br class=""atl-forced-newline"" />s*"" );<br/> > + for ( int i=0; i < v_group_name.length; ++i ) {<br/> > + String s_group = v_group_name<span class=""error"">&#91;i&#93;</span>.trim ();<br/> > + if ( s_group.length () > 0 ) {<br/> > + try </p> { > + v_group_id.add ( Integer.parseInt( s_group ) > ); > + } <p> catch ( Exception e ) </p> { > + olog.warn( ""Exception parsing group "" + > s_group, e ); > + } <p>> + }<br/> > + }<br/> > + }<br/> > + oldap = new DefaultSpeakerToLDAP ();<br/> > + ob_autoregister =<br/> > ConfigurationManager.getBooleanProperty(""webui.ldap.autoregister"");<br/> > + ov_special_group = new int[ v_group_id.size () ];<br/> > + int i_count = 0;<br/> > + for ( Integer i_group_id : v_group_id ) </p> { > + ov_special_group[ i_count ] = i_group_id; > + ++i_count; > + } <p>> + }<br/> > +<br/> > + private final boolean ob_autoregister;<br/> > + /**<br/> > * Let a real auth method return true if it wants.<br/> > */<br/> > public boolean canSelfRegister(Context context,<br/> > @@ -83,8 +135,7 @@<br/> > throws SQLException<br/> > </p> { > // XXX might also want to check that username exists in LDAP. > - > - return > ConfigurationManager.getBooleanProperty(""webui.ldap.autoregister""); > + return ob_autoregister; > } <p>><br/> > /**<br/> > @@ -118,12 +169,10 @@<br/> > return false;<br/> > }<br/> ><br/> > - /*<br/> > - * Nothing here.<br/> > - */<br/> > + private final int[] ov_special_group;<br/> > public int[] getSpecialGroups(Context context, HttpServletRequest<br/> > request)<br/> > </p> { > - return new int[0]; > + return ov_special_group; > } <p>><br/> > /*<br/> > @@ -139,261 +188,140 @@<br/> > HttpServletRequest request)<br/> > throws SQLException<br/> > {<br/> > - log.info(LogManager.getHeader(context, ""auth"", ""attempting<br/> > trivial auth of user=""+netid));<br/> > + olog.info(LogManager.getHeader(context, ""auth"", ""attempting<br/> > auth of user=""+netid));<br/> ><br/> > // Skip out when no netid or password is given.<br/> > - if (netid == null || password == null)<br/> > - return BAD_ARGS;<br/> > + if (netid == null || password == null) </p> { > + return BAD_ARGS; > + } <p>><br/> > // Locate the eperson<br/> > - EPerson eperson = null;<br/> > + EPerson eperson = null;<br/> > try<br/> > </p> { > - eperson = EPerson.findByNetid(context, > netid.toLowerCase()); > + eperson = EPerson.findByNetid(context, > netid.toLowerCase()); > } <p>> catch (SQLException e)<br/> > </p> { > } <p>> - boolean loggedIn = false;<br/> > - SpeakerToLDAP ldap = new SpeakerToLDAP(log);<br/> ><br/> > + olog.debug( ""Found eperson for "" + netid );<br/> > +<br/> > // if they entered a netid that matches an eperson<br/> > if (eperson != null)<br/> > {<br/> > // e-mail address corresponds to active account<br/> > - if (eperson.getRequireCertificate())<br/> > + if (eperson.getRequireCertificate()) </p> { > return CERT_REQUIRED; > - else if (!eperson.canLogIn()) > + } <p> else if (!eperson.canLogIn()) {<br/> > return BAD_ARGS;<br/> > - {<br/> > - if (ldap.ldapAuthenticate(netid, password, context))<br/> > - </p> { > + } <p>> + try {<br/> > + // authenticate<br/> > + olog.debug( ""Attempting LDAP auth-1 for "" + netid );<br/> > + DataFromLDAP ldap_info = oldap.ldapAuthenticate(<br/> > netid, password );<br/> > + if ( null != ldap_info ) </p> { > context.setCurrentUser(eperson = > EPerson.findByNetid(context, netid.toLowerCase(; > - log.info(LogManager > - .getHeader(context, ""authenticate"", > ""type=ldap"")); > + olog.info(LogManager > + .getHeader(context, ""authenticate"", > ""type=ldap"")); > return SUCCESS; > - } <p>> - else<br/> > - return BAD_CREDENTIALS;<br/> > + }<br/> > + } catch ( NamingException e ) </p> { > + olog.warn( ""Failed to authenticate user: "" + netid, e > ); > } <p>> + //else </p> { > + return BAD_CREDENTIALS; > + } <p>> + // eperson == null<br/> > + if ( null != eperson ) </p> { > + throw new AssertionError( ""eperson should be null here!"" > ); > } <p>> -<br/> > - // the user does not already exist so try and authenticate<br/> > them<br/> > - // with ldap and create an eperson for them<br/> > - else<br/> > - {<br/> > - if (ldap.ldapAuthenticate(netid, password, context))<br/> > - {<br/> > - // Register the new user automatically<br/> > - log.info(LogManager.getHeader(context,<br/> > - ""autoregister"", ""netid="" + netid));<br/> > -<br/> > - if<br/> > ((ldap.ldapEmail!=null)&&(!ldap.ldapEmail.equals(""""<br/> > - {<br/> > - try<br/> > - {<br/> > - eperson = EPerson.findByEmail(context,<br/> > ldap.ldapEmail);<br/> > - if (eperson!=null)<br/> > - </p> { > - log.info(LogManager.getHeader(context, > - ""type=ldap-login"", > ""type=ldap_but_already_email"")); > - context.setIgnoreAuthorization(true); > - eperson.setNetid(netid); > - eperson.update(); > - context.commit(); > - context.setIgnoreAuthorization(false); > - context.setCurrentUser(eperson); > - return SUCCESS; > - } <p>> - else<br/> > - {<br/> > - if (canSelfRegister(context, request,<br/> > netid))<br/> > - {<br/> > - // TEMPORARILY turn off<br/> > authorisation<br/> > - try<br/> > - </p> { > - > context.setIgnoreAuthorization(true); > - eperson = > EPerson.create(context); > - if > ((ldap.ldapEmail!=null)&&(!ldap.ldapEmail.equals("""" > eperson.setEmail(ldap.ldapEmail); > - else eperson.setEmail(netid); > - if > ((ldap.ldapGivenName!=null)&&(!ldap.ldapGivenName.equals("""" > eperson.setFirstName(ldap.ldapGivenName); > - if > ((ldap.ldapSurname!=null)&&(!ldap.ldapSurname.equals("""" > eperson.setLastName(ldap.ldapSurname); > - if > ((ldap.ldapPhone!=null)&&(!ldap.ldapPhone.equals("""" > eperson.setMetadata(""phone"", ldap.ldapPhone); > - eperson.setNetid(netid); > - eperson.setCanLogIn(true); > - > AuthenticationManager.initEPerson(context, request, eperson); > - eperson.update(); > - context.commit(); > - context.setCurrentUser(eperson); > - } <p>> - catch (AuthorizeException e)<br/> > - </p> { > - return NO_SUCH_USER; > - } <p>> - finally<br/> > - </p> { > - > context.setIgnoreAuthorization(false); > - } <p>> -<br/> > -<br/> > log.info(LogManager.getHeader(context, ""authenticate"",<br/> > - ""type=ldap-login,<br/> > created ePerson""));<br/> > - return SUCCESS;<br/> > - }<br/> > - else<br/> > - </p> { > - // No auto-registration for valid > certs > - > log.info(LogManager.getHeader(context, > - ""failed_login"", > ""type=ldap_but_no_record"")); > - return NO_SUCH_USER; > - } <p>> - }<br/> > - }<br/> > - catch (AuthorizeException e)<br/> > - </p> { > - eperson = null; > - } <p>> - finally<br/> > - </p> { > - context.setIgnoreAuthorization(false); > - } <p>> - }<br/> > - }<br/> > + olog.debug( ""Attempting LDAP auth-2 for "" + netid );<br/> > + DataFromLDAP ldap_info = null;<br/> > + try </p> { > + ldap_info = oldap.ldapAuthenticate( netid, password ); > + } <p> catch ( NamingException e ) </p> { > + olog.warn( ""Failed to authenticate user: "" + netid, e ); > } <p>> - return BAD_ARGS;<br/> > - }<br/> > -<br/> > - /**<br/> > - * Internal class to manage LDAP query and results, mainly<br/> > - * because there are multiple values to return.<br/> > - */<br/> > - public class SpeakerToLDAP {<br/> > -<br/> > - private Logger log = null;<br/> > -<br/> > - /** ldap email result */<br/> > - protected String ldapEmail = null;<br/> > -<br/> > - /** ldap name result */<br/> > - protected String ldapGivenName = null;<br/> > - protected String ldapSurname = null;<br/> > - protected String ldapPhone = null;<br/> > -<br/> > - SpeakerToLDAP(Logger thelog)<br/> > - {<br/> > - log = thelog;<br/> > + if ( (null == ldap_info)<br/> > + || (ldap_info.getEmail()==null)<br/> > + || ldap_info.getEmail().equals("""")<br/> > + ) </p> { > + return BAD_ARGS; // failed to authenticate or get e-mail > address > } <p>><br/> > - /**<br/> > - * contact the ldap server and attempt to authenticate<br/> > - */<br/> > - protected boolean ldapAuthenticate(String netid, String<br/> > password, Context context)<br/> > - {<br/> > - if (!password.equals(""""))<br/> > - {<br/> > - String ldap_provider_url =<br/> > ConfigurationManager.getProperty(""ldap.provider_url"");<br/> > - String ldap_id_field =<br/> > ConfigurationManager.getProperty(""ldap.id_field"");<br/> > - String ldap_search_context =<br/> > ConfigurationManager.getProperty(""ldap.search_context"");<br/> > - String ldap_object_context =<br/> > ConfigurationManager.getProperty(""ldap.object_context"");<br/> > -<br/> > - // Set up environment for creating initial context<br/> > - Hashtable env = new Hashtable(11);<br/> > - env.put(javax.naming.Context.INITIAL_CONTEXT_FACTORY,<br/> > ""com.sun.jndi.ldap.LdapCtxFactory"");<br/> > - env.put(javax.naming.Context.PROVIDER_URL,<br/> > ldap_provider_url);<br/> > -<br/> > - // Authenticate<br/> > - env.put(javax.naming.Context.SECURITY_AUTHENTICATION,<br/> > ""simple"");<br/> > - env.put(javax.naming.Context.SECURITY_PRINCIPAL,<br/> > ldap_id_field+""=""<ins>netid</ins>"",""+ldap_object_context);<br/> > - env.put(javax.naming.Context.SECURITY_CREDENTIALS,<br/> > password);<br/> > -<br/> > - DirContext ctx = null;<br/> > - try<br/> > - {<br/> > - // Create initial context<br/> > - ctx = new InitialDirContext(env);<br/> > -<br/> > - String ldap_email_field =<br/> > ConfigurationManager.getProperty(""ldap.email_field"");<br/> > - String ldap_givenname_field =<br/> > ConfigurationManager.getProperty(""ldap.givenname_field"");<br/> > - String ldap_surname_field =<br/> > ConfigurationManager.getProperty(""ldap.surname_field"");<br/> > - String ldap_phone_field =<br/> > ConfigurationManager.getProperty(""ldap.phone_field"");<br/> > -<br/> > - Attributes matchAttrs = new<br/> > BasicAttributes(true);<br/> > - matchAttrs.put(new BasicAttribute(ldap_id_field,<br/> > netid));<br/> > -<br/> > - String attlist[] = </p> {ldap_email_field, > ldap_givenname_field, ldap_surname_field, ldap_phone_field} <p>;<br/> > -<br/> > - // look up attributes<br/> > - try<br/> > - {<br/> > - NamingEnumeration answer =<br/> > ctx.search(ldap_search_context, matchAttrs, attlist);<br/> > - while(answer.hasMore()) {<br/> > - SearchResult sr =<br/> > (SearchResult)answer.next();<br/> > - Attributes atts = sr.getAttributes();<br/> > - Attribute att;<br/> > -<br/> > - if (attlist<span class=""error"">&#91;0&#93;</span>!=null)<br/> > - </p> { > - att = atts.get(attlist[0]); > - if (att != null) ldapEmail = > (String)att.get(); > - } <p>> -<br/> > - if (attlist<span class=""error"">&#91;1&#93;</span>!=null)<br/> > - </p> { > - att = atts.get(attlist[1]); > - if (att != null) ldapGivenName = > (String)att.get(); > - } <p>> -<br/> > - if (attlist<span class=""error"">&#91;2&#93;</span>!=null)<br/> > - </p> { > - att = atts.get(attlist[2]); > - if (att != null) ldapSurname = > (String)att.get(); > - } <p>> -<br/> > - if (attlist<span class=""error"">&#91;3&#93;</span>!=null)<br/> > - </p> { > - att = atts.get(attlist[3]); > - if (att != null) ldapPhone = > (String)att.get(); > - } <p>> - }<br/> > + //<br/> > + // autoregister the ldap-authenticated user<br/> > + //<br/> > + olog.info(LogManager.getHeader(context,<br/> > + ""autoregister"", ""netid="" +<br/> > netid)<br/> > + );<br/> > +<br/> > + try {<br/> > + eperson = EPerson.findByEmail(context,<br/> > ldap_info.getEmail());<br/> > + if (eperson!=null) </p> { > + // Just need to set the netid on the eperson record > + olog.info(LogManager.getHeader(context, > + ""type=ldap-login"", > ""type=ldap_but_already_email"")); > + context.setIgnoreAuthorization(true); > + eperson.setNetid(netid); > + eperson.update(); > + context.commit(); > + context.setIgnoreAuthorization(false); > + context.setCurrentUser(eperson); > + return SUCCESS; > + } <p> else if (canSelfRegister(context, request, netid)) {<br/> > + // TEMPORARILY turn off authorisation<br/> > + try {<br/> > + context.setIgnoreAuthorization(true);<br/> > + eperson = EPerson.create(context);<br/> > + eperson.setEmail(ldap_info.getEmail());<br/> > + if ((ldap_info.getGivenName()!=null)<br/> > + &&(!ldap_info.getGivenName().equals(""""))<br/> > + ) </p> { > + > eperson.setFirstName(ldap_info.getGivenName()); > } <p>> - catch (NamingException e)<br/> > - {<br/> > - // if the lookup fails go ahead and create a<br/> > new record for them because the authentication<br/> > - // succeeded<br/> > - log.warn(LogManager.getHeader(context,<br/> > - ""ldap_attribute_lookup"",<br/> > ""type=failed_search ""+e));<br/> > - return true;<br/> > + if ((ldap_info.getSurname()!=null)<br/> > + &&(!ldap_info.getSurname().equals(""""))<br/> > + ) </p> { > + eperson.setLastName(ldap_info.getSurname()); > } <p>> - }<br/> > - catch (NamingException e)<br/> > - </p> { > - log.warn(LogManager.getHeader(context, > - ""ldap_authentication"", > ""type=failed_auth ""+e)); > - return false; > - } <p>> - finally<br/> > - {<br/> > - // Close the context when we're done<br/> > - try<br/> > - {<br/> > - if (ctx != null)<br/> > - ctx.close();<br/> > + if ((ldap_info.getPhone()!=null)<br/> > + &&(!ldap_info.getPhone().equals(""""))<br/> > + ) </p> { > + eperson.setMetadata(""phone"", > ldap_info.getPhone()); > } <p>> - catch (NamingException e)<br/> > - </p> { > - } <p>> + eperson.setNetid(ldap_info.getNetId());<br/> > + eperson.setCanLogIn(true);<br/> > + AuthenticationManager.initEPerson(context,<br/> > request, eperson);<br/> > + eperson.update();<br/> > + context.commit();<br/> > + context.setCurrentUser(eperson);<br/> > + } catch (AuthorizeException e) </p> { > + return NO_SUCH_USER; > + } <p> finally </p> { > + context.setIgnoreAuthorization(false); > }<br/> > + olog.info(LogManager.getHeader(context,<br/> > ""authenticate"",<br/> > + ""type=ldap-login,<br/> > created ePerson""));<br/> > + return SUCCESS;<br/> > + } else { > + // No auto-registration for valid certs > + olog.info(LogManager.getHeader(context, > + ""failed_login"", > ""type=ldap_but_no_record"")); > + return NO_SUCH_USER; > }<br/> > - else<br/> > - { > - return false; > - }<br/> > -<br/> > - return true;<br/> > + } catch (AuthorizeException e) { > + eperson = null; > + // authentication failed > + return BAD_ARGS; > + } finally {> + context.setIgnoreAuthorization(false);> } <p>> -<br/> > -<br/> > + // Unreachable!<br/> > }<br/> ><br/> > +<br/> > /*<br/> > * Returns URL to which to redirect to obtain credentials (either<br/> > password<br/> > * prompt or e.g. HTTPS port for client cert.); null means no<br/> > redirect.<br/> > @@ -430,4 +358,4 @@<br/> > </p> { > return ""org.dspace.eperson.LDAPAuthentication.title""; > } <p>> -}<br/> > \ No newline at end of file<br/> > +}<br/> > Index: src/main/java/org/dspace/authenticate/DefaultSpeakerToLDAP.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/DefaultSpeakerToLDAP.java<br/> (revision<br/> > 0)<br/> > <br/> > src/main/java/org/dspace/authenticate/DefaultSpeakerToLDAP.java<br/> (revision<br/> > 0)<br/> > @@ -0,0 +1,183 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +import java.util.Hashtable;<br/> > +<br/> > +import javax.naming.NamingEnumeration;<br/> > +import javax.naming.NamingException;<br/> > +import javax.naming.directory.Attribute;<br/> > +import javax.naming.directory.Attributes;<br/> > +import javax.naming.directory.BasicAttribute;<br/> > +import javax.naming.directory.BasicAttributes;<br/> > +import javax.naming.directory.DirContext;<br/> > +import javax.naming.directory.InitialDirContext;<br/> > +import javax.naming.directory.SearchControls;<br/> > +import javax.naming.directory.SearchResult;<br/> > +<br/> > +import org.apache.log4j.Logger;<br/> > +import org.dspace.core.ConfigurationManager;<br/> > +<br/> > +/**<br/> > + * Internal class to manage LDAP query and results, mainly<br/> > + * because there are multiple values to return.<br/> > + */<br/> > +public class DefaultSpeakerToLDAP implements SpeakerToLDAP {<br/> > + private static final Logger olog =<br/> > Logger.getLogger(DefaultSpeakerToLDAP.class);<br/> > + private final String os_provider_url;<br/> > + private final String os_id_field;<br/> > + private final String os_search_context;<br/> > + private final String os_object_context;<br/> > + private final String os_email_field;<br/> > + private final String os_givenname_field;<br/> > + private final String os_surname_field;<br/> > + private final String os_phone_field;<br/> > +<br/> > +<br/> > + /**<br/> > + * Constructor allows injection of<br/> > + * configuration parameters.<br/> > + *<br/> > + * @param s_provider_url to the server - we assume simple<br/> > authentication<br/> > + * @param s_id_field attribute of user object - usually cn<br/> > + * @param s_search_context subtree under which to search for user<br/> > info,<br/> > + * ex: ou=People,dc=myschool,dc=edu<br/> > + * @param s_object_context of user bind-path -<br/> > + * ex: ou=People,dc=myschool,dc=edu leads to bind attempt<br/> > + * againt cn=username,ou=People,dc=myschool,dc=edu<br/> > + * @param s_email_field in user record<br/> > + * @param s_givenname_field in user record<br/> > + * @param s_surname_field in user record, usually sn<br/> > + * @param s_phone_field in user record<br/> > + */<br/> > + public DefaultSpeakerToLDAP( String s_provider_url,<br/> > + String s_id_field,<br/> > + String s_search_context,<br/> > + String s_object_context,<br/> > + String s_email_field,<br/> > + String s_givenname_field,<br/> > + String s_surname_field,<br/> > + String s_phone_field<br/> > + )<br/> > + </p> { > + os_provider_url = s_provider_url; > + os_id_field = s_id_field; > + os_search_context = s_search_context; > + os_object_context = s_object_context; > + os_email_field = s_email_field; > + os_givenname_field = s_givenname_field; > + os_surname_field = s_surname_field; > + os_phone_field = s_phone_field; > + } <p>> +<br/> > + /**<br/> > + * Default constructor extracts LDAP-server parameters<br/> > + * from ConfigurationManager (dspace.cfg):<br/> > + * ldap.provider_url, ldap_id_field,<br/> > + * ldap_search_contect, ldap_object_context<br/> > + */<br/> > + public DefaultSpeakerToLDAP() </p> { > + os_provider_url = > ConfigurationManager.getProperty(""ldap.provider_url""); > + os_id_field = > ConfigurationManager.getProperty(""ldap.id_field""); > + os_search_context = > ConfigurationManager.getProperty(""ldap.search_context""); > + os_object_context = > ConfigurationManager.getProperty(""ldap.object_context""); > + os_email_field = > ConfigurationManager.getProperty(""ldap.email_field""); > + os_givenname_field = > ConfigurationManager.getProperty(""ldap.givenname_field""); > + os_surname_field = > ConfigurationManager.getProperty(""ldap.surname_field""); > + os_phone_field = > ConfigurationManager.getProperty(""ldap.phone_field""); > + } <p>> +<br/> > + /**<br/> > + * contact the ldap server and attempt to authenticate<br/> > + */<br/> > + public DataFromLDAP ldapAuthenticate(String s_netid, String<br/> > s_password ) throws NamingException<br/> > + {<br/> > + if (s_password.equals(""""))<br/> > + </p> { > + return null; > + } <p>> + // Set up environment for creating initial context<br/> > + Hashtable env = new Hashtable(11);<br/> > + env.put(javax.naming.Context.INITIAL_CONTEXT_FACTORY,<br/> > ""com.sun.jndi.ldap.LdapCtxFactory"");<br/> > + env.put(javax.naming.Context.PROVIDER_URL, os_provider_url);<br/> > +<br/> > + // Authenticate<br/> > + env.put(javax.naming.Context.SECURITY_AUTHENTICATION,<br/> > ""simple"");<br/> > + final String s_ad_key = ""WINDOWS_DOMAIN:"";<br/> > + if ( os_object_context.toUpperCase ().startsWith( s_ad_key ) )<br/> > </p> { > + // Active Directory bind > + String s_principal = os_object_context.substring( > s_ad_key.length () ) + ""\\"" + s_netid; > + olog.debug( ""Binding principal to: "" + s_principal ); > + env.put(javax.naming.Context.SECURITY_PRINCIPAL, > s_principal ); > + } <p> else </p> { > + env.put(javax.naming.Context.SECURITY_PRINCIPAL, > os_id_field+""=""+s_netid+"",""+os_object_context); > + } <p>> + env.put(javax.naming.Context.SECURITY_CREDENTIALS,<br/> > s_password);<br/> > +<br/> > + DirContext ctx = new InitialDirContext(env);<br/> > + try {<br/> > + Attributes search_attributes = new BasicAttributes(true);<br/> > + search_attributes.put(new BasicAttribute(os_id_field,<br/> > s_netid));<br/> > +<br/> > + String[] v_result_atts = </p> {os_email_field, > os_givenname_field, os_surname_field, os_phone_field} <p>;<br/> > +<br/> > + olog.debug( ""Searching LDAP for "" + os_id_field + ""="" +<br/> > s_netid<br/> > + + "" under "" + os_search_context<br/> > + );<br/> > +<br/> > + NamingEnumeration answer = ctx.search(os_search_context,<br/> > + ""("" + os_id_field +<br/> > ""="" + s_netid + "")"",<br/> > + new SearchControls(<br/> > SearchControls.SUBTREE_SCOPE,<br/> > +<br/> > 1, 20000,<br/> > +<br/> > v_result_atts,<br/> > +<br/> > false, false<br/> > +<br/> > )<br/> > + );<br/> > + if( ! answer.hasMore()) </p> { > + olog.info( ""Able to bind as "" + s_netid + "", but > unable to find LDAP record"" ); > + return null; > + } <p>> + // look up attributes<br/> > + String ldapEmail = null;<br/> > + String ldapGivenName = null;<br/> > + String ldapSurname = null;<br/> > + String ldapPhone = null;<br/> > + SearchResult sr = (SearchResult)answer.next();<br/> > + Attributes atts = sr.getAttributes();<br/> > + Attribute att;<br/> > +<br/> > + if (v_result_atts<span class=""error"">&#91;0&#93;</span>!=null) </p> { > + att = atts.get(v_result_atts[0]); > + if (att != null) ldapEmail = (String)att.get(); > + } <p>> +<br/> > + if (v_result_atts<span class=""error"">&#91;1&#93;</span>!=null) {<br/> > + att = atts.get(v_result_atts<span class=""error"">&#91;1&#93;</span>);<br/> > + if (att != null) </p> { > + ldapGivenName = (String)att.get(); > + } <p>> + }<br/> > +<br/> > + if (v_result_atts<span class=""error"">&#91;2&#93;</span>!=null) {<br/> > + att = atts.get(v_result_atts<span class=""error"">&#91;2&#93;</span>);<br/> > + if (att != null) </p> { > + ldapSurname = (String)att.get(); > + } <p>> + }<br/> > +<br/> > + if (v_result_atts<span class=""error"">&#91;3&#93;</span>!=null) {<br/> > + att = atts.get(v_result_atts<span class=""error"">&#91;3&#93;</span>);<br/> > + if (att != null) </p> { > + ldapPhone = (String)att.get(); > + } <p>> + }<br/> > + return new SimpleDataFromLDAP( ldapEmail, ldapGivenName,<br/> > ldapSurname, ldapPhone, s_netid );<br/> > + } finally {<br/> > + // Close the context when we're done<br/> > + try {<br/> > + if (ctx != null) </p> { > + ctx.close(); > + } <p>> + } catch (NamingException e) { }<br/> > + }<br/> > + // Unreachable<br/> > + }<br/> > +}<br/> > Index: src/main/java/org/dspace/authenticate/SimpleDataFromLDAP.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/SimpleDataFromLDAP.java (revision<br/> > 0)<br/> > <br/> > src/main/java/org/dspace/authenticate/SimpleDataFromLDAP.java (revision<br/> > 0)<br/> > @@ -0,0 +1,48 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +<br/> > +/**<br/> > + * Simple implementation of DataFromLDAP<br/> > + */<br/> > +public class SimpleDataFromLDAP implements DataFromLDAP {<br/> > + /**<br/> > + * Constructor injects all the property values<br/> > + */<br/> > + public SimpleDataFromLDAP ( String s_email,<br/> > + String s_given_name,<br/> > + String s_surname,<br/> > + String s_phone,<br/> > + String s_netid<br/> > + ) </p> { > + os_email = s_email; > + os_given_name = s_given_name; > + os_surname = s_surname; > + os_phone = s_phone; > + os_netid = s_netid; > + } <p>> +<br/> > + private final String os_email;<br/> > + public String getEmail () </p> { > + return os_email; > + } <p>> +<br/> > + private final String os_given_name;<br/> > + public String getGivenName () </p> { > + return os_given_name; > + } <p>> +<br/> > + private final String os_surname;<br/> > + public String getSurname() </p> { > + return os_surname; > + } <p>> +<br/> > + private final String os_phone;<br/> > + public String getPhone () </p> { > + return os_phone; > + } <p>> +<br/> > + private final String os_netid;<br/> > + public String getNetId () </p> { > + return os_netid; > + } <p>> +}<br/> > Index: src/main/java/org/dspace/authenticate/SpeakerToLDAP.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/SpeakerToLDAP.java (revision<br/> > 0)<br/> > <br/> > src/main/java/org/dspace/authenticate/SpeakerToLDAP.java (revision<br/> > 0)<br/> > @@ -0,0 +1,20 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +import javax.naming.NamingException;<br/> > +<br/> > +/**<br/> > + * Interface for LDAP interaction handler<br/> > + */<br/> > +public interface SpeakerToLDAP </p> { > + /** > + * Authenticate the given user with LDAP, > + * and get some data about him/her from the directory. > + * > + * @param s_netid cn of the user to authenticate > + * @param s_password > + * @return user info > + */ > + public DataFromLDAP ldapAuthenticate( String s_netid, > + String s_password > + ) throws NamingException; > +} <p>> Index: src/main/java/org/dspace/authenticate/DataFromLDAP.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/DataFromLDAP.java (revision<br/> > 0)<br/> > <br/> > src/main/java/org/dspace/authenticate/DataFromLDAP.java (revision<br/> > 0)<br/> > @@ -0,0 +1,15 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +<br/> > +/**<br/> > + * POJO data bucket interface for user-data obtained during<br/> > + * LDAP authentication<br/> > + */<br/> > +public interface DataFromLDAP </p> { > + public String getEmail (); > + public String getGivenName (); > + public String getSurname(); > + public String getPhone (); > + /** LDAP common name (cn) for the user */ > + public String getNetId (); > +} <p>><br/> ><br/> ><br/> > </p>",other-file,"[DS-50] LDAP+Active Directory authentication patch - ID: 2100378 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-50"">[DS-50]</a> created by kipkorir2008</i> <p>Thanks, Stuart -</p> <p>I'll submit the patch to the queue.<br/> You can grab a zip file that includes only the<br/> changed files here:<br/> <a href=""http://erwg.lib.auburn.edu/dspace-ldap_20080828.zip"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://erwg.lib.auburn.edu/dspace-ldap_20080828.zip</a></p> <p>The main changes were:</p> <p>*. Our A.D. setup does not allow anonymous bind,<br/> and also has user info scattered around the LDAP tree.<br/> To bind an arbitrary user, we pass a distinguished name<br/> of:<br/> DOMAIN\USER-ID<br/> rather than some LDAP path like cn=USER&ou=People&dc=<br/> We detect this case by allowing the admin<br/> to specify<br/> windows_domain:domain-name<br/> (something like that) as the LDAP object-context in dspace.cfg.</p> <p>*. Since our user info is scattered through an LDAP tree -<br/> I patched the ""lookup user info"" part of the code<br/> to specify a recursive JNDI search.<br/> Your last patch may have done the same thing.</p> <p>*. We would like a user that successfully authenticates against A.D.<br/> to automatically be given certain privileges.<br/> I setup the getSpecialGroups function to accept a list of group-ids in<br/> the<br/> ""ldap.dspace.autogroup""<br/> dspace.cfg parameter.</p> <p>*. I wanted to be able to run a standalone test case against the LDAP<br/> authenticate and search code, so I split out the 'DataFromLDAP'<br/> nested class to an external interface, and include a junit test case.<br/> Also added a few lines to pom.xml to help run the test with verbose<br/> logging, etc.</p> <p>Cheers,<br/> Reuben</p> <p Stuart Lewis <sdl@aber.ac.uk> 9/6/2008 7:57 AM <br/> Hi Reuben,</p> <p>Thanks for getting in touch. Ive got that email sitting in my inbox<br/> waiting<br/> for me to get around to replying to it - sorry it has taken a little<br/> while.</p> <p>What changes have you made to make it work with Active Directory?</p> <p>It would be great if you could formally submit your patch to the DSpace<br/> patch queue<br/> (<a href=""http://sourceforge.net/tracker/?atid=319984&group_id=19984&func=browse"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://sourceforge.net/tracker/?atid=319984&group_id=19984&func=browse</a>).<br/> There are a few of us working on a generic LDAP authenticator which will<br/> hopefully work with any AD / LDAP system, so it would be good to see what<br/> changes youve made to see if we can incorporate them too.</p> <p>Thanks,</p> <p>Stuart</p> <p>On 28/08/2008 16:14, ""Reuben Pasquini"" <rdp0004@auburn.edu> wrote:</p> <p>> Hello!<br/> ><br/> > I've put together a set of patches to the LDAPAuthentication<br/> > code to get it working against Active Directory at Auburn<br/> > University, support implicit-group member-ids in dspace.cfg,<br/> > and add a JUnit regression test.<br/> > I think the changes are backward compatable and generic,<br/> > but I've only tested the code in my environment.<br/> ><br/> > I hope that we can check this patch into the dspace repository.<br/> > An overview and svn diff follow, and a zip file with<br/> > the modified files is available here:<br/> > <a href=""http://erwg.lib.auburn.edu/dspace-ldap_20080828.zip"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://erwg.lib.auburn.edu/dspace-ldap_20080828.zip</a><br/> > Please take a look, and let me know what you think.<br/> ><br/> > Cheers,<br/> > Reuben<br/> ><br/> > <br/> ><br/> > Changes under dspace-api org.dspace.authentication.<br/> ><br/> > *. Moved the<br/> > LDAPAuthentication.SpeakerToLDAP<br/> > nested class out to its own non-nested interface<br/> > with a DefaultSpeakerToLDAP implementation.<br/> ><br/> > *. Refactored SpeakerToLDAP#ldapAuthenticate()<br/> > to return a DataFromLDAP POJO data object<br/> > rather than set object member variables.<br/> ><br/> > *. Implemented SpeakerToLDAPCase JUnit test-case<br/> > and PackageTestSuite classes to support simple<br/> > regression tests against SpeakerToLDAP implementations.<br/> > Modified pom.xml so that<br/> > 'mvn test'<br/> > runs with a verbose log4j setting.<br/> ><br/> > *. Modified the way SpeakToLDAP handles the<br/> > ldap.object_context<br/> > dspace.cfg configuration property so that<br/> > if the ldap.object_context matches<br/> > 'WINDOWS_DOMAIN:DOMAIN_NAME',<br/> > then LDAP attempts to bind with<br/> > 'DOMAIN_NAME\NETID'<br/> > rather than<br/> > 'cn=NETID,ldap.object_context'<br/> > . This change allows us to configure LDAP<br/> > to bind with Active Directory out of the box.<br/> ><br/> > *. Modifed the LDAP search for user-info to take a SearchControls<br/> > parameter that specifies a recursive tree-search under the<br/> > ldap.search_context<br/> > tree for a single user-object result.<br/> > Once again - this allows LDAPAuthenticate to work<br/> > with an Active Directory tree that has user objects<br/> > organized into different folders under a tree.<br/> ><br/> > *. Modified LDAPAuthentication.getSpecialGroups<br/> > to access the<br/> > ldap.dspace.autogroup<br/> > dspace.cfg configuration property<br/> > to get the group-ids that an LDAP-authenticated<br/> > user should be an implicit member of.<br/> > This makes it easy to configure a system where<br/> > every user that can authenticate can also<br/> > submit material to some collections.<br/> ><br/> > *. Changed some of the if/else nesting in<br/> > LDAPAuthentication.authenticate<br/> > so that instead of having something like<br/> > if () </p> { >  > return bla; > } else {<br/> > we have<br/> > if () {> > return bla;> } <p>>  // no else<br/> > and instead of<br/> > } else {<br/> > if () </p> { > return goo > } <p>> }<br/> > we just have<br/> > } else if () {<br/> > just to make the control flow a little<br/> > easier to look at.<br/> ><br/> > <br/> ><br/> > $ svn diff pom.xml src/test src/main/java/org/dspace/authenticate ><br/> > /tmp/bla<br/> ><br/> > Index: pom.xml<br/> > <br/> > &#8212; pom.xml (revision 2942)<br/> >  pom.xml (working copy)<br/> > @@ -61,6 +61,7 @@<br/> ><br/> ><br/> <url><a href=""http://dspace.svn.sourceforge.net/viewvc/dspace/branches/dspace-1_5_x/"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://dspace.svn.sourceforge.net/viewvc/dspace/branches/dspace-1_5_x/</a><br/> dsp<br/> > ace</url><br/> > </scm><br/> ><br/> > +<br/> > <!--<br/> > Runtime and Compile Time dependencies for DSpace.<br/> > --><br/> > @@ -188,6 +189,23 @@<br/> > <groupId>com.ibm.icu</groupId><br/> > <artifactId>icu4j</artifactId><br/> > </dependency><br/> > + <dependency><br/> > + <groupId>junit</groupId><br/> > + <artifactId>junit</artifactId><br/> > + <version>3.8.1</version><br/> > + <scope>test</scope><br/> > + </dependency><br/> > </dependencies><br/> ><br/> > -</project><br/> > \ No newline at end of file<br/> > +<build><br/> > + <testResources><br/> > + <testResource><br/> > + <directory>src/test/resources</directory><br/> > + <includes><br/> > + <include>log4j.properties</include><br/> > + </includes><br/> > + </testResource><br/> > + </testResources><br/> > + </build><br/> > +<br/> > +</project><br/> > Index: src/test/java/org/dspace/authenticate/SpeakerToLDAPCase.java<br/> > <br/> > &#8212;<br/> > src/test/java/org/dspace/authenticate/SpeakerToLDAPCase.java (revision<br/> > 0)<br/> > <br/> > src/test/java/org/dspace/authenticate/SpeakerToLDAPCase.java (revision<br/> > 0)<br/> > @@ -0,0 +1,56 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +<br/> > +import junit.framework.TestCase;<br/> > +<br/> > +import org.apache.log4j.Logger;<br/> > +<br/> > +/**<br/> > + * Generic test runner for SpeakerToLDAP implementations.<br/> > + */<br/> > +public class SpeakerToLDAPCase extends TestCase {<br/> > + private static final Logger olog = Logger.getLogger(<br/> > SpeakerToLDAPCase.class );<br/> > +<br/> > + private SpeakerToLDAP oldap;<br/> > + private String os_netid;<br/> > + private String os_password;<br/> > +<br/> > +<br/> > + /**<br/> > + * Inject the test dependencies - initializes test properties<br/> > + *<br/> > + * @param s_name of test - pass to super<br/> > + * @param ldap instance to authenticate agains<br/> > + * @param s_netid user-id to authenticate as<br/> > + * @param s_password for s_netid<br/> > + */<br/> > + public SpeakerToLDAPCase ( String s_name, SpeakerToLDAP ldap,<br/> > + String s_netid, String s_password<br/> > + ) </p> { > + super( s_name ); > + oldap = ldap; > + os_netid = s_netid; > + os_password = s_password; > + } <p>> +<br/> > + /**<br/> > + * Try to authenticate against the constructor-supplied<br/> > + * (SpeakerToLDAP, s_netid, s_password)<br/> > + */<br/> > + public void testAuthenticate() {<br/> > + try </p> { > + DataFromLDAP ldap_info = oldap.ldapAuthenticate( os_netid, > os_password ); > + assertTrue( ""Test user logged in ok: "" + os_netid, > + null != ldap_info > + ); > + // need e-mail to key into eperson database > + olog.info( ""Got e-mail for "" + os_netid + "": "" + > ldap_info.getEmail () ); > + assertTrue( ""Got e-mail info for "" + os_netid + "" from > ldap"", > + null != ldap_info.getEmail () > + ); > + } <p> catch ( Exception e ) </p> { > + olog.info( ""Failed to authenticate user: "" + os_netid, e > ); > + assertTrue( ""Failed to authenticate user: "" + os_netid + > "", caught: "" + e, false ); > + } <p>> + }<br/> > +}<br/> > Index: src/test/java/org/dspace/authenticate/PackageTest.java<br/> > <br/> > &#8212;<br/> > src/test/java/org/dspace/authenticate/PackageTest.java (revision<br/> > 0)<br/> > <br/> > src/test/java/org/dspace/authenticate/PackageTest.java (revision<br/> > 0)<br/> > @@ -0,0 +1,40 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +<br/> > +import junit.framework.TestCase;<br/> > +import junit.framework.TestSuite;<br/> > +<br/> > +import org.apache.log4j.Logger;<br/> > +<br/> > +/**<br/> > + * Specialization of AbstactSpeakerToLDAPTest configured<br/> > + * to run a DefaultSpeakerToLDAPTest through a test.<br/> > + */<br/> > +public class PackageTest extends TestCase {<br/> > + private static final Logger olog = Logger.getLogger(<br/> > PackageTest.class );<br/> > +<br/> > +<br/> > + /**<br/> > + * Build up the batch of tests to run for the<br/> > org.dspace.authenticate<br/> > + * package. You'll have to modify the properties injected into<br/> > the<br/> > + * test SpeakerToLDAP to work with your environment<br/> > + */<br/> > + public static TestSuite suite () </p> { > + TestSuite suite = new TestSuite( PackageTest.class.getName > () ); > + SpeakerToLDAP ldap = new DefaultSpeakerToLDAP ( > ""ldap://ldaps.university.edu"", > + ""cn"", > + > ""OU=People,OU=AUMain,DC=auburn,DC=edu"", > + > ""WINDOWS_DOMAIN:AUBURN"", > + ""mail"", > + ""givenName"", > + ""sn"", > + > ""telephoneNumber"" > + ); > + suite.addTest ( new SpeakerToLDAPCase( ""testAuthenticate"", > ldap, > + ""USER"", ""PASSWORD"" > + ) > + ); > + return suite; > + } <p>> +<br/> > +}<br/> > Index: src/test/resources/log4j.properties<br/> > <br/> > &#8212; src/test/resources/log4j.properties (revision 0)<br/> >  src/test/resources/log4j.properties (revision 0)<br/> > @@ -0,0 +1,9 @@<br/> > +# Set root logger level to DEBUG and its only appender to A1.<br/> > +log4j.rootLogger=DEBUG, A1<br/> > +<br/> > +# A1 is set to be a ConsoleAppender.<br/> > +log4j.appender.A1=org.apache.log4j.ConsoleAppender<br/> > +<br/> > +# A1 uses PatternLayout.<br/> > +log4j.appender.A1.layout=org.apache.log4j.PatternLayout<br/> > +log4j.appender.A1.layout.ConversionPattern=%-4r <span class=""error"">&#91;%t&#93;</span> %-5p %c %x -<br/> > %m%n<br/> > Index: src/main/java/org/dspace/authenticate/LDAPAuthentication.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/LDAPAuthentication.java (revision<br/> > 3054)<br/> > <br/> > src/main/java/org/dspace/authenticate/LDAPAuthentication.java (working<br/> > copy)<br/> > @@ -40,17 +40,11 @@<br/> > package org.dspace.authenticate;<br/> ><br/> > import java.sql.SQLException;<br/> > +import java.util.ArrayList;<br/> > +import java.util.List;<br/> > import java.util.Hashtable;<br/> ><br/> > -import javax.naming.NamingEnumeration;<br/> > import javax.naming.NamingException;<br/> > -import javax.naming.directory.Attribute;<br/> > -import javax.naming.directory.Attributes;<br/> > -import javax.naming.directory.BasicAttribute;<br/> > -import javax.naming.directory.BasicAttributes;<br/> > -import javax.naming.directory.DirContext;<br/> > -import javax.naming.directory.InitialDirContext;<br/> > -import javax.naming.directory.SearchResult;<br/> > import javax.servlet.http.HttpServletRequest;<br/> > import javax.servlet.http.HttpServletResponse;<br/> ><br/> > @@ -60,6 +54,7 @@<br/> > import org.dspace.core.Context;<br/> > import org.dspace.core.LogManager;<br/> > import org.dspace.eperson.EPerson;<br/> > +import org.dspace.eperson.Group;<br/> ><br/> > /**<br/> > * Authentication module to authenticate against a flat LDAP tree<br/> > where<br/> > @@ -72,9 +67,66 @@<br/> > implements AuthenticationMethod {<br/> ><br/> > /** log4j category */<br/> > - private static Logger log =<br/> > Logger.getLogger(LDAPAuthentication.class);<br/> > + private static final Logger olog =<br/> > Logger.getLogger(LDAPAuthentication.class);<br/> ><br/> > + private final SpeakerToLDAP oldap;<br/> > +<br/> > /**<br/> > + * Constructor injects SpeakerToLDAP dependency<br/> > + *<br/> > + * @param ldap SpeakerToLDAP knows how to authenticate<br/> > + * against and query the LDAP directory<br/> > + * @param b_autoregister set true to auto-register an eperson<br/> > + * for a new user that succesfully authenticates<br/> > + * with LDAP<br/> > + * @param v_special_group ids of user groups that an<br/> > LDAP-authenticated<br/> > + * user should be considered an implicit member of<br/> > + */<br/> > + public LDAPAuthentication ( SpeakerToLDAP ldap,<br/> > + boolean b_autoregister,<br/> > + int[] v_special_group<br/> > + ) </p> { > + oldap = ldap; > + ob_autoregister = b_autoregister; > + ov_special_group = v_special_group; > + } <p>> +<br/> > + /**<br/> > + * Constructor invoked by dspace.cfg based configuration<br/> > + * engine sets up DefaultSpeakerToLDAP,<br/> > + * checks ldap.autoregister and ldap.dspace.autogroup<br/> > + * configuration values to determine canSelfRegister<br/> > + * and getSpecialGroups property values.<br/> > + */<br/> > + public LDAPAuthentication () {<br/> > + String s_groups =<br/> > ConfigurationManager.getProperty(""ldap.dspace.autogroup"");<br/> > +<br/> > + List<Integer> v_group_id = new ArrayList<Integer>();<br/> > + if ( null != s_groups ) {<br/> > + String[] v_group_name = s_groups.trim ().split(<br/> > "",<br class=""atl-forced-newline"" />s*"" );<br/> > + for ( int i=0; i < v_group_name.length; ++i ) {<br/> > + String s_group = v_group_name<span class=""error"">&#91;i&#93;</span>.trim ();<br/> > + if ( s_group.length () > 0 ) {<br/> > + try </p> { > + v_group_id.add ( Integer.parseInt( s_group ) > ); > + } <p> catch ( Exception e ) </p> { > + olog.warn( ""Exception parsing group "" + > s_group, e ); > + } <p>> + }<br/> > + }<br/> > + }<br/> > + oldap = new DefaultSpeakerToLDAP ();<br/> > + ob_autoregister =<br/> > ConfigurationManager.getBooleanProperty(""webui.ldap.autoregister"");<br/> > + ov_special_group = new int[ v_group_id.size () ];<br/> > + int i_count = 0;<br/> > + for ( Integer i_group_id : v_group_id ) </p> { > + ov_special_group[ i_count ] = i_group_id; > + ++i_count; > + } <p>> + }<br/> > +<br/> > + private final boolean ob_autoregister;<br/> > + /**<br/> > * Let a real auth method return true if it wants.<br/> > */<br/> > public boolean canSelfRegister(Context context,<br/> > @@ -83,8 +135,7 @@<br/> > throws SQLException<br/> > </p> { > // XXX might also want to check that username exists in LDAP. > - > - return > ConfigurationManager.getBooleanProperty(""webui.ldap.autoregister""); > + return ob_autoregister; > } <p>><br/> > /**<br/> > @@ -118,12 +169,10 @@<br/> > return false;<br/> > }<br/> ><br/> > - /*<br/> > - * Nothing here.<br/> > - */<br/> > + private final int[] ov_special_group;<br/> > public int[] getSpecialGroups(Context context, HttpServletRequest<br/> > request)<br/> > </p> { > - return new int[0]; > + return ov_special_group; > } <p>><br/> > /*<br/> > @@ -139,261 +188,140 @@<br/> > HttpServletRequest request)<br/> > throws SQLException<br/> > {<br/> > - log.info(LogManager.getHeader(context, ""auth"", ""attempting<br/> > trivial auth of user=""+netid));<br/> > + olog.info(LogManager.getHeader(context, ""auth"", ""attempting<br/> > auth of user=""+netid));<br/> ><br/> > // Skip out when no netid or password is given.<br/> > - if (netid == null || password == null)<br/> > - return BAD_ARGS;<br/> > + if (netid == null || password == null) </p> { > + return BAD_ARGS; > + } <p>><br/> > // Locate the eperson<br/> > - EPerson eperson = null;<br/> > + EPerson eperson = null;<br/> > try<br/> > </p> { > - eperson = EPerson.findByNetid(context, > netid.toLowerCase()); > + eperson = EPerson.findByNetid(context, > netid.toLowerCase()); > } <p>> catch (SQLException e)<br/> > </p> { > } <p>> - boolean loggedIn = false;<br/> > - SpeakerToLDAP ldap = new SpeakerToLDAP(log);<br/> ><br/> > + olog.debug( ""Found eperson for "" + netid );<br/> > +<br/> > // if they entered a netid that matches an eperson<br/> > if (eperson != null)<br/> > {<br/> > // e-mail address corresponds to active account<br/> > - if (eperson.getRequireCertificate())<br/> > + if (eperson.getRequireCertificate()) </p> { > return CERT_REQUIRED; > - else if (!eperson.canLogIn()) > + } <p> else if (!eperson.canLogIn()) {<br/> > return BAD_ARGS;<br/> > - {<br/> > - if (ldap.ldapAuthenticate(netid, password, context))<br/> > - </p> { > + } <p>> + try {<br/> > + // authenticate<br/> > + olog.debug( ""Attempting LDAP auth-1 for "" + netid );<br/> > + DataFromLDAP ldap_info = oldap.ldapAuthenticate(<br/> > netid, password );<br/> > + if ( null != ldap_info ) </p> { > context.setCurrentUser(eperson = > EPerson.findByNetid(context, netid.toLowerCase(; > - log.info(LogManager > - .getHeader(context, ""authenticate"", > ""type=ldap"")); > + olog.info(LogManager > + .getHeader(context, ""authenticate"", > ""type=ldap"")); > return SUCCESS; > - } <p>> - else<br/> > - return BAD_CREDENTIALS;<br/> > + }<br/> > + } catch ( NamingException e ) </p> { > + olog.warn( ""Failed to authenticate user: "" + netid, e > ); > } <p>> + //else </p> { > + return BAD_CREDENTIALS; > + } <p>> + // eperson == null<br/> > + if ( null != eperson ) </p> { > + throw new AssertionError( ""eperson should be null here!"" > ); > } <p>> -<br/> > - // the user does not already exist so try and authenticate<br/> > them<br/> > - // with ldap and create an eperson for them<br/> > - else<br/> > - {<br/> > - if (ldap.ldapAuthenticate(netid, password, context))<br/> > - {<br/> > - // Register the new user automatically<br/> > - log.info(LogManager.getHeader(context,<br/> > - ""autoregister"", ""netid="" + netid));<br/> > -<br/> > - if<br/> > ((ldap.ldapEmail!=null)&&(!ldap.ldapEmail.equals(""""<br/> > - {<br/> > - try<br/> > - {<br/> > - eperson = EPerson.findByEmail(context,<br/> > ldap.ldapEmail);<br/> > - if (eperson!=null)<br/> > - </p> { > - log.info(LogManager.getHeader(context, > - ""type=ldap-login"", > ""type=ldap_but_already_email"")); > - context.setIgnoreAuthorization(true); > - eperson.setNetid(netid); > - eperson.update(); > - context.commit(); > - context.setIgnoreAuthorization(false); > - context.setCurrentUser(eperson); > - return SUCCESS; > - } <p>> - else<br/> > - {<br/> > - if (canSelfRegister(context, request,<br/> > netid))<br/> > - {<br/> > - // TEMPORARILY turn off<br/> > authorisation<br/> > - try<br/> > - </p> { > - > context.setIgnoreAuthorization(true); > - eperson = > EPerson.create(context); > - if > ((ldap.ldapEmail!=null)&&(!ldap.ldapEmail.equals("""" > eperson.setEmail(ldap.ldapEmail); > - else eperson.setEmail(netid); > - if > ((ldap.ldapGivenName!=null)&&(!ldap.ldapGivenName.equals("""" > eperson.setFirstName(ldap.ldapGivenName); > - if > ((ldap.ldapSurname!=null)&&(!ldap.ldapSurname.equals("""" > eperson.setLastName(ldap.ldapSurname); > - if > ((ldap.ldapPhone!=null)&&(!ldap.ldapPhone.equals("""" > eperson.setMetadata(""phone"", ldap.ldapPhone); > - eperson.setNetid(netid); > - eperson.setCanLogIn(true); > - > AuthenticationManager.initEPerson(context, request, eperson); > - eperson.update(); > - context.commit(); > - context.setCurrentUser(eperson); > - } <p>> - catch (AuthorizeException e)<br/> > - </p> { > - return NO_SUCH_USER; > - } <p>> - finally<br/> > - </p> { > - > context.setIgnoreAuthorization(false); > - } <p>> -<br/> > -<br/> > log.info(LogManager.getHeader(context, ""authenticate"",<br/> > - ""type=ldap-login,<br/> > created ePerson""));<br/> > - return SUCCESS;<br/> > - }<br/> > - else<br/> > - </p> { > - // No auto-registration for valid > certs > - > log.info(LogManager.getHeader(context, > - ""failed_login"", > ""type=ldap_but_no_record"")); > - return NO_SUCH_USER; > - } <p>> - }<br/> > - }<br/> > - catch (AuthorizeException e)<br/> > - </p> { > - eperson = null; > - } <p>> - finally<br/> > - </p> { > - context.setIgnoreAuthorization(false); > - } <p>> - }<br/> > - }<br/> > + olog.debug( ""Attempting LDAP auth-2 for "" + netid );<br/> > + DataFromLDAP ldap_info = null;<br/> > + try </p> { > + ldap_info = oldap.ldapAuthenticate( netid, password ); > + } <p> catch ( NamingException e ) </p> { > + olog.warn( ""Failed to authenticate user: "" + netid, e ); > } <p>> - return BAD_ARGS;<br/> > - }<br/> > -<br/> > - /**<br/> > - * Internal class to manage LDAP query and results, mainly<br/> > - * because there are multiple values to return.<br/> > - */<br/> > - public class SpeakerToLDAP {<br/> > -<br/> > - private Logger log = null;<br/> > -<br/> > - /** ldap email result */<br/> > - protected String ldapEmail = null;<br/> > -<br/> > - /** ldap name result */<br/> > - protected String ldapGivenName = null;<br/> > - protected String ldapSurname = null;<br/> > - protected String ldapPhone = null;<br/> > -<br/> > - SpeakerToLDAP(Logger thelog)<br/> > - {<br/> > - log = thelog;<br/> > + if ( (null == ldap_info)<br/> > + || (ldap_info.getEmail()==null)<br/> > + || ldap_info.getEmail().equals("""")<br/> > + ) </p> { > + return BAD_ARGS; // failed to authenticate or get e-mail > address > } <p>><br/> > - /**<br/> > - * contact the ldap server and attempt to authenticate<br/> > - */<br/> > - protected boolean ldapAuthenticate(String netid, String<br/> > password, Context context)<br/> > - {<br/> > - if (!password.equals(""""))<br/> > - {<br/> > - String ldap_provider_url =<br/> > ConfigurationManager.getProperty(""ldap.provider_url"");<br/> > - String ldap_id_field =<br/> > ConfigurationManager.getProperty(""ldap.id_field"");<br/> > - String ldap_search_context =<br/> > ConfigurationManager.getProperty(""ldap.search_context"");<br/> > - String ldap_object_context =<br/> > ConfigurationManager.getProperty(""ldap.object_context"");<br/> > -<br/> > - // Set up environment for creating initial context<br/> > - Hashtable env = new Hashtable(11);<br/> > - env.put(javax.naming.Context.INITIAL_CONTEXT_FACTORY,<br/> > ""com.sun.jndi.ldap.LdapCtxFactory"");<br/> > - env.put(javax.naming.Context.PROVIDER_URL,<br/> > ldap_provider_url);<br/> > -<br/> > - // Authenticate<br/> > - env.put(javax.naming.Context.SECURITY_AUTHENTICATION,<br/> > ""simple"");<br/> > - env.put(javax.naming.Context.SECURITY_PRINCIPAL,<br/> > ldap_id_field+""=""<ins>netid</ins>"",""+ldap_object_context);<br/> > - env.put(javax.naming.Context.SECURITY_CREDENTIALS,<br/> > password);<br/> > -<br/> > - DirContext ctx = null;<br/> > - try<br/> > - {<br/> > - // Create initial context<br/> > - ctx = new InitialDirContext(env);<br/> > -<br/> > - String ldap_email_field =<br/> > ConfigurationManager.getProperty(""ldap.email_field"");<br/> > - String ldap_givenname_field =<br/> > ConfigurationManager.getProperty(""ldap.givenname_field"");<br/> > - String ldap_surname_field =<br/> > ConfigurationManager.getProperty(""ldap.surname_field"");<br/> > - String ldap_phone_field =<br/> > ConfigurationManager.getProperty(""ldap.phone_field"");<br/> > -<br/> > - Attributes matchAttrs = new<br/> > BasicAttributes(true);<br/> > - matchAttrs.put(new BasicAttribute(ldap_id_field,<br/> > netid));<br/> > -<br/> > - String attlist[] = </p> {ldap_email_field, > ldap_givenname_field, ldap_surname_field, ldap_phone_field} <p>;<br/> > -<br/> > - // look up attributes<br/> > - try<br/> > - {<br/> > - NamingEnumeration answer =<br/> > ctx.search(ldap_search_context, matchAttrs, attlist);<br/> > - while(answer.hasMore()) {<br/> > - SearchResult sr =<br/> > (SearchResult)answer.next();<br/> > - Attributes atts = sr.getAttributes();<br/> > - Attribute att;<br/> > -<br/> > - if (attlist<span class=""error"">&#91;0&#93;</span>!=null)<br/> > - </p> { > - att = atts.get(attlist[0]); > - if (att != null) ldapEmail = > (String)att.get(); > - } <p>> -<br/> > - if (attlist<span class=""error"">&#91;1&#93;</span>!=null)<br/> > - </p> { > - att = atts.get(attlist[1]); > - if (att != null) ldapGivenName = > (String)att.get(); > - } <p>> -<br/> > - if (attlist<span class=""error"">&#91;2&#93;</span>!=null)<br/> > - </p> { > - att = atts.get(attlist[2]); > - if (att != null) ldapSurname = > (String)att.get(); > - } <p>> -<br/> > - if (attlist<span class=""error"">&#91;3&#93;</span>!=null)<br/> > - </p> { > - att = atts.get(attlist[3]); > - if (att != null) ldapPhone = > (String)att.get(); > - } <p>> - }<br/> > + //<br/> > + // autoregister the ldap-authenticated user<br/> > + //<br/> > + olog.info(LogManager.getHeader(context,<br/> > + ""autoregister"", ""netid="" +<br/> > netid)<br/> > + );<br/> > +<br/> > + try {<br/> > + eperson = EPerson.findByEmail(context,<br/> > ldap_info.getEmail());<br/> > + if (eperson!=null) </p> { > + // Just need to set the netid on the eperson record > + olog.info(LogManager.getHeader(context, > + ""type=ldap-login"", > ""type=ldap_but_already_email"")); > + context.setIgnoreAuthorization(true); > + eperson.setNetid(netid); > + eperson.update(); > + context.commit(); > + context.setIgnoreAuthorization(false); > + context.setCurrentUser(eperson); > + return SUCCESS; > + } <p> else if (canSelfRegister(context, request, netid)) {<br/> > + // TEMPORARILY turn off authorisation<br/> > + try {<br/> > + context.setIgnoreAuthorization(true);<br/> > + eperson = EPerson.create(context);<br/> > + eperson.setEmail(ldap_info.getEmail());<br/> > + if ((ldap_info.getGivenName()!=null)<br/> > + &&(!ldap_info.getGivenName().equals(""""))<br/> > + ) </p> { > + > eperson.setFirstName(ldap_info.getGivenName()); > } <p>> - catch (NamingException e)<br/> > - {<br/> > - // if the lookup fails go ahead and create a<br/> > new record for them because the authentication<br/> > - // succeeded<br/> > - log.warn(LogManager.getHeader(context,<br/> > - ""ldap_attribute_lookup"",<br/> > ""type=failed_search ""+e));<br/> > - return true;<br/> > + if ((ldap_info.getSurname()!=null)<br/> > + &&(!ldap_info.getSurname().equals(""""))<br/> > + ) </p> { > + eperson.setLastName(ldap_info.getSurname()); > } <p>> - }<br/> > - catch (NamingException e)<br/> > - </p> { > - log.warn(LogManager.getHeader(context, > - ""ldap_authentication"", > ""type=failed_auth ""+e)); > - return false; > - } <p>> - finally<br/> > - {<br/> > - // Close the context when we're done<br/> > - try<br/> > - {<br/> > - if (ctx != null)<br/> > - ctx.close();<br/> > + if ((ldap_info.getPhone()!=null)<br/> > + &&(!ldap_info.getPhone().equals(""""))<br/> > + ) </p> { > + eperson.setMetadata(""phone"", > ldap_info.getPhone()); > } <p>> - catch (NamingException e)<br/> > - </p> { > - } <p>> + eperson.setNetid(ldap_info.getNetId());<br/> > + eperson.setCanLogIn(true);<br/> > + AuthenticationManager.initEPerson(context,<br/> > request, eperson);<br/> > + eperson.update();<br/> > + context.commit();<br/> > + context.setCurrentUser(eperson);<br/> > + } catch (AuthorizeException e) </p> { > + return NO_SUCH_USER; > + } <p> finally </p> { > + context.setIgnoreAuthorization(false); > }<br/> > + olog.info(LogManager.getHeader(context,<br/> > ""authenticate"",<br/> > + ""type=ldap-login,<br/> > created ePerson""));<br/> > + return SUCCESS;<br/> > + } else { > + // No auto-registration for valid certs > + olog.info(LogManager.getHeader(context, > + ""failed_login"", > ""type=ldap_but_no_record"")); > + return NO_SUCH_USER; > }<br/> > - else<br/> > - { > - return false; > - }<br/> > -<br/> > - return true;<br/> > + } catch (AuthorizeException e) { > + eperson = null; > + // authentication failed > + return BAD_ARGS; > + } finally {> + context.setIgnoreAuthorization(false);> } <p>> -<br/> > -<br/> > + // Unreachable!<br/> > }<br/> ><br/> > +<br/> > /*<br/> > * Returns URL to which to redirect to obtain credentials (either<br/> > password<br/> > * prompt or e.g. HTTPS port for client cert.); null means no<br/> > redirect.<br/> > @@ -430,4 +358,4 @@<br/> > </p> { > return ""org.dspace.eperson.LDAPAuthentication.title""; > } <p>> -}<br/> > \ No newline at end of file<br/> > +}<br/> > Index: src/main/java/org/dspace/authenticate/DefaultSpeakerToLDAP.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/DefaultSpeakerToLDAP.java<br/> (revision<br/> > 0)<br/> > <br/> > src/main/java/org/dspace/authenticate/DefaultSpeakerToLDAP.java<br/> (revision<br/> > 0)<br/> > @@ -0,0 +1,183 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +import java.util.Hashtable;<br/> > +<br/> > +import javax.naming.NamingEnumeration;<br/> > +import javax.naming.NamingException;<br/> > +import javax.naming.directory.Attribute;<br/> > +import javax.naming.directory.Attributes;<br/> > +import javax.naming.directory.BasicAttribute;<br/> > +import javax.naming.directory.BasicAttributes;<br/> > +import javax.naming.directory.DirContext;<br/> > +import javax.naming.directory.InitialDirContext;<br/> > +import javax.naming.directory.SearchControls;<br/> > +import javax.naming.directory.SearchResult;<br/> > +<br/> > +import org.apache.log4j.Logger;<br/> > +import org.dspace.core.ConfigurationManager;<br/> > +<br/> > +/**<br/> > + * Internal class to manage LDAP query and results, mainly<br/> > + * because there are multiple values to return.<br/> > + */<br/> > +public class DefaultSpeakerToLDAP implements SpeakerToLDAP {<br/> > + private static final Logger olog =<br/> > Logger.getLogger(DefaultSpeakerToLDAP.class);<br/> > + private final String os_provider_url;<br/> > + private final String os_id_field;<br/> > + private final String os_search_context;<br/> > + private final String os_object_context;<br/> > + private final String os_email_field;<br/> > + private final String os_givenname_field;<br/> > + private final String os_surname_field;<br/> > + private final String os_phone_field;<br/> > +<br/> > +<br/> > + /**<br/> > + * Constructor allows injection of<br/> > + * configuration parameters.<br/> > + *<br/> > + * @param s_provider_url to the server - we assume simple<br/> > authentication<br/> > + * @param s_id_field attribute of user object - usually cn<br/> > + * @param s_search_context subtree under which to search for user<br/> > info,<br/> > + * ex: ou=People,dc=myschool,dc=edu<br/> > + * @param s_object_context of user bind-path -<br/> > + * ex: ou=People,dc=myschool,dc=edu leads to bind attempt<br/> > + * againt cn=username,ou=People,dc=myschool,dc=edu<br/> > + * @param s_email_field in user record<br/> > + * @param s_givenname_field in user record<br/> > + * @param s_surname_field in user record, usually sn<br/> > + * @param s_phone_field in user record<br/> > + */<br/> > + public DefaultSpeakerToLDAP( String s_provider_url,<br/> > + String s_id_field,<br/> > + String s_search_context,<br/> > + String s_object_context,<br/> > + String s_email_field,<br/> > + String s_givenname_field,<br/> > + String s_surname_field,<br/> > + String s_phone_field<br/> > + )<br/> > + </p> { > + os_provider_url = s_provider_url; > + os_id_field = s_id_field; > + os_search_context = s_search_context; > + os_object_context = s_object_context; > + os_email_field = s_email_field; > + os_givenname_field = s_givenname_field; > + os_surname_field = s_surname_field; > + os_phone_field = s_phone_field; > + } <p>> +<br/> > + /**<br/> > + * Default constructor extracts LDAP-server parameters<br/> > + * from ConfigurationManager (dspace.cfg):<br/> > + * ldap.provider_url, ldap_id_field,<br/> > + * ldap_search_contect, ldap_object_context<br/> > + */<br/> > + public DefaultSpeakerToLDAP() </p> { > + os_provider_url = > ConfigurationManager.getProperty(""ldap.provider_url""); > + os_id_field = > ConfigurationManager.getProperty(""ldap.id_field""); > + os_search_context = > ConfigurationManager.getProperty(""ldap.search_context""); > + os_object_context = > ConfigurationManager.getProperty(""ldap.object_context""); > + os_email_field = > ConfigurationManager.getProperty(""ldap.email_field""); > + os_givenname_field = > ConfigurationManager.getProperty(""ldap.givenname_field""); > + os_surname_field = > ConfigurationManager.getProperty(""ldap.surname_field""); > + os_phone_field = > ConfigurationManager.getProperty(""ldap.phone_field""); > + } <p>> +<br/> > + /**<br/> > + * contact the ldap server and attempt to authenticate<br/> > + */<br/> > + public DataFromLDAP ldapAuthenticate(String s_netid, String<br/> > s_password ) throws NamingException<br/> > + {<br/> > + if (s_password.equals(""""))<br/> > + </p> { > + return null; > + } <p>> + // Set up environment for creating initial context<br/> > + Hashtable env = new Hashtable(11);<br/> > + env.put(javax.naming.Context.INITIAL_CONTEXT_FACTORY,<br/> > ""com.sun.jndi.ldap.LdapCtxFactory"");<br/> > + env.put(javax.naming.Context.PROVIDER_URL, os_provider_url);<br/> > +<br/> > + // Authenticate<br/> > + env.put(javax.naming.Context.SECURITY_AUTHENTICATION,<br/> > ""simple"");<br/> > + final String s_ad_key = ""WINDOWS_DOMAIN:"";<br/> > + if ( os_object_context.toUpperCase ().startsWith( s_ad_key ) )<br/> > </p> { > + // Active Directory bind > + String s_principal = os_object_context.substring( > s_ad_key.length () ) + ""\\"" + s_netid; > + olog.debug( ""Binding principal to: "" + s_principal ); > + env.put(javax.naming.Context.SECURITY_PRINCIPAL, > s_principal ); > + } <p> else </p> { > + env.put(javax.naming.Context.SECURITY_PRINCIPAL, > os_id_field+""=""+s_netid+"",""+os_object_context); > + } <p>> + env.put(javax.naming.Context.SECURITY_CREDENTIALS,<br/> > s_password);<br/> > +<br/> > + DirContext ctx = new InitialDirContext(env);<br/> > + try {<br/> > + Attributes search_attributes = new BasicAttributes(true);<br/> > + search_attributes.put(new BasicAttribute(os_id_field,<br/> > s_netid));<br/> > +<br/> > + String[] v_result_atts = </p> {os_email_field, > os_givenname_field, os_surname_field, os_phone_field} <p>;<br/> > +<br/> > + olog.debug( ""Searching LDAP for "" + os_id_field + ""="" +<br/> > s_netid<br/> > + + "" under "" + os_search_context<br/> > + );<br/> > +<br/> > + NamingEnumeration answer = ctx.search(os_search_context,<br/> > + ""("" + os_id_field +<br/> > ""="" + s_netid + "")"",<br/> > + new SearchControls(<br/> > SearchControls.SUBTREE_SCOPE,<br/> > +<br/> > 1, 20000,<br/> > +<br/> > v_result_atts,<br/> > +<br/> > false, false<br/> > +<br/> > )<br/> > + );<br/> > + if( ! answer.hasMore()) </p> { > + olog.info( ""Able to bind as "" + s_netid + "", but > unable to find LDAP record"" ); > + return null; > + } <p>> + // look up attributes<br/> > + String ldapEmail = null;<br/> > + String ldapGivenName = null;<br/> > + String ldapSurname = null;<br/> > + String ldapPhone = null;<br/> > + SearchResult sr = (SearchResult)answer.next();<br/> > + Attributes atts = sr.getAttributes();<br/> > + Attribute att;<br/> > +<br/> > + if (v_result_atts<span class=""error"">&#91;0&#93;</span>!=null) </p> { > + att = atts.get(v_result_atts[0]); > + if (att != null) ldapEmail = (String)att.get(); > + } <p>> +<br/> > + if (v_result_atts<span class=""error"">&#91;1&#93;</span>!=null) {<br/> > + att = atts.get(v_result_atts<span class=""error"">&#91;1&#93;</span>);<br/> > + if (att != null) </p> { > + ldapGivenName = (String)att.get(); > + } <p>> + }<br/> > +<br/> > + if (v_result_atts<span class=""error"">&#91;2&#93;</span>!=null) {<br/> > + att = atts.get(v_result_atts<span class=""error"">&#91;2&#93;</span>);<br/> > + if (att != null) </p> { > + ldapSurname = (String)att.get(); > + } <p>> + }<br/> > +<br/> > + if (v_result_atts<span class=""error"">&#91;3&#93;</span>!=null) {<br/> > + att = atts.get(v_result_atts<span class=""error"">&#91;3&#93;</span>);<br/> > + if (att != null) </p> { > + ldapPhone = (String)att.get(); > + } <p>> + }<br/> > + return new SimpleDataFromLDAP( ldapEmail, ldapGivenName,<br/> > ldapSurname, ldapPhone, s_netid );<br/> > + } finally {<br/> > + // Close the context when we're done<br/> > + try {<br/> > + if (ctx != null) </p> { > + ctx.close(); > + } <p>> + } catch (NamingException e) { }<br/> > + }<br/> > + // Unreachable<br/> > + }<br/> > +}<br/> > Index: src/main/java/org/dspace/authenticate/SimpleDataFromLDAP.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/SimpleDataFromLDAP.java (revision<br/> > 0)<br/> > <br/> > src/main/java/org/dspace/authenticate/SimpleDataFromLDAP.java (revision<br/> > 0)<br/> > @@ -0,0 +1,48 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +<br/> > +/**<br/> > + * Simple implementation of DataFromLDAP<br/> > + */<br/> > +public class SimpleDataFromLDAP implements DataFromLDAP {<br/> > + /**<br/> > + * Constructor injects all the property values<br/> > + */<br/> > + public SimpleDataFromLDAP ( String s_email,<br/> > + String s_given_name,<br/> > + String s_surname,<br/> > + String s_phone,<br/> > + String s_netid<br/> > + ) </p> { > + os_email = s_email; > + os_given_name = s_given_name; > + os_surname = s_surname; > + os_phone = s_phone; > + os_netid = s_netid; > + } <p>> +<br/> > + private final String os_email;<br/> > + public String getEmail () </p> { > + return os_email; > + } <p>> +<br/> > + private final String os_given_name;<br/> > + public String getGivenName () </p> { > + return os_given_name; > + } <p>> +<br/> > + private final String os_surname;<br/> > + public String getSurname() </p> { > + return os_surname; > + } <p>> +<br/> > + private final String os_phone;<br/> > + public String getPhone () </p> { > + return os_phone; > + } <p>> +<br/> > + private final String os_netid;<br/> > + public String getNetId () </p> { > + return os_netid; > + } <p>> +}<br/> > Index: src/main/java/org/dspace/authenticate/SpeakerToLDAP.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/SpeakerToLDAP.java (revision<br/> > 0)<br/> > <br/> > src/main/java/org/dspace/authenticate/SpeakerToLDAP.java (revision<br/> > 0)<br/> > @@ -0,0 +1,20 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +import javax.naming.NamingException;<br/> > +<br/> > +/**<br/> > + * Interface for LDAP interaction handler<br/> > + */<br/> > +public interface SpeakerToLDAP </p> { > + /** > + * Authenticate the given user with LDAP, > + * and get some data about him/her from the directory. > + * > + * @param s_netid cn of the user to authenticate > + * @param s_password > + * @return user info > + */ > + public DataFromLDAP ldapAuthenticate( String s_netid, > + String s_password > + ) throws NamingException; > +} <p>> Index: src/main/java/org/dspace/authenticate/DataFromLDAP.java<br/> > <br/> > &#8212;<br/> > src/main/java/org/dspace/authenticate/DataFromLDAP.java (revision<br/> > 0)<br/> > <br/> > src/main/java/org/dspace/authenticate/DataFromLDAP.java (revision<br/> > 0)<br/> > @@ -0,0 +1,15 @@<br/> > +package org.dspace.authenticate;<br/> > +<br/> > +<br/> > +/**<br/> > + * POJO data bucket interface for user-data obtained during<br/> > + * LDAP authentication<br/> > + */<br/> > +public interface DataFromLDAP </p> { > + public String getEmail (); > + public String getGivenName (); > + public String getSurname(); > + public String getPhone (); > + /** LDAP common name (cn) for the user */ > + public String getNetId (); > +} <p>><br/> ><br/> ><br/> > </p> other-file",no-bug,0.95
9192,DSpace,https://github.com/DSpace/DSpace/issues/9192,Make forgot-password link removable,"Is your feature request related to a problem? Please describe. Make the forgot-password anchor removable as it is now working with the new-user one. Describe the solution you'd like Create a new AuthorizationFeature that will handle this behavior by checking a configuration property, and if the user is specified also that the user can update the password, i.e. org.dspace.app.util.AuthorizeUtil#authorizeUpdatePassword. **Additional context** linked `dspace-angular` issue: https://github.com/DSpace/dspace-angular/issues/2622",source-file | source-file | source-file | test-file | other-file | test-file | test-file | test-file | source-file | source-file | source-file | test-file | test-file | other-file | source-file | source-file | source-file | test-file | other-file | test-file | test-file | test-file,"Make forgot-password link removable Is your feature request related to a problem? Please describe. Make the forgot-password anchor removable as it is now working with the new-user one. Describe the solution you'd like Create a new AuthorizationFeature that will handle this behavior by checking a configuration property, and if the user is specified also that the user can update the password, i.e. org.dspace.app.util.AuthorizeUtil#authorizeUpdatePassword. **Additional context** linked `dspace-angular` issue: https://github.com/DSpace/dspace-angular/issues/2622 source-file source-file source-file test-file other-file test-file test-file test-file source-file source-file source-file test-file test-file other-file source-file source-file source-file test-file other-file test-file test-file test-file",no-bug,0.9
3873,DSpace,https://github.com/DSpace/DSpace/issues/3873,"[DS-499] CLONE -dspace 1.5.2, the bug is occur when the DSpace installation package by running from commandline from C:\dspace-1.5.2-src-release\dspace>mvn package","<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-499"">[DS-499]</a> created by majxster</i> <p>C:\dspace-1.5.2-src-release\dspace>mvn package<br/> <span class=""error"">&#91;INFO&#93;</span> Scanning for projects<br/> <span class=""error"">&#91;INFO&#93;</span> Reactor build order:<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin)<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin) :: Wing-Framework<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace Kernel :: API and Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin) :: API and Core Aspects<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin) :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace Addon Modules<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin) :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI :: Core Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace OAI<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace OAI :: API and Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace OAI :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace OAI :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace JSP-UI<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace JSP-UI :: API and Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace JSP-UI :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace JSP-UI :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace SWORD<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace SWORD :: API and Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace SWORD :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace SWORD :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI :: CLI Client Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace Assembly and Configuration<br/> <span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;INFO&#93;</span> Building DSpace XML-UI (Manakin)<br/> <span class=""error"">&#91;INFO&#93;</span> task-segment: <span class=""error"">&#91;package&#93;</span><br/> <span class=""error"">&#91;INFO&#93;</span> <br/> Downloading: <a href=""http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-site-"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-site-</a><br/> lugin/2.0-beta-7/maven-site-plugin-2.0-beta-7.pom<br/> Downloading: <a href=""http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-site-"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-site-</a><br/> lugin/2.0-beta-7/maven-site-plugin-2.0-beta-7.pom<br/> <span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;ERROR&#93;</span> BUILD ERROR<br/> <span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;INFO&#93;</span> Failed to resolve artifact.</p> <p>GroupId: org.apache.maven.plugins<br/> ArtifactId: maven-site-plugin<br/> Version: 2.0-beta-7</p> <p>Reason: Unable to download the artifact from any repository</p> <p> org.apache.maven.plugins:maven-site-plugin:pom:2.0-beta-7</p> <p>from the specified remote repositories:<br/> central (<a href=""http://repo1.maven.org/maven2"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://repo1.maven.org/maven2</a>),<br/> maven.dspace.org-snapshot (<a href=""http://maven.dspace.org/snapshot"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://maven.dspace.org/snapshot</a>)</p> <p><span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;INFO&#93;</span> For more information, run Maven with the -e switch<br/> <span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;INFO&#93;</span> Total time: 4 seconds<br/> <span class=""error"">&#91;INFO&#93;</span> Finished at: Wed Jan 06 12:35:10 IST 2010<br/> <span class=""error"">&#91;INFO&#93;</span> Final Memory: 4M/7M<br/> <span class=""error"">&#91;INFO&#93;</span> </p>",config-file,"[DS-499] CLONE -dspace 1.5.2, the bug is occur when the DSpace installation package by running from commandline from C:\dspace-1.5.2-src-release\dspace>mvn package <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-499"">[DS-499]</a> created by majxster</i> <p>C:\dspace-1.5.2-src-release\dspace>mvn package<br/> <span class=""error"">&#91;INFO&#93;</span> Scanning for projects<br/> <span class=""error"">&#91;INFO&#93;</span> Reactor build order:<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin)<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin) :: Wing-Framework<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace Kernel :: API and Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin) :: API and Core Aspects<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin) :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace Addon Modules<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace XML-UI (Manakin) :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI :: Core Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace OAI<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace OAI :: API and Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace OAI :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace OAI :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace JSP-UI<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace JSP-UI :: API and Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace JSP-UI :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace JSP-UI :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace SWORD<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace SWORD :: API and Implementation<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace SWORD :: Web Application Resources<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace SWORD :: Web Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace LNI :: CLI Client Application<br/> <span class=""error"">&#91;INFO&#93;</span> DSpace Assembly and Configuration<br/> <span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;INFO&#93;</span> Building DSpace XML-UI (Manakin)<br/> <span class=""error"">&#91;INFO&#93;</span> task-segment: <span class=""error"">&#91;package&#93;</span><br/> <span class=""error"">&#91;INFO&#93;</span> <br/> Downloading: <a href=""http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-site-"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-site-</a><br/> lugin/2.0-beta-7/maven-site-plugin-2.0-beta-7.pom<br/> Downloading: <a href=""http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-site-"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-site-</a><br/> lugin/2.0-beta-7/maven-site-plugin-2.0-beta-7.pom<br/> <span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;ERROR&#93;</span> BUILD ERROR<br/> <span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;INFO&#93;</span> Failed to resolve artifact.</p> <p>GroupId: org.apache.maven.plugins<br/> ArtifactId: maven-site-plugin<br/> Version: 2.0-beta-7</p> <p>Reason: Unable to download the artifact from any repository</p> <p> org.apache.maven.plugins:maven-site-plugin:pom:2.0-beta-7</p> <p>from the specified remote repositories:<br/> central (<a href=""http://repo1.maven.org/maven2"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://repo1.maven.org/maven2</a>),<br/> maven.dspace.org-snapshot (<a href=""http://maven.dspace.org/snapshot"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://maven.dspace.org/snapshot</a>)</p> <p><span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;INFO&#93;</span> For more information, run Maven with the -e switch<br/> <span class=""error"">&#91;INFO&#93;</span> <br/> <span class=""error"">&#91;INFO&#93;</span> Total time: 4 seconds<br/> <span class=""error"">&#91;INFO&#93;</span> Finished at: Wed Jan 06 12:35:10 IST 2010<br/> <span class=""error"">&#91;INFO&#93;</span> Final Memory: 4M/7M<br/> <span class=""error"">&#91;INFO&#93;</span> </p> config-file",no-bug,0.95
3566,DSpace,https://github.com/DSpace/DSpace/issues/3566,[DS-191] metadataschemaregistry_seq is not initialized correctly under Oracle,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-191"">[DS-191]</a> created by lcs</i> <p>The first attempt to add a new metadata schema fails, because the sequence metadataschemaregistry_seq is initialized to the default of 1, while there is already a row with ID 1 (inserted in databse_schema.sql). </p> <p>The easiest fix is probably just initializing the sequence to start with 2, as is done for epersongroup_seq. If I get the time to try it, I'll submit a patch.</p>",source-file | source-file | source-file | source-file | test-file | test-file | config-file | config-file,"[DS-191] metadataschemaregistry_seq is not initialized correctly under Oracle <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-191"">[DS-191]</a> created by lcs</i> <p>The first attempt to add a new metadata schema fails, because the sequence metadataschemaregistry_seq is initialized to the default of 1, while there is already a row with ID 1 (inserted in databse_schema.sql). </p> <p>The easiest fix is probably just initializing the sequence to start with 2, as is done for epersongroup_seq. If I get the time to try it, I'll submit a patch.</p> source-file source-file source-file source-file test-file test-file config-file config-file",no-bug,0.9
8528,DSpace,https://github.com/DSpace/DSpace/issues/8528,Refreshing spider files fails with null pointer exception,"**Describe the bug** Running the cron job /dspace/bin/dspace stats-util -u fails with a null pointer exception because the Project of the Get request is null. Adding a Project before the Get gets excecuted fixes that. [This](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/statistics/util/StatisticsClient.java#L138) is the Get request. Changing it to this: java Get get = new Get(); get.setProject(new org.apache.tools.ant.Project()); // THIS IS THE FIX get.setDest(new File(spiders, url.getHost() + url.getPath().replace(""/"", ""-""; get.setSrc(url); get.setUseTimestamp(true); get.execute();  **To Reproduce** 1. Run this on command line: `/dspace/bin/dspace stats-util -u` **Expected behavior** It should download the spider files.",source-file | source-file,"Refreshing spider files fails with null pointer exception **Describe the bug** Running the cron job /dspace/bin/dspace stats-util -u fails with a null pointer exception because the Project of the Get request is null. Adding a Project before the Get gets excecuted fixes that. [This](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/statistics/util/StatisticsClient.java#L138) is the Get request. Changing it to this: java Get get = new Get(); get.setProject(new org.apache.tools.ant.Project()); // THIS IS THE FIX get.setDest(new File(spiders, url.getHost() + url.getPath().replace(""/"", ""-""; get.setSrc(url); get.setUseTimestamp(true); get.execute();  **To Reproduce** 1. Run this on command line: `/dspace/bin/dspace stats-util -u` **Expected behavior** It should download the spider files. source-file source-file",no-bug,0.9
7946,DSpace,https://github.com/DSpace/DSpace/issues/7946,DSpace 6.x REST API /registries/schema endpoint incorrectly handles fields without qualifiers,"**Describe the bug** The [DSpace 6.x REST API](https://wiki.lyrasis.org/display/DSDOC6x/REST+API) has an endpoint that allows you to get information about metadata fields in the registry. DSpace does not handle metadata fields without qualifiers properly, for example `dc.title` or `dc.contributor`, and returns HTTP 500 to the user. It logs the following to `dspace.log`: console ERROR org.dspace.rest.MetadataRegistryResource @ Field dc.title. not found  These fields obviously exist, and they are visible in the `dc` schema registry: https://demo.dspace.org/rest/registries/schema/dc ~~This probably affects DSpace 4 and 5 as well, since the REST API is the same code.~~ The registries endpoint was added in DSpace 6. **To Reproduce** Make a request to the `/rest/registries/schema/` endpoint for a metadata field without a qualifier, for example: - https://demo.dspace.org/rest/registries/schema/dc/metadata-fields/title - https://demo.dspace.org/rest/registries/schema/dc/metadata-fields/contributor **Expected behavior** An HTTP 200 response with information about the metadata field, for example `dc.contributor.advisor`: - https://demo.dspace.org/rest/registries/schema/dc/metadata-fields/contributor/advisor",source-file | source-file,"DSpace 6.x REST API /registries/schema endpoint incorrectly handles fields without qualifiers **Describe the bug** The [DSpace 6.x REST API](https://wiki.lyrasis.org/display/DSDOC6x/REST+API) has an endpoint that allows you to get information about metadata fields in the registry. DSpace does not handle metadata fields without qualifiers properly, for example `dc.title` or `dc.contributor`, and returns HTTP 500 to the user. It logs the following to `dspace.log`: console ERROR org.dspace.rest.MetadataRegistryResource @ Field dc.title. not found  These fields obviously exist, and they are visible in the `dc` schema registry: https://demo.dspace.org/rest/registries/schema/dc ~~This probably affects DSpace 4 and 5 as well, since the REST API is the same code.~~ The registries endpoint was added in DSpace 6. **To Reproduce** Make a request to the `/rest/registries/schema/` endpoint for a metadata field without a qualifier, for example: - https://demo.dspace.org/rest/registries/schema/dc/metadata-fields/title - https://demo.dspace.org/rest/registries/schema/dc/metadata-fields/contributor **Expected behavior** An HTTP 200 response with information about the metadata field, for example `dc.contributor.advisor`: - https://demo.dspace.org/rest/registries/schema/dc/metadata-fields/contributor/advisor source-file source-file",bug,0.95
3207,DSpace,https://github.com/DSpace/DSpace/issues/3207,LDAP Authentication does not work properly without the authentication-ldap.login.groupmap option,"When I try to login via LDAP, this keeps failing with this error:  2021-03-25 11:16:29,930 ERROR org.springframework.boot.web.servlet.support.ErrorPageFilter @ Forwarding to error page from request [/api/authn/login] due to exception [Index 1 out of bounds for length 1] java.lang.ArrayIndexOutOfBoundsException: Index 1 out of bounds for length 1 at org.dspace.authenticate.LDAPAuthentication.assignGroups(LDAPAuthentication.java:699) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.authenticate.LDAPAuthentication.authenticate(LDAPAuthentication.java:265) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.authenticate.AuthenticationServiceImpl.authenticateInternal(AuthenticationServiceImpl.java:108) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.authenticate.AuthenticationServiceImpl.authenticate(AuthenticationServiceImpl.java:80) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.app.rest.security.EPersonRestAuthenticationProvider.authenticateNewLogin(EPersonRestAuthenticationProvider.java:97) ~[classes/:7.0-beta5-SNAPSHOT] at org.dspace.app.rest.security.EPersonRestAuthenticationProvider.authenticate(EPersonRestAuthenticationProvider.java:71) ~[classes/:7.0-beta5-SNAPSHOT]  I have not configured any authentication-ldap.login.groupmap option (as I thought I won't need them). But apparently LDAPAuthentication does not work properly without this option.",source-file,"LDAP Authentication does not work properly without the authentication-ldap.login.groupmap option When I try to login via LDAP, this keeps failing with this error:  2021-03-25 11:16:29,930 ERROR org.springframework.boot.web.servlet.support.ErrorPageFilter @ Forwarding to error page from request [/api/authn/login] due to exception [Index 1 out of bounds for length 1] java.lang.ArrayIndexOutOfBoundsException: Index 1 out of bounds for length 1 at org.dspace.authenticate.LDAPAuthentication.assignGroups(LDAPAuthentication.java:699) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.authenticate.LDAPAuthentication.authenticate(LDAPAuthentication.java:265) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.authenticate.AuthenticationServiceImpl.authenticateInternal(AuthenticationServiceImpl.java:108) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.authenticate.AuthenticationServiceImpl.authenticate(AuthenticationServiceImpl.java:80) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.app.rest.security.EPersonRestAuthenticationProvider.authenticateNewLogin(EPersonRestAuthenticationProvider.java:97) ~[classes/:7.0-beta5-SNAPSHOT] at org.dspace.app.rest.security.EPersonRestAuthenticationProvider.authenticate(EPersonRestAuthenticationProvider.java:71) ~[classes/:7.0-beta5-SNAPSHOT]  I have not configured any authentication-ldap.login.groupmap option (as I thought I won't need them). But apparently LDAPAuthentication does not work properly without this option. source-file",bug,0.9
8412,DSpace,https://github.com/DSpace/DSpace/issues/8412,"In Submission Form, list collections alphabetically","**Describe the bug** In DSpace 6.3 XMLUI, in the submission form, e.g. https://demo.dspace.org/xmlui/submit, the collections are listed alphabetically starting with the top-level community. <img width=""1172"" alt=""DSpace6_submission_collection_list"" src=""https://user-images.githubusercontent.com/13037168/179617903-1d6d7563-d900-4370-aa8c-d7e9cfec879a.png""> In DSpace 7.3, in the submission form, e.g.https://demo7.dspace.org/home, the collections are listed randomly. The community containing the collection is listed above it. <img width=""1141"" alt=""DSpace7_submission_collection_list"" src=""https://user-images.githubusercontent.com/13037168/179618125-73074fb2-9df0-4f74-83ee-1dfffa3505e0.png""> **To Reproduce** Steps to reproduce the behavior: 1. Do this 2. Then this **Expected behavior** Please either list the top-level communities alphabetically, like DSpace 6, or list the containing communities alphabetically or list the collections alphabetically. **Related work** Link to any related tickets or PRs here.",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,"In Submission Form, list collections alphabetically **Describe the bug** In DSpace 6.3 XMLUI, in the submission form, e.g. https://demo.dspace.org/xmlui/submit, the collections are listed alphabetically starting with the top-level community. <img width=""1172"" alt=""DSpace6_submission_collection_list"" src=""https://user-images.githubusercontent.com/13037168/179617903-1d6d7563-d900-4370-aa8c-d7e9cfec879a.png""> In DSpace 7.3, in the submission form, e.g.https://demo7.dspace.org/home, the collections are listed randomly. The community containing the collection is listed above it. <img width=""1141"" alt=""DSpace7_submission_collection_list"" src=""https://user-images.githubusercontent.com/13037168/179618125-73074fb2-9df0-4f74-83ee-1dfffa3505e0.png""> **To Reproduce** Steps to reproduce the behavior: 1. Do this 2. Then this **Expected behavior** Please either list the top-level communities alphabetically, like DSpace 6, or list the containing communities alphabetically or list the collections alphabetically. **Related work** Link to any related tickets or PRs here. source-file source-file source-file source-file source-file source-file source-file source-file",no-bug,0.9
9383,DSpace,https://github.com/DSpace/DSpace/issues/9383,When answering a request for copy the email subject field will be ignored,"**Describe the bug** When you answer a request for copy, regardless whether you grant or deny the request, you are presented with a form, that has fields for a subject and a message. The subject gets ignored and the subject from the email template is used instead. I post the issue here, because the problem lies with the backend. <img width=""1392"" alt=""Screenshot 2024-02-29 at 10 11 05"" src=""https://github.com/DSpace/DSpace/assets/8408850/52a74a6d-75ff-4c8f-8057-9ca6ab32aadd""> I already have a fix. I will provide a pull request today or tomorrow. **To Reproduce** Steps to reproduce the behavior: 1. Request a copy of a bitstream under embargo 2. Click the link to grant or deny the request 3. Enter a custom subject line 4. Verify the email sent: the subject line provided by you in the form was ignored and the subject from the email template used instead. **Expected behavior** The subject you enter in the form should become the subject of the email you send **Related work** I have a fix. I will provide a pull request today or tomorrow.",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,"When answering a request for copy the email subject field will be ignored **Describe the bug** When you answer a request for copy, regardless whether you grant or deny the request, you are presented with a form, that has fields for a subject and a message. The subject gets ignored and the subject from the email template is used instead. I post the issue here, because the problem lies with the backend. <img width=""1392"" alt=""Screenshot 2024-02-29 at 10 11 05"" src=""https://github.com/DSpace/DSpace/assets/8408850/52a74a6d-75ff-4c8f-8057-9ca6ab32aadd""> I already have a fix. I will provide a pull request today or tomorrow. **To Reproduce** Steps to reproduce the behavior: 1. Request a copy of a bitstream under embargo 2. Click the link to grant or deny the request 3. Enter a custom subject line 4. Verify the email sent: the subject line provided by you in the form was ignored and the subject from the email template used instead. **Expected behavior** The subject you enter in the form should become the subject of the email you send **Related work** I have a fix. I will provide a pull request today or tomorrow. source-file source-file source-file source-file source-file source-file source-file source-file",no-bug,0.9
3886,DSpace,https://github.com/DSpace/DSpace/issues/3886,[DS-512] about chinaese jspui,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-512"">[DS-512]</a> created by ycmspace</i> <p>while I install dspace 1.5.2 nad 1.6.0,I found the chinese jspui not show correct,Messages_zh_CN.properties and Screenshot are Provided beow.I test several language but only chinese(zh_CN)not correct,who can help me</p>",config-file,"[DS-512] about chinaese jspui <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-512"">[DS-512]</a> created by ycmspace</i> <p>while I install dspace 1.5.2 nad 1.6.0,I found the chinese jspui not show correct,Messages_zh_CN.properties and Screenshot are Provided beow.I test several language but only chinese(zh_CN)not correct,who can help me</p> config-file",no-bug,0.9
2826,DSpace,https://github.com/DSpace/DSpace/issues/2826,POSTing item returns null as 'name',"When using the REST API and POSTing to `collections/{collectionId}/items` the field `name` of the Item is ignored. So the command: `curl -X POST https://demo.dspace.org/rest/collections/{collection id}/items -H 'Content-Type: application/json' -H 'Accept: application/json' -d '{""name"": ""TEST""}'` returns `{ ""uuid"": ""someuuid"", ""name"": null,  }` Please correct me if I am wrong but the code in `rest/CollectionsResource.java` suggests that only the metadata, but not the name, of an Item is considered. As [` if (item.getMetadata() != null) {`](https://github.com/DSpace/DSpace/blob/master/dspace-rest/src/main/java/org/dspace/rest/CollectionsResource.java#L356) is the only time when Item is accessed. Do I miss something?",source-file | source-file,"POSTing item returns null as 'name' When using the REST API and POSTing to `collections/{collectionId}/items` the field `name` of the Item is ignored. So the command: `curl -X POST https://demo.dspace.org/rest/collections/{collection id}/items -H 'Content-Type: application/json' -H 'Accept: application/json' -d '{""name"": ""TEST""}'` returns `{ ""uuid"": ""someuuid"", ""name"": null,  }` Please correct me if I am wrong but the code in `rest/CollectionsResource.java` suggests that only the metadata, but not the name, of an Item is considered. As [` if (item.getMetadata() != null) {`](https://github.com/DSpace/DSpace/blob/master/dspace-rest/src/main/java/org/dspace/rest/CollectionsResource.java#L356) is the only time when Item is accessed. Do I miss something? source-file source-file",bug,0.95
5343,DSpace,https://github.com/DSpace/DSpace/issues/5343,"[DS-1977] ""Private"" Items are incorrectly listed in Google Sitemaps","<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-1977"">[DS-1977]</a> created by tdonohue</i> <p>If you mark an item as ""private"" in the Submission UI or the Admin UI, it is still listed in the generated Sitemaps.</p> <p>By definition, a ""private"" item should be hidden from all browse/search interfaces, and therefore we should not encourage Google and other search engines to index them. Private items are still potentially accessible via direct URL, but should not be easy to discover/find in any search engines.</p> <p><a href=""https://wiki.duraspace.org/display/DSDOC4x/DSpace+Item+State+Definitions"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://wiki.duraspace.org/display/DSDOC4x/DSpace+Item+State+Definitions</a></p> <p>To Reproduce this issue:</p> <ul> <li>Create a Item, and mark it as ""private""</li> <li>That item will not be discoverable in the DSpace Browse or Search UIs</li> <li>However, if you regenerate the DSpace Sitemaps, that item will still be listed in the Sitemap.</li> </ul> <p>The expected result:</p> <ul> <li>If an item is marked as ""private"" it should NEVER appear in the generated SiteMaps.</li> </ul>",source-file,"[DS-1977] ""Private"" Items are incorrectly listed in Google Sitemaps <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-1977"">[DS-1977]</a> created by tdonohue</i> <p>If you mark an item as ""private"" in the Submission UI or the Admin UI, it is still listed in the generated Sitemaps.</p> <p>By definition, a ""private"" item should be hidden from all browse/search interfaces, and therefore we should not encourage Google and other search engines to index them. Private items are still potentially accessible via direct URL, but should not be easy to discover/find in any search engines.</p> <p><a href=""https://wiki.duraspace.org/display/DSDOC4x/DSpace+Item+State+Definitions"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://wiki.duraspace.org/display/DSDOC4x/DSpace+Item+State+Definitions</a></p> <p>To Reproduce this issue:</p> <ul> <li>Create a Item, and mark it as ""private""</li> <li>That item will not be discoverable in the DSpace Browse or Search UIs</li> <li>However, if you regenerate the DSpace Sitemaps, that item will still be listed in the Sitemap.</li> </ul> <p>The expected result:</p> <ul> <li>If an item is marked as ""private"" it should NEVER appear in the generated SiteMaps.</li> </ul> source-file",no-bug,0.9
2869,DSpace,https://github.com/DSpace/DSpace/issues/2869,DS-4249: Add support for HTML response in OpenSearch,"This is a duplicate of [DS-4249](https://jira.lyrasis.org/browse/DS-4249) Estimate from release plan: 2 hours Expressing interest: none This is a followup of DS-3943, more specifically the merged PR https://github.com/DSpace/DSpace/pull/2128 doesn't include support for Handle HTML responses in OpenSearchController or correct link options in dspace.cfg and/or https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/app/util/OpenSearchServiceImpl.java to redirect requests to basic search module of the UI",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | source-file | test-file,"DS-4249: Add support for HTML response in OpenSearch This is a duplicate of [DS-4249](https://jira.lyrasis.org/browse/DS-4249) Estimate from release plan: 2 hours Expressing interest: none This is a followup of DS-3943, more specifically the merged PR https://github.com/DSpace/DSpace/pull/2128 doesn't include support for Handle HTML responses in OpenSearchController or correct link options in dspace.cfg and/or https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/app/util/OpenSearchServiceImpl.java to redirect requests to basic search module of the UI source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file test-file source-file source-file source-file source-file test-file source-file test-file",no-bug,0.8
3386,DSpace,https://github.com/DSpace/DSpace/issues/3386,[DS-8] DSpace Home link style in breadcrumb trail - ID: 1951859,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-8"">[DS-8]</a> created by kipkorir2008</i> <p>The breadcrumb trail which is created in the dri:trail xsl template is<br/> created with the CSS class ""first-linklast-link"" when the currently viewed<br/> page is the DSpace Home page.</p> <p>There's a missing space that's needed to give the link the classes<br/> ""first-link last-link"".</p>",source-file | source-file | test-file | test-file | test-file,"[DS-8] DSpace Home link style in breadcrumb trail - ID: 1951859 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-8"">[DS-8]</a> created by kipkorir2008</i> <p>The breadcrumb trail which is created in the dri:trail xsl template is<br/> created with the CSS class ""first-linklast-link"" when the currently viewed<br/> page is the DSpace Home page.</p> <p>There's a missing space that's needed to give the link the classes<br/> ""first-link last-link"".</p> source-file source-file test-file test-file test-file",no-bug,0.95
8152,DSpace,https://github.com/DSpace/DSpace/issues/8152,RDFConsumer creates unnecessary second Context,"**Describe the bug** If you activate the RDFConsumer in DSpace 6 and finish a submission, you run into an Internal Server Error. The log shows:  org.hibernate.exception.GenericJDBCException: could not execute statement  Caused by: org.postgresql.util.PSQLException: ERROR: current transaction is aborted, commands ignored until end of transaction block  Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint ""doi_doi_key"" Detail: Key (doi)=(10.7968/tlc.wi-test.0003/20) already exists.  The RDFConsumer creates a new Context in `READ_ONLY` mode and aborts that context later. Unfortunately another running context seem to be aborted as well. The easy fix here is to change RDFConsumer, to store the previous `Context.Mode`, set it to `READ_ONLY` and restore it once its work is done. The more complex solution would be to determine why both instances of `org.dspace.core.Context` are being aborted. I don't know if the same bug occurs in DSpace 7, but the code exists there as well. **Expected behavior** Being able to submit an item when the RDFConsumer is activated (added to event.dispatcher.default.consumers). **Related work** PR is in preparation.",source-file | source-file,"RDFConsumer creates unnecessary second Context **Describe the bug** If you activate the RDFConsumer in DSpace 6 and finish a submission, you run into an Internal Server Error. The log shows:  org.hibernate.exception.GenericJDBCException: could not execute statement  Caused by: org.postgresql.util.PSQLException: ERROR: current transaction is aborted, commands ignored until end of transaction block  Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint ""doi_doi_key"" Detail: Key (doi)=(10.7968/tlc.wi-test.0003/20) already exists.  The RDFConsumer creates a new Context in `READ_ONLY` mode and aborts that context later. Unfortunately another running context seem to be aborted as well. The easy fix here is to change RDFConsumer, to store the previous `Context.Mode`, set it to `READ_ONLY` and restore it once its work is done. The more complex solution would be to determine why both instances of `org.dspace.core.Context` are being aborted. I don't know if the same bug occurs in DSpace 7, but the code exists there as well. **Expected behavior** Being able to submit an item when the RDFConsumer is activated (added to event.dispatcher.default.consumers). **Related work** PR is in preparation. source-file source-file",no-bug,0.9
9099,DSpace,https://github.com/DSpace/DSpace/issues/9099,Deleted primary bitstream still referenced in the bundle,"**Describe the bug** Primary Bitstreams are used for Access Status calculations, but when the that bitstream is deleted, the bundle primary bitstream reference isn't changed. So, Access Status calculations will return wrong status. **To Reproduce** Steps to reproduce the behavior: 1. Create a new item 2. Upload several files into the item and fill the required data 3. Deposit the item 4. As an admin, Edit that Item and promote one bitstream to be Primary Bitstream (this will reference that bitstream at the bundle level) 5. Please take note of that bitstream's UUID 6. Delete that bitstream that we promote to primary 7. Check the database (please consider your UUID here):  sql SELECT * FROM bundle WHERE primary_bitstream_id='814aefff-4874-4a97-a7aa-b654172e7a40'  **Expected behavior** Apparently nothing changes, but the deleted bitstream is still referenced as that bundle primary bitstream. It's hoped that, when a bitstream is deleted, also that bundle's primary bitstream reference is also removed. This issue is also present in older DSpace versions (like 5.X).",source-file | source-file | database-file | test-file | test-file | source-file | source-file | database-file | test-file | test-file,"Deleted primary bitstream still referenced in the bundle **Describe the bug** Primary Bitstreams are used for Access Status calculations, but when the that bitstream is deleted, the bundle primary bitstream reference isn't changed. So, Access Status calculations will return wrong status. **To Reproduce** Steps to reproduce the behavior: 1. Create a new item 2. Upload several files into the item and fill the required data 3. Deposit the item 4. As an admin, Edit that Item and promote one bitstream to be Primary Bitstream (this will reference that bitstream at the bundle level) 5. Please take note of that bitstream's UUID 6. Delete that bitstream that we promote to primary 7. Check the database (please consider your UUID here):  sql SELECT * FROM bundle WHERE primary_bitstream_id='814aefff-4874-4a97-a7aa-b654172e7a40'  **Expected behavior** Apparently nothing changes, but the deleted bitstream is still referenced as that bundle primary bitstream. It's hoped that, when a bitstream is deleted, also that bundle's primary bitstream reference is also removed. This issue is also present in older DSpace versions (like 5.X). source-file source-file database-file test-file test-file source-file source-file database-file test-file test-file",no-bug,0.9
10476,DSpace,https://github.com/DSpace/DSpace/issues/10476,[Docker] Cannot run CLI commands when JVM debugging enabled,"## Describe the bug This appears to be caused by / related to #10031. Should be fixed by #10487 On the `main` branch, I'm no longer able to run CLI commands in Docker when using the `dspace-test` image. This is the only image where we specify debugging options via `JAVA_TOOL_OPTIONS`: https://github.com/DSpace/DSpace/blob/main/Dockerfile.test#L72 ## To Reproduce Steps to reproduce the behavior: 1. Start up an image based on `dspace-test` using `main` branch 2. SSH into the running image by running `docker exec -it dspace /bin/bash` (where ""dspace"" is the image name) 3. Attempt to run one of our commandline scripts, e.g. `./bin/dspace index-discovery -b` The result will be an error which says something like this:  Picked up JAVA_TOOL_OPTIONS: -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=*:8000 ERROR: transport error 202: bind failed: Address already in use ERROR: JDWP Transport dt_socket failed to initialize, TRANSPORT_INIT(510) JDWP exit error AGENT_ERROR_TRANSPORT_INIT(197): No transports initialized [src/jdk.jdwp.agent/share/native/libjdwp/debugInit.c:744]  It's possible this is specific to Docker Desktop on Windows (which is what I'm using) I've verified that nothing is running on port 8000. It almost seems like this error comes from JDWP attempting to bind to port 8000, which is already ""in use"" by Docker because it is published/exposed (to allow for remote debugging). If I manually edit the `Dockerfile.test` file to **comment out** the `ENV JAVA_TOOL_OPTIONS` line (near the end of the file) and rebuild the Docker image, then CLI commands work. ## Expected behavior CLI commands should still work on the `dspace-test` image. ## Related work #10031",other-file,"[Docker] Cannot run CLI commands when JVM debugging enabled ## Describe the bug This appears to be caused by / related to #10031. Should be fixed by #10487 On the `main` branch, I'm no longer able to run CLI commands in Docker when using the `dspace-test` image. This is the only image where we specify debugging options via `JAVA_TOOL_OPTIONS`: https://github.com/DSpace/DSpace/blob/main/Dockerfile.test#L72 ## To Reproduce Steps to reproduce the behavior: 1. Start up an image based on `dspace-test` using `main` branch 2. SSH into the running image by running `docker exec -it dspace /bin/bash` (where ""dspace"" is the image name) 3. Attempt to run one of our commandline scripts, e.g. `./bin/dspace index-discovery -b` The result will be an error which says something like this:  Picked up JAVA_TOOL_OPTIONS: -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=*:8000 ERROR: transport error 202: bind failed: Address already in use ERROR: JDWP Transport dt_socket failed to initialize, TRANSPORT_INIT(510) JDWP exit error AGENT_ERROR_TRANSPORT_INIT(197): No transports initialized [src/jdk.jdwp.agent/share/native/libjdwp/debugInit.c:744]  It's possible this is specific to Docker Desktop on Windows (which is what I'm using) I've verified that nothing is running on port 8000. It almost seems like this error comes from JDWP attempting to bind to port 8000, which is already ""in use"" by Docker because it is published/exposed (to allow for remote debugging). If I manually edit the `Dockerfile.test` file to **comment out** the `ENV JAVA_TOOL_OPTIONS` line (near the end of the file) and rebuild the Docker image, then CLI commands work. ## Expected behavior CLI commands should still work on the `dspace-test` image. ## Related work #10031 other-file",no-bug,0.9
3363,DSpace,https://github.com/DSpace/DSpace/issues/3363,Allow to change the eperson password via CLI,"The EPersonCLI script should provide a way to set a new password for an existing user. There is no security implication in allowing that as a linux user able to run such script can already - temporary change the eperson email - use the forget password feature to reset the password - restore the previous eperson email moreover, user that can run the script and access the backend shell can retrieve the database connection settings and manipulate the data directly in any way. My estimation is about 2 hours **Additional context** This improvement will provide a more general solution to reset the password of demo / test drive server than https://github.com/DSpace-Labs/demo.dspace.org-site/blob/master/scripts/linux/reset-dspace-passwords",source-file | source-file | config-file | source-file | source-file | source-file | test-file | test-file | source-file | test-file | source-file | test-file | test-file | source-file,"Allow to change the eperson password via CLI The EPersonCLI script should provide a way to set a new password for an existing user. There is no security implication in allowing that as a linux user able to run such script can already - temporary change the eperson email - use the forget password feature to reset the password - restore the previous eperson email moreover, user that can run the script and access the backend shell can retrieve the database connection settings and manipulate the data directly in any way. My estimation is about 2 hours **Additional context** This improvement will provide a more general solution to reset the password of demo / test drive server than https://github.com/DSpace-Labs/demo.dspace.org-site/blob/master/scripts/linux/reset-dspace-passwords source-file source-file config-file source-file source-file source-file test-file test-file source-file test-file source-file test-file test-file source-file",no-bug,0.9
8715,DSpace,https://github.com/DSpace/DSpace/issues/8715,index-discovery command NPE when running with option -r on individual community (unIndex),**Describe the bug** An NPE is thrown when running the command index-discovery with the option -r on an individual community **To Reproduce** Steps to reproduce the behavior: 1. Run index-discovery -r community handle | community UUID 2. An NPE exception is thrown **Expected behavior** The community and associated items are removed from the index This is the line causing the issue https://github.com/DSpace/DSpace/blob/b956bcd3891e372cc0fe5b1595e422e5d059bced/dspace-api/src/main/java/org/dspace/discovery/SolrServiceImpl.java#L223 and error trace: 15:32:46.539 [main] ERROR org.dspace.scripts.handler.impl.CommandLineDSpaceRunnableHandler - null java.lang.NullPointerException: null at org.dspace.discovery.SolrServiceImpl.unIndexContent(SolrServiceImpl.java:239) ~[classes/:?] at org.dspace.discovery.SolrServiceImpl.unIndexContent(SolrServiceImpl.java:222) ~[classes/:?] at org.dspace.discovery.IndexClient.internalRun(IndexClient.java:61) ~[classes/:?] at org.dspace.scripts.DSpaceRunnable.run(DSpaceRunnable.java:104) [classes/:?] at org.dspace.app.launcher.ScriptLauncher.executeScript(ScriptLauncher.java:149) [classes/:?] at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:131) [classes/:?] at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:98) [classes/:?] **Related work** Fixed by #8716,source-file | source-file | source-file | source-file | source-file | source-file,index-discovery command NPE when running with option -r on individual community (unIndex) **Describe the bug** An NPE is thrown when running the command index-discovery with the option -r on an individual community **To Reproduce** Steps to reproduce the behavior: 1. Run index-discovery -r community handle | community UUID 2. An NPE exception is thrown **Expected behavior** The community and associated items are removed from the index This is the line causing the issue https://github.com/DSpace/DSpace/blob/b956bcd3891e372cc0fe5b1595e422e5d059bced/dspace-api/src/main/java/org/dspace/discovery/SolrServiceImpl.java#L223 and error trace: 15:32:46.539 [main] ERROR org.dspace.scripts.handler.impl.CommandLineDSpaceRunnableHandler - null java.lang.NullPointerException: null at org.dspace.discovery.SolrServiceImpl.unIndexContent(SolrServiceImpl.java:239) ~[classes/:?] at org.dspace.discovery.SolrServiceImpl.unIndexContent(SolrServiceImpl.java:222) ~[classes/:?] at org.dspace.discovery.IndexClient.internalRun(IndexClient.java:61) ~[classes/:?] at org.dspace.scripts.DSpaceRunnable.run(DSpaceRunnable.java:104) [classes/:?] at org.dspace.app.launcher.ScriptLauncher.executeScript(ScriptLauncher.java:149) [classes/:?] at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:131) [classes/:?] at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:98) [classes/:?] **Related work** Fixed by #8716 source-file source-file source-file source-file source-file source-file,no-bug,0.9
3708,DSpace,https://github.com/DSpace/DSpace/issues/3708,[DS-333] Adjust SWORD ingest crosswalk to store bibliographic citation,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-333"">[DS-333]</a> created by stuartlewis</i> <p>SWORD deposits using the SWAP/mets packaging format do not process elements marked as <a href=""http://purl.org/eprint/terms/bibliographicCitation"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://purl.org/eprint/terms/bibliographicCitation</a></p> <p>To fix, add the following lines to config/crosswalks/sword-swap-ingest.xsl:</p> <p><!-- bibliographic citation element: dc.identifier.citation --><br/> <xsl:if test=""./@epdcx:propertyURI='http://purl.org/eprint/terms/bibliographicCitation'""><br/> <dim:field mdschema=""dc"" element=""identifier"" qualifier=""citation""><br/> <xsl:value-of select=""epdcx:valueString""/><br/> </dim:field><br/> </xsl:if></p>",other-file,"[DS-333] Adjust SWORD ingest crosswalk to store bibliographic citation <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-333"">[DS-333]</a> created by stuartlewis</i> <p>SWORD deposits using the SWAP/mets packaging format do not process elements marked as <a href=""http://purl.org/eprint/terms/bibliographicCitation"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://purl.org/eprint/terms/bibliographicCitation</a></p> <p>To fix, add the following lines to config/crosswalks/sword-swap-ingest.xsl:</p> <p><!-- bibliographic citation element: dc.identifier.citation --><br/> <xsl:if test=""./@epdcx:propertyURI='http://purl.org/eprint/terms/bibliographicCitation'""><br/> <dim:field mdschema=""dc"" element=""identifier"" qualifier=""citation""><br/> <xsl:value-of select=""epdcx:valueString""/><br/> </dim:field><br/> </xsl:if></p> other-file",no-bug,0.9
8714,DSpace,https://github.com/DSpace/DSpace/issues/8714,index-discovery command ClassCastException when running with option -i on individual community,**Describe the bug** ClassCastException is thrown when attempting to run the index-discovery command on an individual community. **To Reproduce** Steps to reproduce the behavior: 1. Run command index-discovery [-f] -i community-uuid **Expected behavior** The re-indexing of the community happens successfully and no exception is thrown **Related work** Link to any related tickets or PRs here.,source-file | source-file | source-file | source-file | source-file | source-file,index-discovery command ClassCastException when running with option -i on individual community **Describe the bug** ClassCastException is thrown when attempting to run the index-discovery command on an individual community. **To Reproduce** Steps to reproduce the behavior: 1. Run command index-discovery [-f] -i community-uuid **Expected behavior** The re-indexing of the community happens successfully and no exception is thrown **Related work** Link to any related tickets or PRs here. source-file source-file source-file source-file source-file source-file,no-bug,0.9
7986,DSpace,https://github.com/DSpace/DSpace/issues/7986,Use a connection pool for communication with Solr,"**Is your feature request related to a problem? Please describe.** When we are busy, I have noticed a great many connections between DSpace and Solr, the vast majority of which are in CLOSE_WAIT or some other connection-teardown state. Making and breaking connections has a CPU cost, and large numbers of concurrent connections have a memory cost. **Describe the solution you'd like** We could use Solr more efficiently by keeping a pool of open connections. SolrJ uses an Apache HttpComponents HTTP client instance for connecting to the service, and we can allocate from the pool and pass a pooled connection to the client builder.",source-file | other-file | config-file | source-file | test-file | config-file | source-file | source-file | source-file | source-file | test-file | source-file | config-file | test-file,"Use a connection pool for communication with Solr **Is your feature request related to a problem? Please describe.** When we are busy, I have noticed a great many connections between DSpace and Solr, the vast majority of which are in CLOSE_WAIT or some other connection-teardown state. Making and breaking connections has a CPU cost, and large numbers of concurrent connections have a memory cost. **Describe the solution you'd like** We could use Solr more efficiently by keeping a pool of open connections. SolrJ uses an Apache HttpComponents HTTP client instance for connecting to the service, and we can allocate from the pool and pass a pooled connection to the client builder. source-file other-file config-file source-file test-file config-file source-file source-file source-file source-file test-file source-file config-file test-file",no-bug,0.9
3163,DSpace,https://github.com/DSpace/DSpace/issues/3163,CLI item import error (SAF),"**Describe the bug** The DSPace CLI item import is throwing a Spring exception when I import SAF directories. However I am able to run other tasks, like item exporting. The CLI `ItemImportServiceFactory.getInstance().getItemImportService()` method returns a NullPointerException. Exception: null java.lang.NullPointerException at org.dspace.app.itemimport.ItemImportCLITool.main(ItemImportCLITool.java:302) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:566) at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:272) at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:128) at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:93) I added System.out.println to `DSpaceServiceManager.getServiceByName()` to see the error report on the command line: Error creating bean with name 'itemImportServiceFactory': Unsatisfied dependency expressed through field 'itemImportService'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.dspace.app.itemimport.ItemImportServiceImpl#0' defined in file [/Users/michaelspalti/dspace-tomcats/dspace7/config/spring/api/core-services.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.dspace.app.itemimport.ItemImportServiceImpl]: Constructor threw exception; nested exception is java.lang.NullPointerException The `ItemImportService` bean is an autowired property of the `ItemImportServiceFactoryImpl`. **To Reproduce** Steps to reproduce the behavior: 1. Attempt to import items using SAF: e.g. ./bin/dspace import --add --eperson=mspalti@willamette.edu --collection=10177/2 --source=scene1926/batch_1 --mapfile=scene_1926 **Expected behavior** Items should load successfully. I built my local DSpace from an earlier commit **793ac8c0d** the load was successful.",source-file | source-file,"CLI item import error (SAF) **Describe the bug** The DSPace CLI item import is throwing a Spring exception when I import SAF directories. However I am able to run other tasks, like item exporting. The CLI `ItemImportServiceFactory.getInstance().getItemImportService()` method returns a NullPointerException. Exception: null java.lang.NullPointerException at org.dspace.app.itemimport.ItemImportCLITool.main(ItemImportCLITool.java:302) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:566) at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:272) at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:128) at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:93) I added System.out.println to `DSpaceServiceManager.getServiceByName()` to see the error report on the command line: Error creating bean with name 'itemImportServiceFactory': Unsatisfied dependency expressed through field 'itemImportService'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.dspace.app.itemimport.ItemImportServiceImpl#0' defined in file [/Users/michaelspalti/dspace-tomcats/dspace7/config/spring/api/core-services.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.dspace.app.itemimport.ItemImportServiceImpl]: Constructor threw exception; nested exception is java.lang.NullPointerException The `ItemImportService` bean is an autowired property of the `ItemImportServiceFactoryImpl`. **To Reproduce** Steps to reproduce the behavior: 1. Attempt to import items using SAF: e.g. ./bin/dspace import --add --eperson=mspalti@willamette.edu --collection=10177/2 --source=scene1926/batch_1 --mapfile=scene_1926 **Expected behavior** Items should load successfully. I built my local DSpace from an earlier commit **793ac8c0d** the load was successful. source-file source-file",no-bug,0.9
3890,DSpace,https://github.com/DSpace/DSpace/issues/3890,[DS-516] DSRUN does not start Service Manager,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-516"">[DS-516]</a> created by mdiggory</i> <p>I'll also comment you'll want to use the ""dspace"" CLI script to launch executions rather than ""dsrun"" as the DSpace services framework need to be started properly before updates happen to services.</p> <p>Comment to the developers We rather missed this in our architecture of the new execution environment. We may want to consider removing dsrun or enabling a Main wrapper around it similar to the ""dspace"" shell runner so that the Spring/Services framework is properly started. An alternative would be to make ""dspace"" more flexible to support passing Classnames directly to it in the same manner as ""dsrun"".</p>",source-file,"[DS-516] DSRUN does not start Service Manager <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-516"">[DS-516]</a> created by mdiggory</i> <p>I'll also comment you'll want to use the ""dspace"" CLI script to launch executions rather than ""dsrun"" as the DSpace services framework need to be started properly before updates happen to services.</p> <p>Comment to the developers We rather missed this in our architecture of the new execution environment. We may want to consider removing dsrun or enabling a Main wrapper around it similar to the ""dspace"" shell runner so that the Spring/Services framework is properly started. An alternative would be to make ""dspace"" more flexible to support passing Classnames directly to it in the same manner as ""dsrun"".</p> source-file",no-bug,0.9
3747,DSpace,https://github.com/DSpace/DSpace/issues/3747,"[DS-373] ""Letter"" links have broken URLs in 2nd-stage Browse","<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-373"">[DS-373]</a> created by lcs</i> <p>As one of our library staff noticed, the letter links at the top of the Browse pages are incorrect for the second stage of a 2-stage browse index. </p> <p>To demonstrate, in a default configuration, click on the ""Authors"" browse-by index (the relative URL /browse?type=author). Then, click on one of the author names listed to get to a list of Items for that author. Try one of the ""letter"" links at the top of the page which normally jump to first-stage browse values starting with that letter &#8211; observe that it goes to some random set of Items instead of the expected segment of first-stage browse results.</p> <p>The reason is that on the second-stage browse result page, all those ""letter"" URLs include the ""value"" or ""authority"" parameter from the page request. </p> <p>The attached patch fixes it by removing those parameters, and also saves some wasted copying of parameter lists by creating one map and successively replacing the STARTS_WITH value in it.</p>",source-file | test-file,"[DS-373] ""Letter"" links have broken URLs in 2nd-stage Browse <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-373"">[DS-373]</a> created by lcs</i> <p>As one of our library staff noticed, the letter links at the top of the Browse pages are incorrect for the second stage of a 2-stage browse index. </p> <p>To demonstrate, in a default configuration, click on the ""Authors"" browse-by index (the relative URL /browse?type=author). Then, click on one of the author names listed to get to a list of Items for that author. Try one of the ""letter"" links at the top of the page which normally jump to first-stage browse values starting with that letter &#8211; observe that it goes to some random set of Items instead of the expected segment of first-stage browse results.</p> <p>The reason is that on the second-stage browse result page, all those ""letter"" URLs include the ""value"" or ""authority"" parameter from the page request. </p> <p>The attached patch fixes it by removing those parameters, and also saves some wasted copying of parameter lists by creating one map and successively replacing the STARTS_WITH value in it.</p> source-file test-file",no-bug,0.8
3351,DSpace,https://github.com/DSpace/DSpace/issues/3351,Menu toggle from right to left,"Would like to request a feature where it's possible to toggle the side menu where the search bar is from the right side to the left. This is in regards to users making that change on their own browser or account. I've attached a screenshot so hopefully help explain what menu I mean. The one where it has the search bar, and Browse, My Account, Discover, etc. ![Dspace menu](https://user-images.githubusercontent.com/2236722/127877291-acfa5327-0272-4cdb-bdfe-9b2cc6c6cc88.png)",config-file,"Menu toggle from right to left Would like to request a feature where it's possible to toggle the side menu where the search bar is from the right side to the left. This is in regards to users making that change on their own browser or account. I've attached a screenshot so hopefully help explain what menu I mean. The one where it has the search bar, and Browse, My Account, Discover, etc. ![Dspace menu](https://user-images.githubusercontent.com/2236722/127877291-acfa5327-0272-4cdb-bdfe-9b2cc6c6cc88.png) config-file",no-bug,0.9
3556,DSpace,https://github.com/DSpace/DSpace/issues/3556,[DS-181] Versioning_Google_Summer_of_Code_2007_Versioning,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-181"">[DS-181]</a> created by kipkorir2008</i> <p>DSpace currently does not support versioning of items. However, there are some general plans in place to hopefully implement this feature for a 2.0 release, based on the work that came out of <br/> <a href=""http://wiki.dspace.org/index.php/Google_Summer_of_Code_2007_Versioning"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://wiki.dspace.org/index.php/Google_Summer_of_Code_2007_Versioning</a></p>",source-file | test-file,"[DS-181] Versioning_Google_Summer_of_Code_2007_Versioning <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-181"">[DS-181]</a> created by kipkorir2008</i> <p>DSpace currently does not support versioning of items. However, there are some general plans in place to hopefully implement this feature for a 2.0 release, based on the work that came out of <br/> <a href=""http://wiki.dspace.org/index.php/Google_Summer_of_Code_2007_Versioning"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://wiki.dspace.org/index.php/Google_Summer_of_Code_2007_Versioning</a></p> source-file test-file",no-bug,0.9
2951,DSpace,https://github.com/DSpace/DSpace/issues/2951,Potential use of uninitialized variables in DSOIIdentifierProvider,"**Describe the bug** `#getDOIOutOfObject(DSpaceObject)` makes direct use of the fields `PREFIX` and `NAMESPACE_SEPARATOR`. But these seeming constants are in fact filled from DSpace configuration by internal getters `getPrefix()` and `getNamespaceSeparator()`, and may be null if directly used. **To Reproduce** Steps to reproduce the behavior: I tripped over this when running the single test while working on an unrelated issue. **Expected behavior** The test should have succeeded but instead asserted a mismatch with the expected value.",source-file | source-file,"Potential use of uninitialized variables in DSOIIdentifierProvider **Describe the bug** `#getDOIOutOfObject(DSpaceObject)` makes direct use of the fields `PREFIX` and `NAMESPACE_SEPARATOR`. But these seeming constants are in fact filled from DSpace configuration by internal getters `getPrefix()` and `getNamespaceSeparator()`, and may be null if directly used. **To Reproduce** Steps to reproduce the behavior: I tripped over this when running the single test while working on an unrelated issue. **Expected behavior** The test should have succeeded but instead asserted a mismatch with the expected value. source-file source-file",no-bug,0.9
10053,DSpace,https://github.com/DSpace/DSpace/issues/10053,COAR Notify: fixes to Request endorsement pattern implementation to fully adhere to the Notify implementation v1.0,"## Describe the bug The current implementation of COAR Notify in DSpace >= 8.x for the COAR Request endorsement pattern does not fully adhere to the COAR Notify specification (https://coar-notify.net/specification/1.0.0/). Overall, the current implementation works really well, and the proposed fixes are relatively minor. The fixes have been implemented and tested in collaboration with the PCI Service (Peer Community In) which has a full Notify implementation already available, and currently being used by other repositories such as CSIC (Spain) and HAL (France). As a result, the PR associated with this issue will provide fixes to make the implementation fully adhere to Notify 1.0 specification, as well provide a workflow that supports integration with the PCI endorsement services. List of identified issues 1. The current implementation assumes communications between the repository and the endorsement service will be machine to machine (i.e. the offer notification sent by the repository has the actor hardcoded to being the repository service - see https://github.com/DSpace/DSpace/blob/fc544a830987782d90d22c747e12a42ccf9926d7/dspace/config/ldn/request-endorsement#L20) Instead, the endorsement service expects an email address id in the form **mailto:email@example.org""** (e.g. the email and name of the submitter in the actor property) 2. Acknowledgement notifications: the current implementation in DSpace requires that the type property in received notifications includes both a **type (Accept, Reject, etc.)** as well as including the **coar-type (e.g. coar-type:RequestEndorsement)**. If the coar-type is not set, DSpace returns a null pointer error and notifications fails. See https://coar-notify.net/specification/1.0.0/accept/ where the type property is required and must be Accept, in the case of an Accept ack, and so on. Instead, the DSpace implementation could look for the coar-type (as it currently does), and if not present, it should look at inReplyTo property of the received notification and fetch the coar-type from the original notification (coar-type presence is required in the Offer notification, https://coar-notify.net/specification/1.0.0/request-endorsement/). If none present, then it should fail as expected. 3. Acknowledgement notifications the current DSpace implementation requires that the context property is present in received notifications, and uses this to find the associated DSpace object. The presence of context in ack notifications is optional (e.g. https://coar-notify.net/specification/1.0.0/accept/, the ""context"" property is not even mentioned for ack notifications). Therefore DSpace should follow the same approach as in 2.: if the context property is not present, then find it from the object in the associated inReplyTo notification. ## To Reproduce Steps to reproduce the behaviour: To reproduce the behaviour it is needed to set up a connection with PCI's staging/test environment ## Expected behaviour The service should allow to specify whether it requires the repository actor to be an email address, and ideally this should be done via configuration. The most simple implementation could make use of the submitter's email address and name (this approach would require less modifications to the database tables). A more flexible approach (that may not be needed) could allow the submitter to specify an email address (e.g. different to DSpace's submitter email address). The implementation should fully adhere to the current Notify implementation as per description in 2. and 3. ## Related work PR will be coming shortly",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | database-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | database-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | other-file | other-file | other-file | config-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | database-file | database-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | other-file | other-file | other-file | config-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file,"COAR Notify: fixes to Request endorsement pattern implementation to fully adhere to the Notify implementation v1.0 ## Describe the bug The current implementation of COAR Notify in DSpace >= 8.x for the COAR Request endorsement pattern does not fully adhere to the COAR Notify specification (https://coar-notify.net/specification/1.0.0/). Overall, the current implementation works really well, and the proposed fixes are relatively minor. The fixes have been implemented and tested in collaboration with the PCI Service (Peer Community In) which has a full Notify implementation already available, and currently being used by other repositories such as CSIC (Spain) and HAL (France). As a result, the PR associated with this issue will provide fixes to make the implementation fully adhere to Notify 1.0 specification, as well provide a workflow that supports integration with the PCI endorsement services. List of identified issues 1. The current implementation assumes communications between the repository and the endorsement service will be machine to machine (i.e. the offer notification sent by the repository has the actor hardcoded to being the repository service - see https://github.com/DSpace/DSpace/blob/fc544a830987782d90d22c747e12a42ccf9926d7/dspace/config/ldn/request-endorsement#L20) Instead, the endorsement service expects an email address id in the form **mailto:email@example.org""** (e.g. the email and name of the submitter in the actor property) 2. Acknowledgement notifications: the current implementation in DSpace requires that the type property in received notifications includes both a **type (Accept, Reject, etc.)** as well as including the **coar-type (e.g. coar-type:RequestEndorsement)**. If the coar-type is not set, DSpace returns a null pointer error and notifications fails. See https://coar-notify.net/specification/1.0.0/accept/ where the type property is required and must be Accept, in the case of an Accept ack, and so on. Instead, the DSpace implementation could look for the coar-type (as it currently does), and if not present, it should look at inReplyTo property of the received notification and fetch the coar-type from the original notification (coar-type presence is required in the Offer notification, https://coar-notify.net/specification/1.0.0/request-endorsement/). If none present, then it should fail as expected. 3. Acknowledgement notifications the current DSpace implementation requires that the context property is present in received notifications, and uses this to find the associated DSpace object. The presence of context in ack notifications is optional (e.g. https://coar-notify.net/specification/1.0.0/accept/, the ""context"" property is not even mentioned for ack notifications). Therefore DSpace should follow the same approach as in 2.: if the context property is not present, then find it from the object in the associated inReplyTo notification. ## To Reproduce Steps to reproduce the behaviour: To reproduce the behaviour it is needed to set up a connection with PCI's staging/test environment ## Expected behaviour The service should allow to specify whether it requires the repository actor to be an email address, and ideally this should be done via configuration. The most simple implementation could make use of the submitter's email address and name (this approach would require less modifications to the database tables). A more flexible approach (that may not be needed) could allow the submitter to specify an email address (e.g. different to DSpace's submitter email address). The implementation should fully adhere to the current Notify implementation as per description in 2. and 3. ## Related work PR will be coming shortly source-file source-file source-file source-file source-file source-file source-file source-file source-file database-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file other-file other-file other-file other-file other-file other-file other-file other-file config-file database-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file other-file other-file other-file config-file other-file other-file other-file other-file other-file other-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file database-file database-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file other-file other-file other-file other-file other-file other-file other-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file other-file other-file other-file config-file other-file other-file other-file other-file other-file other-file other-file config-file",bug,0.9
3716,DSpace,https://github.com/DSpace/DSpace/issues/3716,[DS-341] Patch to add percentage relevance to the search results,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-341"">[DS-341]</a> created by franksp</i> <p>The attached patch adds a config option to DSpace which, when enabled, displays a percentage of how relevant a search result is to the search query.</p> <p>Some small changes to the DSQuery classes in search which pass the values up through the API using QueryResults to the UI Layer. The patch only has changes needed to work with JSPUI.</p>",other-file,"[DS-341] Patch to add percentage relevance to the search results <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-341"">[DS-341]</a> created by franksp</i> <p>The attached patch adds a config option to DSpace which, when enabled, displays a percentage of how relevant a search result is to the search query.</p> <p>Some small changes to the DSQuery classes in search which pass the values up through the API using QueryResults to the UI Layer. The patch only has changes needed to work with JSPUI.</p> other-file",no-bug,0.9
3850,DSpace,https://github.com/DSpace/DSpace/issues/3850,[DS-476] READ action,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-476"">[DS-476]</a> created by fabien</i> <p>Even without READ action allowed, you can browse inside a collection and a community. You can also read title of documents.<br/> If you try to read by using the link of the document, you can read it.</p>",other-file | config-file,"[DS-476] READ action <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-476"">[DS-476]</a> created by fabien</i> <p>Even without READ action allowed, you can browse inside a collection and a community. You can also read title of documents.<br/> If you try to read by using the link of the document, you can read it.</p> other-file config-file",no-bug,0.7
8719,DSpace,https://github.com/DSpace/DSpace/issues/8719,update-sequences incomplete,**Describe the bug** update-sequences.sql don't updates all sequences. At least doi_seq is missing It affects dspace 6.4 & 7.x **To Reproduce** Steps to reproduce the behavior: Check update-sequences.sql against database structure. **Expected behavior** All sequences should be updated to last used value.,database-file | database-file | database-file | database-file | database-file | database-file,update-sequences incomplete **Describe the bug** update-sequences.sql don't updates all sequences. At least doi_seq is missing It affects dspace 6.4 & 7.x **To Reproduce** Steps to reproduce the behavior: Check update-sequences.sql against database structure. **Expected behavior** All sequences should be updated to last used value. database-file database-file database-file database-file database-file database-file,no-bug,0.9
8933,DSpace,https://github.com/DSpace/DSpace/issues/8933,"Solr statistics core for the current year is queried twice if sharding is enabled, resulting in wrong statistics being displayed","**Describe the bug** Queries against the statistics core (e.g. for download statistics) are showing the wrong number. The cause of this seems to be sharding by year: The Solr query contains a list of which cores to include (in this case: all of the sharded ones), but the list includes the current year twice. The initialization responsible for this is here: https://github.com/DSpace/DSpace/blob/2b42811e971853c85caf8487411de79515e2bcf3/dspace-api/src/main/java/org/dspace/statistics/SolrLoggerServiceImpl.java#L1686-L1698 The problem is, that `statCoreNames` already includes the core for the current year, because it of course also starts with the base name: https://github.com/DSpace/DSpace/blob/2b42811e971853c85caf8487411de79515e2bcf3/dspace-api/src/main/java/org/dspace/statistics/SolrLoggerServiceImpl.java#L1681-L1683 **To Reproduce** Steps to reproduce the behavior: 1. Enable statistics sharding, set `usage-statistics.shardedByYear = true` in the configuration 2. View usage statistics of a bitstream 3. Download numbers for the current year are counted twice **Expected behavior** Download numbers should be accurate **Related work** Link to any related tickets or PRs here.",source-file | source-file | source-file | source-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | test-file | test-file | other-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | other-file | other-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | config-file | other-file | other-file | config-file | other-file | other-file | other-file | config-file | config-file | other-file | other-file | other-file | other-file | config-file | other-file | config-file | config-file | config-file | container-file | other-file | other-file | other-file | config-file | config-file | config-file | test-file | test-file | config-file | config-file | config-file | config-file | config-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | database-file | database-file | database-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | source-file | config-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | other-file | other-file | config-file | test-file | test-file | config-file,"Solr statistics core for the current year is queried twice if sharding is enabled, resulting in wrong statistics being displayed **Describe the bug** Queries against the statistics core (e.g. for download statistics) are showing the wrong number. The cause of this seems to be sharding by year: The Solr query contains a list of which cores to include (in this case: all of the sharded ones), but the list includes the current year twice. The initialization responsible for this is here: https://github.com/DSpace/DSpace/blob/2b42811e971853c85caf8487411de79515e2bcf3/dspace-api/src/main/java/org/dspace/statistics/SolrLoggerServiceImpl.java#L1686-L1698 The problem is, that `statCoreNames` already includes the core for the current year, because it of course also starts with the base name: https://github.com/DSpace/DSpace/blob/2b42811e971853c85caf8487411de79515e2bcf3/dspace-api/src/main/java/org/dspace/statistics/SolrLoggerServiceImpl.java#L1681-L1683 **To Reproduce** Steps to reproduce the behavior: 1. Enable statistics sharding, set `usage-statistics.shardedByYear = true` in the configuration 2. View usage statistics of a bitstream 3. Download numbers for the current year are counted twice **Expected behavior** Download numbers should be accurate **Related work** Link to any related tickets or PRs here. source-file source-file source-file source-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file test-file test-file other-file source-file test-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file other-file other-file other-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file other-file config-file other-file other-file config-file other-file other-file other-file config-file config-file other-file other-file other-file other-file config-file other-file config-file config-file config-file container-file other-file other-file other-file config-file config-file config-file test-file test-file config-file config-file config-file config-file config-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file database-file database-file database-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file source-file config-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file other-file other-file other-file other-file other-file other-file other-file other-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file other-file other-file config-file test-file test-file config-file",no-bug,0.9
7464,DSpace,https://github.com/DSpace/DSpace/issues/7464,[DS-4117] METSRightsCrosswalk doesn't set resource policy type,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-4117"">[DS-4117]</a> created by haoueclf</i> <p>When a user deposits an item via SWORD by using METSRights metadata within the mets file to transfer the embargo period, none resource policy type is set by the <a href=""https://github.com/DSpace/DSpace/blob/21fe950593380a5c6dd56ab7a6b0cf6f3e0d23ea/dspace-api/src/main/java/org/dspace/content/crosswalk/METSRightsCrosswalk.java#L414"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">METSRightsCrosswalk class</a>. This results to the Embargo Date not being displayed to the admin while editing the metadata of such workflowitem in <b>the Upload File(s)</b> (while changing the Embargo Settings of a file) and <b>Verify Submission step</b>.</p> <p>The provided policies are added by users, therefor the resource policy type: TYPE_CUSTOM should be added.</p> <p> </p>",source-file | source-file | source-file | source-file | source-file,"[DS-4117] METSRightsCrosswalk doesn't set resource policy type <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-4117"">[DS-4117]</a> created by haoueclf</i> <p>When a user deposits an item via SWORD by using METSRights metadata within the mets file to transfer the embargo period, none resource policy type is set by the <a href=""https://github.com/DSpace/DSpace/blob/21fe950593380a5c6dd56ab7a6b0cf6f3e0d23ea/dspace-api/src/main/java/org/dspace/content/crosswalk/METSRightsCrosswalk.java#L414"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">METSRightsCrosswalk class</a>. This results to the Embargo Date not being displayed to the admin while editing the metadata of such workflowitem in <b>the Upload File(s)</b> (while changing the Embargo Settings of a file) and <b>Verify Submission step</b>.</p> <p>The provided policies are added by users, therefor the resource policy type: TYPE_CUSTOM should be added.</p> <p> </p> source-file source-file source-file source-file source-file",no-bug,0.9
8662,DSpace,https://github.com/DSpace/DSpace/issues/8662,Versioning and ORCID,**Describe the bug** Versioning and ORCID are not playing well together. All the versions are pushed to ORCID. I would expect to have the existing record updated on the ORCID side with the most recent version. **Expected behavior** The ORCID record should be updated with the new version. The item should reuse the same PUT code from ORCID instead than remove and create a new record.,source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | test-file | source-file | test-file | source-file | test-file,Versioning and ORCID **Describe the bug** Versioning and ORCID are not playing well together. All the versions are pushed to ORCID. I would expect to have the existing record updated on the ORCID side with the most recent version. **Expected behavior** The ORCID record should be updated with the new version. The item should reuse the same PUT code from ORCID instead than remove and create a new record. source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file test-file source-file test-file source-file test-file,no-bug,0.7
3040,DSpace,https://github.com/DSpace/DSpace/issues/3040,process scheduler does not keep track of special groups,"**Describe the bug** Whenever a process is scheduled, information about user scheduling it is tracked. But we don't keep track of special groups, if any, active for the user at the moment of scheduling. In such cases, if scheduled process requires permission(s) related to a special group, it might fail. To provide a scenario if an user is granted as administrator by shibboleth, but he / she isn't administrator according to dspace systems, and with administrator grant can schedule a process, when the process is triggered and permissions are re-checked we do not have evidence of previous administrator grant.",config-file | config-file,"process scheduler does not keep track of special groups **Describe the bug** Whenever a process is scheduled, information about user scheduling it is tracked. But we don't keep track of special groups, if any, active for the user at the moment of scheduling. In such cases, if scheduled process requires permission(s) related to a special group, it might fail. To provide a scenario if an user is granted as administrator by shibboleth, but he / she isn't administrator according to dspace systems, and with administrator grant can schedule a process, when the process is triggered and permissions are re-checked we do not have evidence of previous administrator grant. config-file config-file",no-bug,0.9
2958,DSpace,https://github.com/DSpace/DSpace/issues/2958,Mysterious linkage between config/../*.cfg and Spring dependency injection,"**Describe the bug** If there is a configuration property `foo.bar` and a Bean `some.Clazz` with `id=""foo""` then instantiating the Bean causes *something* to try to call `some.Clazz.setBar(String)`, even though no such property is mentioned in the ApplicationContext. The culprit is DSpaceBeanPostProcessor, which Spring calls during Bean instantiation. I asked, and nobody recalled why it does this. It may be left over from when dspace-services had the never-used ability do DI with Guice instead of Spring. **To Reproduce** Steps to reproduce the behavior: 1. create a DSpace configuration property with a dotted name like `this.that`. 1. define a Bean which has the `id` equal to the part of the DSpace property name before the first dot (e.g. `this`), and which is embodied by a class which does *not* have a property with a name equal to the part of the DSpace property *after* the first dot (e.g. `that`). Configure it for eager instantiation. Do *not* give it a `<property>` with that name. 1. start DSpace and you should log a failure to instantiate the bean, noting a missing setter. **Expected behavior** Spring should not complain about mysterious properties that were not defined to it. **Related work** Link to any related tickets or PRs here.",source-file | source-file | test-file,"Mysterious linkage between config/../*.cfg and Spring dependency injection **Describe the bug** If there is a configuration property `foo.bar` and a Bean `some.Clazz` with `id=""foo""` then instantiating the Bean causes *something* to try to call `some.Clazz.setBar(String)`, even though no such property is mentioned in the ApplicationContext. The culprit is DSpaceBeanPostProcessor, which Spring calls during Bean instantiation. I asked, and nobody recalled why it does this. It may be left over from when dspace-services had the never-used ability do DI with Guice instead of Spring. **To Reproduce** Steps to reproduce the behavior: 1. create a DSpace configuration property with a dotted name like `this.that`. 1. define a Bean which has the `id` equal to the part of the DSpace property name before the first dot (e.g. `this`), and which is embodied by a class which does *not* have a property with a name equal to the part of the DSpace property *after* the first dot (e.g. `that`). Configure it for eager instantiation. Do *not* give it a `<property>` with that name. 1. start DSpace and you should log a failure to instantiate the bean, noting a missing setter. **Expected behavior** Spring should not complain about mysterious properties that were not defined to it. **Related work** Link to any related tickets or PRs here. source-file source-file test-file",no-bug,0.9
3507,DSpace,https://github.com/DSpace/DSpace/issues/3507,"[DS-130] XMLUI Browse by Author doesn't work for names with special characters (for example: , , , etc.)","<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-130"">[DS-130]</a> created by tdonohue</i> <p>Browse by Author doesn't work for author names that include special characters (for example: , , , etc.).</p> <p>If you click on an author name with such characters you always receive zero results. This <b>only</b> occurs when Tomcat's HTTP Connector has URIEncoding=""UTF-8"". If you unset the URIEncoding, than the XMLUI Browse By Author will work properly. However, unsetting the URIEncoding will default to Tomcat to using ISO-8859-1, which may cause problems elsewhere in DSpace.</p> <p>This bug only occurs with the XMLUI. JSPUI seems unaffected.</p>",config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file,"[DS-130] XMLUI Browse by Author doesn't work for names with special characters (for example: , , , etc.) <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-130"">[DS-130]</a> created by tdonohue</i> <p>Browse by Author doesn't work for author names that include special characters (for example: , , , etc.).</p> <p>If you click on an author name with such characters you always receive zero results. This <b>only</b> occurs when Tomcat's HTTP Connector has URIEncoding=""UTF-8"". If you unset the URIEncoding, than the XMLUI Browse By Author will work properly. However, unsetting the URIEncoding will default to Tomcat to using ISO-8859-1, which may cause problems elsewhere in DSpace.</p> <p>This bug only occurs with the XMLUI. JSPUI seems unaffected.</p> config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file",no-bug,0.8
7060,DSpace,https://github.com/DSpace/DSpace/issues/7060,[DS-3713] REST Query/Collection Report - Bug Filtering for Bitstream Permissions,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3713"">[DS-3713]</a> created by terrywbrady</i> <p>There is an incorrect test of Bundle names when looking for restricted bitstreams in the original and thumbnail bundles. (Look for these filters within the Collection Report and the Item Query report.)</p> <p><a href=""https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-rest/src/main/java/org/dspace/rest/filter/ItemFilterDefsPerm.java#L38"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-rest/src/main/java/org/dspace/rest/filter/ItemFilterDefsPerm.java#L38</a></p> <p><a href=""https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-rest/src/main/java/org/dspace/rest/filter/ItemFilterDefsPerm.java#L58"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-rest/src/main/java/org/dspace/rest/filter/ItemFilterDefsPerm.java#L58</a></p> <p>The following tutorial page will provide instructions on how to replicate this error.</p> <p><a href=""https://github.com/terrywbrady/restReportTutorial/blob/master/demo4/README.md"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://github.com/terrywbrady/restReportTutorial/blob/master/demo4/README.md</a></p>",config-file | config-file | other-file,"[DS-3713] REST Query/Collection Report - Bug Filtering for Bitstream Permissions <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3713"">[DS-3713]</a> created by terrywbrady</i> <p>There is an incorrect test of Bundle names when looking for restricted bitstreams in the original and thumbnail bundles. (Look for these filters within the Collection Report and the Item Query report.)</p> <p><a href=""https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-rest/src/main/java/org/dspace/rest/filter/ItemFilterDefsPerm.java#L38"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-rest/src/main/java/org/dspace/rest/filter/ItemFilterDefsPerm.java#L38</a></p> <p><a href=""https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-rest/src/main/java/org/dspace/rest/filter/ItemFilterDefsPerm.java#L58"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://github.com/DSpace/DSpace/blob/dspace-6_x/dspace-rest/src/main/java/org/dspace/rest/filter/ItemFilterDefsPerm.java#L58</a></p> <p>The following tutorial page will provide instructions on how to replicate this error.</p> <p><a href=""https://github.com/terrywbrady/restReportTutorial/blob/master/demo4/README.md"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">https://github.com/terrywbrady/restReportTutorial/blob/master/demo4/README.md</a></p> config-file config-file other-file",no-bug,0.8
3695,DSpace,https://github.com/DSpace/DSpace/issues/3695,[DS-320] java.util.NoSuchElementException: Timeout waiting for idle objec,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-320"">[DS-320]</a> created by nuncanada</i> <p>We have been restarting Tomcat daily now, sometimes multiple times a day, the connections are running out.</p> <p>From a heap dump its clear that there is a lot of Context objects not being released, actually being hold onto by Finalizer.</p> <p>When applied Mark Woods patch:</p> <p><a href=""http://jira.dspace.org/jira/browse/DS-253"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://jira.dspace.org/jira/browse/DS-253</a></p> <p>That seemed to make it longer for the problems to appear, but still they end up happening. (Nevertheless the patch brings other concurrent critical problem from cocoon, that we never actually spotted in production).</p> <p>There are some Exceptions appearing before the one about no connections left, but the most common one is:</p> <p>Caused by: org.postgresql.util.PSQLException: This statement has been closed.<br/> at org.postgresql.jdbc2.AbstractJdbc2Statement.checkClosed(AbstractJdbc2Statement.java:2444)<br/> at org.postgresql.jdbc2.AbstractJdbc2Statement.setInt(AbstractJdbc2Statement.java:1150)<br/> at org.apache.commons.dbcp.DelegatingPreparedStatement.setInt(DelegatingPreparedStatement.java:117)<br/> at org.apache.commons.dbcp.DelegatingPreparedStatement.setInt(DelegatingPreparedStatement.java:117)<br/> at org.dspace.storage.rdbms.DatabaseManager.loadParameters(DatabaseManager.java:1676)<br/> at org.dspace.storage.rdbms.DatabaseManager.query(DatabaseManager.java:219)<br/> at org.dspace.storage.rdbms.DatabaseManager.querySingle(DatabaseManager.java:302)</p> <p>But i don't know why this is happening? Any clues?</p> <p>Anyways, maybe there is some problem with the top-level Exception handling in XMLUI that is ending up making Contexts getting 'leaked'?</p>",source-file,"[DS-320] java.util.NoSuchElementException: Timeout waiting for idle objec <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-320"">[DS-320]</a> created by nuncanada</i> <p>We have been restarting Tomcat daily now, sometimes multiple times a day, the connections are running out.</p> <p>From a heap dump its clear that there is a lot of Context objects not being released, actually being hold onto by Finalizer.</p> <p>When applied Mark Woods patch:</p> <p><a href=""http://jira.dspace.org/jira/browse/DS-253"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://jira.dspace.org/jira/browse/DS-253</a></p> <p>That seemed to make it longer for the problems to appear, but still they end up happening. (Nevertheless the patch brings other concurrent critical problem from cocoon, that we never actually spotted in production).</p> <p>There are some Exceptions appearing before the one about no connections left, but the most common one is:</p> <p>Caused by: org.postgresql.util.PSQLException: This statement has been closed.<br/> at org.postgresql.jdbc2.AbstractJdbc2Statement.checkClosed(AbstractJdbc2Statement.java:2444)<br/> at org.postgresql.jdbc2.AbstractJdbc2Statement.setInt(AbstractJdbc2Statement.java:1150)<br/> at org.apache.commons.dbcp.DelegatingPreparedStatement.setInt(DelegatingPreparedStatement.java:117)<br/> at org.apache.commons.dbcp.DelegatingPreparedStatement.setInt(DelegatingPreparedStatement.java:117)<br/> at org.dspace.storage.rdbms.DatabaseManager.loadParameters(DatabaseManager.java:1676)<br/> at org.dspace.storage.rdbms.DatabaseManager.query(DatabaseManager.java:219)<br/> at org.dspace.storage.rdbms.DatabaseManager.querySingle(DatabaseManager.java:302)</p> <p>But i don't know why this is happening? Any clues?</p> <p>Anyways, maybe there is some problem with the top-level Exception handling in XMLUI that is ending up making Contexts getting 'leaked'?</p> source-file",no-bug,0.9
9579,DSpace,https://github.com/DSpace/DSpace/issues/9579,Web of Science import missing entry key-ref wosPublisherContrib,"**Describe the bug** Version: DSpace 7.6.1 Missing entry key-ref wosPublisherContrib in DSpace 7.6.1 in /dspace/config/spring/api/**wos-integration.xml** **<entry key-ref=""wos.publisher"" value-ref=""wosPublisherContrib""/>**",config-file | test-file | test-file | config-file | config-file | test-file | test-file | config-file | test-file | config-file,"Web of Science import missing entry key-ref wosPublisherContrib **Describe the bug** Version: DSpace 7.6.1 Missing entry key-ref wosPublisherContrib in DSpace 7.6.1 in /dspace/config/spring/api/**wos-integration.xml** **<entry key-ref=""wos.publisher"" value-ref=""wosPublisherContrib""/>** config-file test-file test-file config-file config-file test-file test-file config-file test-file config-file",no-bug,0.9
3718,DSpace,https://github.com/DSpace/DSpace/issues/3718,[DS-343] Patch to hide empty Communities/Collections on JSPUI,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-343"">[DS-343]</a> created by franksp</i> <p>We have had many clients request this functionality.</p> <p>It adds some new config variables :<br/> webui.hide.empty-communities = false<br/> webui.hide.empty-collections = false<br/> webui.hide.empty-fromadmins = false</p> <p>When enabled, the mod will hide Communities and/or Collections that contain no items. </p> <p>Specific Communities/Collections can also be hidden by specifing them by handle:</p> <p>webui.hide.handle.1 = 123456789/1<br/> webui.hide.handle.x = 123456789/2<br/> etc</p> <p>The code changes are within JSPUI and works by filtering hidden objects from results.</p>",config-file | config-file | config-file | other-file | container-file | container-file | container-file | test-file | other-file | config-file | config-file | config-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | database-file | database-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | source-file | source-file | other-file | test-file | config-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | source-file | source-file | test-file | test-file | test-file | config-file | config-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | config-file | config-file | config-file | other-file | other-file | other-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | container-file | container-file | config-file,"[DS-343] Patch to hide empty Communities/Collections on JSPUI <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-343"">[DS-343]</a> created by franksp</i> <p>We have had many clients request this functionality.</p> <p>It adds some new config variables :<br/> webui.hide.empty-communities = false<br/> webui.hide.empty-collections = false<br/> webui.hide.empty-fromadmins = false</p> <p>When enabled, the mod will hide Communities and/or Collections that contain no items. </p> <p>Specific Communities/Collections can also be hidden by specifing them by handle:</p> <p>webui.hide.handle.1 = 123456789/1<br/> webui.hide.handle.x = 123456789/2<br/> etc</p> <p>The code changes are within JSPUI and works by filtering hidden objects from results.</p> config-file config-file config-file other-file container-file container-file container-file test-file other-file config-file config-file config-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file database-file database-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file source-file source-file other-file test-file config-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file other-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file source-file source-file test-file test-file test-file config-file config-file other-file other-file other-file other-file other-file other-file other-file other-file config-file config-file config-file config-file other-file other-file other-file other-file config-file config-file config-file config-file config-file config-file container-file container-file container-file container-file config-file",no-bug,0.9
2956,DSpace,https://github.com/DSpace/DSpace/issues/2956,Many long-lived deprecation warnings,"For example, in dspace-api, which produces a river of warnings that overflows a reasonably-sized terminal scroll buffer. This makes it difficult to see other issues. DSpace is subjected to code that may not be receiving enough attention. Some of these warnings date back at least as far as DSpace 4.0.",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file,"Many long-lived deprecation warnings For example, in dspace-api, which produces a river of warnings that overflows a reasonably-sized terminal scroll buffer. This makes it difficult to see other issues. DSpace is subjected to code that may not be receiving enough attention. Some of these warnings date back at least as far as DSpace 4.0. source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file",no-bug,0.9
8750,DSpace,https://github.com/DSpace/DSpace/issues/8750,doi-organiser command line NPE when using VersionedDOIIdentifierProvider,**Describe the bug** An NPE is thrown when trying to reserve (--reserve-doi) or register (--register-doi) an individul DOI for an item  /home/dspace/dspace/bin/dspace doi-organiser --reserve-doi 1810/347187 Exception: null java.lang.NullPointerException at org.dspace.identifier.doi.DOIOrganiser.reserve(DOIOrganiser.java:502) at org.dspace.identifier.doi.DOIOrganiser.reserve(DOIOrganiser.java:492) at org.dspace.identifier.doi.DOIOrganiser.runCLI(DOIOrganiser.java:310) at org.dspace.identifier.doi.DOIOrganiser.main(DOIOrganiser.java:103) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:566) at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:277) at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:133) at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:98)  **To Reproduce** Steps to reproduce the behavior: 1. Enable VersionedDOIIdentifierProvider in identifier-service.xml 2. Run command doi-organiser with --reserve-doi or --register-doi option **Expected behavior** The DOI is reserved or registered successfully **Related work** Link to any related tickets or PRs here.,source-file | source-file | source-file,doi-organiser command line NPE when using VersionedDOIIdentifierProvider **Describe the bug** An NPE is thrown when trying to reserve (--reserve-doi) or register (--register-doi) an individul DOI for an item  /home/dspace/dspace/bin/dspace doi-organiser --reserve-doi 1810/347187 Exception: null java.lang.NullPointerException at org.dspace.identifier.doi.DOIOrganiser.reserve(DOIOrganiser.java:502) at org.dspace.identifier.doi.DOIOrganiser.reserve(DOIOrganiser.java:492) at org.dspace.identifier.doi.DOIOrganiser.runCLI(DOIOrganiser.java:310) at org.dspace.identifier.doi.DOIOrganiser.main(DOIOrganiser.java:103) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:566) at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:277) at org.dspace.app.launcher.ScriptLauncher.handleScript(ScriptLauncher.java:133) at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:98)  **To Reproduce** Steps to reproduce the behavior: 1. Enable VersionedDOIIdentifierProvider in identifier-service.xml 2. Run command doi-organiser with --reserve-doi or --register-doi option **Expected behavior** The DOI is reserved or registered successfully **Related work** Link to any related tickets or PRs here. source-file source-file source-file,no-bug,0.9
3892,DSpace,https://github.com/DSpace/DSpace/issues/3892,[DS-518] Duplicate listing of dependencies in dspace-sword/pom.xml,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-518"">[DS-518]</a> created by caryn.n</i> <p>Two dependencies are listed twice in the sword pom. </p>",source-file,"[DS-518] Duplicate listing of dependencies in dspace-sword/pom.xml <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-518"">[DS-518]</a> created by caryn.n</i> <p>Two dependencies are listed twice in the sword pom. </p> source-file",no-bug,0.95
3247,DSpace,https://github.com/DSpace/DSpace/issues/3247,DSpace 6 build fails using latest Maven version due to blocking of restlet m2 repository,"**Describe the bug** Using the latest version of maven (3.8.1), building DSpace 6 (or DSpace 5), the build fails with a message like the following (formatted for readability):  [ERROR] Failed to execute goal on project dspace-solr: Could not resolve dependencies for project org.dspace:dspace-solr:war:6.4-SNAPSHOT: Failed to collect dependencies at org.apache.solr:solr-core:jar:4.10.4 -> org.restlet.jee:org.restlet:jar:2.1.1: Failed to read artifact descriptor for org.restlet.jee:org.restlet:jar:2.1.1: Could not transfer artifact org.restlet.jee:org.restlet:pom:2.1.1 from/to maven-default-http-blocker (http://0.0.0.0/): Blocked mirror for repositories: [ maven-snapshots (http://oss.sonatype.org/content/repositories/snapshots, default, snapshots), maven-restlet (http://maven.restlet.org, default, releases+snapshots), apache.snapshots (http://repository.apache.org/snapshots, default, disabled) ] -> [Help 1]  This is failing due to a security measure added to maven 3.8.1 ([see release notes](https://maven.apache.org/docs/3.8.1/release-notes.html)). This measure prevents the use of plain old http maven repositories in order to reduce the chance of man-in-the-middle attacks. **To Reproduce** Steps to reproduce the behavior: 1. Clear out your ~/.m2/repository/org/restlet/ directory, if present (this may not be wholly necessary, but it ensures maven will be forced to try to download the library in any case). 2. Make sure you're using the latest version of maven (currently 3.8.1) 3. Try to build dspacethe build should fail with an error like the above. **Expected behavior** It should successfully build, as it does with Maven 3.8.0 and below.",config-file | source-file | source-file | source-file | source-file | source-file | config-file | test-file,"DSpace 6 build fails using latest Maven version due to blocking of restlet m2 repository **Describe the bug** Using the latest version of maven (3.8.1), building DSpace 6 (or DSpace 5), the build fails with a message like the following (formatted for readability):  [ERROR] Failed to execute goal on project dspace-solr: Could not resolve dependencies for project org.dspace:dspace-solr:war:6.4-SNAPSHOT: Failed to collect dependencies at org.apache.solr:solr-core:jar:4.10.4 -> org.restlet.jee:org.restlet:jar:2.1.1: Failed to read artifact descriptor for org.restlet.jee:org.restlet:jar:2.1.1: Could not transfer artifact org.restlet.jee:org.restlet:pom:2.1.1 from/to maven-default-http-blocker (http://0.0.0.0/): Blocked mirror for repositories: [ maven-snapshots (http://oss.sonatype.org/content/repositories/snapshots, default, snapshots), maven-restlet (http://maven.restlet.org, default, releases+snapshots), apache.snapshots (http://repository.apache.org/snapshots, default, disabled) ] -> [Help 1]  This is failing due to a security measure added to maven 3.8.1 ([see release notes](https://maven.apache.org/docs/3.8.1/release-notes.html)). This measure prevents the use of plain old http maven repositories in order to reduce the chance of man-in-the-middle attacks. **To Reproduce** Steps to reproduce the behavior: 1. Clear out your ~/.m2/repository/org/restlet/ directory, if present (this may not be wholly necessary, but it ensures maven will be forced to try to download the library in any case). 2. Make sure you're using the latest version of maven (currently 3.8.1) 3. Try to build dspacethe build should fail with an error like the above. **Expected behavior** It should successfully build, as it does with Maven 3.8.0 and below. config-file source-file source-file source-file source-file source-file config-file test-file",no-bug,0.95
9660,DSpace,https://github.com/DSpace/DSpace/issues/9660,submitter facet unnecessary for archived items,"**Is your feature request related to a problem? Please describe.** During indexing the item for the search the submitter information is saved in some own facet https://github.com/DSpace/DSpace/blob/075e51d4d8ad675f029a1d6af6ea249e04b5781d/dspace-api/src/main/java/org/dspace/discovery/indexobject/ItemIndexFactoryImpl.java#L158 Knowing administrative and curative staff of some repository allows you to track certain people (e.g. by their surname). e.g. https://tore.tuhh.de/search?spc.page=1&query=submitter_keyword:Oliver*&configuration=site ` (DSpace-Cris) https://depositonce.tu-berlin.de/search?spc.page=1&query=submitter_keyword:Maximilian* (DSpace7) https://sandbox.dspace.org/search?spc.page=1&query=submitter_keyword:%22Demo%20Site%20Administrator%22 (Dspace8 Sandbox) Query: `submitter_keyword:""Demo Site Administrator""` ![Screenshot 2024-06-20 at 11-32-06 DSpace Repository Search](https://github.com/DSpace/DSpace/assets/33422716/bf5a171e-d2d1-4fe8-9d25-65624eb1ad5f) **Describe the solution you'd like** The submitter information is currently never used after the information is archived. Contents in metadatafield `dc.description.provenance` (containing the submitter) is not exposed and not indexed by default. We would like some additional configuration to disable the submitter facet for archived items and also some optional configuration setting to set some placeholder value instead name (e.g. John, Doe). `discovery.index.item.submitter.enabled` (boolean, default false) ~`discovery.index.item.submitter.name` (string, default null)~ **Describe alternatives or workarounds you've considered** The `submitter_authority` might be needed if you define some own discovery configuration which displays archived items for some eperson in mydspace. Thus we would prefer the configuration possibility to enable repository developers to still use submitter_authority. **Additional context** The submitter information is also indexed for inprogressItems where it is needed for the submitter Facet on workflow search configurations. The feature does not impact this facet https://github.com/DSpace/DSpace/blob/075e51d4d8ad675f029a1d6af6ea249e04b5781d/dspace-api/src/main/java/org/dspace/discovery/indexobject/InprogressSubmissionIndexFactoryImpl.java#L64 We can offer some solution for this issue. Update: After consolidation we removed the previous functionality to set some placeholder value for the value which has no value for the ui (won't be shown in the UI in the current discovery) and no value for the product.",source-file | test-file | other-file | source-file | test-file | other-file | source-file | test-file | other-file | source-file | test-file | other-file | source-file | test-file | other-file | source-file | test-file | other-file | source-file | test-file | other-file | source-file | test-file | other-file,"submitter facet unnecessary for archived items **Is your feature request related to a problem? Please describe.** During indexing the item for the search the submitter information is saved in some own facet https://github.com/DSpace/DSpace/blob/075e51d4d8ad675f029a1d6af6ea249e04b5781d/dspace-api/src/main/java/org/dspace/discovery/indexobject/ItemIndexFactoryImpl.java#L158 Knowing administrative and curative staff of some repository allows you to track certain people (e.g. by their surname). e.g. https://tore.tuhh.de/search?spc.page=1&query=submitter_keyword:Oliver*&configuration=site ` (DSpace-Cris) https://depositonce.tu-berlin.de/search?spc.page=1&query=submitter_keyword:Maximilian* (DSpace7) https://sandbox.dspace.org/search?spc.page=1&query=submitter_keyword:%22Demo%20Site%20Administrator%22 (Dspace8 Sandbox) Query: `submitter_keyword:""Demo Site Administrator""` ![Screenshot 2024-06-20 at 11-32-06 DSpace Repository Search](https://github.com/DSpace/DSpace/assets/33422716/bf5a171e-d2d1-4fe8-9d25-65624eb1ad5f) **Describe the solution you'd like** The submitter information is currently never used after the information is archived. Contents in metadatafield `dc.description.provenance` (containing the submitter) is not exposed and not indexed by default. We would like some additional configuration to disable the submitter facet for archived items and also some optional configuration setting to set some placeholder value instead name (e.g. John, Doe). `discovery.index.item.submitter.enabled` (boolean, default false) ~`discovery.index.item.submitter.name` (string, default null)~ **Describe alternatives or workarounds you've considered** The `submitter_authority` might be needed if you define some own discovery configuration which displays archived items for some eperson in mydspace. Thus we would prefer the configuration possibility to enable repository developers to still use submitter_authority. **Additional context** The submitter information is also indexed for inprogressItems where it is needed for the submitter Facet on workflow search configurations. The feature does not impact this facet https://github.com/DSpace/DSpace/blob/075e51d4d8ad675f029a1d6af6ea249e04b5781d/dspace-api/src/main/java/org/dspace/discovery/indexobject/InprogressSubmissionIndexFactoryImpl.java#L64 We can offer some solution for this issue. Update: After consolidation we removed the previous functionality to set some placeholder value for the value which has no value for the ui (won't be shown in the UI in the current discovery) and no value for the product. source-file test-file other-file source-file test-file other-file source-file test-file other-file source-file test-file other-file source-file test-file other-file source-file test-file other-file source-file test-file other-file source-file test-file other-file",no-bug,0.9
3715,DSpace,https://github.com/DSpace/DSpace/issues/3715,[DS-340] DSpace services log to the command line,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-340"">[DS-340]</a> created by stuartlewis</i> <p>When running command line scripts, the DSpace services log to the screen rather than to a log file (initially at least, before logging is configured).</p> <p>E.g.</p> <p>laptop:bin username$ ./dspace metadata-export<br/> INFO Created new kernel: DSpaceKernel:org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel:lastLoad=null:loadTime=0:running=false:kernel=null<br/> INFO Registered new Kernel MBEAN: org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel <span class=""error"">&#91;DSpaceKernel:org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel:lastLoad=null:loadTime=0:running=false:kernel=null&#93;</span><br/> INFO Registered service (org.dspace.services.events.SystemEventService) serviceName (org.dspace.services.EventService) with 2 mixins<br/> INFO Registered service (org.dspace.services.caching.CachingServiceImpl) serviceName (org.dspace.services.CachingService) with 5 mixins<br/> INFO Registered service (org.springframework.context.event.SimpleApplicationEventMulticaster) serviceName (applicationEventMulticaster) with 1 mixins<br/> INFO Registered service (org.dspace.servicemanager.config.DSpaceConfigurationService) serviceName (org.dspace.services.ConfigurationService) with 1 mixins<br/> INFO Registered service (org.springframework.context.support.DelegatingMessageSource) serviceName (messageSource) with 2 mixins<br/> INFO Registered service (org.dspace.servicemanager.DSpaceServiceManager) serviceName (org.dspace.servicemanager.ServiceManagerSystem) with 2 mixins<br/> INFO Registered service (org.springframework.cache.ehcache.EhCacheManagerFactoryBean) serviceName (org.dspace.caching.ehcache.CacheManager) with 3 mixins<br/> INFO Registered service (org.dspace.services.sessions.SessionRequestServiceImpl) serviceName (org.dspace.services.SessionService) with 4 mixins<br/> INFO Registered service (org.dspace.servicemanager.spring.DSpaceBeanPostProcessor) serviceName (org.dspace.servicemanager.spring.DSpaceBeanPostProcessor#0) with 2 mixins<br/> Registered 9 service's mixins from loaded core services<br/> INFO DSpace kernel startup completed in 1318 ms and registered as MBean: org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel<br/> Required parameter -f missing!<br/> usage: MetadataExport</p> <p> <del>a,</del>-all include all metadata fields that are not normally changed<br/> (e.g. provenance)<br/> <del>f,</del>-file destination where you want file written<br/> <del>h,</del>-help help<br/> <del>i,</del>-id ID or handle of thing to export (item, collection, or<br/> community)</p> <p>full export: metadataexport -f filename<br/> partial export: metadataexport -i handle -f filename<br/> Shutdown DSpace core service manager<br/> INFO: DSpace kernel shutdown completed and unregistered MBean: org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel</p>",other-file,"[DS-340] DSpace services log to the command line <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-340"">[DS-340]</a> created by stuartlewis</i> <p>When running command line scripts, the DSpace services log to the screen rather than to a log file (initially at least, before logging is configured).</p> <p>E.g.</p> <p>laptop:bin username$ ./dspace metadata-export<br/> INFO Created new kernel: DSpaceKernel:org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel:lastLoad=null:loadTime=0:running=false:kernel=null<br/> INFO Registered new Kernel MBEAN: org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel <span class=""error"">&#91;DSpaceKernel:org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel:lastLoad=null:loadTime=0:running=false:kernel=null&#93;</span><br/> INFO Registered service (org.dspace.services.events.SystemEventService) serviceName (org.dspace.services.EventService) with 2 mixins<br/> INFO Registered service (org.dspace.services.caching.CachingServiceImpl) serviceName (org.dspace.services.CachingService) with 5 mixins<br/> INFO Registered service (org.springframework.context.event.SimpleApplicationEventMulticaster) serviceName (applicationEventMulticaster) with 1 mixins<br/> INFO Registered service (org.dspace.servicemanager.config.DSpaceConfigurationService) serviceName (org.dspace.services.ConfigurationService) with 1 mixins<br/> INFO Registered service (org.springframework.context.support.DelegatingMessageSource) serviceName (messageSource) with 2 mixins<br/> INFO Registered service (org.dspace.servicemanager.DSpaceServiceManager) serviceName (org.dspace.servicemanager.ServiceManagerSystem) with 2 mixins<br/> INFO Registered service (org.springframework.cache.ehcache.EhCacheManagerFactoryBean) serviceName (org.dspace.caching.ehcache.CacheManager) with 3 mixins<br/> INFO Registered service (org.dspace.services.sessions.SessionRequestServiceImpl) serviceName (org.dspace.services.SessionService) with 4 mixins<br/> INFO Registered service (org.dspace.servicemanager.spring.DSpaceBeanPostProcessor) serviceName (org.dspace.servicemanager.spring.DSpaceBeanPostProcessor#0) with 2 mixins<br/> Registered 9 service's mixins from loaded core services<br/> INFO DSpace kernel startup completed in 1318 ms and registered as MBean: org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel<br/> Required parameter -f missing!<br/> usage: MetadataExport</p> <p> <del>a,</del>-all include all metadata fields that are not normally changed<br/> (e.g. provenance)<br/> <del>f,</del>-file destination where you want file written<br/> <del>h,</del>-help help<br/> <del>i,</del>-id ID or handle of thing to export (item, collection, or<br/> community)</p> <p>full export: metadataexport -f filename<br/> partial export: metadataexport -i handle -f filename<br/> Shutdown DSpace core service manager<br/> INFO: DSpace kernel shutdown completed and unregistered MBean: org.dspace:name=4ca61ba8-d4a4-4fca-bd26-ed842d55c3b8,type=DSpaceKernel</p> other-file",no-bug,0.95
3281,DSpace,https://github.com/DSpace/DSpace/issues/3281,Restriction of email domains for self-registration has no effect,"**Describe the bug** Setting ""authentication-password.domain.valid = example.com"" in the local.cfg file has no effect. Self-registration is still possible with other email domains. **Expected behavior** When ""authentication-password.domain.valid"" is specified in local.cfg, self-registration should only be possible with the respective domains. Related to #3272",source-file | test-file | source-file,"Restriction of email domains for self-registration has no effect **Describe the bug** Setting ""authentication-password.domain.valid = example.com"" in the local.cfg file has no effect. Self-registration is still possible with other email domains. **Expected behavior** When ""authentication-password.domain.valid"" is specified in local.cfg, self-registration should only be possible with the respective domains. Related to #3272 source-file test-file source-file",no-bug,0.7
7083,DSpace,https://github.com/DSpace/DSpace/issues/7083,[DS-3736] EPerson REST endpoint should expose groups as a link,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3736"">[DS-3736]</a> created by bollini</i> <p>The EPerson REST endpoint includes information about the groups that the eperson is member of. The groups should be exposed as links instead to be inline in the eperson resource</p>",config-file | config-file | other-file,"[DS-3736] EPerson REST endpoint should expose groups as a link <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3736"">[DS-3736]</a> created by bollini</i> <p>The EPerson REST endpoint includes information about the groups that the eperson is member of. The groups should be exposed as links instead to be inline in the eperson resource</p> config-file config-file other-file",no-bug,0.8
3061,DSpace,https://github.com/DSpace/DSpace/issues/3061,Many warnings from errorprone,"Clearing away a long list of deprecation warnings exposes a number of warnings and suggestions from `errorprone`. Addressing these would not only improve code quality, but make it easier to see the remaining compiler warnings.",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | test-file,"Many warnings from errorprone Clearing away a long list of deprecation warnings exposes a number of warnings and suggestions from `errorprone`. Addressing these would not only improve code quality, but make it easier to see the remaining compiler warnings. source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file source-file source-file source-file source-file test-file",no-bug,0.9
8148,DSpace,https://github.com/DSpace/DSpace/issues/8148,DSpaceApiExceptionControllerAdvice logs nothing of interest,"**Describe the bug** Method `sendErrorResponse` is also responsible for logging the exception, but except in a few specific cases it logs only the HTTP response code, without mentioning the actual exception or location. In the few specific cases we get a stack trace. As stated in comments, we probably don't want that level of detail for most exceptions, but I think that we *do* want to know what happened and where -- why are we sending this non-success response? **To Reproduce** Steps to reproduce the behavior: 1. Trigger a 404 response. 2. See the log. All you'll find is ""org.dspace.app.rest.exception.DSpaceApiExceptionControllerAdvice @ An exception has occurred (status:404)"". **Expected behavior** When logging an exception, we should always log the actual exception and its location.",source-file | source-file | source-file | config-file | source-file | config-file | other-file | other-file,"DSpaceApiExceptionControllerAdvice logs nothing of interest **Describe the bug** Method `sendErrorResponse` is also responsible for logging the exception, but except in a few specific cases it logs only the HTTP response code, without mentioning the actual exception or location. In the few specific cases we get a stack trace. As stated in comments, we probably don't want that level of detail for most exceptions, but I think that we *do* want to know what happened and where -- why are we sending this non-success response? **To Reproduce** Steps to reproduce the behavior: 1. Trigger a 404 response. 2. See the log. All you'll find is ""org.dspace.app.rest.exception.DSpaceApiExceptionControllerAdvice @ An exception has occurred (status:404)"". **Expected behavior** When logging an exception, we should always log the actual exception and its location. source-file source-file source-file config-file source-file config-file other-file other-file",no-bug,0.9
8320,DSpace,https://github.com/DSpace/DSpace/issues/8320,Address many long-standing LGTM complaints,"**Describe the bug** LGTM calls out many things that it sees as problems, which we have never addressed. **To Reproduce** Submit a pull request, and watch LGTM report more than 150 issues that have nothing to do with your changes. **Expected behavior** LGTM should have little or (preferably) nothing to point out.",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,"Address many long-standing LGTM complaints **Describe the bug** LGTM calls out many things that it sees as problems, which we have never addressed. **To Reproduce** Submit a pull request, and watch LGTM report more than 150 issues that have nothing to do with your changes. **Expected behavior** LGTM should have little or (preferably) nothing to point out. source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file",no-bug,0.9
3427,DSpace,https://github.com/DSpace/DSpace/issues/3427,[DS-49] Add support for DjVu-documents - ID: 2234659,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-49"">[DS-49]</a> created by kipkorir2008</i> <p>Hello All</p> <p>This patch based on<br/> <a href=""http://mailman.mit.edu/pipermail/dspace-general/2007-May/001513.html"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://mailman.mit.edu/pipermail/dspace-general/2007-May/001513.html</a></p> <p>In DSpace 1.5.0+ we need (before compilation)</p> <p>1) Add utility djvutxt (package djvulibre), for Debian it is:<br/> apt-get install djvulibre-bin</p> <p>2) Edit <span class=""error"">&#91;dspace-source&#93;</span>/dspace/config/dspace.cfg, text-block "" Media<br/> Filter / Format Filter plugins""<br/> and add DjVu-support in 3 places:</p> <p>filter.plugins =  \<br/> DjVu Text Extractor</p> <p>plugin.named.org.dspace.app.mediafilter.FormatFilter =  \<br/> org.dspace.app.mediafilter.DjVuFilter = DjVu Text Extractor</p> <p>filter.org.dspace.app.mediafilter.DjVuFilter.inputFormats = DjVu</p> <p>3) Edit <span class=""error"">&#91;dspace-source&#93;</span>/dspace/config/registries/bitstream-formats.xml<br/> and add next</p> <p><bitstream-type><br/> <mimetype>image/vnd.djvu</mimetype><br/> <short_description>DjVu</short_description><br/> <description>DjVu</description><br/> <support_level>1</support_level><br/> <internal>false</internal><br/> <extension>djvu</extension><br/> <extension>djv</extension><br/> </bitstream-type></p> <p>4) Create file<br/> <span class=""error"">&#91;dspace-source&#93;</span>/dspace-api/src/main/java/org/dspace/app/mediafilter/DjVuFil<br/> ter.java<br/> with next content</p> <p>/*<br/> DjVuFilter.java<br/> Version: 0.1<br/> DSpace version: 1.4.2 beta<br/> Author: Ivan Penev<br/> e-mail: inpenev at gmail.com<br/> */</p> <p>package org.dspace.app.mediafilter;</p> <p>import java.io.InputStream;<br/> import java.io.FileInputStream;<br/> import java.io.BufferedInputStream;<br/> import java.io.ByteArrayInputStream;<br/> import java.io.OutputStream;<br/> import java.io.FileOutputStream;<br/> import java.io.BufferedOutputStream;<br/> import java.io.FileReader;<br/> import java.io.BufferedReader;<br/> import java.io.File;</p> <p>/**</p> <ul> <li>This class provides a media filter for processing files of type DjVu.</li> <li><p>The current implementation uses a program called<br/> <code>djvutxt</code>, which extracts the text layer from a previously<br/> OCR-ed DjVu file and saves it into a UTF-8 text document. The program<br/> is distributed with the <code>djvulibre</code> package which is freely<br/> available under the GPL license from <a<br/> href=""http://djvu.sourceforge.net/""><a href=""http://djvu.sourceforge.net/"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://djvu.sourceforge.net/</a></a><br/> for both Unix and Windows operating systems. Hence, for the media<br/> filter to work it is required that <code>djvutxt</code> is a valid<br/> command (in the working environment).</p><br/> */</li> </ul> <p>public class DjVuFilter extends MediaFilter<br/> {<br/> /**</p> <ul> <li>Get a filename for a newly created filtered bitstream.<br/> *</li> <li>@param sourceName</li> <li>name of source bitstream</li> <li>@return filename generated by the filter - for example, document.djvu</li> <li>becomes document.djvu.txt<br/> */</li> </ul> <p>public String getFilteredName(String sourceName)<br/> {<br/> return sourceName + "".txt"";<br/> }</p> <p>/**</p> <ul> <li>Get name of the bundle this filter will stick its generated<br/> bitstreams.<br/> *</li> <li>@return ""TEXT""<br/> */<br/> public String getBundleName()<br/> {<br/> return ""TEXT"";<br/> }</li> </ul> <p>/**</p> <ul> <li>Get name of the bitstream format returned by this filter.<br/> *</li> <li>@return ""Text""<br/> */</li> </ul> <p>public String getFormatString()<br/> {<br/> return ""Text"";<br/> }</p> <p>/**</p> <ul> <li>Get a string describing the newly-generated bitstream.<br/> *</li> <li>@return ""Extracted text""<br/> */</li> </ul> <p>public String getDescription()<br/> {<br/> return ""Extracted text"";<br/> }</p> <p>/**</p> <ul> <li>Get a bitstream filled with the extracted text from a DjVu bitstream.</li> <li><p>The bitstream supplied as a parameter is written to a DjVu<br/> file on the file system (in the working directory), and the system<br/> command <code>djvutxt</code> is called on the latter to produce a<br/> UTF-8 text file containg the extracted text. The file is then copied<br/> to a bitstream. Finally, the auxiliary files are removed from the file<br/> system, and the generated bitsream is returned as a result.</p></li> <li><p>WARNING! Write access to the working directory is needed for<br/> this method to operate! No exception handling provided!</p><br/> *</li> <li>@param source</li> <li>input stream<br/> *</li> <li>@return result of filter's transformation, written out to a bitstream<br/> */</li> </ul> <p>public InputStream getDestinationStream(InputStream source) throws<br/> Exception<br/> {<br/> /* Some convenience initializations. */<br/> final String cmd = ""djvutxt"";<br/> final String fileName = ""aux"";<br/> final String djvuFileName = fileName + "".djvu"";<br/> final String txtFileName = fileName + "".txt"";</p> <p>/* Store input bitstresam to auxiliary DjVu file. */<br/> File djvuFile = streamToFile(source, djvuFileName);</p> <p>/* Invoke external command djvutxt with appropriate agruments<br/> to do the actual job */<br/> final String[] cmdArray = </p> {cmd, djvuFileName, txtFileName} <p>;<br/> Process p = Runtime.getRuntime().exec(cmdArray);<br/> /* and wait for it to terminate */<br/> p.waitFor();</p> <p>/* Copy extracted text from file to an independent bitstream,<br/> and optionally print the text to standard output. */<br/> File txtFile = new File(txtFileName);<br/> InputStream dest = fileToStream(txtFile, MediaFilterManager.isVerbose);</p> <p>/* Then remove auxiliary files*/<br/> djvuFile.delete();<br/> txtFile.delete();<br/> /* and return resulting bitstream. */<br/> return dest;<br/> }</p> <p>/**</p> <ul> <li>Write given input stream to a file on the file system.</li> <li><p>WARNING! No exception handling!</p><br/> *</li> <li>@param inStream input stream</li> <li>@param fileName name of the file to be generated<br/> *</li> <li>@return <code>File</code> object associated with the generated file<br/> *</li> <li>@throws Exception<br/> */</li> </ul> <p>private File streamToFile(InputStream inStream, String fileName)<br/> throws Exception</p> { /* Data will be read from input stream in chunks of size e.g. 4KB. */ final int chunkSize = 4096; byte[] byteArray = new byte[chunkSize]; /* Open the stream for buffered reading. */ InputStream bufInStream = new BufferedInputStream(inStream); /* Create an empty file (if the file already exists, it will be left untouched) to store the supplied bitstream */ File file = new File(fileName); file.createNewFile(); /* and associate a buffered output stream with it. */ OutputStream bufOutStream = new BufferedOutputStream(new FileOutputStream(file)); /* Copy data from input stream to newly generated file. */ int readBytes = -1; while ((readBytes = bufInStream.read(byteArray, 0, chunkSize)) != -1) bufOutStream.write(byteArray, 0, readBytes); /* Stop transactions to the file system */ bufOutStream.close(); /* and return result. */ return file; } /** * Produce input stream from a given file on the file system. * <p>WARNING! No exception handling!</p> * * @param file <code>File</code> object associated with the given file * * @return input stream containing the data read from file * *@throws Exception */ private InputStream fileToStream(File file, boolean verbose) throws Exception { /* Open the stream for reading. */ InputStream inStream = new FileInputStream(file); /* Allocate necessary memory for data buffer. */ byte[] byteArray = new byte[(int)file.length()]; /* Load file contents into buffer. */ inStream.read(byteArray); /* And imediately close transactions with the file system. */ inStream.close(); /* If required to send the retrieved data to standard output */ if (verbose) { /* Open the file again, but this tim handle it as a character stream */ BufferedReader bufReader = new BufferedReader(new FileReader(file)); /* then print its contents line by line to the standard output */ String lineOfText = null; while ((lineOfText = bufReader.readLine()) != null) System.out.println(lineOfText); /* and close connection to the file. */ bufReader.close(); } /* Finally, generate and return input stream containing desired data. */ return new ByteArrayInputStream(byteArray); } } <p>5) Compilation/recompilation<br/> cd <span class=""error"">&#91;dspace-source&#93;</span>/dspace/dspace-1.5.0-src-release/dspace/<br/> mvn package</p> <p>6) Install or for recompilation - </p> {edit work bitstream-formats.xml & dspace.cfg as above and replace dspace-api-1.5.0.jar from folders webapps/jspui/WEB-INF/lib/, lib/, webapps/lni/WEB-INF/lib/, webapps/oai/WEB-INF/lib/, webapps/xmlui/WEB-INF/lib/ by compiled [dspace-source]/dspace-api/target/dspace-api-1.5.0.jar} <p>7) Don't forgive restart Tomcat and run<br/> /usr/share/dspace/bin/filter-media</p> <p>With best regards<br/> Serhij Dubyk</p>",config-file | config-file,"[DS-49] Add support for DjVu-documents - ID: 2234659 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-49"">[DS-49]</a> created by kipkorir2008</i> <p>Hello All</p> <p>This patch based on<br/> <a href=""http://mailman.mit.edu/pipermail/dspace-general/2007-May/001513.html"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://mailman.mit.edu/pipermail/dspace-general/2007-May/001513.html</a></p> <p>In DSpace 1.5.0+ we need (before compilation)</p> <p>1) Add utility djvutxt (package djvulibre), for Debian it is:<br/> apt-get install djvulibre-bin</p> <p>2) Edit <span class=""error"">&#91;dspace-source&#93;</span>/dspace/config/dspace.cfg, text-block "" Media<br/> Filter / Format Filter plugins""<br/> and add DjVu-support in 3 places:</p> <p>filter.plugins =  \<br/> DjVu Text Extractor</p> <p>plugin.named.org.dspace.app.mediafilter.FormatFilter =  \<br/> org.dspace.app.mediafilter.DjVuFilter = DjVu Text Extractor</p> <p>filter.org.dspace.app.mediafilter.DjVuFilter.inputFormats = DjVu</p> <p>3) Edit <span class=""error"">&#91;dspace-source&#93;</span>/dspace/config/registries/bitstream-formats.xml<br/> and add next</p> <p><bitstream-type><br/> <mimetype>image/vnd.djvu</mimetype><br/> <short_description>DjVu</short_description><br/> <description>DjVu</description><br/> <support_level>1</support_level><br/> <internal>false</internal><br/> <extension>djvu</extension><br/> <extension>djv</extension><br/> </bitstream-type></p> <p>4) Create file<br/> <span class=""error"">&#91;dspace-source&#93;</span>/dspace-api/src/main/java/org/dspace/app/mediafilter/DjVuFil<br/> ter.java<br/> with next content</p> <p>/*<br/> DjVuFilter.java<br/> Version: 0.1<br/> DSpace version: 1.4.2 beta<br/> Author: Ivan Penev<br/> e-mail: inpenev at gmail.com<br/> */</p> <p>package org.dspace.app.mediafilter;</p> <p>import java.io.InputStream;<br/> import java.io.FileInputStream;<br/> import java.io.BufferedInputStream;<br/> import java.io.ByteArrayInputStream;<br/> import java.io.OutputStream;<br/> import java.io.FileOutputStream;<br/> import java.io.BufferedOutputStream;<br/> import java.io.FileReader;<br/> import java.io.BufferedReader;<br/> import java.io.File;</p> <p>/**</p> <ul> <li>This class provides a media filter for processing files of type DjVu.</li> <li><p>The current implementation uses a program called<br/> <code>djvutxt</code>, which extracts the text layer from a previously<br/> OCR-ed DjVu file and saves it into a UTF-8 text document. The program<br/> is distributed with the <code>djvulibre</code> package which is freely<br/> available under the GPL license from <a<br/> href=""http://djvu.sourceforge.net/""><a href=""http://djvu.sourceforge.net/"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://djvu.sourceforge.net/</a></a><br/> for both Unix and Windows operating systems. Hence, for the media<br/> filter to work it is required that <code>djvutxt</code> is a valid<br/> command (in the working environment).</p><br/> */</li> </ul> <p>public class DjVuFilter extends MediaFilter<br/> {<br/> /**</p> <ul> <li>Get a filename for a newly created filtered bitstream.<br/> *</li> <li>@param sourceName</li> <li>name of source bitstream</li> <li>@return filename generated by the filter - for example, document.djvu</li> <li>becomes document.djvu.txt<br/> */</li> </ul> <p>public String getFilteredName(String sourceName)<br/> {<br/> return sourceName + "".txt"";<br/> }</p> <p>/**</p> <ul> <li>Get name of the bundle this filter will stick its generated<br/> bitstreams.<br/> *</li> <li>@return ""TEXT""<br/> */<br/> public String getBundleName()<br/> {<br/> return ""TEXT"";<br/> }</li> </ul> <p>/**</p> <ul> <li>Get name of the bitstream format returned by this filter.<br/> *</li> <li>@return ""Text""<br/> */</li> </ul> <p>public String getFormatString()<br/> {<br/> return ""Text"";<br/> }</p> <p>/**</p> <ul> <li>Get a string describing the newly-generated bitstream.<br/> *</li> <li>@return ""Extracted text""<br/> */</li> </ul> <p>public String getDescription()<br/> {<br/> return ""Extracted text"";<br/> }</p> <p>/**</p> <ul> <li>Get a bitstream filled with the extracted text from a DjVu bitstream.</li> <li><p>The bitstream supplied as a parameter is written to a DjVu<br/> file on the file system (in the working directory), and the system<br/> command <code>djvutxt</code> is called on the latter to produce a<br/> UTF-8 text file containg the extracted text. The file is then copied<br/> to a bitstream. Finally, the auxiliary files are removed from the file<br/> system, and the generated bitsream is returned as a result.</p></li> <li><p>WARNING! Write access to the working directory is needed for<br/> this method to operate! No exception handling provided!</p><br/> *</li> <li>@param source</li> <li>input stream<br/> *</li> <li>@return result of filter's transformation, written out to a bitstream<br/> */</li> </ul> <p>public InputStream getDestinationStream(InputStream source) throws<br/> Exception<br/> {<br/> /* Some convenience initializations. */<br/> final String cmd = ""djvutxt"";<br/> final String fileName = ""aux"";<br/> final String djvuFileName = fileName + "".djvu"";<br/> final String txtFileName = fileName + "".txt"";</p> <p>/* Store input bitstresam to auxiliary DjVu file. */<br/> File djvuFile = streamToFile(source, djvuFileName);</p> <p>/* Invoke external command djvutxt with appropriate agruments<br/> to do the actual job */<br/> final String[] cmdArray = </p> {cmd, djvuFileName, txtFileName} <p>;<br/> Process p = Runtime.getRuntime().exec(cmdArray);<br/> /* and wait for it to terminate */<br/> p.waitFor();</p> <p>/* Copy extracted text from file to an independent bitstream,<br/> and optionally print the text to standard output. */<br/> File txtFile = new File(txtFileName);<br/> InputStream dest = fileToStream(txtFile, MediaFilterManager.isVerbose);</p> <p>/* Then remove auxiliary files*/<br/> djvuFile.delete();<br/> txtFile.delete();<br/> /* and return resulting bitstream. */<br/> return dest;<br/> }</p> <p>/**</p> <ul> <li>Write given input stream to a file on the file system.</li> <li><p>WARNING! No exception handling!</p><br/> *</li> <li>@param inStream input stream</li> <li>@param fileName name of the file to be generated<br/> *</li> <li>@return <code>File</code> object associated with the generated file<br/> *</li> <li>@throws Exception<br/> */</li> </ul> <p>private File streamToFile(InputStream inStream, String fileName)<br/> throws Exception</p> { /* Data will be read from input stream in chunks of size e.g. 4KB. */ final int chunkSize = 4096; byte[] byteArray = new byte[chunkSize]; /* Open the stream for buffered reading. */ InputStream bufInStream = new BufferedInputStream(inStream); /* Create an empty file (if the file already exists, it will be left untouched) to store the supplied bitstream */ File file = new File(fileName); file.createNewFile(); /* and associate a buffered output stream with it. */ OutputStream bufOutStream = new BufferedOutputStream(new FileOutputStream(file)); /* Copy data from input stream to newly generated file. */ int readBytes = -1; while ((readBytes = bufInStream.read(byteArray, 0, chunkSize)) != -1) bufOutStream.write(byteArray, 0, readBytes); /* Stop transactions to the file system */ bufOutStream.close(); /* and return result. */ return file; } /** * Produce input stream from a given file on the file system. * <p>WARNING! No exception handling!</p> * * @param file <code>File</code> object associated with the given file * * @return input stream containing the data read from file * *@throws Exception */ private InputStream fileToStream(File file, boolean verbose) throws Exception { /* Open the stream for reading. */ InputStream inStream = new FileInputStream(file); /* Allocate necessary memory for data buffer. */ byte[] byteArray = new byte[(int)file.length()]; /* Load file contents into buffer. */ inStream.read(byteArray); /* And imediately close transactions with the file system. */ inStream.close(); /* If required to send the retrieved data to standard output */ if (verbose) { /* Open the file again, but this tim handle it as a character stream */ BufferedReader bufReader = new BufferedReader(new FileReader(file)); /* then print its contents line by line to the standard output */ String lineOfText = null; while ((lineOfText = bufReader.readLine()) != null) System.out.println(lineOfText); /* and close connection to the file. */ bufReader.close(); } /* Finally, generate and return input stream containing desired data. */ return new ByteArrayInputStream(byteArray); } } <p>5) Compilation/recompilation<br/> cd <span class=""error"">&#91;dspace-source&#93;</span>/dspace/dspace-1.5.0-src-release/dspace/<br/> mvn package</p> <p>6) Install or for recompilation - </p> {edit work bitstream-formats.xml & dspace.cfg as above and replace dspace-api-1.5.0.jar from folders webapps/jspui/WEB-INF/lib/, lib/, webapps/lni/WEB-INF/lib/, webapps/oai/WEB-INF/lib/, webapps/xmlui/WEB-INF/lib/ by compiled [dspace-source]/dspace-api/target/dspace-api-1.5.0.jar} <p>7) Don't forgive restart Tomcat and run<br/> /usr/share/dspace/bin/filter-media</p> <p>With best regards<br/> Serhij Dubyk</p> config-file config-file",no-bug,0.95
2962,DSpace,https://github.com/DSpace/DSpace/issues/2962,CORS policy issue when retrieving bitstream through Angular,"**Describe the bug** During the implementation of the Angular counterpart of the [scripts and processes output](https://github.com/DSpace/DSpace/pull/2934), @MarieVerdonck noticed the following error when retrieving the output bitstream through a GET call of the relevant `process._links.output.href` link >Access to XMLHttpRequest at 'http://localhost:8080/server/api/core/bitstreams/fd4bf164-a876-486d-95a6-d9f24cb23700/content?authentication-token=eyJhbGciOiJIUzI1NiJ9.eyJlaWQiOiJjZDgyNGE2MS05NWJlLTRlMTYtYmNjZC01MWZlYTI2NzA3ZDAiLCJzZyI6W10sImV4cCI6MTU5OTcyNzMzOH0.s3EVCgQjjw1dLq2auJnDCzhb6ze59LxDYgEeX6tHHw0' from origin 'http://localhost:4000' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource. This LOOKS to be CORS related at a first glance, but might need additional investigation as well. **Request**  curl --location --request GET 'http://localhost:8080/server/api/core/bitstreams/fd4bf164-a876-486d-95a6-d9f24cb23700/content' \ --header 'Authorization: Bearer {{currentAccessToken}}'  **Response headers:** ![Screenshot 2020-09-10 at 11 31 53](https://user-images.githubusercontent.com/11884252/92738652-6b4e2880-f37c-11ea-9abc-d5be9ff5b2ac.png) This might be solvable if the CORS headers are properly set through the REST Api, it might also have another underlying issue that is not readily apparent. **To Reproduce** Steps to reproduce the behaviour: 1. Setup [REST PR](https://github.com/DSpace/DSpace/pull/2934) 2. Setup [Angular PR](https://github.com/DSpace/dspace-angular/pull/827) 3. Make sure to trigger a script that keeps output in a file. 4. Try to download that particular output bitstream **Expected behaviour** The bitstream should be properly 'downloaded', no CORS error should be logged, and the information of the logs should be shown in the UI **Related work** https://github.com/DSpace/DSpace/pull/2934 https://github.com/DSpace/dspace-angular/pull/827",source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file,"CORS policy issue when retrieving bitstream through Angular **Describe the bug** During the implementation of the Angular counterpart of the [scripts and processes output](https://github.com/DSpace/DSpace/pull/2934), @MarieVerdonck noticed the following error when retrieving the output bitstream through a GET call of the relevant `process._links.output.href` link >Access to XMLHttpRequest at 'http://localhost:8080/server/api/core/bitstreams/fd4bf164-a876-486d-95a6-d9f24cb23700/content?authentication-token=eyJhbGciOiJIUzI1NiJ9.eyJlaWQiOiJjZDgyNGE2MS05NWJlLTRlMTYtYmNjZC01MWZlYTI2NzA3ZDAiLCJzZyI6W10sImV4cCI6MTU5OTcyNzMzOH0.s3EVCgQjjw1dLq2auJnDCzhb6ze59LxDYgEeX6tHHw0' from origin 'http://localhost:4000' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource. This LOOKS to be CORS related at a first glance, but might need additional investigation as well. **Request**  curl --location --request GET 'http://localhost:8080/server/api/core/bitstreams/fd4bf164-a876-486d-95a6-d9f24cb23700/content' \ --header 'Authorization: Bearer {{currentAccessToken}}'  **Response headers:** ![Screenshot 2020-09-10 at 11 31 53](https://user-images.githubusercontent.com/11884252/92738652-6b4e2880-f37c-11ea-9abc-d5be9ff5b2ac.png) This might be solvable if the CORS headers are properly set through the REST Api, it might also have another underlying issue that is not readily apparent. **To Reproduce** Steps to reproduce the behaviour: 1. Setup [REST PR](https://github.com/DSpace/DSpace/pull/2934) 2. Setup [Angular PR](https://github.com/DSpace/dspace-angular/pull/827) 3. Make sure to trigger a script that keeps output in a file. 4. Try to download that particular output bitstream **Expected behaviour** The bitstream should be properly 'downloaded', no CORS error should be logged, and the information of the logs should be shown in the UI **Related work** https://github.com/DSpace/DSpace/pull/2934 https://github.com/DSpace/dspace-angular/pull/827 source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file",bug,0.85
6722,DSpace,https://github.com/DSpace/DSpace/issues/6722,[DS-3367] Configurable Workflow authorization denied error,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3367"">[DS-3367]</a> created by tarje.lavik@ub.uib.no</i> <p>After upgrading by git merging 5.6 into 5.5 the non-administrator users get this error msg in XMLUI after clicking a submission in the pool, then on the metadata page click ""take task"". </p> <p>We use the ""configurable"" workflow.</p> <blockquote> <p>An error has occurred:<br/> JavaException: org.dspace.authorize.AuthorizeException: Authorization denied for action WRITE on ITEM:53907 by user 790</p></blockquote> <p>The item disappears from ""submissions"" and is only found by the ""Workflow overview"" with the ""Step"" info ""Unknown state"". <br/> It is also possible to find the document with the item # on ""Items"". </p> <p>In the dspace.log no error messages appears, but i might have missed it.</p> <p>Downgrading to 5.5 on our test server fixed the problem, but i would rather not downgrade on production.<br/> After the upgrade i checked <tt>bin/dspace database info</tt>, and it stated that it was on 5.6.</p> <p>This might be a separate jira issue, but there is a similar error in the dspace.log file connected to Sword deposits. </p> <blockquote> <p>2016-10-26 18:34:03,741 ERROR org.dspace.sword.DSpaceSWORDServer @ caught exception:<br/> org.dspace.sword.DSpaceSWORDException: org.dspace.authorize.AuthorizeException: Authorization denied for action WRITE on ITEM:58858 by user 1066</p></blockquote>",config-file | config-file,"[DS-3367] Configurable Workflow authorization denied error <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3367"">[DS-3367]</a> created by tarje.lavik@ub.uib.no</i> <p>After upgrading by git merging 5.6 into 5.5 the non-administrator users get this error msg in XMLUI after clicking a submission in the pool, then on the metadata page click ""take task"". </p> <p>We use the ""configurable"" workflow.</p> <blockquote> <p>An error has occurred:<br/> JavaException: org.dspace.authorize.AuthorizeException: Authorization denied for action WRITE on ITEM:53907 by user 790</p></blockquote> <p>The item disappears from ""submissions"" and is only found by the ""Workflow overview"" with the ""Step"" info ""Unknown state"". <br/> It is also possible to find the document with the item # on ""Items"". </p> <p>In the dspace.log no error messages appears, but i might have missed it.</p> <p>Downgrading to 5.5 on our test server fixed the problem, but i would rather not downgrade on production.<br/> After the upgrade i checked <tt>bin/dspace database info</tt>, and it stated that it was on 5.6.</p> <p>This might be a separate jira issue, but there is a similar error in the dspace.log file connected to Sword deposits. </p> <blockquote> <p>2016-10-26 18:34:03,741 ERROR org.dspace.sword.DSpaceSWORDServer @ caught exception:<br/> org.dspace.sword.DSpaceSWORDException: org.dspace.authorize.AuthorizeException: Authorization denied for action WRITE on ITEM:58858 by user 1066</p></blockquote> config-file config-file",no-bug,0.9
2938,DSpace,https://github.com/DSpace/DSpace/issues/2938,JWT Authentication Token(s) should not store IP address by default,"**Describe the bug** This bug was encountered on the demo site (https://dspace7-demo.atmire.com/) backend and was the cause of two other bugs (#2920 and #2935) which only existed on the demo site. The problem is simply that, *by default* the JWT authentication token stores the user's IP address. While this works fine in simple DSpace setups, it is problematic if you are using a Proxy or ISP or hosting service where the IP address may change in the middle of a user session. When the IP changes, the user's session is invalidated and they need to login again. **Expected behavior** The JWT authentication token should NEVER store a user's IP address as that information is not guaranteed to be stable/consistent. As soon as the IP changes, the token can no longer be validated. Therefore, ideally, once we have reenabled CSRF protection (#2922), we should **completely remove the following settings**: * `jwt.login.token.include.ip` * `jwt.shortLived.token.include.ip` **Quick Fix** If any users encounter either previous bug (especially #2935 which is easy to test), they should disable the existing settings in their `local.cfg` by adding:  jwt.login.token.include.ip = false jwt.shortLived.token.include.ip = false  Once this bug is fixed, those settings can be removed as the IP will never be included in those authentication tokens. **Related Work** * Somewhat depends on #2922. Including the IP address in these tokens is a form of basic ""protection"" against attacks like CSRF. However, it's a flawed solution as described above. That said, the IP address in the token is completely unnecessary once #2922 is merged.",source-file | source-file | source-file | test-file | other-file,"JWT Authentication Token(s) should not store IP address by default **Describe the bug** This bug was encountered on the demo site (https://dspace7-demo.atmire.com/) backend and was the cause of two other bugs (#2920 and #2935) which only existed on the demo site. The problem is simply that, *by default* the JWT authentication token stores the user's IP address. While this works fine in simple DSpace setups, it is problematic if you are using a Proxy or ISP or hosting service where the IP address may change in the middle of a user session. When the IP changes, the user's session is invalidated and they need to login again. **Expected behavior** The JWT authentication token should NEVER store a user's IP address as that information is not guaranteed to be stable/consistent. As soon as the IP changes, the token can no longer be validated. Therefore, ideally, once we have reenabled CSRF protection (#2922), we should **completely remove the following settings**: * `jwt.login.token.include.ip` * `jwt.shortLived.token.include.ip` **Quick Fix** If any users encounter either previous bug (especially #2935 which is easy to test), they should disable the existing settings in their `local.cfg` by adding:  jwt.login.token.include.ip = false jwt.shortLived.token.include.ip = false  Once this bug is fixed, those settings can be removed as the IP will never be included in those authentication tokens. **Related Work** * Somewhat depends on #2922. Including the IP address in these tokens is a form of basic ""protection"" against attacks like CSRF. However, it's a flawed solution as described above. That said, the IP address in the token is completely unnecessary once #2922 is merged. source-file source-file source-file test-file other-file",no-bug,0.9
9667,DSpace,https://github.com/DSpace/DSpace/issues/9667,Request-a-copy link has subpath stripped from dspace.ui.url,"In a dspace instance configured to run at a subpath, that subpath is stripped when request-a-copy link is generated here: https://github.com/DSpace/DSpace/blob/87f66fbc55cf2b8f8e265d74ce2c902ac2ee7e26/dspace-server-webapp/src/main/java/org/dspace/app/rest/repository/RequestItemRepository.java#L300 URIBuilder.setPathSegments removes any exiting path segments from the base url before adding the new segments.",source-file | test-file | source-file | test-file | source-file | test-file,"Request-a-copy link has subpath stripped from dspace.ui.url In a dspace instance configured to run at a subpath, that subpath is stripped when request-a-copy link is generated here: https://github.com/DSpace/DSpace/blob/87f66fbc55cf2b8f8e265d74ce2c902ac2ee7e26/dspace-server-webapp/src/main/java/org/dspace/app/rest/repository/RequestItemRepository.java#L300 URIBuilder.setPathSegments removes any exiting path segments from the base url before adding the new segments. source-file test-file source-file test-file source-file test-file",bug,0.9
3520,DSpace,https://github.com/DSpace/DSpace/issues/3520,[DS-145] messages_el.xml for DSpace 1.5.1 XMLUI - ID: 2615647,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-145"">[DS-145]</a> created by kipkorir2008</i> <p>This is the traslated messages.xml file for XMLUI Greek language</p> <p>Translation was made from the Library of ATEI of Thessaloniki with the help<br/> of the Open University of Cyprus<br/> In some messages the words ""DSpace"" are translated as ""Eureka"" (the name of<br/> our repository)</p>",config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | config-file | config-file | config-file | source-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | source-file | config-file | config-file | other-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file,"[DS-145] messages_el.xml for DSpace 1.5.1 XMLUI - ID: 2615647 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-145"">[DS-145]</a> created by kipkorir2008</i> <p>This is the traslated messages.xml file for XMLUI Greek language</p> <p>Translation was made from the Library of ATEI of Thessaloniki with the help<br/> of the Open University of Cyprus<br/> In some messages the words ""DSpace"" are translated as ""Eureka"" (the name of<br/> our repository)</p> config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file config-file config-file config-file source-file source-file source-file source-file config-file test-file test-file test-file test-file test-file test-file test-file test-file config-file source-file config-file config-file other-file other-file config-file config-file config-file config-file config-file config-file config-file",no-bug,0.9
3479,DSpace,https://github.com/DSpace/DSpace/issues/3479,[DS-102] Submission without file possible with the skip upload functionality disabled,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-102"">[DS-102]</a> created by bollini</i> <p>It is possible to complete a submission without any files also if the skip upload functionality is disabled. This is true with both JSPUI and XMLUI<br/> For reproduce this you need to go through a submission with multi-file option checked. <br/> First upload a file and go to the verify step, now using the progress bar go back to the upload step.<br/> Remove the uploaded file and use the progress bar to go at the verify step or next. Now you are able to complete the submission without files.</p>",source-file,"[DS-102] Submission without file possible with the skip upload functionality disabled <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-102"">[DS-102]</a> created by bollini</i> <p>It is possible to complete a submission without any files also if the skip upload functionality is disabled. This is true with both JSPUI and XMLUI<br/> For reproduce this you need to go through a submission with multi-file option checked. <br/> First upload a file and go to the verify step, now using the progress bar go back to the upload step.<br/> Remove the uploaded file and use the progress bar to go at the verify step or next. Now you are able to complete the submission without files.</p> source-file",no-bug,0.9
3204,DSpace,https://github.com/DSpace/DSpace/issues/3204,DSpace 7 REST API is not usable with LDAP authentication,"On our DSpace 7 test environment we are using LDAP authentication and for all LDAP authorized epersons we assign a special group with the configuration option authentication-ldap.login.specialgroup = Login\ Member. The group exists. When I try to GET the DSpace 7 REST API, I get this error in dspace.log:  java.lang.NullPointerException: null at org.dspace.authenticate.LDAPAuthentication.getSpecialGroups(LDAPAuthentication.java:144) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.authenticate.AuthenticationServiceImpl.getSpecialGroups(AuthenticationServiceImpl.java:182) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.app.rest.security.AnonymousAdditionalAuthorizationFilter.doFilterInternal(AnonymousAdditionalAuthorizationFilter.java:59) ~[classes/:7.0-beta5-SNAPSHOT]  I have prepared a PR, which should fix this behaviour: https://github.com/DSpace/DSpace/pull/3203",config-file | config-file,"DSpace 7 REST API is not usable with LDAP authentication On our DSpace 7 test environment we are using LDAP authentication and for all LDAP authorized epersons we assign a special group with the configuration option authentication-ldap.login.specialgroup = Login\ Member. The group exists. When I try to GET the DSpace 7 REST API, I get this error in dspace.log:  java.lang.NullPointerException: null at org.dspace.authenticate.LDAPAuthentication.getSpecialGroups(LDAPAuthentication.java:144) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.authenticate.AuthenticationServiceImpl.getSpecialGroups(AuthenticationServiceImpl.java:182) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT] at org.dspace.app.rest.security.AnonymousAdditionalAuthorizationFilter.doFilterInternal(AnonymousAdditionalAuthorizationFilter.java:59) ~[classes/:7.0-beta5-SNAPSHOT]  I have prepared a PR, which should fix this behaviour: https://github.com/DSpace/DSpace/pull/3203 config-file config-file",no-bug,0.8
3531,DSpace,https://github.com/DSpace/DSpace/issues/3531,[DS-156] File description not available in XMLUI,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-156"">[DS-156]</a> created by ottenhoffs</i> <p>The user-entered file description is not available in the XMLUI.</p>",config-file,"[DS-156] File description not available in XMLUI <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-156"">[DS-156]</a> created by ottenhoffs</i> <p>The user-entered file description is not available in the XMLUI.</p> config-file",no-bug,0.8
9715,DSpace,https://github.com/DSpace/DSpace/issues/9715,OpenAIRE v4 default crosswalk: Revised mapping for Accepted and Issued dates,"## Context The particular piece of code that needs revision is https://github.com/DSpace/DSpace/blob/main/dspace/config/crosswalks/oai/metadataFormats/oai_openaire.xsl#L740-L754 What basically happens there is dc.date.issued and dc.date.accepted are taken as input, and are being exposed as BOTH ""Accepted"" and ""Issued"". As described here in the [OpenAIRE guidelines](https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/field_embargoenddate.html), ""Accepted"" should very specifically be used for the start of an embargo. ## Proposal Only dc.date.issued should be considered as the input for the crosswalk to both Issued and Accepted. The rationale is that embargo start dates generally start counting as of date of publication, and dc.date.issued is the commonly used field for keeping the data of publication. The current crosswalk is ok if only dc.date.issued is filled out, because in that case it doesn't matter anyway that dc.date.accepted is also included in the crosswalk. But as soon as you have items where either ONLY dc.date.accepted has a value (and it's NOT the publication date!) or dc.date.issued and dc.date.accepted are both filled out, the crosswalk produces conflicting and incorrect results. ## To Reproduce Steps to reproduce the behavior: 1. Create an item that has both dc.date.issued and dc.date.accepted filled out 2. Run oai import so that the metadata show up in the OpenAIRE OAI endpoint. ## Expected behavior dc.date.issued should be exposed as ""Accepted"" and ""Issued"" in the crosswalked record.",other-file,"OpenAIRE v4 default crosswalk: Revised mapping for Accepted and Issued dates ## Context The particular piece of code that needs revision is https://github.com/DSpace/DSpace/blob/main/dspace/config/crosswalks/oai/metadataFormats/oai_openaire.xsl#L740-L754 What basically happens there is dc.date.issued and dc.date.accepted are taken as input, and are being exposed as BOTH ""Accepted"" and ""Issued"". As described here in the [OpenAIRE guidelines](https://openaire-guidelines-for-literature-repository-managers.readthedocs.io/en/v4.0.0/field_embargoenddate.html), ""Accepted"" should very specifically be used for the start of an embargo. ## Proposal Only dc.date.issued should be considered as the input for the crosswalk to both Issued and Accepted. The rationale is that embargo start dates generally start counting as of date of publication, and dc.date.issued is the commonly used field for keeping the data of publication. The current crosswalk is ok if only dc.date.issued is filled out, because in that case it doesn't matter anyway that dc.date.accepted is also included in the crosswalk. But as soon as you have items where either ONLY dc.date.accepted has a value (and it's NOT the publication date!) or dc.date.issued and dc.date.accepted are both filled out, the crosswalk produces conflicting and incorrect results. ## To Reproduce Steps to reproduce the behavior: 1. Create an item that has both dc.date.issued and dc.date.accepted filled out 2. Run oai import so that the metadata show up in the OpenAIRE OAI endpoint. ## Expected behavior dc.date.issued should be exposed as ""Accepted"" and ""Issued"" in the crosswalked record. other-file",no-bug,0.9
7070,DSpace,https://github.com/DSpace/DSpace/issues/7070,[DS-3723] Exporting AIP packages problem,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3723"">[DS-3723]</a> created by paulo_graca</i> <p>Hi,</p> <p>We have an installed process that periodacally exports all items, collections and communities from DSpace using the AIP packager feature. But sometimes this proccess breaks unexpectally. For instance this exception:</p> <p> </p> <p>Exception: Error exporting METS for DSpace Object, type=ITEM, handle=XXXXX/XXX, dbID=XXXXX<br/> org.dspace.content.packager.PackageValidationException: Error exporting METS for DSpace Object, type=ITEM, handle=XXXXX/XXX, dbID=XXXXX, Reason: edu.harvard.hul.ois.mets.helper.MetsException: ID ""<b>bitstream_3</b>"" already exists<br/> at org.dspace.content.packager.AbstractMETSDisseminator.disseminate(AbstractMETSDisseminator.java:280)<br/> at org.dspace.content.packager.DSpaceAIPDisseminator.disseminate(DSpaceAIPDisseminator.java:160)<br/> at org.dspace.content.packager.AbstractPackageDisseminator.disseminateAll(AbstractPackageDisseminator.java:103)<br/> at org.dspace.app.packager.Packager.disseminate(Packager.java:641)<br/> at org.dspace.app.packager.Packager.main(Packager.java:460)<br/> at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br/> at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)<br/> at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br/> at java.lang.reflect.Method.invoke(Method.java:606)<br/> at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:226)<br/> at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:78)<br/> Caused by: edu.harvard.hul.ois.mets.helper.MetsException: ID ""<b>bitstream_3</b>"" already exists<br/> at edu.harvard.hul.ois.mets.helper.MetsValidator.validate(MetsValidator.java:68)<br/> at edu.harvard.hul.ois.mets.helper.MetsVElement.validate(MetsVElement.java:68)<br/> at edu.harvard.hul.ois.mets.helper.MetsValidator.validate(MetsValidator.java:78)<br/> at edu.harvard.hul.ois.mets.helper.MetsVElement.validate(MetsVElement.java:68)<br/> at edu.harvard.hul.ois.mets.helper.MetsValidator.validate(MetsValidator.java:78)<br/> at edu.harvard.hul.ois.mets.helper.MetsVElement.validate(MetsVElement.java:68)<br/> at edu.harvard.hul.ois.mets.helper.MetsValidator.validate(MetsValidator.java:78)<br/> at edu.harvard.hul.ois.mets.helper.MetsVElement.validate(MetsVElement.java:68)<br/> at org.dspace.content.packager.AbstractMETSDisseminator.writeZipPackage(AbstractMETSDisseminator.java:386)<br/> at org.dspace.content.packager.AbstractMETSDisseminator.disseminate(AbstractMETSDisseminator.java:259)</p> <p> </p> <p>We identify that there are two different sequences. One in bundle2bitstream (field: bitstream_order) table and the other in bitstream table (sequence_id). I don't know the reason for having two different sequences, perhaps a legacy issue. In this reported issue we had:</p> <div class='table-wrap'> <table class='confluenceTable'><tbody> <tr> <td class='confluenceTd'><b>bundle2bitstream.bitstream_order</b></td> <td class='confluenceTd'><b>bitstream.sequence_id</b></td> </tr> <tr> <td class='confluenceTd'>0</td> <td class='confluenceTd'>1</td> </tr> <tr> <td class='confluenceTd'>1</td> <td class='confluenceTd'>2</td> </tr> <tr> <td class='confluenceTd'>2</td> <td class='confluenceTd'><b>3</b></td> </tr> <tr> <td class='confluenceTd'>3</td> <td class='confluenceTd'><b>3</b></td> </tr> <tr> <td class='confluenceTd'>4</td> <td class='confluenceTd'>4</td> </tr> <tr> <td class='confluenceTd'>5</td> <td class='confluenceTd'>5</td> </tr> <tr> <td class='confluenceTd'>6</td> <td class='confluenceTd'>6</td> </tr> </tbody></table> </div> <p> </p> <p>Not sure why the <b>bitstream.sequence_id</b> = 3 field repeats itself but I think it must be related with the ordering feature in the adminstrator backoffice interface.</p> <p>The solution to this problem it's to manually correct the bitstream sequence. </p> <p> </p>",config-file | config-file | other-file,"[DS-3723] Exporting AIP packages problem <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3723"">[DS-3723]</a> created by paulo_graca</i> <p>Hi,</p> <p>We have an installed process that periodacally exports all items, collections and communities from DSpace using the AIP packager feature. But sometimes this proccess breaks unexpectally. For instance this exception:</p> <p> </p> <p>Exception: Error exporting METS for DSpace Object, type=ITEM, handle=XXXXX/XXX, dbID=XXXXX<br/> org.dspace.content.packager.PackageValidationException: Error exporting METS for DSpace Object, type=ITEM, handle=XXXXX/XXX, dbID=XXXXX, Reason: edu.harvard.hul.ois.mets.helper.MetsException: ID ""<b>bitstream_3</b>"" already exists<br/> at org.dspace.content.packager.AbstractMETSDisseminator.disseminate(AbstractMETSDisseminator.java:280)<br/> at org.dspace.content.packager.DSpaceAIPDisseminator.disseminate(DSpaceAIPDisseminator.java:160)<br/> at org.dspace.content.packager.AbstractPackageDisseminator.disseminateAll(AbstractPackageDisseminator.java:103)<br/> at org.dspace.app.packager.Packager.disseminate(Packager.java:641)<br/> at org.dspace.app.packager.Packager.main(Packager.java:460)<br/> at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br/> at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)<br/> at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br/> at java.lang.reflect.Method.invoke(Method.java:606)<br/> at org.dspace.app.launcher.ScriptLauncher.runOneCommand(ScriptLauncher.java:226)<br/> at org.dspace.app.launcher.ScriptLauncher.main(ScriptLauncher.java:78)<br/> Caused by: edu.harvard.hul.ois.mets.helper.MetsException: ID ""<b>bitstream_3</b>"" already exists<br/> at edu.harvard.hul.ois.mets.helper.MetsValidator.validate(MetsValidator.java:68)<br/> at edu.harvard.hul.ois.mets.helper.MetsVElement.validate(MetsVElement.java:68)<br/> at edu.harvard.hul.ois.mets.helper.MetsValidator.validate(MetsValidator.java:78)<br/> at edu.harvard.hul.ois.mets.helper.MetsVElement.validate(MetsVElement.java:68)<br/> at edu.harvard.hul.ois.mets.helper.MetsValidator.validate(MetsValidator.java:78)<br/> at edu.harvard.hul.ois.mets.helper.MetsVElement.validate(MetsVElement.java:68)<br/> at edu.harvard.hul.ois.mets.helper.MetsValidator.validate(MetsValidator.java:78)<br/> at edu.harvard.hul.ois.mets.helper.MetsVElement.validate(MetsVElement.java:68)<br/> at org.dspace.content.packager.AbstractMETSDisseminator.writeZipPackage(AbstractMETSDisseminator.java:386)<br/> at org.dspace.content.packager.AbstractMETSDisseminator.disseminate(AbstractMETSDisseminator.java:259)</p> <p> </p> <p>We identify that there are two different sequences. One in bundle2bitstream (field: bitstream_order) table and the other in bitstream table (sequence_id). I don't know the reason for having two different sequences, perhaps a legacy issue. In this reported issue we had:</p> <div class='table-wrap'> <table class='confluenceTable'><tbody> <tr> <td class='confluenceTd'><b>bundle2bitstream.bitstream_order</b></td> <td class='confluenceTd'><b>bitstream.sequence_id</b></td> </tr> <tr> <td class='confluenceTd'>0</td> <td class='confluenceTd'>1</td> </tr> <tr> <td class='confluenceTd'>1</td> <td class='confluenceTd'>2</td> </tr> <tr> <td class='confluenceTd'>2</td> <td class='confluenceTd'><b>3</b></td> </tr> <tr> <td class='confluenceTd'>3</td> <td class='confluenceTd'><b>3</b></td> </tr> <tr> <td class='confluenceTd'>4</td> <td class='confluenceTd'>4</td> </tr> <tr> <td class='confluenceTd'>5</td> <td class='confluenceTd'>5</td> </tr> <tr> <td class='confluenceTd'>6</td> <td class='confluenceTd'>6</td> </tr> </tbody></table> </div> <p> </p> <p>Not sure why the <b>bitstream.sequence_id</b> = 3 field repeats itself but I think it must be related with the ordering feature in the adminstrator backoffice interface.</p> <p>The solution to this problem it's to manually correct the bitstream sequence. </p> <p> </p> config-file config-file other-file",no-bug,0.9
9357,DSpace,https://github.com/DSpace/DSpace/issues/9357,Should dc.type be required by default?,"In #9339 we upgraded the DIM2DataCite crosswalk to follow DataCite's metadata schema in version 4.5. With version 4 the field resourceType was made mandatory by DataCite. In DSpace's default submission-forms.xml it is currently not mandatory. DataCite's metadata schema is getting a de facto standard in the open science community and being reused in other projects as well. This brings up the question, whether we want to make dc.type required in DSpace default configuration. If we don't we should add to our documentation, that you should make it required, if you mint DOIs. We already build in another fall-back into the crosswalk setting DataCite's required resource type to ""Other"" if dc.type is not set. As #9339 was ported back to DSpace 7.6.2 (see #9356), we should mention in the release note of 7.6.2 that people should make dc.type required.",config-file,"Should dc.type be required by default? In #9339 we upgraded the DIM2DataCite crosswalk to follow DataCite's metadata schema in version 4.5. With version 4 the field resourceType was made mandatory by DataCite. In DSpace's default submission-forms.xml it is currently not mandatory. DataCite's metadata schema is getting a de facto standard in the open science community and being reused in other projects as well. This brings up the question, whether we want to make dc.type required in DSpace default configuration. If we don't we should add to our documentation, that you should make it required, if you mint DOIs. We already build in another fall-back into the crosswalk setting DataCite's required resource type to ""Other"" if dc.type is not set. As #9339 was ported back to DSpace 7.6.2 (see #9356), we should mention in the release note of 7.6.2 that people should make dc.type required. config-file",no-bug,0.9
3211,DSpace,https://github.com/DSpace/DSpace/issues/3211,Full-text indexing fails due to missing Tika library,"**Describe the bug** When adding or updating an item in the search core (via the discovery consumer, e.g. after a metadata edit occurs in the UI), full-text indexing fails, with an error in dspace.log containing the following snippet:  Caused by: java.lang.NoClassDefFoundError: org/apache/tika/parser/csv/TextAndCSVParser at org.dspace.discovery.indexobject.IndexFactoryImpl.writeDocument(IndexFactoryImpl.java:99) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT]  **To Reproduce** Steps to reproduce the behavior: 1. Create an item with a PDF 2. Run filter-media on it so that a fulltext bitstream is created in the TEXT bundle 3. Edit the item to modify the metadata 4. Notice that the indexing fails and a message like the above appears in dspace.log **Expected behavior** Full-text indexing should succeed without error.",config-file | config-file | config-file | config-file | config-file,"Full-text indexing fails due to missing Tika library **Describe the bug** When adding or updating an item in the search core (via the discovery consumer, e.g. after a metadata edit occurs in the UI), full-text indexing fails, with an error in dspace.log containing the following snippet:  Caused by: java.lang.NoClassDefFoundError: org/apache/tika/parser/csv/TextAndCSVParser at org.dspace.discovery.indexobject.IndexFactoryImpl.writeDocument(IndexFactoryImpl.java:99) ~[dspace-api-7.0-beta5-SNAPSHOT.jar:7.0-beta5-SNAPSHOT]  **To Reproduce** Steps to reproduce the behavior: 1. Create an item with a PDF 2. Run filter-media on it so that a fulltext bitstream is created in the TEXT bundle 3. Edit the item to modify the metadata 4. Notice that the indexing fails and a message like the above appears in dspace.log **Expected behavior** Full-text indexing should succeed without error. config-file config-file config-file config-file config-file",no-bug,0.9
2982,DSpace,https://github.com/DSpace/DSpace/issues/2982,Upgrade version of Bootstrap used by OAI-PMH interface (for human display of output),"OAI-PMH (dspace-oai) is currently using Bootstrap v3.0.2 which is outdated (see `dspace-oai/src/main/resources/static/js/bootstrap.js`). Additionally LGTM is reporting possible security issues with the `bootstrap.js`. See the **last two** issues in this list: https://lgtm.com/projects/g/DSpace/DSpace/?mode=list&tag=security Ideally, we'd upgrade minimally to Bootstrap v3.4.1 (the latest 3.x release), but we also could upgrade to v4.5 (the latest release) if no major effort is required.",source-file | source-file | source-file | source-file | source-file | other-file | config-file | other-file,"Upgrade version of Bootstrap used by OAI-PMH interface (for human display of output) OAI-PMH (dspace-oai) is currently using Bootstrap v3.0.2 which is outdated (see `dspace-oai/src/main/resources/static/js/bootstrap.js`). Additionally LGTM is reporting possible security issues with the `bootstrap.js`. See the **last two** issues in this list: https://lgtm.com/projects/g/DSpace/DSpace/?mode=list&tag=security Ideally, we'd upgrade minimally to Bootstrap v3.4.1 (the latest 3.x release), but we also could upgrade to v4.5 (the latest release) if no major effort is required. source-file source-file source-file source-file source-file other-file config-file other-file",no-bug,0.95
8403,DSpace,https://github.com/DSpace/DSpace/issues/8403,Old jbibtex library breaks for identifiers starting with dot,"**Describe the bug** When performing a BibTeX import, identifiers starting with a dot are not recognized. This was seen on DSpace CRIS 7.2 but should be a problem generally as jbibtex is in the old version (1.0.10 instead of the current 1.0.20) in both systems. **To Reproduce** Import a BibTeX file using an identifier starting with a period ""."" as generated by Citavi. **Expected behavior** Import succeeds.",config-file | config-file,"Old jbibtex library breaks for identifiers starting with dot **Describe the bug** When performing a BibTeX import, identifiers starting with a dot are not recognized. This was seen on DSpace CRIS 7.2 but should be a problem generally as jbibtex is in the old version (1.0.10 instead of the current 1.0.20) in both systems. **To Reproduce** Import a BibTeX file using an identifier starting with a period ""."" as generated by Citavi. **Expected behavior** Import succeeds. config-file config-file",no-bug,0.9
3217,DSpace,https://github.com/DSpace/DSpace/issues/3217,NPE in SherpaService constructor when running any IT,"**Describe the bug** `SherpaService#configurationService` is both injected and explicitly initialized. Apparently Spring is calling the constructor before `DSpaceServicesFactory.getInstance()` is ready, leading to an NPE. The explicit initialization should be removed. This showed up after I merged today's `main` into a patch that I'm developing. **To Reproduce** Steps to reproduce the behavior: 1. Run integration tests. **Expected behavior** Spring should succeed in creating the bean. **Note** The explicit initialization was removed in commit dd10104661ce9cf6887093674c684852c9ad167f but reappeared in fdabd643f0eb3620612aad6ba08758f3a1629275.",config-file | source-file,"NPE in SherpaService constructor when running any IT **Describe the bug** `SherpaService#configurationService` is both injected and explicitly initialized. Apparently Spring is calling the constructor before `DSpaceServicesFactory.getInstance()` is ready, leading to an NPE. The explicit initialization should be removed. This showed up after I merged today's `main` into a patch that I'm developing. **To Reproduce** Steps to reproduce the behavior: 1. Run integration tests. **Expected behavior** Spring should succeed in creating the bean. **Note** The explicit initialization was removed in commit dd10104661ce9cf6887093674c684852c9ad167f but reappeared in fdabd643f0eb3620612aad6ba08758f3a1629275. config-file source-file",no-bug,0.9
8676,DSpace,https://github.com/DSpace/DSpace/issues/8676,grunt 1.6.x requires Node.js v16,"**Describe the bug** The Mirage 2 theme in DSpace 6.x relies on grunt to run tasks during the frontend build. A few weeks ago [grunt was updated 1.6.0](https://github.com/gruntjs/grunt/blob/HEAD/CHANGELOG#L6), which requires Node.js v16. This breaks the build because Mirage 2 is limited to Node.js v14: console error grunt@1.6.1: The engine ""node"" is incompatible with this module. Expected version "">=16"". Got ""14.21.2""  DSpace 6 is nearing end of life, but the solution is to pin grunt to version 1.5.x using the `~1.5.3` semver specifier in `dspace-xmlui-mirage2/src/main/webapp/package.json`.",documentation-file,"grunt 1.6.x requires Node.js v16 **Describe the bug** The Mirage 2 theme in DSpace 6.x relies on grunt to run tasks during the frontend build. A few weeks ago [grunt was updated 1.6.0](https://github.com/gruntjs/grunt/blob/HEAD/CHANGELOG#L6), which requires Node.js v16. This breaks the build because Mirage 2 is limited to Node.js v14: console error grunt@1.6.1: The engine ""node"" is incompatible with this module. Expected version "">=16"". Got ""14.21.2""  DSpace 6 is nearing end of life, but the solution is to pin grunt to version 1.5.x using the `~1.5.3` semver specifier in `dspace-xmlui-mirage2/src/main/webapp/package.json`. documentation-file",no-bug,0.9
3116,DSpace,https://github.com/DSpace/DSpace/issues/3116,Security issue in discovery,"**Describe the bug** Items under embargo (not the bitstreams) are exposed via Discovery. There's even an IT proving it's broken. The [item](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/DiscoveryRestControllerIT.java#L1927) has an [embargo period of 12 months](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/DiscoveryRestControllerIT.java#L1933), but is [accessible via discovery](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/DiscoveryRestControllerIT.java#L1959) as an [anonymous user](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/DiscoveryRestControllerIT.java#L1941). This implies there are security bugs: * The [SolrServiceResourceRestrictionPlugin](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/discovery/SolrServiceResourceRestrictionPlugin.java) doesn't check for dates on permissions, causing the embargoed items to be returned * Discovery ignores the [PreAuthorize permissions check](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/main/java/org/dspace/app/rest/converter/ConverterService.java#L122) which should ensure the item cannot be returned, not even when it's embedded The issue doesn't occur on the item REST endpoint. An [embargo of 6 months](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/ItemRestRepositoryIT.java#L1353) is resulting in an [unauthorized](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/ItemRestRepositoryIT.java#L1379) response.",source-file | test-file | source-file | test-file,"Security issue in discovery **Describe the bug** Items under embargo (not the bitstreams) are exposed via Discovery. There's even an IT proving it's broken. The [item](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/DiscoveryRestControllerIT.java#L1927) has an [embargo period of 12 months](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/DiscoveryRestControllerIT.java#L1933), but is [accessible via discovery](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/DiscoveryRestControllerIT.java#L1959) as an [anonymous user](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/DiscoveryRestControllerIT.java#L1941). This implies there are security bugs: * The [SolrServiceResourceRestrictionPlugin](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/discovery/SolrServiceResourceRestrictionPlugin.java) doesn't check for dates on permissions, causing the embargoed items to be returned * Discovery ignores the [PreAuthorize permissions check](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/main/java/org/dspace/app/rest/converter/ConverterService.java#L122) which should ensure the item cannot be returned, not even when it's embedded The issue doesn't occur on the item REST endpoint. An [embargo of 6 months](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/ItemRestRepositoryIT.java#L1353) is resulting in an [unauthorized](https://github.com/DSpace/DSpace/blob/main/dspace-server-webapp/src/test/java/org/dspace/app/rest/ItemRestRepositoryIT.java#L1379) response. source-file test-file source-file test-file",bug,0.95
3284,DSpace,https://github.com/DSpace/DSpace/issues/3284,OAI response contains wrong URL for bitstream,"**Describe the bug** The xoai document contains the old style bitstream URL with unreplaced place holder instead that the new one **To Reproduce** Steps to reproduce the behavior: 1. check the xoai response of any record that contains files 2. https://api7.dspace.org/server/oai/request?verb=GetRecord&metadataPrefix=xoai&identifier=oai:demo7.dspace.org:10673/248 3. the url looks like `<field name=""url"">bitstream.baseUrl/bitstream/10673/248/1/Video-Based%20Solution-Focused%20Brief%20Coaching.pdf</field>` **Expected behavior** The bitstream URL should work, the right one is https://demo7.dspace.org/bitstreams/b54bc2e4-e37d-4418-a108-79314f95f5a3/download",source-file | test-file | test-file,"OAI response contains wrong URL for bitstream **Describe the bug** The xoai document contains the old style bitstream URL with unreplaced place holder instead that the new one **To Reproduce** Steps to reproduce the behavior: 1. check the xoai response of any record that contains files 2. https://api7.dspace.org/server/oai/request?verb=GetRecord&metadataPrefix=xoai&identifier=oai:demo7.dspace.org:10673/248 3. the url looks like `<field name=""url"">bitstream.baseUrl/bitstream/10673/248/1/Video-Based%20Solution-Focused%20Brief%20Coaching.pdf</field>` **Expected behavior** The bitstream URL should work, the right one is https://demo7.dspace.org/bitstreams/b54bc2e4-e37d-4418-a108-79314f95f5a3/download source-file test-file test-file",bug,0.95
3885,DSpace,https://github.com/DSpace/DSpace/issues/3885,[DS-511] Combine eperson and groups search in Assign Roles page,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-511"">[DS-511]</a> created by dsalo</i> <p>Currently in XMLUI, the searches for people and groups to assign to roles are separate, triggered by different buttons. When searching for a group, I hit return by reflex, only to have DSpace tell me ""there's no such person.""</p> <p>I would prefer that there be only one search that returns both epeople and groups, separated on the results page.</p>",config-file,"[DS-511] Combine eperson and groups search in Assign Roles page <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-511"">[DS-511]</a> created by dsalo</i> <p>Currently in XMLUI, the searches for people and groups to assign to roles are separate, triggered by different buttons. When searching for a group, I hit return by reflex, only to have DSpace tell me ""there's no such person.""</p> <p>I would prefer that there be only one search that returns both epeople and groups, separated on the results page.</p> config-file",no-bug,0.9
8706,DSpace,https://github.com/DSpace/DSpace/issues/8706,solr-upgrade-statistics-6x - Not committing last batch in certain scenarios,"**Describe the bug** In DSpace 6.4 and 7.5, running CLI `/dspace/bin/dspace solr-upgrade-statistics-6x` does not commit the last batch if the total size is a even multiple of the batch size. **To Reproduce** Steps to reproduce the behavior: 1. Have a statistics core with over 100 items with legacy ids left to migrate 2. /dspace/bin/dspace solr-upgrade-statistics-6x -n 100 -b 10 3. 90 items will have changed in Solr and the TOTAL report will show 90 fewer legacy items. **Expected behavior** There should be 100 items changed. **Related work** Have a one-character PR, about to submit.",source-file | source-file,"solr-upgrade-statistics-6x - Not committing last batch in certain scenarios **Describe the bug** In DSpace 6.4 and 7.5, running CLI `/dspace/bin/dspace solr-upgrade-statistics-6x` does not commit the last batch if the total size is a even multiple of the batch size. **To Reproduce** Steps to reproduce the behavior: 1. Have a statistics core with over 100 items with legacy ids left to migrate 2. /dspace/bin/dspace solr-upgrade-statistics-6x -n 100 -b 10 3. 90 items will have changed in Solr and the TOTAL report will show 90 fewer legacy items. **Expected behavior** There should be 100 items changed. **Related work** Have a one-character PR, about to submit. source-file source-file",no-bug,0.9
9006,DSpace,https://github.com/DSpace/DSpace/issues/9006,Geoip error message reference wrong config file,Version 7.6 Geoip error message reference wrong config file Screenshot fo the healthcheck ![image](https://github.com/DSpace/DSpace/assets/54576195/35cb6274-4fc8-47c3-936b-8240d81b0332) The key `usage-statistics.dbfile` is defined in `usage-statistics.cfg` https://github.com/DSpace/DSpace/blob/a997d4c3ed61390c9e311919776d13031ada66ea/dspace/config/modules/usage-statistics.cfg#L9-L12,source-file | test-file | source-file | test-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | test-file | test-file | other-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | other-file | other-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | config-file | other-file | other-file | config-file | other-file | other-file | other-file | config-file | config-file | other-file | other-file | other-file | other-file | config-file | other-file | config-file | config-file | config-file | container-file | other-file | other-file | other-file | config-file | config-file | config-file | test-file | test-file | config-file | config-file | config-file | config-file | config-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | database-file | database-file | database-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | source-file | config-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | config-file | config-file | config-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | other-file | other-file | config-file | test-file | test-file | config-file,Geoip error message reference wrong config file Version 7.6 Geoip error message reference wrong config file Screenshot fo the healthcheck ![image](https://github.com/DSpace/DSpace/assets/54576195/35cb6274-4fc8-47c3-936b-8240d81b0332) The key `usage-statistics.dbfile` is defined in `usage-statistics.cfg` https://github.com/DSpace/DSpace/blob/a997d4c3ed61390c9e311919776d13031ada66ea/dspace/config/modules/usage-statistics.cfg#L9-L12 source-file test-file source-file test-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file test-file test-file other-file source-file test-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file other-file other-file other-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file source-file source-file source-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file test-file other-file config-file other-file other-file config-file other-file other-file other-file config-file config-file other-file other-file other-file other-file config-file other-file config-file config-file config-file container-file other-file other-file other-file config-file config-file config-file test-file test-file config-file config-file config-file config-file config-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file database-file database-file database-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file source-file config-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file config-file config-file config-file other-file other-file other-file other-file other-file other-file other-file other-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file config-file other-file other-file config-file test-file test-file config-file,no-bug,0.9
3202,DSpace,https://github.com/DSpace/DSpace/issues/3202,Collection location is not indexed for in submission items,"**Describe the bug** When [searching for an in submission item](https://github.com/DSpace/RestContract/blob/main/search-endpoint.md#workflow), the attached collection of the item is not indexed, and not attached as a location of the record in solr This has the side effect that, when searching using the workflow configuration of discovery, that: * The item CAN searchable when using a general search * The item CAN NOT be found using the collection as a scope parameter The underlying reason for this is that, when the item is indexed, the [related collections](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/discovery/indexobject/ItemIndexFactoryImpl.java#L677) are checked But in progress items do not have a link to the owning collection -> The [InProgressSubmission does have a link to the collection](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/content/InProgressSubmission.java#L42) **To Reproduce** Steps to reproduce the behavior: 1. Create an in submission item in a particular collection 2. Search that it's present in a 'general, non scoped' search for the workflow items 2.1 This item should be retrieved since it's indexed through [this indexer](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/discovery/indexobject/InprogressSubmissionIndexFactoryImpl.java#L49) 3. Search that it's present in a 'scoped' search, using the collection that the item is being submitted into 3.1 This item can not be found, since it doesn't contain location information for the collection **Expected behavior** Both the scoped and non scoped searches should return the relevant item",config-file | config-file,"Collection location is not indexed for in submission items **Describe the bug** When [searching for an in submission item](https://github.com/DSpace/RestContract/blob/main/search-endpoint.md#workflow), the attached collection of the item is not indexed, and not attached as a location of the record in solr This has the side effect that, when searching using the workflow configuration of discovery, that: * The item CAN searchable when using a general search * The item CAN NOT be found using the collection as a scope parameter The underlying reason for this is that, when the item is indexed, the [related collections](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/discovery/indexobject/ItemIndexFactoryImpl.java#L677) are checked But in progress items do not have a link to the owning collection -> The [InProgressSubmission does have a link to the collection](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/content/InProgressSubmission.java#L42) **To Reproduce** Steps to reproduce the behavior: 1. Create an in submission item in a particular collection 2. Search that it's present in a 'general, non scoped' search for the workflow items 2.1 This item should be retrieved since it's indexed through [this indexer](https://github.com/DSpace/DSpace/blob/main/dspace-api/src/main/java/org/dspace/discovery/indexobject/InprogressSubmissionIndexFactoryImpl.java#L49) 3. Search that it's present in a 'scoped' search, using the collection that the item is being submitted into 3.1 This item can not be found, since it doesn't contain location information for the collection **Expected behavior** Both the scoped and non scoped searches should return the relevant item config-file config-file",no-bug,0.9
7051,DSpace,https://github.com/DSpace/DSpace/issues/7051,[DS-3704] Expand DSpace REST Reports to include bitstream fields in item listing,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3704"">[DS-3704]</a> created by terrywbrady</i> <p>There was discussion of the REST reporting tools at the DSpace North American User Meeting. One enhancement that I can provide would enable a user to generate a report that includes bitstream information.</p> <p> </p> <p><span class=""image-wrap"" style=""""><img src=""https://jira.lyrasis.org/secure/attachment/18724/18724_2017-09-28_15-41-07.png"" style=""border: 0px solid black"" /></span></p> <p><span class=""image-wrap"" style=""""><img src=""https://jira.lyrasis.org/secure/attachment/18723/18723_image-2017-09-28-15-42-22-885.png"" style=""border: 0px solid black"" /></span></p>",other-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | other-file | source-file | test-file | source-file | other-file | test-file | other-file | other-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file,"[DS-3704] Expand DSpace REST Reports to include bitstream fields in item listing <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-3704"">[DS-3704]</a> created by terrywbrady</i> <p>There was discussion of the REST reporting tools at the DSpace North American User Meeting. One enhancement that I can provide would enable a user to generate a report that includes bitstream information.</p> <p> </p> <p><span class=""image-wrap"" style=""""><img src=""https://jira.lyrasis.org/secure/attachment/18724/18724_2017-09-28_15-41-07.png"" style=""border: 0px solid black"" /></span></p> <p><span class=""image-wrap"" style=""""><img src=""https://jira.lyrasis.org/secure/attachment/18723/18723_image-2017-09-28-15-42-22-885.png"" style=""border: 0px solid black"" /></span></p> other-file source-file source-file source-file source-file source-file source-file other-file other-file source-file source-file source-file source-file other-file source-file source-file other-file source-file test-file source-file other-file test-file other-file other-file other-file source-file source-file source-file source-file source-file source-file other-file",no-bug,0.9
9277,DSpace,https://github.com/DSpace/DSpace/issues/9277,"Migrate from deprecated ""openjdk"" Docker image","DSpace currently uses the [`openjdk`](https://hub.docker.com/_/openjdk/) Docker image, which is now officially deprecated: > This image is officially deprecated and all users are recommended to find and use suitable replacements ASAP. Some examples of other Official Image alternatives (listed in alphabetical order with no intentional or implied preference): > > * [amazoncorretto](https://hub.docker.com/_/amazoncorretto) > * [eclipse-temurin](https://hub.docker.com/_/eclipse-temurin) > * [ibm-semeru-runtimes](https://hub.docker.com/_/ibm-semeru-runtimes) > * [ibmjava](https://hub.docker.com/_/ibmjava) > * [sapmachine](https://hub.docker.com/_/sapmachine) While I don't know which image would be the most appropriate choice to migrate to for the whole community, it's clear that a different image needs to be used.",container-file | container-file | container-file | test-file | container-file | container-file | container-file | test-file,"Migrate from deprecated ""openjdk"" Docker image DSpace currently uses the [`openjdk`](https://hub.docker.com/_/openjdk/) Docker image, which is now officially deprecated: > This image is officially deprecated and all users are recommended to find and use suitable replacements ASAP. Some examples of other Official Image alternatives (listed in alphabetical order with no intentional or implied preference): > > * [amazoncorretto](https://hub.docker.com/_/amazoncorretto) > * [eclipse-temurin](https://hub.docker.com/_/eclipse-temurin) > * [ibm-semeru-runtimes](https://hub.docker.com/_/ibm-semeru-runtimes) > * [ibmjava](https://hub.docker.com/_/ibmjava) > * [sapmachine](https://hub.docker.com/_/sapmachine) While I don't know which image would be the most appropriate choice to migrate to for the whole community, it's clear that a different image needs to be used. container-file container-file container-file test-file container-file container-file container-file test-file",no-bug,0.95
8213,DSpace,https://github.com/DSpace/DSpace/issues/8213,"Hibernate warns of ""legacy cache name""s","**Describe the bug** It seems that Hibernate has changed the names of two caches that it looks for by default. Warnings are logged, suggesting that we rename our caches. We should keep up with these changes. **To Reproduce** Steps to reproduce the behavior: 1. Start a DSpace webapp. 2. Look in log/dspace.log for HHH90001007 warnings. **Expected behavior** No HHH90001007 warnings.",config-file,"Hibernate warns of ""legacy cache name""s **Describe the bug** It seems that Hibernate has changed the names of two caches that it looks for by default. Warnings are logged, suggesting that we rename our caches. We should keep up with these changes. **To Reproduce** Steps to reproduce the behavior: 1. Start a DSpace webapp. 2. Look in log/dspace.log for HHH90001007 warnings. **Expected behavior** No HHH90001007 warnings. config-file",no-bug,0.9
3369,DSpace,https://github.com/DSpace/DSpace/issues/3369,o.d.core.AbstractHibernateDAO#uniqueResult has useless pagination arguments,"**Describe the bug** The method always returns a single object or null, or throws an exception if more than one one row matches the query. There is no need for pagination, and it's confusing and wasteful to have to fill these in wherever the method is used. Every reference to the method is passing -1, -1 here.",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,"o.d.core.AbstractHibernateDAO#uniqueResult has useless pagination arguments **Describe the bug** The method always returns a single object or null, or throws an exception if more than one one row matches the query. There is no need for pagination, and it's confusing and wasteful to have to fill these in wherever the method is used. Every reference to the method is passing -1, -1 here. source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file",no-bug,0.9
502,DSpace,https://github.com/DSpace/DSpace/issues/502,sqlite(3) db instead of postgresql or mysql,"hi dspace gurus, after searching a bit for sqlite config. info. i wonder if there is none such for dspace. please help -- is there such, and if so how does one configure it; and if not, what would it take to provide it? thanks for any feedback. --david",config-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | config-file | container-file | container-file | other-file | config-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | config-file | other-file | other-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | documentation-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | config-file | config-file | config-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | documentation-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | other-file | source-file | config-file | config-file | config-file | test-file | test-file | other-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | other-file | other-file | other-file | other-file | config-file | config-file,"sqlite(3) db instead of postgresql or mysql hi dspace gurus, after searching a bit for sqlite config. info. i wonder if there is none such for dspace. please help -- is there such, and if so how does one configure it; and if not, what would it take to provide it? thanks for any feedback. --david config-file other-file config-file config-file config-file config-file config-file config-file config-file container-file container-file other-file config-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file config-file other-file other-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file documentation-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file config-file config-file config-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file test-file documentation-file source-file source-file source-file source-file source-file test-file source-file source-file source-file source-file source-file test-file test-file other-file source-file config-file config-file config-file test-file test-file other-file source-file test-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file other-file other-file other-file other-file config-file config-file",no-bug,0.9
8888,DSpace,https://github.com/DSpace/DSpace/issues/8888,Shibboleth login leads to an error page when logging in with spaces in a GET request,"**Describe the bug** If you do a search with a space in it, for example ""testing turbine"" & then logging in with shibboleth will result in a ""Unauthorized, status=401"" error. **To Reproduce** Steps to reproduce the behavior: 1. Go to the following page: https://demo7.dspace.org/search?query=testing%20turbine 2. Then login with shibboleth **Expected behavior** Login should work. **Related work** Link to any related tickets or PRs here.",source-file | test-file | source-file | test-file,"Shibboleth login leads to an error page when logging in with spaces in a GET request **Describe the bug** If you do a search with a space in it, for example ""testing turbine"" & then logging in with shibboleth will result in a ""Unauthorized, status=401"" error. **To Reproduce** Steps to reproduce the behavior: 1. Go to the following page: https://demo7.dspace.org/search?query=testing%20turbine 2. Then login with shibboleth **Expected behavior** Login should work. **Related work** Link to any related tickets or PRs here. source-file test-file source-file test-file",bug,0.9
3419,DSpace,https://github.com/DSpace/DSpace/issues/3419,[DS-41] Small JSP cleanups,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-41"">[DS-41]</a> created by mwood</i> <p>While working on something else I became aware of a few malformed places in login-related JSPs: overlapped tags, missing quotes, and one place where ""tabid"" was used where ""tabindex"" seems to be meant.</p>",source-file | test-file | test-file | test-file | test-file | test-file | other-file | config-file | config-file | config-file,"[DS-41] Small JSP cleanups <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-41"">[DS-41]</a> created by mwood</i> <p>While working on something else I became aware of a few malformed places in login-related JSPs: overlapped tags, missing quotes, and one place where ""tabid"" was used where ""tabindex"" seems to be meant.</p> source-file test-file test-file test-file test-file test-file other-file config-file config-file config-file",no-bug,0.9
3889,DSpace,https://github.com/DSpace/DSpace/issues/3889,[DS-515] Czech localization of 1.5.2,"<i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-515"">[DS-515]</a> created by cjuergen</i> <p>Copied from Sourceforge:<br/> <a href=""http://sourceforge.net/tracker/?func=detail&atid=319984&aid=2970609&group_id=19984"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://sourceforge.net/tracker/?func=detail&atid=319984&aid=2970609&group_id=19984</a></p>",source-file,"[DS-515] Czech localization of 1.5.2 <i>Imported from JIRA <a href=""https://jira.lyrasis.org/browse/DS-515"">[DS-515]</a> created by cjuergen</i> <p>Copied from Sourceforge:<br/> <a href=""http://sourceforge.net/tracker/?func=detail&atid=319984&aid=2970609&group_id=19984"" class=""external-link"" target=""_blank"" rel=""nofollow noopener"">http://sourceforge.net/tracker/?func=detail&atid=319984&aid=2970609&group_id=19984</a></p> source-file",no-bug,0.9
2864,DSpace,https://github.com/DSpace/DSpace/issues/2864,DS-3947: Add RSS/Atom subscriptions for new records to DSpace7,"This is a duplicate of [DS-3947](https://jira.lyrasis.org/browse/DS-3947) Estimate from release plan: 2 hours Expressing interest: none RSS needs to create a link based on the Angular UI (for details of the item). REST needs to translate the URL to the Angular Path (Similar idea on Sitemaps too). RSS/ATOM feeds already provided via OpenSearch, which can limit by Community or Collection. These estimates assume we will use OpenSearch and simply document the proper queries to run in different scenarios. Required for https://github.com/DSpace/dspace-angular/issues/788",source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file | test-file,"DS-3947: Add RSS/Atom subscriptions for new records to DSpace7 This is a duplicate of [DS-3947](https://jira.lyrasis.org/browse/DS-3947) Estimate from release plan: 2 hours Expressing interest: none RSS needs to create a link based on the Angular UI (for details of the item). REST needs to translate the URL to the Angular Path (Similar idea on Sitemaps too). RSS/ATOM feeds already provided via OpenSearch, which can limit by Community or Collection. These estimates assume we will use OpenSearch and simply document the proper queries to run in different scenarios. Required for https://github.com/DSpace/dspace-angular/issues/788 source-file source-file source-file source-file source-file source-file source-file test-file test-file test-file test-file test-file test-file test-file test-file",no-bug,0.9
8401,DSpace,https://github.com/DSpace/DSpace/issues/8401,Support handle identifier attribute in StructBuilder,"**Problem** As of now is impossible to import items with identifier tag (it will be ignored) inside the StructBuilder, this attribute is indicates the handle identifier of the item. **Solution** Add a new arg param that will be used inside the StructBuilder to ignore / or do not ignore target attributes. An xpath selector restricted to attributes will be nice, as it will be extensible and quite simple to use.",other-file | config-file,"Support handle identifier attribute in StructBuilder **Problem** As of now is impossible to import items with identifier tag (it will be ignored) inside the StructBuilder, this attribute is indicates the handle identifier of the item. **Solution** Add a new arg param that will be used inside the StructBuilder to ignore / or do not ignore target attributes. An xpath selector restricted to attributes will be nice, as it will be extensible and quite simple to use. other-file config-file",no-bug,0.9
2807,DSpace,https://github.com/DSpace/DSpace/issues/2807,Cookie Preferences per account,Estimate: none Expressing interest: none Store which accounts (Epeople) allow or disallow cookies For additional details on Cookie Preferences agreement see this comment on the Angular UI ticket: https://github.com/DSpace/dspace-angular/issues/735#issuecomment-670214947,source-file,Cookie Preferences per account Estimate: none Expressing interest: none Store which accounts (Epeople) allow or disallow cookies For additional details on Cookie Preferences agreement see this comment on the Angular UI ticket: https://github.com/DSpace/dspace-angular/issues/735#issuecomment-670214947 source-file,no-bug,0.9
