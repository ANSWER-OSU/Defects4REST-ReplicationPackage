issue_no,repo,issue_url,title,description,patched_file_types,text_for_topic_modeling,prediction,confidence
29797,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29797,"Webhook targets are active, even if they are deactivated", Bug Everything is in the title :)  Dolibarr Version 19.0.2  Environment PHP PHP8.2  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior Create a target Activate it Webhook works Deactivate the target Webhook still works  Attached files _No response_,other-file | other-file,"Webhook targets are active, even if they are deactivated  Bug Everything is in the title :)  Dolibarr Version 19.0.2  Environment PHP PHP8.2  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior Create a target Activate it Webhook works Deactivate the target Webhook still works  Attached files _No response_ other-file other-file",bug,0.8
31015,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31015,Can't add payment through API since upgrade to 20.0," Bug Hello, Since upgrade to version 20.0, I can't add a payment to an invoice through the API. I'm getting this error: `{ ""error"": { ""code"": 400, ""message"": ""Bad Request: Payment error : Incorrect datetime value: '' for column `dolibarr`.`llx_paiement`.`datep` at row 1"" }, ""debug"": { ""source"": ""api_invoices.class.php:1516 at call stage"", ""stages"": { ""success"": [ ""get"", ""route"", ""negotiate"", ""authenticate"", ""validate"" ], ""failure"": [ ""call"", ""message"" ] } } }` The request has not changed since months: `CallDOAPI(""POST"", ""/invoices/$facid/payments"", json_encode(array(""datepaye""=>time(), ""paymentid""=>6, ""closepaidinvoices""=>""yes"", ""accountid""=>5;` time() returns the expected value (tried with another value and I'm getting the ""Bad Request: Invalid value specified for `datepaye`. Expecting unix timestamp, such as 1726652385"" error). The function called is: `$paymentobj->datepaye = dol_stringtotime($datepaye);` In version 19.0.3, it was: `$paymentobj->datepaye = $datepaye;`  Dolibarr Version 20.0.0  Environment PHP 8.2.23  Environment Database MariaDB 10.11.6  Steps to reproduce the behavior and expected behavior See above  Attached files _No response_",other-file | other-file | other-file,"Can't add payment through API since upgrade to 20.0  Bug Hello, Since upgrade to version 20.0, I can't add a payment to an invoice through the API. I'm getting this error: `{ ""error"": { ""code"": 400, ""message"": ""Bad Request: Payment error : Incorrect datetime value: '' for column `dolibarr`.`llx_paiement`.`datep` at row 1"" }, ""debug"": { ""source"": ""api_invoices.class.php:1516 at call stage"", ""stages"": { ""success"": [ ""get"", ""route"", ""negotiate"", ""authenticate"", ""validate"" ], ""failure"": [ ""call"", ""message"" ] } } }` The request has not changed since months: `CallDOAPI(""POST"", ""/invoices/$facid/payments"", json_encode(array(""datepaye""=>time(), ""paymentid""=>6, ""closepaidinvoices""=>""yes"", ""accountid""=>5;` time() returns the expected value (tried with another value and I'm getting the ""Bad Request: Invalid value specified for `datepaye`. Expecting unix timestamp, such as 1726652385"" error). The function called is: `$paymentobj->datepaye = dol_stringtotime($datepaye);` In version 19.0.3, it was: `$paymentobj->datepaye = $datepaye;`  Dolibarr Version 20.0.0  Environment PHP 8.2.23  Environment Database MariaDB 10.11.6  Steps to reproduce the behavior and expected behavior See above  Attached files _No response_ other-file other-file other-file",bug,0.95
26953,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26953,Fatal error on OF list if Product field is not selected to be displayed," Bug If you hide the product field in the OF list, there's a fatal error with message `Class 'Product' not found in htdocs/mrp/mo_list.php`  Environment Version 18.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior 1. Go to page `/mrp/mo_list.php` 2. Unselect the product field in the left selectfield menu  Attached files _No response_",other-file,"Fatal error on OF list if Product field is not selected to be displayed  Bug If you hide the product field in the OF list, there's a fatal error with message `Class 'Product' not found in htdocs/mrp/mo_list.php`  Environment Version 18.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior 1. Go to page `/mrp/mo_list.php` 2. Unselect the product field in the left selectfield menu  Attached files _No response_ other-file",no-bug,0.9
24085,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24085,Project filter on stock movements," Bug On https://demo.dolibarr.org/product/stock/movement_list.php?leftmenu= the filter on the column ""project"" is not shown. Now it is not possible to filter stock movements based on Project.  Environment Version 16.0.4 & 17.0.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) https://demo.dolibarr.org/product/stock/movement_list.php?leftmenu=  Expected and actual behavior A filter for the column ""project"" should be shown, similar as the warehouse column. A selection list with all available project should be shown that allows to select the stock movements linked to the selected projects to be visible.  Steps to reproduce the behavior _No response_  Attached files ![image](https://user-images.githubusercontent.com/34092708/222245509-710f499e-5542-4295-9b26-44aff49d50c2.png)",other-file | other-file | other-file,"Project filter on stock movements  Bug On https://demo.dolibarr.org/product/stock/movement_list.php?leftmenu= the filter on the column ""project"" is not shown. Now it is not possible to filter stock movements based on Project.  Environment Version 16.0.4 & 17.0.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) https://demo.dolibarr.org/product/stock/movement_list.php?leftmenu=  Expected and actual behavior A filter for the column ""project"" should be shown, similar as the warehouse column. A selection list with all available project should be shown that allows to select the stock movements linked to the selected projects to be visible.  Steps to reproduce the behavior _No response_  Attached files ![image](https://user-images.githubusercontent.com/34092708/222245509-710f499e-5542-4295-9b26-44aff49d50c2.png) other-file other-file other-file",no-bug,0.8
31670,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31670,Bug: API Add/Update purchase prices for a product. Validation Error, Bug Bug come with PR https://github.com/Dolibarr/dolibarr/pull/27442. ![image](https://github.com/user-attachments/assets/024da69c-1b58-4c6a-80b4-d8272fab2a1e) Error: Restler Validator throw Internal Server Error.  Dolibarr Version 20  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file,Bug: API Add/Update purchase prices for a product. Validation Error  Bug Bug come with PR https://github.com/Dolibarr/dolibarr/pull/27442. ![image](https://github.com/user-attachments/assets/024da69c-1b58-4c6a-80b4-d8272fab2a1e) Error: Restler Validator throw Internal Server Error.  Dolibarr Version 20  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.7
25512,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25512,Refus authent si + de n echec d'authent en 24h," Feature Request Add an option in home - setup - security called Max nb of failed authentication attempt in last 24h to allow login Value 100 by default Then into file functions_dolibarr, before testing password, we do a select count into llx_event for login and ip and code = USER_LOGIN_FAILED and date > now - 24h. If result is higher than param (so 100), we return an error ""Too many attempts"". No need to check password.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_",other-file | other-file | other-file | other-file,"Refus authent si + de n echec d'authent en 24h  Feature Request Add an option in home - setup - security called Max nb of failed authentication attempt in last 24h to allow login Value 100 by default Then into file functions_dolibarr, before testing password, we do a select count into llx_event for login and ip and code = USER_LOGIN_FAILED and date > now - 24h. If result is higher than param (so 100), we return an error ""Too many attempts"". No need to check password.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file",no-bug,0.9
25884,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25884,Bad user ID (object id) reassingment on CREATE user [SOLVED]," Bug On Dolibarr 18, when creating a new user (i.e., when object=NULL), I noticed an issue at the top of the `/user/card.php` file where the `$id` value is being overwritten with:  if (empty($id)) { $id = $user->id; }  While this might make sense in certain scenarios, it shouldn't reassign the value when creating a new user. In this case, this re-assignment is causing that Dolibarr LOAD EXTRAFIELDS VALUES of the logged user (me when creating a new user)!! A more suitable condition might be:  if (empty($id) && $action!='create') { $id = $user->id; }  - Note 1: I've tested this minor change, and it worked well. @eldy, could you please incorporate this change into the code? I've checked the develop-branch, and it hasn't been fixed yet. - Note 2: this conditional re-assignment doesn't exist on Dolibarr 17 branch !  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Bad user ID (object id) reassingment on CREATE user [SOLVED]  Bug On Dolibarr 18, when creating a new user (i.e., when object=NULL), I noticed an issue at the top of the `/user/card.php` file where the `$id` value is being overwritten with:  if (empty($id)) { $id = $user->id; }  While this might make sense in certain scenarios, it shouldn't reassign the value when creating a new user. In this case, this re-assignment is causing that Dolibarr LOAD EXTRAFIELDS VALUES of the logged user (me when creating a new user)!! A more suitable condition might be:  if (empty($id) && $action!='create') { $id = $user->id; }  - Note 1: I've tested this minor change, and it worked well. @eldy, could you please incorporate this change into the code? I've checked the develop-branch, and it hasn't been fixed yet. - Note 2: this conditional re-assignment doesn't exist on Dolibarr 17 branch !  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.8
26620,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26620,Multicurrency calculated incorrectly in Expedition fetch_lines," Bug Multicurrency total amounts are calculated incorrectly in Expedition fetch_lines  Environment Version 17.0.x, 18.0.x  Environment OS n/a  Environment Web server n/a  Environment PHP n/a  Environment Database n/a  Environment URL(s) severl URLs, eg compta/facture/card.php?action=create&origin=shipping&originid=xx  Expected and actual behavior see ""Steps to reproduce the behavior""  Steps to reproduce the behavior 1. Create a customer order with multicurrency with at least 2 positions 2. Create an expedition from this order 3. Create an invoice from this expedition The total multicurrency amounts are wrong and showing the amount only of the last position of the order  Attached files _No response_",other-file | other-file,"Multicurrency calculated incorrectly in Expedition fetch_lines  Bug Multicurrency total amounts are calculated incorrectly in Expedition fetch_lines  Environment Version 17.0.x, 18.0.x  Environment OS n/a  Environment Web server n/a  Environment PHP n/a  Environment Database n/a  Environment URL(s) severl URLs, eg compta/facture/card.php?action=create&origin=shipping&originid=xx  Expected and actual behavior see ""Steps to reproduce the behavior""  Steps to reproduce the behavior 1. Create a customer order with multicurrency with at least 2 positions 2. Create an expedition from this order 3. Create an invoice from this expedition The total multicurrency amounts are wrong and showing the amount only of the last position of the order  Attached files _No response_ other-file other-file",no-bug,0.85
24201,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24201,v17.0.0 upload of external module fails to copy from incorrectly generated temp source dir," Bug Since 17.0.0 it is not possible to install an external module using the provided form because the system fails to copy from an unexisting source path. Not related to file permission, but bad source file path. ![Capture dcran de 2023-03-13 20-42-25](https://user-images.githubusercontent.com/3855975/224863344-8155e91a-c0ba-421d-8e4a-f475575e4e24.png)  Environment Version 17.0.0  Environment OS Linux  Environment Web server Apache  Environment PHP 7.4, 8.1  Environment Database MySQL  Environment URL(s) /admin/modules.php  Expected and actual behavior **Expected** Uploading a custom module shall copy it to /htdocs/custom/ folder and install the module. **Actual** System is trying to copy a source folder that does not exzist, therefore breaking the installation of external module. In detail, the system append a _htdocs_ folder in the temporary path of the uploaded module, that does not exist on disk, creating the error. ![Capture dcran de 2023-03-13 20-35-29](https://user-images.githubusercontent.com/3855975/224862471-c19a7bfb-a2d2-483a-be4e-d19511cc0d25.png)  Steps to reproduce the behavior Upload any external module using the form in /admin/modules.php .  Attached files ![Capture dcran de 2023-03-13 20-35-29](https://user-images.githubusercontent.com/3855975/224862509-ca08b307-d293-4773-8c59-2c6682cbdab8.png) ![Capture dcran de 2023-03-13 20-37-05](https://user-images.githubusercontent.com/3855975/224862647-ffedd1e5-b3ab-42f9-9eee-34e27e4d6aac.png)",other-file | other-file,"v17.0.0 upload of external module fails to copy from incorrectly generated temp source dir  Bug Since 17.0.0 it is not possible to install an external module using the provided form because the system fails to copy from an unexisting source path. Not related to file permission, but bad source file path. ![Capture dcran de 2023-03-13 20-42-25](https://user-images.githubusercontent.com/3855975/224863344-8155e91a-c0ba-421d-8e4a-f475575e4e24.png)  Environment Version 17.0.0  Environment OS Linux  Environment Web server Apache  Environment PHP 7.4, 8.1  Environment Database MySQL  Environment URL(s) /admin/modules.php  Expected and actual behavior **Expected** Uploading a custom module shall copy it to /htdocs/custom/ folder and install the module. **Actual** System is trying to copy a source folder that does not exzist, therefore breaking the installation of external module. In detail, the system append a _htdocs_ folder in the temporary path of the uploaded module, that does not exist on disk, creating the error. ![Capture dcran de 2023-03-13 20-35-29](https://user-images.githubusercontent.com/3855975/224862471-c19a7bfb-a2d2-483a-be4e-d19511cc0d25.png)  Steps to reproduce the behavior Upload any external module using the form in /admin/modules.php .  Attached files ![Capture dcran de 2023-03-13 20-35-29](https://user-images.githubusercontent.com/3855975/224862509-ca08b307-d293-4773-8c59-2c6682cbdab8.png) ![Capture dcran de 2023-03-13 20-37-05](https://user-images.githubusercontent.com/3855975/224862647-ffedd1e5-b3ab-42f9-9eee-34e27e4d6aac.png) other-file other-file",no-bug,0.9
23281,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23281,Bug: Error when deselecting default permissions," Bug When you try to delete a default permission under Setup -> Security, you get an error. Access to this page this way (POST method or GET with a sensible value for 'action' parameter) is refused by CSRF protection in main.inc.php. Token not provided. If you access your server behind a proxy using url rewriting and the parameter is provided by caller, you might check that all HTTP header are propagated (or add the line $dolibarr_nocsrfcheck=1 into your conf.php file or MAIN_SECURITY_CSRF_WITH_TOKEN to 0 instead of 2 into setup).  Environment Version Dolibarr 16.0.3  Environment OS Mac OS 13.0  Environment Web server Apache 2.4.46  Environment PHP PHP 7.4.21  Environment Database MySQL 5.7.34  Environment URL(s) /admin/perms.php  Expected and actual behavior In version 16.0.3, if you do not have MAIN_SECURITY_CSRF_WITH_TOKEN = 1 defined, you will get an error message when you try to disable a default permission. I would imagine that you should be able to disable a default permission, with or without the MAIN_SECURITY_CSRF_WITH_TOKEN constant.  Steps to reproduce the behavior Remove MAIN_SECURITY_CSRF_WITH_TOKEN from the Other Setup items. Enable and then disable a default permission under Setup -> Security.  Attached files _No response_",other-file | other-file,"Bug: Error when deselecting default permissions  Bug When you try to delete a default permission under Setup -> Security, you get an error. Access to this page this way (POST method or GET with a sensible value for 'action' parameter) is refused by CSRF protection in main.inc.php. Token not provided. If you access your server behind a proxy using url rewriting and the parameter is provided by caller, you might check that all HTTP header are propagated (or add the line $dolibarr_nocsrfcheck=1 into your conf.php file or MAIN_SECURITY_CSRF_WITH_TOKEN to 0 instead of 2 into setup).  Environment Version Dolibarr 16.0.3  Environment OS Mac OS 13.0  Environment Web server Apache 2.4.46  Environment PHP PHP 7.4.21  Environment Database MySQL 5.7.34  Environment URL(s) /admin/perms.php  Expected and actual behavior In version 16.0.3, if you do not have MAIN_SECURITY_CSRF_WITH_TOKEN = 1 defined, you will get an error message when you try to disable a default permission. I would imagine that you should be able to disable a default permission, with or without the MAIN_SECURITY_CSRF_WITH_TOKEN constant.  Steps to reproduce the behavior Remove MAIN_SECURITY_CSRF_WITH_TOKEN from the Other Setup items. Enable and then disable a default permission under Setup -> Security.  Attached files _No response_ other-file other-file",no-bug,0.8
25613,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25613,PHP Error when sending invoice email," Bug Hi, When I want to send an email, I have this error: Call to undefined function getDomainFromURL()  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4  Environment Database Percona SQL 8.0  Environment URL(s) _No response_  Expected and actual behavior  [10-Aug-2023 17:08:52 Europe/Berlin] PHP Fatal error: Uncaught Error: Call to undefined function getDomainFromURL() in /space/www/dolibarr/htdocs/core/class/smtps.class.php:697 Stack trace: #0 /space/www/dolibarr/htdocs/core/class/CMailFile.class.php(1004): SMTPs->sendMsg() #1 /space/www/dolibarr/htdocs/core/actions_sendmails.inc.php(372): CMailFile->sendfile() #2 /space/www/dolibarr/htdocs/compta/facture/card.php(2878): include('/space/www/doli') #3 {main} thrown in /space/www/dolibarr/htdocs/core/class/smtps.class.php on line 697  If I add in htdocs/core/class/smtps.class.php the line below it works but I think it is not the right place for this. `require_once(DOL_DOCUMENT_ROOT.'/core/lib/geturl.lib.php');`  Steps to reproduce the behavior Inside an invoice, click on sendemail and then click again on send email.  Attached files _No response_",other-file | other-file | other-file,"PHP Error when sending invoice email  Bug Hi, When I want to send an email, I have this error: Call to undefined function getDomainFromURL()  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4  Environment Database Percona SQL 8.0  Environment URL(s) _No response_  Expected and actual behavior  [10-Aug-2023 17:08:52 Europe/Berlin] PHP Fatal error: Uncaught Error: Call to undefined function getDomainFromURL() in /space/www/dolibarr/htdocs/core/class/smtps.class.php:697 Stack trace: #0 /space/www/dolibarr/htdocs/core/class/CMailFile.class.php(1004): SMTPs->sendMsg() #1 /space/www/dolibarr/htdocs/core/actions_sendmails.inc.php(372): CMailFile->sendfile() #2 /space/www/dolibarr/htdocs/compta/facture/card.php(2878): include('/space/www/doli') #3 {main} thrown in /space/www/dolibarr/htdocs/core/class/smtps.class.php on line 697  If I add in htdocs/core/class/smtps.class.php the line below it works but I think it is not the right place for this. `require_once(DOL_DOCUMENT_ROOT.'/core/lib/geturl.lib.php');`  Steps to reproduce the behavior Inside an invoice, click on sendemail and then click again on send email.  Attached files _No response_ other-file other-file other-file",no-bug,0.9
32467,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32467,Deprecated error on doleditor, Bug Deprecated: htmlspecialchars(): Passing null to parameter #1 ($string) of type string is deprecated in /var/www/htdocs/core/class/doleditor.class.php on line 169  Dolibarr Version 20.0.0  Environment PHP 8.2  Environment Database mariadb-10.11  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file,Deprecated error on doleditor  Bug Deprecated: htmlspecialchars(): Passing null to parameter #1 ($string) of type string is deprecated in /var/www/htdocs/core/class/doleditor.class.php on line 169  Dolibarr Version 20.0.0  Environment PHP 8.2  Environment Database mariadb-10.11  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
27221,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27221,"E-Mailcollector: Save attachments on operation ""recordevent"" for tickets", Feature Request When there is an attachment in a reply to a ticket this attachment should be stored in the ticket. Currently the attachment is lost (not stored)  Use case see above  Suggested implementation _No response_  Suggested steps _No response_,other-file,"E-Mailcollector: Save attachments on operation ""recordevent"" for tickets  Feature Request When there is an attachment in a reply to a ticket this attachment should be stored in the ticket. Currently the attachment is lost (not stored)  Use case see above  Suggested implementation _No response_  Suggested steps _No response_ other-file",no-bug,0.9
30523,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30523,An user with only user->rights->user->self->password can't update it's password, Bug An user with only user->rights->user->self->password (and without user->rights->user->self->creer) can't update it's password  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Create an user 2. Give it only the right user->rights->user->self->password 3. Log with this new user 4. Go to your user card edition 5. Generate a new password 6. Validate the form 7. Disconnect you and try to log you with the new password  Attached files _No response_,other-file | other-file | other-file,An user with only user->rights->user->self->password can't update it's password  Bug An user with only user->rights->user->self->password (and without user->rights->user->self->creer) can't update it's password  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Create an user 2. Give it only the right user->rights->user->self->password 3. Log with this new user 4. Go to your user card edition 5. Generate a new password 6. Validate the form 7. Disconnect you and try to log you with the new password  Attached files _No response_ other-file other-file other-file,no-bug,0.8
28334,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28334,Using 2 digits (yy) for the date format goes to 19XX," Bug Specifying 2 digit in the date format : FormatDateShortJavaInput The date generated is in 1900 Bug in file : lib_head.js.php line 347 : var year=now.getYear(); if (year.length < 4) { year=""""+(year-0+1900); } and line 372 : if (substr == ""yy"") year=""""+(getIntegerInString(val,d,2,2)-0+1900);  Environment Version 19.0.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4  Environment Database MariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![Dolibarr-001](https://github.com/Dolibarr/dolibarr/assets/74211972/4cfbd0d6-67e1-49f1-be58-ff18ccc5f382) ![Dolibarr-002](https://github.com/Dolibarr/dolibarr/assets/74211972/7c60a36f-dd0f-447d-a372-c4f8d2e918d1)",other-file | other-file,"Using 2 digits (yy) for the date format goes to 19XX  Bug Specifying 2 digit in the date format : FormatDateShortJavaInput The date generated is in 1900 Bug in file : lib_head.js.php line 347 : var year=now.getYear(); if (year.length < 4) { year=""""+(year-0+1900); } and line 372 : if (substr == ""yy"") year=""""+(getIntegerInString(val,d,2,2)-0+1900);  Environment Version 19.0.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4  Environment Database MariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![Dolibarr-001](https://github.com/Dolibarr/dolibarr/assets/74211972/4cfbd0d6-67e1-49f1-be58-ff18ccc5f382) ![Dolibarr-002](https://github.com/Dolibarr/dolibarr/assets/74211972/7c60a36f-dd0f-447d-a372-c4f8d2e918d1) other-file other-file",no-bug,0.7
33446,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33446,Bug V21 Linked Object," Bug Dolibarr a dtect une erreur technique. Ces informations peuvent tre utiles  des fins de diagnostic (vous pouvez dfinir l'option $dolibarr_main_prod sur '1' pour masquer les informations sensibles): Date: 20250313163013 Dolibarr: 21.0.0 - https://www.dolibarr.org Niveau de fonctionnalits: 0 Identifiant:  PHP: 8.3.17 Serveur: Apache OS: Linux  4.18.0-553.5.1.lve.1.el8.x86_64 #1 SMP Fri Jun 14 15:38:45 UTC 2024 x86_64 User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 Url sollicite: /comm/propal/card.php?id=3200&save_lastsearch_values=1 Referer: https:///comm/propal/list.php?leftmenu=propals Gestionnaire de menu: eldy_menu.php Modules/Applications: api, syslog, user, ameliorationprojets, notification, tracking, paymentbybanktransfer, product, alertes, blockedlog, tickettotask, dav, ameliorationtiers, knowledgemanagement, stock, ameliorationtickets, productbatch, projet, qualite, fichedevie, ultimatepdf, modulebuilder, milestone, socialnetworks, categorie, fckeditor, ref, ameliorationproduits, bookmark, ameliorationnotedefrais, workflow, import, propal, export, mailing, expedition, heures, m2am, multicurrency, exports, planification, ameliorationcommandes, ameliorationfactures, accounting, agenda, bom, banque, barcode, commande, ecm, expensereport, facture, fournisseur, holiday, margin, mrp, salaries, service, societe, espaceclient, ticket, communication, mbisignature, timemaster, piecesref, produitstickets, ameliorationdevis, ameliorationutilisateurs, ameliorationexpeditions, ameliorationstats, cdav, supplier_proposal, gestionprix, reception, incoterm, stocktransfers, tax, ameliorationexports, fusion Type gestionnaire de base de donnes: mysqli Requte dernier accs en base en erreur: SELECT s.rowid as socid, s.nom as name, s.client, t.rowid, t.titre as ref, t.total_ht FROM dolibarr_societe as s, dolibarr_facture_rec as t WHERE t.fk_soc = s.rowid AND t.fk_soc IN (1051) AND t.entity IN (1) AND t.paye < 1 Code retour dernier accs en base en erreur: DB_ERROR_NOSUCHFIELD Information sur le dernier accs en base en erreur: Unknown column 't.paye' in 'WHERE'  Dolibarr Version 21  Environment PHP 8.3  Environment Database _No response_  Steps to reproduce the behavior and expected behavior Access a document and view linked objects  Attached files _No response_",other-file | other-file | other-file,"Bug V21 Linked Object  Bug Dolibarr a dtect une erreur technique. Ces informations peuvent tre utiles  des fins de diagnostic (vous pouvez dfinir l'option $dolibarr_main_prod sur '1' pour masquer les informations sensibles): Date: 20250313163013 Dolibarr: 21.0.0 - https://www.dolibarr.org Niveau de fonctionnalits: 0 Identifiant:  PHP: 8.3.17 Serveur: Apache OS: Linux  4.18.0-553.5.1.lve.1.el8.x86_64 #1 SMP Fri Jun 14 15:38:45 UTC 2024 x86_64 User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 Url sollicite: /comm/propal/card.php?id=3200&save_lastsearch_values=1 Referer: https:comm/propal/list.php?leftmenu=propals Gestionnaire de menu: eldy_menu.php Modules/Applications: api, syslog, user, ameliorationprojets, notification, tracking, paymentbybanktransfer, product, alertes, blockedlog, tickettotask, dav, ameliorationtiers, knowledgemanagement, stock, ameliorationtickets, productbatch, projet, qualite, fichedevie, ultimatepdf, modulebuilder, milestone, socialnetworks, categorie, fckeditor, ref, ameliorationproduits, bookmark, ameliorationnotedefrais, workflow, import, propal, export, mailing, expedition, heures, m2am, multicurrency, exports, planification, ameliorationcommandes, ameliorationfactures, accounting, agenda, bom, banque, barcode, commande, ecm, expensereport, facture, fournisseur, holiday, margin, mrp, salaries, service, societe, espaceclient, ticket, communication, mbisignature, timemaster, piecesref, produitstickets, ameliorationdevis, ameliorationutilisateurs, ameliorationexpeditions, ameliorationstats, cdav, supplier_proposal, gestionprix, reception, incoterm, stocktransfers, tax, ameliorationexports, fusion Type gestionnaire de base de donnes: mysqli Requte dernier accs en base en erreur: SELECT s.rowid as socid, s.nom as name, s.client, t.rowid, t.titre as ref, t.total_ht FROM dolibarr_societe as s, dolibarr_facture_rec as t WHERE t.fk_soc = s.rowid AND t.fk_soc IN (1051) AND t.entity IN (1) AND t.paye < 1 Code retour dernier accs en base en erreur: DB_ERROR_NOSUCHFIELD Information sur le dernier accs en base en erreur: Unknown column 't.paye' in 'WHERE'  Dolibarr Version 21  Environment PHP 8.3  Environment Database _No response_  Steps to reproduce the behavior and expected behavior Access a document and view linked objects  Attached files _No response_ other-file other-file other-file",no-bug,0.9
23227,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23227,Retrieve the last insert id for a tag link breaks the import with PostgreSQL," Bug With a PostgreSQL database, when we we do an import simulation of a tag link (e.g. between a tag and a supllier), Dolibarr try to retrieve the last insert id of the SQL transaction. Since the insertion will be done in an association table, this cannot work.  Environment Version 16  Environment OS Debian 10.13  Environment Web server Apache/2.4.38  Environment PHP 8.1.11  Environment Database PostgreSQL 14.4  Environment URL(s) /imports/import.php  Expected and actual behavior **Expected behavior:** It should import the tag links. **Actual behavior:** It return an error like:  ERROR: 42P01: relation ""llx_categorie_fournisseur_rowid_seq"" does not exist LINE 1: SELECT currval('llx_categorie_fournisseur_rowid_seq') ^ LOCATION: RangeVarGetRelidExtended, namespace.c:433   Steps to reproduce the behavior Import a tag link.  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file,"Retrieve the last insert id for a tag link breaks the import with PostgreSQL  Bug With a PostgreSQL database, when we we do an import simulation of a tag link (e.g. between a tag and a supllier), Dolibarr try to retrieve the last insert id of the SQL transaction. Since the insertion will be done in an association table, this cannot work.  Environment Version 16  Environment OS Debian 10.13  Environment Web server Apache/2.4.38  Environment PHP 8.1.11  Environment Database PostgreSQL 14.4  Environment URL(s) /imports/import.php  Expected and actual behavior **Expected behavior:** It should import the tag links. **Actual behavior:** It return an error like:  ERROR: 42P01: relation ""llx_categorie_fournisseur_rowid_seq"" does not exist LINE 1: SELECT currval('llx_categorie_fournisseur_rowid_seq') ^ LOCATION: RangeVarGetRelidExtended, namespace.c:433   Steps to reproduce the behavior Import a tag link.  Attached files _No response_ other-file other-file other-file other-file other-file other-file",no-bug,0.9
32072,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32072,PUT method doesn't change the value of the extra fields of the shipments module," Bug When using the `PUT /shipments/{id}` method of the REST_API, the extra fields contained under array_options does not change after a successfull API call.  Dolibarr Version 20.0.2  Environment PHP 8.2.24  Environment Database MySQL or MariaDB 10.9.8-MariaDB-1:10.9.8+maria~deb11  Steps to reproduce the behavior and expected behavior Request body: ![image](https://github.com/user-attachments/assets/69469a27-7e3a-41d3-9e8e-824c4655a549) Response body: ![image](https://github.com/user-attachments/assets/2ed921df-87c9-4b7a-9f3b-ca9be14a6e84) If I try to update a normal field, it works: Request body: ![image](https://github.com/user-attachments/assets/4fc06e53-18bb-43da-bc15-cc43a4f7056b) Response body: ![image](https://github.com/user-attachments/assets/0f7dafe7-db70-48c7-aedc-36de0ce8e36a) If I use the `PUT /products/{id}` method, that also works fine: Request body: ![image](https://github.com/user-attachments/assets/6d8b0be0-af9e-4d3d-838a-59d93290b5d5) Response body: ![image](https://github.com/user-attachments/assets/080dd026-b50d-4966-9acc-b262af22a16f) It looks like the products API handle the array_options: https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/product/class/api_products.class.php#L397 But the shipment API does not: https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/expedition/class/api_shipments.class.php#L486  Attached files _No response_",other-file | other-file | other-file | other-file,"PUT method doesn't change the value of the extra fields of the shipments module  Bug When using the `PUT /shipments/{id}` method of the REST_API, the extra fields contained under array_options does not change after a successfull API call.  Dolibarr Version 20.0.2  Environment PHP 8.2.24  Environment Database MySQL or MariaDB 10.9.8-MariaDB-1:10.9.8+maria~deb11  Steps to reproduce the behavior and expected behavior Request body: ![image](https://github.com/user-attachments/assets/69469a27-7e3a-41d3-9e8e-824c4655a549) Response body: ![image](https://github.com/user-attachments/assets/2ed921df-87c9-4b7a-9f3b-ca9be14a6e84) If I try to update a normal field, it works: Request body: ![image](https://github.com/user-attachments/assets/4fc06e53-18bb-43da-bc15-cc43a4f7056b) Response body: ![image](https://github.com/user-attachments/assets/0f7dafe7-db70-48c7-aedc-36de0ce8e36a) If I use the `PUT /products/{id}` method, that also works fine: Request body: ![image](https://github.com/user-attachments/assets/6d8b0be0-af9e-4d3d-838a-59d93290b5d5) Response body: ![image](https://github.com/user-attachments/assets/080dd026-b50d-4966-9acc-b262af22a16f) It looks like the products API handle the array_options: https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/product/class/api_products.class.php#L397 But the shipment API does not: https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/expedition/class/api_shipments.class.php#L486  Attached files _No response_ other-file other-file other-file other-file",bug,0.95
29909,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29909,Problme de conservation des filtres dans la liste des propal depuis un tiers, Bug Jai besoin daccder  mes PR ouvertes sur un tiers mais je me retrouve avec une PR qui na rien  voir dans ma recherche. Voici mon parcours : ![Image](https://github.com/Evarisk/Projets-developpement/assets/41377034/2142accd-6e6e-4c6a-b252-b36994a30e40) ![Image](https://github.com/Evarisk/Projets-developpement/assets/41377034/cbc525ee-f81e-4b22-bf7f-a42e2e08fc05) ![Image](https://github.com/Evarisk/Projets-developpement/assets/41377034/a23185d2-2d66-4021-ae0e-27b557c5760f) ![Image](https://github.com/Evarisk/Projets-developpement/assets/41377034/6d8ea242-03be-42b9-b6b0-86326a84c3af)  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file | other-file | other-file,Problme de conservation des filtres dans la liste des propal depuis un tiers  Bug Jai besoin daccder  mes PR ouvertes sur un tiers mais je me retrouve avec une PR qui na rien  voir dans ma recherche. Voici mon parcours : ![Image](https://github.com/Evarisk/Projets-developpement/assets/41377034/2142accd-6e6e-4c6a-b252-b36994a30e40) ![Image](https://github.com/Evarisk/Projets-developpement/assets/41377034/cbc525ee-f81e-4b22-bf7f-a42e2e08fc05) ![Image](https://github.com/Evarisk/Projets-developpement/assets/41377034/a23185d2-2d66-4021-ae0e-27b557c5760f) ![Image](https://github.com/Evarisk/Projets-developpement/assets/41377034/6d8ea242-03be-42b9-b6b0-86326a84c3af)  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file,no-bug,0.7
31366,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31366,Bug: Date not kept when an error is made during account creation," Bug Version: 20.0.1 Hello, When I create a bank account I set a date ![image](https://github.com/user-attachments/assets/b582d6e4-1509-4f49-8977-2f5fdce82134) but I don't specify a account number ![image](https://github.com/user-attachments/assets/947ca906-f26f-4785-95dd-ffc3671ab6b2) And I get an error because this field is mandatory ![image](https://github.com/user-attachments/assets/9614a0cc-8394-4850-bbd5-280482423838) However the date that I set in the first place is lost ![image](https://github.com/user-attachments/assets/46523aa3-3cc4-41c4-b270-b514900413b9) So if I don't pay attention to check this field after an initial failed attempt, I don't create the bank account the way I wanted to.  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"Bug: Date not kept when an error is made during account creation  Bug Version: 20.0.1 Hello, When I create a bank account I set a date ![image](https://github.com/user-attachments/assets/b582d6e4-1509-4f49-8977-2f5fdce82134) but I don't specify a account number ![image](https://github.com/user-attachments/assets/947ca906-f26f-4785-95dd-ffc3671ab6b2) And I get an error because this field is mandatory ![image](https://github.com/user-attachments/assets/9614a0cc-8394-4850-bbd5-280482423838) However the date that I set in the first place is lost ![image](https://github.com/user-attachments/assets/46523aa3-3cc4-41c4-b270-b514900413b9) So if I don't pay attention to check this field after an initial failed attempt, I don't create the bank account the way I wanted to.  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
26250,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26250,Bug: Adding a product consisting of a kit to a kit causes fatal error in php 8.2 and only warning in php 7.4,"# Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug [*Short description*] ## Environment - **Version**: 18.0.2 - **OS**: Linux - **Web server**: Apache - **PHP**: fpm-fcgi 8.2.9 - **Database**: MySQL or MariaDB 10.4.25-MariaDB-1:10.4.25+maria~stretch-log - **URL(s)**: /product/composition/card.php?id=4096 ## Expected and actual behavior Our products consist of kits of kits. However, adding kits to kits sometimes causes a fatal error (php 8.2) or at least warnings (php 7.4) [*Verbose description*] ## Steps to reproduce the behavior [*Verbose description*] ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging informations) [*Files*] ## Report <img width=""1115"" alt=""in php 8 2"" src=""https://github.com/Dolibarr/dolibarr/assets/147659158/0e88dc32-bb9a-4775-ac51-74e308861a6b""> <img width=""1115"" alt=""in php 8 2"" src=""https://github.com/Dolibarr/dolibarr/assets/147659158/350c029e-749f-44c6-87b6-e126fa6c8eb6"">",other-file | other-file,"Bug: Adding a product consisting of a kit to a kit causes fatal error in php 8.2 and only warning in php 7.4 # Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug [*Short description*] ## Environment - **Version**: 18.0.2 - **OS**: Linux - **Web server**: Apache - **PHP**: fpm-fcgi 8.2.9 - **Database**: MySQL or MariaDB 10.4.25-MariaDB-1:10.4.25+maria~stretch-log - **URL(s)**: /product/composition/card.php?id=4096 ## Expected and actual behavior Our products consist of kits of kits. However, adding kits to kits sometimes causes a fatal error (php 8.2) or at least warnings (php 7.4) [*Verbose description*] ## Steps to reproduce the behavior [*Verbose description*] ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging informations) [*Files*] ## Report <img width=""1115"" alt=""in php 8 2"" src=""https://github.com/Dolibarr/dolibarr/assets/147659158/0e88dc32-bb9a-4775-ac51-74e308861a6b""> <img width=""1115"" alt=""in php 8 2"" src=""https://github.com/Dolibarr/dolibarr/assets/147659158/350c029e-749f-44c6-87b6-e126fa6c8eb6""> other-file other-file",no-bug,0.8
24187,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24187,Wrong annual total on Bank IOMonthlyReporting," Bug Total of each year is only the last month total. on htdocs/compta/bank/annuel.php code is :  for ($mois = 1; $mois < 13; $mois++) { print '<tr class=""oddeven"">'; print ""<td>"".dol_print_date(dol_mktime(1, 1, 1, $mois, 1, 2000), ""%B"").""</td>""; for ($annee = $year_start; $annee <= $year_end; $annee++) { $totsorties[$annee] = 0; $totentrees[$annee] = 0;  Seem to be better with :  for ($mois = 1; $mois < 13; $mois++) { print '<tr class=""oddeven"">'; print ""<td>"".dol_print_date(dol_mktime(1, 1, 1, $mois, 1, 2000), ""%B"").""</td>""; $totsorties[$annee] = 0; $totentrees[$annee] = 0; for ($annee = $year_start; $annee <= $year_end; $annee++) { $case = sprintf(""%04s-%02s"", $annee, $mois);   Environment Version 17 dev  Environment OS all  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"Wrong annual total on Bank IOMonthlyReporting  Bug Total of each year is only the last month total. on htdocs/compta/bank/annuel.php code is :  for ($mois = 1; $mois < 13; $mois++) { print '<tr class=""oddeven"">'; print ""<td>"".dol_print_date(dol_mktime(1, 1, 1, $mois, 1, 2000), ""%B"").""</td>""; for ($annee = $year_start; $annee <= $year_end; $annee++) { $totsorties[$annee] = 0; $totentrees[$annee] = 0;  Seem to be better with :  for ($mois = 1; $mois < 13; $mois++) { print '<tr class=""oddeven"">'; print ""<td>"".dol_print_date(dol_mktime(1, 1, 1, $mois, 1, 2000), ""%B"").""</td>""; $totsorties[$annee] = 0; $totentrees[$annee] = 0; for ($annee = $year_start; $annee <= $year_end; $annee++) { $case = sprintf(""%04s-%02s"", $annee, $mois);   Environment Version 17 dev  Environment OS all  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.9
26881,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26881,REST API thirparties setlevelprice fix, Bug problem : the API thirparties setlevelprice does not work solution : in file api_thirdparties.class.php correct L562 from ` * @url PUT {id}/setpricelevel` to ` * @url PUT {id}/setpricelevel/{priceLevel}` to fix the API  Environment Version 18.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file,REST API thirparties setlevelprice fix  Bug problem : the API thirparties setlevelprice does not work solution : in file api_thirdparties.class.php correct L562 from ` * @url PUT {id}/setpricelevel` to ` * @url PUT {id}/setpricelevel/{priceLevel}` to fix the API  Environment Version 18.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file,bug,0.9
24031,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24031,Add grand total to lists," Feature Request There'is a total line in the bottom of lists, but it displays only the total of the page If you want to see the grand total, you're obliged to select a big amount of line displayed, it's not convenient and sometimes very long ! A ""grand total"" line would be apreciated !  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Add grand total to lists  Feature Request There'is a total line in the bottom of lists, but it displays only the total of the page If you want to see the grand total, you're obliged to select a big amount of line displayed, it's not convenient and sometimes very long ! A ""grand total"" line would be apreciated !  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
32843,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32843,Linked Files not showing on the BOM Tab," Bug I have Linked documents in Linked Files Tab using the URL, and it is accessible. However, when I return to the BOM Tab it does not show there. This also occurs on the MO. It is working in the Product.  Dolibarr Version 20.0.03  Environment PHP 8.2.22  Environment Database MySQL 8.0.39  Steps to reproduce the behavior and expected behavior Add the File in the Linked Files Tab. The go to the BOM tab, the file is not listed.  Attached files ![Image](https://github.com/user-attachments/assets/7b82372f-9f60-49b9-bf9c-981021d33011) ![Image](https://github.com/user-attachments/assets/525e6c61-0aaf-4595-a270-793b131158e0)",other-file | other-file | other-file | other-file,"Linked Files not showing on the BOM Tab  Bug I have Linked documents in Linked Files Tab using the URL, and it is accessible. However, when I return to the BOM Tab it does not show there. This also occurs on the MO. It is working in the Product.  Dolibarr Version 20.0.03  Environment PHP 8.2.22  Environment Database MySQL 8.0.39  Steps to reproduce the behavior and expected behavior Add the File in the Linked Files Tab. The go to the BOM tab, the file is not listed.  Attached files ![Image](https://github.com/user-attachments/assets/7b82372f-9f60-49b9-bf9c-981021d33011) ![Image](https://github.com/user-attachments/assets/525e6c61-0aaf-4595-a270-793b131158e0) other-file other-file other-file other-file",no-bug,0.9
32317,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32317,Error with report by month sales tax (Parameter localTaxType is missing), Bug When you are at /compta/localtax/index.php?leftmenu=tax_2_vat&localTaxType=2 (IRPF Report per month) ![image](https://github.com/user-attachments/assets/53ca30ce-218c-44d0-8581-67d1e9bd62e3) When you click on a month you get this error: ![image](https://github.com/user-attachments/assets/6465b2dc-e759-4255-8e11-62cbc439cd1d) There seems to be a fix on the thread of the #9428 issue.  Dolibarr Version 19.0.4 and 20.0.2  Environment PHP 8.2.26  Environment Database MySQL or MariaDB 11.4.3-MariaDB-ubu2404  Steps to reproduce the behavior and expected behavior Stated on the bug description  Attached files _No response_,other-file | other-file,Error with report by month sales tax (Parameter localTaxType is missing)  Bug When you are at /compta/localtax/index.php?leftmenu=tax_2_vat&localTaxType=2 (IRPF Report per month) ![image](https://github.com/user-attachments/assets/53ca30ce-218c-44d0-8581-67d1e9bd62e3) When you click on a month you get this error: ![image](https://github.com/user-attachments/assets/6465b2dc-e759-4255-8e11-62cbc439cd1d) There seems to be a fix on the thread of the #9428 issue.  Dolibarr Version 19.0.4 and 20.0.2  Environment PHP 8.2.26  Environment Database MySQL or MariaDB 11.4.3-MariaDB-ubu2404  Steps to reproduce the behavior and expected behavior Stated on the bug description  Attached files _No response_ other-file other-file,no-bug,0.9
27029,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27029,User without access rights to thirdparties cannot access entry to Knowledge DB, Bug User without access rights to thirdparties cannot access entry to Knowledge DB  Environment Version 18.0  Environment OS n/a  Environment Web server n/a  Environment PHP n/a  Environment Database n/a  Environment URL(s) knowledgemanagement/knowledgerecord_card.php  Expected and actual behavior User should be able to access Knowledge DB also without rights to access thirdparties  Steps to reproduce the behavior 1. Enable Module Knowledgemanagement 2. Create an entry to Knowledgemanagement 3. Create a user without rights to access thirdparties and read-rights to Knowledgemanagement 4. Access the entry you created in step 2 There will be an error message  Attached files _No response_,other-file | other-file,User without access rights to thirdparties cannot access entry to Knowledge DB  Bug User without access rights to thirdparties cannot access entry to Knowledge DB  Environment Version 18.0  Environment OS n/a  Environment Web server n/a  Environment PHP n/a  Environment Database n/a  Environment URL(s) knowledgemanagement/knowledgerecord_card.php  Expected and actual behavior User should be able to access Knowledge DB also without rights to access thirdparties  Steps to reproduce the behavior 1. Enable Module Knowledgemanagement 2. Create an entry to Knowledgemanagement 3. Create a user without rights to access thirdparties and read-rights to Knowledgemanagement 4. Access the entry you created in step 2 There will be an error message  Attached files _No response_ other-file other-file,no-bug,0.9
32060,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32060,Add : end-of-month and end-of-year calculation functionality for services and recurring invoices, Feature Request Add function of - [ ] Last day of month - [ ] Last day of year - [ ] dol_time_plus_duree should be in interface for reccuring invoice @W1W1-M @mdeweerd Instead of add number day of month like ![image](https://github.com/user-attachments/assets/cf8f24c3-b827-4069-9045-ff41e5f1a0d5),other-file | other-file | other-file | other-file | other-file | other-file,Add : end-of-month and end-of-year calculation functionality for services and recurring invoices  Feature Request Add function of - [ ] Last day of month - [ ] Last day of year - [ ] dol_time_plus_duree should be in interface for reccuring invoice @W1W1-M @mdeweerd Instead of add number day of month like ![image](https://github.com/user-attachments/assets/cf8f24c3-b827-4069-9045-ff41e5f1a0d5) other-file other-file other-file other-file other-file other-file,no-bug,0.95
30397,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30397,SWIFT/BIC should be optional for direct debit payments according to regulations," Bug **Background:** After importing customer payment details from another system, no direct debit payments could be generated, because Dolibarr expects not only the IBAN but also the SWIFT/BIC code as mandatory information, but the BIC data was not present. **Regulatory Status** There has been a change in the SEPA direct debit regulations from February 2016(!), which made the BIC optional for direct debit transactions within the EU (Switzerland, Monaco and San Marino still require a BIC code), see: https://www.sparkasse.de/pk/ratgeber/finanzplanung/banking-tipps/bic.html (in German). **Fix:** Will add a hidden variable WITHDRAWAL_WITHOUT_BIC which, if set to 1, makes the BIC optional (if BIC is empty, this is ok, if any data is entered for BIC, the existing structural check will still be applied).",other-file | other-file | other-file,"SWIFT/BIC should be optional for direct debit payments according to regulations  Bug **Background:** After importing customer payment details from another system, no direct debit payments could be generated, because Dolibarr expects not only the IBAN but also the SWIFT/BIC code as mandatory information, but the BIC data was not present. **Regulatory Status** There has been a change in the SEPA direct debit regulations from February 2016(!), which made the BIC optional for direct debit transactions within the EU (Switzerland, Monaco and San Marino still require a BIC code), see: https://www.sparkasse.de/pk/ratgeber/finanzplanung/banking-tipps/bic.html (in German). **Fix:** Will add a hidden variable WITHDRAWAL_WITHOUT_BIC which, if set to 1, makes the BIC optional (if BIC is empty, this is ok, if any data is entered for BIC, the existing structural check will still be applied). other-file other-file other-file",no-bug,0.8
27453,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27453,Improvement in the management of batch numbers and serial numbers, Feature Request - [ ] add a check when a product is managed by batches in serial number management (UC1) - [ ] Proposal allowing the numbers to be split into serial numbers if we wish to validate the change of status (UC1) - [ ] Separation of batch number and series number fields(UC2) - [ ] Add option to see all serial number of one lot (UC3)  Use case 1 ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/53e886e4-9695-4b52-934a-eb932e7d6947)  Use Case 2 Missing field for lot : ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/4a75f9d4-8975-419d-89ff-ebac2393b5ea) Should be ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/87d05770-dff9-4157-8e2e-cf811d8aa268)  Use Case 3 ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/23317dc4-24b0-44ee-a377-c6c86ef02ebd),other-file | other-file | other-file | other-file | other-file,Improvement in the management of batch numbers and serial numbers  Feature Request - [ ] add a check when a product is managed by batches in serial number management (UC1) - [ ] Proposal allowing the numbers to be split into serial numbers if we wish to validate the change of status (UC1) - [ ] Separation of batch number and series number fields(UC2) - [ ] Add option to see all serial number of one lot (UC3)  Use case 1 ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/53e886e4-9695-4b52-934a-eb932e7d6947)  Use Case 2 Missing field for lot : ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/4a75f9d4-8975-419d-89ff-ebac2393b5ea) Should be ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/87d05770-dff9-4157-8e2e-cf811d8aa268)  Use Case 3 ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/23317dc4-24b0-44ee-a377-c6c86ef02ebd) other-file other-file other-file other-file other-file,no-bug,0.9
31374,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31374,Bug: Sort by Type d'entit lgale crashes," Bug Version: 20.0.1 Hello, In Tiers > Liste Dolibarr is crashing when I try to sort by Type d'entit lgale  Requte dernier accs en base en erreur: SELECT s.rowid, s.nom as name, s.name_alias, s.barcode, s.address, s.town, s.zip, s.datec, s.code_client, s.code_fournisseur, s.logo, s.entity, st.libelle as stcomm, st.picto as stcomm_picto, s.fk_stcomm as stcomm_id, s.fk_prospectlevel, s.prefix_comm, s.client, s.fournisseur, s.canvas, s.status as status, s.email, s.phone, s.phone_mobile, s.fax, s.url, s.siren as idprof1, s.siret as idprof2, s.ape as idprof3, s.idprof4 as idprof4, s.idprof5 as idprof5, s.idprof6 as idprof6, s.tva_intra, s.fk_pays, s.tms as date_modification, s.datec as date_creation, s.import_key, s.code_compta, s.code_compta_fournisseur, s.parent as fk_parent,s.price_level, s2.nom as name2, typent.code as typent_code, staff.code as staff_code, s.fk_forme_juridique as legalform_code, country.code as country_code, country.label as country_label, state.code_departement as state_code, state.nom as state_name, region.code_region as region_code, region.nom as region_name FROM llx_societe as s LEFT JOIN llx_societe as s2 ON s.parent = s2.rowid LEFT JOIN llx_c_country as country on (country.rowid = s.fk_pays) LEFT JOIN llx_c_typent as typent on (typent.id = s.fk_typent) LEFT JOIN llx_c_effectif as staff on (staff.id = s.fk_effectif) LEFT JOIN llx_c_departements as state on (state.rowid = s.fk_departement) LEFT JOIN llx_c_regions as region on (region.code_region = state.fk_region) LEFT JOIN llx_c_stcomm as st ON s.fk_stcomm = st.id WHERE s.entity IN (1) AND (s.status IN (1)) ORDER BY legalform.code ASC LIMIT 51 Code retour dernier accs en base en erreur: DB_ERROR_NOSUCHFIELD Information sur le dernier accs en base en erreur: Unknown column 'legalform.code' in 'order clause'  The problem is just after ORDER BY it's written legalform.code whereas earlier in the query it's s.fk_forme_juridique as legalform_code with an underscore so the correct query is `ORDER BY legalform_code` I don't know where to modify the code, so I open the ticket.  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"Bug: Sort by Type d'entit lgale crashes  Bug Version: 20.0.1 Hello, In Tiers > Liste Dolibarr is crashing when I try to sort by Type d'entit lgale  Requte dernier accs en base en erreur: SELECT s.rowid, s.nom as name, s.name_alias, s.barcode, s.address, s.town, s.zip, s.datec, s.code_client, s.code_fournisseur, s.logo, s.entity, st.libelle as stcomm, st.picto as stcomm_picto, s.fk_stcomm as stcomm_id, s.fk_prospectlevel, s.prefix_comm, s.client, s.fournisseur, s.canvas, s.status as status, s.email, s.phone, s.phone_mobile, s.fax, s.url, s.siren as idprof1, s.siret as idprof2, s.ape as idprof3, s.idprof4 as idprof4, s.idprof5 as idprof5, s.idprof6 as idprof6, s.tva_intra, s.fk_pays, s.tms as date_modification, s.datec as date_creation, s.import_key, s.code_compta, s.code_compta_fournisseur, s.parent as fk_parent,s.price_level, s2.nom as name2, typent.code as typent_code, staff.code as staff_code, s.fk_forme_juridique as legalform_code, country.code as country_code, country.label as country_label, state.code_departement as state_code, state.nom as state_name, region.code_region as region_code, region.nom as region_name FROM llx_societe as s LEFT JOIN llx_societe as s2 ON s.parent = s2.rowid LEFT JOIN llx_c_country as country on (country.rowid = s.fk_pays) LEFT JOIN llx_c_typent as typent on (typent.id = s.fk_typent) LEFT JOIN llx_c_effectif as staff on (staff.id = s.fk_effectif) LEFT JOIN llx_c_departements as state on (state.rowid = s.fk_departement) LEFT JOIN llx_c_regions as region on (region.code_region = state.fk_region) LEFT JOIN llx_c_stcomm as st ON s.fk_stcomm = st.id WHERE s.entity IN (1) AND (s.status IN (1)) ORDER BY legalform.code ASC LIMIT 51 Code retour dernier accs en base en erreur: DB_ERROR_NOSUCHFIELD Information sur le dernier accs en base en erreur: Unknown column 'legalform.code' in 'order clause'  The problem is just after ORDER BY it's written legalform.code whereas earlier in the query it's s.fk_forme_juridique as legalform_code with an underscore so the correct query is `ORDER BY legalform_code` I don't know where to modify the code, so I open the ticket.  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
32161,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32161,Payment terms are not taken from thirdparty when proposal is created from project, Bug Payment terms are not taken from thirdparty when proposal is created from project  Dolibarr Version 19.0  Environment PHP n/a  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Create a new Thirdparty and set payment terms to any value 2. Create a new project with this thirdparty 3. Create a new proposal from the project Bug: Payment terms are empty and not taken from thirdparty.  Attached files _No response_,other-file | other-file,Payment terms are not taken from thirdparty when proposal is created from project  Bug Payment terms are not taken from thirdparty when proposal is created from project  Dolibarr Version 19.0  Environment PHP n/a  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Create a new Thirdparty and set payment terms to any value 2. Create a new project with this thirdparty 3. Create a new proposal from the project Bug: Payment terms are empty and not taken from thirdparty.  Attached files _No response_ other-file other-file,no-bug,0.9
23142,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23142,Product Creation Detail not kept," Bug When creating a new product, values from drop menu are not kept when product is validated.  Environment Version 15.0.3  Environment OS Ubuntu Server LTS 20.04.5  Environment Web server Apache/2.4.41  Environment PHP PHP 7.4.3  Environment Database MySQL 8.0.31  Environment URL(s) _No response_  Expected and actual behavior Create a new product Choose nature of product: raw material Validate product creation Expected: nature of product is defined a per initial choice: raw material Actual behavior: nature of product is empty  Steps to reproduce the behavior Create a new product Choose nature of product: raw material Validate product creation  Attached files _No response_",other-file | other-file,"Product Creation Detail not kept  Bug When creating a new product, values from drop menu are not kept when product is validated.  Environment Version 15.0.3  Environment OS Ubuntu Server LTS 20.04.5  Environment Web server Apache/2.4.41  Environment PHP PHP 7.4.3  Environment Database MySQL 8.0.31  Environment URL(s) _No response_  Expected and actual behavior Create a new product Choose nature of product: raw material Validate product creation Expected: nature of product is defined a per initial choice: raw material Actual behavior: nature of product is empty  Steps to reproduce the behavior Create a new product Choose nature of product: raw material Validate product creation  Attached files _No response_ other-file other-file",no-bug,0.9
23790,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23790,"Bug: REST API ""/mos/{id}/produceandconsume"" not possible to consume specific MoLines"," Bug The implementation doest correspond the function in Dolibarr. i need feedback if i should revise the function.  Environment Version 17  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior **Expected behavior:** Like the same behavior with the API as in the Dolibarr UI: ![image](https://user-images.githubusercontent.com/78662388/216821734-096cc624-f9c7-432a-958b-f3a52d58aba3.png) _REST Call:_  { ""inventorylabel"": ""Production of MO2301-0005"", ""inventorycode"": ""20230205140301"", ""autoclose"": 1, ""arraytoconsume"": [{""objectId"": 253, ""qty"": 2, ""fk_warehouse"": 1}], ""arraytoproduce"": [] }  **Actual behavior:** The REST Call returns a ""Internal Server Error"". Problems: 1. Only if no value in arraytoconsume and arraytoproduce the API make a ""automatic"" consum and produce over all MoLines. Its crashing if the Stockvalue is lower then the expected qty in the MoLine. 2. The ""objectId"" is linked to fk_product. This is wrong we need a link to the MoLine. 3. If you set a value in arraytoconsume or arraytoproduce then the API function try to generate a new MoLine. The current implementation of the API function make not ""produce and consume"".  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Bug: REST API ""/mos/{id}/produceandconsume"" not possible to consume specific MoLines  Bug The implementation doest correspond the function in Dolibarr. i need feedback if i should revise the function.  Environment Version 17  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior **Expected behavior:** Like the same behavior with the API as in the Dolibarr UI: ![image](https://user-images.githubusercontent.com/78662388/216821734-096cc624-f9c7-432a-958b-f3a52d58aba3.png) _REST Call:_  { ""inventorylabel"": ""Production of MO2301-0005"", ""inventorycode"": ""20230205140301"", ""autoclose"": 1, ""arraytoconsume"": [{""objectId"": 253, ""qty"": 2, ""fk_warehouse"": 1}], ""arraytoproduce"": [] }  **Actual behavior:** The REST Call returns a ""Internal Server Error"". Problems: 1. Only if no value in arraytoconsume and arraytoproduce the API make a ""automatic"" consum and produce over all MoLines. Its crashing if the Stockvalue is lower then the expected qty in the MoLine. 2. The ""objectId"" is linked to fk_product. This is wrong we need a link to the MoLine. 3. If you set a value in arraytoconsume or arraytoproduce then the API function try to generate a new MoLine. The current implementation of the API function make not ""produce and consume"".  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",bug,0.95
23089,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23089,"Bug: Wrong replenishment line of a article, if the article is consumed in a MO."," Bug If a article is consumed in a MO the ""Replenishment"" shows the article to replenish with ""0"" to order. ![image](https://user-images.githubusercontent.com/78662388/205441449-3246f2cc-baa2-44c0-81ba-2bb164f7ab37.png)  Environment Version 17.0.0-beta  Environment OS Windows 10  Environment Web server xampp  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) _No response_  Expected and actual behavior The article should be not in the list.  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Bug: Wrong replenishment line of a article, if the article is consumed in a MO.  Bug If a article is consumed in a MO the ""Replenishment"" shows the article to replenish with ""0"" to order. ![image](https://user-images.githubusercontent.com/78662388/205441449-3246f2cc-baa2-44c0-81ba-2bb164f7ab37.png)  Environment Version 17.0.0-beta  Environment OS Windows 10  Environment Web server xampp  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) _No response_  Expected and actual behavior The article should be not in the list.  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
28393,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28393,Establish a single entry point," Feature Request Establishing a single entry point in htdocs/index.php would go a long way toward simplifying function calls, application routing, and improving security.  Use case It is very simple to add two GET variables to the url indicating the path and name of the file that has to be executed as the first approximation to a single entry point. As a direct improvement, the calls to each controller would already have all the libraries loaded instead of having to load them in each call, and in addition, we would have a constant with the input path without having to define it in the configuration, since it would be the __DIR__ of index.php  Suggested implementation The modification so that GET variables are accepted is already implemented. The only thing that would have to be done is to modify the call menus so that they call the main index.php with said variables, and in the controllers not to call again what has already been invoked.  Suggested steps The steps to follow would be: - First, modify the index.php so that it checks if the GET variables exist, and if so, redirect the call to the corresponding controller. - Secondly, modify each controller so that it considers that the calls to the standard libraries are already loaded if it is invoked from index.php - Modify the menus so that they invoke index.php with the GET variables instead of the direct URL.",other-file,"Establish a single entry point  Feature Request Establishing a single entry point in htdocs/index.php would go a long way toward simplifying function calls, application routing, and improving security.  Use case It is very simple to add two GET variables to the url indicating the path and name of the file that has to be executed as the first approximation to a single entry point. As a direct improvement, the calls to each controller would already have all the libraries loaded instead of having to load them in each call, and in addition, we would have a constant with the input path without having to define it in the configuration, since it would be the __DIR__ of index.php  Suggested implementation The modification so that GET variables are accepted is already implemented. The only thing that would have to be done is to modify the call menus so that they call the main index.php with said variables, and in the controllers not to call again what has already been invoked.  Suggested steps The steps to follow would be: - First, modify the index.php so that it checks if the GET variables exist, and if so, redirect the call to the corresponding controller. - Secondly, modify each controller so that it considers that the calls to the standard libraries are already loaded if it is invoked from index.php - Modify the menus so that they invoke index.php with the GET variables instead of the direct URL. other-file",no-bug,0.9
32147,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32147,Customer Invoice Search, Bug In the customer invoice module I want the customer to see his/her own invoices. Although there are invoices for the customer somehow it does not see it when logged in as this customer. When performing a search in the LIST section of Customer Invoices the search crashes.  Dolibarr Version 20.0.2  Environment PHP 8.1  Environment Database Server: Localhost via UNIX socket Server type: MySQL Server connection: SSL is not being used Documentation Server version: 8.0.40-cll-lve - MySQL Community Server - GPL Protocol version: 10  Steps to reproduce the behavior and expected behavior login as a 3rd party head over to Billing/Payment which the 3rd party has permission to Search.  Attached files ![2](https://github.com/user-attachments/assets/ad35e461-2080-4961-ad83-ac0cdc437b6c) ![1](https://github.com/user-attachments/assets/ad58d181-7417-42aa-8d84-64551380922f),other-file | other-file,Customer Invoice Search  Bug In the customer invoice module I want the customer to see his/her own invoices. Although there are invoices for the customer somehow it does not see it when logged in as this customer. When performing a search in the LIST section of Customer Invoices the search crashes.  Dolibarr Version 20.0.2  Environment PHP 8.1  Environment Database Server: Localhost via UNIX socket Server type: MySQL Server connection: SSL is not being used Documentation Server version: 8.0.40-cll-lve - MySQL Community Server - GPL Protocol version: 10  Steps to reproduce the behavior and expected behavior login as a 3rd party head over to Billing/Payment which the 3rd party has permission to Search.  Attached files ![2](https://github.com/user-attachments/assets/ad35e461-2080-4961-ad83-ac0cdc437b6c) ![1](https://github.com/user-attachments/assets/ad58d181-7417-42aa-8d84-64551380922f) other-file other-file,no-bug,0.8
23420,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23420,fatal error on tasks list when time to bill field is selected with no category filter," Bug ![image](https://user-images.githubusercontent.com/68421590/210745609-4a6760e9-f1a4-4d06-8c6e-6a70245f35df.png) There's a check on $search_categ but not on its value therefore when $search_categ equals -1, the condition is filled. It should be as it is everywhere in the task/list.php file : ![image](https://user-images.githubusercontent.com/68421590/210746324-4db614dc-b94f-4c22-84c1-8cb1d42f633e.png)  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"fatal error on tasks list when time to bill field is selected with no category filter  Bug ![image](https://user-images.githubusercontent.com/68421590/210745609-4a6760e9-f1a4-4d06-8c6e-6a70245f35df.png) There's a check on $search_categ but not on its value therefore when $search_categ equals -1, the condition is filled. It should be as it is everywhere in the task/list.php file : ![image](https://user-images.githubusercontent.com/68421590/210746324-4db614dc-b94f-4c22-84c1-8cb1d42f633e.png)  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.8
24690,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24690,search by accounting code with virtual zero," Feature Request When i want to search products with virtual zero like 7060 in products accounting from comptaiblit module, j'ai un resultat vide. This seems normal to me because its virtual zero (only visible to the user) that are added at the end of my accounting numbers. Except that many users do not know this subtilety. It will be good to manage the problem in the search when the conf of virtual zeros is enabled in order to avoid this misunderstanding.  Use case _No response_  Suggested implementation We could delete the additional 0 when searching from a field of type accounting code.  Suggested steps _No response_",other-file,"search by accounting code with virtual zero  Feature Request When i want to search products with virtual zero like 7060 in products accounting from comptaiblit module, j'ai un resultat vide. This seems normal to me because its virtual zero (only visible to the user) that are added at the end of my accounting numbers. Except that many users do not know this subtilety. It will be good to manage the problem in the search when the conf of virtual zeros is enabled in order to avoid this misunderstanding.  Use case _No response_  Suggested implementation We could delete the additional 0 when searching from a field of type accounting code.  Suggested steps _No response_ other-file",no-bug,0.9
26856,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26856,[UI/UX] Update body class to all pages," Feature Request Here is a summary of the actions to be taken on Dolibarr pages following the ui/ux round table at the Dolibarr winter 2023 dev camp. To help css integrator to easily target elements according to page context. Note : css class name use bem write style  Use case _No response_  Suggested implementation For all page add css classes to body 1. To describe curent module use the prefix **mod-** followed by the module name ex : **mod-**_modulename_ 2. To describe curent page type use the prefix **page-** followed by the page type: **page-**list list of page type : page-list, page-card, page-dashboard, page-stats, page-admin, page-card_documents , page-card_notes, page-card_agenda 3. Differentiate between edit, create, and delete at file level by using css class. To describe curent page action use the prefix **action-** followed by the curent action. limit class to **action-create, action-delete, action-update** Action-view isn't present because irrelevant view is default action  Suggested steps for 3 - [ ] add behavior to llxHeader  Suggested steps for 1 & 2 - [x] **Module Holiday** #30375 - [x] ./holiday/card.php - [x] ./holiday/card_group.php - [x] ./holiday/define_holiday.php - [x] ./holiday/document.php - [x] ./holiday/info.php - [x] ./holiday/list.php - [x] ./holiday/month_report.php - [x] ./holiday/view_log.php - [x] **Module loan** #30370 - [x] ./loan/card.php #30370 - [x] ./loan/document.php #30370 - [x] ./loan/info.php #30370 - [x] ./loan/list.php #30370 - [x] ./loan/note.php #30370 - [x] ./loan/payment/card.php #30370 - [x] ./loan/payment/payment.php #30370 - [x] ./loan/schedule.php #30370 - [ ] **Module asset** - [x] ./asset/accountancy_codes.php #27152 - [ ] ./asset/admin/asset_extrafields.php - [ ] ./asset/admin/assetmodel_extrafields.php - [ ] ./asset/admin/setup.php - [x] ./asset/agenda.php #27152 - [x] ./asset/card.php #27152 - [x] ./asset/depreciation_options.php #27152 - [x] ./asset/depreciation.php #27152 - [x] ./asset/disposal.php #27152 - [x] ./asset/document.php #27152 - [x] ./asset/list.php #27152 - [x] ./asset/model/accountancy_codes.php #27152 - [x] ./asset/model/agenda.php #27152 - [x] ./asset/model/card.php #27152 - [x] ./asset/model/depreciation_options.php #27152 - [x] ./asset/model/list.php #27152 - [x] ./asset/model/note.php #27152 - [x] ./asset/note.php #27152 - [ ] **Module barcode** - [ ] ./barcode/codeinit.php - [ ] ./barcode/printsheet.php - [ ] ./blockedlog/admin/blockedlog_list.php - [ ] ./blockedlog/admin/blockedlog.php - [ ] **Module command** - [x] ./commande/agenda.php #27144 - [x] ./commande/card.php #27144 - [x] ./commande/contact.php #27144 - [ ] ./commande/customer.php - [x] ./commande/document.php #27144 - [ ] ./commande/index.php - [ ] ./commande/list_det.php - [ ] ./commande/list_det.php - [x] ./commande/list.php #27144 - [x] ./commande/note.php #27144 - [x] ./commande/stats/index.php #27144 - [ ] ./delivery/card.php - [x] **Module don** #27153 - [x] ./don/admin/donation_extrafields.php #27153 - [x] ./don/admin/donation.php #27153 - [x] ./don/card.php #27153 - [x] ./don/document.php #27153 - [x] ./don/index.php #27153 - [x] ./don/info.php #27153 - [x] ./don/list.php #27153 - [x] ./don/note.php #27153 - [x] ./don/payment/card.php #27153 - [x] ./don/payment/payment.php #27153 - [x] ./don/stats/index.php #27153 - [ ] **Module export** - [ ] ./exports/export.php - [ ] ./exports/index.php - [ ] **Module knowledgemanagement** - [ ] ./knowledgemanagement/knowledgemanagementindex.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_agenda.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_card.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_contact.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_document.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_list.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_note.php #29867 - [x] **Module partnership** #29875 - [x] ./partnership/admin/partnership_extrafields.php #29875 - [x] ./partnership/admin/setup.php #29875 - [x] ./partnership/admin/website.php #29875 - [x] ./partnership/partnership_agenda.php #29875 - [x] ./partnership/partnership_card.php #29875 - [x] ./partnership/partnership_contact.php #29875 - [x] ./partnership/partnership_document.php #29875 - [x] ./partnership/partnership_list.php #29875 - [x] ./partnership/partnership_note.php #29875 - [ ] **./paypal/admin/paypal.php** - [ ] **Module product** - [x] ./product/admin/dynamic_prices.php - [x] ./product/admin/inventory_extrafields.php - [x] ./product/admin/price_rules.php - [x] ./product/admin/product_extrafields.php - [x] ./product/admin/product_lot_extrafields.php - [x] ./product/admin/product_lot.php - [x] ./product/admin/product_supplier_extrafields.php - [x] ./product/admin/product_tools.php - [x] ./product/admin/product.php - [x] ./product/admin/stock_extrafields.php - [x] ./product/admin/stock_mouvement_extrafields.php - [x] ./product/agenda.php - [x] ./product/card.php - [x] ./product/composition/card.php - [x] ./product/document.php - [x] ./product/dynamic_price/editor.php - [ ] ./product/fournisseurs.php - [ ] ./product/index.php - [x] ./product/inventory/card.php - [x] ./product/inventory/inventory.php - [ ] ./product/inventory/list.php - [ ] ./product/list.php - [ ] ./product/list.php - [ ] ./product/note.php - [ ] ./product/popuprop.php - [ ] ./product/price.php - [ ] ./product/reassort.php - [ ] ./product/reassortlot.php - [ ] ./product/stats/bom.php - [x] ./product/stats/card.php #29894 - [x] ./product/stats/card.php #29894 - [x] ./product/stats/commande_fournisseur.php #29894 - [x] ./product/stats/commande.php #29894 - [x] ./product/stats/contrat.php #29894 - [x] ./product/stats/facture_fournisseur.php #29894 - [x] ./product/stats/facture.php #29894 - [x] ./product/stats/facturerec.php #29894 - [x] ./product/stats/mo.php #29894 - [x] ./product/stats/propal.php #29894 - [x] ./product/stats/supplier_proposal.php #29894 - [ ] ./product/stock/card.php - [x] ./product/stock/fiche-valo.php #29894 - [x] ./product/stock/index.php #29894 - [x] ./product/stock/info.php #29894 - [x] ./product/stock/list.php #29894 - [x] ./product/stock/massstockmove.php #29894 - [x] ./product/stock/movement_card.php #29894 - [x] ./product/stock/movement_list.php #29894 - [x] ./product/stock/product.php #29894 - [x] ./product/stock/productlot_card.php #29894 - [x] ./product/stock/productlot_document.php #29894 - [x] ./product/stock/productlot_list.php #29894 - [x] ./product/stock/productlot_note.php #29894 - [x] ./product/stock/replenish.php #29894 - [x] ./product/stock/replenishorders.php #29894 - [x] ./product/stock/stats/commande_fournisseur.php - [x] ./product/stock/stats/expedition.php - [ ] ./product/stock/stats/mo.php - [x] ./product/stock/stats/reception.php #29894 - [x] ./product/stock/stockatdate.php #29894 - [x] ./product/stock/stocktransfer/stocktransfer_agenda.php - [x] ./product/stock/stocktransfer/stocktransfer_card.php - [ ] ./product/stock/stocktransfer/stocktransfer_contact.php - [x] ./product/stock/stocktransfer/stocktransfer_document.php - [x] ./product/stock/stocktransfer/stocktransfer_list.php - [x] ./product/stock/stocktransfer/stocktransfer_note.php - [x] ./product/stock/valo.php #29894 - [ ] ./product/traduction.php - [ ] **Module resource** - [ ] ./resource/agenda.php - [ ] ./resource/card.php - [ ] ./resource/contact.php - [ ] ./resource/document.php - [ ] ./resource/element_resource.php - [ ] ./resource/list.php - [ ] ./resource/note.php - [ ] **Module supplier_proposal** - [ ] ./supplier_proposal/admin/supplier_proposal_extrafields.php - [ ] ./supplier_proposal/admin/supplier_proposaldet_extrafields.php - [ ] ./supplier_proposal/card.php - [ ] ./supplier_proposal/contact.php - [ ] ./supplier_proposal/document.php - [ ] ./supplier_proposal/index.php - [ ] ./supplier_proposal/info.php - [ ] ./supplier_proposal/list.php - [ ] ./supplier_proposal/note.php - [ ] **Module takepos** - [ ] ./takepos/admin/appearance.php - [ ] ./takepos/admin/bar.php - [ ] ./takepos/admin/orderprinters.php - [ ] ./takepos/admin/other.php - [ ] ./takepos/admin/receipt.php - [ ] ./takepos/admin/setup.php - [ ] ./takepos/admin/terminal.php - [ ] ./takepos/invoice.php - [ ] ./takepos/phone.php - [ ] **Module ticket** - [ ] ./ticket/agenda.php - [ ] ./ticket/card.php - [ ] ./ticket/contact.php - [ ] ./ticket/document.php - [ ] ./ticket/index.php - [ ] ./ticket/list.php - [ ] ./ticket/messaging.php - [ ] ./ticket/stats/index.php - [ ] **Module user** - [x] ./user/admin/group_extrafields.php - [x] ./user/admin/user_extrafields.php - [x] ./user/agenda_extsites.php - [x] ./user/bank.php - [x] ./user/card.php - [x] ./user/clicktodial.php - [x] ./user/document.php - [x] ./user/group/card.php - [x] ./user/group/ldap.php - [x] ./user/group/list.php - [x] ./user/group/perms.php - [x] ./user/hierarchy.php - [x] ./user/home.php - [ ] ./user/info.php - [x] ./user/ldap.php - [x] ./user/list.php - [x] ./user/note.php - [x] ./user/notify/card.php - [x] ./user/param_ihm.php - [x] ./user/perms.php - [x] ./user/virtualcard.php - [ ] **Module webhook** - [ ] ./webhook/target_card.php - [ ] ./webhook/target_list.php - [ ] ./webhook/webhookindex.php - [ ] **Module website** - [ ] ./website/index.php - [ ] ./website/websiteaccount_card.php - [ ] **Module workstation** - [ ] ./workstation/workstation_agenda.php - [ ] ./workstation/workstation_card.php - [ ] ./workstation/workstation_document.php - [ ] ./workstation/workstation_list.php - [ ] ./workstation/workstation_note.php - [ ] ./categories/traduction.php - [ ] ./index.php - [ ] **Module fichinter** - [ ] ./fichinter/contact.php - [ ] ./fichinter/index.php - [ ] ./fichinter/card-rec.php - [ ] ./fichinter/note.php - [ ] ./fichinter/document.php - [ ] ./fichinter/stats/index.php - [ ] ./fichinter/admin/fichinterdet_extrafields.php - [ ] ./fichinter/admin/fichinter_extrafields.php - [ ] ./fichinter/agenda.php - [ ] ./fichinter/list.php - [ ] ./fichinter/card.php - [x] **Module fourn_commande** - [x] ./fourn/commande/info.php #27381 - [x] ./fourn/commande/contact.php #27381 - [x] ./fourn/commande/index.php #27381 - [x] ./fourn/commande/note.php #27381 - [x] ./fourn/commande/document.php #27381 - [x] ./fourn/commande/dispatch.php #27381 - [x] ./fourn/commande/list.php #27381 - [x] ./fourn/commande/card.php #27381 - [ ] **Module fourn_product** - [ ] ./fourn/product/list.php - [ ] **Module fourn_facture** - [ ] ./fourn/facture/info.php - [ ] ./fourn/facture/contact.php - [ ] ./fourn/facture/index.php - [ ] ./fourn/facture/rapport.php - [ ] ./fourn/facture/card-rec.php - [ ] ./fourn/facture/note.php - [ ] ./fourn/facture/document.php - [ ] ./fourn/facture/list-rec.php - [ ] ./fourn/facture/list.php - [ ] ./fourn/facture/card.php - [ ] ./fourn/facture/paiement.php - [ ] ./fourn/card.php - [ ] ./fourn/recap-fourn.php - [x] **Module accountancy** - [x] ./accountancy/customer/lines.php - [x] ./accountancy/supplier/index.php - [x] ./accountancy/supplier/list.php - [x] ./accountancy/supplier/card.php - [x] ./accountancy/supplier/lines.php - [x] ./accountancy/expensereport/index.php - [x] ./accountancy/expensereport/list.php - [x] ./accountancy/expensereport/card.php - [x] ./accountancy/expensereport/lines.php - [x] accountancy/journal/bankjournal.php #30026 - [x] accountancy/journal/expensereportsjournal.php #30026 - [x] accountancy/journal/purchasesjournal.php #30026 - [x] accountancy/journal/sellsjournal.php #30026 - [x] accountancy/journal/variousjournal.php #30026 - [x] bookkeeping/balance.php #30028 - [x] accountancy/bookkeeping/card.php #30028 - [x] accountancy/bookkeeping/export.php #30028 - [x] accountancy/bookkeeping/list.php #30028 - [x] accountancy/bookkeeping/listbyaccount.php #30028 - [ ] **Module margin** - [ ] ./margin/tabs/thirdpartyMargins.php - [ ] ./margin/tabs/productMargins.php - [ ] ./margin/agentMargins.php - [ ] ./margin/checkMargins.php - [ ] ./margin/admin/margin.php - [ ] ./margin/customerMargins.php - [ ] ./margin/productMargins.php - [x] **Module projet** - [x] ./projet/element.php #30357 - [x] ./projet/activity/perday.php #30357 - [x] ./projet/activity/perweek.php #30357 - [x] ./projet/activity/permonth.php #30357 - [x] ./projet/index.php #30357 - [x] ./projet/note.php #30357 - [ ] ./projet/document.php - [x] ./projet/stats/index.php #30357 - [ ] ./projet/admin/project_extrafields.php - [x] ./projet/admin/website.php #30357 - [x] ./projet/admin/project_task_extrafields.php #30357 - [x] ./projet/admin/project.php #30357 - [x] ./projet/tasks/task.php - [x] ./projet/tasks/contact.php #30357 - [x] ./projet/tasks/note.php - [x] ./projet/tasks/document.php - [x] ./projet/tasks/time.php - [x] ./projet/tasks/stats/index.php - [x] ./projet/tasks/list.php - [x] ./projet/tasks/comment.php #30357 - [x] ./projet/ganttview.php #30357 - [x] ./projet/agenda.php #30357 - [x] ./projet/list.php #30357 - [x] ./projet/card.php #30357 - [x] ./projet/tasks.php #30357 - [x] ./projet/comment.php #30357 - [x] ./projet/admin/project_extrafields.php #30357 - [x] ./projet/contact.php #30357 - [x] ./projet/document.php #30357 - [x] ./projet/messaging.php #30357 - [ ] **Module expedition** - [ ] ./expedition/contact.php - [ ] ./expedition/index.php - [ ] ./expedition/note.php - [ ] ./expedition/document.php - [ ] ./expedition/stats/month.php - [ ] ./expedition/stats/index.php - [ ] ./expedition/dispatch.php - [ ] ./expedition/list.php - [ ] ./expedition/card.php - [ ] ./expedition/shipment.php - [ ] **Module modulebuilder** ** BE CARFULL OF MODULE TEMPLATE** - [ ] ./modulebuilder/index.php - [ ] ./modulebuilder/admin/setup.php - [x] ./modulebuilder/template/myobject_agenda.php #27146 - [x] ./modulebuilder/template/myobject_list.php #27146 - [x] ./modulebuilder/template/myobject_note.php #27146 - [x] ./modulebuilder/template/mymoduleindex.php #27146 - [x] ./modulebuilder/template/myobject_card.php #27146 - [x] ./modulebuilder/template/admin/about.php #27146 - [x] ./modulebuilder/template/admin/myobject_extrafields.php #27146 - [x] ./modulebuilder/template/admin/setup.php #27146 - [x] ./modulebuilder/template/myobject_document.php #27146 - [x] ./modulebuilder/template/myobject_contact.php #27146 - [ ] **Module zapier** - [ ] ./zapier/admin/about.php - [ ] ./zapier/admin/setup.php - [ ] **Module externalsite** - [ ] ./externalsite/frames.php - [ ] ./externalsite/frames.php - [ ] ./externalsite/frames.php - [x] ./externalsite/admin/index.php - [ ] ./collab/index.php - [ ] **Module bookcal** - [ ] ./bookcal/availabilities_document.php - [ ] ./bookcal/availabilities_agenda.php - [ ] ./bookcal/availabilities_list.php - [ ] ./bookcal/availabilities_note.php - [ ] ./bookcal/admin/setup.php - [ ] ./bookcal/admin/booking_extrafields.php - [ ] ./bookcal/admin/availabilities_extrafields.php - [ ] ./bookcal/booking_list.php - [ ] ./bookcal/booking_card.php - [ ] ./bookcal/availabilities_contact.php - [ ] ./bookcal/bookcalindex.php - [ ] ./bookcal/booking_agenda.php - [ ] ./bookcal/booking_document.php - [ ] ./bookcal/booking_note.php - [ ] ./bookcal/availabilities_card.php - [ ] ./bookcal/booking_contact.php - [ ] **Module bom** - [x] ./bom/bom_agenda.php - [x] ./bom/bom_note.php - [x] ./bom/bom_card.php - [x] ./bom/bom_document.php - [ ] ./bom/bom_list.php - [x] ./bom/bom_net_needs.php - [ ] **Module intracommreport** - [ ] ./intracommreport/admin/intracommreport.php - [ ] ./intracommreport/list.php - [ ] ./intracommreport/card.php - [ ] **Module asterisk** - [ ] ./asterisk/wrapper.php - [ ] ./asterisk/wrapper.php - [ ] **Module reception** - [ ] ./reception/contact.php - [ ] ./reception/index.php - [ ] ./reception/note.php - [ ] ./reception/document.php - [ ] ./reception/stats/month.php - [ ] ./reception/stats/index.php - [ ] ./reception/dispatch.php - [ ] ./reception/list.php - [ ] ./reception/card.php - [ ] **Module bookmarks** - [ ] ./bookmarks/admin/bookmark.php - [ ] ./bookmarks/list.php - [ ] ./bookmarks/card.php - [ ] **Module printing** - [ ] ./printing/index.php - [ ] ./printing/admin/printing.php - [ ] **Module mrp** #30373 - [x] ./mrp/mo_note.php - [x] ./mrp/index.php - [x] ./mrp/mo_card.php - [x] ./mrp/mo_movements.php - [x] ./mrp/mo_agenda.php - [x] ./mrp/mo_production.php - [x] ./mrp/mo_list.php - [x] ./mrp/mo_document.php - [ ] **Admin pages** - [ ] ./admin/supplier_order.php - [ ] ./admin/stocktransfer.php - [ ] ./admin/modules.php - [x] ./admin/dict.php - [x] ./admin/debugbar.php - [x] ./admin/ecm_files_extrafields.php - [ ] ./admin/commande.php - [ ] ./admin/user.php - [x] ./admin/ecm_directories_extrafields.php - [x] ./admin/delivery.php - [x] ./admin/mailing.php - [ ] ./admin/multicurrency.php - [ ] ./admin/resource_extrafields.php - [x] ./admin/bank.php - [x] ./admin/mails_ingoing.php - [ ] ./admin/menus.php - [x] ./admin/bank_extrafields.php - [x] ./admin/bomline_extrafields.php - [ ] ./admin/facture_situation.php - [x] ./admin/agenda_xcal.php - [x] ./admin/fichinter.php - [ ] ./admin/index.php - [x] ./admin/limits.php - [x] ./admin/ldap_contacts.php - [ ] ./admin/website_options.php - [x] ./admin/ecm.php - [x] ./admin/accountant.php - [ ] ./admin/spip.php - [x] ./admin/mailman.php - [ ] ./admin/website.php - [x] ./admin/import.php - [ ] ./admin/openinghours.php - [ ] ./admin/triggers.php - [ ] ./admin/stock.php - [ ] ./admin/syslog.php - [ ] ./admin/order_extrafields.php - [x] ./admin/bom_extrafields.php - [ ] ./admin/oauthlogintokens.php - [ ] ./admin/mails_ticket.php - [x] ./admin/boxes.php - [x] ./admin/agenda_extrafields.php - [ ] ./admin/supplierorderdet_extrafields.php - [ ] ./admin/supplier_invoice.php - [x] ./admin/eventorganization.php - [ ] ./admin/mrp.php - [ ] ./admin/modulehelp.php - [ ] ./admin/taxes.php - [ ] ./admin/pdf_other.php - [ ] ./admin/security_file.php - [ ] ./admin/prelevement.php - [ ] ./admin/menus/index.php - [ ] ./admin/menus/edit.php - [x] ./admin/knowledgemanagement.php - [ ] ./admin/ticket.php - [x] ./admin/expensereport_ik.php - [ ] ./admin/commande_fournisseur_dispatch_extrafields.php - [ ] ./admin/security.php - [x] ./admin/loan.php - [ ] ./admin/proxy.php - [x] ./admin/hrm.php - [x] ./admin/accounting.php - [ ] ./admin/resource.php - [ ] ./admin/workflow.php - [ ] ./admin/mrp_extrafields.php - [ ] ./admin/perms.php - [x] ./admin/export.php - [x] ./admin/clicktodial.php - [x] ./admin/expensereport_extrafields.php - [x] ./admin/deliverydet_extrafields.php - [x] ./admin/dav.php - [ ] ./admin/notification.php - [ ] ./admin/translation.php - [x] ./admin/bom.php - [x] ./admin/emailcollector_list.php - [x] ./admin/knowledgerecord_extrafields.php - [x] ./admin/chequereceipts.php - [ ] ./admin/orderdet_extrafields.php - [x] ./admin/holiday.php - [x] ./admin/ldap_members_types.php - [x] ./admin/fckeditor.php - [ ] ./admin/ticket_public.php - [x] ./admin/expensereport_rules.php - [ ] ./admin/pdf.php - [ ] ./admin/receiptprinter.php - [ ] ./admin/webhook.php - [x] ./admin/mails_emailing.php - [x] ./admin/events.php - [ ] ./admin/mails_templates.php - [x] ./admin/company_socialnetworks.php - [x] ./admin/ldap_groups.php - [x] ./admin/ihm.php - [x] ./admin/compta.php - [x] ./admin/agenda_reminder.php - [ ] **Admin ecm** - [ ] ./ecm/file_note.php - [ ] ./ecm/file_card.php - [ ] ./ecm/index.php - [ ] ./ecm/search.php - [ ] ./ecm/index_auto.php - [ ] ./ecm/index_medias.php - [ ] ./ecm/dir_add_card.php - [ ] ./ecm/dir_card.php",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"[UI/UX] Update body class to all pages  Feature Request Here is a summary of the actions to be taken on Dolibarr pages following the ui/ux round table at the Dolibarr winter 2023 dev camp. To help css integrator to easily target elements according to page context. Note : css class name use bem write style  Use case _No response_  Suggested implementation For all page add css classes to body 1. To describe curent module use the prefix **mod-** followed by the module name ex : **mod-**_modulename_ 2. To describe curent page type use the prefix **page-** followed by the page type: **page-**list list of page type : page-list, page-card, page-dashboard, page-stats, page-admin, page-card_documents , page-card_notes, page-card_agenda 3. Differentiate between edit, create, and delete at file level by using css class. To describe curent page action use the prefix **action-** followed by the curent action. limit class to **action-create, action-delete, action-update** Action-view isn't present because irrelevant view is default action  Suggested steps for 3 - [ ] add behavior to llxHeader  Suggested steps for 1 & 2 - [x] **Module Holiday** #30375 - [x] ./holiday/card.php - [x] ./holiday/card_group.php - [x] ./holiday/define_holiday.php - [x] ./holiday/document.php - [x] ./holiday/info.php - [x] ./holiday/list.php - [x] ./holiday/month_report.php - [x] ./holiday/view_log.php - [x] **Module loan** #30370 - [x] ./loan/card.php #30370 - [x] ./loan/document.php #30370 - [x] ./loan/info.php #30370 - [x] ./loan/list.php #30370 - [x] ./loan/note.php #30370 - [x] ./loan/payment/card.php #30370 - [x] ./loan/payment/payment.php #30370 - [x] ./loan/schedule.php #30370 - [ ] **Module asset** - [x] ./asset/accountancy_codes.php #27152 - [ ] ./asset/admin/asset_extrafields.php - [ ] ./asset/admin/assetmodel_extrafields.php - [ ] ./asset/admin/setup.php - [x] ./asset/agenda.php #27152 - [x] ./asset/card.php #27152 - [x] ./asset/depreciation_options.php #27152 - [x] ./asset/depreciation.php #27152 - [x] ./asset/disposal.php #27152 - [x] ./asset/document.php #27152 - [x] ./asset/list.php #27152 - [x] ./asset/model/accountancy_codes.php #27152 - [x] ./asset/model/agenda.php #27152 - [x] ./asset/model/card.php #27152 - [x] ./asset/model/depreciation_options.php #27152 - [x] ./asset/model/list.php #27152 - [x] ./asset/model/note.php #27152 - [x] ./asset/note.php #27152 - [ ] **Module barcode** - [ ] ./barcode/codeinit.php - [ ] ./barcode/printsheet.php - [ ] ./blockedlog/admin/blockedlog_list.php - [ ] ./blockedlog/admin/blockedlog.php - [ ] **Module command** - [x] ./commande/agenda.php #27144 - [x] ./commande/card.php #27144 - [x] ./commande/contact.php #27144 - [ ] ./commande/customer.php - [x] ./commande/document.php #27144 - [ ] ./commande/index.php - [ ] ./commande/list_det.php - [ ] ./commande/list_det.php - [x] ./commande/list.php #27144 - [x] ./commande/note.php #27144 - [x] ./commande/stats/index.php #27144 - [ ] ./delivery/card.php - [x] **Module don** #27153 - [x] ./don/admin/donation_extrafields.php #27153 - [x] ./don/admin/donation.php #27153 - [x] ./don/card.php #27153 - [x] ./don/document.php #27153 - [x] ./don/index.php #27153 - [x] ./don/info.php #27153 - [x] ./don/list.php #27153 - [x] ./don/note.php #27153 - [x] ./don/payment/card.php #27153 - [x] ./don/payment/payment.php #27153 - [x] ./don/stats/index.php #27153 - [ ] **Module export** - [ ] ./exports/export.php - [ ] ./exports/index.php - [ ] **Module knowledgemanagement** - [ ] ./knowledgemanagement/knowledgemanagementindex.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_agenda.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_card.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_contact.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_document.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_list.php #29867 - [ ] ./knowledgemanagement/knowledgerecord_note.php #29867 - [x] **Module partnership** #29875 - [x] ./partnership/admin/partnership_extrafields.php #29875 - [x] ./partnership/admin/setup.php #29875 - [x] ./partnership/admin/website.php #29875 - [x] ./partnership/partnership_agenda.php #29875 - [x] ./partnership/partnership_card.php #29875 - [x] ./partnership/partnership_contact.php #29875 - [x] ./partnership/partnership_document.php #29875 - [x] ./partnership/partnership_list.php #29875 - [x] ./partnership/partnership_note.php #29875 - [ ] **./paypal/admin/paypal.php** - [ ] **Module product** - [x] ./product/admin/dynamic_prices.php - [x] ./product/admin/inventory_extrafields.php - [x] ./product/admin/price_rules.php - [x] ./product/admin/product_extrafields.php - [x] ./product/admin/product_lot_extrafields.php - [x] ./product/admin/product_lot.php - [x] ./product/admin/product_supplier_extrafields.php - [x] ./product/admin/product_tools.php - [x] ./product/admin/product.php - [x] ./product/admin/stock_extrafields.php - [x] ./product/admin/stock_mouvement_extrafields.php - [x] ./product/agenda.php - [x] ./product/card.php - [x] ./product/composition/card.php - [x] ./product/document.php - [x] ./product/dynamic_price/editor.php - [ ] ./product/fournisseurs.php - [ ] ./product/index.php - [x] ./product/inventory/card.php - [x] ./product/inventory/inventory.php - [ ] ./product/inventory/list.php - [ ] ./product/list.php - [ ] ./product/list.php - [ ] ./product/note.php - [ ] ./product/popuprop.php - [ ] ./product/price.php - [ ] ./product/reassort.php - [ ] ./product/reassortlot.php - [ ] ./product/stats/bom.php - [x] ./product/stats/card.php #29894 - [x] ./product/stats/card.php #29894 - [x] ./product/stats/commande_fournisseur.php #29894 - [x] ./product/stats/commande.php #29894 - [x] ./product/stats/contrat.php #29894 - [x] ./product/stats/facture_fournisseur.php #29894 - [x] ./product/stats/facture.php #29894 - [x] ./product/stats/facturerec.php #29894 - [x] ./product/stats/mo.php #29894 - [x] ./product/stats/propal.php #29894 - [x] ./product/stats/supplier_proposal.php #29894 - [ ] ./product/stock/card.php - [x] ./product/stock/fiche-valo.php #29894 - [x] ./product/stock/index.php #29894 - [x] ./product/stock/info.php #29894 - [x] ./product/stock/list.php #29894 - [x] ./product/stock/massstockmove.php #29894 - [x] ./product/stock/movement_card.php #29894 - [x] ./product/stock/movement_list.php #29894 - [x] ./product/stock/product.php #29894 - [x] ./product/stock/productlot_card.php #29894 - [x] ./product/stock/productlot_document.php #29894 - [x] ./product/stock/productlot_list.php #29894 - [x] ./product/stock/productlot_note.php #29894 - [x] ./product/stock/replenish.php #29894 - [x] ./product/stock/replenishorders.php #29894 - [x] ./product/stock/stats/commande_fournisseur.php - [x] ./product/stock/stats/expedition.php - [ ] ./product/stock/stats/mo.php - [x] ./product/stock/stats/reception.php #29894 - [x] ./product/stock/stockatdate.php #29894 - [x] ./product/stock/stocktransfer/stocktransfer_agenda.php - [x] ./product/stock/stocktransfer/stocktransfer_card.php - [ ] ./product/stock/stocktransfer/stocktransfer_contact.php - [x] ./product/stock/stocktransfer/stocktransfer_document.php - [x] ./product/stock/stocktransfer/stocktransfer_list.php - [x] ./product/stock/stocktransfer/stocktransfer_note.php - [x] ./product/stock/valo.php #29894 - [ ] ./product/traduction.php - [ ] **Module resource** - [ ] ./resource/agenda.php - [ ] ./resource/card.php - [ ] ./resource/contact.php - [ ] ./resource/document.php - [ ] ./resource/element_resource.php - [ ] ./resource/list.php - [ ] ./resource/note.php - [ ] **Module supplier_proposal** - [ ] ./supplier_proposal/admin/supplier_proposal_extrafields.php - [ ] ./supplier_proposal/admin/supplier_proposaldet_extrafields.php - [ ] ./supplier_proposal/card.php - [ ] ./supplier_proposal/contact.php - [ ] ./supplier_proposal/document.php - [ ] ./supplier_proposal/index.php - [ ] ./supplier_proposal/info.php - [ ] ./supplier_proposal/list.php - [ ] ./supplier_proposal/note.php - [ ] **Module takepos** - [ ] ./takepos/admin/appearance.php - [ ] ./takepos/admin/bar.php - [ ] ./takepos/admin/orderprinters.php - [ ] ./takepos/admin/other.php - [ ] ./takepos/admin/receipt.php - [ ] ./takepos/admin/setup.php - [ ] ./takepos/admin/terminal.php - [ ] ./takepos/invoice.php - [ ] ./takepos/phone.php - [ ] **Module ticket** - [ ] ./ticket/agenda.php - [ ] ./ticket/card.php - [ ] ./ticket/contact.php - [ ] ./ticket/document.php - [ ] ./ticket/index.php - [ ] ./ticket/list.php - [ ] ./ticket/messaging.php - [ ] ./ticket/stats/index.php - [ ] **Module user** - [x] ./user/admin/group_extrafields.php - [x] ./user/admin/user_extrafields.php - [x] ./user/agenda_extsites.php - [x] ./user/bank.php - [x] ./user/card.php - [x] ./user/clicktodial.php - [x] ./user/document.php - [x] ./user/group/card.php - [x] ./user/group/ldap.php - [x] ./user/group/list.php - [x] ./user/group/perms.php - [x] ./user/hierarchy.php - [x] ./user/home.php - [ ] ./user/info.php - [x] ./user/ldap.php - [x] ./user/list.php - [x] ./user/note.php - [x] ./user/notify/card.php - [x] ./user/param_ihm.php - [x] ./user/perms.php - [x] ./user/virtualcard.php - [ ] **Module webhook** - [ ] ./webhook/target_card.php - [ ] ./webhook/target_list.php - [ ] ./webhook/webhookindex.php - [ ] **Module website** - [ ] ./website/index.php - [ ] ./website/websiteaccount_card.php - [ ] **Module workstation** - [ ] ./workstation/workstation_agenda.php - [ ] ./workstation/workstation_card.php - [ ] ./workstation/workstation_document.php - [ ] ./workstation/workstation_list.php - [ ] ./workstation/workstation_note.php - [ ] ./categories/traduction.php - [ ] ./index.php - [ ] **Module fichinter** - [ ] ./fichinter/contact.php - [ ] ./fichinter/index.php - [ ] ./fichinter/card-rec.php - [ ] ./fichinter/note.php - [ ] ./fichinter/document.php - [ ] ./fichinter/stats/index.php - [ ] ./fichinter/admin/fichinterdet_extrafields.php - [ ] ./fichinter/admin/fichinter_extrafields.php - [ ] ./fichinter/agenda.php - [ ] ./fichinter/list.php - [ ] ./fichinter/card.php - [x] **Module fourn_commande** - [x] ./fourn/commande/info.php #27381 - [x] ./fourn/commande/contact.php #27381 - [x] ./fourn/commande/index.php #27381 - [x] ./fourn/commande/note.php #27381 - [x] ./fourn/commande/document.php #27381 - [x] ./fourn/commande/dispatch.php #27381 - [x] ./fourn/commande/list.php #27381 - [x] ./fourn/commande/card.php #27381 - [ ] **Module fourn_product** - [ ] ./fourn/product/list.php - [ ] **Module fourn_facture** - [ ] ./fourn/facture/info.php - [ ] ./fourn/facture/contact.php - [ ] ./fourn/facture/index.php - [ ] ./fourn/facture/rapport.php - [ ] ./fourn/facture/card-rec.php - [ ] ./fourn/facture/note.php - [ ] ./fourn/facture/document.php - [ ] ./fourn/facture/list-rec.php - [ ] ./fourn/facture/list.php - [ ] ./fourn/facture/card.php - [ ] ./fourn/facture/paiement.php - [ ] ./fourn/card.php - [ ] ./fourn/recap-fourn.php - [x] **Module accountancy** - [x] ./accountancy/customer/lines.php - [x] ./accountancy/supplier/index.php - [x] ./accountancy/supplier/list.php - [x] ./accountancy/supplier/card.php - [x] ./accountancy/supplier/lines.php - [x] ./accountancy/expensereport/index.php - [x] ./accountancy/expensereport/list.php - [x] ./accountancy/expensereport/card.php - [x] ./accountancy/expensereport/lines.php - [x] accountancy/journal/bankjournal.php #30026 - [x] accountancy/journal/expensereportsjournal.php #30026 - [x] accountancy/journal/purchasesjournal.php #30026 - [x] accountancy/journal/sellsjournal.php #30026 - [x] accountancy/journal/variousjournal.php #30026 - [x] bookkeeping/balance.php #30028 - [x] accountancy/bookkeeping/card.php #30028 - [x] accountancy/bookkeeping/export.php #30028 - [x] accountancy/bookkeeping/list.php #30028 - [x] accountancy/bookkeeping/listbyaccount.php #30028 - [ ] **Module margin** - [ ] ./margin/tabs/thirdpartyMargins.php - [ ] ./margin/tabs/productMargins.php - [ ] ./margin/agentMargins.php - [ ] ./margin/checkMargins.php - [ ] ./margin/admin/margin.php - [ ] ./margin/customerMargins.php - [ ] ./margin/productMargins.php - [x] **Module projet** - [x] ./projet/element.php #30357 - [x] ./projet/activity/perday.php #30357 - [x] ./projet/activity/perweek.php #30357 - [x] ./projet/activity/permonth.php #30357 - [x] ./projet/index.php #30357 - [x] ./projet/note.php #30357 - [ ] ./projet/document.php - [x] ./projet/stats/index.php #30357 - [ ] ./projet/admin/project_extrafields.php - [x] ./projet/admin/website.php #30357 - [x] ./projet/admin/project_task_extrafields.php #30357 - [x] ./projet/admin/project.php #30357 - [x] ./projet/tasks/task.php - [x] ./projet/tasks/contact.php #30357 - [x] ./projet/tasks/note.php - [x] ./projet/tasks/document.php - [x] ./projet/tasks/time.php - [x] ./projet/tasks/stats/index.php - [x] ./projet/tasks/list.php - [x] ./projet/tasks/comment.php #30357 - [x] ./projet/ganttview.php #30357 - [x] ./projet/agenda.php #30357 - [x] ./projet/list.php #30357 - [x] ./projet/card.php #30357 - [x] ./projet/tasks.php #30357 - [x] ./projet/comment.php #30357 - [x] ./projet/admin/project_extrafields.php #30357 - [x] ./projet/contact.php #30357 - [x] ./projet/document.php #30357 - [x] ./projet/messaging.php #30357 - [ ] **Module expedition** - [ ] ./expedition/contact.php - [ ] ./expedition/index.php - [ ] ./expedition/note.php - [ ] ./expedition/document.php - [ ] ./expedition/stats/month.php - [ ] ./expedition/stats/index.php - [ ] ./expedition/dispatch.php - [ ] ./expedition/list.php - [ ] ./expedition/card.php - [ ] ./expedition/shipment.php - [ ] **Module modulebuilder** ** BE CARFULL OF MODULE TEMPLATE** - [ ] ./modulebuilder/index.php - [ ] ./modulebuilder/admin/setup.php - [x] ./modulebuilder/template/myobject_agenda.php #27146 - [x] ./modulebuilder/template/myobject_list.php #27146 - [x] ./modulebuilder/template/myobject_note.php #27146 - [x] ./modulebuilder/template/mymoduleindex.php #27146 - [x] ./modulebuilder/template/myobject_card.php #27146 - [x] ./modulebuilder/template/admin/about.php #27146 - [x] ./modulebuilder/template/admin/myobject_extrafields.php #27146 - [x] ./modulebuilder/template/admin/setup.php #27146 - [x] ./modulebuilder/template/myobject_document.php #27146 - [x] ./modulebuilder/template/myobject_contact.php #27146 - [ ] **Module zapier** - [ ] ./zapier/admin/about.php - [ ] ./zapier/admin/setup.php - [ ] **Module externalsite** - [ ] ./externalsite/frames.php - [ ] ./externalsite/frames.php - [ ] ./externalsite/frames.php - [x] ./externalsite/admin/index.php - [ ] ./collab/index.php - [ ] **Module bookcal** - [ ] ./bookcal/availabilities_document.php - [ ] ./bookcal/availabilities_agenda.php - [ ] ./bookcal/availabilities_list.php - [ ] ./bookcal/availabilities_note.php - [ ] ./bookcal/admin/setup.php - [ ] ./bookcal/admin/booking_extrafields.php - [ ] ./bookcal/admin/availabilities_extrafields.php - [ ] ./bookcal/booking_list.php - [ ] ./bookcal/booking_card.php - [ ] ./bookcal/availabilities_contact.php - [ ] ./bookcal/bookcalindex.php - [ ] ./bookcal/booking_agenda.php - [ ] ./bookcal/booking_document.php - [ ] ./bookcal/booking_note.php - [ ] ./bookcal/availabilities_card.php - [ ] ./bookcal/booking_contact.php - [ ] **Module bom** - [x] ./bom/bom_agenda.php - [x] ./bom/bom_note.php - [x] ./bom/bom_card.php - [x] ./bom/bom_document.php - [ ] ./bom/bom_list.php - [x] ./bom/bom_net_needs.php - [ ] **Module intracommreport** - [ ] ./intracommreport/admin/intracommreport.php - [ ] ./intracommreport/list.php - [ ] ./intracommreport/card.php - [ ] **Module asterisk** - [ ] ./asterisk/wrapper.php - [ ] ./asterisk/wrapper.php - [ ] **Module reception** - [ ] ./reception/contact.php - [ ] ./reception/index.php - [ ] ./reception/note.php - [ ] ./reception/document.php - [ ] ./reception/stats/month.php - [ ] ./reception/stats/index.php - [ ] ./reception/dispatch.php - [ ] ./reception/list.php - [ ] ./reception/card.php - [ ] **Module bookmarks** - [ ] ./bookmarks/admin/bookmark.php - [ ] ./bookmarks/list.php - [ ] ./bookmarks/card.php - [ ] **Module printing** - [ ] ./printing/index.php - [ ] ./printing/admin/printing.php - [ ] **Module mrp** #30373 - [x] ./mrp/mo_note.php - [x] ./mrp/index.php - [x] ./mrp/mo_card.php - [x] ./mrp/mo_movements.php - [x] ./mrp/mo_agenda.php - [x] ./mrp/mo_production.php - [x] ./mrp/mo_list.php - [x] ./mrp/mo_document.php - [ ] **Admin pages** - [ ] ./admin/supplier_order.php - [ ] ./admin/stocktransfer.php - [ ] ./admin/modules.php - [x] ./admin/dict.php - [x] ./admin/debugbar.php - [x] ./admin/ecm_files_extrafields.php - [ ] ./admin/commande.php - [ ] ./admin/user.php - [x] ./admin/ecm_directories_extrafields.php - [x] ./admin/delivery.php - [x] ./admin/mailing.php - [ ] ./admin/multicurrency.php - [ ] ./admin/resource_extrafields.php - [x] ./admin/bank.php - [x] ./admin/mails_ingoing.php - [ ] ./admin/menus.php - [x] ./admin/bank_extrafields.php - [x] ./admin/bomline_extrafields.php - [ ] ./admin/facture_situation.php - [x] ./admin/agenda_xcal.php - [x] ./admin/fichinter.php - [ ] ./admin/index.php - [x] ./admin/limits.php - [x] ./admin/ldap_contacts.php - [ ] ./admin/website_options.php - [x] ./admin/ecm.php - [x] ./admin/accountant.php - [ ] ./admin/spip.php - [x] ./admin/mailman.php - [ ] ./admin/website.php - [x] ./admin/import.php - [ ] ./admin/openinghours.php - [ ] ./admin/triggers.php - [ ] ./admin/stock.php - [ ] ./admin/syslog.php - [ ] ./admin/order_extrafields.php - [x] ./admin/bom_extrafields.php - [ ] ./admin/oauthlogintokens.php - [ ] ./admin/mails_ticket.php - [x] ./admin/boxes.php - [x] ./admin/agenda_extrafields.php - [ ] ./admin/supplierorderdet_extrafields.php - [ ] ./admin/supplier_invoice.php - [x] ./admin/eventorganization.php - [ ] ./admin/mrp.php - [ ] ./admin/modulehelp.php - [ ] ./admin/taxes.php - [ ] ./admin/pdf_other.php - [ ] ./admin/security_file.php - [ ] ./admin/prelevement.php - [ ] ./admin/menus/index.php - [ ] ./admin/menus/edit.php - [x] ./admin/knowledgemanagement.php - [ ] ./admin/ticket.php - [x] ./admin/expensereport_ik.php - [ ] ./admin/commande_fournisseur_dispatch_extrafields.php - [ ] ./admin/security.php - [x] ./admin/loan.php - [ ] ./admin/proxy.php - [x] ./admin/hrm.php - [x] ./admin/accounting.php - [ ] ./admin/resource.php - [ ] ./admin/workflow.php - [ ] ./admin/mrp_extrafields.php - [ ] ./admin/perms.php - [x] ./admin/export.php - [x] ./admin/clicktodial.php - [x] ./admin/expensereport_extrafields.php - [x] ./admin/deliverydet_extrafields.php - [x] ./admin/dav.php - [ ] ./admin/notification.php - [ ] ./admin/translation.php - [x] ./admin/bom.php - [x] ./admin/emailcollector_list.php - [x] ./admin/knowledgerecord_extrafields.php - [x] ./admin/chequereceipts.php - [ ] ./admin/orderdet_extrafields.php - [x] ./admin/holiday.php - [x] ./admin/ldap_members_types.php - [x] ./admin/fckeditor.php - [ ] ./admin/ticket_public.php - [x] ./admin/expensereport_rules.php - [ ] ./admin/pdf.php - [ ] ./admin/receiptprinter.php - [ ] ./admin/webhook.php - [x] ./admin/mails_emailing.php - [x] ./admin/events.php - [ ] ./admin/mails_templates.php - [x] ./admin/company_socialnetworks.php - [x] ./admin/ldap_groups.php - [x] ./admin/ihm.php - [x] ./admin/compta.php - [x] ./admin/agenda_reminder.php - [ ] **Admin ecm** - [ ] ./ecm/file_note.php - [ ] ./ecm/file_card.php - [ ] ./ecm/index.php - [ ] ./ecm/search.php - [ ] ./ecm/index_auto.php - [ ] ./ecm/index_medias.php - [ ] ./ecm/dir_add_card.php - [ ] ./ecm/dir_card.php other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.95
25400,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25400,Fatal error while exporting Customer invoices and invoice details with excel2007," Bug When we export Customer invoices and invoice details a fatal error is triggered If we export Description of line with a line description starting with the char ""=""  Environment Version 12,13,14,15,16,17,18, develop  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4.3  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior - Create an invoice - Add a line with description starting with the character : = - Start exportation of Customer invoices and invoice details - Choose the field : Description of line - Step 5 -> choose doc template : Excel 2007 - Generate It creates a fatal error  Attached files _No response_",other-file,"Fatal error while exporting Customer invoices and invoice details with excel2007  Bug When we export Customer invoices and invoice details a fatal error is triggered If we export Description of line with a line description starting with the char ""=""  Environment Version 12,13,14,15,16,17,18, develop  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4.3  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior - Create an invoice - Add a line with description starting with the character : = - Start exportation of Customer invoices and invoice details - Choose the field : Description of line - Step 5 -> choose doc template : Excel 2007 - Generate It creates a fatal error  Attached files _No response_ other-file",no-bug,0.9
31989,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31989,Bug: Erreur affichage montant,"# Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug [*Short description*] In ""open commercial proposal"" when I point the mouse over the quote number, the details always appear with the same number ## Environment - **Version**: 20.0.2 - **OS**: Linux - **Web server**: Apache/2.4.54 (Unix) - **PHP**: fpm-fcgi 8.0.23 - **Database**: MySQL or MariaDB 10.3.32-MariaDB - **URL(s)**: /CRM/htdocs/comm/propal/index.php?leftmenu=propals ## Expected and actual behavior [*Verbose description*] ## Steps to reproduce the behavior [*Verbose description*] ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging information) [*Files*] ![Capture d'cran 2024-11-18 202444](https://github.com/user-attachments/assets/13ade645-cc9b-42c5-acd6-5598f613d9c7) ![Capture d'cran 2024-11-18 202744](https://github.com/user-attachments/assets/6bb90918-315d-4527-bd10-9f7734fdea5b) ## Report",other-file | other-file,"Bug: Erreur affichage montant # Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug [*Short description*] In ""open commercial proposal"" when I point the mouse over the quote number, the details always appear with the same number ## Environment - **Version**: 20.0.2 - **OS**: Linux - **Web server**: Apache/2.4.54 (Unix) - **PHP**: fpm-fcgi 8.0.23 - **Database**: MySQL or MariaDB 10.3.32-MariaDB - **URL(s)**: /CRM/htdocs/comm/propal/index.php?leftmenu=propals ## Expected and actual behavior [*Verbose description*] ## Steps to reproduce the behavior [*Verbose description*] ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging information) [*Files*] ![Capture d'cran 2024-11-18 202444](https://github.com/user-attachments/assets/13ade645-cc9b-42c5-acd6-5598f613d9c7) ![Capture d'cran 2024-11-18 202744](https://github.com/user-attachments/assets/6bb90918-315d-4527-bd10-9f7734fdea5b) ## Report other-file other-file",no-bug,0.9
30362,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30362,An user with user->rights->projet->lire can see task time from other user on all projects, Bug An user with `user->rights->projet->lire` can see task time from other user on all project just by clicking on the cross to clear filter on page `projet/tasks/time.php`  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Create a project 2. Create some tasks on this project 3. Add some time spent on those tasks 4. Create an external user 5. Add this User as contact of this project 6. Add only permission `user->rights->projet->lire` to this external user 7. Go to `projet/tasks/time.php` and clear filter by clicking on the cross  Attached files _No response_,other-file | other-file | other-file,An user with user->rights->projet->lire can see task time from other user on all projects  Bug An user with `user->rights->projet->lire` can see task time from other user on all project just by clicking on the cross to clear filter on page `projet/tasks/time.php`  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Create a project 2. Create some tasks on this project 3. Add some time spent on those tasks 4. Create an external user 5. Add this User as contact of this project 6. Add only permission `user->rights->projet->lire` to this external user 7. Go to `projet/tasks/time.php` and clear filter by clicking on the cross  Attached files _No response_ other-file other-file other-file,no-bug,0.9
29100,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29100,member type field too narrow," Bug Both when creating a new member and when editing an existing member the member type field is too narrow to really see the full contents, meaning if you have several member types and they only differ towards the end, then a quick glance can not tell you which type of membership is selected, you have to click on it and activate the dropdown menu.  Dolibarr Version 19.0.0 + 18.0.4  Environment PHP 8.2.7  Environment Database 11.3.2-MariaDB-1:11.3.2+maria~ubu2204  Steps to reproduce the behavior and expected behavior create 2 or more membership types with very similar length, but only the end characters differ create a member, notice have you have to click through to see which membership type is actually selected.  Attached files ![member_types](https://github.com/Dolibarr/dolibarr/assets/2551481/8b7ee1ff-dac8-452c-b61a-81556cfcb54a) ![member_create](https://github.com/Dolibarr/dolibarr/assets/2551481/4306392c-2a27-446a-be0c-d6516ddabe0a) ![member_type_field_narrow](https://github.com/Dolibarr/dolibarr/assets/2551481/6dd40821-775a-43e8-88a1-8447715566c3)",other-file,"member type field too narrow  Bug Both when creating a new member and when editing an existing member the member type field is too narrow to really see the full contents, meaning if you have several member types and they only differ towards the end, then a quick glance can not tell you which type of membership is selected, you have to click on it and activate the dropdown menu.  Dolibarr Version 19.0.0 + 18.0.4  Environment PHP 8.2.7  Environment Database 11.3.2-MariaDB-1:11.3.2+maria~ubu2204  Steps to reproduce the behavior and expected behavior create 2 or more membership types with very similar length, but only the end characters differ create a member, notice have you have to click through to see which membership type is actually selected.  Attached files ![member_types](https://github.com/Dolibarr/dolibarr/assets/2551481/8b7ee1ff-dac8-452c-b61a-81556cfcb54a) ![member_create](https://github.com/Dolibarr/dolibarr/assets/2551481/4306392c-2a27-446a-be0c-d6516ddabe0a) ![member_type_field_narrow](https://github.com/Dolibarr/dolibarr/assets/2551481/6dd40821-775a-43e8-88a1-8447715566c3) other-file",no-bug,0.95
24414,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24414,Incorrect value shown in search fields for extrafields of type select," Bug If an extrafield of type ""select"" is depending on another extrafield using this syntax `1, value1 | options_ parent_list_code : parent_key` the full parameter text is shown instead of just the value (eg VIE1|options_sto:1 instead of VIE1)  Environment Version 16.0.x  Environment OS na  Environment Web server na  Environment PHP na  Environment Database na  Environment URL(s) all list.php  Expected and actual behavior see bug description  Steps to reproduce the behavior 1. Create an extrafield of type select which is dependent on another list 2. Open the list view of this element 3. Enable the new extrafield in the list view 4. Click into the search field of this element  Attached files _No response_",other-file,"Incorrect value shown in search fields for extrafields of type select  Bug If an extrafield of type ""select"" is depending on another extrafield using this syntax `1, value1 | options_ parent_list_code : parent_key` the full parameter text is shown instead of just the value (eg VIE1|options_sto:1 instead of VIE1)  Environment Version 16.0.x  Environment OS na  Environment Web server na  Environment PHP na  Environment Database na  Environment URL(s) all list.php  Expected and actual behavior see bug description  Steps to reproduce the behavior 1. Create an extrafield of type select which is dependent on another list 2. Open the list view of this element 3. Enable the new extrafield in the list view 4. Click into the search field of this element  Attached files _No response_ other-file",no-bug,0.9
28976,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28976,What's the fuck with Takepos ?," Bug with dolibarr 18 (or before ?) when i enabled takepos and access just one time in pos, logout, and after login again, i am redirect in pos ! i deleted cookies, but same problem  Where is the problem please ! :-) thanks ! https://github.com/Dolibarr/dolibarr/assets/454387/87c38822-c2f4-4355-9ca8-afc8f222dbf4  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file,"What's the fuck with Takepos ?  Bug with dolibarr 18 (or before ?) when i enabled takepos and access just one time in pos, logout, and after login again, i am redirect in pos ! i deleted cookies, but same problem  Where is the problem please ! :-) thanks ! https://github.com/Dolibarr/dolibarr/assets/454387/87c38822-c2f4-4355-9ca8-afc8f222dbf4  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file",no-bug,0.8
32736,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32736,Filter problems per user on the page /compta/sociales/list.php," Bug In the htdocs/compta/sociales/list.php page, if filter per user i have a blank page I had to change $ Search_users = getpost ('Search_users', 'Intcomma'); to $search_users = GETPOST('search_users', 'array:int'); then it works I don't know if the problem is only with php 8.3 not supported  Dolibarr Version 20.0.3  Environment PHP 8.3.15  Environment Database mariadb  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"Filter problems per user on the page /compta/sociales/list.php  Bug In the htdocs/compta/sociales/list.php page, if filter per user i have a blank page I had to change $ Search_users = getpost ('Search_users', 'Intcomma'); to $search_users = GETPOST('search_users', 'array:int'); then it works I don't know if the problem is only with php 8.3 not supported  Dolibarr Version 20.0.3  Environment PHP 8.3.15  Environment Database mariadb  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.7
29887,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29887,Bug on preview translation, Bug ![image](https://github.com/Dolibarr/dolibarr/assets/158461084/29876e92-d14a-445e-8588-8cd167a75df5)  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file,Bug on preview translation  Bug ![image](https://github.com/Dolibarr/dolibarr/assets/158461084/29876e92-d14a-445e-8588-8cd167a75df5)  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.8
32193,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32193,Stored CSRF via Uploaded HTML File in User Account Document Section," Bug The application allows normal users (e.g.,test.test) to upload files in their user account under the /user/document.php path. However, there are no restrictions preventing the upload of .html files, which can contain CSRF payloads. When an admin user later inspects the user's account, downloads, and opens the file in their browser, the CSRF payload automatically logs them out. This vulnerability exposes administrators to potential session disruption and indicates a lack of filtering for potentially executable file uploads.  Dolibarr Version Dolibarr 21.0.0-alpha  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior - **Log in as an admin** user and create a new user account (test.test) with permissions to modify their data. - **Log in as test.test** and navigate to card option then open linked files https://preview2.dolibarr.org/user/document.php?userid=<user_id> - **Upload a crafted .html file** containing the logout CSRF payload. - **Log back in as the admin** user and open the user list. - **Inspect the test.test user account**. You will see a notification or link indicating that a file has been uploaded by the user. - **To check the uploaded file by user, click on the file,** it will be downloaded automatically. - **Open the downloaded file in a browser** to check its contents. Observe that the CSRF payload automatically logs out the admin. - **Expected Result** - The application should restrict uploads of potentially dangerous files (like .html) to prevent CSRF attacks and ensure that uploaded files cannot execute scripts that impact admin sessions. - **Actual Result** - The application allows the upload of .html files, which can contain executable scripts. When viewed or downloaded by an admin, these scripts execute in the admins session, logging them out or performing other actions via CSRF.  Attached files https://github.com/user-attachments/assets/c7278ded-f65b-4644-b63f-26b2a5357dc7",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Stored CSRF via Uploaded HTML File in User Account Document Section  Bug The application allows normal users (e.g.,test.test) to upload files in their user account under the /user/document.php path. However, there are no restrictions preventing the upload of .html files, which can contain CSRF payloads. When an admin user later inspects the user's account, downloads, and opens the file in their browser, the CSRF payload automatically logs them out. This vulnerability exposes administrators to potential session disruption and indicates a lack of filtering for potentially executable file uploads.  Dolibarr Version Dolibarr 21.0.0-alpha  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior - **Log in as an admin** user and create a new user account (test.test) with permissions to modify their data. - **Log in as test.test** and navigate to card option then open linked files https://preview2.dolibarr.org/user/document.php?userid=<user_id> - **Upload a crafted .html file** containing the logout CSRF payload. - **Log back in as the admin** user and open the user list. - **Inspect the test.test user account**. You will see a notification or link indicating that a file has been uploaded by the user. - **To check the uploaded file by user, click on the file,** it will be downloaded automatically. - **Open the downloaded file in a browser** to check its contents. Observe that the CSRF payload automatically logs out the admin. - **Expected Result** - The application should restrict uploads of potentially dangerous files (like .html) to prevent CSRF attacks and ensure that uploaded files cannot execute scripts that impact admin sessions. - **Actual Result** - The application allows the upload of .html files, which can contain executable scripts. When viewed or downloaded by an admin, these scripts execute in the admins session, logging them out or performing other actions via CSRF.  Attached files https://github.com/user-attachments/assets/c7278ded-f65b-4644-b63f-26b2a5357dc7 other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
31486,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31486,Creating a service via a BOM send us to the product creation page," Bug On the BOM page, in the BOM's services table, the ""+"" button sends us to the same link as the BOM's product ""+"" button. It's just missing the `leftmenu=service&type=1` to the url params. I guess it's those lines https://github.com/Dolibarr/dolibarr/blob/a185fb4296717deb8d10e86f97acb78542692177/htdocs/bom/tpl/objectline_create.tpl.php#L145-L146  Dolibarr Version 20.0.1  Environment PHP 8.2.7  Environment Database mariaDB 11.5.2  Steps to reproduce the behavior and expected behavior - Create a BOM - Create a service from the BOM's page  Attached files _No response_",other-file | other-file,"Creating a service via a BOM send us to the product creation page  Bug On the BOM page, in the BOM's services table, the ""+"" button sends us to the same link as the BOM's product ""+"" button. It's just missing the `leftmenu=service&type=1` to the url params. I guess it's those lines https://github.com/Dolibarr/dolibarr/blob/a185fb4296717deb8d10e86f97acb78542692177/htdocs/bom/tpl/objectline_create.tpl.php#L145-L146  Dolibarr Version 20.0.1  Environment PHP 8.2.7  Environment Database mariaDB 11.5.2  Steps to reproduce the behavior and expected behavior - Create a BOM - Create a service from the BOM's page  Attached files _No response_ other-file other-file",no-bug,0.8
24710,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24710,Special Characters button in CKEditor is missing in v17," Bug After updating to V17, the special characters button disappeared from ckeditor. We use that button to insert characters that are not easily found in the standard Spanish keyboard, such as the multiplication symbol  I saw that the button was removed by this commit https://github.com/Dolibarr/dolibarr/commit/9f0eaf58a9c88fb956064c1f38ae7330324b9d24 Please restore the button, or allow enabling it in some way (maybe through setup other?)  Environment Version 17.0.1  Environment OS Linux webm074.cluster003.gra.hosting.ovh.net 5.15.80-ovh-vps-grsec-zfs-classid  Environment Web server Apache (from OVH shared hosting, no idea on the version)  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 5.7.42-log  Environment URL(s) _No response_  Expected and actual behavior Special chars button should appear in the WYSIWYG editor (CKEditor)  Steps to reproduce the behavior Install or update Dolibarr to V17+  Attached files _No response_",other-file | other-file | source-file | source-file | other-file | other-file | source-file | source-file,"Special Characters button in CKEditor is missing in v17  Bug After updating to V17, the special characters button disappeared from ckeditor. We use that button to insert characters that are not easily found in the standard Spanish keyboard, such as the multiplication symbol  I saw that the button was removed by this commit https://github.com/Dolibarr/dolibarr/commit/9f0eaf58a9c88fb956064c1f38ae7330324b9d24 Please restore the button, or allow enabling it in some way (maybe through setup other?)  Environment Version 17.0.1  Environment OS Linux webm074.cluster003.gra.hosting.ovh.net 5.15.80-ovh-vps-grsec-zfs-classid  Environment Web server Apache (from OVH shared hosting, no idea on the version)  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 5.7.42-log  Environment URL(s) _No response_  Expected and actual behavior Special chars button should appear in the WYSIWYG editor (CKEditor)  Steps to reproduce the behavior Install or update Dolibarr to V17+  Attached files _No response_ other-file other-file source-file source-file other-file other-file source-file source-file",no-bug,0.9
24154,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24154,Entrept - Description adds linebreak at every Save," Bug At Save, a <br/> tag is added to every line in the Description field in Entrept  Environment Version 16.0.3  Environment OS Debian Linux 11  Environment Web server Apache  Environment PHP 7.4  Environment Database Maria DB  Environment URL(s) /htdocs/product/stock/card.php  Expected and actual behavior At Save, no html linebreak tags `<br/>` should be added, but they are added for every line at Save.  Steps to reproduce the behavior Create an Entrept and write 2 or more lines in the Description field. Save and you will notice that an <br/> tag is added for every line. Open and save again, and one again a <br/> tag is added for every line. This happends every time the Entrept card is opend and svaved This is what Source looks like before Save  Contact:&nbsp;Mr.XXX- Phone-No.: +49 9999999<br /> The best references for our colleagues in the warehouse are the order confirmation numbers.  This is what it looks like after 1 Save  Contact:&nbsp;Mr.XXX- Phone-No.: +49 9999999<br /> <br /> The best references for our colleagues in the warehouse are the order confirmation numbers.  And this is what it looks like after 2 Saves  Contact:&nbsp;Mr.XXX- Phone-No.: +49 9999999<br /> <br /> <br /> <br /> The best references for our colleagues in the warehouse are the order confirmation numbers.  And so on   Attached files _No response_",other-file | other-file,"Entrept - Description adds linebreak at every Save  Bug At Save, a <br/> tag is added to every line in the Description field in Entrept  Environment Version 16.0.3  Environment OS Debian Linux 11  Environment Web server Apache  Environment PHP 7.4  Environment Database Maria DB  Environment URL(s) /htdocs/product/stock/card.php  Expected and actual behavior At Save, no html linebreak tags `<br/>` should be added, but they are added for every line at Save.  Steps to reproduce the behavior Create an Entrept and write 2 or more lines in the Description field. Save and you will notice that an <br/> tag is added for every line. Open and save again, and one again a <br/> tag is added for every line. This happends every time the Entrept card is opend and svaved This is what Source looks like before Save  Contact:&nbsp;Mr.XXX- Phone-No.: +49 9999999<br /> The best references for our colleagues in the warehouse are the order confirmation numbers.  This is what it looks like after 1 Save  Contact:&nbsp;Mr.XXX- Phone-No.: +49 9999999<br /> <br /> The best references for our colleagues in the warehouse are the order confirmation numbers.  And this is what it looks like after 2 Saves  Contact:&nbsp;Mr.XXX- Phone-No.: +49 9999999<br /> <br /> <br /> <br /> The best references for our colleagues in the warehouse are the order confirmation numbers.  And so on   Attached files _No response_ other-file other-file",no-bug,0.9
25260,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25260,Setup of tax module not stored correctly," Bug Under /htdocs/admin/taxes.php it can be defined, when the VAT is due (on invoice date or on payment date). This setting does not get stored properly.  Environment Version v18-beta",other-file | other-file | other-file,"Setup of tax module not stored correctly  Bug Under /htdocs/admin/taxes.php it can be defined, when the VAT is due (on invoice date or on payment date). This setting does not get stored properly.  Environment Version v18-beta other-file other-file other-file",no-bug,0.9
27173,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27173,Blank page when creating event (action) with a missing required extra field," Bug If one adds a required extra field to events, then tries to create an event forgetting this field, instead of seeing the pre-filled form they get a blank page.  Environment Version 17.0.2, 17.0.3 probably all above  Environment OS Debian 11  Environment Web server Apache/2.4.56 (Debian)  Environment PHP 7.4.33  Environment Database 11.1.2-MariaDB  Environment URL(s) comm/action/card.php  Expected and actual behavior ## Expected I should see the erroneous form so I can easily complete and resubmit it ## Actual Blank page with an error message alerting me about the missing field  Steps to reproduce the behavior 1. Add a required extra field to events 2. Create an event omitting to complete this field 3. Blank page  Attached files The following patch fixes the issue (PR will follow) patch diff --git a/htdocs/comm/action/card.php b/htdocs/comm/action/card.php index dab70304d08..7eb5b68db9a 100644  a/htdocs/comm/action/card.php  b/htdocs/comm/action/card.php @@ -419,7 +419,8 @@ if (empty($reshook) && $action == 'add') { // Fill array 'array_options' with data from add form $ret = $extrafields->setOptionalsFromPost(null, $object); if ($ret < 0) { - $error++; + $error++;$donotclearsession = 1; + $action = 'create'; } ",other-file,"Blank page when creating event (action) with a missing required extra field  Bug If one adds a required extra field to events, then tries to create an event forgetting this field, instead of seeing the pre-filled form they get a blank page.  Environment Version 17.0.2, 17.0.3 probably all above  Environment OS Debian 11  Environment Web server Apache/2.4.56 (Debian)  Environment PHP 7.4.33  Environment Database 11.1.2-MariaDB  Environment URL(s) comm/action/card.php  Expected and actual behavior ## Expected I should see the erroneous form so I can easily complete and resubmit it ## Actual Blank page with an error message alerting me about the missing field  Steps to reproduce the behavior 1. Add a required extra field to events 2. Create an event omitting to complete this field 3. Blank page  Attached files The following patch fixes the issue (PR will follow) patch diff --git a/htdocs/comm/action/card.php b/htdocs/comm/action/card.php index dab70304d08..7eb5b68db9a 100644  a/htdocs/comm/action/card.php  b/htdocs/comm/action/card.php @@ -419,7 +419,8 @@ if (empty($reshook) && $action == 'add') { // Fill array 'array_options' with data from add form $ret = $extrafields->setOptionalsFromPost(null, $object); if ($ret < 0) { - $error++; + $error++;$donotclearsession = 1; + $action = 'create'; }  other-file",bug,0.9
31816,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31816,Impossible to complete installation on develop," Bug The step 5 of the installation is blocked : Fatal error: Uncaught TypeError: Cronjob::create(): Argument #1 ($user) must be of type User, int given, called in /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/modules/DolibarrModules.class.php on line 1701 and defined in /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/cron/class/cronjob.class.php:235 Stack trace: #0 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/modules/DolibarrModules.class.php(1701): Cronjob->create(1) #1 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/modules/DolibarrModules.class.php(570): DolibarrModules->insert_cronjobs() #2 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/modules/modAgenda.class.php(615): DolibarrModules->_init(Array, '') #3 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/lib/admin.lib.php(1228): modAgenda->init() #4 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/install/step5.php(360): activateModule('modAgenda', 1) #5 {main} thrown in /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/cron/class/cronjob.class.php on line 235 Impossible to finalise installation  Dolibarr Version develop  Environment PHP 8.2  Environment Database Mysql version 5.7.39  Steps to reproduce the behavior and expected behavior Install a develop dolibarr  Attached files _No response_",other-file | other-file | other-file | other-file,"Impossible to complete installation on develop  Bug The step 5 of the installation is blocked : Fatal error: Uncaught TypeError: Cronjob::create(): Argument #1 ($user) must be of type User, int given, called in /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/modules/DolibarrModules.class.php on line 1701 and defined in /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/cron/class/cronjob.class.php:235 Stack trace: #0 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/modules/DolibarrModules.class.php(1701): Cronjob->create(1) #1 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/modules/DolibarrModules.class.php(570): DolibarrModules->insert_cronjobs() #2 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/modules/modAgenda.class.php(615): DolibarrModules->_init(Array, '') #3 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/core/lib/admin.lib.php(1228): modAgenda->init() #4 /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/install/step5.php(360): activateModule('modAgenda', 1) #5 {main} thrown in /Users/pragma-tech/Documents/000000 DEV/DEVELOP/dolibarr/htdocs/cron/class/cronjob.class.php on line 235 Impossible to finalise installation  Dolibarr Version develop  Environment PHP 8.2  Environment Database Mysql version 5.7.39  Steps to reproduce the behavior and expected behavior Install a develop dolibarr  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
27262,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27262,Object of class User could not be converted to string in /htdocs/fourn/class/fournisseur.facture-rec.class.php," Bug While generating recurrent invoice in Dolibarr 18.0.4 AH01071: Got error 'PHP message: PHP Fatal error: Uncaught Error: Object of class User could not be converted to string in /htdocs/fourn/class/fournisseur.facture-rec.class.php:1330 Stack trace: #0 /htdocs/cron/class/cronjob.class.php(1290): FactureFournisseurRec->createRecurringInvoices() #1 /htdocs/cron/card.php(105): Cronjob->run_jobs('') #2 {main} thrown in /htdocs/fourn/class/fournisseur.facture-rec.class.php on line 1330', referer: https:///cron/card.php?action=execute&token=&id=3&securitykey=  Environment Version 18.0.4  Environment OS (Synology) Linux 3.2.101 #42962 SMP PREEMPT Fri Mar 24 00:27:46 CST 2023 i686  Environment Web server Apache/2.4.54  Environment PHP php 7.4.30  Environment Database MariaDB 5.5.5-10.3.32-MariaDB  Environment URL(s) cron/card.php?action=execute  Expected and actual behavior Generate recurrent invoice without error  Steps to reproduce the behavior Started recurrent invoice generation fomr  Attached files cron/list.php?leftmenu=admintools&idmenu=15701 Not sure how to reproduce it - the issue seems to be with User to string conversion.",other-file | other-file,"Object of class User could not be converted to string in /htdocs/fourn/class/fournisseur.facture-rec.class.php  Bug While generating recurrent invoice in Dolibarr 18.0.4 AH01071: Got error 'PHP message: PHP Fatal error: Uncaught Error: Object of class User could not be converted to string in /htdocs/fourn/class/fournisseur.facture-rec.class.php:1330 Stack trace: #0 /htdocs/cron/class/cronjob.class.php(1290): FactureFournisseurRec->createRecurringInvoices() #1 /htdocs/cron/card.php(105): Cronjob->run_jobs('') #2 {main} thrown in /htdocs/fourn/class/fournisseur.facture-rec.class.php on line 1330', referer: https:cron/card.php?action=execute&token=&id=3&securitykey=  Environment Version 18.0.4  Environment OS (Synology) Linux 3.2.101 #42962 SMP PREEMPT Fri Mar 24 00:27:46 CST 2023 i686  Environment Web server Apache/2.4.54  Environment PHP php 7.4.30  Environment Database MariaDB 5.5.5-10.3.32-MariaDB  Environment URL(s) cron/card.php?action=execute  Expected and actual behavior Generate recurrent invoice without error  Steps to reproduce the behavior Started recurrent invoice generation fomr  Attached files cron/list.php?leftmenu=admintools&idmenu=15701 Not sure how to reproduce it - the issue seems to be with User to string conversion. other-file other-file",no-bug,0.9
23963,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23963,Update product description in situation invoice, Feature Request Users can't modify line description in the case of invoice situation and that is a good idea.  Use case Sometimes people need to update some information (for example when a legal rule is updated).  Suggested implementation Add a new hidden configuration flag like INVOICE_SITUATION_CAN_FORCE_UPDATE_DESCRIPTION  Suggested steps _No response_,other-file | other-file,Update product description in situation invoice  Feature Request Users can't modify line description in the case of invoice situation and that is a good idea.  Use case Sometimes people need to update some information (for example when a legal rule is updated).  Suggested implementation Add a new hidden configuration flag like INVOICE_SITUATION_CAN_FORCE_UPDATE_DESCRIPTION  Suggested steps _No response_ other-file other-file,no-bug,0.9
28541,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28541,Gestion de la longueur des donnes dans le champs QRCode, Bug ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/34ae5c04-536e-4488-a836-4aa8831be646)  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file | other-file,Gestion de la longueur des donnes dans le champs QRCode  Bug ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/34ae5c04-536e-4488-a836-4aa8831be646)  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file,no-bug,0.8
24953,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24953,HRM Establishment 404 error," Bug Missing setup.php and about.php in HRM module. in hrm section of dolibarr , I have setup tab and about tab that shows 404 error . those tabs pointing to htdocs/hrm/admin setup.php and about.php respectively but there are no files in the folder .  Environment Version 17.0.1  Environment OS Ubuntu  Environment Web server Apache2  Environment PHP 8.1  Environment Database Mariadb  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Setup / Modules Application . click on Gear Icon of HRM module . Create Establishment Once created . There are 4 tabs . Establishment , Log , Setup, About. Setup and about producing 404 error.  Attached files _No response_",other-file | other-file | other-file,"HRM Establishment 404 error  Bug Missing setup.php and about.php in HRM module. in hrm section of dolibarr , I have setup tab and about tab that shows 404 error . those tabs pointing to htdocs/hrm/admin setup.php and about.php respectively but there are no files in the folder .  Environment Version 17.0.1  Environment OS Ubuntu  Environment Web server Apache2  Environment PHP 8.1  Environment Database Mariadb  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Setup / Modules Application . click on Gear Icon of HRM module . Create Establishment Once created . There are 4 tabs . Establishment , Log , Setup, About. Setup and about producing 404 error.  Attached files _No response_ other-file other-file other-file",no-bug,0.9
28382,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28382,Unit price not imported in invoice import process," Bug The ""subprice"" field of facturedet table is not in the import fields list. (Dolibarr/htdocs/core/modules/modFacture.class.php line 371 and 436 show commented lines) Is there any reason why this field is voluntary not imported ? Can I create a PR to add the good information to import this field ?  Environment Version 18.0 19.0  Environment OS Debian 12  Environment Web server Apache  Environment PHP 8.1  Environment Database 8.0  Environment URL(s) imports/import.php?step=2&datatoimport=facture_3  Expected and actual behavior The unit prices of invoices are not imported with the import feature.  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Unit price not imported in invoice import process  Bug The ""subprice"" field of facturedet table is not in the import fields list. (Dolibarr/htdocs/core/modules/modFacture.class.php line 371 and 436 show commented lines) Is there any reason why this field is voluntary not imported ? Can I create a PR to add the good information to import this field ?  Environment Version 18.0 19.0  Environment OS Debian 12  Environment Web server Apache  Environment PHP 8.1  Environment Database 8.0  Environment URL(s) imports/import.php?step=2&datatoimport=facture_3  Expected and actual behavior The unit prices of invoices are not imported with the import feature.  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
23799,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23799,External users are not able to create events," Bug External users are not able to create events, even if they have the permission  Environment Version V16.x  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) /comm/action/card.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"External users are not able to create events  Bug External users are not able to create events, even if they have the permission  Environment Version V16.x  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) /comm/action/card.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.6
25223,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25223,Not able to uplad documents to donations," Bug I want to upload a written receipt to a donation in the donations module, but I cannot view the uploaded file. I get the success message for the uploaded document, but when I want to view the file I get the following error message `ErrorFileDoesNotExists: 1/Scanned Document 2022 002.pdf` <img width=""1726"" alt=""Screenshot 2023-06-28 at 20 51 06"" src=""https://github.com/Dolibarr/dolibarr/assets/11063798/d728b71b-6849-449e-b3db-0a238bdc64fb""> I use the https://github.com/tuxgasy/docker-dolibarr Docker install  Environment Version 17.0.2  Environment OS Docker Container on Linux 3c459c7be176 5.4.0-131-generic #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 x86_64  Environment Web server Apache  Environment PHP 8.1.20  Environment Database MySQL or MariaDB 10.8.8-MariaDB-1:10.8.8+maria~ubu2204  Environment URL(s) /don/card.php?id=29&save_lastsearch_values=1  Expected and actual behavior Be able to view the file  Steps to reproduce the behavior Add a donation in the donations module, add a file (pdf), view the file  Attached files _No response_",other-file,"Not able to uplad documents to donations  Bug I want to upload a written receipt to a donation in the donations module, but I cannot view the uploaded file. I get the success message for the uploaded document, but when I want to view the file I get the following error message `ErrorFileDoesNotExists: 1/Scanned Document 2022 002.pdf` <img width=""1726"" alt=""Screenshot 2023-06-28 at 20 51 06"" src=""https://github.com/Dolibarr/dolibarr/assets/11063798/d728b71b-6849-449e-b3db-0a238bdc64fb""> I use the https://github.com/tuxgasy/docker-dolibarr Docker install  Environment Version 17.0.2  Environment OS Docker Container on Linux 3c459c7be176 5.4.0-131-generic #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 x86_64  Environment Web server Apache  Environment PHP 8.1.20  Environment Database MySQL or MariaDB 10.8.8-MariaDB-1:10.8.8+maria~ubu2204  Environment URL(s) /don/card.php?id=29&save_lastsearch_values=1  Expected and actual behavior Be able to view the file  Steps to reproduce the behavior Add a donation in the donations module, add a file (pdf), view the file  Attached files _No response_ other-file",no-bug,0.8
29114,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29114,Intervention contact role text is in french," Bug Intervention contact role text is in french, should be in en_US ![intervention_contact_role_is_in_french](https://github.com/Dolibarr/dolibarr/assets/2551481/39fae0f7-3e29-4dd5-b267-0b9eda526083)  Dolibarr Version 18.0.4 + 19.0.0  Environment PHP 8.1.20  Environment Database MySQL or MariaDB 11.2.2-MariaDB-1:11.2.2+maria~ubu2204  Steps to reproduce the behavior and expected behavior create intervention, after creation go to `intervention contact`in top and notice how the text under ""contact role"" is in french.  Attached files _No response_",other-file | other-file,"Intervention contact role text is in french  Bug Intervention contact role text is in french, should be in en_US ![intervention_contact_role_is_in_french](https://github.com/Dolibarr/dolibarr/assets/2551481/39fae0f7-3e29-4dd5-b267-0b9eda526083)  Dolibarr Version 18.0.4 + 19.0.0  Environment PHP 8.1.20  Environment Database MySQL or MariaDB 11.2.2-MariaDB-1:11.2.2+maria~ubu2204  Steps to reproduce the behavior and expected behavior create intervention, after creation go to `intervention contact`in top and notice how the text under ""contact role"" is in french.  Attached files _No response_ other-file other-file",no-bug,0.9
26551,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26551,supplier invoice : no error message displayed when trying to delete a reconciled payment,"On a V18.0.3, go to a supplier invoice that has already been payed, and which payment has been reconciled. Re-open the invoice and notice there is a delete button at the end of the payment line, which proposes to delete the payment. If you click on this delete button, and confirm your choice, it seems like nothing happens. This is because your payment is reconciled and Dolibarr refuses to delete the payment. However, there is no error message giving you this information. This type of error is correctly handled via the `paiementfourn` class: https://github.com/Dolibarr/dolibarr/blob/09696078f37da3b5e37e72b3d3ea42fa205a8f28/htdocs/fourn/class/paiementfourn.class.php#L455-L465 In `card.php` however, `header()` is called right after the `delete()` action at line 706, so if there is an error, we never set the event message at line 709: https://github.com/Dolibarr/dolibarr/blob/09696078f37da3b5e37e72b3d3ea42fa205a8f28/htdocs/fourn/facture/card.php#L698-L711",other-file | other-file,"supplier invoice : no error message displayed when trying to delete a reconciled payment On a V18.0.3, go to a supplier invoice that has already been payed, and which payment has been reconciled. Re-open the invoice and notice there is a delete button at the end of the payment line, which proposes to delete the payment. If you click on this delete button, and confirm your choice, it seems like nothing happens. This is because your payment is reconciled and Dolibarr refuses to delete the payment. However, there is no error message giving you this information. This type of error is correctly handled via the `paiementfourn` class: https://github.com/Dolibarr/dolibarr/blob/09696078f37da3b5e37e72b3d3ea42fa205a8f28/htdocs/fourn/class/paiementfourn.class.php#L455-L465 In `card.php` however, `header()` is called right after the `delete()` action at line 706, so if there is an error, we never set the event message at line 709: https://github.com/Dolibarr/dolibarr/blob/09696078f37da3b5e37e72b3d3ea42fa205a8f28/htdocs/fourn/facture/card.php#L698-L711 other-file other-file",no-bug,0.9
28306,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28306,Bug with accountancy import," Bug Hello everyone! Trying to import some accountancy data in FEC format on Dolibarr 18.0.4 I receive this error for each line of my file: ""Data truncated for column 'montant' at row 1"". Have a nice day!  Environment Version 18.0.4  Environment OS Darwin mbpdealexandra2.home 23.3.0 Darwin Kernel Version 23.3.0: Wed Dec 20 21:30:59 PST 2023; root:xnu-10002.81.5~7/RELEASE_ARM64_T6030 arm64  Environment Web server Apache/2.4.54 (Unix) OpenSSL/1.0.2u PHP/7.4.33 mod_wsgi/3.5 Python/2.7.18 mod_fastcgi/mod_fastcgi-SNAP-0910052141 mod_perl/2.0.11 Perl/v5.30.1  Environment PHP 7.4.33  Environment Database 5.7.39 mysqli (mysqlnd 7.4.33)  Environment URL(s) _No response_  Expected and actual behavior When we import a document whith everything mathing the given import format we expect that it works. Here, I receive this error for each line of my file: ""Data truncated for column 'montant' at row 1"".  Steps to reproduce the behavior Importing an XLS FEC file.  Attached files As I look for this error source, I find bugs in method ""computeAmount"" in accountancyimport.class.php: We have this line : $field_index_list = array_flip($listfields); But the $listfields don't need to be flip as it is already on the good format: $listfields[$key]=$value; where $key is the field name like debit or credit and $value is an int matching the index for the $arrayrecord[index]['val']. The second error is that in $listfields the indexes are all like b.something. Therefore, $listfield['debit'] must be change in $listfield['b.debit']; With these things changed, the import work well. Here is the corrected code : /** * Compute amount * * @param array $arrayrecord Array of read values: [fieldpos] => (['val']=>val, ['type']=>-1=null,0=blank,1=string), [fieldpos+1] * @param array $listfields Fields list to add * @param int $record_key Record key * @return mixed Value */ public function computeAmount(&$arrayrecord, $listfields, $record_key) { // get fields indexes if (isset($listfields['b.debit']) && isset($listfields['b.credit'])) { $debit_index = $listfields['b.debit']; $credit_index = $listfields['b.credit']; $debit = floatval($arrayrecord[$debit_index]['val']); $credit = floatval($arrayrecord[$credit_index]['val']); if (!empty($debit)) { $amount = $debit; } else { $amount = $credit; } return ""'"" . $this->db->escape(abs($amount)) . ""'""; } return ""''""; }",other-file | other-file,"Bug with accountancy import  Bug Hello everyone! Trying to import some accountancy data in FEC format on Dolibarr 18.0.4 I receive this error for each line of my file: ""Data truncated for column 'montant' at row 1"". Have a nice day!  Environment Version 18.0.4  Environment OS Darwin mbpdealexandra2.home 23.3.0 Darwin Kernel Version 23.3.0: Wed Dec 20 21:30:59 PST 2023; root:xnu-10002.81.5~7/RELEASE_ARM64_T6030 arm64  Environment Web server Apache/2.4.54 (Unix) OpenSSL/1.0.2u PHP/7.4.33 mod_wsgi/3.5 Python/2.7.18 mod_fastcgi/mod_fastcgi-SNAP-0910052141 mod_perl/2.0.11 Perl/v5.30.1  Environment PHP 7.4.33  Environment Database 5.7.39 mysqli (mysqlnd 7.4.33)  Environment URL(s) _No response_  Expected and actual behavior When we import a document whith everything mathing the given import format we expect that it works. Here, I receive this error for each line of my file: ""Data truncated for column 'montant' at row 1"".  Steps to reproduce the behavior Importing an XLS FEC file.  Attached files As I look for this error source, I find bugs in method ""computeAmount"" in accountancyimport.class.php: We have this line : $field_index_list = array_flip($listfields); But the $listfields don't need to be flip as it is already on the good format: $listfields[$key]=$value; where $key is the field name like debit or credit and $value is an int matching the index for the $arrayrecord[index]['val']. The second error is that in $listfields the indexes are all like b.something. Therefore, $listfield['debit'] must be change in $listfield['b.debit']; With these things changed, the import work well. Here is the corrected code : /** * Compute amount * * @param array $arrayrecord Array of read values: [fieldpos] => (['val']=>val, ['type']=>-1=null,0=blank,1=string), [fieldpos+1] * @param array $listfields Fields list to add * @param int $record_key Record key * @return mixed Value */ public function computeAmount(&$arrayrecord, $listfields, $record_key) { // get fields indexes if (isset($listfields['b.debit']) && isset($listfields['b.credit'])) { $debit_index = $listfields['b.debit']; $credit_index = $listfields['b.credit']; $debit = floatval($arrayrecord[$debit_index]['val']); $credit = floatval($arrayrecord[$credit_index]['val']); if (!empty($debit)) { $amount = $debit; } else { $amount = $credit; } return ""'"" . $this->db->escape(abs($amount)) . ""'""; } return ""''""; } other-file other-file",no-bug,0.9
24267,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24267,Bug: Dynamic price / parseExpression ist not loading the extrafields of product," Bug In the price expression for dynamic prices, extrafields of the product should be usable via #extrafield_nameofthefield#, but currently they are not loaded correctly.  Environment Version 17  Expected and actual behavior All extrafields of the product shall be usable as variables in the price expression.",other-file,"Bug: Dynamic price / parseExpression ist not loading the extrafields of product  Bug In the price expression for dynamic prices, extrafields of the product should be usable via #extrafield_nameofthefield#, but currently they are not loaded correctly.  Environment Version 17  Expected and actual behavior All extrafields of the product shall be usable as variables in the price expression. other-file",no-bug,0.8
27078,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27078,FormConfirm() function : send values in POST with ajax," Feature Request Manage the case where there are a lot of value in form confirm to send.  Use case In tab ""Contacts"" of a project card with a lot of tasks : - Add a contributor to project - Check all tasks - Valid  Suggested implementation Function formconfirm() with parameter ""$useajax"" at ""1"" : Values of form do not have to send in url (GET) : an error is generated with a lot of values. Values have to send in POST. We must to use this method in formconfirm() function : ![image](https://github.com/Dolibarr/dolibarr/assets/52402938/3e6ae40d-b5d1-4c08-8e1e-3fab398bf340)  Suggested steps _No response_",other-file | other-file | other-file | other-file,"FormConfirm() function : send values in POST with ajax  Feature Request Manage the case where there are a lot of value in form confirm to send.  Use case In tab ""Contacts"" of a project card with a lot of tasks : - Add a contributor to project - Check all tasks - Valid  Suggested implementation Function formconfirm() with parameter ""$useajax"" at ""1"" : Values of form do not have to send in url (GET) : an error is generated with a lot of values. Values have to send in POST. We must to use this method in formconfirm() function : ![image](https://github.com/Dolibarr/dolibarr/assets/52402938/3e6ae40d-b5d1-4c08-8e1e-3fab398bf340)  Suggested steps _No response_ other-file other-file other-file other-file",no-bug,0.9
23822,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23822,Theorical stock calculation error," Bug Good morning, I think there is an oversight in the load_stats_command function of the product.class.php file in the htdocs/products/class/ folder In theorical stock management, if the DECREASE_ONLY_UNINVOICEDPRODUCTS option is on, we have a compensation. But in the SQL query of this part, we do not make the difference between an invoice (stock that we no longer have) and a credit note (stock that we recover). In this query, we just sum all quantities without distinction, invoice quantities are counted as positive. I therefore suggest modifying the SELECT with this proposal: SELECT SUM(IF(f.type=2,-1,1)*fd.qty) as count The goal is that if the type of invoice is a credit (type=2) to multiply by -1 to have a negative quantity otherwise to multiply by 1 and that does not change anything for an invoice. Thank you in advance for your feedback because maybe I'm wrong :) Good day,  Environment Version 16.0.0  Environment OS Ubuntu 18.04.6 LTS  Environment Web server HTTP/2 - Apache - Nginx/1.20.2  Environment PHP 7.4.33  Environment Database MySQL 5.7.41  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Theorical stock calculation error  Bug Good morning, I think there is an oversight in the load_stats_command function of the product.class.php file in the htdocs/products/class/ folder In theorical stock management, if the DECREASE_ONLY_UNINVOICEDPRODUCTS option is on, we have a compensation. But in the SQL query of this part, we do not make the difference between an invoice (stock that we no longer have) and a credit note (stock that we recover). In this query, we just sum all quantities without distinction, invoice quantities are counted as positive. I therefore suggest modifying the SELECT with this proposal: SELECT SUM(IF(f.type=2,-1,1)*fd.qty) as count The goal is that if the type of invoice is a credit (type=2) to multiply by -1 to have a negative quantity otherwise to multiply by 1 and that does not change anything for an invoice. Thank you in advance for your feedback because maybe I'm wrong :) Good day,  Environment Version 16.0.0  Environment OS Ubuntu 18.04.6 LTS  Environment Web server HTTP/2 - Apache - Nginx/1.20.2  Environment PHP 7.4.33  Environment Database MySQL 5.7.41  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
29101,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29101,Sort by email template fails with DB_ERROR_NOSUCHFIELD Unknown column 'type_templatetype_template' in 'order clause'," Bug Hi team, thank you for your outstanding efforts to make Dolibarr a great solution. In setting up emails, displaying email templates and sorting by Type of template, Dolibarr returns an error: DB_ERROR_NOSUCHFIELD Unknown column 'type_templatetype_template' in 'order clause'  Dolibarr Version 19.0.1  Environment PHP 8.1.27  Environment Database MySQL or MariaDB 5.7.44-cll-lve  Steps to reproduce the behavior and expected behavior Pick Home, Setup, Emails, Email templates. Click Type of template. [Type of template](mails_templates.php?sortfield=type_templatetype_template,lang,position,label&sortorder=asc,asc,asc,asc&begin=&id=25&search_type_template=)  Attached files [Dolibarr.log](https://github.com/Dolibarr/dolibarr/files/14789032/Dolibarr.log)",other-file,"Sort by email template fails with DB_ERROR_NOSUCHFIELD Unknown column 'type_templatetype_template' in 'order clause'  Bug Hi team, thank you for your outstanding efforts to make Dolibarr a great solution. In setting up emails, displaying email templates and sorting by Type of template, Dolibarr returns an error: DB_ERROR_NOSUCHFIELD Unknown column 'type_templatetype_template' in 'order clause'  Dolibarr Version 19.0.1  Environment PHP 8.1.27  Environment Database MySQL or MariaDB 5.7.44-cll-lve  Steps to reproduce the behavior and expected behavior Pick Home, Setup, Emails, Email templates. Click Type of template. [Type of template](mails_templates.php?sortfield=type_templatetype_template,lang,position,label&sortorder=asc,asc,asc,asc&begin=&id=25&search_type_template=)  Attached files [Dolibarr.log](https://github.com/Dolibarr/dolibarr/files/14789032/Dolibarr.log) other-file",no-bug,0.9
25044,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25044,Add Visibility parameter in the setup of Public self-registration form in projects/leads," Feature Request Now the self registered leads are always created with visibility to everybody. This is a problem, since all external users that have permissions to see only their own projects, also can see the new leads.  Suggested implementation To fix it is necessary to be able to specify in the public self-registration form a Visibility parameter that allows to specify wich user or group of users will attend the new leads created using the Public self-registration portal. Also can be fixed adding the permission ""everydody except external users"" to the permissions system. The Setup of the projects module could be similar than this screenshot as below ![image](https://github.com/Dolibarr/dolibarr/assets/7486607/0ebd752f-ce35-46a2-9bf7-04f03613e7ed)",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Add Visibility parameter in the setup of Public self-registration form in projects/leads  Feature Request Now the self registered leads are always created with visibility to everybody. This is a problem, since all external users that have permissions to see only their own projects, also can see the new leads.  Suggested implementation To fix it is necessary to be able to specify in the public self-registration form a Visibility parameter that allows to specify wich user or group of users will attend the new leads created using the Public self-registration portal. Also can be fixed adding the permission ""everydody except external users"" to the permissions system. The Setup of the projects module could be similar than this screenshot as below ![image](https://github.com/Dolibarr/dolibarr/assets/7486607/0ebd752f-ce35-46a2-9bf7-04f03613e7ed) other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
27123,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27123,"Missing translation key ""ErrorStartDateGreaterEnd"""," Bug The translation key `ErrorStartDateGreaterEnd` is called by multiple files, but isn't defined in V18 and probably develop (V19). On a V18.0.3 this key is called from:  grep -Rl ""ErrorStartDateGreaterEnd"" . ./htdocs/comm/propal/class/propal.class.php ./htdocs/commande/class/commande.class.php ./htdocs/fourn/class/fournisseur.facture.class.php ./htdocs/fourn/class/fournisseur.commande.class.php ./htdocs/compta/facture/class/facture.class.php ./htdocs/contrat/class/contrat.class.php  For example here: https://github.com/Dolibarr/dolibarr/blob/24703a0f3d63dc2f6f900cbc0147abed4f6335d2/htdocs/fourn/class/fournisseur.facture.class.php#L2076-L2080 or here: https://github.com/Dolibarr/dolibarr/blob/24703a0f3d63dc2f6f900cbc0147abed4f6335d2/htdocs/fourn/class/fournisseur.commande.class.php#L1902-L1906 or here: https://github.com/Dolibarr/dolibarr/blob/24703a0f3d63dc2f6f900cbc0147abed4f6335d2/htdocs/compta/facture/class/facture.class.php#L4123-L4127 I've checked on Transifex but couldn't find it: https://app.transifex.com/dolibarr-association/dolibarr/translate/#fr_FR/$?q=key%3AErrorStartDateGreaterEnd It probably existed before and has been deleted at some point. I guess this key should be added to `/htdocs/langs/en_US/errors.lang` since we've always got `$langs->load(""errors"");` just before it's called.  Environment Version 18.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Missing translation key ""ErrorStartDateGreaterEnd""  Bug The translation key `ErrorStartDateGreaterEnd` is called by multiple files, but isn't defined in V18 and probably develop (V19). On a V18.0.3 this key is called from:  grep -Rl ""ErrorStartDateGreaterEnd"" . ./htdocs/comm/propal/class/propal.class.php ./htdocs/commande/class/commande.class.php ./htdocs/fourn/class/fournisseur.facture.class.php ./htdocs/fourn/class/fournisseur.commande.class.php ./htdocs/compta/facture/class/facture.class.php ./htdocs/contrat/class/contrat.class.php  For example here: https://github.com/Dolibarr/dolibarr/blob/24703a0f3d63dc2f6f900cbc0147abed4f6335d2/htdocs/fourn/class/fournisseur.facture.class.php#L2076-L2080 or here: https://github.com/Dolibarr/dolibarr/blob/24703a0f3d63dc2f6f900cbc0147abed4f6335d2/htdocs/fourn/class/fournisseur.commande.class.php#L1902-L1906 or here: https://github.com/Dolibarr/dolibarr/blob/24703a0f3d63dc2f6f900cbc0147abed4f6335d2/htdocs/compta/facture/class/facture.class.php#L4123-L4127 I've checked on Transifex but couldn't find it: https://app.transifex.com/dolibarr-association/dolibarr/translate/#fr_FR/$?q=key%3AErrorStartDateGreaterEnd It probably existed before and has been deleted at some point. I guess this key should be added to `/htdocs/langs/en_US/errors.lang` since we've always got `$langs->load(""errors"");` just before it's called.  Environment Version 18.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
26692,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26692,phphstan report fix compatibility php8.2 - class accountancy - class facture," Bug <img width=""1268"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/67911601/f21ba561-cd4e-41c2-bb2d-f0f086e40ce3""> <img width=""1127"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/67911601/848ca1dc-5f9f-4883-8ad4-6879aaf3533d"">  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"phphstan report fix compatibility php8.2 - class accountancy - class facture  Bug <img width=""1268"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/67911601/f21ba561-cd4e-41c2-bb2d-f0f086e40ce3""> <img width=""1127"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/67911601/848ca1dc-5f9f-4883-8ad4-6879aaf3533d"">  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
23334,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23334,Modify/add a line in an invoice with a price in foreign currency," Bug When modifying/adding a line in an invoice with a price in foreign currency, php code fails in file htdocs/commande/card.php (line 947 -add- and 1072 -update-)  if !empty($conf->global->MAIN_USE_ADVANCED_PERMS) && empty($user->rights->produit->ignore_price_min_advance)) || empty($conf->global->MAIN_USE_ADVANCED_PERMS)) && (!empty($price_min) && (price2num($pu_ht) * (1 - price2num($remise_percent) / 100) < price2num($price_min { $mesg = $langs->trans(""CantBeLessThanMinPrice"", price(price2num($price_min, 'MU'), 0, $langs, 0, 0, - 1, $conf->currency)); setEventMessages($mesg, null, 'errors');  Condition fails because $pu_ht is not defined A solution would be to define $pu_ht_equi that would be $pu_ht if defined and $pu_ht_devise if defined My problem is I don't see where is currency rate Many thanks  Environment Version 16.0.1  Environment OS ubuntu  Environment Web server apache 2.4  Environment PHP php8.0  Environment Database mariadb  Environment URL(s) htdocs/commande/card.php (line 947 -add- and 1072 -update-)  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"Modify/add a line in an invoice with a price in foreign currency  Bug When modifying/adding a line in an invoice with a price in foreign currency, php code fails in file htdocs/commande/card.php (line 947 -add- and 1072 -update-)  if !empty($conf->global->MAIN_USE_ADVANCED_PERMS) && empty($user->rights->produit->ignore_price_min_advance)) || empty($conf->global->MAIN_USE_ADVANCED_PERMS)) && (!empty($price_min) && (price2num($pu_ht) * (1 - price2num($remise_percent) / 100) < price2num($price_min { $mesg = $langs->trans(""CantBeLessThanMinPrice"", price(price2num($price_min, 'MU'), 0, $langs, 0, 0, - 1, $conf->currency)); setEventMessages($mesg, null, 'errors');  Condition fails because $pu_ht is not defined A solution would be to define $pu_ht_equi that would be $pu_ht if defined and $pu_ht_devise if defined My problem is I don't see where is currency rate Many thanks  Environment Version 16.0.1  Environment OS ubuntu  Environment Web server apache 2.4  Environment PHP php8.0  Environment Database mariadb  Environment URL(s) htdocs/commande/card.php (line 947 -add- and 1072 -update-)  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
26005,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26005,Depricated link to check tax id," Bug The link to check the validity of a tax id seams to be deprecated. The new link is: [https://ec.europa.eu/taxation_customs/vies/#/vat-validation 1](https://ec.europa.eu/taxation_customs/vies/#/vat-validation) This bug was first displayed in the German forum by ""Notaufnahme"" (https://forum.dolibarr.de/forum/t/umsatzsteuer-id-ueberpruefen/8782).  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected: Check the valiantly of the tax id. Actual: Only check syntax, warning is displayed ![image](https://github.com/Dolibarr/dolibarr/assets/115941074/ac0576d7-6d8d-4327-b6f8-951069c26c3b)  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"Depricated link to check tax id  Bug The link to check the validity of a tax id seams to be deprecated. The new link is: [https://ec.europa.eu/taxation_customs/vies/#/vat-validation 1](https://ec.europa.eu/taxation_customs/vies/#/vat-validation) This bug was first displayed in the German forum by ""Notaufnahme"" (https://forum.dolibarr.de/forum/t/umsatzsteuer-id-ueberpruefen/8782).  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected: Check the valiantly of the tax id. Actual: Only check syntax, warning is displayed ![image](https://github.com/Dolibarr/dolibarr/assets/115941074/ac0576d7-6d8d-4327-b6f8-951069c26c3b)  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.7
31206,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31206,Ticket markAsRead function does not update the status to STATUS_READ," Bug Clicking the ""Read"" status button does not update the object's fk_statut attribute resulting in the object's status remaining the same as before the action. The ticket.class.php 'markAsRead' function executes a database update for the field. However, it does not set '$this->fk_statut' to Ticket::STATUS_READ. As a result, if there are triggers that update the object the status is reverted back to the original status. If the following is added somewhere before or after the database update the problem is resolved. `$this->fk_status = Ticket::STATUS_READ;`  Dolibarr Version 18.0  Environment PHP PHP 7.x  Environment Database 10.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior 1. Open a ticket card. 2. Click the 'Read' status button. 3. Observe the status did not change.  Attached files _No response_",other-file | other-file,"Ticket markAsRead function does not update the status to STATUS_READ  Bug Clicking the ""Read"" status button does not update the object's fk_statut attribute resulting in the object's status remaining the same as before the action. The ticket.class.php 'markAsRead' function executes a database update for the field. However, it does not set '$this->fk_statut' to Ticket::STATUS_READ. As a result, if there are triggers that update the object the status is reverted back to the original status. If the following is added somewhere before or after the database update the problem is resolved. `$this->fk_status = Ticket::STATUS_READ;`  Dolibarr Version 18.0  Environment PHP PHP 7.x  Environment Database 10.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior 1. Open a ticket card. 2. Click the 'Read' status button. 3. Observe the status did not change.  Attached files _No response_ other-file other-file",no-bug,0.9
29224,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29224,Create Purchase order from Selling order is using sell prices in Purchase order," Bug When creating ""Purchase order"" from ""Selling order"" (a new function I haven't seen before) the purchase order is using the prices from the selling order, and must be adjusted manually. The Purchase prices should of course be used. Also the discount used in the Selling order is transferred to the Purchase order.  Dolibarr Version 19.0.1  Environment PHP 7.4  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file,"Create Purchase order from Selling order is using sell prices in Purchase order  Bug When creating ""Purchase order"" from ""Selling order"" (a new function I haven't seen before) the purchase order is using the prices from the selling order, and must be adjusted manually. The Purchase prices should of course be used. Also the discount used in the Selling order is transferred to the Purchase order.  Dolibarr Version 19.0.1  Environment PHP 7.4  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
29864,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29864,Rapid stock transfer allows the creation of stock greater than 1 for parts managed by serial numbers, Bug Step 1 : Update Stock and authorize negative stock! ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/6ac5136e-b685-4b20-a2cc-3b1900f0bfdb) Step 2 : bonbon unique serial ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/e9210a2e-1678-45a1-9f86-cb809c9f2834) Step 3 : Quantity in stock are > 1 ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/9cd5c0a5-fcc6-488e-8f7a-a0fbbbecf00b)  Dolibarr Version 20.0.0 Beta,other-file | other-file | other-file | other-file,Rapid stock transfer allows the creation of stock greater than 1 for parts managed by serial numbers  Bug Step 1 : Update Stock and authorize negative stock! ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/6ac5136e-b685-4b20-a2cc-3b1900f0bfdb) Step 2 : bonbon unique serial ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/e9210a2e-1678-45a1-9f86-cb809c9f2834) Step 3 : Quantity in stock are > 1 ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/9cd5c0a5-fcc6-488e-8f7a-a0fbbbecf00b)  Dolibarr Version 20.0.0 Beta other-file other-file other-file other-file,no-bug,0.9
30520,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30520,Creator user data displayed in the form after an error in the user creation form, Bug Creator user data displayed in the form after an error in the user creation form  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Set the address data of your user 2. Open the user creation form 3. Don't set anything and valid the form 4. Now data of the current user is set on the addresses fields  Attached files ![Capture dcran du 2024-08-01 14-09-51](https://github.com/user-attachments/assets/3263aaca-9fd2-4555-b0d5-2964aa432228) ![Capture dcran du 2024-08-01 14-09-44](https://github.com/user-attachments/assets/fe014491-7c7f-45e5-af42-a4adbaa5d78f),other-file | other-file,Creator user data displayed in the form after an error in the user creation form  Bug Creator user data displayed in the form after an error in the user creation form  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Set the address data of your user 2. Open the user creation form 3. Don't set anything and valid the form 4. Now data of the current user is set on the addresses fields  Attached files ![Capture dcran du 2024-08-01 14-09-51](https://github.com/user-attachments/assets/3263aaca-9fd2-4555-b0d5-2964aa432228) ![Capture dcran du 2024-08-01 14-09-44](https://github.com/user-attachments/assets/fe014491-7c7f-45e5-af42-a4adbaa5d78f) other-file other-file,no-bug,0.9
33546,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33546,"""Error bad setup of field"" when disposing of assets"," Bug When selecting ""Dispose"" option on the Asset item page, this shows up in the Disposal popup box under the ""Customer Invoice"" field: selectForForms: Error bad setup of field objectdescorig=Facture, objectfield=asset@asset:disposal_invoice_id, objectdesc=  Dolibarr Version 21.0.0  Environment PHP 8.2.28  Environment Database MariaDB 11.7.2-MariaDB-ubu2404, mysqli (mysqlnd 8.2.28)  Steps to reproduce the behavior and expected behavior - Create an asset - Click on ""Disposal""  Attached files ![Image](https://github.com/user-attachments/assets/e3003304-3475-48c8-96ce-a07fcaeab099)",other-file | other-file,"""Error bad setup of field"" when disposing of assets  Bug When selecting ""Dispose"" option on the Asset item page, this shows up in the Disposal popup box under the ""Customer Invoice"" field: selectForForms: Error bad setup of field objectdescorig=Facture, objectfield=asset@asset:disposal_invoice_id, objectdesc=  Dolibarr Version 21.0.0  Environment PHP 8.2.28  Environment Database MariaDB 11.7.2-MariaDB-ubu2404, mysqli (mysqlnd 8.2.28)  Steps to reproduce the behavior and expected behavior - Create an asset - Click on ""Disposal""  Attached files ![Image](https://github.com/user-attachments/assets/e3003304-3475-48c8-96ce-a07fcaeab099) other-file other-file",no-bug,0.9
29424,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29424,BUG: in API GET member categories," Bug If you in dolibarr version 20-alpha tries to use the API to get member categories it does not respect when you supply a non existing member id, where as in version 18.0.5 it does respect and gives an error.  Dolibarr Version 20.0.0-alpha  Environment PHP 8.2.7  Environment Database 10.11.7-MariaDB-1:10.11.7+maria~ubu2204  Steps to reproduce the behavior and expected behavior create some member categories and assign some members to them. use the API to get the member categories for a non existing member expected is an error better than the one in 18.0.5, because in 18.0.5 it says that the category does not exist, but it is the member that does not exist.  Attached files v20 ignores non existing members ![get_member_categories_v20_ignores_nonexisting_member](https://github.com/Dolibarr/dolibarr/assets/2551481/5a054bc6-4608-47c9-8ad1-6d83b1033e82)",other-file | other-file,"BUG: in API GET member categories  Bug If you in dolibarr version 20-alpha tries to use the API to get member categories it does not respect when you supply a non existing member id, where as in version 18.0.5 it does respect and gives an error.  Dolibarr Version 20.0.0-alpha  Environment PHP 8.2.7  Environment Database 10.11.7-MariaDB-1:10.11.7+maria~ubu2204  Steps to reproduce the behavior and expected behavior create some member categories and assign some members to them. use the API to get the member categories for a non existing member expected is an error better than the one in 18.0.5, because in 18.0.5 it says that the category does not exist, but it is the member that does not exist.  Attached files v20 ignores non existing members ![get_member_categories_v20_ignores_nonexisting_member](https://github.com/Dolibarr/dolibarr/assets/2551481/5a054bc6-4608-47c9-8ad1-6d83b1033e82) other-file other-file",bug,0.9
23023,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23023,'off' parameters are erased during a module update," Bug When disabling, then enabling a module (for example during an update), the on/off constants set on 'off' by the user are re-set on 'on' if it is the default parameter.  Environment Version tested on v14 and v16.  Environment OS any  Environment Web server any  Environment PHP any  Environment Database any  Environment URL(s) _No response_  Expected and actual behavior current behavior: When disabling, then enabling a module (for example during an update), the on/off constants that were previously set to 'off' by the user are re-set on 'on' if 'on' is the default parameter. expected behavior: if a parameter has been set to 'OFF' by a user, it should stay on 'OFF' when re-enabling the module, even if the default parameter is 'ON'.  Steps to reproduce the behavior This behavior can be found on WYSIWYG editor, but **it will also happen on almost any internal or external module where a default value is set to 1**. 1. On a fresh install, we enable WYSIWYG editor. We have the **default** setup: ![image](https://user-images.githubusercontent.com/89838020/204255114-a970327d-e1e4-4370-b7e5-ac6166128033.png) 2. we disable one parameter: ![image](https://user-images.githubusercontent.com/89838020/204255370-e9c81583-4be2-4c1d-a90e-4e39dde6cc67.png) 3. We disable/enable the module 4. The modified parameter has been overridden: ![image](https://user-images.githubusercontent.com/89838020/204255114-a970327d-e1e4-4370-b7e5-ac6166128033.png) ___ Explanations  This behavior is due to using `dolibarr_del_const()` when setting a parameter to 'OFF'. The const is deleted from table llx_const. When re-enabling the module, an insertion is done because the const does not appear in the table. When setting a parameter to 'OFF', the const value should be set to '0'. On most modules (ex. WYSIWYG editor) the fix must be made on the admin page. If using ajax_constantonoff, the fix must also be made on core/ajax/constantonoff.php file.  Attached files _No response_",other-file,"'off' parameters are erased during a module update  Bug When disabling, then enabling a module (for example during an update), the on/off constants set on 'off' by the user are re-set on 'on' if it is the default parameter.  Environment Version tested on v14 and v16.  Environment OS any  Environment Web server any  Environment PHP any  Environment Database any  Environment URL(s) _No response_  Expected and actual behavior current behavior: When disabling, then enabling a module (for example during an update), the on/off constants that were previously set to 'off' by the user are re-set on 'on' if 'on' is the default parameter. expected behavior: if a parameter has been set to 'OFF' by a user, it should stay on 'OFF' when re-enabling the module, even if the default parameter is 'ON'.  Steps to reproduce the behavior This behavior can be found on WYSIWYG editor, but **it will also happen on almost any internal or external module where a default value is set to 1**. 1. On a fresh install, we enable WYSIWYG editor. We have the **default** setup: ![image](https://user-images.githubusercontent.com/89838020/204255114-a970327d-e1e4-4370-b7e5-ac6166128033.png) 2. we disable one parameter: ![image](https://user-images.githubusercontent.com/89838020/204255370-e9c81583-4be2-4c1d-a90e-4e39dde6cc67.png) 3. We disable/enable the module 4. The modified parameter has been overridden: ![image](https://user-images.githubusercontent.com/89838020/204255114-a970327d-e1e4-4370-b7e5-ac6166128033.png) ___ Explanations  This behavior is due to using `dolibarr_del_const()` when setting a parameter to 'OFF'. The const is deleted from table llx_const. When re-enabling the module, an insertion is done because the const does not appear in the table. When setting a parameter to 'OFF', the const value should be set to '0'. On most modules (ex. WYSIWYG editor) the fix must be made on the admin page. If using ajax_constantonoff, the fix must also be made on core/ajax/constantonoff.php file.  Attached files _No response_ other-file",no-bug,0.9
29381,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29381,Hide old projects," Bug When Im placing an order with a supplier, I can link it to the corresponding project. But the list of projects shows all projects (opened and closed several years ago). I'm trying to hide the closed projects from the list to be more productive. I have tried using the PROJECT_HIDE_UNSELECTABLES and PROJECT_ALWAYS_DISCARD_CLOSED_PROJECTS_IN_SELECT variables in Setup/Other setup without success.  Dolibarr Version 19.0.1  Environment PHP 8.2  Environment Database MySQL or MariaDB 5.7.44  Steps to reproduce the behavior and expected behavior Inside Thrid-parties --> Choosing a random third party. Enter to the ""Vendor"" section. --> Select ""Create order"" and select ""create draft"". The list of projects to be linked to the projects is complete (projects opened and closed). I expect to see only the opened projects.  Attached files ![2024-04-17 19_47_44-(PROV5124) - Card](https://github.com/Dolibarr/dolibarr/assets/154713844/3be0deb5-55df-450c-8eff-0f36e71c0901)",other-file | other-file,"Hide old projects  Bug When Im placing an order with a supplier, I can link it to the corresponding project. But the list of projects shows all projects (opened and closed several years ago). I'm trying to hide the closed projects from the list to be more productive. I have tried using the PROJECT_HIDE_UNSELECTABLES and PROJECT_ALWAYS_DISCARD_CLOSED_PROJECTS_IN_SELECT variables in Setup/Other setup without success.  Dolibarr Version 19.0.1  Environment PHP 8.2  Environment Database MySQL or MariaDB 5.7.44  Steps to reproduce the behavior and expected behavior Inside Thrid-parties --> Choosing a random third party. Enter to the ""Vendor"" section. --> Select ""Create order"" and select ""create draft"". The list of projects to be linked to the projects is complete (projects opened and closed). I expect to see only the opened projects.  Attached files ![2024-04-17 19_47_44-(PROV5124) - Card](https://github.com/Dolibarr/dolibarr/assets/154713844/3be0deb5-55df-450c-8eff-0f36e71c0901) other-file other-file",no-bug,0.9
24921,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24921,Broken group card and permissions pages," Bug The `user/group/card.php?id=1` and `user/group/perms.php?id=1` pages are empty and result in error messages (the following is for card.php):  PHP Fatal error: Uncaught Error: Call to undefined method UserGroup::getFullName() in /var/www/dolibarr/htdocs/core/class/html.form.class.php:9540 Stack trace: #0 /var/www/dolibarr/htdocs/core/lib/functions.lib.php(2484): Form->showrefnav() #1 /var/www/dolibarr/htdocs/user/group/perms.php(210): dol_banner_tab() #2 {main} thrown in /var/www/dolibarr/htdocs/core/class/html.form.class.php on line 9540, referer: https://dolibarr.local/user/group/card.php?id=1&save_lastsearch_values=1  This was working in 17.0.2 before we upgraded to 18.0.0-beta.  Environment Version 18  Environment OS Debian 11  Environment Web server apache2  Environment PHP 8.2.6  Environment Database MariaDB 10.5.19  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Broken group card and permissions pages  Bug The `user/group/card.php?id=1` and `user/group/perms.php?id=1` pages are empty and result in error messages (the following is for card.php):  PHP Fatal error: Uncaught Error: Call to undefined method UserGroup::getFullName() in /var/www/dolibarr/htdocs/core/class/html.form.class.php:9540 Stack trace: #0 /var/www/dolibarr/htdocs/core/lib/functions.lib.php(2484): Form->showrefnav() #1 /var/www/dolibarr/htdocs/user/group/perms.php(210): dol_banner_tab() #2 {main} thrown in /var/www/dolibarr/htdocs/core/class/html.form.class.php on line 9540, referer: https://dolibarr.local/user/group/card.php?id=1&save_lastsearch_values=1  This was working in 17.0.2 before we upgraded to 18.0.0-beta.  Environment Version 18  Environment OS Debian 11  Environment Web server apache2  Environment PHP 8.2.6  Environment Database MariaDB 10.5.19  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
25314,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25314,Delete Donation Button not working," Bug The delete Button for donations is greyed and not working. If a manually add ""action=delete"" to the url, the donation can be removed.  Environment Version 17.0.2  Environment OS Docker Linux 3c459c7be176 5.4.0-131-generic #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 x86_64  Environment Web server Apache  Environment PHP Ok 8.1.20  Environment Database MySQL or MariaDB 10.8.8-MariaDB-1:10.8.8+maria~ubu2204  Environment URL(s) /societe/card.php?socid=96&save_lastsearch_values=1  Expected and actual behavior Expected: be able to delete a donation via the UI with the delete button Actual: deletion is only possible by changing the url  Steps to reproduce the behavior Activate Unalterable Archives Set INVOICE_CAN_ALWAYS_BE_REMOVED=1 Create a donation, remove the payment, try to delete the donation with the delete button.  Attached files <img width=""1330"" alt=""Screenshot 2023-07-09 at 12 39 37"" src=""https://github.com/Dolibarr/dolibarr/assets/11063798/5087070f-1e67-42c5-8a4d-46c588681bc5"">",other-file,"Delete Donation Button not working  Bug The delete Button for donations is greyed and not working. If a manually add ""action=delete"" to the url, the donation can be removed.  Environment Version 17.0.2  Environment OS Docker Linux 3c459c7be176 5.4.0-131-generic #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 x86_64  Environment Web server Apache  Environment PHP Ok 8.1.20  Environment Database MySQL or MariaDB 10.8.8-MariaDB-1:10.8.8+maria~ubu2204  Environment URL(s) /societe/card.php?socid=96&save_lastsearch_values=1  Expected and actual behavior Expected: be able to delete a donation via the UI with the delete button Actual: deletion is only possible by changing the url  Steps to reproduce the behavior Activate Unalterable Archives Set INVOICE_CAN_ALWAYS_BE_REMOVED=1 Create a donation, remove the payment, try to delete the donation with the delete button.  Attached files <img width=""1330"" alt=""Screenshot 2023-07-09 at 12 39 37"" src=""https://github.com/Dolibarr/dolibarr/assets/11063798/5087070f-1e67-42c5-8a4d-46c588681bc5""> other-file",no-bug,0.9
24796,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24796,PROJECT_USE_SEARCH_TO_SELECT doesn't exst in llx_const, Bug Warning: Undefined property: stdClass::$PROJECT_USE_SEARCH_TO_SELECT in htdocs/core/class/html.form.class.php on line 7773  Environment Version develop  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Go to /categories/viewcat.php?id=1  Attached files _No response_,other-file | other-file,PROJECT_USE_SEARCH_TO_SELECT doesn't exst in llx_const  Bug Warning: Undefined property: stdClass::$PROJECT_USE_SEARCH_TO_SELECT in htdocs/core/class/html.form.class.php on line 7773  Environment Version develop  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Go to /categories/viewcat.php?id=1  Attached files _No response_ other-file other-file,no-bug,0.9
28347,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28347,sales order to p.o.," Bug By creating a purchase order from a sales order, even if the purchase prices are correctly entered, the purchase order reflects the sales prices.  Environment Version 19.0.0  Environment OS Linux  Environment Web server Litespeed  Environment PHP 8.2  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior the purchase order should show the purchase prices for that specific supplier, as entered in the product sheet  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"sales order to p.o.  Bug By creating a purchase order from a sales order, even if the purchase prices are correctly entered, the purchase order reflects the sales prices.  Environment Version 19.0.0  Environment OS Linux  Environment Web server Litespeed  Environment PHP 8.2  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior the purchase order should show the purchase prices for that specific supplier, as entered in the product sheet  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.8
25392,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25392,member public new form - Error," Bug Steps 1. Setup Module Members -> Public self-registration form -> select option: Show a table of all available membership types (if no, show directly the registration form) - YES 2. create different Member Types 3. open Public self-registration form url - htdocs/public/members/new.php Errors: Warning: Undefined variable $langs in C:\laragon\www\dolibarr\dolibarr-18.0\htdocs\public\members\new.php on line 172 Warning: Attempt to read property ""defaultlang"" on null in C:\laragon\www\dolibarr\dolibarr-18.0\htdocs\public\members\new.php on line 172 Warning: Undefined variable $ext in C:\laragon\www\dolibarr\dolibarr-18.0\htdocs\public\members\new.php on line 172 ![Screenshot 2023-07-18 at 23-46-49 New contribution](https://github.com/Dolibarr/dolibarr/assets/45215329/a1420bb8-7d26-428a-b778-029a999f8489)  Environment Version 18.0.0  Environment OS _No response_  Environment Web server Apache 2.4.54  Environment PHP 8.1.10  Environment Database MariaDB 8.0.30  Environment URL(s) /htdocs/public/members/new.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"member public new form - Error  Bug Steps 1. Setup Module Members -> Public self-registration form -> select option: Show a table of all available membership types (if no, show directly the registration form) - YES 2. create different Member Types 3. open Public self-registration form url - htdocs/public/members/new.php Errors: Warning: Undefined variable $langs in C:\laragon\www\dolibarr\dolibarr-18.0\htdocs\public\members\new.php on line 172 Warning: Attempt to read property ""defaultlang"" on null in C:\laragon\www\dolibarr\dolibarr-18.0\htdocs\public\members\new.php on line 172 Warning: Undefined variable $ext in C:\laragon\www\dolibarr\dolibarr-18.0\htdocs\public\members\new.php on line 172 ![Screenshot 2023-07-18 at 23-46-49 New contribution](https://github.com/Dolibarr/dolibarr/assets/45215329/a1420bb8-7d26-428a-b778-029a999f8489)  Environment Version 18.0.0  Environment OS _No response_  Environment Web server Apache 2.4.54  Environment PHP 8.1.10  Environment Database MariaDB 8.0.30  Environment URL(s) /htdocs/public/members/new.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
23062,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23062,FIX Third party should get notification upon first ticket creation by email collector class," Feature Request Dolibarr has a other setup key, **TICKET_CHECK_NOTIFY_THIRDPARTY_AT_CREATION**. Upon setting the value **1** to this key, third party gets notification on new ticket creation by Dolibarr users. But when tickets are created first time with the help of **Email Collector Class**, this doesn't happen.  Use case _No response_  Suggested implementation When a third party sends an email to the mailbox of the Email Collector Class, emaill collector class will collect email and creates a ticket. Now if the vale of the key **TICKET_CHECK_NOTIFY_THIRDPARTY_AT_CREATION** is _**1,**_ then third party should get an confirmation email about the new ticket creation.  Suggested steps _No response_",other-file,"FIX Third party should get notification upon first ticket creation by email collector class  Feature Request Dolibarr has a other setup key, **TICKET_CHECK_NOTIFY_THIRDPARTY_AT_CREATION**. Upon setting the value **1** to this key, third party gets notification on new ticket creation by Dolibarr users. But when tickets are created first time with the help of **Email Collector Class**, this doesn't happen.  Use case _No response_  Suggested implementation When a third party sends an email to the mailbox of the Email Collector Class, emaill collector class will collect email and creates a ticket. Now if the vale of the key **TICKET_CHECK_NOTIFY_THIRDPARTY_AT_CREATION** is _**1,**_ then third party should get an confirmation email about the new ticket creation.  Suggested steps _No response_ other-file",no-bug,0.9
27265,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27265,Limits and precision : bad control on MAIN_MAX_DECIMALS_SHOWN," Bug In admin ->limit and precision, it's not allowed to set MAIN_MAX_DECIMALS_TOT>MAIN_MAX_DECIMALS_SHOWN This throws an error and I don't understand why, I think the test is inverted For example, you want the HT totals calculated with 5 digits (when applying VAT afterwards for example), but you want only 2 digits displayed; but that's now impossible It would be more logical to throw and error if MAIN_MAX_DECIMALS_TOT < MAIN_MAX_DECIMALS_SHOWN . Or may be not comparing these 2 values at all  Environment Version all (including develop branch)  Environment OS All  Environment Web server All  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Limits and precision : bad control on MAIN_MAX_DECIMALS_SHOWN  Bug In admin ->limit and precision, it's not allowed to set MAIN_MAX_DECIMALS_TOT>MAIN_MAX_DECIMALS_SHOWN This throws an error and I don't understand why, I think the test is inverted For example, you want the HT totals calculated with 5 digits (when applying VAT afterwards for example), but you want only 2 digits displayed; but that's now impossible It would be more logical to throw and error if MAIN_MAX_DECIMALS_TOT < MAIN_MAX_DECIMALS_SHOWN . Or may be not comparing these 2 values at all  Environment Version all (including develop branch)  Environment OS All  Environment Web server All  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
26668,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26668,Add SPL (socit publique locale) in dict form_juridique, Feature Request Add SPL (socit publique locale) in dict of form_juridique  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,database-file | database-file | database-file | database-file,Add SPL (socit publique locale) in dict form_juridique  Feature Request Add SPL (socit publique locale) in dict of form_juridique  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ database-file database-file database-file database-file,no-bug,0.95
31880,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31880,Serious error in ver 20*," Bug purchase order reception ignore qty if it in decimal only, i tested this error in fresh installation for version 20.0.1 and 20.0.2 and found both version have the same error which not exist in version 19* which work prefect i attached 5 screen shots for the order qty and receiving screen one by one, you will find that the product 3 with qty 0.444 disappeared in final reception screen  Dolibarr Version 20.0.2  Environment PHP PHP 8.1.2-1ubuntu2.19  Environment Database mariadb Ver 15.1 Distrib 10.6.18-MariaDB, for debian-linux-gnu (x86_64) using EditLine wrapper  Steps to reproduce the behavior and expected behavior 1- create purchase order with item qty in only decimal like 0.700 2- complete the reception steps 3- you will find empty reception to validate in the end of reception process  Attached files <img width=""1173"" alt=""Order qty"" src=""https://github.com/user-attachments/assets/2708284c-6ca2-412d-b570-a4c1b03a7963""> <img width=""1173"" alt=""create reception screen 1"" src=""https://github.com/user-attachments/assets/96bcacf0-e1d2-4cec-b5ed-65c75e8f8c63""> <img width=""1173"" alt=""create reception screen 2"" src=""https://github.com/user-attachments/assets/f1c0aacb-ddf5-4529-b895-bb1bd38ef823""> <img width=""1173"" alt=""validate reception"" src=""https://github.com/user-attachments/assets/286052e3-1f29-4532-99ef-693922acec02""> <img width=""1173"" alt=""Reception Validated"" src=""https://github.com/user-attachments/assets/bcbdd4e1-5dfe-4f8d-82dc-68140c52015e"">",other-file | other-file | other-file,"Serious error in ver 20*  Bug purchase order reception ignore qty if it in decimal only, i tested this error in fresh installation for version 20.0.1 and 20.0.2 and found both version have the same error which not exist in version 19* which work prefect i attached 5 screen shots for the order qty and receiving screen one by one, you will find that the product 3 with qty 0.444 disappeared in final reception screen  Dolibarr Version 20.0.2  Environment PHP PHP 8.1.2-1ubuntu2.19  Environment Database mariadb Ver 15.1 Distrib 10.6.18-MariaDB, for debian-linux-gnu (x86_64) using EditLine wrapper  Steps to reproduce the behavior and expected behavior 1- create purchase order with item qty in only decimal like 0.700 2- complete the reception steps 3- you will find empty reception to validate in the end of reception process  Attached files <img width=""1173"" alt=""Order qty"" src=""https://github.com/user-attachments/assets/2708284c-6ca2-412d-b570-a4c1b03a7963""> <img width=""1173"" alt=""create reception screen 1"" src=""https://github.com/user-attachments/assets/96bcacf0-e1d2-4cec-b5ed-65c75e8f8c63""> <img width=""1173"" alt=""create reception screen 2"" src=""https://github.com/user-attachments/assets/f1c0aacb-ddf5-4529-b895-bb1bd38ef823""> <img width=""1173"" alt=""validate reception"" src=""https://github.com/user-attachments/assets/286052e3-1f29-4532-99ef-693922acec02""> <img width=""1173"" alt=""Reception Validated"" src=""https://github.com/user-attachments/assets/bcbdd4e1-5dfe-4f8d-82dc-68140c52015e""> other-file other-file other-file",no-bug,0.8
29622,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29622,Reverse movement," Bug On the movement module, if you check a movement and choose ""reverse"", if you select ""no"" for the action, the movement is still canceled. The ""reverse"" function cancels the movement line but does not recalculate the stock of the item.  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Reverse movement  Bug On the movement module, if you check a movement and choose ""reverse"", if you select ""no"" for the action, the movement is still canceled. The ""reverse"" function cancels the movement line but does not recalculate the stock of the item.  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
24946,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24946,Displaying third-party donors in bank entries, Feature Request Would it be possible to display the Third Parties linked to a bank entry created by a donation in the Third Parties/Users column of the list of bank entries?  Use case See: [https://www.dolibarr.fr/forum/t/liste-des-ecritures-bancaires-et-dons/35062](url)  Suggested implementation _No response_  Suggested steps _No response_,other-file,Displaying third-party donors in bank entries  Feature Request Would it be possible to display the Third Parties linked to a bank entry created by a donation in the Third Parties/Users column of the list of bank entries?  Use case See: [https://www.dolibarr.fr/forum/t/liste-des-ecritures-bancaires-et-dons/35062](url)  Suggested implementation _No response_  Suggested steps _No response_ other-file,no-bug,0.9
33456,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33456,DATAMODEL - Missing share link on link in tab file,See https://github.com/Dolibarr/dolibarr/issues/33316,database-file | database-file | database-file | database-file | other-file | other-file | other-file | other-file,DATAMODEL - Missing share link on link in tab file See https://github.com/Dolibarr/dolibarr/issues/33316 database-file database-file database-file database-file other-file other-file other-file other-file,no-bug,0.7
32259,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32259,Erreur type ligne modle de facturation fournisseur," Bug Bonjour, Lordsque que l'on gnre un modle de facture fournisseur avec un champs libre de type service, celui-ci devient un type produit  la gnration.  Dolibarr Version 20.0.2  Environment PHP 8.2.24  Environment Database MariaDB 10.11.9-MariaDB-0+deb12u1  Steps to reproduce the behavior and expected behavior Crer un modle de facture fournisseur avec un champs de type service et gnrer la facvture voulue => cela devient un type produit.  Attached files ![Screenshot 2024-12-05 at 16 42 03](https://github.com/user-attachments/assets/93e2b9f8-f777-4e31-b8c2-1e07a65f4b98) ![Screenshot 2024-12-05 at 16 43 59](https://github.com/user-attachments/assets/b1d440b5-00c0-4199-90ea-25250bca5eea)",other-file | other-file,"Erreur type ligne modle de facturation fournisseur  Bug Bonjour, Lordsque que l'on gnre un modle de facture fournisseur avec un champs libre de type service, celui-ci devient un type produit  la gnration.  Dolibarr Version 20.0.2  Environment PHP 8.2.24  Environment Database MariaDB 10.11.9-MariaDB-0+deb12u1  Steps to reproduce the behavior and expected behavior Crer un modle de facture fournisseur avec un champs de type service et gnrer la facvture voulue => cela devient un type produit.  Attached files ![Screenshot 2024-12-05 at 16 42 03](https://github.com/user-attachments/assets/93e2b9f8-f777-4e31-b8c2-1e07a65f4b98) ![Screenshot 2024-12-05 at 16 43 59](https://github.com/user-attachments/assets/b1d440b5-00c0-4199-90ea-25250bca5eea) other-file other-file",no-bug,0.9
33424,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33424,Create cronjob security key not posible in version 20 and higher,"We have an live installation with version 19, here we can create/refresh the cronjob Security key. Our test installation has version is 20, here we are not able to create an cronjob Security key. To find out if there was an setup problem, i put an new installation in an subdomain, here is what i found: git install version 19, only enable cronjobs and check for the button (yes it is there). delete all DB tables checkout version 20, only enable cronjobs and check for the button (no it is not there). Version 21 has the same result as version 20. Only cronjobs have been enabled no other settings have been changed, an real clean install. In version 19 on the page ""Home > Modules/Applications > Scheduled jobs > Miscellaneous"" there is a button to create an new Security key. The constant `CRON_DISABLE_KEY_CHANGE` is not present in de DB In version 20 the create button is not present and the `CRON_DISABLE_KEY_CHANGE` is also not present in the DB. I MUST add the constant. I added it in ""Home > Modules/Applications > Other Setup"" name `CRON_DISABLE_KEY_CHANGE` with value of `0`. If i understand it correct there has been an change in: `/htdocs/cron/admin/cron.php` after version 19. This is the only file that this constant is used (i could not find an other one). I assume that there now should be a entry add in `llx_const` with the setting i used above. If the constant is not added, the please update the docs to punt to this. My problem is solved for this installation, but other will also have an hard time finding out what is going on. It toke me more then two days, reading tickets, documentation and forms.",other-file | other-file | other-file,"Create cronjob security key not posible in version 20 and higher We have an live installation with version 19, here we can create/refresh the cronjob Security key. Our test installation has version is 20, here we are not able to create an cronjob Security key. To find out if there was an setup problem, i put an new installation in an subdomain, here is what i found: git install version 19, only enable cronjobs and check for the button (yes it is there). delete all DB tables checkout version 20, only enable cronjobs and check for the button (no it is not there). Version 21 has the same result as version 20. Only cronjobs have been enabled no other settings have been changed, an real clean install. In version 19 on the page ""Home > Modules/Applications > Scheduled jobs > Miscellaneous"" there is a button to create an new Security key. The constant `CRON_DISABLE_KEY_CHANGE` is not present in de DB In version 20 the create button is not present and the `CRON_DISABLE_KEY_CHANGE` is also not present in the DB. I MUST add the constant. I added it in ""Home > Modules/Applications > Other Setup"" name `CRON_DISABLE_KEY_CHANGE` with value of `0`. If i understand it correct there has been an change in: `/htdocs/cron/admin/cron.php` after version 19. This is the only file that this constant is used (i could not find an other one). I assume that there now should be a entry add in `llx_const` with the setting i used above. If the constant is not added, the please update the docs to punt to this. My problem is solved for this installation, but other will also have an hard time finding out what is going on. It toke me more then two days, reading tickets, documentation and forms. other-file other-file other-file",no-bug,0.9
30772,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30772,Accounting/Export source documents Project filter is NOT working.," Bug In the Export source documents at the Accouting menu. When using the **Project** filter, the output is just **Miscellaneous payment** which is last one in the checked list. <img width=""1079"" alt=""image"" src=""https://github.com/user-attachments/assets/af5c0fdb-449c-4c26-ad96-7e3b0431ef56""> I can get other lists when I use **no filter.** <img width=""915"" alt=""image"" src=""https://github.com/user-attachments/assets/ecb38a57-64f9-4e0f-a7ca-bfd366c4182a"">  Dolibarr Version 19.0.1  Environment PHP 8.2.7  Environment Database MariaDB 11.0.2  Steps to reproduce the behavior and expected behavior The source documents shoud be showed with **Project filter**  Attached files _No response_",other-file | other-file,"Accounting/Export source documents Project filter is NOT working.  Bug In the Export source documents at the Accouting menu. When using the **Project** filter, the output is just **Miscellaneous payment** which is last one in the checked list. <img width=""1079"" alt=""image"" src=""https://github.com/user-attachments/assets/af5c0fdb-449c-4c26-ad96-7e3b0431ef56""> I can get other lists when I use **no filter.** <img width=""915"" alt=""image"" src=""https://github.com/user-attachments/assets/ecb38a57-64f9-4e0f-a7ca-bfd366c4182a"">  Dolibarr Version 19.0.1  Environment PHP 8.2.7  Environment Database MariaDB 11.0.2  Steps to reproduce the behavior and expected behavior The source documents shoud be showed with **Project filter**  Attached files _No response_ other-file other-file",no-bug,0.8
26291,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26291,Supplier on payment is wrong, Bug Supplier is wrong on /fourn/paiement/document.php Full details on https://www.dolibarr.fr/forum/t/probleme-fichier-joint-sur-reglement-fournisseur-sur-v18-02/44508  Environment Version 18.0.2 and above  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected behavior : correct supplier to be displayed on the payment page Actual behavior : wrong supplier displayed on the payment page  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file,Supplier on payment is wrong  Bug Supplier is wrong on /fourn/paiement/document.php Full details on https://www.dolibarr.fr/forum/t/probleme-fichier-joint-sur-reglement-fournisseur-sur-v18-02/44508  Environment Version 18.0.2 and above  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected behavior : correct supplier to be displayed on the payment page Actual behavior : wrong supplier displayed on the payment page  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file,no-bug,0.7
25983,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25983,"Bug - Cannot create payment mode dictionary entry - ""Field 'entity' is required"""," Bug Since 18.0.x it's no longer possible to create a payment mode (under `/admin/dict.php?id=13`). An error is shown: `Field 'entity' is required`  Environment Version 18.0.x  Environment OS Debian 12.1  Environment Web server _No response_  Environment PHP 7.4.33  Environment Database MySQL 8.0.33  Environment URL(s) _No response_  Expected and actual behavior Expected: Payment mode is created Actual: Payment mode cannot be created as Dolibarr is not populating the mandatory `entity` database field correctly.  Steps to reproduce the behavior In an environment with no additional modules (i.e. no multicompany support added): 1. Navigate to the ""Payment modes"" dictionary page (`/admin/dict.php?id=13`) 2. Create a new payment mode, i.e. code `TEST`, label `Test`, type `Payment Type - Customer and Vendor`, click 'ADD"" 3. Observe: Error is shown: `Field 'entity' is required`  Attached files _No response_",other-file,"Bug - Cannot create payment mode dictionary entry - ""Field 'entity' is required""  Bug Since 18.0.x it's no longer possible to create a payment mode (under `/admin/dict.php?id=13`). An error is shown: `Field 'entity' is required`  Environment Version 18.0.x  Environment OS Debian 12.1  Environment Web server _No response_  Environment PHP 7.4.33  Environment Database MySQL 8.0.33  Environment URL(s) _No response_  Expected and actual behavior Expected: Payment mode is created Actual: Payment mode cannot be created as Dolibarr is not populating the mandatory `entity` database field correctly.  Steps to reproduce the behavior In an environment with no additional modules (i.e. no multicompany support added): 1. Navigate to the ""Payment modes"" dictionary page (`/admin/dict.php?id=13`) 2. Create a new payment mode, i.e. code `TEST`, label `Test`, type `Payment Type - Customer and Vendor`, click 'ADD"" 3. Observe: Error is shown: `Field 'entity' is required`  Attached files _No response_ other-file",no-bug,0.9
24102,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24102,Manual addition of invoice lines on time spent in tasks," Feature Request Allow to add billing in past time  Use case Time spent invoices can be made without the relation to time in task. It must be possible to assign them afterwards in order to allow a future calculation of ROI on the time invoiced.  Suggested implementation ![image](https://user-images.githubusercontent.com/3288514/222674692-6c9ca4b4-7133-42ce-83f4-d094b55263fd.png) ![image](https://user-images.githubusercontent.com/3288514/222675993-92177bb1-0f55-40d0-a64d-40b96cd288c6.png)  Suggested steps - [ ] Add select invoice - [ ] Add ligne invoice - [ ] Add informations of facture line (Quantity, Amount)",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Manual addition of invoice lines on time spent in tasks  Feature Request Allow to add billing in past time  Use case Time spent invoices can be made without the relation to time in task. It must be possible to assign them afterwards in order to allow a future calculation of ROI on the time invoiced.  Suggested implementation ![image](https://user-images.githubusercontent.com/3288514/222674692-6c9ca4b4-7133-42ce-83f4-d094b55263fd.png) ![image](https://user-images.githubusercontent.com/3288514/222675993-92177bb1-0f55-40d0-a64d-40b96cd288c6.png)  Suggested steps - [ ] Add select invoice - [ ] Add ligne invoice - [ ] Add informations of facture line (Quantity, Amount) other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
24877,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24877,DB_ERROR_NOSUCHFIELD 'status' in 'where clause'," Bug Hello, I have an issu that I can't fix. Is anybody can help ? Thanks in advance. Dolibarr a dtect une erreur technique. Ces informations peuvent tre utiles  des fins de diagnostic (vous pouvez dfinir l'option $dolibarr_main_prod sur '1' pour masquer les informations sensibles): Date: 20230525124329 Dolibarr: 17.0.1 - https://www.dolibarr.org Niveau de fonctionnalits: 0 PHP: 7.4.33 Server: Apache OS: Linux webd003.cluster021.gra.hosting.ovh.net 5.15.80-ovh-vps-grsec-zfs-classid #1 SMP Wed Nov 30 08:49:06 UTC 2022 x86_64 User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.5 Safari/605.1.15 Url sollicite: /htdocs/product/stock/list.php?leftmenu= Gestionnaire de menu: eldy_menu.php Modules/Applications: user, syslog, supplier_proposal, agenda, barcode, fckeditor, cron, commande, ecm, facture, fournisseur, margin, printing, service, societe, categorie, projet, bom, propal, mrp, debugbar, bookmark, expedition, incoterm, workflow, product, stock, reception, productbatch, notification Type gestionnaire de base de donnes: mysqli Requte dernier accs en base en erreur: SELECT t.rowid, t.ref,t.lieu FROM llx_entrepot as t WHERE 1=1 AND t.entity IN (1) AND ((status = 1 AND entity IN (1 ORDER BY t.ref ASC, t.lieu ASC Code retour dernier accs en base en erreur: DB_ERROR_NOSUCHFIELD Information sur le dernier accs en base en erreur: Unknown column 'status' in 'where clause'  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"DB_ERROR_NOSUCHFIELD 'status' in 'where clause'  Bug Hello, I have an issu that I can't fix. Is anybody can help ? Thanks in advance. Dolibarr a dtect une erreur technique. Ces informations peuvent tre utiles  des fins de diagnostic (vous pouvez dfinir l'option $dolibarr_main_prod sur '1' pour masquer les informations sensibles): Date: 20230525124329 Dolibarr: 17.0.1 - https://www.dolibarr.org Niveau de fonctionnalits: 0 PHP: 7.4.33 Server: Apache OS: Linux webd003.cluster021.gra.hosting.ovh.net 5.15.80-ovh-vps-grsec-zfs-classid #1 SMP Wed Nov 30 08:49:06 UTC 2022 x86_64 User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.5 Safari/605.1.15 Url sollicite: /htdocs/product/stock/list.php?leftmenu= Gestionnaire de menu: eldy_menu.php Modules/Applications: user, syslog, supplier_proposal, agenda, barcode, fckeditor, cron, commande, ecm, facture, fournisseur, margin, printing, service, societe, categorie, projet, bom, propal, mrp, debugbar, bookmark, expedition, incoterm, workflow, product, stock, reception, productbatch, notification Type gestionnaire de base de donnes: mysqli Requte dernier accs en base en erreur: SELECT t.rowid, t.ref,t.lieu FROM llx_entrepot as t WHERE 1=1 AND t.entity IN (1) AND ((status = 1 AND entity IN (1 ORDER BY t.ref ASC, t.lieu ASC Code retour dernier accs en base en erreur: DB_ERROR_NOSUCHFIELD Information sur le dernier accs en base en erreur: Unknown column 'status' in 'where clause'  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
33090,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33090,EEC/EU and SEPA zones are mixed in Bank transferts files," Bug EEC (now EU) is mixed up with SEPA zone for bank transfert files. The SEPA Zone [contains other countries than EU (former EEC), such as Switzerland](https://www.ecb.europa.eu/paym/integration/retail/sepa/html/index.en.html). As a results, banks in those countries accept SEPA mandates, while Dolibarr output an error and do not generate the files. One should replace `/htdocs/compta/prelevement/class/bonprelevement.class.php` line `1827` (in develop) call to `isInEEC` by a newly create `isInSEPA`. Calls to `isInEEC` are still valids for VAT purposes. While I think EEC should be replaced by EU. Ideally, we should link to the bank account. Must also be corrected in: - htdocs/compta/prelevement/class/bonprelevement.class.php - 1827 - htdocs/compta/bank/card.php - 609, 867, 1210 - htdocs/compta/prelevement/create.php - 328, 350 New function is expected in `htdocs/societe/class/societe.class.php` around 4277)  Dolibarr Version 14 at least  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file,"EEC/EU and SEPA zones are mixed in Bank transferts files  Bug EEC (now EU) is mixed up with SEPA zone for bank transfert files. The SEPA Zone [contains other countries than EU (former EEC), such as Switzerland](https://www.ecb.europa.eu/paym/integration/retail/sepa/html/index.en.html). As a results, banks in those countries accept SEPA mandates, while Dolibarr output an error and do not generate the files. One should replace `/htdocs/compta/prelevement/class/bonprelevement.class.php` line `1827` (in develop) call to `isInEEC` by a newly create `isInSEPA`. Calls to `isInEEC` are still valids for VAT purposes. While I think EEC should be replaced by EU. Ideally, we should link to the bank account. Must also be corrected in: - htdocs/compta/prelevement/class/bonprelevement.class.php - 1827 - htdocs/compta/bank/card.php - 609, 867, 1210 - htdocs/compta/prelevement/create.php - 328, 350 New function is expected in `htdocs/societe/class/societe.class.php` around 4277)  Dolibarr Version 14 at least  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file",no-bug,0.9
32374,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32374,[20.0.2][pgsql] SQL Error accountancy/journal/purchasesjournal.php," Bug SQL error on the purchase journal.  Dolibarr Version 20.0.2  Environment PHP 8.2  Environment Database Postgresql 15  Steps to reproduce the behavior and expected behavior No transactions done, empty instance installed on postgresql. - create fiscal year - go to the purchase journal  Attached files  Dec 15 16:01:33: dolibarr[98]: 33 sql=SELECT f.rowid, f.ref as ref, f.type, f.datef as df, f.libelle as label, f.ref_supplier, f.date_lim_reglement as dlr, f.close_code, f.vat_reverse_charge, fd.rowid as fdid, fd.description, fd.product_type, fd.total_ht, fd.tva as total_tva, fd.total_localtax1, fd.total_localtax2, fd.tva_tx, fd.total_ttc, fd.vat_src_code, fd.info_bits, p.default_vat_code AS product_buy_default_vat_code, p.tva_tx as product_buy_vat, p.localtax1_tx as product_buy_localvat1, p.localtax2_tx as product_buy_localvat2, co.code as country_code, co.label as country_label, s.rowid as socid, s.nom as name, s.fournisseur, s.code_client, s.code_fournisseur, s.fk_pays, s.code_compta as code_compta, s.code_compta_fournisseur, p.accountancy_code_buy, aa.rowid as fk_compte, aa.account_number as compte, aa.label as label_compte FROM llx_facture_fourn_det as fd LEFT JOIN llx_product as p ON p.rowid = fd.fk_product LEFT JOIN llx_accounting_account as aa ON aa.rowid = fd.fk_code_ventilation JOIN llx_facture_fourn as f ON f.rowid = fd.fk_facture_fourn JOIN llx_societe as s ON s.rowid = f.fk_soc LEFT JOIN llx_c_country as co ON co.rowid = s.fk_pays WHERE f.fk_statut > 0 AND fd.fk_code_ventilation > 0 AND f.entity IN (1) AND f.type IN (0,1,2,3,5) AND f.datef >= '2024-01-01 00:00:00' AND f.datef <= '2024-12-31 23:59:59' AND f.rowid NOT IN (SELECT fk_doc FROM llx_accounting_bookkeeping as ab WHERE ab.doc_type='supplier_invoice') ORDER BY f.datef Dec 15 16:01:33: dolibarr[98]: 33 sql=SELECT cc.code FROM llx_c_country as cc WHERE cc.eec = 1 Dec 15 16:01:33: dolibarr[98]: 33 sql=SELECT Dec 15 16:01:33: dolibarr[98]: fk_facture_fourn, Dec 15 16:01:33: dolibarr[98]: COUNT(fd.rowid) as nb Dec 15 16:01:33: dolibarr[98]: FROM Dec 15 16:01:33: dolibarr[98]: llx_facture_fourn_det as fd Dec 15 16:01:33: dolibarr[98]: WHERE Dec 15 16:01:33: dolibarr[98]: fd.product_type <= 2 Dec 15 16:01:33: dolibarr[98]: AND fd.fk_code_ventilation <= 0 Dec 15 16:01:33: dolibarr[98]: AND fd.total_ttc <> 0 Dec 15 16:01:33: dolibarr[98]: \x09AND fk_facture_fourn IN () Dec 15 16:01:33: dolibarr[98]: GROUP BY fk_facture_fourn Dec 15 16:01:33: dolibarr[98]: 33 DoliDBPgsql::query SQL Error message: ERROR: 42601: syntax error at or near "")"" Dec 15 16:01:33: dolibarr[98]: LINE 10: AND fk_facture_fourn IN () Dec 15 16:01:33: dolibarr[98]: ^ Dec 15 16:01:33: dolibarr[98]: LOCATION: scanner_yyerror, scan.l:1188 (DB_ERROR_SYNTAX) Dec 15 16:01:33: 172.22.0.3 - 15/Dec/2024:16:01:33 +0000 ""GET /accountancy/journal/purchasesjournal.php"" 500 Dec 15 16:01:33: dolibarr[98]: 33 DoliDBPgsql::query SQL Error usesavepoint = 0 Dec 15 16:01:33: dolibarr[98]: 33  End access to /accountancy/journal/purchasesjournal.php ",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"[20.0.2][pgsql] SQL Error accountancy/journal/purchasesjournal.php  Bug SQL error on the purchase journal.  Dolibarr Version 20.0.2  Environment PHP 8.2  Environment Database Postgresql 15  Steps to reproduce the behavior and expected behavior No transactions done, empty instance installed on postgresql. - create fiscal year - go to the purchase journal  Attached files  Dec 15 16:01:33: dolibarr[98]: 33 sql=SELECT f.rowid, f.ref as ref, f.type, f.datef as df, f.libelle as label, f.ref_supplier, f.date_lim_reglement as dlr, f.close_code, f.vat_reverse_charge, fd.rowid as fdid, fd.description, fd.product_type, fd.total_ht, fd.tva as total_tva, fd.total_localtax1, fd.total_localtax2, fd.tva_tx, fd.total_ttc, fd.vat_src_code, fd.info_bits, p.default_vat_code AS product_buy_default_vat_code, p.tva_tx as product_buy_vat, p.localtax1_tx as product_buy_localvat1, p.localtax2_tx as product_buy_localvat2, co.code as country_code, co.label as country_label, s.rowid as socid, s.nom as name, s.fournisseur, s.code_client, s.code_fournisseur, s.fk_pays, s.code_compta as code_compta, s.code_compta_fournisseur, p.accountancy_code_buy, aa.rowid as fk_compte, aa.account_number as compte, aa.label as label_compte FROM llx_facture_fourn_det as fd LEFT JOIN llx_product as p ON p.rowid = fd.fk_product LEFT JOIN llx_accounting_account as aa ON aa.rowid = fd.fk_code_ventilation JOIN llx_facture_fourn as f ON f.rowid = fd.fk_facture_fourn JOIN llx_societe as s ON s.rowid = f.fk_soc LEFT JOIN llx_c_country as co ON co.rowid = s.fk_pays WHERE f.fk_statut > 0 AND fd.fk_code_ventilation > 0 AND f.entity IN (1) AND f.type IN (0,1,2,3,5) AND f.datef >= '2024-01-01 00:00:00' AND f.datef <= '2024-12-31 23:59:59' AND f.rowid NOT IN (SELECT fk_doc FROM llx_accounting_bookkeeping as ab WHERE ab.doc_type='supplier_invoice') ORDER BY f.datef Dec 15 16:01:33: dolibarr[98]: 33 sql=SELECT cc.code FROM llx_c_country as cc WHERE cc.eec = 1 Dec 15 16:01:33: dolibarr[98]: 33 sql=SELECT Dec 15 16:01:33: dolibarr[98]: fk_facture_fourn, Dec 15 16:01:33: dolibarr[98]: COUNT(fd.rowid) as nb Dec 15 16:01:33: dolibarr[98]: FROM Dec 15 16:01:33: dolibarr[98]: llx_facture_fourn_det as fd Dec 15 16:01:33: dolibarr[98]: WHERE Dec 15 16:01:33: dolibarr[98]: fd.product_type <= 2 Dec 15 16:01:33: dolibarr[98]: AND fd.fk_code_ventilation <= 0 Dec 15 16:01:33: dolibarr[98]: AND fd.total_ttc <> 0 Dec 15 16:01:33: dolibarr[98]: \x09AND fk_facture_fourn IN () Dec 15 16:01:33: dolibarr[98]: GROUP BY fk_facture_fourn Dec 15 16:01:33: dolibarr[98]: 33 DoliDBPgsql::query SQL Error message: ERROR: 42601: syntax error at or near "")"" Dec 15 16:01:33: dolibarr[98]: LINE 10: AND fk_facture_fourn IN () Dec 15 16:01:33: dolibarr[98]: ^ Dec 15 16:01:33: dolibarr[98]: LOCATION: scanner_yyerror, scan.l:1188 (DB_ERROR_SYNTAX) Dec 15 16:01:33: 172.22.0.3 - 15/Dec/2024:16:01:33 +0000 ""GET /accountancy/journal/purchasesjournal.php"" 500 Dec 15 16:01:33: dolibarr[98]: 33 DoliDBPgsql::query SQL Error usesavepoint = 0 Dec 15 16:01:33: dolibarr[98]: 33  End access to /accountancy/journal/purchasesjournal.php  other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
32352,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32352,Impossible to upload file with firefox, Bug When we upload a file on any document page with firefox navigator the navigator change page instead of opening file form. Same for URL form.  Dolibarr Version develop  Environment PHP 8.4  Environment Database _No response_  Steps to reproduce the behavior and expected behavior - Open any module document page - click on + button to open file form - See that firefox navigate to a page instead of opening file form Same behavior for URL form  Attached files _No response_,other-file | other-file,Impossible to upload file with firefox  Bug When we upload a file on any document page with firefox navigator the navigator change page instead of opening file form. Same for URL form.  Dolibarr Version develop  Environment PHP 8.4  Environment Database _No response_  Steps to reproduce the behavior and expected behavior - Open any module document page - click on + button to open file form - See that firefox navigate to a page instead of opening file form Same behavior for URL form  Attached files _No response_ other-file other-file,no-bug,0.9
33689,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33689,API > supplierorders > post lines not working, Bug @mdeweerd : in commit 035ede5 the function post() in api_supplier_order.class.php has been modified at the beginning `// Check mandatory fields` `$request_data = $this->_validate($request_data);` where we previously we had `$result = $this->_validate($request_data);` this breaks the function to import lines order for me  Dolibarr Version develop  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file | other-file | other-file | other-file | other-file | other-file,API > supplierorders > post lines not working  Bug @mdeweerd : in commit 035ede5 the function post() in api_supplier_order.class.php has been modified at the beginning `// Check mandatory fields` `$request_data = $this->_validate($request_data);` where we previously we had `$result = $this->_validate($request_data);` this breaks the function to import lines order for me  Dolibarr Version develop  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file,bug,0.9
30945,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30945,Missing reccurring invoice listing, Feature Request Add listing reccurring invoices like custumer ![image](https://github.com/user-attachments/assets/8e2e36dc-a999-4190-b8d1-199351069932) Like ![image](https://github.com/user-attachments/assets/87677e03-447c-43a3-a6cc-c45b5a86dabe),other-file | other-file | other-file | other-file,Missing reccurring invoice listing  Feature Request Add listing reccurring invoices like custumer ![image](https://github.com/user-attachments/assets/8e2e36dc-a999-4190-b8d1-199351069932) Like ![image](https://github.com/user-attachments/assets/87677e03-447c-43a3-a6cc-c45b5a86dabe) other-file other-file other-file other-file,no-bug,0.9
32892,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32892,Emailcollector does not update status of tickets when receiving a new message for a ticket," Bug Emailcollector does not update status of tickets when receiving a new message for a ticket when status of ticket is: * STATUS_NEED_MORE_INFO * STATUS_WAITING  Dolibarr Version 20.0  Environment PHP PHP 8.x  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Setup Emailcollector and enable Collect_Response_Incoming 2. Enable Ticket Module and create a ticket (eg via public interface). Ticket creator receives an email with information, that ticket is opened 3. Set the ticket status to either ""on hold"" or ""waiting for feedback"" 4. Send a reply to this email with some additional information The status of the ticket should change to ""assigned"" or ""unread""  Attached files _No response_",other-file | other-file,"Emailcollector does not update status of tickets when receiving a new message for a ticket  Bug Emailcollector does not update status of tickets when receiving a new message for a ticket when status of ticket is: * STATUS_NEED_MORE_INFO * STATUS_WAITING  Dolibarr Version 20.0  Environment PHP PHP 8.x  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Setup Emailcollector and enable Collect_Response_Incoming 2. Enable Ticket Module and create a ticket (eg via public interface). Ticket creator receives an email with information, that ticket is opened 3. Set the ticket status to either ""on hold"" or ""waiting for feedback"" 4. Send a reply to this email with some additional information The status of the ticket should change to ""assigned"" or ""unread""  Attached files _No response_ other-file other-file",no-bug,0.9
32894,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32894,Confirmation email missing when ticket is created via Emailcollector, Bug Confirmation email missing when ticket is created via Emailcollector The feature is implemented in core/triggers/interface_50_modTicket_TicketEmail.class.php but missing in emailcollector/class/emailcollector.class.php  Dolibarr Version 20.0  Environment PHP PHP 8.x  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Configure module Emailcollector to receive mails and create tickets 2. Send an email with to the configured address There is no confirmation mail to the sender. Therefore the sender also does not get information how to access the ticket via the public interface to see status updates  Attached files _No response_,other-file | other-file,Confirmation email missing when ticket is created via Emailcollector  Bug Confirmation email missing when ticket is created via Emailcollector The feature is implemented in core/triggers/interface_50_modTicket_TicketEmail.class.php but missing in emailcollector/class/emailcollector.class.php  Dolibarr Version 20.0  Environment PHP PHP 8.x  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Configure module Emailcollector to receive mails and create tickets 2. Send an email with to the configured address There is no confirmation mail to the sender. Therefore the sender also does not get information how to access the ticket via the public interface to see status updates  Attached files _No response_ other-file other-file,no-bug,0.9
28938,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28938,Prelevement prefix table in card.php," Bug My tables prefix isn't llx. I have a error with htdocs/compta/prelevement/card.ph in line 463 $sql .= "" FROM llx_prelevement_lignes as pl""; I think should be $sql .="" FROM "".MAIN_DB_PREFIX.""prelevement_lignes as pl"";  Dolibarr Version 19.0.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"Prelevement prefix table in card.php  Bug My tables prefix isn't llx. I have a error with htdocs/compta/prelevement/card.ph in line 463 $sql .= "" FROM llx_prelevement_lignes as pl""; I think should be $sql .="" FROM "".MAIN_DB_PREFIX.""prelevement_lignes as pl"";  Dolibarr Version 19.0.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.9
29403,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29403,Unable to delete a skill in the job profile," Bug it's impossible to delete a skill in the list for a job profile. when you click on the trash; there is a message ""skill delete Ok"" but nothing happens. the skill is always in the list ![delete-skill](https://github.com/Dolibarr/dolibarr/assets/167513680/039cd676-ecef-4af1-96df-15388406b5ea)  Dolibarr Version 19.0.1  Environment PHP 8.0.23  Environment Database MySQL or MariaDB 10.3.32-MariaDB  Steps to reproduce the behavior and expected behavior In GRH module / evaluation create a new job profile add skills try to delete skill in the list  Attached files ![delete-skill](https://github.com/Dolibarr/dolibarr/assets/167513680/6cfd5181-0669-46df-bfc9-cd10b6d772ba)",other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Unable to delete a skill in the job profile  Bug it's impossible to delete a skill in the list for a job profile. when you click on the trash; there is a message ""skill delete Ok"" but nothing happens. the skill is always in the list ![delete-skill](https://github.com/Dolibarr/dolibarr/assets/167513680/039cd676-ecef-4af1-96df-15388406b5ea)  Dolibarr Version 19.0.1  Environment PHP 8.0.23  Environment Database MySQL or MariaDB 10.3.32-MariaDB  Steps to reproduce the behavior and expected behavior In GRH module / evaluation create a new job profile add skills try to delete skill in the list  Attached files ![delete-skill](https://github.com/Dolibarr/dolibarr/assets/167513680/6cfd5181-0669-46df-bfc9-cd10b6d772ba) other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.7
29782,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29782,"No option for creating purhcase order from sales order, for some cases only"," Bug There is a feature that makes it possible to create a purchase order directly from the sales order, but is same cases that option does not appear, and I can't see any pattern in this behavior. I can't say anything else than sometimes the option is not there.  Dolibarr Version 19.0.2  Environment PHP 7.4  Environment Database MariaDB version 10.11.6  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"No option for creating purhcase order from sales order, for some cases only  Bug There is a feature that makes it possible to create a purchase order directly from the sales order, but is same cases that option does not appear, and I can't see any pattern in this behavior. I can't say anything else than sometimes the option is not there.  Dolibarr Version 19.0.2  Environment PHP 7.4  Environment Database MariaDB version 10.11.6  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
24367,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24367,No automatic end date of membership," Bug The end date of membership is not calculated accordingly to the membership duration.  Environment Version 16.0.5  Environment OS Linux 5.15.0-69 (Kubuntu)  Environment Web server Apache/2.4.52  Environment PHP 8.1.2-1ubuntu2  Environment Database MariaDB 5.5.5-10.6.12-MariaDB-0ubuntu0.22.04.1  Environment URL(s) _No response_  Expected and actual behavior In the member module, I created several member types : one for each payment frequency (monthly, quarterly, etc.), and I filled the _duration_ field accordingly. When I register a contribution, the _end date of membership_ is supposed to be calculated automatically when left empty. But instead of this, it registers the membership for one year, no matter the membership duration.  Steps to reproduce the behavior Happens every time.  Attached files ![image](https://user-images.githubusercontent.com/77627672/228382601-e240ae59-e209-4c40-9816-ae4a0c2ab563.png) ![image](https://user-images.githubusercontent.com/77627672/228382844-4c505ffe-0171-4d1f-a014-1f4739aa341f.png) ![image](https://user-images.githubusercontent.com/77627672/228383053-1ede58de-5469-41c0-88ad-c01e1bc6f301.png)",other-file | other-file | other-file | other-file,"No automatic end date of membership  Bug The end date of membership is not calculated accordingly to the membership duration.  Environment Version 16.0.5  Environment OS Linux 5.15.0-69 (Kubuntu)  Environment Web server Apache/2.4.52  Environment PHP 8.1.2-1ubuntu2  Environment Database MariaDB 5.5.5-10.6.12-MariaDB-0ubuntu0.22.04.1  Environment URL(s) _No response_  Expected and actual behavior In the member module, I created several member types : one for each payment frequency (monthly, quarterly, etc.), and I filled the _duration_ field accordingly. When I register a contribution, the _end date of membership_ is supposed to be calculated automatically when left empty. But instead of this, it registers the membership for one year, no matter the membership duration.  Steps to reproduce the behavior Happens every time.  Attached files ![image](https://user-images.githubusercontent.com/77627672/228382601-e240ae59-e209-4c40-9816-ae4a0c2ab563.png) ![image](https://user-images.githubusercontent.com/77627672/228382844-4c505ffe-0171-4d1f-a014-1f4739aa341f.png) ![image](https://user-images.githubusercontent.com/77627672/228383053-1ede58de-5469-41c0-88ad-c01e1bc6f301.png) other-file other-file other-file other-file",no-bug,0.9
29103,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29103,Module builder : Error in the export model," Bug Tiny error. In the builder module, suggestions are offered by default. Just remove the comments for this to work. Except for this line: //$this->export_sql_end[$r] =' LEFT JOIN '.MAIN_DB_PREFIX.'competence_line as tl ON tl.fk_competence = t.rowid'; A ""point"" is missing before the ""equal"": //$this->export_sql_end[$r] .=' LEFT JOIN '.MAIN_DB_PREFIX.'competence_line as tl ON tl.fk_competence = t.rowid'; The problem is the overwriting of part of the query, if we want to couple other tables. Tiny error, but will improve the no-code module. Thanks!  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior ourmodule**/core/modules/**modObject**.class.php**  Attached files _No response_",other-file | other-file,"Module builder : Error in the export model  Bug Tiny error. In the builder module, suggestions are offered by default. Just remove the comments for this to work. Except for this line: //$this->export_sql_end[$r] =' LEFT JOIN '.MAIN_DB_PREFIX.'competence_line as tl ON tl.fk_competence = t.rowid'; A ""point"" is missing before the ""equal"": //$this->export_sql_end[$r] .=' LEFT JOIN '.MAIN_DB_PREFIX.'competence_line as tl ON tl.fk_competence = t.rowid'; The problem is the overwriting of part of the query, if we want to couple other tables. Tiny error, but will improve the no-code module. Thanks!  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior ourmodule**/core/modules/**modObject**.class.php**  Attached files _No response_ other-file other-file",no-bug,0.9
29294,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29294,Warning in accountancy journals," Bug There are multiple warning in sells, purchses, or bankjournal page of accountancy module. I see them when option 'display_errors=On' is active in my php.ini file, it's basically undefined array key, it's still working correctly but I think it deserves to be fix.  Dolibarr Version 19.0.1  Environment PHP 8.1.25  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files ![Screenshot from 2024-04-09 13-08-07](https://github.com/Dolibarr/dolibarr/assets/114406707/c16398bb-b0d0-427f-83b3-dc0107b589b0)",other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Warning in accountancy journals  Bug There are multiple warning in sells, purchses, or bankjournal page of accountancy module. I see them when option 'display_errors=On' is active in my php.ini file, it's basically undefined array key, it's still working correctly but I think it deserves to be fix.  Dolibarr Version 19.0.1  Environment PHP 8.1.25  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files ![Screenshot from 2024-04-09 13-08-07](https://github.com/Dolibarr/dolibarr/assets/114406707/c16398bb-b0d0-427f-83b3-dc0107b589b0) other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
30187,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30187,BUG: Missing columns in BOM-Card if stockmanagement for services is active," Bug If the stockmanagement for services is active we can't configure the BOM correct: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/281308c9-8b88-413a-a92d-a25dd2398c15)  Dolibarr Version 19.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Activate Moduls: Services, Stock 2. Switch ""Stock management supports Services"" in the stock module to active. ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/4a479cd0-380d-4fbe-8f35-c906ac70ad78) 3. Create a BOM => you can't set the Frozen Qty, Stock change disabled and Manufacturing efficiency (no columns visible).  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"BUG: Missing columns in BOM-Card if stockmanagement for services is active  Bug If the stockmanagement for services is active we can't configure the BOM correct: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/281308c9-8b88-413a-a92d-a25dd2398c15)  Dolibarr Version 19.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Activate Moduls: Services, Stock 2. Switch ""Stock management supports Services"" in the stock module to active. ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/4a479cd0-380d-4fbe-8f35-c906ac70ad78) 3. Create a BOM => you can't set the Frozen Qty, Stock change disabled and Manufacturing efficiency (no columns visible).  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
31724,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31724,"TakePOS : Undefined variable $servicestatus in pay.php on lines 126, 368 and 392 when stripe is not enabled"," Bug Hi, The `$servicestatus` var is undefined on lines 126, 368 and 392 in `pay.php` when the 'stripe' module is disabled. Indeed, the `$servicestatus` var is defined in the `if (isModEnabled('stripe')){}` conditional block in between lines 87 and 147. This causes side effects such as the payment pad becoming unusable because the `addreceived()` function is no longer in scope.  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"TakePOS : Undefined variable $servicestatus in pay.php on lines 126, 368 and 392 when stripe is not enabled  Bug Hi, The `$servicestatus` var is undefined on lines 126, 368 and 392 in `pay.php` when the 'stripe' module is disabled. Indeed, the `$servicestatus` var is defined in the `if (isModEnabled('stripe')){}` conditional block in between lines 87 and 147. This causes side effects such as the payment pad becoming unusable because the `addreceived()` function is no longer in scope.  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
26871,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26871,Double discount on updateline in contract," Bug When you update a line on a contract to change the discount, the discount is applied twice.  Environment Version 17, 18  Environment OS Debian  Environment Web server Apache  Environment PHP php 8.0  Environment Database mysql  Environment URL(s) _No response_  Expected and actual behavior 1. create a contract 2. add a line 3. save the line 4. modify the line 5. change discount 6. save 7. see the new price with discount  Steps to reproduce the behavior 1. create a contract 2. add a line 3. save the line 4. modify the line 5. change discount 6. save 7. the price in database is incorrect  Attached files Workaround: on file contrat/card.php change : // update price_ht with discount // TODO Use object->updateline instead objedtline->update $price_ht = price2num(GETPOST('elprice'), 'MU'); $remise_percent = price2num(GETPOST('elremise_percent'), 2); if ($remise_percent > 0) { $remise = round(($price_ht * $remise_percent / 100), 2); $price_ht = ($price_ht - $remise); } to : // update price_ht with discount // TODO Use object->updateline instead objedtline->update $price_ht = price2num(GETPOST('elprice'), 'MU'); $remise_percent = price2num(GETPOST('elremise_percent'), 2); if ($remise_percent > 0) { $remise = round(($price_ht * $remise_percent / 100), 2); //$price_ht = ($price_ht - $remise); }",other-file,"Double discount on updateline in contract  Bug When you update a line on a contract to change the discount, the discount is applied twice.  Environment Version 17, 18  Environment OS Debian  Environment Web server Apache  Environment PHP php 8.0  Environment Database mysql  Environment URL(s) _No response_  Expected and actual behavior 1. create a contract 2. add a line 3. save the line 4. modify the line 5. change discount 6. save 7. see the new price with discount  Steps to reproduce the behavior 1. create a contract 2. add a line 3. save the line 4. modify the line 5. change discount 6. save 7. the price in database is incorrect  Attached files Workaround: on file contrat/card.php change : // update price_ht with discount // TODO Use object->updateline instead objedtline->update $price_ht = price2num(GETPOST('elprice'), 'MU'); $remise_percent = price2num(GETPOST('elremise_percent'), 2); if ($remise_percent > 0) { $remise = round(($price_ht * $remise_percent / 100), 2); $price_ht = ($price_ht - $remise); } to : // update price_ht with discount // TODO Use object->updateline instead objedtline->update $price_ht = price2num(GETPOST('elprice'), 'MU'); $remise_percent = price2num(GETPOST('elremise_percent'), 2); if ($remise_percent > 0) { $remise = round(($price_ht * $remise_percent / 100), 2); //$price_ht = ($price_ht - $remise); } other-file",no-bug,0.9
25985,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25985,[Bug] date_c need tzuser when we create a ticket," Bug The date of creation of a ticket is not set on the user timezone  Environment Version 17 - 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior It should set the creation date of a ticket with ""tzuser"" argument to have the good timezone  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"[Bug] date_c need tzuser when we create a ticket  Bug The date of creation of a ticket is not set on the user timezone  Environment Version 17 - 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior It should set the creation date of a ticket with ""tzuser"" argument to have the good timezone  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
27226,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27226,E-Mailcollector: Mails are not moved to target_directory when using PHPIMAP external library, Bug E-Mailcollector: Mails are not moved to target_directory when using PHPIMAP external library  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,E-Mailcollector: Mails are not moved to target_directory when using PHPIMAP external library  Bug E-Mailcollector: Mails are not moved to target_directory when using PHPIMAP external library  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
30950,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30950,Bad ref in supplier invoice created by Rest API from an invoice template," Bug When a supplier invoice is created from the Rest API with an invoice template, Dolibarr always add `_1` at the end of the ref.  Dolibarr Version 19.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Create an invoice template 2. Call the API with this body: json { ""date"": ""1725235200"", ""fac_rec"": 1, ""ref_supplier"": ""my_ref"", ""socid"": 1 }   Attached files _No response_",other-file | other-file,"Bad ref in supplier invoice created by Rest API from an invoice template  Bug When a supplier invoice is created from the Rest API with an invoice template, Dolibarr always add `_1` at the end of the ref.  Dolibarr Version 19.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Create an invoice template 2. Call the API with this body: json { ""date"": ""1725235200"", ""fac_rec"": 1, ""ref_supplier"": ""my_ref"", ""socid"": 1 }   Attached files _No response_ other-file other-file",bug,0.85
24298,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24298,V16 et V17 Data truncated for column de type Prix lorsque l'on remet rien sur les devis," Bug Bonjour, J'ai des attributs supplmentaires de type Prix sur les devis, commande et facture. Sur les devis uniquement lorsque l'on met un valeur, celle-ci est bien enregistre. Lorsque l'on revient dessus et que l'on met rien, on a un message ""Data truncated for column"". Cela ne se produit pas sur les commandes ni les factures. Par ailleurs nous avons constat que pour le devis, sur une autre configuration, lorsque l'on mettais rien, dans la base on se retrouv avec la valeur 0.00000 sans le message d'erreur et NULL sur les commandes. Nous avons fait le test sur des Dol 16.0.3 et un 17.0.0. Voil !  Environment Version 16.0.3 et 17.0.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"V16 et V17 Data truncated for column de type Prix lorsque l'on remet rien sur les devis  Bug Bonjour, J'ai des attributs supplmentaires de type Prix sur les devis, commande et facture. Sur les devis uniquement lorsque l'on met un valeur, celle-ci est bien enregistre. Lorsque l'on revient dessus et que l'on met rien, on a un message ""Data truncated for column"". Cela ne se produit pas sur les commandes ni les factures. Par ailleurs nous avons constat que pour le devis, sur une autre configuration, lorsque l'on mettais rien, dans la base on se retrouv avec la valeur 0.00000 sans le message d'erreur et NULL sur les commandes. Nous avons fait le test sur des Dol 16.0.3 et un 17.0.0. Voil !  Environment Version 16.0.3 et 17.0.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.8
31228,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31228,llx_receptiondet_batch_rowid_seq does not exist when creating reception," Bug When creating a new reception from a purchase order I get an error since update to 20.0.0 from version 19.0.3: ERROR: 42P01: relation ""llx_receptiondet_batch_rowid_seq"" does not exist LINE 1: SELECT currval('llx_receptiondet_batch_rowid_seq') ^ LOCATION: RangeVarGetRelidExtended, namespace.c:433  Dolibarr Version 20.0.0  Environment PHP 8.2  Environment Database postgresql 15  Steps to reproduce the behavior and expected behavior 1) Create purchase order and make that order 2) Create a reception and force to a specific warehouse  Attached files _No response_",database-file | database-file | database-file,"llx_receptiondet_batch_rowid_seq does not exist when creating reception  Bug When creating a new reception from a purchase order I get an error since update to 20.0.0 from version 19.0.3: ERROR: 42P01: relation ""llx_receptiondet_batch_rowid_seq"" does not exist LINE 1: SELECT currval('llx_receptiondet_batch_rowid_seq') ^ LOCATION: RangeVarGetRelidExtended, namespace.c:433  Dolibarr Version 20.0.0  Environment PHP 8.2  Environment Database postgresql 15  Steps to reproduce the behavior and expected behavior 1) Create purchase order and make that order 2) Create a reception and force to a specific warehouse  Attached files _No response_ database-file database-file database-file",no-bug,0.9
29594,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29594,REST API PUT `/contacts/{id}`: `update` called with notrigger = 1," Bug Currently, the API endpoint for contact update bypasses triggers (notrigger = 1). The same is true for some other PUT endpoints (~~thirdparty for instance~~), but not all (contract, BOM, proposal, anything made with ModuleBuilder, etc.). **[edit]** I was wrong about `thirdparty` because Societe::update's 3rd parameter is `$call_trigger` and not `$notrigger` as is usually the case. So the 3rd parameter is `1` but it _does_ call the trigger. If the endpoint `PUT /contacts/{id}` was copy-pasted from the third party API, it could explain this issue because this detail is easy to overlook (I'm a good example of that). I assume this is on purpose, but I can't find the reason why, and it is inconsinstent (why notrigger for updating and not for creating, why some objects and not others). We are developing a feature using triggers to change information whenever a contact is created or updated, but because of this `notrigger`, we can't make it work in APIs.  Dolibarr Version 17.0, 18.0, 19.0, develop,   Environment PHP any  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Implement triggers CONTACT_MODIFY and CONTACT_CREATE (let's say they both do the same: they concatenate ""elloworld"" to the lastname of the contact) 2. create a contact with lastname ""h"" using Dolibarr interface OK, its name is ""helloworld"" 3. edit the contact with lastname ""h"" using Dolibarr interface  OK, its name is ""helloworld"" 4. create a contact with lastname ""h"" using Dolibarr API POST /contacts  OK, its name is ""helloworld"" 5. update a contact with lastname ""h""using Dolibarr API PUT /contacts/{id}  KO (its is still ""h"")  Attached files _No response_",other-file | other-file | other-file | other-file | other-file,"REST API PUT `/contacts/{id}`: `update` called with notrigger = 1  Bug Currently, the API endpoint for contact update bypasses triggers (notrigger = 1). The same is true for some other PUT endpoints (~~thirdparty for instance~~), but not all (contract, BOM, proposal, anything made with ModuleBuilder, etc.). **[edit]** I was wrong about `thirdparty` because Societe::update's 3rd parameter is `$call_trigger` and not `$notrigger` as is usually the case. So the 3rd parameter is `1` but it _does_ call the trigger. If the endpoint `PUT /contacts/{id}` was copy-pasted from the third party API, it could explain this issue because this detail is easy to overlook (I'm a good example of that). I assume this is on purpose, but I can't find the reason why, and it is inconsinstent (why notrigger for updating and not for creating, why some objects and not others). We are developing a feature using triggers to change information whenever a contact is created or updated, but because of this `notrigger`, we can't make it work in APIs.  Dolibarr Version 17.0, 18.0, 19.0, develop,   Environment PHP any  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Implement triggers CONTACT_MODIFY and CONTACT_CREATE (let's say they both do the same: they concatenate ""elloworld"" to the lastname of the contact) 2. create a contact with lastname ""h"" using Dolibarr interface OK, its name is ""helloworld"" 3. edit the contact with lastname ""h"" using Dolibarr interface  OK, its name is ""helloworld"" 4. create a contact with lastname ""h"" using Dolibarr API POST /contacts  OK, its name is ""helloworld"" 5. update a contact with lastname ""h""using Dolibarr API PUT /contacts/{id}  KO (its is still ""h"")  Attached files _No response_ other-file other-file other-file other-file other-file",bug,0.9
25143,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25143,Default values for extrafields does not work on lists," Bug I'm trying to use the default search filters on one of my list, and it seems to not be working for the extrafields of the object, mainly because of this line `$search_array_options = $extrafields->getOptionalsFromPost($object->table_element, '', 'search_')` where the `getOptionalsFromPost()` function is using the `GETPOSTISSET()` function which doesn't check for values inside user->default_values unlike the `GETPOST()` function Shall I do a PR updating the `getOptionalsFromPost` function with GETPOST instead of GETPOSTISSET (seems to work at least for the `type boolean` just tried in local) or is there a reason we're using the GETPOSTISSET function inside of it ? Thanks!  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Default values for extrafields does not work on lists  Bug I'm trying to use the default search filters on one of my list, and it seems to not be working for the extrafields of the object, mainly because of this line `$search_array_options = $extrafields->getOptionalsFromPost($object->table_element, '', 'search_')` where the `getOptionalsFromPost()` function is using the `GETPOSTISSET()` function which doesn't check for values inside user->default_values unlike the `GETPOST()` function Shall I do a PR updating the `getOptionalsFromPost` function with GETPOST instead of GETPOSTISSET (seems to work at least for the `type boolean` just tried in local) or is there a reason we're using the GETPOSTISSET function inside of it ? Thanks!  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.8
31890,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31890,"v19.0.4 line extrafield in proposal cannot be saved, if empty"," Bug Proposal line extrafield with contents: contents cannot be completely deleted - will keep the original contents after save. However, changes of the contents get successfully stored.  Dolibarr Version Confirmed at least on v19.0.2, v19.0.3 and v19.0.4  Environment PHP 8.1  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior 1. create extrafield of type String for proposal line 2. create a proposal with one line with text in extrafield 3. click on pencil, delete the text of the extrafield and press save The extrafield now still contains the original text, log has a SQL error",other-file | other-file | other-file,"v19.0.4 line extrafield in proposal cannot be saved, if empty  Bug Proposal line extrafield with contents: contents cannot be completely deleted - will keep the original contents after save. However, changes of the contents get successfully stored.  Dolibarr Version Confirmed at least on v19.0.2, v19.0.3 and v19.0.4  Environment PHP 8.1  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior 1. create extrafield of type String for proposal line 2. create a proposal with one line with text in extrafield 3. click on pencil, delete the text of the extrafield and press save The extrafield now still contains the original text, log has a SQL error other-file other-file other-file",no-bug,0.9
24756,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24756,Report in Module Bank," Bug In version 17.0.1 (using php 8.0) the sums in monthly report in the module ""bank"" are incorrect. I found a problem in the file compta/bank/annuel.php. In line 199 and 200 the annual sums for ""sorties"" and ""entrees"" are set to zero every month in the loop over years. So as a final result I only see the sum of December. Instead of  for ($annee = $year_start; $annee <= $year_end; $annee++) { $totsorties[$annee] = 0; $totentrees[$annee] = 0;  it should be like this:  $totsorties[$annee] = 0;| $totentrees[$annee] = 0;| for ($annee = $year_start; $annee <= $year_end; $annee++) {  I'm not a developer, so maybe someone can fix this for future releases. thx, Peter  Environment Version 17.0.1  Environment OS synology disk station - linux  Environment Web server nginx  Environment PHP 8.0  Environment Database MariaDB 10  Environment URL(s) _No response_  Expected and actual behavior explained in Bug-Description.  Steps to reproduce the behavior In the menu Bank open the monthly report. The sum for the year is incorrect.  Attached files _No response_",other-file,"Report in Module Bank  Bug In version 17.0.1 (using php 8.0) the sums in monthly report in the module ""bank"" are incorrect. I found a problem in the file compta/bank/annuel.php. In line 199 and 200 the annual sums for ""sorties"" and ""entrees"" are set to zero every month in the loop over years. So as a final result I only see the sum of December. Instead of  for ($annee = $year_start; $annee <= $year_end; $annee++) { $totsorties[$annee] = 0; $totentrees[$annee] = 0;  it should be like this:  $totsorties[$annee] = 0;| $totentrees[$annee] = 0;| for ($annee = $year_start; $annee <= $year_end; $annee++) {  I'm not a developer, so maybe someone can fix this for future releases. thx, Peter  Environment Version 17.0.1  Environment OS synology disk station - linux  Environment Web server nginx  Environment PHP 8.0  Environment Database MariaDB 10  Environment URL(s) _No response_  Expected and actual behavior explained in Bug-Description.  Steps to reproduce the behavior In the menu Bank open the monthly report. The sum for the year is incorrect.  Attached files _No response_ other-file",no-bug,0.9
33206,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33206,Custom Email profile signature not applied when using USER_SIGNATURE or SENDEREMAIL_SIGNATURE variables," Bug Hello, I've encountered an issue in Dolibarr regarding email signatures set in a custom email profile (_Setup> Emails > Emails sender profiles_). As far as I understand, the email should be sent with the custom signature specific to the selected email profile, but the email is sent with the personal user signature instead.. Thank you for looking into this issue! Please let me know if any further information is needed  Dolibarr Version 20.0.3-20.0.4  Environment PHP 8.3.17  Environment Database MariaDB 10.6.18  Steps to reproduce the behavior and expected behavior 1. Create a separate email profile in with a custom signature. 2. Attempt to send an email choosing this custom profile. 3. Insert the variable `__USER_SIGNATURE__` (or `__SENDEREMAIL_SIGNATURE__`) in the email content. **Expected behavior** The email should be sent with the custom signature specific to the selected email profile. **Actual behavior** The email is sent with the personal user signature.  Attached files _No response_",other-file,"Custom Email profile signature not applied when using USER_SIGNATURE or SENDEREMAIL_SIGNATURE variables  Bug Hello, I've encountered an issue in Dolibarr regarding email signatures set in a custom email profile (_Setup> Emails > Emails sender profiles_). As far as I understand, the email should be sent with the custom signature specific to the selected email profile, but the email is sent with the personal user signature instead.. Thank you for looking into this issue! Please let me know if any further information is needed  Dolibarr Version 20.0.3-20.0.4  Environment PHP 8.3.17  Environment Database MariaDB 10.6.18  Steps to reproduce the behavior and expected behavior 1. Create a separate email profile in with a custom signature. 2. Attempt to send an email choosing this custom profile. 3. Insert the variable `__USER_SIGNATURE__` (or `__SENDEREMAIL_SIGNATURE__`) in the email content. **Expected behavior** The email should be sent with the custom signature specific to the selected email profile. **Actual behavior** The email is sent with the personal user signature.  Attached files _No response_ other-file",no-bug,0.9
31452,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31452,Bug: Wrong name in facture template: client instead of fournisseur," Bug Bug Version: 20.0.1 Hello, I have a facture fournisseur ![377649546-9eab07d6-5f4e-4331-be22-fbe8a5dbbaaf](https://github.com/user-attachments/assets/509471c4-3747-48e1-a25b-2ce8fc468bdf) And I convert it in a facture template On the next screen it's written Client just before my fournisseur name ![image](https://github.com/user-attachments/assets/d0f44e2f-518b-440d-956d-04ecf910052b) What is expected is ""Fournisseur""  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"Bug: Wrong name in facture template: client instead of fournisseur  Bug Bug Version: 20.0.1 Hello, I have a facture fournisseur ![377649546-9eab07d6-5f4e-4331-be22-fbe8a5dbbaaf](https://github.com/user-attachments/assets/509471c4-3747-48e1-a25b-2ce8fc468bdf) And I convert it in a facture template On the next screen it's written Client just before my fournisseur name ![image](https://github.com/user-attachments/assets/d0f44e2f-518b-440d-956d-04ecf910052b) What is expected is ""Fournisseur""  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
30456,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30456,Misleading title for purchase orders," Bug I have just noticed that the PDFs of the supplier orders are unclear. If you create an order in the system and have not placed an order, the PDF can still be read as if the order has been placed. There is a small red note at the top. But I think most people overlook it. In the case of a draft (e.g. for a quotation), it is very clear that it has not been released. For us, the problem arises in connection with tenders that we agree orders that we only commission after approval. As the partners (often smaller offices) still want to have something for their records, these documents are useful. However, they are misleading. To solve this, we should add a large note at the top of the PO number stating that the order has not been placed.  Dolibarr Version 19  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files ![Screenshot 2024-07-24 16 29 04](https://github.com/user-attachments/assets/3888712a-8e4a-4a93-a295-81fc62ab1c8c)",other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Misleading title for purchase orders  Bug I have just noticed that the PDFs of the supplier orders are unclear. If you create an order in the system and have not placed an order, the PDF can still be read as if the order has been placed. There is a small red note at the top. But I think most people overlook it. In the case of a draft (e.g. for a quotation), it is very clear that it has not been released. For us, the problem arises in connection with tenders that we agree orders that we only commission after approval. As the partners (often smaller offices) still want to have something for their records, these documents are useful. However, they are misleading. To solve this, we should add a large note at the top of the PO number stating that the order has not been placed.  Dolibarr Version 19  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files ![Screenshot 2024-07-24 16 29 04](https://github.com/user-attachments/assets/3888712a-8e4a-4a93-a295-81fc62ab1c8c) other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
28962,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28962,Converting Customer Order to Supplier Order Uses Selling Price Instead of Buying Price," Bug Problem Description When converting a customer order into a supplier order, the product prices are incorrectly taken from the selling prices instead of the buying prices. Expected Behavior The prices of the products in the supplier order should be their buying prices.  Dolibarr Version 19  Environment PHP 8  Environment Database _No response_  Steps to reproduce the behavior and expected behavior - Navigate to a customer order. - Click on ""Create"" then ""Create purchase order"". - Notice that the product prices in the supplier order correspond to the selling prices, not the buying prices.  Attached files _No response_",other-file,"Converting Customer Order to Supplier Order Uses Selling Price Instead of Buying Price  Bug Problem Description When converting a customer order into a supplier order, the product prices are incorrectly taken from the selling prices instead of the buying prices. Expected Behavior The prices of the products in the supplier order should be their buying prices.  Dolibarr Version 19  Environment PHP 8  Environment Database _No response_  Steps to reproduce the behavior and expected behavior - Navigate to a customer order. - Click on ""Create"" then ""Create purchase order"". - Notice that the product prices in the supplier order correspond to the selling prices, not the buying prices.  Attached files _No response_ other-file",no-bug,0.9
30976,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30976,ODT to PDF Invoice having full file path in their Filename," Bug When I'm generating the PDF Invoice From ODT template, The file name I'm getting the full path of the file. I'm using **MAIN_DISABLE_PDF_AUTOUPDATE** configuration in other setup. As you can see in the Screenshot. ![image](https://github.com/user-attachments/assets/878351db-8117-4176-ba9d-033713ca6189)  Dolibarr Version 19.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"ODT to PDF Invoice having full file path in their Filename  Bug When I'm generating the PDF Invoice From ODT template, The file name I'm getting the full path of the file. I'm using **MAIN_DISABLE_PDF_AUTOUPDATE** configuration in other setup. As you can see in the Screenshot. ![image](https://github.com/user-attachments/assets/878351db-8117-4176-ba9d-033713ca6189)  Dolibarr Version 19.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
28721,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28721,Ticket update function sets fk_statut to NULL," Bug The default value for fk_statut is set to null when it appears it ought to be set to zero(0). Ticket::update function: $sql .= "" fk_statut="".(isset($this->fk_statut) ? $this->fk_statut : ""null"")."",""; Ticket::create function: $sql .= "" "".(!isset($this->fk_statut) ? '0' : ""'"".$this->db->escape($this->fk_statut).""'"")."","";  Dolibarr Version 18.0  Environment PHP PHP 7.x  Environment Database 10.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior Perform an update to a ticket that was just created using the ""$object"". For example, I have an extra field named ""latestactivity"". $object->array_options['options_latestactivity'] = $this->db->idate(dol_now()); $object->update($user, 1); // update with no trigger.  Attached files _No response_",other-file | other-file,"Ticket update function sets fk_statut to NULL  Bug The default value for fk_statut is set to null when it appears it ought to be set to zero(0). Ticket::update function: $sql .= "" fk_statut="".(isset($this->fk_statut) ? $this->fk_statut : ""null"")."",""; Ticket::create function: $sql .= "" "".(!isset($this->fk_statut) ? '0' : ""'"".$this->db->escape($this->fk_statut).""'"")."","";  Dolibarr Version 18.0  Environment PHP PHP 7.x  Environment Database 10.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior Perform an update to a ticket that was just created using the ""$object"". For example, I have an extra field named ""latestactivity"". $object->array_options['options_latestactivity'] = $this->db->idate(dol_now()); $object->update($user, 1); // update with no trigger.  Attached files _No response_ other-file other-file",no-bug,0.9
23019,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23019,Impossible to add task times to an existing draft invoice," Bug Impossible to add task times to an existing draft invoice, Dolibar greys all the draft projects because they are linked to another company, which is not the case. File projet/tasks/time.php is calling selectInvoice method with string 'invoice' parameter instead if the company id, I guess '$projectstatic->thirdparty->id'  Environment Version 16.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Impossible to add task times to an existing draft invoice  Bug Impossible to add task times to an existing draft invoice, Dolibar greys all the draft projects because they are linked to another company, which is not the case. File projet/tasks/time.php is calling selectInvoice method with string 'invoice' parameter instead if the company id, I guess '$projectstatic->thirdparty->id'  Environment Version 16.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.8
25967,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25967,"Manque le champ ""Code comptable (achat)"""," Bug Lorsque l'on veut faire un export (Outils - Nouvel export),  l'tape 3 (filtre), l'intitul ""Code comptable (achat)"" apparait bien. Mais il n'y a pas de champ en face, au bout de la ligne Donc impossible de dfinir le code comptable  appliquer en tant que filtre (sur les achats).  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![Nouvel_export](https://github.com/Dolibarr/dolibarr/assets/6048396/3a9191af-5750-4d90-a02a-f2b9dc25a717)",other-file | other-file | other-file | other-file,"Manque le champ ""Code comptable (achat)""  Bug Lorsque l'on veut faire un export (Outils - Nouvel export),  l'tape 3 (filtre), l'intitul ""Code comptable (achat)"" apparait bien. Mais il n'y a pas de champ en face, au bout de la ligne Donc impossible de dfinir le code comptable  appliquer en tant que filtre (sur les achats).  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![Nouvel_export](https://github.com/Dolibarr/dolibarr/assets/6048396/3a9191af-5750-4d90-a02a-f2b9dc25a717) other-file other-file other-file other-file",no-bug,0.8
23096,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23096,Cannot validate orders in v17," Bug When trying to validate a customer order, the following error appears: ""Failed to insert event : Unknown column 'ip' in 'field list'"" and the problem comes from inserting into llx_actioncomm. Full SQL query from the debug tool is: `INSERT INTO llx_actioncomm(ref,datec,datep,datep2,durationp,fk_action,code,ref_ext,fk_soc,fk_project,note,fk_contact,fk_user_author,fk_user_action,fk_user_done,label,percent,priority,fulldayevent,location,transparency,fk_element,elementtype,entity,extraparams,email_msgid,email_from,email_sender,email_to,email_tocc,email_tobcc,email_subject,errors_to,recurid,recurrule,recurdateend,num_vote,event_paid,status,ip) VALUES ('(PROV)', '2022-12-04 11:11:08', '2022-12-04 11:11:08', '2022-12-04 11:11:08', null, 40,'AC_ORDER_VALIDATE', null, 1, null, ' SO2212-0001  ', null, 1, 1, null, ' SO2212-0001  ', '-1', '0', '0', '', '0', 1, 'order', 1,null, null, null, null, null, null, null, null, null, null, null, null, null, 0, 0, null)7.98 [DB_ERROR_NOSUCHFIELD] Unknown column 'ip' in 'field list'` In ""install/tables/llx_actioncomm"" there is NO field named ""ip""  Environment Version 17  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior The order should be validated and action record inserted into llx_actioncomm. Add field ""ip"" into ""install/tables/llx_actioncomm""  Steps to reproduce the behavior Create customer order and try to validate  Attached files _No response_",database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file,"Cannot validate orders in v17  Bug When trying to validate a customer order, the following error appears: ""Failed to insert event : Unknown column 'ip' in 'field list'"" and the problem comes from inserting into llx_actioncomm. Full SQL query from the debug tool is: `INSERT INTO llx_actioncomm(ref,datec,datep,datep2,durationp,fk_action,code,ref_ext,fk_soc,fk_project,note,fk_contact,fk_user_author,fk_user_action,fk_user_done,label,percent,priority,fulldayevent,location,transparency,fk_element,elementtype,entity,extraparams,email_msgid,email_from,email_sender,email_to,email_tocc,email_tobcc,email_subject,errors_to,recurid,recurrule,recurdateend,num_vote,event_paid,status,ip) VALUES ('(PROV)', '2022-12-04 11:11:08', '2022-12-04 11:11:08', '2022-12-04 11:11:08', null, 40,'AC_ORDER_VALIDATE', null, 1, null, ' SO2212-0001  ', null, 1, 1, null, ' SO2212-0001  ', '-1', '0', '0', '', '0', 1, 'order', 1,null, null, null, null, null, null, null, null, null, null, null, null, null, 0, 0, null)7.98 [DB_ERROR_NOSUCHFIELD] Unknown column 'ip' in 'field list'` In ""install/tables/llx_actioncomm"" there is NO field named ""ip""  Environment Version 17  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior The order should be validated and action record inserted into llx_actioncomm. Add field ""ip"" into ""install/tables/llx_actioncomm""  Steps to reproduce the behavior Create customer order and try to validate  Attached files _No response_ database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file",no-bug,0.9
29757,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29757,Ticket Ref Collisions," Bug In v18.0 the ticket form preemptively fills out a ""Ref"" in the create ticket form. If more than one user opens a new ticket form at the same time they have the same ""Ref"". When the forms are submitted, the later person's ticket inherits extra field values from the other person's ticket. I have identified the problem in v18.0. The ""$object"" variable is used to set and save posted values. At the same time the ""$object"" variable is used to ""fetch"" data using the posted ""ref"" to check if the ref is already used. The ""$object->fetch"" call populates the object with data values for the ticket found. The extra field values from the ticket found overrides the extra field values submitted. I would attempt to create a pull request to prevent this problem, but I see that the develop version contains major refactoring of the logic in this code-block. https://github.com/Dolibarr/dolibarr/blob/18.0/htdocs/ticket/card.php#L206  FUTURE CONCERN  In the develop branch the problem appears to be exacerbated. If I am reading the impending code-logic correctly, the future code will be changing the ticket ""add"" action to an ""update"". This means that when two people are creating a ticket at the same time and somehow start with the same ""ref"" in their form the second person who submits their form will be updating the other person's ticket instead of creating a new ticket as expected. https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/ticket/card.php#L211C1-L240C17  Dolibarr Version 18.0, develop  Environment PHP PHP 7.x  Environment Database 10.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior 1. Open a new ticket form in one browser tab. 2. Open a new ticket form in a different browser tab. 3. Submit form from step 1 setting a value for extra field X. 4. Submit form from step 2 WITHOUT setting a value for extra field X. The event messages report that the Ref was already used and has been replaced. However, the second ticket now has the same value for extra field X that was specified on the first ticket.  Attached files <img width=""1009"" alt=""Screenshot_2024_05_24_at_11 16 52_AM"" src=""https://github.com/Dolibarr/dolibarr/assets/445543/a5a0b00d-e22f-415c-804b-7eeca2a36dbc"">",other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Ticket Ref Collisions  Bug In v18.0 the ticket form preemptively fills out a ""Ref"" in the create ticket form. If more than one user opens a new ticket form at the same time they have the same ""Ref"". When the forms are submitted, the later person's ticket inherits extra field values from the other person's ticket. I have identified the problem in v18.0. The ""$object"" variable is used to set and save posted values. At the same time the ""$object"" variable is used to ""fetch"" data using the posted ""ref"" to check if the ref is already used. The ""$object->fetch"" call populates the object with data values for the ticket found. The extra field values from the ticket found overrides the extra field values submitted. I would attempt to create a pull request to prevent this problem, but I see that the develop version contains major refactoring of the logic in this code-block. https://github.com/Dolibarr/dolibarr/blob/18.0/htdocs/ticket/card.php#L206  FUTURE CONCERN  In the develop branch the problem appears to be exacerbated. If I am reading the impending code-logic correctly, the future code will be changing the ticket ""add"" action to an ""update"". This means that when two people are creating a ticket at the same time and somehow start with the same ""ref"" in their form the second person who submits their form will be updating the other person's ticket instead of creating a new ticket as expected. https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/ticket/card.php#L211C1-L240C17  Dolibarr Version 18.0, develop  Environment PHP PHP 7.x  Environment Database 10.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior 1. Open a new ticket form in one browser tab. 2. Open a new ticket form in a different browser tab. 3. Submit form from step 1 setting a value for extra field X. 4. Submit form from step 2 WITHOUT setting a value for extra field X. The event messages report that the Ref was already used and has been replaced. However, the second ticket now has the same value for extra field X that was specified on the first ticket.  Attached files <img width=""1009"" alt=""Screenshot_2024_05_24_at_11 16 52_AM"" src=""https://github.com/Dolibarr/dolibarr/assets/445543/a5a0b00d-e22f-415c-804b-7eeca2a36dbc""> other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
30120,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30120,Setup Default values doesn't work on all pages," Bug Hi, Trying to use ""[Default values/filters/sorting](https://wiki.dolibarr.org/index.php?title=Setup_Default_values/filters/sorting)"" function I met some issues  Apparently, it doesn't not work on some pages. For example, invoice is ok, not project or proposal : ![image](https://github.com/Dolibarr/dolibarr/assets/5184702/9b705d5e-494b-492a-a809-94de25103d20) Regards  Dolibarr Version 18.0.4 & 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"Setup Default values doesn't work on all pages  Bug Hi, Trying to use ""[Default values/filters/sorting](https://wiki.dolibarr.org/index.php?title=Setup_Default_values/filters/sorting)"" function I met some issues  Apparently, it doesn't not work on some pages. For example, invoice is ok, not project or proposal : ![image](https://github.com/Dolibarr/dolibarr/assets/5184702/9b705d5e-494b-492a-a809-94de25103d20) Regards  Dolibarr Version 18.0.4 & 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
30377,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30377,An external user can see invoices of all companies, Bug An external user can see invoices of all company. Rights allocated to this user: - user->rights->societe->lire - user->rights->societe->client->voir - user->rights->facture->lire  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Create some companies 2. Create some invoices for some companies 4. Create an external user 5. Add this User as contact of one company 6. Add permissions to this external user: - user->rights->societe->lire - user->rights->societe->client->voir - user->rights->facture->lire 7. Go to /compta/facture/list.php and clear filter by clicking on the cross  Attached files _No response_,other-file | other-file | other-file | other-file,An external user can see invoices of all companies  Bug An external user can see invoices of all company. Rights allocated to this user: - user->rights->societe->lire - user->rights->societe->client->voir - user->rights->facture->lire  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Create some companies 2. Create some invoices for some companies 4. Create an external user 5. Add this User as contact of one company 6. Add permissions to this external user: - user->rights->societe->lire - user->rights->societe->client->voir - user->rights->facture->lire 7. Go to /compta/facture/list.php and clear filter by clicking on the cross  Attached files _No response_ other-file other-file other-file other-file,no-bug,0.8
25982,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25982,defined currency of customer is not populated on card.php, Bug A customer has been configured with e.g USD currency but the card.php does not select the correct currency.  Environment Version 18.0.1  Environment OS RHEL  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file | other-file | other-file | other-file | other-file | other-file,defined currency of customer is not populated on card.php  Bug A customer has been configured with e.g USD currency but the card.php does not select the correct currency.  Environment Version 18.0.1  Environment OS RHEL  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file,no-bug,0.7
25130,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25130,Language is ignored in Shipping card when sending email," Bug Bug in expedition/card.php causes the selected language to be unused and enforces the default language instead. Patch to fix:   card.php.bad 2023-06-15 19:04:39.849285674 +0200  card.php 2023-06-18 09:42:33.889476061 +0200 @@ -2637,7 +2637,7 @@ // Presend form $modelmail = 'shipping_send'; - $defaulttopic = $langs->trans('SendShippingRef'); + $defaulttopic = 'SendShippingRef'; $diroutput = $conf->expedition->dir_output.'/sending'; $trackid = 'shi'.$object->id;   Environment Version 17.0.2  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"Language is ignored in Shipping card when sending email  Bug Bug in expedition/card.php causes the selected language to be unused and enforces the default language instead. Patch to fix:   card.php.bad 2023-06-15 19:04:39.849285674 +0200  card.php 2023-06-18 09:42:33.889476061 +0200 @@ -2637,7 +2637,7 @@ // Presend form $modelmail = 'shipping_send'; - $defaulttopic = $langs->trans('SendShippingRef'); + $defaulttopic = 'SendShippingRef'; $diroutput = $conf->expedition->dir_output.'/sending'; $trackid = 'shi'.$object->id;   Environment Version 17.0.2  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.8
26208,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26208,Add VAT free & VAT amounts to payment view," Feature Request On the payment input view, in the table that lists various payment information, it could be useful, in some cases, to also have VAT free (HT) and VAT (TVA) amounts. These 2 new columns would be just before the Amount including VAT column as in the suggested implementation below. ![new-show-vat-free-amount-payment-input](https://github.com/Dolibarr/dolibarr/assets/31100265/1ef68b61-97d4-4e64-92aa-f0cb499565b9) In order to keep importance on the full amount on which we are checking and entering a payment for, we could use `font-weight: bold` on the _Amount (inc. tax)_ value. **Remarks:** 1. Nowadays lots of screens are at least HD, I believe we have enough space to easily add these two columns to the view without affecting readability. 2. Importance could also be put on the _""Remaining amount to take""_ as this is what we would probably be comparing the full amount with.  Use case In some of the views of various accounting programs, the importance is sometimes put on VAT free amounts. For the person in charge of manually entering payments into Dolibarr it can be useful to also see VAT free and VAT amounts in order to pinpoint the correct payment information. The objectif is to reduce human error and improve quality of life for the user.  Suggested implementation Cf. screenshot above  Suggested steps _No response_",other-file,"Add VAT free & VAT amounts to payment view  Feature Request On the payment input view, in the table that lists various payment information, it could be useful, in some cases, to also have VAT free (HT) and VAT (TVA) amounts. These 2 new columns would be just before the Amount including VAT column as in the suggested implementation below. ![new-show-vat-free-amount-payment-input](https://github.com/Dolibarr/dolibarr/assets/31100265/1ef68b61-97d4-4e64-92aa-f0cb499565b9) In order to keep importance on the full amount on which we are checking and entering a payment for, we could use `font-weight: bold` on the _Amount (inc. tax)_ value. **Remarks:** 1. Nowadays lots of screens are at least HD, I believe we have enough space to easily add these two columns to the view without affecting readability. 2. Importance could also be put on the _""Remaining amount to take""_ as this is what we would probably be comparing the full amount with.  Use case In some of the views of various accounting programs, the importance is sometimes put on VAT free amounts. For the person in charge of manually entering payments into Dolibarr it can be useful to also see VAT free and VAT amounts in order to pinpoint the correct payment information. The objectif is to reduce human error and improve quality of life for the user.  Suggested implementation Cf. screenshot above  Suggested steps _No response_ other-file",no-bug,0.95
29049,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29049,IRPF reset when editing the label of a supplier invoice," Bug Problem: When there is a taxable person reversal invoice with IRPF and the label is edited, the IRPF is eliminated having the value 0. ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/76410c6b-e37e-4fe2-a4db-f410872ebf4a) I edit the tag: ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/6e7d82ea-ae62-4988-a82e-3e9154cbaf69) After editing the tag: ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/442e63d0-e959-4e8c-a7d0-47ba1e48b903) Expected behavior: ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/874c350c-8f30-43e8-bd54-46a8f10cc4de) Solution: Edit the file htdocs/fourn/class/fournisseur.facture.class.php. We look for the Update method: if (isset($this->localtax2)) { $this->total_localtax2 = trim($this->localtax2); } and we substitute: if (isset($this->total_localtax2)) { $this->total_localtax2 = trim($this->total_localtax2); } And that : $sql .= "" localtax2="" . (isset($this->localtax2) ? ((float) $this->localtax2) : ""null"") . "",""; For this: $sql .= "" localtax2="" . (isset($this->total_localtax2) ? ((float) $this->total_localtax2) : ""null"") . "","";  Dolibarr Version 19.0  Environment PHP 8.1  Environment Database MySQL or MariaDB 8.0.36-0ubuntu0.22.04.1  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file,"IRPF reset when editing the label of a supplier invoice  Bug Problem: When there is a taxable person reversal invoice with IRPF and the label is edited, the IRPF is eliminated having the value 0. ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/76410c6b-e37e-4fe2-a4db-f410872ebf4a) I edit the tag: ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/6e7d82ea-ae62-4988-a82e-3e9154cbaf69) After editing the tag: ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/442e63d0-e959-4e8c-a7d0-47ba1e48b903) Expected behavior: ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/874c350c-8f30-43e8-bd54-46a8f10cc4de) Solution: Edit the file htdocs/fourn/class/fournisseur.facture.class.php. We look for the Update method: if (isset($this->localtax2)) { $this->total_localtax2 = trim($this->localtax2); } and we substitute: if (isset($this->total_localtax2)) { $this->total_localtax2 = trim($this->total_localtax2); } And that : $sql .= "" localtax2="" . (isset($this->localtax2) ? ((float) $this->localtax2) : ""null"") . "",""; For this: $sql .= "" localtax2="" . (isset($this->total_localtax2) ? ((float) $this->total_localtax2) : ""null"") . "","";  Dolibarr Version 19.0  Environment PHP 8.1  Environment Database MySQL or MariaDB 8.0.36-0ubuntu0.22.04.1  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
26195,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26195,FIX - Add project with thirdparties when modify various payement," Bug When we create an various payement, we are able to select all the projects validated, but when it is create, if we modify the various payement to modify/add a project, we can't have all the projects. [card.zip](https://github.com/Dolibarr/dolibarr/files/12879829/card.zip)  Environment Version 17.0.1  Environment OS Linux dolibarr 5.4.0-146-generic #163-Ubuntu SMP Fri Mar 17 18:26:02 UTC 2023 x86_64  Environment Web server Apache/2.4.41 (Ubuntu)  Environment PHP 7.2.34-18+ubuntu20  Environment Database MySQL or MariaDB 5.5.5-10.3.38-MariaDB-0ubuntu0.20.04.1  Environment URL(s) https://transantico.srv01.gpca.fr/compta/bank/various_payment/card.php  Expected and actual behavior When we create an various payement, we are able to select all the projects validated, but when it is create, if we modify the various payement to modify/add a project, we can't have all the projects but only projects which haven't thirdparties affected (it had a filtrer SQL to the selector of projects in the modify form).  Steps to reproduce the behavior #FIX modify the line 572 : ""$morehtmlref .= $formproject->select_projects(0, $object->fk_project, 'projectid', $maxlength, 0, 1, 0, 1, 0, 0, '', 1);"" in the file /compta/bank/various_payement/card.php by the line ""$morehtmlref .= $formproject->select_projects(-1, $object->fk_project, 'projectid', $maxlength, 0, 1, 0, 1, 0, 0, '', 1);"" => Change the first parameter of the function select_projects() by -1 to be able to select all projects  Attached files ![image](https://github.com/Dolibarr/dolibarr/assets/147707369/5e28b398-a946-4fbf-a090-a476e0ae0241)",other-file | other-file,"FIX - Add project with thirdparties when modify various payement  Bug When we create an various payement, we are able to select all the projects validated, but when it is create, if we modify the various payement to modify/add a project, we can't have all the projects. [card.zip](https://github.com/Dolibarr/dolibarr/files/12879829/card.zip)  Environment Version 17.0.1  Environment OS Linux dolibarr 5.4.0-146-generic #163-Ubuntu SMP Fri Mar 17 18:26:02 UTC 2023 x86_64  Environment Web server Apache/2.4.41 (Ubuntu)  Environment PHP 7.2.34-18+ubuntu20  Environment Database MySQL or MariaDB 5.5.5-10.3.38-MariaDB-0ubuntu0.20.04.1  Environment URL(s) https://transantico.srv01.gpca.fr/compta/bank/various_payment/card.php  Expected and actual behavior When we create an various payement, we are able to select all the projects validated, but when it is create, if we modify the various payement to modify/add a project, we can't have all the projects but only projects which haven't thirdparties affected (it had a filtrer SQL to the selector of projects in the modify form).  Steps to reproduce the behavior #FIX modify the line 572 : ""$morehtmlref .= $formproject->select_projects(0, $object->fk_project, 'projectid', $maxlength, 0, 1, 0, 1, 0, 0, '', 1);"" in the file /compta/bank/various_payement/card.php by the line ""$morehtmlref .= $formproject->select_projects(-1, $object->fk_project, 'projectid', $maxlength, 0, 1, 0, 1, 0, 0, '', 1);"" => Change the first parameter of the function select_projects() by -1 to be able to select all projects  Attached files ![image](https://github.com/Dolibarr/dolibarr/assets/147707369/5e28b398-a946-4fbf-a090-a476e0ae0241) other-file other-file",no-bug,0.9
28544,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28544,Add interface for comment on change price for products and services, Feature Request Add interface for comment on price See : #27237  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file | other-file | other-file | other-file | other-file,Add interface for comment on change price for products and services  Feature Request Add interface for comment on price See : #27237  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file other-file other-file,no-bug,0.9
30447,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30447,Error sorting Services with a date filter," Bug Hello, In the list of services, when you select a date, be it scheduled start date, scheduled end date, start date, , and sort by any other column, e.g. Third Party, Department or Contract, , you get a Mysql error. Here's the error message: Dolibarr a dtect une erreur technique. Ces informations peuvent tre utiles  des fins de diagnostic (vous pouvez dfinir l'option $dolibarr_main_prod sur '1' pour masquer les informations sensibles): Date: 20240724115838 Dolibarr: 19.0.2 - https://www.dolibarr.org Niveau de fonctionnalits: 0 PHP: 8.1.2-1ubuntu2.18 Server: nginx/1.18.0 OS: Linux IRCFDEV10 6.5.0-44-generic #44~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Tue Jun 18 14:36:16 UTC 2 x86_64 User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0 Url sollicite: /contrat/services_list.php?sortfield=s.nom&sortorder=asc&begin=&contextpage=contractservicelist&search_status=-1&filter_opouvertureprevue=+BETWEEN+&opouvertureprevueday=3&opouvertureprevuemonth=7&opouvertureprevueyear=2024 Referer: http://pro2.localhost/ Gestionnaire de menu: eldy_menu.php Modules/Applications: api, syslog, user, fckeditor, kanview, import, modulebuilder, categorie, agenda, cron, commande, expensereport, facture, holiday, service, societe, mailing, export, ficheinter, propal, contrat, userswitcher, expedition, notification, ispconfig, product Type gestionnaire de base de donnes: mysqli Requte dernier accs en base en erreur: SELECT c.rowid as cid, c.ref, c.statut as cstatut, c.ref_customer, c.ref_supplier, s.rowid as socid, s.nom as name, s.email, s.client, s.fournisseur, cd.rowid, cd.description, cd.statut, cd.product_type as type, p.rowid as pid, p.ref as pref, p.label as label, p.fk_product_type as ptype, p.tobuy, p.tosell, p.barcode, p.entity as pentity, cd.date_ouverture_prevue, cd.date_ouverture, cd.date_fin_validite, cd.date_cloture, cd.qty, cd.total_ht, cd.total_tva, cd.tva_tx, cd.subprice, cd.tms as date_update FROM llx_contrat as c, llx_societe as s, llx_contratdet as cd LEFT JOIN llx_product as p ON cd.fk_product = p.rowid WHERE c.entity IN (1) AND c.rowid = cd.fk_contrat AND c.fk_soc = s.rowid AND **cd.date_ouverture_prevue BETWEEN '2024-07-03 00:00:00'** ORDER BY s.nom ASC LIMIT 26 Code retour dernier accs en base en erreur: DB_ERROR_SYNTAX Information sur le dernier accs en base en erreur: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'ORDER BY s.nom ASC LIMIT 26' at line 1 I've highlighted in bold where the error comes from, the BETWEEN has only one date instead of two. Thank you very much.  Dolibarr Version 19.0.2  Environment PHP 8.1  Environment Database MariaDB 10.6.18  Steps to reproduce the behavior and expected behavior Go to Commerce then Service. Enter a date in one of the fields provided, then perform the search. Sort by another column that is not a date.  Attached files _No response_",other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Error sorting Services with a date filter  Bug Hello, In the list of services, when you select a date, be it scheduled start date, scheduled end date, start date, , and sort by any other column, e.g. Third Party, Department or Contract, , you get a Mysql error. Here's the error message: Dolibarr a dtect une erreur technique. Ces informations peuvent tre utiles  des fins de diagnostic (vous pouvez dfinir l'option $dolibarr_main_prod sur '1' pour masquer les informations sensibles): Date: 20240724115838 Dolibarr: 19.0.2 - https://www.dolibarr.org Niveau de fonctionnalits: 0 PHP: 8.1.2-1ubuntu2.18 Server: nginx/1.18.0 OS: Linux IRCFDEV10 6.5.0-44-generic #44~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Tue Jun 18 14:36:16 UTC 2 x86_64 User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0 Url sollicite: /contrat/services_list.php?sortfield=s.nom&sortorder=asc&begin=&contextpage=contractservicelist&search_status=-1&filter_opouvertureprevue=+BETWEEN+&opouvertureprevueday=3&opouvertureprevuemonth=7&opouvertureprevueyear=2024 Referer: http://pro2.localhost/ Gestionnaire de menu: eldy_menu.php Modules/Applications: api, syslog, user, fckeditor, kanview, import, modulebuilder, categorie, agenda, cron, commande, expensereport, facture, holiday, service, societe, mailing, export, ficheinter, propal, contrat, userswitcher, expedition, notification, ispconfig, product Type gestionnaire de base de donnes: mysqli Requte dernier accs en base en erreur: SELECT c.rowid as cid, c.ref, c.statut as cstatut, c.ref_customer, c.ref_supplier, s.rowid as socid, s.nom as name, s.email, s.client, s.fournisseur, cd.rowid, cd.description, cd.statut, cd.product_type as type, p.rowid as pid, p.ref as pref, p.label as label, p.fk_product_type as ptype, p.tobuy, p.tosell, p.barcode, p.entity as pentity, cd.date_ouverture_prevue, cd.date_ouverture, cd.date_fin_validite, cd.date_cloture, cd.qty, cd.total_ht, cd.total_tva, cd.tva_tx, cd.subprice, cd.tms as date_update FROM llx_contrat as c, llx_societe as s, llx_contratdet as cd LEFT JOIN llx_product as p ON cd.fk_product = p.rowid WHERE c.entity IN (1) AND c.rowid = cd.fk_contrat AND c.fk_soc = s.rowid AND **cd.date_ouverture_prevue BETWEEN '2024-07-03 00:00:00'** ORDER BY s.nom ASC LIMIT 26 Code retour dernier accs en base en erreur: DB_ERROR_SYNTAX Information sur le dernier accs en base en erreur: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'ORDER BY s.nom ASC LIMIT 26' at line 1 I've highlighted in bold where the error comes from, the BETWEEN has only one date instead of two. Thank you very much.  Dolibarr Version 19.0.2  Environment PHP 8.1  Environment Database MariaDB 10.6.18  Steps to reproduce the behavior and expected behavior Go to Commerce then Service. Enter a date in one of the fields provided, then perform the search. Sort by another column that is not a date.  Attached files _No response_ other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
29371,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29371,PHP errors on separator type extrafield update," Bug When we update a separator type extrafield (on company configuration for example), we have two errors due to a variable not instantiated on extrafield.class.php file and explode() function on actions_extrafields.inc.php. ![Capture decran 2024-04-17 a 11 22 41](https://github.com/Dolibarr/dolibarr/assets/9167207/52789dcb-a0d5-4209-a5ab-fdf17cbbb30a) $param_ligne does not always contain a comma and in this case, we get the warning. ![Capture decran 2024-04-17 a 11 41 42](https://github.com/Dolibarr/dolibarr/assets/9167207/0240decf-6e7c-4803-91fd-1eb77209bbcd) If $type is ""separate"", $result is not instantiated. ![Capture decran 2024-04-17 a 11 17 51](https://github.com/Dolibarr/dolibarr/assets/9167207/c2b96c85-a20c-4a38-afa1-6ad017bfc666) I updated separator without parameters : ![Capture decran 2024-04-17 a 11 43 39](https://github.com/Dolibarr/dolibarr/assets/9167207/e4d89195-3312-4f47-8a86-1e434000e565)  Dolibarr Version 19.0.1  Environment PHP 8.2.10  Environment Database MySQL or MariaDB 10.3.39-MariaDB-0+deb10u1  Steps to reproduce the behavior and expected behavior Add a separator extrafield on an object and modify it : ![Capture decran 2024-04-17 a 11 43 39](https://github.com/Dolibarr/dolibarr/assets/9167207/88a00b58-9c71-4f17-98c3-ae337673eb01)  Attached files _No response_",other-file | other-file | other-file,"PHP errors on separator type extrafield update  Bug When we update a separator type extrafield (on company configuration for example), we have two errors due to a variable not instantiated on extrafield.class.php file and explode() function on actions_extrafields.inc.php. ![Capture decran 2024-04-17 a 11 22 41](https://github.com/Dolibarr/dolibarr/assets/9167207/52789dcb-a0d5-4209-a5ab-fdf17cbbb30a) $param_ligne does not always contain a comma and in this case, we get the warning. ![Capture decran 2024-04-17 a 11 41 42](https://github.com/Dolibarr/dolibarr/assets/9167207/0240decf-6e7c-4803-91fd-1eb77209bbcd) If $type is ""separate"", $result is not instantiated. ![Capture decran 2024-04-17 a 11 17 51](https://github.com/Dolibarr/dolibarr/assets/9167207/c2b96c85-a20c-4a38-afa1-6ad017bfc666) I updated separator without parameters : ![Capture decran 2024-04-17 a 11 43 39](https://github.com/Dolibarr/dolibarr/assets/9167207/e4d89195-3312-4f47-8a86-1e434000e565)  Dolibarr Version 19.0.1  Environment PHP 8.2.10  Environment Database MySQL or MariaDB 10.3.39-MariaDB-0+deb10u1  Steps to reproduce the behavior and expected behavior Add a separator extrafield on an object and modify it : ![Capture decran 2024-04-17 a 11 43 39](https://github.com/Dolibarr/dolibarr/assets/9167207/88a00b58-9c71-4f17-98c3-ae337673eb01)  Attached files _No response_ other-file other-file other-file",no-bug,0.9
26704,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26704,Missing pdf for task, Feature Request Missing pdf document for task  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file,Missing pdf for task  Feature Request Missing pdf document for task  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file,no-bug,0.9
28795,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28795,forgeSQLFromUniversalSearchCriteria breaking forms in v18 file: core/lib/functions.lib.php," Bug forgeSQLFromUniversalSearchCriteria breaking many company and project select2 inputs in my application. file: core/lib/functions.lib.php  Dolibarr Version 18.0  Environment PHP PHP 7.x  Environment Database 10.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior Attempt to use the ""Form::select_company"" function with multiple conditions OR simply use a conditions such as the following and the ""Bad syntax of the search string"" error occurs. `""((s.client = 1 OR s.client = 2 OR s.client = 3) AND s.status=1)'""` `""( s.client IN (1,2,3) )"" ` Also, try doing a project select2 input field with filter ""fk_soc=1234"" and the same error occurs. `//Do not display projects until a thirdparty is selected : start here` `$thirdparty_soc_id = isset( $socid ) && ! empty ( $socid ) ? $socid : '0000';` `if (isset($object->fields['fk_project'], $thirdparty_soc_id)) {` ` $object->fields['fk_project'] = array('type'=>'integer:Project:projet/class/project.class.php:1:fk_soc='.$thirdparty_soc_id, 'label'=>'Project', 'picto'=>'project', 'enabled'=>'$conf- >project->enabled', 'position'=>52, 'notnull'=>-1, 'visible'=>-1, 'index'=>1, 'css'=>'maxwidth500 widthcentpercentminusxx', 'validate'=>'1',);` `}//Do not display projects until a thirdparty is selected : end here ` <img width=""928"" alt=""Screenshot 2024-03-12 at 3 01 18 PM"" src=""https://github.com/Dolibarr/dolibarr/assets/445543/0ad45279-191c-4362-9022-97417f8727cf""> Company search produces SQL Error due to query condition ""AND (Filter syntax error - Bad syntax of the search string) "" inserted into the query. <img width=""1118"" alt=""Screenshot 2024-03-12 at 3 04 19 PM"" src=""https://github.com/Dolibarr/dolibarr/assets/445543/a98e679b-8d1c-4a51-90e2-ffa3d57f4a9c"">  Attached files I am using version 18.x and found issues when trying to use ""Form::select_thirdparty_list"" with ajax select2. print img_picto('', '').$form->select_company('', 'socid', '((s.client = 1 OR s.client = 2 OR s.client = 3) AND s.status=1)', 'SelectThirdParty', 0, 0, null, 0, 'minwidth175 maxwidth500 widthcentpercentminusxx'); Search produces the following error: ""Bad syntax of the search string"" I tried updating the filter to ""( s.client IN (1,2,3) )"" and get the same error. I see two(2) issues here: A. The function does not allow for more than one condition. B. The function is rejecting perfectly functional filters. There is a pull request that reports the issue is fixed below. However, I am on the latest for v.18 and do not see the change. v.18 The issue reported in the following is still present. https://github.com/Dolibarr/dolibarr/pull/26921",other-file,"forgeSQLFromUniversalSearchCriteria breaking forms in v18 file: core/lib/functions.lib.php  Bug forgeSQLFromUniversalSearchCriteria breaking many company and project select2 inputs in my application. file: core/lib/functions.lib.php  Dolibarr Version 18.0  Environment PHP PHP 7.x  Environment Database 10.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior Attempt to use the ""Form::select_company"" function with multiple conditions OR simply use a conditions such as the following and the ""Bad syntax of the search string"" error occurs. `""((s.client = 1 OR s.client = 2 OR s.client = 3) AND s.status=1)'""` `""( s.client IN (1,2,3) )"" ` Also, try doing a project select2 input field with filter ""fk_soc=1234"" and the same error occurs. `//Do not display projects until a thirdparty is selected : start here` `$thirdparty_soc_id = isset( $socid ) && ! empty ( $socid ) ? $socid : '0000';` `if (isset($object->fields['fk_project'], $thirdparty_soc_id)) {` ` $object->fields['fk_project'] = array('type'=>'integer:Project:projet/class/project.class.php:1:fk_soc='.$thirdparty_soc_id, 'label'=>'Project', 'picto'=>'project', 'enabled'=>'$conf- >project->enabled', 'position'=>52, 'notnull'=>-1, 'visible'=>-1, 'index'=>1, 'css'=>'maxwidth500 widthcentpercentminusxx', 'validate'=>'1',);` `}//Do not display projects until a thirdparty is selected : end here ` <img width=""928"" alt=""Screenshot 2024-03-12 at 3 01 18 PM"" src=""https://github.com/Dolibarr/dolibarr/assets/445543/0ad45279-191c-4362-9022-97417f8727cf""> Company search produces SQL Error due to query condition ""AND (Filter syntax error - Bad syntax of the search string) "" inserted into the query. <img width=""1118"" alt=""Screenshot 2024-03-12 at 3 04 19 PM"" src=""https://github.com/Dolibarr/dolibarr/assets/445543/a98e679b-8d1c-4a51-90e2-ffa3d57f4a9c"">  Attached files I am using version 18.x and found issues when trying to use ""Form::select_thirdparty_list"" with ajax select2. print img_picto('', '').$form->select_company('', 'socid', '((s.client = 1 OR s.client = 2 OR s.client = 3) AND s.status=1)', 'SelectThirdParty', 0, 0, null, 0, 'minwidth175 maxwidth500 widthcentpercentminusxx'); Search produces the following error: ""Bad syntax of the search string"" I tried updating the filter to ""( s.client IN (1,2,3) )"" and get the same error. I see two(2) issues here: A. The function does not allow for more than one condition. B. The function is rejecting perfectly functional filters. There is a pull request that reports the issue is fixed below. However, I am on the latest for v.18 and do not see the change. v.18 The issue reported in the following is still present. https://github.com/Dolibarr/dolibarr/pull/26921 other-file",no-bug,0.9
28608,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28608,COMMERCIAL PROPOSAL NUMBERING \," Bug Greetings to the team that provides us end user with a great product, thank you! Commercial proposal numbering and online signature. Reproduced in both 18.0.4 in production and 19.0.0 in test, I made a discover regarding Commercial proposal numbering and online signature. In configuration of the COMMERCIAL PROPOSALS MODULE SETUP, I have added a numbering mask containing a space: Proposal {000+22}. This works fine in all other modules and situations, except from tab, Commercial proposal and Link for online signature. In line 77 of the code of /core/lib/signature.lib.php, there is a str_replace. To me it looks like it removes space/blank in the proposal ref. When this blank/space is removed, the online signature form fails in displaying all the information.  Dolibarr Version 19.0 develop  Environment PHP 8.1.27  Environment Database MySQL or MariaDB 5.7.44-cll-lve  Steps to reproduce the behavior and expected behavior If the mask of Commercial proposal numbering contains a blank/white space, then the online signature form does not show the name of the customer and amount.  Attached files [Setup COMMERCIAL PROPOSAL NUMBERING MODELS.pdf](https://github.com/Dolibarr/dolibarr/files/14474153/Setup.COMMERCIAL.PROPOSAL.NUMBERING.MODELS.pdf)",other-file | other-file | other-file | other-file | other-file | other-file,"COMMERCIAL PROPOSAL NUMBERING \  Bug Greetings to the team that provides us end user with a great product, thank you! Commercial proposal numbering and online signature. Reproduced in both 18.0.4 in production and 19.0.0 in test, I made a discover regarding Commercial proposal numbering and online signature. In configuration of the COMMERCIAL PROPOSALS MODULE SETUP, I have added a numbering mask containing a space: Proposal {000+22}. This works fine in all other modules and situations, except from tab, Commercial proposal and Link for online signature. In line 77 of the code of /core/lib/signature.lib.php, there is a str_replace. To me it looks like it removes space/blank in the proposal ref. When this blank/space is removed, the online signature form fails in displaying all the information.  Dolibarr Version 19.0 develop  Environment PHP 8.1.27  Environment Database MySQL or MariaDB 5.7.44-cll-lve  Steps to reproduce the behavior and expected behavior If the mask of Commercial proposal numbering contains a blank/white space, then the online signature form does not show the name of the customer and amount.  Attached files [Setup COMMERCIAL PROPOSAL NUMBERING MODELS.pdf](https://github.com/Dolibarr/dolibarr/files/14474153/Setup.COMMERCIAL.PROPOSAL.NUMBERING.MODELS.pdf) other-file other-file other-file other-file other-file other-file",no-bug,0.9
26501,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26501,Wrong wiki page link," Bug In a V18.0.2, the page ""Facturation | Paiement"" > ""Charges fiscales/sociales"" > ""Nouvelle charge"" (`/compta/sociales/card.php?leftmenu=tax_social&action=create`) embeds a help button liking to the following wiki page : `http://wiki.dolibarr.org/index.php/Module+Taxes+et+dividendes`. However this wiki page doesn't exist and returns : > Module+Taxes+et+dividendes > Il ny a pour linstant aucun texte sur cette page. I think the help button shall link to the following existing wiki page: `https://wiki.dolibarr.org/index.php/Module_Taxes_et_charges_spciales`  Environment Version 18.0.2  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Wrong wiki page link  Bug In a V18.0.2, the page ""Facturation | Paiement"" > ""Charges fiscales/sociales"" > ""Nouvelle charge"" (`/compta/sociales/card.php?leftmenu=tax_social&action=create`) embeds a help button liking to the following wiki page : `http://wiki.dolibarr.org/index.php/Module+Taxes+et+dividendes`. However this wiki page doesn't exist and returns : > Module+Taxes+et+dividendes > Il ny a pour linstant aucun texte sur cette page. I think the help button shall link to the following existing wiki page: `https://wiki.dolibarr.org/index.php/Module_Taxes_et_charges_spciales`  Environment Version 18.0.2  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
24834,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24834,option to hide the footer of tickets on the public interface," Feature Request Now the ticket module setup have an option to display or hide the logo of the company in the public interface. Also will be great to have an option to display or hide the footer. This is necessary to be able to offer a white label looking urll of the ticket portal to the third parties that can use the public interface, and do not want to see the data of our company when they integrate out link in their websites. Please kindly implement the option ""**Display the footer of the company in the public interface**"" as is detailed in the next screenshot: ![image](https://github.com/Dolibarr/dolibarr/assets/7486607/633beff6-6607-46f4-97cf-f8efec38ce8c) This is the current apparience of the ticket public portal that will be great to improve enabling an option to hide the footer: ![image](https://github.com/Dolibarr/dolibarr/assets/7486607/63521e5c-28ae-43e3-bb77-0e157372f020)  Suggested implementation Add a new option in the setup of the tickets module, and implement the option",other-file | other-file | other-file | other-file | other-file,"option to hide the footer of tickets on the public interface  Feature Request Now the ticket module setup have an option to display or hide the logo of the company in the public interface. Also will be great to have an option to display or hide the footer. This is necessary to be able to offer a white label looking urll of the ticket portal to the third parties that can use the public interface, and do not want to see the data of our company when they integrate out link in their websites. Please kindly implement the option ""**Display the footer of the company in the public interface**"" as is detailed in the next screenshot: ![image](https://github.com/Dolibarr/dolibarr/assets/7486607/633beff6-6607-46f4-97cf-f8efec38ce8c) This is the current apparience of the ticket public portal that will be great to improve enabling an option to hide the footer: ![image](https://github.com/Dolibarr/dolibarr/assets/7486607/63521e5c-28ae-43e3-bb77-0e157372f020)  Suggested implementation Add a new option in the setup of the tickets module, and implement the option other-file other-file other-file other-file other-file",no-bug,0.95
24661,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24661,Start and end date of contract lines not available in API anymore," Bug In version 17 the contract start and end dates of contract lines are not exposed in the API anymore but are [cleaned before](https://github.com/Dolibarr/dolibarr/blob/b1e62d729754b94d8a50a83f1903ef3197a061e7/htdocs/contrat/class/api_contracts.class.php#L664).  Environment Version 17.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) /api/index.php/contracts/93  Expected and actual behavior Until version 16, start and end dates of individual contract lines were included in the API response in the fields `date_start`, `date_start_real`, `date_end` and `date_end_real`. This was apparently changed in d597eb8 when the legacy field names were permanently removed. I would expect that the dates continue to be sent in the API as they are not particularly sensitive.  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Start and end date of contract lines not available in API anymore  Bug In version 17 the contract start and end dates of contract lines are not exposed in the API anymore but are [cleaned before](https://github.com/Dolibarr/dolibarr/blob/b1e62d729754b94d8a50a83f1903ef3197a061e7/htdocs/contrat/class/api_contracts.class.php#L664).  Environment Version 17.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) /api/index.php/contracts/93  Expected and actual behavior Until version 16, start and end dates of individual contract lines were included in the API response in the fields `date_start`, `date_start_real`, `date_end` and `date_end_real`. This was apparently changed in d597eb8 when the legacy field names were permanently removed. I would expect that the dates continue to be sent in the API as they are not particularly sensitive.  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file",bug,0.9
31047,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31047,"The notes of mass emailing tool are not retrieved (Undefined array key """" in /comm/mailing/note.php )"," Bug The mass emailing notes are not stored. Is possible to edit the notes and included text in the notes filed, but after record it, changing the option in dolibarr and returning to the same note, the notes field appears empty. error.log PHP Warning: Undefined array key """" in /public_html/comm/mailing/note.php on line 52  Dolibarr Version 19.0.2, 20.0.4  Environment PHP 8.1.29  Environment Database MySQL or MariaDB 10.6.19-MariaDB  Steps to reproduce the behavior and expected behavior 1. Select in Dolibarr one emailing in the menu Tools/Emailing List 2. Edit ""Note"" of the emailing and add some content and store it 3. Select the ""Emailing"" Sheet of the emailing 4. Return to the same ""note"" sheet of the emailing selected and observe that is empty, instead with the content stored as should be error.log PHP Warning: Undefined array key """" in /public_html/comm/mailing/note.php on line 52  Attached files _No response_",other-file | other-file,"The notes of mass emailing tool are not retrieved (Undefined array key """" in /comm/mailing/note.php )  Bug The mass emailing notes are not stored. Is possible to edit the notes and included text in the notes filed, but after record it, changing the option in dolibarr and returning to the same note, the notes field appears empty. error.log PHP Warning: Undefined array key """" in /public_html/comm/mailing/note.php on line 52  Dolibarr Version 19.0.2, 20.0.4  Environment PHP 8.1.29  Environment Database MySQL or MariaDB 10.6.19-MariaDB  Steps to reproduce the behavior and expected behavior 1. Select in Dolibarr one emailing in the menu Tools/Emailing List 2. Edit ""Note"" of the emailing and add some content and store it 3. Select the ""Emailing"" Sheet of the emailing 4. Return to the same ""note"" sheet of the emailing selected and observe that is empty, instead with the content stored as should be error.log PHP Warning: Undefined array key """" in /public_html/comm/mailing/note.php on line 52  Attached files _No response_ other-file other-file",no-bug,0.8
29333,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29333,Link type extrafields on supplier order line are no longer working," Bug Hello, When i attempted to create an extrafield (link to an other object) on a supplier order line, this error showed up : selectForForms: Error bad setup of field objectdescorig=Contact, objectfield=commande_fournisseurdet:options_buyprice ![Capture dcran du 2024-04-12 11-01-26](https://github.com/Dolibarr/dolibarr/assets/86972374/8b8423a2-4946-4aed-a91c-9f1bf39f9e7e) I already found the origin of this bug and i will make a pull request, but i suspect that this problem will possibily occur on many other elements, since the problem comes from the 'getElementProperties' function (core/lib/functions.lib.php) and that many elements may not have been integrated into this function (maybe) ![Capture dcran du 2024-04-12 11-05-05](https://github.com/Dolibarr/dolibarr/assets/86972374/2fd6dd0b-4d00-4f9c-bea6-baa34ff0e0b2)  Dolibarr Version 19.0.1  Environment PHP 8.1.27  Environment Database 10.5.23-MariaDB  Steps to reproduce the behavior and expected behavior Set up an extrafield of type link on supplier order lines (from code or dolibarr's interface) Link it to whatever you want (even the basic examples provided into the help tooltip) Create it When you go to the line form on any order supplier, you'll see the error  Attached files _No response_",other-file | other-file,"Link type extrafields on supplier order line are no longer working  Bug Hello, When i attempted to create an extrafield (link to an other object) on a supplier order line, this error showed up : selectForForms: Error bad setup of field objectdescorig=Contact, objectfield=commande_fournisseurdet:options_buyprice ![Capture dcran du 2024-04-12 11-01-26](https://github.com/Dolibarr/dolibarr/assets/86972374/8b8423a2-4946-4aed-a91c-9f1bf39f9e7e) I already found the origin of this bug and i will make a pull request, but i suspect that this problem will possibily occur on many other elements, since the problem comes from the 'getElementProperties' function (core/lib/functions.lib.php) and that many elements may not have been integrated into this function (maybe) ![Capture dcran du 2024-04-12 11-05-05](https://github.com/Dolibarr/dolibarr/assets/86972374/2fd6dd0b-4d00-4f9c-bea6-baa34ff0e0b2)  Dolibarr Version 19.0.1  Environment PHP 8.1.27  Environment Database 10.5.23-MariaDB  Steps to reproduce the behavior and expected behavior Set up an extrafield of type link on supplier order lines (from code or dolibarr's interface) Link it to whatever you want (even the basic examples provided into the help tooltip) Create it When you go to the line form on any order supplier, you'll see the error  Attached files _No response_ other-file other-file",no-bug,0.9
25941,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25941,When setting up Emails in english language it asks a question in french," Bug When setting up Emails in english language it asks a question in french On page /admin/mails.php?action=edit&token=_-REDACTED-_ under the segment ""Email sending method"" it asks me something about certificates, but the text is in French? Authorise les certificats auto-signs  Environment Version 18.0.1  Environment OS upshift dolibarr docker image 18.0.1  Environment Web server upshift dolibarr docker image 18.0.1  Environment PHP upshift dolibarr docker image 18.0.1  Environment Database latest mariadb  Environment URL(s) /admin/mails.php?action=edit&token=_-REDACTED-_  Expected and actual behavior I would expect the text to be written in English  Steps to reproduce the behavior _No response_  Attached files ![french_ssl_quesiton](https://github.com/Dolibarr/dolibarr/assets/2551481/92b1d395-115b-4e37-bea4-a1b0ed08799c)",other-file | other-file | other-file | other-file,"When setting up Emails in english language it asks a question in french  Bug When setting up Emails in english language it asks a question in french On page /admin/mails.php?action=edit&token=_-REDACTED-_ under the segment ""Email sending method"" it asks me something about certificates, but the text is in French? Authorise les certificats auto-signs  Environment Version 18.0.1  Environment OS upshift dolibarr docker image 18.0.1  Environment Web server upshift dolibarr docker image 18.0.1  Environment PHP upshift dolibarr docker image 18.0.1  Environment Database latest mariadb  Environment URL(s) /admin/mails.php?action=edit&token=_-REDACTED-_  Expected and actual behavior I would expect the text to be written in English  Steps to reproduce the behavior _No response_  Attached files ![french_ssl_quesiton](https://github.com/Dolibarr/dolibarr/assets/2551481/92b1d395-115b-4e37-bea4-a1b0ed08799c) other-file other-file other-file other-file",no-bug,0.9
26243,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26243,projet/tasks/time.php no entity filter in query," Bug Filter on entity field is missing, so with multicompany module installed every company can see worked hour of other company  Environment Version all version  Environment OS all version  Environment Web server all version  Environment PHP all version  Environment Database all version  Environment URL(s) projet/tasks/time.php  Expected and actual behavior $sql .= "" WHERE p.entity IN ("".getEntity('project')."")"";  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"projet/tasks/time.php no entity filter in query  Bug Filter on entity field is missing, so with multicompany module installed every company can see worked hour of other company  Environment Version all version  Environment OS all version  Environment Web server all version  Environment PHP all version  Environment Database all version  Environment URL(s) projet/tasks/time.php  Expected and actual behavior $sql .= "" WHERE p.entity IN ("".getEntity('project')."")"";  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
27536,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27536,VAT of the buyer's country not applied if it is an individual while the SERVICE_ARE_ECOMMERCE_200238EC option is activated, Bug VAT of the buyer's country not applied if it is an individual while the SERVICE_ARE_ECOMMERCE_200238EC option is activated as it describe in https://wiki.dolibarr.org/index.php?title=Loi_europ%C3%A9enne_TVA_Vente_%C3%A0_Distance_VAD_et_e-commerce_BtoC  Environment Version 18.0 19.0  Environment OS Linux Debian  Environment Web server Linux Debian  Environment PHP 8.1  Environment Database 5.7  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file | other-file | other-file | other-file,VAT of the buyer's country not applied if it is an individual while the SERVICE_ARE_ECOMMERCE_200238EC option is activated  Bug VAT of the buyer's country not applied if it is an individual while the SERVICE_ARE_ECOMMERCE_200238EC option is activated as it describe in https://wiki.dolibarr.org/index.php?title=Loi_europ%C3%A9enne_TVA_Vente_%C3%A0_Distance_VAD_et_e-commerce_BtoC  Environment Version 18.0 19.0  Environment OS Linux Debian  Environment Web server Linux Debian  Environment PHP 8.1  Environment Database 5.7  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file,no-bug,0.8
26965,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26965,"Variants: missing check if variable ""VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT"" is set"," Bug In the check for the user rights the code has an OR clause which checks if a product is not a variant **OR** a certain string is globally set. https://github.com/Dolibarr/dolibarr/blob/e4536e0a2ebb87a91a09bf595242c2181889c0b4/htdocs/product/stock/product.php#L948 In the following if clause this check for the global string is missing: https://github.com/Dolibarr/dolibarr/blob/e4536e0a2ebb87a91a09bf595242c2181889c0b4/htdocs/product/stock/product.php#L962 This means that even if the global string **VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT** is set the product stock page does not show the serial/charge number table.  Environment Version 18.0.1  Environment OS Ubuntu Ubuntu 22.04.2 LTS x86_64  Environment Web server nginx version: nginx/1.18.0 (Ubuntu)  Environment PHP PHP 7.4.33 (cli) (built: Jun 8 2023 15:23:32) ( NTS ) Copyright (c) The PHP Group Zend Engine v3.4.0, Copyright (c) Zend Technologies with Zend OPcache v7.4.33, Copyright (c), by Zend Technologies  Environment Database mariadb Ver 15.1 Distrib 10.6.14-MariaDB, for debian-linux-gnu (x86_64) using EditLine wrapper  Environment URL(s) /product/stock/product.php?id=2915  Expected and actual behavior Expected behaviour: If variable **VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT** is set it should also show the stock table.  Steps to reproduce the behavior 1. Setup -> other Setup -> add variable with name = ""VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT"" and value = 1 2. go to product/stock/product.php Buttons for ""Transfer Stock"" and ""Correct Stock"" are visible, you can create a stock movement, but cannot see the table with serial/charge numbers.  Attached files _No response_",other-file | other-file,"Variants: missing check if variable ""VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT"" is set  Bug In the check for the user rights the code has an OR clause which checks if a product is not a variant **OR** a certain string is globally set. https://github.com/Dolibarr/dolibarr/blob/e4536e0a2ebb87a91a09bf595242c2181889c0b4/htdocs/product/stock/product.php#L948 In the following if clause this check for the global string is missing: https://github.com/Dolibarr/dolibarr/blob/e4536e0a2ebb87a91a09bf595242c2181889c0b4/htdocs/product/stock/product.php#L962 This means that even if the global string **VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT** is set the product stock page does not show the serial/charge number table.  Environment Version 18.0.1  Environment OS Ubuntu Ubuntu 22.04.2 LTS x86_64  Environment Web server nginx version: nginx/1.18.0 (Ubuntu)  Environment PHP PHP 7.4.33 (cli) (built: Jun 8 2023 15:23:32) ( NTS ) Copyright (c) The PHP Group Zend Engine v3.4.0, Copyright (c) Zend Technologies with Zend OPcache v7.4.33, Copyright (c), by Zend Technologies  Environment Database mariadb Ver 15.1 Distrib 10.6.14-MariaDB, for debian-linux-gnu (x86_64) using EditLine wrapper  Environment URL(s) /product/stock/product.php?id=2915  Expected and actual behavior Expected behaviour: If variable **VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT** is set it should also show the stock table.  Steps to reproduce the behavior 1. Setup -> other Setup -> add variable with name = ""VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT"" and value = 1 2. go to product/stock/product.php Buttons for ""Transfer Stock"" and ""Correct Stock"" are visible, you can create a stock movement, but cannot see the table with serial/charge numbers.  Attached files _No response_ other-file other-file",no-bug,0.9
25250,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25250,Wrong class called in api_receptions.class.php causes _validate method to crash,"Bug, current version 18.0.0-beta. https://github.com/Dolibarr/dolibarr/blob/61c5400d772336b4a6ad124f4471af833cce6827/htdocs/reception/class/api_receptions.class.php#L712C43-L712C43 It seems that the wrong class is called here. If i'm not mistaken, this should be the Receptions class and not the Shipments class.",other-file | other-file,"Wrong class called in api_receptions.class.php causes _validate method to crash Bug, current version 18.0.0-beta. https://github.com/Dolibarr/dolibarr/blob/61c5400d772336b4a6ad124f4471af833cce6827/htdocs/reception/class/api_receptions.class.php#L712C43-L712C43 It seems that the wrong class is called here. If i'm not mistaken, this should be the Receptions class and not the Shipments class. other-file other-file",no-bug,0.9
26676,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26676,Missing substitution variables," Feature Request In list when choosing massaction to send object by mail, in the list of available substitution variables we need the following: __ONLINE_PAYMENT_URL__ __ONLINE_PAYMENT_TEXT_AND_URL__ __THIRDPARTY_NAME__ __PROJECT_NAME__  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_",other-file | other-file | other-file,"Missing substitution variables  Feature Request In list when choosing massaction to send object by mail, in the list of available substitution variables we need the following: __ONLINE_PAYMENT_URL__ __ONLINE_PAYMENT_TEXT_AND_URL__ __THIRDPARTY_NAME__ __PROJECT_NAME__  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file",no-bug,0.9
28491,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28491,Issue on the Country / State on User modify," Bug When modifying a user, selecting a country is not refreshing the State field. From what i can see the function changed on User->New but for User->Modified its using the old one i guess that is creating an issue. Regards  Environment Version 19  Environment OS Windows Server 2016  Environment Web server Apache 2.4.54  Environment PHP 7.4.33  Environment Database mariadb 10.5.24  Environment URL(s) _No response_  Expected and actual behavior When choosing a country it should refresh the state field  Steps to reproduce the behavior Modifying a user country  Attached files _No response_",other-file,"Issue on the Country / State on User modify  Bug When modifying a user, selecting a country is not refreshing the State field. From what i can see the function changed on User->New but for User->Modified its using the old one i guess that is creating an issue. Regards  Environment Version 19  Environment OS Windows Server 2016  Environment Web server Apache 2.4.54  Environment PHP 7.4.33  Environment Database mariadb 10.5.24  Environment URL(s) _No response_  Expected and actual behavior When choosing a country it should refresh the state field  Steps to reproduce the behavior Modifying a user country  Attached files _No response_ other-file",no-bug,0.8
23108,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23108,"Bug: Consuming a Service or a Product with activated flag ""Stock change disabled"" in a MO"," Bug If consuming a Service or a Product with activated flag ""Stock change disabled"" in a MO, a error was thrown. > Cannot add or update a child row: a foreign key constraint fails (`dolibarr_develop`.`llx_mrp_production`, CONSTRAINT `fk_mrp_production_stock_movement` FOREIGN KEY (`fk_stock_movement`) REFERENCES `llx_stock_mouvement` (`rowid`)) Also the Services must split from the ""Consumption"" to ""Consumption Services"" similar to BOM View. Its not right to see the same fields how ""Stock"" or ""Warehouse"" as a Product. ![image](https://user-images.githubusercontent.com/78662388/205662796-80604206-6d6a-46d1-9ac7-5704222cc84c.png)  Environment Version 17.0.0-beta  Environment OS Windows 10  Environment Web server xampp  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior ![image](https://user-images.githubusercontent.com/78662388/205658395-2710c9fe-bec4-4274-a6a1-fc58a7104393.png)  Attached files _No response_",other-file | other-file | other-file,"Bug: Consuming a Service or a Product with activated flag ""Stock change disabled"" in a MO  Bug If consuming a Service or a Product with activated flag ""Stock change disabled"" in a MO, a error was thrown. > Cannot add or update a child row: a foreign key constraint fails (`dolibarr_develop`.`llx_mrp_production`, CONSTRAINT `fk_mrp_production_stock_movement` FOREIGN KEY (`fk_stock_movement`) REFERENCES `llx_stock_mouvement` (`rowid`)) Also the Services must split from the ""Consumption"" to ""Consumption Services"" similar to BOM View. Its not right to see the same fields how ""Stock"" or ""Warehouse"" as a Product. ![image](https://user-images.githubusercontent.com/78662388/205662796-80604206-6d6a-46d1-9ac7-5704222cc84c.png)  Environment Version 17.0.0-beta  Environment OS Windows 10  Environment Web server xampp  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior ![image](https://user-images.githubusercontent.com/78662388/205658395-2710c9fe-bec4-4274-a6a1-fc58a7104393.png)  Attached files _No response_ other-file other-file other-file",no-bug,0.9
25452,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25452,disable module Products should also disable BOM + MO, Bug if we disable module Products we should also disable the modules BOM & MO (imho)  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,disable module Products should also disable BOM + MO  Bug if we disable module Products we should also disable the modules BOM & MO (imho)  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
29756,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29756,"Typo in ""comments"" filter on accountancy/expensereport/lines.php"," Bug Dolibarr 19.0.2 On accountancy/expensereport/lines.php (Lignes de notes de frais lies), using the ""comments"" filter returns the following error: `Unknown column 'er.comments' in 'where clause'` . The ""comment"" filter works perfectly on accountancy/expensereport/list.php (Lignes de notes de frais  lier). It looks like a typo as a **D** is missing on the filter in accountancy/expensereport/lines.php: SQL SELECT statement contains er**d**.comments https://github.com/Dolibarr/dolibarr/blob/d62bd87f067bff51cfae8323967d0430af4307d3/htdocs/accountancy/expensereport/lines.php#L196 but filter is natural_search(""er.comments"", $search_desc); https://github.com/Dolibarr/dolibarr/blob/d62bd87f067bff51cfae8323967d0430af4307d3/htdocs/accountancy/expensereport/lines.php#L222 in accountancy/expensereport/list.php , you can see that the filter contains er**d** : https://github.com/Dolibarr/dolibarr/blob/d62bd87f067bff51cfae8323967d0430af4307d3/htdocs/accountancy/expensereport/list.php#L267  How to fix replace ""er"" by ""erd"" on line 222: https://github.com/Dolibarr/dolibarr/blob/d62bd87f067bff51cfae8323967d0430af4307d3/htdocs/accountancy/expensereport/lines.php#L222",other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Typo in ""comments"" filter on accountancy/expensereport/lines.php  Bug Dolibarr 19.0.2 On accountancy/expensereport/lines.php (Lignes de notes de frais lies), using the ""comments"" filter returns the following error: `Unknown column 'er.comments' in 'where clause'` . The ""comment"" filter works perfectly on accountancy/expensereport/list.php (Lignes de notes de frais  lier). It looks like a typo as a **D** is missing on the filter in accountancy/expensereport/lines.php: SQL SELECT statement contains er**d**.comments https://github.com/Dolibarr/dolibarr/blob/d62bd87f067bff51cfae8323967d0430af4307d3/htdocs/accountancy/expensereport/lines.php#L196 but filter is natural_search(""er.comments"", $search_desc); https://github.com/Dolibarr/dolibarr/blob/d62bd87f067bff51cfae8323967d0430af4307d3/htdocs/accountancy/expensereport/lines.php#L222 in accountancy/expensereport/list.php , you can see that the filter contains er**d** : https://github.com/Dolibarr/dolibarr/blob/d62bd87f067bff51cfae8323967d0430af4307d3/htdocs/accountancy/expensereport/list.php#L267  How to fix replace ""er"" by ""erd"" on line 222: https://github.com/Dolibarr/dolibarr/blob/d62bd87f067bff51cfae8323967d0430af4307d3/htdocs/accountancy/expensereport/lines.php#L222 other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.8
24265,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24265,Bug on TakePos Mobile Only - Not View all product/categorie," Bug Hello, When i use TakePos on mobile (or tablet). I see my product categories on the TakePos. However the first 3 are not clickable at the beginning. On the other hand, if I click on one of the following categories then the first 3 become selectable. In addition in all the categories I unfortunately do not see all my products. I only see 8 per category and cannot view the products afterwards. This for all categories  Environment Version 17.0.0  Environment OS Android 13  Environment Web server CentOS 7.9 - Plesk Obsidian V18.0.49  Environment PHP 8.0.28  Environment Database MariaDB 5.5.68  Environment URL(s) takepos/index.php?idmenu=54&mainmenu=takepos&leftmenu=  Expected and actual behavior _No response_  Steps to reproduce the behavior Open TakePos on mobile or tablet Click 3 first categorie don't work Click another else The 3 first work But i see only 8 product on all categorie  Attached files Cannot click to the 3 first category (for information, the 3 first category are children category inside) : ![cannot click the 3 first category](https://user-images.githubusercontent.com/84474411/226144178-fdcd5784-b405-4e1d-a030-196d694b22e1.PNG) After i click another category, for example i click to ""04 - Confiseries"" : ![Click other category](https://user-images.githubusercontent.com/84474411/226144205-cc62e904-2050-48b2-9d3b-c0635475ff3d.PNG) Now the 3 first category work : But in all category i view alors 8 product i cannot scroll more : ![not view all product](https://user-images.githubusercontent.com/84474411/226144275-0f02e044-d58d-4719-a35f-8f619161f63e.PNG)",other-file | other-file,"Bug on TakePos Mobile Only - Not View all product/categorie  Bug Hello, When i use TakePos on mobile (or tablet). I see my product categories on the TakePos. However the first 3 are not clickable at the beginning. On the other hand, if I click on one of the following categories then the first 3 become selectable. In addition in all the categories I unfortunately do not see all my products. I only see 8 per category and cannot view the products afterwards. This for all categories  Environment Version 17.0.0  Environment OS Android 13  Environment Web server CentOS 7.9 - Plesk Obsidian V18.0.49  Environment PHP 8.0.28  Environment Database MariaDB 5.5.68  Environment URL(s) takepos/index.php?idmenu=54&mainmenu=takepos&leftmenu=  Expected and actual behavior _No response_  Steps to reproduce the behavior Open TakePos on mobile or tablet Click 3 first categorie don't work Click another else The 3 first work But i see only 8 product on all categorie  Attached files Cannot click to the 3 first category (for information, the 3 first category are children category inside) : ![cannot click the 3 first category](https://user-images.githubusercontent.com/84474411/226144178-fdcd5784-b405-4e1d-a030-196d694b22e1.PNG) After i click another category, for example i click to ""04 - Confiseries"" : ![Click other category](https://user-images.githubusercontent.com/84474411/226144205-cc62e904-2050-48b2-9d3b-c0635475ff3d.PNG) Now the 3 first category work : But in all category i view alors 8 product i cannot scroll more : ![not view all product](https://user-images.githubusercontent.com/84474411/226144275-0f02e044-d58d-4719-a35f-8f619161f63e.PNG) other-file other-file",no-bug,0.8
24185,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24185,from release 16 onwards: pdf merge result for Intervention doesn't show up," Bug The merged file doesn't show up after performing a pdf merge for object type ""Intervention"". The merged file is being created and can be found in the documents folder, but that's inconvenient. I would expect the link to the merged file being displayed below the single files. This has to be considered as a bug, because it worked up to release 15 and still works in current versions for all other relevant object's I've tested.  Environment Version 16 and newer, including alpha of R18  Environment OS Linux Debian 5.10  Environment Web server Apache  Environment PHP 8.1  Environment Database MariaDB 10.5.18  Environment URL(s) /htdocs/fichinter/list.php?leftmenu=ficheinter  Expected and actual behavior I would expect the link to the merged file being displayed below the single files. Instead the file is being created and can be found in the respective subfolder of the document folder, but there's no link displayed in the window.  Steps to reproduce the behavior  Module Commerce, section Interventions: * Create more than one object of type interventions, including the validation, so that a pdf document is generated for each object * Navigate to Interventions -> list * Select at least two objects via the checkbox * Select action -> pdf merge, confirm * Realise the pop up message that a document has been created * Realise that no result link is being displayed. * Navigate to document subfolder and find the merged pdf  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"from release 16 onwards: pdf merge result for Intervention doesn't show up  Bug The merged file doesn't show up after performing a pdf merge for object type ""Intervention"". The merged file is being created and can be found in the documents folder, but that's inconvenient. I would expect the link to the merged file being displayed below the single files. This has to be considered as a bug, because it worked up to release 15 and still works in current versions for all other relevant object's I've tested.  Environment Version 16 and newer, including alpha of R18  Environment OS Linux Debian 5.10  Environment Web server Apache  Environment PHP 8.1  Environment Database MariaDB 10.5.18  Environment URL(s) /htdocs/fichinter/list.php?leftmenu=ficheinter  Expected and actual behavior I would expect the link to the merged file being displayed below the single files. Instead the file is being created and can be found in the respective subfolder of the document folder, but there's no link displayed in the window.  Steps to reproduce the behavior  Module Commerce, section Interventions: * Create more than one object of type interventions, including the validation, so that a pdf document is generated for each object * Navigate to Interventions -> list * Select at least two objects via the checkbox * Select action -> pdf merge, confirm * Realise the pop up message that a document has been created * Realise that no result link is being displayed. * Navigate to document subfolder and find the merged pdf  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
28993,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28993,Import xlsx file get white screen, Bug Import file between step 3 and 4 goes to white screen with php warning error and fatal error  Dolibarr Version _No response_  Environment PHP 8.2.7  Environment Database mariadb 10.11.4  Steps to reproduce the behavior and expected behavior Import file between step 3 and 4 goes to white screen with php warning error : file_get_contents(): Unable to find the wrapper &quot;zip&quot; - did you forget to enable it when you configured PHP? in /var/www/html/dolibarr19/htdocs/includes/phpoffice/phpspreadsheet/src/PhpSpreadsheet/Reader/Security/XmlScanner.php on line 152 And give fatal error : PHP Fatal error: Uncaught ValueError: XMLReader::XML(): Argument #1 ($source) cannot be empty in /var/www/html/dolibarr19/htdocs/includes/phpoffice/phpspreadsheet/src/PhpSpreadsheet/Reader/Xlsx.php:210\nStack  Attached files _No response_,other-file | other-file,Import xlsx file get white screen  Bug Import file between step 3 and 4 goes to white screen with php warning error and fatal error  Dolibarr Version _No response_  Environment PHP 8.2.7  Environment Database mariadb 10.11.4  Steps to reproduce the behavior and expected behavior Import file between step 3 and 4 goes to white screen with php warning error : file_get_contents(): Unable to find the wrapper &quot;zip&quot; - did you forget to enable it when you configured PHP? in /var/www/html/dolibarr19/htdocs/includes/phpoffice/phpspreadsheet/src/PhpSpreadsheet/Reader/Security/XmlScanner.php on line 152 And give fatal error : PHP Fatal error: Uncaught ValueError: XMLReader::XML(): Argument #1 ($source) cannot be empty in /var/www/html/dolibarr19/htdocs/includes/phpoffice/phpspreadsheet/src/PhpSpreadsheet/Reader/Xlsx.php:210\nStack  Attached files _No response_ other-file other-file,no-bug,0.9
26272,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26272,FK violation when merging companies with Reception objects attached," Bug When merging two companies with existing Reception object attached, the following error happens  ERROR: 23503: update or delete on table 'llx_societe' violates foreign key constraint 'fk_reception_fk_soc' on table 'llx_reception' DETAIL: Key (rowid)=(822) is still referenced from table 'llx_reception'. SCHEMA NAME: public TABLE NAME: llx_reception CONSTRAINT NAME: fk_reception_fk_soc LOCATION: ri_ReportViolation, ri_triggers.c:2797 Echec de la fusion de 2 enregistrements. Demande annule.  Indeed the lists are not accounting Reception: - https://github.com/Dolibarr/dolibarr/blob/268812fa3c014c3426842ac39984aa7f6e57ada1/htdocs/societe/card.php#L293C19-L293C19 - https://github.com/Dolibarr/dolibarr/blob/268812fa3c014c3426842ac39984aa7f6e57ada1/htdocs/societe/class/api_thirdparties.class.php#L437 And thus the associated reception are not handled.  Environment Version 17.0.2  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected behaviour: The companies should be merged and Reception objects from the deleted company should be reassigned to the resulting merged company. Actual behaviour: Red alert with the following error:  ERROR: 23503: update or delete on table 'llx_societe' violates foreign key constraint 'fk_reception_fk_soc' on table 'llx_reception' DETAIL: Key (rowid)=(822) is still referenced from table 'llx_reception'. SCHEMA NAME: public TABLE NAME: llx_reception CONSTRAINT NAME: fk_reception_fk_soc LOCATION: ri_ReportViolation, ri_triggers.c:2797 Echec de la fusion de 2 enregistrements. Demande annule.   Steps to reproduce the behavior Create two companies, create a Reception objects assigned to the company that will be deleted, and try merging the companies.  Attached files _No response_",other-file | test-file | test-file | other-file | test-file | test-file | test-file | test-file | other-file | test-file | test-file | other-file | other-file | other-file | test-file | test-file,"FK violation when merging companies with Reception objects attached  Bug When merging two companies with existing Reception object attached, the following error happens  ERROR: 23503: update or delete on table 'llx_societe' violates foreign key constraint 'fk_reception_fk_soc' on table 'llx_reception' DETAIL: Key (rowid)=(822) is still referenced from table 'llx_reception'. SCHEMA NAME: public TABLE NAME: llx_reception CONSTRAINT NAME: fk_reception_fk_soc LOCATION: ri_ReportViolation, ri_triggers.c:2797 Echec de la fusion de 2 enregistrements. Demande annule.  Indeed the lists are not accounting Reception: - https://github.com/Dolibarr/dolibarr/blob/268812fa3c014c3426842ac39984aa7f6e57ada1/htdocs/societe/card.php#L293C19-L293C19 - https://github.com/Dolibarr/dolibarr/blob/268812fa3c014c3426842ac39984aa7f6e57ada1/htdocs/societe/class/api_thirdparties.class.php#L437 And thus the associated reception are not handled.  Environment Version 17.0.2  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected behaviour: The companies should be merged and Reception objects from the deleted company should be reassigned to the resulting merged company. Actual behaviour: Red alert with the following error:  ERROR: 23503: update or delete on table 'llx_societe' violates foreign key constraint 'fk_reception_fk_soc' on table 'llx_reception' DETAIL: Key (rowid)=(822) is still referenced from table 'llx_reception'. SCHEMA NAME: public TABLE NAME: llx_reception CONSTRAINT NAME: fk_reception_fk_soc LOCATION: ri_ReportViolation, ri_triggers.c:2797 Echec de la fusion de 2 enregistrements. Demande annule.   Steps to reproduce the behavior Create two companies, create a Reception objects assigned to the company that will be deleted, and try merging the companies.  Attached files _No response_ other-file test-file test-file other-file test-file test-file test-file test-file other-file test-file test-file other-file other-file other-file test-file test-file",no-bug,0.9
24631,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24631,Filter on categories of warehouses faulty," Bug After creating and assigning a tag/category to a warehouse, filtering for this category in the list of warehouses does not work correctly.  Environment Version 17.0.1 and 18.0.0-alpha  Steps to reproduce the behavior Create several warehouses in a hierarchy (not sure yet, if hierarchy is a contributing factor). Create a category for warehouses. Assign category to warehouse on top of hierarchy. Go to list of warehouses and filter for the new category. Either nothing is found or even unrelated warehouses are shown instead.",other-file | other-file,"Filter on categories of warehouses faulty  Bug After creating and assigning a tag/category to a warehouse, filtering for this category in the list of warehouses does not work correctly.  Environment Version 17.0.1 and 18.0.0-alpha  Steps to reproduce the behavior Create several warehouses in a hierarchy (not sure yet, if hierarchy is a contributing factor). Create a category for warehouses. Assign category to warehouse on top of hierarchy. Go to list of warehouses and filter for the new category. Either nothing is found or even unrelated warehouses are shown instead. other-file other-file",no-bug,0.7
29458,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29458,incorrect page numbering in PDF," Bug In v18.0.5 (php 8.0.30) the page numbering in the Propale pdf is incorrect. It is in the form: 1/2, 2/3, 3/4, 4/4 instead of 1/4, 2/4, 3/4, 4/4 (azure and cyan models). On the same server and configuration it is correct for v17.0.3  Dolibarr Version 18.0.5  Environment PHP 8.0.3  Environment Database 10.6.17-MariaDB  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file,"incorrect page numbering in PDF  Bug In v18.0.5 (php 8.0.30) the page numbering in the Propale pdf is incorrect. It is in the form: 1/2, 2/3, 3/4, 4/4 instead of 1/4, 2/4, 3/4, 4/4 (azure and cyan models). On the same server and configuration it is correct for v17.0.3  Dolibarr Version 18.0.5  Environment PHP 8.0.3  Environment Database 10.6.17-MariaDB  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
29449,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29449,"In the contract, only services are displayed when adding predefined services or products, and all services and goods are displayed when modifying."," Bug In the contract, only services are displayed when adding predefined services or products, and all services and goods are displayed when modifying.  Dolibarr Version 19.0  Environment PHP php 7.4  Environment Database mysql 5.7  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"In the contract, only services are displayed when adding predefined services or products, and all services and goods are displayed when modifying.  Bug In the contract, only services are displayed when adding predefined services or products, and all services and goods are displayed when modifying.  Dolibarr Version 19.0  Environment PHP php 7.4  Environment Database mysql 5.7  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.3
32365,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32365,"Bug: Warning: Attempt to read property ""datepaye"" on string"," Bug Version: 20.0.2 Hello, When I go to Modules/Applications > Configuration du module Fournisseurs > Rglements fournisseurs I see a warning ![image](https://github.com/user-attachments/assets/f23395c4-2374-4fd2-a171-96494896c578) Regards  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file,"Bug: Warning: Attempt to read property ""datepaye"" on string  Bug Version: 20.0.2 Hello, When I go to Modules/Applications > Configuration du module Fournisseurs > Rglements fournisseurs I see a warning ![image](https://github.com/user-attachments/assets/f23395c4-2374-4fd2-a171-96494896c578) Regards  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
24569,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24569,Search functionnality in stock list doesn't work, Bug Search functionality in does not work ![Stock_a_date](https://user-images.githubusercontent.com/26635105/233768015-f905b7e7-1993-44ea-a428-c7f5f3dacfba.png)  Environment Version 16.0.5  Environment OS Debian  Environment Web server Apache2  Environment PHP 7.4  Environment Database MySQL  Environment URL(s) http://xxxxx/product/stock/stockatdate.php  Expected and actual behavior Search title should display element using the keyword  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,Search functionnality in stock list doesn't work  Bug Search functionality in does not work ![Stock_a_date](https://user-images.githubusercontent.com/26635105/233768015-f905b7e7-1993-44ea-a428-c7f5f3dacfba.png)  Environment Version 16.0.5  Environment OS Debian  Environment Web server Apache2  Environment PHP 7.4  Environment Database MySQL  Environment URL(s) http://xxxxx/product/stock/stockatdate.php  Expected and actual behavior Search title should display element using the keyword  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
24405,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24405,DEPOSIT_PERCENT est affich au lieu de la valeur relle dans le document,"Lors de la creation d'une proposition commerciale sur un tiers ayant la condition de rglement  DEP30PCTDEL , sur la proposition commerciale apparat DEPOSIT_PERCENT% acompte, reste  la livraison au lieu de la valeur que devait avoir cette variable. Plus de dtails ici https://www.dolibarr.fr/forum/t/demande-davis-sur-fonctionnalite-acompte-automatique/37824/43 Test en 16.0.3",other-file | other-file | other-file | config-file | other-file | other-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | other-file | other-file | database-file | other-file | other-file | config-file | config-file | other-file | other-file | config-file | other-file | config-file | other-file | other-file | documentation-file | documentation-file | config-file | config-file | other-file | documentation-file | other-file | documentation-file | other-file | config-file | other-file | documentation-file | config-file | database-file | database-file | config-file | config-file | config-file | config-file | other-file | other-file | documentation-file | documentation-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | other-file | test-file | test-file | test-file | test-file | test-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"DEPOSIT_PERCENT est affich au lieu de la valeur relle dans le document Lors de la creation d'une proposition commerciale sur un tiers ayant la condition de rglement  DEP30PCTDEL , sur la proposition commerciale apparat DEPOSIT_PERCENT% acompte, reste  la livraison au lieu de la valeur que devait avoir cette variable. Plus de dtails ici https://www.dolibarr.fr/forum/t/demande-davis-sur-fonctionnalite-acompte-automatique/37824/43 Test en 16.0.3 other-file other-file other-file config-file other-file other-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file other-file other-file database-file other-file other-file config-file config-file other-file other-file config-file other-file config-file other-file other-file documentation-file documentation-file config-file config-file other-file documentation-file other-file documentation-file other-file config-file other-file documentation-file config-file database-file database-file config-file config-file config-file config-file other-file other-file documentation-file documentation-file other-file config-file config-file config-file config-file config-file config-file other-file test-file test-file test-file test-file test-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
28641,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28641,annoying autocomplete on DatePicker, Bug On datepicker object autocomplete is annoying ![image](https://github.com/Dolibarr/dolibarr/assets/93346975/7bba98ca-bb97-4c98-a92b-bacb08d37444)  Dolibarr Version 19  Environment PHP 8.1  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior on an empty date form click datepicker icon. the html autocomplete function does not let click on calendar ![image](https://github.com/Dolibarr/dolibarr/assets/93346975/82193b01-02a8-4355-957a-4c4c5b79ec1d)  Attached files _No response_,other-file,annoying autocomplete on DatePicker  Bug On datepicker object autocomplete is annoying ![image](https://github.com/Dolibarr/dolibarr/assets/93346975/7bba98ca-bb97-4c98-a92b-bacb08d37444)  Dolibarr Version 19  Environment PHP 8.1  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior on an empty date form click datepicker icon. the html autocomplete function does not let click on calendar ![image](https://github.com/Dolibarr/dolibarr/assets/93346975/82193b01-02a8-4355-957a-4c4c5b79ec1d)  Attached files _No response_ other-file,no-bug,0.95
24761,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24761,Add REST API for retrieving regions, Feature Request Add REST API for retrieving country regions  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file | other-file | other-file,Add REST API for retrieving regions  Feature Request Add REST API for retrieving country regions  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file,no-bug,0.9
30067,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30067,Displaying user who received an expense payment in bank entries," Bug Following [#24946](https://github.com/Dolibarr/dolibarr/issues/24946), the same occurs for expense payments : the name of the user who received the payment is missing in the bank entries, remains empty while it appears for salary payments. ![image](https://github.com/Dolibarr/dolibarr/assets/14906222/27d4e09f-fc09-4029-b0c9-2970911e2fab)  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"Displaying user who received an expense payment in bank entries  Bug Following [#24946](https://github.com/Dolibarr/dolibarr/issues/24946), the same occurs for expense payments : the name of the user who received the payment is missing in the bank entries, remains empty while it appears for salary payments. ![image](https://github.com/Dolibarr/dolibarr/assets/14906222/27d4e09f-fc09-4029-b0c9-2970911e2fab)  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.7
27203,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27203,Avoid ugly messages / eventMessage not displayed," Bug If a plugin or another core bug send to setEventMessage something which's not a string, you'll see an ugly message in the footer like `Fatal error: Uncaught TypeError: preg_match(): Argument #2 ($subject) must be of type string, __PHP_Incomplete_Class given in /home/asheuroptw/erpdev/htdocs/core/lib/functions.lib.php:8309 Stack trace: #0 /home/asheuroptw/erpdev/htdocs/core/lib/functions.lib.php(8309): preg_match( /class= error / , Object(__PHP_Incomplete_Class)) #1 /home/asheuroptw/erpdev/htdocs/core/lib/functions.lib.php(8184): dol_htmloutput_mesg( , Array,  error ) #2 /home/asheuroptw/erpdev/htdocs/main.inc.php(3182): dol_htmloutput_events(0) #3 /home/asheuroptw/erpdev/htdocs/compta/facture/card.php(5762): llxFooter() #4 {main} thrown in /home/asheuroptw/erpdev/htdocs/core/lib/functions.lib.php on line 8309` And the other Eventmessages, even if ther'e Ok, are not displayed That's because the type of string message isn't controlled  Environment Version All  Environment OS All  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"Avoid ugly messages / eventMessage not displayed  Bug If a plugin or another core bug send to setEventMessage something which's not a string, you'll see an ugly message in the footer like `Fatal error: Uncaught TypeError: preg_match(): Argument #2 ($subject) must be of type string, __PHP_Incomplete_Class given in /home/asheuroptw/erpdev/htdocs/core/lib/functions.lib.php:8309 Stack trace: #0 /home/asheuroptw/erpdev/htdocs/core/lib/functions.lib.php(8309): preg_match( /class= error / , Object(__PHP_Incomplete_Class)) #1 /home/asheuroptw/erpdev/htdocs/core/lib/functions.lib.php(8184): dol_htmloutput_mesg( , Array,  error ) #2 /home/asheuroptw/erpdev/htdocs/main.inc.php(3182): dol_htmloutput_events(0) #3 /home/asheuroptw/erpdev/htdocs/compta/facture/card.php(5762): llxFooter() #4 {main} thrown in /home/asheuroptw/erpdev/htdocs/core/lib/functions.lib.php on line 8309` And the other Eventmessages, even if ther'e Ok, are not displayed That's because the type of string message isn't controlled  Environment Version All  Environment OS All  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
26244,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26244,Interventions with multilines -> display like if it was duplicate interventions and bug," Bug If i make an intervention with 3 lines like that: ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/ca7ef2b2-3bf4-4a3c-9684-91c9d99ed041) intervention list make 3 lines: ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/17274bd4-0e36-4187-b451-cc2d7a81f2bc) that's not really a bug due to filters against lines ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/e12c283c-4ea0-4338-bbae-3e85b2e0a5ee) but massaction ""delete"" can't delete that intervention, even if i select all lines ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/9db38ff4-4237-453b-b672-93b9e6ec57dd) and after that ""try to delete via mass action"" the bug is if i'm going to the card and delete the card everything seems ok, intervention list is empty BUT i could NEVER validate a new intervention due to that bug: ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/5d2a762b-7ddd-470d-8fce-02dfb610df89) That's a race condition with massaction delete + intervention with multiline + delete intervention via globalcard   Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Interventions with multilines -> display like if it was duplicate interventions and bug  Bug If i make an intervention with 3 lines like that: ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/ca7ef2b2-3bf4-4a3c-9684-91c9d99ed041) intervention list make 3 lines: ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/17274bd4-0e36-4187-b451-cc2d7a81f2bc) that's not really a bug due to filters against lines ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/e12c283c-4ea0-4338-bbae-3e85b2e0a5ee) but massaction ""delete"" can't delete that intervention, even if i select all lines ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/9db38ff4-4237-453b-b672-93b9e6ec57dd) and after that ""try to delete via mass action"" the bug is if i'm going to the card and delete the card everything seems ok, intervention list is empty BUT i could NEVER validate a new intervention due to that bug: ![image](https://github.com/Dolibarr/dolibarr/assets/1468823/5d2a762b-7ddd-470d-8fce-02dfb610df89) That's a race condition with massaction delete + intervention with multiline + delete intervention via globalcard   Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
23087,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23087,Bug: Several issues in setup.php on new module creation, Bug There seems to be several issues with setup.php on a new module creation. https://www.dolibarr.org/forum/t/possible-bug-in-setup-php-code-in-modulebuilder/22947 See the link above for a description.  Environment Version 16.0.3  Environment OS Mac OS 13.0  Environment Web server Apache 2.4.46  Environment PHP PHP 7.4.21  Environment Database MySQL 5.7.34  Environment URL(s) setup.php  Expected and actual behavior There is also another issue found with a totally new module being created in the setup.php page. See attached screenshot.  Steps to reproduce the behavior Create a new module using the module builder. Enable new module. Navigate to setup page for new module.  Attached files ![Screenshot 2022-12-02 at 10 42 11 AM](https://user-images.githubusercontent.com/91085820/205353064-68a252fb-98c0-4493-8b3c-5a760c2e43c7.png),other-file,Bug: Several issues in setup.php on new module creation  Bug There seems to be several issues with setup.php on a new module creation. https://www.dolibarr.org/forum/t/possible-bug-in-setup-php-code-in-modulebuilder/22947 See the link above for a description.  Environment Version 16.0.3  Environment OS Mac OS 13.0  Environment Web server Apache 2.4.46  Environment PHP PHP 7.4.21  Environment Database MySQL 5.7.34  Environment URL(s) setup.php  Expected and actual behavior There is also another issue found with a totally new module being created in the setup.php page. See attached screenshot.  Steps to reproduce the behavior Create a new module using the module builder. Enable new module. Navigate to setup page for new module.  Attached files ![Screenshot 2022-12-02 at 10 42 11 AM](https://user-images.githubusercontent.com/91085820/205353064-68a252fb-98c0-4493-8b3c-5a760c2e43c7.png) other-file,no-bug,0.9
26452,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26452,Missing sending in mail on product card and service card, Feature Request Add Email on product card ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/4f787fe7-120b-4967-b22b-f9cc70f7a50f) Add Email model ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/7216ba61-21fd-49f1-812b-f119afa2083a) Add Event on email sent Add Standard Subtitution variable for product/Service  Use case - [ ] Send product card for pre-sell - [ ] Obligation to send information to all client on a product  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file | other-file,Missing sending in mail on product card and service card  Feature Request Add Email on product card ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/4f787fe7-120b-4967-b22b-f9cc70f7a50f) Add Email model ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/7216ba61-21fd-49f1-812b-f119afa2083a) Add Event on email sent Add Standard Subtitution variable for product/Service  Use case - [ ] Send product card for pre-sell - [ ] Obligation to send information to all client on a product  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file,no-bug,0.9
25752,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25752,Entering supplier payments not possible anymore," Bug I've just successfully entered a supplier payment and when hovering to the next payment, i am not seeing the full screen any longer. The screen looks like this: ![image](https://github.com/Dolibarr/dolibarr/assets/5146717/61d66949-0f66-4112-95fb-236cd5f10312) PHP 8.1 (also tried with php8.2) Logs say the following  2023/08/31 12:55:10 [error] 3931785#3931785: *685396 FastCGI sent in stderr: ""PHP message: PHP Warning: Undefined array key ""labeladddateof"" in /var/www/dolibarr.mysrv/chroot/htdocs/core/class/html.form.class.php on line 7076; PHP message: PHP Fatal error: Uncaught TypeError: DateTime::setTimestamp(): Argument #1 ($timestamp) must be of type int, string given in /var/www/dolibarr.mysrv/chroot/htdocs/core/lib/functions.lib.php:2930 Stack trace: #0 /var/www/dolibarr.mysrv/chroot/htdocs/core/lib/functions.lib.php(2930): DateTime->setTimestamp() #1 /var/www/dolibarr.mysrv/chroot/htdocs/core/class/html.form.class.php(7077): dol_getdate() #2 /var/www/dolibarr.mysrv/chroot/htdocs/fourn/facture/paiement.php(512): Form->selectDate() #3 {main} thrown in /var/www/dolibarr.mysrv/chroot/htdocs/core/lib/functions.lib.php on line 2930"" while reading upstream, client: <someIP>, server: dolibarr.mysrv, request: ""GET /fourn/facture/paiement.php?facid=423&action=create&page_y=36 HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php/fpm-dolibarr.mysrv.sock:"", host: ""dolibarr.mysrv"", referrer: ""https://dolibarr.mysrv/fourn/facture/card.php?facid=423&save_lastsearch_values=1"" 2023/08/31 12:55:10 [error] 3931785#3931785: *685398 FastCGI sent in stderr: ""PHP message: PHP Fatal error: Uncaught TypeError: array_sum(): Argument #1 ($array) must be of type array, string given in /var/www/dolibarr.mysrv/chroot/htdocs/compta/ajaxpayment.php:84 Stack trace: #0 /var/www/dolibarr.mysrv/chroot/htdocs/compta/ajaxpayment.php(84): array_sum() #1 {main} thrown in /var/www/dolibarr.mysrv/chroot/htdocs/compta/ajaxpayment.php on line 84"" while reading response header from upstream, client: 2003:e7:6711:4400:7804:e1dd:c47d:e213, server: dolibarr.mysrv, request: ""POST /compta/ajaxpayment.php HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php/fpm-dolibarr.mysrv.sock:"", host: ""dolibarr.mysrv"", referrer: ""https://dolibarr.mysrv/fourn/facture/paiement.php?facid=423&action=create&page_y=36""   Environment Version 18.0.0  Environment OS Debian GNU/Linux 11  Environment Web server nginx  Environment PHP PHP 8.1.22  Environment Database Ver 15.1 Distrib 10.6.15-MariaDB  Environment URL(s) _No response_  Expected and actual behavior Being able to see the full ""payments"" screen. The current behaviour happens in all available browser (Chrome, Safari, FireFox) and as well in anonymous mode.  Steps to reproduce the behavior I have no clue what changed, as it was working with all the given versions beforehand. After entering a payment, it stopped working randomly  Attached files _No response_",other-file | other-file,"Entering supplier payments not possible anymore  Bug I've just successfully entered a supplier payment and when hovering to the next payment, i am not seeing the full screen any longer. The screen looks like this: ![image](https://github.com/Dolibarr/dolibarr/assets/5146717/61d66949-0f66-4112-95fb-236cd5f10312) PHP 8.1 (also tried with php8.2) Logs say the following  2023/08/31 12:55:10 [error] 3931785#3931785: *685396 FastCGI sent in stderr: ""PHP message: PHP Warning: Undefined array key ""labeladddateof"" in /var/www/dolibarr.mysrv/chroot/htdocs/core/class/html.form.class.php on line 7076; PHP message: PHP Fatal error: Uncaught TypeError: DateTime::setTimestamp(): Argument #1 ($timestamp) must be of type int, string given in /var/www/dolibarr.mysrv/chroot/htdocs/core/lib/functions.lib.php:2930 Stack trace: #0 /var/www/dolibarr.mysrv/chroot/htdocs/core/lib/functions.lib.php(2930): DateTime->setTimestamp() #1 /var/www/dolibarr.mysrv/chroot/htdocs/core/class/html.form.class.php(7077): dol_getdate() #2 /var/www/dolibarr.mysrv/chroot/htdocs/fourn/facture/paiement.php(512): Form->selectDate() #3 {main} thrown in /var/www/dolibarr.mysrv/chroot/htdocs/core/lib/functions.lib.php on line 2930"" while reading upstream, client: <someIP>, server: dolibarr.mysrv, request: ""GET /fourn/facture/paiement.php?facid=423&action=create&page_y=36 HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php/fpm-dolibarr.mysrv.sock:"", host: ""dolibarr.mysrv"", referrer: ""https://dolibarr.mysrv/fourn/facture/card.php?facid=423&save_lastsearch_values=1"" 2023/08/31 12:55:10 [error] 3931785#3931785: *685398 FastCGI sent in stderr: ""PHP message: PHP Fatal error: Uncaught TypeError: array_sum(): Argument #1 ($array) must be of type array, string given in /var/www/dolibarr.mysrv/chroot/htdocs/compta/ajaxpayment.php:84 Stack trace: #0 /var/www/dolibarr.mysrv/chroot/htdocs/compta/ajaxpayment.php(84): array_sum() #1 {main} thrown in /var/www/dolibarr.mysrv/chroot/htdocs/compta/ajaxpayment.php on line 84"" while reading response header from upstream, client: 2003:e7:6711:4400:7804:e1dd:c47d:e213, server: dolibarr.mysrv, request: ""POST /compta/ajaxpayment.php HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php/fpm-dolibarr.mysrv.sock:"", host: ""dolibarr.mysrv"", referrer: ""https://dolibarr.mysrv/fourn/facture/paiement.php?facid=423&action=create&page_y=36""   Environment Version 18.0.0  Environment OS Debian GNU/Linux 11  Environment Web server nginx  Environment PHP PHP 8.1.22  Environment Database Ver 15.1 Distrib 10.6.15-MariaDB  Environment URL(s) _No response_  Expected and actual behavior Being able to see the full ""payments"" screen. The current behaviour happens in all available browser (Chrome, Safari, FireFox) and as well in anonymous mode.  Steps to reproduce the behavior I have no clue what changed, as it was working with all the given versions beforehand. After entering a payment, it stopped working randomly  Attached files _No response_ other-file other-file",no-bug,0.8
33563,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33563,Discount count twice when create a discount from a deposit invoice," Bug When a discount is created from a deposit invoice with a line containing a parent product and children, the discount got a wrong value  Dolibarr Version develop  Environment PHP PHP 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Create an order with this parent product and children : ![Image](https://github.com/user-attachments/assets/b819569c-3f1b-4851-8dc5-b1e0e6f845d0) 2. Create a deposit invoice with variable amount on all lines ![Image](https://github.com/user-attachments/assets/28aa8e44-835e-4400-ad3a-5bee81190d6e) 3. Create a payment of this deposit invoice ![Image](https://github.com/user-attachments/assets/8ccc55ba-05cc-4df2-8027-37cef6cad9c0) 4. Check the discount on this deposit invoice ![Image](https://github.com/user-attachments/assets/4748f599-aa0c-4d32-a350-68e5e6acf78c) **The discount amount is not equal to the amount of payment**  Attached files _No response_",other-file | other-file,"Discount count twice when create a discount from a deposit invoice  Bug When a discount is created from a deposit invoice with a line containing a parent product and children, the discount got a wrong value  Dolibarr Version develop  Environment PHP PHP 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Create an order with this parent product and children : ![Image](https://github.com/user-attachments/assets/b819569c-3f1b-4851-8dc5-b1e0e6f845d0) 2. Create a deposit invoice with variable amount on all lines ![Image](https://github.com/user-attachments/assets/28aa8e44-835e-4400-ad3a-5bee81190d6e) 3. Create a payment of this deposit invoice ![Image](https://github.com/user-attachments/assets/8ccc55ba-05cc-4df2-8027-37cef6cad9c0) 4. Check the discount on this deposit invoice ![Image](https://github.com/user-attachments/assets/4748f599-aa0c-4d32-a350-68e5e6acf78c) **The discount amount is not equal to the amount of payment**  Attached files _No response_ other-file other-file",no-bug,0.9
26536,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26536,Divided lines in the bank account balance," Bug [EN] We migrated from version 16 to version 18.0.2. Since, some accounts are divided into several lines in the balance. The total remains correct, but impossible to find a common point between these divided lines. Yesterday, we updated to version 18.0.3. On 2023 some lines have disappeared, only 2 accounts remain (5121110 and 602250), but on 2022 it's worse than before, new divided lines appeared. I can send more screeshots or give you access to our Dolibarr online if needed. [FR] Nous avons migr de la version 16  la version 18.0.2. Depuis, certains comptes sont diviss en plusieurs lignes dans la balance. Le total reste bon, mais impossible de trouver un point commun entre ces lignes divises. Hier, nous avons fait la mise  jour vers la version 18.0.3, sur 2023 certaines lignes ont disparues, il n'en reste plus que sur 2 comptes (5121110 et 602250), par contre sur 2022 cela a empir, d'autres lignes sont apparues. Je peux envoyer d'autres captures d'cran ou vous donner la main sur notre instance en ligne.  Environment Version 18.0.3  Environment OS Debian 5.10.197-1  Environment Web server Apache 2  Environment PHP 8.1.25  Environment Database mysqlnd 8.1.25  Environment URL(s) accountancy/bookkeeping/balance.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![exemple 1](https://github.com/Dolibarr/dolibarr/assets/45743169/35af795e-601d-4ea6-a28b-7f1b82dd42e0) ![exemple 2](https://github.com/Dolibarr/dolibarr/assets/45743169/921e9706-cf5b-412b-858c-09481d7f2789)",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Divided lines in the bank account balance  Bug [EN] We migrated from version 16 to version 18.0.2. Since, some accounts are divided into several lines in the balance. The total remains correct, but impossible to find a common point between these divided lines. Yesterday, we updated to version 18.0.3. On 2023 some lines have disappeared, only 2 accounts remain (5121110 and 602250), but on 2022 it's worse than before, new divided lines appeared. I can send more screeshots or give you access to our Dolibarr online if needed. [FR] Nous avons migr de la version 16  la version 18.0.2. Depuis, certains comptes sont diviss en plusieurs lignes dans la balance. Le total reste bon, mais impossible de trouver un point commun entre ces lignes divises. Hier, nous avons fait la mise  jour vers la version 18.0.3, sur 2023 certaines lignes ont disparues, il n'en reste plus que sur 2 comptes (5121110 et 602250), par contre sur 2022 cela a empir, d'autres lignes sont apparues. Je peux envoyer d'autres captures d'cran ou vous donner la main sur notre instance en ligne.  Environment Version 18.0.3  Environment OS Debian 5.10.197-1  Environment Web server Apache 2  Environment PHP 8.1.25  Environment Database mysqlnd 8.1.25  Environment URL(s) accountancy/bookkeeping/balance.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![exemple 1](https://github.com/Dolibarr/dolibarr/assets/45743169/35af795e-601d-4ea6-a28b-7f1b82dd42e0) ![exemple 2](https://github.com/Dolibarr/dolibarr/assets/45743169/921e9706-cf5b-412b-858c-09481d7f2789) other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
28963,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28963,"When an order is invoiced, its status does not change to Billed in the list of orders"," Bug To check the error we carry out this process: 1) We create an order and its status is correctly shown as not billed ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/540a94ac-a37c-4b38-bee6-8f49d0b20eb3) 2) We proceed to create an invoice from that order. To do this, I open the order and create the invoice. ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/89d6cb6e-df1c-47b5-8130-a669966b3251) I validate the invoice and, as you can see, the invoice is linked to the order. ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/4f0f773d-b2ea-4884-bb0e-37375ce75f39) Finally I go to the order list and as you can see the invoice thas was validated is not shown as (Billed) as it should. ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/23da6008-b331-47cd-8393-f6946b884ca0) To fix this error, the way I found to fix it is: In the file htdocs/fourn/facture/card.php i add this after line 231. We insert the following code after line 238 elseif($acion==confirm_valid && $confirm==yes && $usercanvalidate){ This coniditional applies when the user has validaled and confirmed an order. and within that conditional there is another conditional: if(!$error){ which tells us that no error has ocurred. Then it calls the validate function and then there is a conditional in which we indicate if there has been an error. If there is and error , we show it. If not, then this is where I have added the additional lines of code that correct the error. $objectfechObjectLinked(); I load all items associated with that invoice. I check that there is an element of type order supplier associated with that invoice: if(array_key_exists(order_supplier,$objectlinkedObjects)){ $linkedObjectBlock=$objectlinkedObjects[order_supplier]; I check that there only one order associated with an invoice because when there are several orders associated with an invoice, it is done correctly. if(count($linkedObjectBlock)==1){ In case that there is only one order associated with an invoice, I go through all the elements associated with the invoice of type order_supplier and I classify that order using the ""ClassifyBilled"" method. foreach($linkedObjectBlock as $key =>$objectlink){ $objectlink->classifyBilled($user) } } } ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/cec680d0-62d2-415a-b816-97860610a174)  Dolibarr Version 19.0  Environment PHP 8.1  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file,"When an order is invoiced, its status does not change to Billed in the list of orders  Bug To check the error we carry out this process: 1) We create an order and its status is correctly shown as not billed ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/540a94ac-a37c-4b38-bee6-8f49d0b20eb3) 2) We proceed to create an invoice from that order. To do this, I open the order and create the invoice. ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/89d6cb6e-df1c-47b5-8130-a669966b3251) I validate the invoice and, as you can see, the invoice is linked to the order. ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/4f0f773d-b2ea-4884-bb0e-37375ce75f39) Finally I go to the order list and as you can see the invoice thas was validated is not shown as (Billed) as it should. ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/23da6008-b331-47cd-8393-f6946b884ca0) To fix this error, the way I found to fix it is: In the file htdocs/fourn/facture/card.php i add this after line 231. We insert the following code after line 238 elseif($acion==confirm_valid && $confirm==yes && $usercanvalidate){ This coniditional applies when the user has validaled and confirmed an order. and within that conditional there is another conditional: if(!$error){ which tells us that no error has ocurred. Then it calls the validate function and then there is a conditional in which we indicate if there has been an error. If there is and error , we show it. If not, then this is where I have added the additional lines of code that correct the error. $objectfechObjectLinked(); I load all items associated with that invoice. I check that there is an element of type order supplier associated with that invoice: if(array_key_exists(order_supplier,$objectlinkedObjects)){ $linkedObjectBlock=$objectlinkedObjects[order_supplier]; I check that there only one order associated with an invoice because when there are several orders associated with an invoice, it is done correctly. if(count($linkedObjectBlock)==1){ In case that there is only one order associated with an invoice, I go through all the elements associated with the invoice of type order_supplier and I classify that order using the ""ClassifyBilled"" method. foreach($linkedObjectBlock as $key =>$objectlink){ $objectlink->classifyBilled($user) } } } ![image](https://github.com/Dolibarr/dolibarr/assets/120027058/cec680d0-62d2-415a-b816-97860610a174)  Dolibarr Version 19.0  Environment PHP 8.1  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
29353,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29353,Hidden extrafields of type boolean are set to 0 on update," Bug Hidden extrafields of type boolean are set to 0 on update. Can only happen with extrafields in positions of commercial elements (facture, propal, commande, etc)  Dolibarr Version 18, 19, develop  Environment PHP na  Environment Database na  Steps to reproduce the behavior and expected behavior 1. Create an extrafield of type boolean for an invoice or proposal or order on the lines (DB: det_extrafields) and set visibility to 1 2. Create a new line (position) of an element where you have created the extrafield and enable the checkbox 3. Set the visibility of the extrafield created in step 1 to 0 4. Edit the line which has been created in step 2. Doesn't matter what is changed, just important to push the ""save"" button 5. Set the visibility of the extrafield created in step 1 to 1 6. View the line created in step 2 - Checkbox is not set (value 0)  Attached files _No response_",other-file | other-file,"Hidden extrafields of type boolean are set to 0 on update  Bug Hidden extrafields of type boolean are set to 0 on update. Can only happen with extrafields in positions of commercial elements (facture, propal, commande, etc)  Dolibarr Version 18, 19, develop  Environment PHP na  Environment Database na  Steps to reproduce the behavior and expected behavior 1. Create an extrafield of type boolean for an invoice or proposal or order on the lines (DB: det_extrafields) and set visibility to 1 2. Create a new line (position) of an element where you have created the extrafield and enable the checkbox 3. Set the visibility of the extrafield created in step 1 to 0 4. Edit the line which has been created in step 2. Doesn't matter what is changed, just important to push the ""save"" button 5. Set the visibility of the extrafield created in step 1 to 1 6. View the line created in step 2 - Checkbox is not set (value 0)  Attached files _No response_ other-file other-file",no-bug,0.8
24798,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24798,Deleting member subscription is not possible anymore," Bug When trying to delete a subscription of one member dolibarr throw this error Fatal error: Uncaught Error: Call to undefined method Subscription::getFullName() in htdocs/core/triggers/interface_50_modAgenda_ActionsAuto.class.php:767 Stack trace: #0 htdocs/core/class/interfaces.class.php(183): InterfaceActionsAuto->runTrigger('MEMBER_SUBSCRIP', Object(Subscription), Object(User), Object(Translate), Object(Conf)) #1 htdocs/core/class/commonobject.class.php(5758): Interfaces->run_triggers('MEMBER_SUBSCRIP', Object(Subscription), Object(User), Object(Translate), Object(Conf)) #2 htdocs/adherents/class/subscription.class.php(340): CommonObject->call_trigger('MEMBER_SUBSCRIP', Object(User)) #3 htdocs/adherents/subscription/card.php(146): Subscription->delete(Object(User)) #4 {main} thrown in htdocs/core/triggers/interface_50_modAgenda_ActionsAuto.class.php on line 767  Environment Version develop  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Deleting member subscription is not possible anymore  Bug When trying to delete a subscription of one member dolibarr throw this error Fatal error: Uncaught Error: Call to undefined method Subscription::getFullName() in htdocs/core/triggers/interface_50_modAgenda_ActionsAuto.class.php:767 Stack trace: #0 htdocs/core/class/interfaces.class.php(183): InterfaceActionsAuto->runTrigger('MEMBER_SUBSCRIP', Object(Subscription), Object(User), Object(Translate), Object(Conf)) #1 htdocs/core/class/commonobject.class.php(5758): Interfaces->run_triggers('MEMBER_SUBSCRIP', Object(Subscription), Object(User), Object(Translate), Object(Conf)) #2 htdocs/adherents/class/subscription.class.php(340): CommonObject->call_trigger('MEMBER_SUBSCRIP', Object(User)) #3 htdocs/adherents/subscription/card.php(146): Subscription->delete(Object(User)) #4 {main} thrown in htdocs/core/triggers/interface_50_modAgenda_ActionsAuto.class.php on line 767  Environment Version develop  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
29439,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29439,API GET /documents doesn't return all information," Bug Hi, I use API to retrive share link of my invoices. After some tests it seemed OK but I don't know why, GET /documents returned content is not consistent. Exampel using API explorer : GET api/index.php/documents?modulepart=invoice&id=226  [ { ""name"": ""FA2403-0183.pdf"", ""path"": ""/var/lib/dolibarr/documents/facture/FA2403-0183"", ""level1name"": ""FA2403-0183"", ""relativename"": ""FA2403-0183.pdf"", ""fullname"": ""/var/lib/dolibarr/documents/facture/FA2403-0183/FA2403-0183.pdf"", ""date"": 1710515325, ""size"": 67051, ""type"": ""file"", ""label"": ""XXXXXXXXXX"", ""entity"": ""1"", ""filename"": ""FA2403-0183.pdf"", ""filepath"": ""facture/FA2403-0183"", ""fullpath_orig"": """", ""description"": """", ""keywords"": """", ""cover"": null, ""position"": ""1"", ""gen_or_uploaded"": ""generated"", ""extraparams"": null, ""date_c"": 1710515325, ""date_m"": 1710515325, ""fk_user_c"": ""1"", ""fk_user_m"": null, ""acl"": null, ""src_object_type"": ""facture"", ""src_object_id"": ""226"", ""id"": ""682"", ""ref"": ""682"", ""share"": ""XXXXXXXXXXXX"" } ]  GET api/index.php/documents?modulepart=invoice&id=251  [ { ""name"": ""FA2404-0204.pdf"", ""path"": ""/var/lib/dolibarr/documents/facture/FA2404-0204"", ""level1name"": ""FA2404-0204"", ""relativename"": ""FA2404-0204.pdf"", ""fullname"": ""/var/lib/dolibarr/documents/facture/FA2404-0204/FA2404-0204.pdf"", ""date"": 1713257786, ""size"": 67550, ""type"": ""file"" } ]  Both in webUI have a share link for example. I can't get what could lead to this difference of behaviour  Regards  Dolibarr Version 18.0.4  Environment PHP 7.4  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ ## EDIT Ok I'm close from a solution :) I found the problem but don't know exactly how to solve it  And maybe there are two bugs in one So in /htdocs/api/class/api_documents.class.php there is the main function, which call for fetchAll() of htdocs/ecm/class/ecmfiles.class.php The problem here is that the SQL built use ""LIKE"" in WHERE condition. In my case, I'm looking for an invoice. But if the src_object_id exists for different objects, multiple lines are return. So maybe it's the bug n1 because ""LIKE %facture%"" also returns ""facture_fourn"" type for example. So if multiple lines are returned by fetchAll() , this code is invloved :  $result = $ecmfile->fetchAll('', '', 0, 0, array('t.src_object_type' => $objectType, 't.src_object_id' => $object->id)); if ($result < 0) { throw new RestException(503, 'Error when retrieve ecm list : '.$this->db->lasterror()); } elseif (is_array($ecmfile->lines) && count($ecmfile->lines) > 0) { $count = count($filearray); for ($i = 0 ; $i < $count ; $i++) { if ($filearray[$i]['name'] == $ecmfile->lines[$i]->filename) { $filearray[$i] = array_merge($filearray[$i], (array) $ecmfile->lines[0]); } } }  And it seems not able to healthy manage this case because I debuged it, if ($filearray[$i]['name'] == $ecmfile->lines[$i]->filename) is never triggered (I'm still searching for a solution on this part). So it's bug n2 ## EDIT 2 Solved :)  if ($filearray[$i]['name'] == $ecmfile->lines[$i]->filename) { $filearray[$i] = array_merge($filearray[$i], (array) $ecmfile->lines[0]); }  Replaced by  foreach ($ecmfile->lines as $line) { if ($filearray[$i]['name'] == $line->filename) { $filearray[$i] = array_merge($filearray[$i], (array) $line); } }  Allows to scan all files returned in $ecmfiles for each file in $filearray, and merge them if filenames match",other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"API GET /documents doesn't return all information  Bug Hi, I use API to retrive share link of my invoices. After some tests it seemed OK but I don't know why, GET /documents returned content is not consistent. Exampel using API explorer : GET api/index.php/documents?modulepart=invoice&id=226  [ { ""name"": ""FA2403-0183.pdf"", ""path"": ""/var/lib/dolibarr/documents/facture/FA2403-0183"", ""level1name"": ""FA2403-0183"", ""relativename"": ""FA2403-0183.pdf"", ""fullname"": ""/var/lib/dolibarr/documents/facture/FA2403-0183/FA2403-0183.pdf"", ""date"": 1710515325, ""size"": 67051, ""type"": ""file"", ""label"": ""XXXXXXXXXX"", ""entity"": ""1"", ""filename"": ""FA2403-0183.pdf"", ""filepath"": ""facture/FA2403-0183"", ""fullpath_orig"": """", ""description"": """", ""keywords"": """", ""cover"": null, ""position"": ""1"", ""gen_or_uploaded"": ""generated"", ""extraparams"": null, ""date_c"": 1710515325, ""date_m"": 1710515325, ""fk_user_c"": ""1"", ""fk_user_m"": null, ""acl"": null, ""src_object_type"": ""facture"", ""src_object_id"": ""226"", ""id"": ""682"", ""ref"": ""682"", ""share"": ""XXXXXXXXXXXX"" } ]  GET api/index.php/documents?modulepart=invoice&id=251  [ { ""name"": ""FA2404-0204.pdf"", ""path"": ""/var/lib/dolibarr/documents/facture/FA2404-0204"", ""level1name"": ""FA2404-0204"", ""relativename"": ""FA2404-0204.pdf"", ""fullname"": ""/var/lib/dolibarr/documents/facture/FA2404-0204/FA2404-0204.pdf"", ""date"": 1713257786, ""size"": 67550, ""type"": ""file"" } ]  Both in webUI have a share link for example. I can't get what could lead to this difference of behaviour  Regards  Dolibarr Version 18.0.4  Environment PHP 7.4  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ ## EDIT Ok I'm close from a solution :) I found the problem but don't know exactly how to solve it  And maybe there are two bugs in one So in /htdocs/api/class/api_documents.class.php there is the main function, which call for fetchAll() of htdocs/ecm/class/ecmfiles.class.php The problem here is that the SQL built use ""LIKE"" in WHERE condition. In my case, I'm looking for an invoice. But if the src_object_id exists for different objects, multiple lines are return. So maybe it's the bug n1 because ""LIKE %facture%"" also returns ""facture_fourn"" type for example. So if multiple lines are returned by fetchAll() , this code is invloved :  $result = $ecmfile->fetchAll('', '', 0, 0, array('t.src_object_type' => $objectType, 't.src_object_id' => $object->id)); if ($result < 0) { throw new RestException(503, 'Error when retrieve ecm list : '.$this->db->lasterror()); } elseif (is_array($ecmfile->lines) && count($ecmfile->lines) > 0) { $count = count($filearray); for ($i = 0 ; $i < $count ; $i++) { if ($filearray[$i]['name'] == $ecmfile->lines[$i]->filename) { $filearray[$i] = array_merge($filearray[$i], (array) $ecmfile->lines[0]); } } }  And it seems not able to healthy manage this case because I debuged it, if ($filearray[$i]['name'] == $ecmfile->lines[$i]->filename) is never triggered (I'm still searching for a solution on this part). So it's bug n2 ## EDIT 2 Solved :)  if ($filearray[$i]['name'] == $ecmfile->lines[$i]->filename) { $filearray[$i] = array_merge($filearray[$i], (array) $ecmfile->lines[0]); }  Replaced by  foreach ($ecmfile->lines as $line) { if ($filearray[$i]['name'] == $line->filename) { $filearray[$i] = array_merge($filearray[$i], (array) $line); } }  Allows to scan all files returned in $ecmfiles for each file in $filearray, and merge them if filenames match other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",bug,0.95
31677,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31677,Bug: API Missing Support BomLine DefaultWorkstationId, Bug DefaultWorkstationId is not implemented in the API.  Dolibarr Version 20  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file,Bug: API Missing Support BomLine DefaultWorkstationId  Bug DefaultWorkstationId is not implemented in the API.  Dolibarr Version 20  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file,bug,0.8
27215,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27215,Price HT becomes TTC when HT is empty in invoice/commande lines," Bug When I edit an order line and only fill the TTC value of the line and the HT value is left empty, the HT value is replaced by the TTC value. Steps to reproduce : add order line with a predefined product with a sell price. Click on edit line and remove the HT price. Click on save and watch how the HT is replaced by the TTC price. <img width=""794"" alt=""Screenshot 2023-12-23 140935"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/9211d6e7-9c5e-4f85-936a-7ac7368e0448""> <img width=""788"" alt=""Screenshot 2023-12-23 141005"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/bf8f7aad-be24-4ebe-ab84-f3684a0683ec""> <img width=""787"" alt=""Screenshot 2023-12-23 141034"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/ff0f0e76-de68-430f-a8b5-016a54c102d4""> In the code I saw that this is explicit behaviour, but I am almost certain this shouldn't work this way. If confirmed I will gladly remove this code. <img width=""254"" alt=""Screenshot 2023-12-23 141110"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/79b95547-b38d-4d68-b9d6-9434be20cb29""> <img width=""223"" alt=""Screenshot 2023-12-23 141133"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/677eb2ca-f905-4c05-8b48-8d5dfec3b89a"">  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Price HT becomes TTC when HT is empty in invoice/commande lines  Bug When I edit an order line and only fill the TTC value of the line and the HT value is left empty, the HT value is replaced by the TTC value. Steps to reproduce : add order line with a predefined product with a sell price. Click on edit line and remove the HT price. Click on save and watch how the HT is replaced by the TTC price. <img width=""794"" alt=""Screenshot 2023-12-23 140935"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/9211d6e7-9c5e-4f85-936a-7ac7368e0448""> <img width=""788"" alt=""Screenshot 2023-12-23 141005"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/bf8f7aad-be24-4ebe-ab84-f3684a0683ec""> <img width=""787"" alt=""Screenshot 2023-12-23 141034"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/ff0f0e76-de68-430f-a8b5-016a54c102d4""> In the code I saw that this is explicit behaviour, but I am almost certain this shouldn't work this way. If confirmed I will gladly remove this code. <img width=""254"" alt=""Screenshot 2023-12-23 141110"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/79b95547-b38d-4d68-b9d6-9434be20cb29""> <img width=""223"" alt=""Screenshot 2023-12-23 141133"" src=""https://github.com/Dolibarr/dolibarr/assets/93868548/677eb2ca-f905-4c05-8b48-8d5dfec3b89a"">  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
28670,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28670,show image in a line description of a proposal PDF," Feature Request /!\ I don't speak about showing a article picture in a picture column, I know that is possible with the Setup > PDF > Other > Add column for picture on proposal lines When you set `FCKEDITOR_ENABLE_DETAILS_FULL` to 1 you can **add images with the WYSIWYG bar**. But, in a proposal, a local picture **select by the buton ""Browse Server""** is not show in the PDF (he is visible in the description in the web page but not in the azur PDF). the URL of the picture show in the ""Image Properties"" popup is `/dolibarr/viewimage.php?modulepart=medias&entity=1&file=image/mypicture.jpg` if I put a full URL of a external picture (from an other website) it's OK in de webpage **AND in the PDF**  Use case _No response_  Suggested implementation it is possible by adding this line : `$labelproductservice = preg_replace('/(<img[^>]*src="")[^\""]*viewimage\.php[^\""]*modulepart=medias[^\""]*file=([^\""]*)/', '\1file:/'.DOL_DATA_ROOT.'/medias/\2\3', $labelproductservice, -1, $nbrep);` after the line : `$labelproductservice = preg_replace('/(<img[^>]*src="")([^""]*)(&amp;)([^""]*"")/', '\1\2&\4', $labelproductservice, -1, $nbrep);` in the function `pdf_writelinedesc()` in the file `htdocs\core\lib\pdf.lib.php` can you implement it in a future version ?  Suggested steps _No response_",other-file | other-file,"show image in a line description of a proposal PDF  Feature Request /!\ I don't speak about showing a article picture in a picture column, I know that is possible with the Setup > PDF > Other > Add column for picture on proposal lines When you set `FCKEDITOR_ENABLE_DETAILS_FULL` to 1 you can **add images with the WYSIWYG bar**. But, in a proposal, a local picture **select by the buton ""Browse Server""** is not show in the PDF (he is visible in the description in the web page but not in the azur PDF). the URL of the picture show in the ""Image Properties"" popup is `/dolibarr/viewimage.php?modulepart=medias&entity=1&file=image/mypicture.jpg` if I put a full URL of a external picture (from an other website) it's OK in de webpage **AND in the PDF**  Use case _No response_  Suggested implementation it is possible by adding this line : `$labelproductservice = preg_replace('/(<img[^>]*src="")[^\""]*viewimage\.php[^\""]*modulepart=medias[^\""]*file=([^\""]*)/', '\1file:/'.DOL_DATA_ROOT.'/medias/\2\3', $labelproductservice, -1, $nbrep);` after the line : `$labelproductservice = preg_replace('/(<img[^>]*src="")([^""]*)(&amp;)([^""]*"")/', '\1\2&\4', $labelproductservice, -1, $nbrep);` in the function `pdf_writelinedesc()` in the file `htdocs\core\lib\pdf.lib.php` can you implement it in a future version ?  Suggested steps _No response_ other-file other-file",no-bug,0.9
25458,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25458,"Not able to translate the string ""Done"" (intervention status)"," Bug The interventions list shows some status: validated, done but ""Done"" can not be translated, there is no string to do it.  Environment Version 17.0.2  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"Not able to translate the string ""Done"" (intervention status)  Bug The interventions list shows some status: validated, done but ""Done"" can not be translated, there is no string to do it.  Environment Version 17.0.2  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.9
33117,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33117,An offset occured in Quadratus export file from accountancy bookeeping, Bug An offset occured in Quadratus export file from accountancy bookeeping - when you export a Quadratus file from accountancy bookeeping in some cases you got not enough spaces between piece num and attached file name  Dolibarr Version 18.0 until develop  Environment PHP 7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Go to accountancy export 2. Choose to export in Quadratus file with source files 3. Check the file exported 4. You see some offset between similar lines with attached files  Attached files _No response_,other-file,An offset occured in Quadratus export file from accountancy bookeeping  Bug An offset occured in Quadratus export file from accountancy bookeeping - when you export a Quadratus file from accountancy bookeeping in some cases you got not enough spaces between piece num and attached file name  Dolibarr Version 18.0 until develop  Environment PHP 7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Go to accountancy export 2. Choose to export in Quadratus file with source files 3. Check the file exported 4. You see some offset between similar lines with attached files  Attached files _No response_ other-file,no-bug,0.9
27278,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27278,Add admin feature to manage MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND," Feature Request Add an admin - config feature to handle MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND in config screen ""limits and precision""  Use case Now you're obliged to set the const directly in database, it would be convenient to manage this in config  Suggested implementation _No response_  Suggested steps _No response_",other-file | other-file | other-file | other-file | other-file,"Add admin feature to manage MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND  Feature Request Add an admin - config feature to handle MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND in config screen ""limits and precision""  Use case Now you're obliged to set the const directly in database, it would be convenient to manage this in config  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file other-file",no-bug,0.95
32930,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32930,"natural_search remove """" from SQL statement"," Bug Have ""BUY"" as danish ""KB"" in the database [llx_accounting_bookkeeping] and do a search in accountancy/bookkeeping/list.php gives wrong SQL : SELECT COUNT(*) as nbtotalofrecords FROM llx_accounting_bookkeeping as t WHERE t.entity IN (1) AND t.doc_date >= '2025-01-01 00:00:00' AND t.doc_date <= '2025-12-31 23:59:59' AND (t.code_journal IN ('KB')) should be: SELECT COUNT(*) as nbtotalofrecords FROM llx_accounting_bookkeeping as t WHERE t.entity IN (1) AND t.doc_date >= '2025-01-01 00:00:00' AND t.doc_date <= '2025-12-31 23:59:59' AND (t.code_journal IN ('KB')) Some how natural_search remove the """" and may be also - (have not tested)  Dolibarr Version _No response_  Environment PHP 8.2  Environment Database mysqli  Steps to reproduce the behavior and expected behavior Use danish language  Attached files _No response_",other-file | test-file,"natural_search remove """" from SQL statement  Bug Have ""BUY"" as danish ""KB"" in the database [llx_accounting_bookkeeping] and do a search in accountancy/bookkeeping/list.php gives wrong SQL : SELECT COUNT(*) as nbtotalofrecords FROM llx_accounting_bookkeeping as t WHERE t.entity IN (1) AND t.doc_date >= '2025-01-01 00:00:00' AND t.doc_date <= '2025-12-31 23:59:59' AND (t.code_journal IN ('KB')) should be: SELECT COUNT(*) as nbtotalofrecords FROM llx_accounting_bookkeeping as t WHERE t.entity IN (1) AND t.doc_date >= '2025-01-01 00:00:00' AND t.doc_date <= '2025-12-31 23:59:59' AND (t.code_journal IN ('KB')) Some how natural_search remove the """" and may be also - (have not tested)  Dolibarr Version _No response_  Environment PHP 8.2  Environment Database mysqli  Steps to reproduce the behavior and expected behavior Use danish language  Attached files _No response_ other-file test-file",no-bug,0.9
24080,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24080,Modify product extra field (mass action) : translation not done," Bug When we use mass action ""modify extra field"" on product listing, the extra field select values are not translated.  Environment Version 16.0.4  Environment OS Linux homestead 5.4.0-131-generic #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 x86_64  Environment Web server Apache/2.4.41 (Ubuntu)  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 8.0.31-0ubuntu0.20.04.1  Environment URL(s) /product/list.php  Expected and actual behavior Values in extra field select should be translated using $langs->trans() function. In this case, values in extra field select should be : - ""Attribut supplmentaire 2"" - ""Attribut supplmentaire 1"" - ""Attribut supplmentaire 3""  Steps to reproduce the behavior - Add a product extrafield with translation key - Add translation of translation key - Go to product listing - Select one product or more - Select ""Modify extra field"" mass action - Extra field select values are not translated  Attached files ![1](https://user-images.githubusercontent.com/9167207/222087129-b917a60b-445e-4472-9478-aa4471d5838f.png) ![2](https://user-images.githubusercontent.com/9167207/222087134-93e9e601-afbb-421e-b61b-d429ee12c093.png) ![3](https://user-images.githubusercontent.com/9167207/222087137-52c21f15-f8eb-4a26-9c16-426b0e6a87d4.png)",other-file | other-file,"Modify product extra field (mass action) : translation not done  Bug When we use mass action ""modify extra field"" on product listing, the extra field select values are not translated.  Environment Version 16.0.4  Environment OS Linux homestead 5.4.0-131-generic #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 x86_64  Environment Web server Apache/2.4.41 (Ubuntu)  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 8.0.31-0ubuntu0.20.04.1  Environment URL(s) /product/list.php  Expected and actual behavior Values in extra field select should be translated using $langs->trans() function. In this case, values in extra field select should be : - ""Attribut supplmentaire 2"" - ""Attribut supplmentaire 1"" - ""Attribut supplmentaire 3""  Steps to reproduce the behavior - Add a product extrafield with translation key - Add translation of translation key - Go to product listing - Select one product or more - Select ""Modify extra field"" mass action - Extra field select values are not translated  Attached files ![1](https://user-images.githubusercontent.com/9167207/222087129-b917a60b-445e-4472-9478-aa4471d5838f.png) ![2](https://user-images.githubusercontent.com/9167207/222087134-93e9e601-afbb-421e-b61b-d429ee12c093.png) ![3](https://user-images.githubusercontent.com/9167207/222087137-52c21f15-f8eb-4a26-9c16-426b0e6a87d4.png) other-file other-file",no-bug,0.9
28752,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28752,Fatal Error at adding a new third party, Bug ![image](https://github.com/Dolibarr/dolibarr/assets/115029864/1d111e8b-e728-4b62-804e-a1e246b7438c) Fatal Error is present at the Assigned to Sales Representative part and no button to save is set.  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file | other-file,Fatal Error at adding a new third party  Bug ![image](https://github.com/Dolibarr/dolibarr/assets/115029864/1d111e8b-e728-4b62-804e-a1e246b7438c) Fatal Error is present at the Assigned to Sales Representative part and no button to save is set.  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file,no-bug,0.9
25171,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25171,no function to retrieve contacts of a societe," Bug I mark this as a bug even it's not a real one, even it seems to be I wanted in one of my custom modules to retrieve all contacts of a societe I naturaly tried to use `$societe->list_contact(-1, ""external', );` but even if the societe do have some, no one has been retrieved. The reason : for external contacts, `list_contact` is only looking in `llx_socpeople` table, but, only for societe contacts, these are stored in `llx_societe_contacts` table `llx_societe_contacts` has very a similary structure as `llx_element_contacts`, except for the unique key 'element_id, fk_c_type_contact, fk_socpeople' which is absent of llx_societe_contacts (a same societe can have several contacts of same types). And I looked every where in the code, there is no function to retrieve all contacts (by code) of a societe. I suggest 2 ways to correct this : - delete the unique key in llx_element_contacts, and store societe contacts in this table. If so, no need to modify generic list_contact method - modify generic list_contact method, so that when searching for external societe contacts, it select in llx_societe_contacts table. I'll happy to hear some comments about this !  Environment Version all  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file,"no function to retrieve contacts of a societe  Bug I mark this as a bug even it's not a real one, even it seems to be I wanted in one of my custom modules to retrieve all contacts of a societe I naturaly tried to use `$societe->list_contact(-1, ""external', );` but even if the societe do have some, no one has been retrieved. The reason : for external contacts, `list_contact` is only looking in `llx_socpeople` table, but, only for societe contacts, these are stored in `llx_societe_contacts` table `llx_societe_contacts` has very a similary structure as `llx_element_contacts`, except for the unique key 'element_id, fk_c_type_contact, fk_socpeople' which is absent of llx_societe_contacts (a same societe can have several contacts of same types). And I looked every where in the code, there is no function to retrieve all contacts (by code) of a societe. I suggest 2 ways to correct this : - delete the unique key in llx_element_contacts, and store societe contacts in this table. If so, no need to modify generic list_contact method - modify generic list_contact method, so that when searching for external societe contacts, it select in llx_societe_contacts table. I'll happy to hear some comments about this !  Environment Version all  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file",no-bug,0.9
32111,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32111,Impossible to set the date of a payment using API," Bug At `htdocs/compta/facture/class/api_invoices.class.php` you have: `$paymentobj->datepaye = dol_stringtotime($datepaye);` So the code expects a date string: 2024/11/26 (instead timestamp) but if I try to give a date string I get a response (from DOLIBARR API): Message: Bad Request: Invalid value specified for `datepaye`. Expecting unix timestamp, such as 1732638616 It is not possible to workaround this in my code, so I patched the code to be: `$paymentobj->datepaye = (int) $datepaye;` I don't know/have not checked if other part code of the code is sending date string instead of a timestamp Whatever is the write way to fix this (date string or timestamp), I will use it when this is addressed in a future release, thanks  Dolibarr Version 20.0.1  Environment PHP 8.2  Environment Database _No response_  Steps to reproduce the behavior and expected behavior Use API to created/update a payment  Attached files _No response_",other-file | other-file,"Impossible to set the date of a payment using API  Bug At `htdocs/compta/facture/class/api_invoices.class.php` you have: `$paymentobj->datepaye = dol_stringtotime($datepaye);` So the code expects a date string: 2024/11/26 (instead timestamp) but if I try to give a date string I get a response (from DOLIBARR API): Message: Bad Request: Invalid value specified for `datepaye`. Expecting unix timestamp, such as 1732638616 It is not possible to workaround this in my code, so I patched the code to be: `$paymentobj->datepaye = (int) $datepaye;` I don't know/have not checked if other part code of the code is sending date string instead of a timestamp Whatever is the write way to fix this (date string or timestamp), I will use it when this is addressed in a future release, thanks  Dolibarr Version 20.0.1  Environment PHP 8.2  Environment Database _No response_  Steps to reproduce the behavior and expected behavior Use API to created/update a payment  Attached files _No response_ other-file other-file",bug,0.9
25312,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25312,Support search on extrafields in selectForFormsList," Feature Request It should be possible to use filters on extrafields when referencing an object as foreign key. Example: `'type' => 'integer:Contact:contact/class/contact.class.php:0:(extrafieldname:=:2)'` Right now, only the table of the object itself is loaded.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_",other-file | other-file | other-file | other-file | other-file,"Support search on extrafields in selectForFormsList  Feature Request It should be possible to use filters on extrafields when referencing an object as foreign key. Example: `'type' => 'integer:Contact:contact/class/contact.class.php:0:(extrafieldname:=:2)'` Right now, only the table of the object itself is loaded.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file other-file",no-bug,0.9
23676,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23676,Replenish - displayed info is good but does not seem logic because of treatment," Bug ![image](https://user-images.githubusercontent.com/50403308/214319565-a3b3f88b-79bc-4771-8fa2-a682119440be.png) If a warehouse is specified to prepare the replenish list, the desired stocks and stocks minimum displayed may indicate 0 when it is no specified for this warehouse in particular. Although, the values specified on the product card are used instead (good behaviour) I think, the value must be displayed in another color with a tooltip which explain the fact that this is the value of the product card because no one was specified for the warehouse  Environment Version 17 and older  Environment OS Linux  Environment Web server Linux Debian  Environment PHP php 7.4  Environment Database _No response_  Environment URL(s) htdocs/product/stock/replenish.php  Expected and actual behavior # Expected When no value is specified to stock minimum or desired stock for a warehouse in particular, indicates the value used in another color instead of 0. (The user may misunderstand the reason of this line appears) # Actual The values are 0, but the line appears if the default value matches the condition.  Steps to reproduce the behavior Fresh Dolibarr Activate - Product - Supplier - Stock Create a product with desired / minimum stock to 10 for example Create a warehouse Go to Stock Configuration and allows Desired and Minimum Stock per warehouse-product pair Go to Product -> Warehouse -> Replenish and choose a warehouse before filter The line appears even if you have 0 in stock and 0 in desired stock column P.S. : I will manage this bug soon if nobody is faster ;)  Attached files _No response_",other-file | other-file | other-file | other-file,"Replenish - displayed info is good but does not seem logic because of treatment  Bug ![image](https://user-images.githubusercontent.com/50403308/214319565-a3b3f88b-79bc-4771-8fa2-a682119440be.png) If a warehouse is specified to prepare the replenish list, the desired stocks and stocks minimum displayed may indicate 0 when it is no specified for this warehouse in particular. Although, the values specified on the product card are used instead (good behaviour) I think, the value must be displayed in another color with a tooltip which explain the fact that this is the value of the product card because no one was specified for the warehouse  Environment Version 17 and older  Environment OS Linux  Environment Web server Linux Debian  Environment PHP php 7.4  Environment Database _No response_  Environment URL(s) htdocs/product/stock/replenish.php  Expected and actual behavior # Expected When no value is specified to stock minimum or desired stock for a warehouse in particular, indicates the value used in another color instead of 0. (The user may misunderstand the reason of this line appears) # Actual The values are 0, but the line appears if the default value matches the condition.  Steps to reproduce the behavior Fresh Dolibarr Activate - Product - Supplier - Stock Create a product with desired / minimum stock to 10 for example Create a warehouse Go to Stock Configuration and allows Desired and Minimum Stock per warehouse-product pair Go to Product -> Warehouse -> Replenish and choose a warehouse before filter The line appears even if you have 0 in stock and 0 in desired stock column P.S. : I will manage this bug soon if nobody is faster ;)  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
28485,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28485,PHP Warning: Undefined variable $facture in /fourn/facture/paiement.php on line 840," Bug This warning occur when apply a payment for a vendor invoice  Environment Version 19.0  Environment OS Linux CentOS  Environment Web server Apache  Environment PHP 8.1  Environment Database MariaDB  Environment URL(s) /fourn/facture/paiement.php  Expected and actual behavior Expect do not generate a php warning  Steps to reproduce the behavior On a vendor invoice, enter payment, full fill the form and press Pay button  Attached files _No response_",other-file,"PHP Warning: Undefined variable $facture in /fourn/facture/paiement.php on line 840  Bug This warning occur when apply a payment for a vendor invoice  Environment Version 19.0  Environment OS Linux CentOS  Environment Web server Apache  Environment PHP 8.1  Environment Database MariaDB  Environment URL(s) /fourn/facture/paiement.php  Expected and actual behavior Expect do not generate a php warning  Steps to reproduce the behavior On a vendor invoice, enter payment, full fill the form and press Pay button  Attached files _No response_ other-file",no-bug,0.9
24780,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24780,500 Error - Serialization error during update of custom field," Bug When I attempt to update a custom field from the facture card, I have a unhandled 500 error. I just updated : - dolibarr from 16.0.4 to 17.0.1 - ubuntu 20.04 to 22.04 - php from 7.4 to 8.1 - pgsql from 12.x to 14.7) This custom field is a simple boolean and was working before the bunch of update. Here is the apache log.  [Mon May 15 21:54:34.209985 2023] [php:error] [pid 5655] [client 12.34.56.78:50449] PHP Fatal error: Uncaught Exception: Serialization of 'PgSql\\Connection' is not allowed in /opt/dolibarr/htdocs/core/lib/functions.lib.php:1167\nStack trace:\n#0 /opt/dolibarr/htdocs/core/lib/functions.lib.php(1167): serialize()\n#1 /opt/dolibarr/htdocs/compta/facture/card.php(2875): dol_clone()\n#2 {main}\n thrown in /opt/dolibarr/htdocs/core/lib/functions.lib.php on line 1167, referer: https://myowidolibarr.ca/compta/facture/card.php?id=61&action=edit_extras&token=hiddentoken&attribute=quickbooks&ignorecollapsesetup=1   Environment Version 17.0.1  Environment OS Ubuntu 22.04 LTS  Environment Web server Apache 2.4  Environment PHP php 8.1.2  Environment Database postgresql 14.7  Environment URL(s) /compta/facture/card.php  Expected and actual behavior **Expected behaviour:** Just refresh the page with updated custom field (box checked in my case) **Actual behaviour:** After submit the update of the single custom field, I see the 500 error on my browser.  Steps to reproduce the behavior Pre-requisite: have a (boolean) custom field on invoice card. Create an invoice without filling the custom field. once created (and validated), click the pen near the custom field to enable input, update the custom field and click Update <- and showtime  Attached files Concern my ""quickbooks"" field <img width=""694"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/1232923/ed62bed1-d20e-48a8-b53c-0d03f57017bd""> <img width=""1475"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/1232923/bdd21b75-8db6-4dfb-a482-b6e61a4d16f9"">",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"500 Error - Serialization error during update of custom field  Bug When I attempt to update a custom field from the facture card, I have a unhandled 500 error. I just updated : - dolibarr from 16.0.4 to 17.0.1 - ubuntu 20.04 to 22.04 - php from 7.4 to 8.1 - pgsql from 12.x to 14.7) This custom field is a simple boolean and was working before the bunch of update. Here is the apache log.  [Mon May 15 21:54:34.209985 2023] [php:error] [pid 5655] [client 12.34.56.78:50449] PHP Fatal error: Uncaught Exception: Serialization of 'PgSql\\Connection' is not allowed in /opt/dolibarr/htdocs/core/lib/functions.lib.php:1167\nStack trace:\n#0 /opt/dolibarr/htdocs/core/lib/functions.lib.php(1167): serialize()\n#1 /opt/dolibarr/htdocs/compta/facture/card.php(2875): dol_clone()\n#2 {main}\n thrown in /opt/dolibarr/htdocs/core/lib/functions.lib.php on line 1167, referer: https://myowidolibarr.ca/compta/facture/card.php?id=61&action=edit_extras&token=hiddentoken&attribute=quickbooks&ignorecollapsesetup=1   Environment Version 17.0.1  Environment OS Ubuntu 22.04 LTS  Environment Web server Apache 2.4  Environment PHP php 8.1.2  Environment Database postgresql 14.7  Environment URL(s) /compta/facture/card.php  Expected and actual behavior **Expected behaviour:** Just refresh the page with updated custom field (box checked in my case) **Actual behaviour:** After submit the update of the single custom field, I see the 500 error on my browser.  Steps to reproduce the behavior Pre-requisite: have a (boolean) custom field on invoice card. Create an invoice without filling the custom field. once created (and validated), click the pen near the custom field to enable input, update the custom field and click Update <- and showtime  Attached files Concern my ""quickbooks"" field <img width=""694"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/1232923/ed62bed1-d20e-48a8-b53c-0d03f57017bd""> <img width=""1475"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/1232923/bdd21b75-8db6-4dfb-a482-b6e61a4d16f9""> other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",bug,0.9
24173,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24173,Some fields of a supplier order are always editable after a validation, Bug Some fields of a supplier order are always editable after a validation.  Environment Version 16.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior These fields should only be editable in the draft state.  Steps to reproduce the behavior Create a supplier order and validate it.  Attached files ![image](https://user-images.githubusercontent.com/1256948/224071770-6b5fd979-1437-4c91-bf90-bc3dccd0a7b5.png),other-file | other-file,Some fields of a supplier order are always editable after a validation  Bug Some fields of a supplier order are always editable after a validation.  Environment Version 16.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior These fields should only be editable in the draft state.  Steps to reproduce the behavior Create a supplier order and validate it.  Attached files ![image](https://user-images.githubusercontent.com/1256948/224071770-6b5fd979-1437-4c91-bf90-bc3dccd0a7b5.png) other-file other-file,no-bug,0.9
33226,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33226,"Dynamic price ""Back"" link broken since file renaming"," Bug From the page Product > Supplier pric, the dynamic price editor ""back"" link is broken. It tries to return on the page `/product/fournisseurs.php` instead of `/product/supplier_price.php`  Dolibarr Version 20.0, 21.0  Environment PHP 8.2  Environment Database mariaDB  Steps to reproduce the behavior and expected behavior 1. Enable Dynamic price 2. Go to a product page 3. Go to the Buying price tab 4. Add Or edit a price 5. Click on the Price Expression Editor button 6. Click on the ""Back"" button  Attached files _No response_",other-file,"Dynamic price ""Back"" link broken since file renaming  Bug From the page Product > Supplier pric, the dynamic price editor ""back"" link is broken. It tries to return on the page `/product/fournisseurs.php` instead of `/product/supplier_price.php`  Dolibarr Version 20.0, 21.0  Environment PHP 8.2  Environment Database mariaDB  Steps to reproduce the behavior and expected behavior 1. Enable Dynamic price 2. Go to a product page 3. Go to the Buying price tab 4. Add Or edit a price 5. Click on the Price Expression Editor button 6. Click on the ""Back"" button  Attached files _No response_ other-file",no-bug,0.9
31957,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31957,VCF contact download on Third Party," Feature Request Make the VCF download link available for third parties (Dolibarr 20.0.2) The VCF card download link is available for contacts, but apparently not for Thrid Parties (supplier) - at the least, there is no download link next to the name.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"VCF contact download on Third Party  Feature Request Make the VCF download link available for third parties (Dolibarr 20.0.2) The VCF card download link is available for contacts, but apparently not for Thrid Parties (supplier) - at the least, there is no download link next to the name.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
24766,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24766,Bug - ODT - Supplier orders, Bug ODT generation does not take into account : {object_date_commande} {object_options_xxx} --> Extrafields on supplier orders.  Environment Version 16.x  Environment OS Debian  Environment Web server Apache2  Environment PHP 7.4  Environment Database MySQL  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Create an extrafields on a supplier order : http://xxx/admin/supplierorder_extrafields.php Select ODT template from the admin pannel : http://xxx/admin/supplier_order.php Create a new supplier order Access supplier order : http://xxx/fourn/commande/card.php?id=xxx Generate a document from the ODT template  Attached files An exemple of an ODT template causing the issue : [example_supplier_order.odt](https://github.com/Dolibarr/dolibarr/files/11472153/example_supplier_order.odt) (extrafield 'date_commande_extended' should be created before using this template),other-file | other-file | other-file | other-file | other-file | other-file,Bug - ODT - Supplier orders  Bug ODT generation does not take into account : {object_date_commande} {object_options_xxx} --> Extrafields on supplier orders.  Environment Version 16.x  Environment OS Debian  Environment Web server Apache2  Environment PHP 7.4  Environment Database MySQL  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Create an extrafields on a supplier order : http://xxx/admin/supplierorder_extrafields.php Select ODT template from the admin pannel : http://xxx/admin/supplier_order.php Create a new supplier order Access supplier order : http://xxx/fourn/commande/card.php?id=xxx Generate a document from the ODT template  Attached files An exemple of an ODT template causing the issue : [example_supplier_order.odt](https://github.com/Dolibarr/dolibarr/files/11472153/example_supplier_order.odt) (extrafield 'date_commande_extended' should be created before using this template) other-file other-file other-file other-file other-file other-file,no-bug,0.9
31415,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31415,Bug: Field not translated for export," Bug Version: 20.0.1 Hello, In Tools > New export The field List of sercurity events is not translated ![image](https://github.com/user-attachments/assets/7ef012bb-5e97-4b9c-8db7-0f7b59b31894)  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"Bug: Field not translated for export  Bug Version: 20.0.1 Hello, In Tools > New export The field List of sercurity events is not translated ![image](https://github.com/user-attachments/assets/7ef012bb-5e97-4b9c-8db7-0f7b59b31894)  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.9
25379,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25379,Create a public page (a form) to record a prospect in database, Feature Request Essayer de partir sur la page /htdocs/public/newmember qui sert  crer un adhrent pour faire un page dans htdocs/public/newcompany qui servirait  crer un tier. Cest trs similaire.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,Create a public page (a form) to record a prospect in database  Feature Request Essayer de partir sur la page /htdocs/public/newmember qui sert  crer un adhrent pour faire un page dans htdocs/public/newcompany qui servirait  crer un tier. Cest trs similaire.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file other-file other-file other-file other-file,no-bug,0.95
24945,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24945,Project event mail dont create after sending mail action, Bug No trace of the email sent in the project in the list of events  Environment Version 16.0.3  Environment OS Windows 11  Environment Web server Linux  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 5.5.5-10.3.39-MariaDB  Environment URL(s) _No response_  Expected and actual behavior I would like an event to be added  Steps to reproduce the behavior I wrote an email directly in the project and it was not added to the list of events.  Attached files _No response_,other-file | database-file | other-file,Project event mail dont create after sending mail action  Bug No trace of the email sent in the project in the list of events  Environment Version 16.0.3  Environment OS Windows 11  Environment Web server Linux  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 5.5.5-10.3.39-MariaDB  Environment URL(s) _No response_  Expected and actual behavior I would like an event to be added  Steps to reproduce the behavior I wrote an email directly in the project and it was not added to the list of events.  Attached files _No response_ other-file database-file other-file,no-bug,0.9
26912,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26912,Barcode module: too few arguments to function modPhpbarcode," Bug When I try to open the barcode module configuration page. 2023/12/01 06:45:51 [error] 2729620#2729620: *742754 FastCGI sent in stderr: ""PHP message: PHP Fatal error: Uncaught ArgumentCountError: Too few arguments to function modPhpbarcode::info(), 0 passed in /usr/share/dolibarr/htdocs/admin/barcode.php on line 184 and exactly 1 expected in /usr/share/dolibarr/htdocs/core/modules/barcode/doc/phpbarcode.modules.php:64 Stack trace: #0 /usr/share/dolibarr/htdocs/admin/barcode.php(184): modPhpbarcode->info() #1 {main} thrown in /usr/share/dolibarr/htdocs/core/modules/barcode/doc/phpbarcode.modules.php on line 64"" while reading upstream, client: MYIPV6ADDRESS, server: MY_DOMAIN_NAME, request: ""GET /admin/barcode.php?save_lastsearch_values=1&backtopage=%2Fadmin%2Fmodules.php%3Fsearch_keyword%3Dcode HTTP/2.0"", upstream: ""fastcgi://unix:/run/php-fpm-legacy/php-fpm.sock:"", host: ""MY_DOMAIN_NAME"", referrer: ""MY_DOMAIN_NAME/admin/modules.php""  Environment Version 18  Environment OS Arch Linux  Environment Web server nginx version: nginx/1.25.3  Environment PHP PHP 8.1.26 (fpm-fcgi) (built: Nov 23 2023 18:18:52) Copyright (c) The PHP Group Zend Engine v4.1.26, Copyright (c) Zend Technologies with Zend OPcache v8.1.26, Copyright (c), by Zend Technologies  Environment Database mariadb from 11.2.2-MariaDB, client 15.2 for Linux (x86_64) using readline 5.1  Environment URL(s) https://MY_DOMAIN_NAME/admin/barcode.php?save_lastsearch_values=1&backtopage=%2Fadmin%2Fmodules.php%3Fsearch_keyword%3Dcode  Expected and actual behavior the barcode module configuration page is blank and should not  Steps to reproduce the behavior open the barcode module configuration page and see it blank  Attached files <img width=""1207"" alt=""Screenshot 2023-12-01 at 06 47 21"" src=""https://github.com/Dolibarr/dolibarr/assets/2359059/40f4d29c-a68d-4b7f-8015-f30eacbba036"">",other-file,"Barcode module: too few arguments to function modPhpbarcode  Bug When I try to open the barcode module configuration page. 2023/12/01 06:45:51 [error] 2729620#2729620: *742754 FastCGI sent in stderr: ""PHP message: PHP Fatal error: Uncaught ArgumentCountError: Too few arguments to function modPhpbarcode::info(), 0 passed in /usr/share/dolibarr/htdocs/admin/barcode.php on line 184 and exactly 1 expected in /usr/share/dolibarr/htdocs/core/modules/barcode/doc/phpbarcode.modules.php:64 Stack trace: #0 /usr/share/dolibarr/htdocs/admin/barcode.php(184): modPhpbarcode->info() #1 {main} thrown in /usr/share/dolibarr/htdocs/core/modules/barcode/doc/phpbarcode.modules.php on line 64"" while reading upstream, client: MYIPV6ADDRESS, server: MY_DOMAIN_NAME, request: ""GET /admin/barcode.php?save_lastsearch_values=1&backtopage=%2Fadmin%2Fmodules.php%3Fsearch_keyword%3Dcode HTTP/2.0"", upstream: ""fastcgi://unix:/run/php-fpm-legacy/php-fpm.sock:"", host: ""MY_DOMAIN_NAME"", referrer: ""MY_DOMAIN_NAME/admin/modules.php""  Environment Version 18  Environment OS Arch Linux  Environment Web server nginx version: nginx/1.25.3  Environment PHP PHP 8.1.26 (fpm-fcgi) (built: Nov 23 2023 18:18:52) Copyright (c) The PHP Group Zend Engine v4.1.26, Copyright (c) Zend Technologies with Zend OPcache v8.1.26, Copyright (c), by Zend Technologies  Environment Database mariadb from 11.2.2-MariaDB, client 15.2 for Linux (x86_64) using readline 5.1  Environment URL(s) https://MY_DOMAIN_NAME/admin/barcode.php?save_lastsearch_values=1&backtopage=%2Fadmin%2Fmodules.php%3Fsearch_keyword%3Dcode  Expected and actual behavior the barcode module configuration page is blank and should not  Steps to reproduce the behavior open the barcode module configuration page and see it blank  Attached files <img width=""1207"" alt=""Screenshot 2023-12-01 at 06 47 21"" src=""https://github.com/Dolibarr/dolibarr/assets/2359059/40f4d29c-a68d-4b7f-8015-f30eacbba036""> other-file",no-bug,0.9
32706,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32706,Comptabilit de trsorerie | Treasury accountancy,"Dolibarr ne gnre actuellement que de la comptabilit dites d' ""engagement"" et il serait intressant pour ouvrir Dolibarr  d'autres socits (BNC / Micro) d'intgrer galement un mode comptabilit de ""trsorerie"" bas uniquement sur les extraits bancaires. Voir avec Easya la possibilit d'intgrer le module au core.  Dolibarr currently only generates commitment accounting and it would be interesting to open Dolibarr to other companies (BNC / Micro) to also integrate a cash accounting mode based solely on bank statements. See with Easya the way to integrate their module into the core.  Module available : https://www.dolistore.com/product.php?id=1242&title=comptabilit-de-tr-sorerie&l=fr",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Comptabilit de trsorerie | Treasury accountancy Dolibarr ne gnre actuellement que de la comptabilit dites d' ""engagement"" et il serait intressant pour ouvrir Dolibarr  d'autres socits (BNC / Micro) d'intgrer galement un mode comptabilit de ""trsorerie"" bas uniquement sur les extraits bancaires. Voir avec Easya la possibilit d'intgrer le module au core.  Dolibarr currently only generates commitment accounting and it would be interesting to open Dolibarr to other companies (BNC / Micro) to also integrate a cash accounting mode based solely on bank statements. See with Easya the way to integrate their module into the core.  Module available : https://www.dolistore.com/product.php?id=1242&title=comptabilit-de-tr-sorerie&l=fr other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
30022,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30022,"BUG: Linked Files is removing, though i click ""No"" in the Dialog"," Bug Linked Files is removing, though i click ""No"" in the Dialog.  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/a765b933-1297-4d70-833a-cfe10db64a1c) 2. ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/5b2c6ff2-5ffe-4469-8d6b-94632385ab4f) 3. ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/3afd31ac-1f32-4c96-8b18-c74380d04914)  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"BUG: Linked Files is removing, though i click ""No"" in the Dialog  Bug Linked Files is removing, though i click ""No"" in the Dialog.  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/a765b933-1297-4d70-833a-cfe10db64a1c) 2. ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/5b2c6ff2-5ffe-4469-8d6b-94632385ab4f) 3. ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/3afd31ac-1f32-4c96-8b18-c74380d04914)  Attached files _No response_ other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
25973,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25973,Orders to process main menu bug," Bug In the main menu, when I click on Orders (Commandes in French), ![image](https://github.com/Dolibarr/dolibarr/assets/6176810/fcfcc418-e664-4300-9983-527f2436c468) the link go to https://myserver/commande/list.php?search_status=-3&mainmenu=commercial&leftmenu=orders instead of https://myserver/commande/list.php?search_status=-2&mainmenu=commercial&leftmenu=orders In the code, the search_status is set in hard.  Environment Version 17.0.3  Environment OS _No response_  Environment Web server Hosted  Environment PHP _No response_  Environment Database MySQL  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Orders to process main menu bug  Bug In the main menu, when I click on Orders (Commandes in French), ![image](https://github.com/Dolibarr/dolibarr/assets/6176810/fcfcc418-e664-4300-9983-527f2436c468) the link go to https://myserver/commande/list.php?search_status=-3&mainmenu=commercial&leftmenu=orders instead of https://myserver/commande/list.php?search_status=-2&mainmenu=commercial&leftmenu=orders In the code, the search_status is set in hard.  Environment Version 17.0.3  Environment OS _No response_  Environment Web server Hosted  Environment PHP _No response_  Environment Database MySQL  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
30800,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30800,WebHook Error in Make.com," Bug When trying to establish a connection with Make, I encountered many issues because the JSON that Make.com was receiving was malformed. So, what I did was add the following variable to the `interface_95_modWebhook_WebhookTriggers.class.php` file: $headers = array( 'Content-Type: application/json', 'Accept: application/json' ); And the getURLContent method ended up as follows: $response = getURLContent($tmpobject->url, 'POST', $jsonstr, 1, $headers, array('http', 'https'), 0, -1);  Dolibarr Version 19.03  Environment PHP 7.4  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior Create a webhook in Make.com, copy the webhook link, and configure it in the Dolibarr WebHook module. Set the parameter as CREATE_COMPANY and wait to analyze the string that Make.com receives.  Attached files _No response_",other-file | other-file,"WebHook Error in Make.com  Bug When trying to establish a connection with Make, I encountered many issues because the JSON that Make.com was receiving was malformed. So, what I did was add the following variable to the `interface_95_modWebhook_WebhookTriggers.class.php` file: $headers = array( 'Content-Type: application/json', 'Accept: application/json' ); And the getURLContent method ended up as follows: $response = getURLContent($tmpobject->url, 'POST', $jsonstr, 1, $headers, array('http', 'https'), 0, -1);  Dolibarr Version 19.03  Environment PHP 7.4  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior Create a webhook in Make.com, copy the webhook link, and configure it in the Dolibarr WebHook module. Set the parameter as CREATE_COMPANY and wait to analyze the string that Make.com receives.  Attached files _No response_ other-file other-file",bug,0.9
26584,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26584,Rf produit fournisseur empty," Bug Hi, The field Rf produit fournisseur (supplier) is empty in the supplier invoice page fourn/facture/card.php. The bug seems to have appeared around mid-august (v17 -> v18), see [https://www.dolibarr.fr/forum/t/v18-ref-produit-fournisseur-dans-facture-fournisseur-est-maintenant-vide-bug/44162](url). I unfortunately don't have a patch to provide. Thank you!  Environment Version 18  Environment OS Debian  Environment Web server Apache  Environment PHP 8.1  Environment Database Mysql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Rf produit fournisseur empty  Bug Hi, The field Rf produit fournisseur (supplier) is empty in the supplier invoice page fourn/facture/card.php. The bug seems to have appeared around mid-august (v17 -> v18), see [https://www.dolibarr.fr/forum/t/v18-ref-produit-fournisseur-dans-facture-fournisseur-est-maintenant-vide-bug/44162](url). I unfortunately don't have a patch to provide. Thank you!  Environment Version 18  Environment OS Debian  Environment Web server Apache  Environment PHP 8.1  Environment Database Mysql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
23740,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23740,pgsql: function sum(character varying) does not exist," Bug Error messages in /ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Upgraded from 13.0.3 via 14.0.5 and 15.0.5 to 16.0.3  Environment Version 16.0.3  Environment OS Debian 11  Environment Web server Apache 2.4.54-1  Environment PHP 7.4.33  Environment Database psql (13.9 (Debian 13.9-0+deb11u1), server 9.6.15)  Environment URL(s) /ticket/stats/index.php  Expected and actual behavior Display ticket statistiks for never used statistik module Errors on top: Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2021' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function sum(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2022' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function sum(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2023' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function sum(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2021' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function avg(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2022' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function avg(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2023' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function avg(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%Y') as year, count(*) as nb, sum(timing) as total, avg(timing) as avg FROM llx_ticket WHERE fk_statut > 0 AND entity = 1 GROUP BY year ORDER BY year DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function sum(character varying) does not exist\nLINE 1:  date_format(datec,'%Y') as year, count(*) as nb, sum(timing\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523  Steps to reproduce the behavior Open statistik page of ticket module  Attached files [dolibar.log.txt](https://github.com/Dolibarr/dolibarr/files/10549969/dolibar.log.txt)",other-file | other-file,"pgsql: function sum(character varying) does not exist  Bug Error messages in /ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Upgraded from 13.0.3 via 14.0.5 and 15.0.5 to 16.0.3  Environment Version 16.0.3  Environment OS Debian 11  Environment Web server Apache 2.4.54-1  Environment PHP 7.4.33  Environment Database psql (13.9 (Debian 13.9-0+deb11u1), server 9.6.15)  Environment URL(s) /ticket/stats/index.php  Expected and actual behavior Display ticket statistiks for never used statistik module Errors on top: Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2021' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function sum(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2022' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function sum(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2023' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function sum(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, sum(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2021' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function avg(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2022' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function avg(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_ticket WHERE date_format(datec,'%Y') = '2023' AND fk_statut > 0 AND entity = 1 GROUP BY dm ORDER BY dm DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function avg(character varying) does not exist\nLINE 1: SELECT date_format(datec,'%m') as dm, avg(timing) FROM llx_t\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523 Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230131185547 Dolibarr: 16.0.3 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache OS: Linux server 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 UserAgent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0 Angefragte URL: /erp/ticket/stats/index.php?idmenu=5525&mainmenu=ticket&leftmenu= Referer: https://server/erp/ticket/list.php?mode=mine&search_fk_status=non_closed&idmenu=5524&mainmenu=ticket&leftmenu= Menverwaltung: eldy_menu.php Module/Anwendungen: user, syslog, accounting, banque, cron, commande, clicktodial, notification, fckeditor, facture, service, product, tax, import, projet, workflow, societe, ticket, agenda Datenbank Type Manager: pgsql Letzter Fehlerhafter Datenbankzugriff: SELECT date_format(datec,'%Y') as year, count(*) as nb, sum(timing) as total, avg(timing) as avg FROM llx_ticket WHERE fk_statut > 0 AND entity = 1 GROUP BY year ORDER BY year DESC Rckgabewert des letzten fehlerhaften Datenbankzugriff: DB_ERROR_42883 Information zum letzten fehlerhaften Datenbankzugriff: ERROR: 42883: function sum(character varying) does not exist\nLINE 1:  date_format(datec,'%Y') as year, count(*) as nb, sum(timing\n ^\nHINT: No function matches the given name and argument types. You might need to add explicit type casts.\nLOCATION: ParseFuncOrColumn, parse_func.c:523  Steps to reproduce the behavior Open statistik page of ticket module  Attached files [dolibar.log.txt](https://github.com/Dolibarr/dolibarr/files/10549969/dolibar.log.txt) other-file other-file",no-bug,0.9
23449,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23449,Discussion / Logical Bug: Limited duration for Services and also for Products," Feature Request Can also set a limited duration for Products.  Use case In some (in our company in the most cases) business events its necessary to deliver also products to a different date.  Suggested implementation ![image](https://user-images.githubusercontent.com/78662388/211195541-9a4f06fe-24b6-459e-af87-43feb00ff99e.png)  Suggested steps Variant 1: Remove all if-statements where is requesting ""its a service"". Variant 2: Integrate a configuration variable to say ""PRODUCT_LIMITED_DURATION_FOR_PRODUCTS""  @eldy: What do you think is the best implementation?",other-file | other-file,"Discussion / Logical Bug: Limited duration for Services and also for Products  Feature Request Can also set a limited duration for Products.  Use case In some (in our company in the most cases) business events its necessary to deliver also products to a different date.  Suggested implementation ![image](https://user-images.githubusercontent.com/78662388/211195541-9a4f06fe-24b6-459e-af87-43feb00ff99e.png)  Suggested steps Variant 1: Remove all if-statements where is requesting ""its a service"". Variant 2: Integrate a configuration variable to say ""PRODUCT_LIMITED_DURATION_FOR_PRODUCTS""  @eldy: What do you think is the best implementation? other-file other-file",no-bug,0.9
32402,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32402,Employee is dropped on social update," Bug When I update a social expense, at the moment I saved, the employee input is blanked.  Dolibarr Version 20.0.0  Environment PHP 8.2.25  Environment Database PostgreSQL  Steps to reproduce the behavior and expected behavior Create a social expense with an employee, clik save. Then edit the social expense and save.  Attached files _No response_",other-file | other-file,"Employee is dropped on social update  Bug When I update a social expense, at the moment I saved, the employee input is blanked.  Dolibarr Version 20.0.0  Environment PHP 8.2.25  Environment Database PostgreSQL  Steps to reproduce the behavior and expected behavior Create a social expense with an employee, clik save. Then edit the social expense and save.  Attached files _No response_ other-file other-file",no-bug,0.8
31538,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31538,"[EPC-QR, Sponge] Addition to the EPC-QR values for SEPA transfers with correct remittance information"," Bug According to my understanding, the EPC QR code available in the sponge invoices needs to be extended by a value/a line. The current implementation does not contain the value ""Purpose of the SEPA Credit Transfer"". This means that with the QR codes currently generated, SEPA payment instructions have the invoice number assigned in the wrong field based on the scanned QR-code. Namely as ""Remittance (Reference)"" instead of the correct value in ""Remittance (Information)"". ""Guidelines to Enable the Data Capture for the Initiation of a SEPA Credit Transfer"" (see chapter 2.2, page 3) https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2022-09/EPC069-12%20v3.0%20Quick%20Response%20Code%20-%20Guidelines%20to%20Enable%20the%20Data%20Capture%20for%20the%20Initiation%20of%20an%20SCT_0.pdf I would like to ask for comments or a confirmation. The implementation for the correction would be adding a line in the file `/htdocs/core/class/commoninvoice.class.php` as follows: >// Add the amount and reference $lines[] = 'EUR' . $totalTTCString; // Amount (optional) **$lines[] = ''; // Purpose (optional)** $lines[] = ''; // Payment reference (optional) $lines[] = $this->ref; // Remittance Information (optional)  Dolibarr Version 20.0.1",other-file | other-file,"[EPC-QR, Sponge] Addition to the EPC-QR values for SEPA transfers with correct remittance information  Bug According to my understanding, the EPC QR code available in the sponge invoices needs to be extended by a value/a line. The current implementation does not contain the value ""Purpose of the SEPA Credit Transfer"". This means that with the QR codes currently generated, SEPA payment instructions have the invoice number assigned in the wrong field based on the scanned QR-code. Namely as ""Remittance (Reference)"" instead of the correct value in ""Remittance (Information)"". ""Guidelines to Enable the Data Capture for the Initiation of a SEPA Credit Transfer"" (see chapter 2.2, page 3) https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2022-09/EPC069-12%20v3.0%20Quick%20Response%20Code%20-%20Guidelines%20to%20Enable%20the%20Data%20Capture%20for%20the%20Initiation%20of%20an%20SCT_0.pdf I would like to ask for comments or a confirmation. The implementation for the correction would be adding a line in the file `/htdocs/core/class/commoninvoice.class.php` as follows: >// Add the amount and reference $lines[] = 'EUR' . $totalTTCString; // Amount (optional) **$lines[] = ''; // Purpose (optional)** $lines[] = ''; // Payment reference (optional) $lines[] = $this->ref; // Remittance Information (optional)  Dolibarr Version 20.0.1 other-file other-file",no-bug,0.8
27010,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27010,Possible to bill several times lines of an order already billed," Bug This is between a bug and a feature request Example : you create an invoice from an order, but you bill only some lines Some time after, you create an invoice from the same order : you'll see a warning that an invoice already exists for this order, but all the lines of the original order will be pre-selected, ignoring those that are already billed This is true with both client invoices and supplier_invoices I will propose a PR to resolve this  Environment Version all  Environment OS All  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Possible to bill several times lines of an order already billed  Bug This is between a bug and a feature request Example : you create an invoice from an order, but you bill only some lines Some time after, you create an invoice from the same order : you'll see a warning that an invoice already exists for this order, but all the lines of the original order will be pre-selected, ignoring those that are already billed This is true with both client invoices and supplier_invoices I will propose a PR to resolve this  Environment Version all  Environment OS All  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.8
31089,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31089,Can't delete Multicurrency Rate (BLOCKING!)," Bug i have enabled the multicurrency module and have added the rates for Euro, i can modify but i can't delete the Rate completely when clicking on Delete! i have not used this currency anywhere its a clean database!  Dolibarr Version 19.0.3  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1- Activate the multicurrency module 2- add a rate to a currency of your choice 3- try do delete the rate  Attached files <img width=""1243"" alt=""Screenshot 2024-09-23 at 11 04 00 AM"" src=""https://github.com/user-attachments/assets/56150cef-b91e-4cf2-bd09-4496edae087e""> <img width=""999"" alt=""Screenshot 2024-09-23 at 11 04 17 AM"" src=""https://github.com/user-attachments/assets/d492755f-afe2-4355-8368-fb381b13ef8f"">",other-file | other-file,"Can't delete Multicurrency Rate (BLOCKING!)  Bug i have enabled the multicurrency module and have added the rates for Euro, i can modify but i can't delete the Rate completely when clicking on Delete! i have not used this currency anywhere its a clean database!  Dolibarr Version 19.0.3  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1- Activate the multicurrency module 2- add a rate to a currency of your choice 3- try do delete the rate  Attached files <img width=""1243"" alt=""Screenshot 2024-09-23 at 11 04 00 AM"" src=""https://github.com/user-attachments/assets/56150cef-b91e-4cf2-bd09-4496edae087e""> <img width=""999"" alt=""Screenshot 2024-09-23 at 11 04 17 AM"" src=""https://github.com/user-attachments/assets/d492755f-afe2-4355-8368-fb381b13ef8f""> other-file other-file",no-bug,0.8
26100,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26100,Is not allowed to select closed projects at tickets creation," Bug Is not allowed to select closed projects in Tickets. Even when a ticket is closed, remains under garantee, and new support tickets can arise over an alreaady closed project.  Environment Version ALl  Environment OS All  Environment Web server All  Environment PHP All  Environment Database All  Environment URL(s) https://myserver.com/ticket/card.php?action=create&idmenu=6596&mainmenu=ticket&leftmenu=  Expected and actual behavior Now all the closed projects appears in grey color and is not possible to select it when a ticket is created. This force the user to reopen the project, then assign the project to the ticket, and close again the project.  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Is not allowed to select closed projects at tickets creation  Bug Is not allowed to select closed projects in Tickets. Even when a ticket is closed, remains under garantee, and new support tickets can arise over an alreaady closed project.  Environment Version ALl  Environment OS All  Environment Web server All  Environment PHP All  Environment Database All  Environment URL(s) https://myserver.com/ticket/card.php?action=create&idmenu=6596&mainmenu=ticket&leftmenu=  Expected and actual behavior Now all the closed projects appears in grey color and is not possible to select it when a ticket is created. This force the user to reopen the project, then assign the project to the ticket, and close again the project.  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
28071,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28071,Merge that went wrong?," Bug @eldy Sorry for tagging directly, but this concerns a merge https://github.com/Dolibarr/dolibarr/compare/2a28248..854292e Something went wrong when merging 2a28248d to 854292e . I double confirmed that this is a direct transition (7db64c5bcc0 is the commit just before 2a28248d):  $ git rev-list --ancestry-path 7db64c5bcc0..854292ea47d 854292ea47ddb87714fae56e2dc4d338a5dd238f 2a28248dd4e9202d7cadfc9e91de35d29ab16173  I discovered this when I went looking for the reason some changes that I made in PR's went missing in the develop branch.",other-file | other-file | documentation-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | test-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Merge that went wrong?  Bug @eldy Sorry for tagging directly, but this concerns a merge https://github.com/Dolibarr/dolibarr/compare/2a28248..854292e Something went wrong when merging 2a28248d to 854292e . I double confirmed that this is a direct transition (7db64c5bcc0 is the commit just before 2a28248d):  $ git rev-list --ancestry-path 7db64c5bcc0..854292ea47d 854292ea47ddb87714fae56e2dc4d338a5dd238f 2a28248dd4e9202d7cadfc9e91de35d29ab16173  I discovered this when I went looking for the reason some changes that I made in PR's went missing in the develop branch. other-file other-file documentation-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file test-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
30731,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30731,Eldy theme issue.," Bug i have just encountered with an issue on the Eldy theme, which is the placement of side menu on the right or left for rtl or ltr languages, for ltr languages there is no problem, but for the rtl languages the side menu is supposed to be on the Right but in some tabs it is going back to Left! and the Md theme is not having this problem! i have searched deeply inside the theme style.css.php file but could not figure out how to fix it  Dolibarr Version 19.0.2  Environment PHP 8.3  Environment Database mysql  Steps to reproduce the behavior and expected behavior 1- Change the display language to Arabic. 2- go to products -> product card 3- now go to the selling prices or buying prices 4- the menu is moving to the left side and goes back to the right when changing the tabs <img width=""1446"" alt=""Screenshot 2024-08-23 at 12 07 13 AM"" src=""https://github.com/user-attachments/assets/63dff087-078e-4c9b-865b-347385c857a1""> <img width=""1443"" alt=""Screenshot 2024-08-23 at 12 07 23 AM"" src=""https://github.com/user-attachments/assets/daeb1ff3-82cc-4ce7-ae4a-90e6c9cc440c"">  Attached files _No response_",other-file,"Eldy theme issue.  Bug i have just encountered with an issue on the Eldy theme, which is the placement of side menu on the right or left for rtl or ltr languages, for ltr languages there is no problem, but for the rtl languages the side menu is supposed to be on the Right but in some tabs it is going back to Left! and the Md theme is not having this problem! i have searched deeply inside the theme style.css.php file but could not figure out how to fix it  Dolibarr Version 19.0.2  Environment PHP 8.3  Environment Database mysql  Steps to reproduce the behavior and expected behavior 1- Change the display language to Arabic. 2- go to products -> product card 3- now go to the selling prices or buying prices 4- the menu is moving to the left side and goes back to the right when changing the tabs <img width=""1446"" alt=""Screenshot 2024-08-23 at 12 07 13 AM"" src=""https://github.com/user-attachments/assets/63dff087-078e-4c9b-865b-347385c857a1""> <img width=""1443"" alt=""Screenshot 2024-08-23 at 12 07 23 AM"" src=""https://github.com/user-attachments/assets/daeb1ff3-82cc-4ce7-ae4a-90e6c9cc440c"">  Attached files _No response_ other-file",no-bug,0.9
32656,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32656,"Bug: Fatal error: Uncaught Error: Class ""FormProjets"" - Loan Module"," Bug Version: 22.0.0-alpha Hello, I wanted to test the 21.x.-beta but I git cloned 22.0.0-alpha Anyway, I have a loan created and when I access the note thumbnail I see this error message on top of a white page. `Fatal error: Uncaught Error: Class ""FormProjets"" not found in /htdocs/applications/dolibarr-develop/htdocs/loan/note.php:86 Stack trace: #0 {main} thrown in /htdocs/applications/dolibarr-develop/htdocs/loan/note.php on line 86` Regards  Dolibarr Version 22.0.0-alpha  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"Bug: Fatal error: Uncaught Error: Class ""FormProjets"" - Loan Module  Bug Version: 22.0.0-alpha Hello, I wanted to test the 21.x.-beta but I git cloned 22.0.0-alpha Anyway, I have a loan created and when I access the note thumbnail I see this error message on top of a white page. `Fatal error: Uncaught Error: Class ""FormProjets"" not found in /htdocs/applications/dolibarr-develop/htdocs/loan/note.php:86 Stack trace: #0 {main} thrown in /htdocs/applications/dolibarr-develop/htdocs/loan/note.php on line 86` Regards  Dolibarr Version 22.0.0-alpha  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
24997,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24997,VAT TAX wrong for slovakia," Bug The value for the VAT for Slovakia is wrong, it should be 20% instead of 19%  Environment Version 14  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",database-file | database-file,"VAT TAX wrong for slovakia  Bug The value for the VAT for Slovakia is wrong, it should be 20% instead of 19%  Environment Version 14  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ database-file database-file",no-bug,0.8
26337,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26337,Error 500 when try to edit an existing line in Intervention, Bug Error 500 when try to edit an existing line in Intervention path : /htdocs/fichinter/card.php?id=109 error : this page isn't working  Environment Version 18.0.2  Environment OS Apache  Environment Web server Apache  Environment PHP 8.0.30  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,Error 500 when try to edit an existing line in Intervention  Bug Error 500 when try to edit an existing line in Intervention path : /htdocs/fichinter/card.php?id=109 error : this page isn't working  Environment Version 18.0.2  Environment OS Apache  Environment Web server Apache  Environment PHP 8.0.30  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.7
32271,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32271,DB_ERROR_1052 (Column 'active' in where clause is ambiguous) when using /admin/dict.php?id=8 + filter active = yes," Bug SQL error 1052 Column 'active' is ambiguous when trying to filter only active codes in the dictionary page ""Types de tiers"". Running the same SQL from phpMyAdmin returns same error. Desambiguing sql in phpMyAdmin returns different result if desambiguing type of entity (typent) or country : SELECT COUNT(*) as nbtotalofrecords FROM xxxxxx_c_typent as t LEFT JOIN xxxxx_c_country as c ON t.fk_country=c.rowid WHERE 1 = 1 AND active = 1; ==> adapting in t.active or c.active. PHP: 8.2.21 Serveur: Apache/2.4.58 (Unix) OS: Linux  Dolibarr Version 20.0.2  Environment PHP 8.2.21  Environment Database 10.11.6-MariaDB  Steps to reproduce the behavior and expected behavior 1. Login Dolibarr as admin 2. Setup menu 3. Dictionaries submenu 4. Third-party type entry 5. Select ""Yes"" on status dropdown list + launch the filter 6. Error message page containing 2 sql errors 1052 with detail (as attached detail)  Attached files [dolibarr_errorDB1052.txt](https://github.com/user-attachments/files/18047957/dolibarr_errorDB1052.txt)",other-file | other-file,"DB_ERROR_1052 (Column 'active' in where clause is ambiguous) when using /admin/dict.php?id=8 + filter active = yes  Bug SQL error 1052 Column 'active' is ambiguous when trying to filter only active codes in the dictionary page ""Types de tiers"". Running the same SQL from phpMyAdmin returns same error. Desambiguing sql in phpMyAdmin returns different result if desambiguing type of entity (typent) or country : SELECT COUNT(*) as nbtotalofrecords FROM xxxxxx_c_typent as t LEFT JOIN xxxxx_c_country as c ON t.fk_country=c.rowid WHERE 1 = 1 AND active = 1; ==> adapting in t.active or c.active. PHP: 8.2.21 Serveur: Apache/2.4.58 (Unix) OS: Linux  Dolibarr Version 20.0.2  Environment PHP 8.2.21  Environment Database 10.11.6-MariaDB  Steps to reproduce the behavior and expected behavior 1. Login Dolibarr as admin 2. Setup menu 3. Dictionaries submenu 4. Third-party type entry 5. Select ""Yes"" on status dropdown list + launch the filter 6. Error message page containing 2 sql errors 1052 with detail (as attached detail)  Attached files [dolibarr_errorDB1052.txt](https://github.com/user-attachments/files/18047957/dolibarr_errorDB1052.txt) other-file other-file",no-bug,0.9
25885,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25885,US Chart Of Accounts Will Not Fully Load," Bug When you load the US chart of account, you get a error. Most load, but not all. The problem is that the table llx_accounting_account field pcg_type is a varchar(20) and there are many inserts that look like this sql INSERT INTO llx_accounting_account (entity, rowid, fk_pcg_version, pcg_type, account_number, account_parent, label, active) VALUES (__ENTITY__, 10099, 'US-GAAP-BASIC', 'OTHER_INCOME_EXPENSES', '6', '0', 'Other (Non-Operating) Income And Expenses', 1);  Notice the pcg_type is OTHER_INCOME_EXPENSES. This needs a varchar(21). This is a easy fix and I can do a pull request but I need to know, should it be fixed in -  htdocs/install/mysql/tables/llx_accounting_account.sql and modify the field varchar? - htdocs/install/mysql/data/llx_accounting_account_us.sql and do a ALTER? - Maybe in the install process on database upgrade it can do something in the migrations? Also note: I found the varchar actually should to be varchar(30) . There is another pcg_type insert INTERCOMPANY_RELPARTY_ACCOUNTS  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database mysql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",database-file | database-file | database-file | database-file,"US Chart Of Accounts Will Not Fully Load  Bug When you load the US chart of account, you get a error. Most load, but not all. The problem is that the table llx_accounting_account field pcg_type is a varchar(20) and there are many inserts that look like this sql INSERT INTO llx_accounting_account (entity, rowid, fk_pcg_version, pcg_type, account_number, account_parent, label, active) VALUES (__ENTITY__, 10099, 'US-GAAP-BASIC', 'OTHER_INCOME_EXPENSES', '6', '0', 'Other (Non-Operating) Income And Expenses', 1);  Notice the pcg_type is OTHER_INCOME_EXPENSES. This needs a varchar(21). This is a easy fix and I can do a pull request but I need to know, should it be fixed in -  htdocs/install/mysql/tables/llx_accounting_account.sql and modify the field varchar? - htdocs/install/mysql/data/llx_accounting_account_us.sql and do a ALTER? - Maybe in the install process on database upgrade it can do something in the migrations? Also note: I found the varchar actually should to be varchar(30) . There is another pcg_type insert INTERCOMPANY_RELPARTY_ACCOUNTS  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database mysql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ database-file database-file database-file database-file",no-bug,0.9
30044,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30044,"When billing multiple orders, all order numbers are implicitly added in Public Note without the ability to edit/remove"," Bug As the title says. If we select sales orders SO0001, SO0002, SO0003 and bill them as ""one invoice for al third party"", there is added a box on the invoice containing the text SO0001 (date), SO0002 and so on, but this information is added on-the-fly in `core/lib/pdf.lib.php`, with the side effect that we cannot remove it and there is no setting to not do this. Suggestion: instead of letting `pdf_getLinkedObject()` handle this on the fly, make an actual Public Note immediately when clicking ""Bill orders"". That way, we can edit the note to whatever we want (in this case we want to delete all the information).  Dolibarr Version 19.0, probably all versions  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Go to sales orders and choose minimum 2 from the same third party 2. Click Bill orders in top menu 3. Select ""Yes"" on ""Create one invoice per third party"" For the new invoice draft, generate the pdf-file and see the sales order info in the box, while Public Note is empty (i.e. you cannot edit it).  Attached files ![2024-06-15_173418](https://github.com/Dolibarr/dolibarr/assets/11036018/0c98cdd7-0e8e-4ce2-b177-fd598ebb155b) ![2024-06-15_173447](https://github.com/Dolibarr/dolibarr/assets/11036018/e3414fe5-a3b8-4a4a-aa24-33dac69632b9)",other-file | other-file | other-file | other-file,"When billing multiple orders, all order numbers are implicitly added in Public Note without the ability to edit/remove  Bug As the title says. If we select sales orders SO0001, SO0002, SO0003 and bill them as ""one invoice for al third party"", there is added a box on the invoice containing the text SO0001 (date), SO0002 and so on, but this information is added on-the-fly in `core/lib/pdf.lib.php`, with the side effect that we cannot remove it and there is no setting to not do this. Suggestion: instead of letting `pdf_getLinkedObject()` handle this on the fly, make an actual Public Note immediately when clicking ""Bill orders"". That way, we can edit the note to whatever we want (in this case we want to delete all the information).  Dolibarr Version 19.0, probably all versions  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Go to sales orders and choose minimum 2 from the same third party 2. Click Bill orders in top menu 3. Select ""Yes"" on ""Create one invoice per third party"" For the new invoice draft, generate the pdf-file and see the sales order info in the box, while Public Note is empty (i.e. you cannot edit it).  Attached files ![2024-06-15_173418](https://github.com/Dolibarr/dolibarr/assets/11036018/0c98cdd7-0e8e-4ce2-b177-fd598ebb155b) ![2024-06-15_173447](https://github.com/Dolibarr/dolibarr/assets/11036018/e3414fe5-a3b8-4a4a-aa24-33dac69632b9) other-file other-file other-file other-file",no-bug,0.9
29780,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29780,MAIN_SECURITY_FORCERP - HTTP_REFERER," Bug Because of the MAIN_SECURITY_FORCERP set by default on strict-origin, in v19, it's impossible to keep the list filter in the URL when you clic on ""return list"" from an object. Because of this, HTTP_REFERER is equal to the domain name only and not the page you was from. In v18, MAIN_SECURITY_FORCERP is set on same-origin and the filters are kept when you clic on ""Return list"" from an object. HTTP_REFERER works fine. I would like to know the reasons of this modification. Normally, it should be the same problem for all users v19. Will this have any impact on safety ?  Dolibarr Version 19.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"MAIN_SECURITY_FORCERP - HTTP_REFERER  Bug Because of the MAIN_SECURITY_FORCERP set by default on strict-origin, in v19, it's impossible to keep the list filter in the URL when you clic on ""return list"" from an object. Because of this, HTTP_REFERER is equal to the domain name only and not the page you was from. In v18, MAIN_SECURITY_FORCERP is set on same-origin and the filters are kept when you clic on ""Return list"" from an object. HTTP_REFERER works fine. I would like to know the reasons of this modification. Normally, it should be the same problem for all users v19. Will this have any impact on safety ?  Dolibarr Version 19.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
23393,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23393,Bug: BOM 'Create' View are broken (to much content), Bug ![image](https://user-images.githubusercontent.com/78662388/210274644-5c3ee183-2640-4ed8-888c-0af3a7395e1c.png)  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file,Bug: BOM 'Create' View are broken (to much content)  Bug ![image](https://user-images.githubusercontent.com/78662388/210274644-5c3ee183-2640-4ed8-888c-0af3a7395e1c.png)  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file,no-bug,0.9
25929,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25929,error on api_proposals.class.php," Bug if call to endpoint /api/index.php/proposals/xxxxx/lines without sql filter this generate an exception The line 319 of file htdocs/comm/propal/class/api_proposals.class.php say: $this->propal->getLinesArray($sql); and $sql is not set this line would set into if at line 311 if (!empty($sqlfilters)) {  Environment Version 18.0.1  Environment OS Ubuntu 22.04  Environment Web server Nginx  Environment PHP 8.2  Environment Database mariadb 10  Environment URL(s) _No response_  Expected and actual behavior 2023/09/15 13:02:57 [error] 704889#704889: *47475930 FastCGI sent in stderr: ""PHP message: PHP Warning: Undefined variable $sql in /xxxxx/htdocs/comm/propal/class/api_proposals.class.php on line 319"" while reading response header from upstream, client: xxx.xxx.xxx.xx, server: xxxxxxxt, request: ""GET /api/index.php/proposals/nnnnn/lines HTTP/1.1"", upstream: ""fastcgi://unix:/run/php/php8.2-fpm.sock:"", host: ""xxxxxxx""  Steps to reproduce the behavior curl -X GET --header 'Accept: application/json' --header 'DOLAPIKEY: xxxxxx' 'https://xxxxxxx/api/index.php/proposals/nnnnnn/lines'  Attached files _No response_",other-file | other-file | other-file | other-file,"error on api_proposals.class.php  Bug if call to endpoint /api/index.php/proposals/xxxxx/lines without sql filter this generate an exception The line 319 of file htdocs/comm/propal/class/api_proposals.class.php say: $this->propal->getLinesArray($sql); and $sql is not set this line would set into if at line 311 if (!empty($sqlfilters)) {  Environment Version 18.0.1  Environment OS Ubuntu 22.04  Environment Web server Nginx  Environment PHP 8.2  Environment Database mariadb 10  Environment URL(s) _No response_  Expected and actual behavior 2023/09/15 13:02:57 [error] 704889#704889: *47475930 FastCGI sent in stderr: ""PHP message: PHP Warning: Undefined variable $sql in /xxxxx/htdocs/comm/propal/class/api_proposals.class.php on line 319"" while reading response header from upstream, client: xxx.xxx.xxx.xx, server: xxxxxxxt, request: ""GET /api/index.php/proposals/nnnnn/lines HTTP/1.1"", upstream: ""fastcgi://unix:/run/php/php8.2-fpm.sock:"", host: ""xxxxxxx""  Steps to reproduce the behavior curl -X GET --header 'Accept: application/json' --header 'DOLAPIKEY: xxxxxx' 'https://xxxxxxx/api/index.php/proposals/nnnnnn/lines'  Attached files _No response_ other-file other-file other-file other-file",bug,0.95
23094,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23094,Separate expedition billing status from main statuses and add more shipping statuses," Feature Request As discussed [HERE](https://github.com/Dolibarr/dolibarr/issues/20987#issuecomment-1336352533), it will be good to separate expedition billing status from shipment status.  Use case The reasons for this are, that now when an invoice is created from a shipment (expedition), the column ""billed"" in llx_expediton remains with a value of 0 instead of 1. Sometimes, there is a workflow, where you create a shipment, then create an invoice and validate this invoice. But the items are NOT shipped yet. So, at a later stage, when the warehouse ship the items they classify the shipment as ""Closed (sent)"". I.e. you can have an invoice when the shipment is not yet processed. Thus, when you create an invoice, the shipment should be set as billed but NOT closed.  Suggested implementation Make following changes: 1. When an invoice is created, no matter the status of the shipment, it should be changed to billed, like ""Validated - billed"" or, to avoid too many statuses that can be confusing, add a separate field (not editable by user) named ""Billed"" in view and list mode 2. Add more Shipment statuses like ""Awaiting shipment"", ""Shipped"", ""Delivered"" 3. This is not very often, but it will be good to have also status ""Returned"", or ""Returned from customer"". It could be a wrong address or wrong items but mistakes happens. For this status, it also will be good upon clicking ""Set as returned"" to have a pop-up to enter the reason for return for future reference.  Suggested steps _No response_",other-file | other-file | other-file | other-file,"Separate expedition billing status from main statuses and add more shipping statuses  Feature Request As discussed [HERE](https://github.com/Dolibarr/dolibarr/issues/20987#issuecomment-1336352533), it will be good to separate expedition billing status from shipment status.  Use case The reasons for this are, that now when an invoice is created from a shipment (expedition), the column ""billed"" in llx_expediton remains with a value of 0 instead of 1. Sometimes, there is a workflow, where you create a shipment, then create an invoice and validate this invoice. But the items are NOT shipped yet. So, at a later stage, when the warehouse ship the items they classify the shipment as ""Closed (sent)"". I.e. you can have an invoice when the shipment is not yet processed. Thus, when you create an invoice, the shipment should be set as billed but NOT closed.  Suggested implementation Make following changes: 1. When an invoice is created, no matter the status of the shipment, it should be changed to billed, like ""Validated - billed"" or, to avoid too many statuses that can be confusing, add a separate field (not editable by user) named ""Billed"" in view and list mode 2. Add more Shipment statuses like ""Awaiting shipment"", ""Shipped"", ""Delivered"" 3. This is not very often, but it will be good to have also status ""Returned"", or ""Returned from customer"". It could be a wrong address or wrong items but mistakes happens. For this status, it also will be good upon clicking ""Set as returned"" to have a pop-up to enter the reason for return for future reference.  Suggested steps _No response_ other-file other-file other-file other-file",no-bug,0.9
29640,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29640,Impossible to delete Draft Invoice because of delete_linked_contact empty," Bug Error when trying to delete a draft invoice. In facture.class.php line 2871 the if do 3 tests at the same time that all need to be true : 1. $this->db->query($sqlef) 2. $this->db->query($sql) 3. $this->delete_linked_contact() In delete_linked_contact from the object CommonObject, the result can be : Return integer <0 if KO, 0=Nothing done, >0 if OK The ligne : `if ($this->db->query($sqlef) && $this->db->query($sql) && $this->delete_linked_contact()) {` Have to be change by: `if ($this->db->query($sqlef) && $this->db->query($sql) && $this->delete_linked_contact()>=0) {`  Dolibarr Version 19.0.2  Environment PHP 8.2.5  Environment Database MySQL or MariaDB 10.11.2-MariaDB  Steps to reproduce the behavior and expected behavior Create a draft invoice. Try do delete It.  Attached files _No response_",other-file | other-file | other-file | other-file,"Impossible to delete Draft Invoice because of delete_linked_contact empty  Bug Error when trying to delete a draft invoice. In facture.class.php line 2871 the if do 3 tests at the same time that all need to be true : 1. $this->db->query($sqlef) 2. $this->db->query($sql) 3. $this->delete_linked_contact() In delete_linked_contact from the object CommonObject, the result can be : Return integer <0 if KO, 0=Nothing done, >0 if OK The ligne : `if ($this->db->query($sqlef) && $this->db->query($sql) && $this->delete_linked_contact()) {` Have to be change by: `if ($this->db->query($sqlef) && $this->db->query($sql) && $this->delete_linked_contact()>=0) {`  Dolibarr Version 19.0.2  Environment PHP 8.2.5  Environment Database MySQL or MariaDB 10.11.2-MariaDB  Steps to reproduce the behavior and expected behavior Create a draft invoice. Try do delete It.  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
30628,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30628,currency conversion rate - cannot be changed," Bug Since several weeks, the currency conversion rate (under vendor / invoices) cannot be changed anymore. If changed, then it goes back to either 1 or 0. ![image](https://github.com/user-attachments/assets/1aef7e04-ab8f-4c30-b44d-f070f0d29272)  Dolibarr Version 21 alpha  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"currency conversion rate - cannot be changed  Bug Since several weeks, the currency conversion rate (under vendor / invoices) cannot be changed anymore. If changed, then it goes back to either 1 or 0. ![image](https://github.com/user-attachments/assets/1aef7e04-ab8f-4c30-b44d-f070f0d29272)  Dolibarr Version 21 alpha  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.8
26262,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26262,Phan static checks - merits attention," Bug I've added phan analysis support in [mdeweerd/test/phan](https://github.com/mdeweerd/Dolibarr/tree/test/phan). I think several messages merit attention: [phan.log](https://github.com/Dolibarr/dolibarr/files/13031629/phan.log) text htdocs\supplier_proposal\card.php:1342 PhanUndeclaredFunction Call to undeclared function \in_numeric() (Did you mean \is_numeric()) htdocs\public\onlinesign\newonlinesign.php:183 PhanUndeclaredMagicConstant Reference to magic constant __METHOD__ that is undeclared in the current scope: used outside of a functionlike htdocs\product\stock\stocktransfer\class\stocktransfer.class.php:345 PhanStaticCallToNonStatic Static call to non-static method \StockTransfer::cmp defined at htdocs\product\stock\stocktransfer\class\stocktransfer.class.php:356. This is an Error in PHP 8.0+. htdocs\comm\action\class\actioncomm.class.php:1337 PhanUndeclaredVariable Variable $db is undeclared (Did you mean $this->db) htdocs\core\menus\standard\empty.php:108 PhanUndeclaredVariable Variable $atarget is undeclared (Did you mean $this->atarget) htdocs\core\menus\standard\empty.php:128 PhanUndeclaredVariable Variable $atarget is undeclared (Did you mean $this->atarget) htdocs\expedition\class\expedition.class.php:1595 PhanUndeclaredVariable Variable $line is undeclared (Did you mean $lineindex) htdocs\expedition\class\expedition.class.php:1596 PhanUndeclaredVariable Variable $line is undeclared (Did you mean $lineindex) htdocs\fourn\class\fournisseur.facture-rec.class.php:1081 PhanUndeclaredVariable Variable $pu_ttc is undeclared (Did you mean $pu_ht) htdocs\fourn\class\fournisseur.facture-rec.class.php:1097 PhanUndeclaredVariable Variable $pu_ttc is undeclared (Did you mean $pu_ht) htdocs\hrm\position.php:1328 PhanUndeclaredVariable Variable $permissiontoread is undeclared (Did you mean $permissiontoadd) htdocs\mrp\class\mo.class.php:807 PhanUndeclaredVariable Variable $line is undeclared (Did you mean $this->line) htdocs\ticket\class\ticket.class.php:2931 PhanUndeclaredVariable Variable $user is undeclared (Did you mean $this->user) htdocs\intracommreport\card.php:120 PhanAccessPropertyStaticAsNonStatic Accessing static property \IntracommReport::$type as non static htdocs\intracommreport\list.php:569 PhanAccessPropertyStaticAsNonStatic Accessing static property \IntracommReport::$type as non static htdocs\core\actions_massactions.inc.php:1088 PhanParamTooFew Call with 0 arg(s) to \Facture::delete(\User $user, int $notrigger = 0, int $idwarehouse = unknown) which requires 1 arg(s) defined at htdocs\compta\facture\class\facture.class.php:2748 htdocs\don\class\don.class.php:1076 PhanParamTooMany Call with 6 arg(s) to \html_cerfafr::write_file(\Don $don, \Translate $outputlangs, string $currency = '') which only takes 3 arg(s) defined at htdocs\core\modules\dons\html_cerfafr.modules.php:76 htdocs\modulebuilder\index.php:3780 PhanParamTooMany Call with 2 arg(s) to \GETPOSTISSET(string $paramname) which only takes 1 arg(s) defined at htdocs\core\lib\functions.lib.php:520 htdocs\public\eventorganization\attendee_new.php:480 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\public\project\suggestbooth.php:274 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\public\project\suggestconference.php:275 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\societe\canvas\actions_card_common.class.php:167 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\societe\card.php:1961 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\societe\consumption.php:516 PhanParamTooMany Call with 2 arg(s) to \Contrat::getLibStatut(int $mode) which only takes 1 arg(s) defined at htdocs\contrat\class\contrat.class.php:1948 htdocs\societe\consumption.php:518 PhanParamTooMany Call with 2 arg(s) to \Contrat::getLibStatut(int $mode) which only takes 1 arg(s) defined at htdocs\contrat\class\contrat.class.php:1948 htdocs\collab\index.php:131 PhanParamTooMany Call with 2 arg(s) to \Bookmark::fetch(int $id) which only takes 1 arg(s) defined at htdocs\bookmarks\class\bookmark.class.php:114 htdocs\admin\receiptprinter.php:67 PhanRedefineFunctionInternal Function gzdecode defined at htdocs\admin\receiptprinter.php:67 was previously defined internally htdocs\adherents\class\adherentstats.class.php:87 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\adherents\class\adherentstats.class.php:124 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\comm\propal\class\propalestats.class.php:119 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\comm\propal\class\propalestats.class.php:168 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\commande\class\commandestats.class.php:120 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\commande\class\commandestats.class.php:169 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\compta\deplacement\class\deplacementstats.class.php:101 PhanParamSignatureMismatch Declaration of function getNbByMonth(string $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 (Expected string $year to have the same type as int $year or a supertype) htdocs\compta\deplacement\class\deplacementstats.class.php:123 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\compta\facture\class\facturestats.class.php:133 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\compta\facture\class\facturestats.class.php:184 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\core\db\mysqli.class.php:243 PhanParamSignatureMismatch Declaration of function connect(string $host, string $login, string $passwd, string $name, int $port = 0) : \mysqli|null should be compatible with function connect(string $host, string $login, string $passwd, string $name, int $port = 0) : resource defined in htdocs\core\db\Database.interface.php:258 htdocs\core\db\mysqli.class.php:378 PhanParamSignatureMismatch Declaration of function fetch_object(\mysqli_result $resultset) : null|object should be compatible with function fetch_object(\Connection|resource $resultset) : object defined in htdocs\core\db\Database.interface.php:521 (Expected \mysqli_result $resultset to have the same type as \Connection|resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:396 PhanParamSignatureMismatch Declaration of function fetch_array(\mysqli_result $resultset) : array|null should be compatible with function fetch_array(resource $resultset) : array defined in htdocs\core\db\Database.interface.php:174 (Expected \mysqli_result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:413 PhanParamSignatureMismatch Declaration of function fetch_row(\mysqli_result $resultset) : array|int|null should be compatible with function fetch_row(resource $resultset) : array defined in htdocs\core\db\Database.interface.php:45 (Expected \mysqli_result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:436 PhanParamSignatureMismatch Declaration of function num_rows(\mysqli_result $resultset) : int should be compatible with function num_rows(resource $resultset) : int defined in htdocs\core\db\Database.interface.php:300 (Expected \mysqli_result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:454 PhanParamSignatureMismatch Declaration of function affected_rows(\mysqli_result $resultset) : int should be compatible with function affected_rows(resource $resultset) : int defined in htdocs\core\db\Database.interface.php:111 (Expected \mysqli_result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:473 PhanParamSignatureMismatch Declaration of function free(\mysqli_result $resultset = null) : void should be compatible with function free(resource $resultset = null) : void defined in htdocs\core\db\Database.interface.php:488 (Expected \mysqli_result $resultset = unknown to have the same type as resource $resultset = unknown or a supertype) htdocs\core\db\mysqli.class.php:679 PhanParamSignatureMismatch Declaration of function DDLCreateDb(string $database, string $charset = '', string $collation = '', string $owner = '') : \mysqli_result|bool should be compatible with function DDLCreateDb(string $database, string $charset = '', string $collation = '', string $owner = '') : resource defined in htdocs\core\db\Database.interface.php:84 htdocs\core\db\mysqli.class.php:910 PhanParamSignatureMismatch Declaration of function DDLDescTable(string $table, string $field = '') : \mysqli_result|bool should be compatible with function DDLDescTable(string $table, string $field = '') : resource defined in htdocs\core\db\Database.interface.php:408 htdocs\core\db\pgsql.class.php:856 PhanParamSignatureMismatch Declaration of function last_insert_id(string $tab, string $fieldid = 'rowid') : string should be compatible with function last_insert_id(string $tab, string $fieldid = 'rowid') : int defined in htdocs\core\db\Database.interface.php:217 htdocs\core\db\pgsql.class.php:899 PhanParamSignatureMismatch Declaration of function decrypt(int $value) : string should be compatible with function decrypt(string $value) : string defined in htdocs\core\db\Database.interface.php:165 (Expected int $value to have the same type as string $value or a supertype) htdocs\core\db\sqlite3.class.php:322 PhanParamSignatureMismatch Declaration of function connect(string $host, string $login, string $passwd, string $name, int $port = 0) : \SQLite3|string should be compatible with function connect(string $host, string $login, string $passwd, string $name, int $port = 0) : resource defined in htdocs\core\db\Database.interface.php:258 htdocs\core\db\sqlite3.class.php:517 PhanParamSignatureMismatch Declaration of function fetch_object(\SQLite3Result $resultset) : false|object should be compatible with function fetch_object(\Connection|resource $resultset) : object defined in htdocs\core\db\Database.interface.php:521 (Expected \SQLite3Result $resultset to have the same type as \Connection|resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:540 PhanParamSignatureMismatch Declaration of function fetch_array(\SQLite3Result $resultset) : array|false should be compatible with function fetch_array(resource $resultset) : array defined in htdocs\core\db\Database.interface.php:174 (Expected \SQLite3Result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:559 PhanParamSignatureMismatch Declaration of function fetch_row(\SQLite3Result $resultset) : array|false should be compatible with function fetch_row(resource $resultset) : array defined in htdocs\core\db\Database.interface.php:45 (Expected \SQLite3Result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:582 PhanParamSignatureMismatch Declaration of function num_rows(\SQLite3Result $resultset) : int should be compatible with function num_rows(resource $resultset) : int defined in htdocs\core\db\Database.interface.php:300 (Expected \SQLite3Result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:605 PhanParamSignatureMismatch Declaration of function affected_rows(\SQLite3Result $resultset) : int should be compatible with function affected_rows(resource $resultset) : int defined in htdocs\core\db\Database.interface.php:111 (Expected \SQLite3Result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:629 PhanParamSignatureMismatch Declaration of function free(\SQLite3Result $resultset = null) : void should be compatible with function free(resource $resultset = null) : void defined in htdocs\core\db\Database.interface.php:488 (Expected \SQLite3Result $resultset = unknown to have the same type as resource $resultset = unknown or a supertype) htdocs\core\db\sqlite3.class.php:847 PhanParamSignatureMismatch Declaration of function DDLCreateDb(string $database, string $charset = '', string $collation = '', string $owner = '') : \SQLite3Result should be compatible with function DDLCreateDb(string $database, string $charset = '', string $collation = '', string $owner = '') : resource defined in htdocs\core\db\Database.interface.php:84 htdocs\core\db\sqlite3.class.php:1066 PhanParamSignatureMismatch Declaration of function DDLDescTable(string $table, string $field = '') : \SQLite3Result|bool should be compatible with function DDLDescTable(string $table, string $field = '') : resource defined in htdocs\core\db\Database.interface.php:408 htdocs\core\modules\barcode\mod_barcode_thirdparty_standard.php:180 PhanParamSignatureMismatch Declaration of function getNextValue(\Societe $objthirdparty, string $type = '') : string should be compatible with function getNextValue(\Product $objproduct, string $type = '') : string defined in htdocs\core\modules\barcode\modules_barcode.class.php:63 (Expected \Societe $objthirdparty to have the same type as \Product $objproduct or a supertype) htdocs\core\modules\member\doc\pdf_standard.class.php:275 PhanParamSignatureMismatch Declaration of function write_file(\Adherent $object, \Translate $outputlangs, string $srctemplatepath, string $mode = 'member', int $nooutput = 0, string $filename = 'tmp_cards') : int should be compatible with function write_file(array $arrayofrecords, \Translate $outputlangs, string $srctemplatepath, string $outputdir = '') : int defined in htdocs\core\class\commonstickergenerator.class.php:129 (Expected \Adherent $object to have the same type as array $arrayofrecords or a supertype) htdocs\core\modules\syslog\mod_syslog_file.php:52 PhanParamSignatureMismatch Declaration of function isActive() : int should be compatible with function isActive() : bool defined in htdocs\core\modules\syslog\logHandler.php:63 htdocs\core\modules\syslog\mod_syslog_file.php:52 PhanParamSignatureMismatch Declaration of function isActive() : int should be compatible with function isActive() : bool defined in htdocs\core\modules\syslog\logHandlerInterface.php:77 htdocs\core\modules\syslog\mod_syslog_file.php:82 PhanParamSignatureMismatch Declaration of function checkConfiguration() : array should be compatible with function checkConfiguration() : bool defined in htdocs\core\modules\syslog\logHandlerInterface.php:70 htdocs\core\modules\syslog\mod_syslog_file.php:138 PhanParamSignatureMismatch Declaration of function export(array $content, string $suffixinfilename = '') : void should be compatible with function export(string $content) : void defined in htdocs\core\modules\syslog\logHandlerInterface.php:85 (Expected array $content to have the same type as string $content or a supertype) htdocs\core\modules\syslog\mod_syslog_syslog.php:49 PhanParamSignatureMismatch Declaration of function isActive() : int should be compatible with function isActive() : bool defined in htdocs\core\modules\syslog\logHandler.php:63 htdocs\core\modules\syslog\mod_syslog_syslog.php:49 PhanParamSignatureMismatch Declaration of function isActive() : int should be compatible with function isActive() : bool defined in htdocs\core\modules\syslog\logHandlerInterface.php:77 htdocs\core\modules\syslog\mod_syslog_syslog.php:84 PhanParamSignatureMismatch Declaration of function checkConfiguration() : array should be compatible with function checkConfiguration() : bool defined in htdocs\core\modules\syslog\logHandlerInterface.php:70 htdocs\core\modules\syslog\mod_syslog_syslog.php:111 PhanParamSignatureMismatch Declaration of function export(array $content) : void should be compatible with function export(string $content) : void defined in htdocs\core\modules\syslog\logHandlerInterface.php:85 (Expected array $content to have the same type as string $content or a supertype) htdocs\don\class\donstats.class.php:100 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\don\class\donstats.class.php:137 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\eventorganization\class\conferenceorbooth.class.php:185 PhanParamSignatureMismatch Declaration of function create(\User $user, bool|false $notrigger = false) : int should be compatible with function create(\User $user, int $notrigger = 0) : int defined in htdocs\comm\action\class\actioncomm.class.php:429 (Expected bool|false $notrigger = false to have the same type as int $notrigger = 0 or a supertype) htdocs\eventorganization\class\conferenceorbooth.class.php:351 PhanParamSignatureMismatch Declaration of function update(\User $user, bool|false $notrigger = false) : int should be compatible with function update(\User $user, int $notrigger = 0) : int defined in htdocs\comm\action\class\actioncomm.class.php:1123 (Expected bool|false $notrigger = false to have the same type as int $notrigger = 0 or a supertype) htdocs\eventorganization\class\conferenceorbooth.class.php:364 PhanParamSignatureMismatch Declaration of function delete(bool|false $notrigger = false) : int should be compatible with function delete(int $notrigger = 0) : int defined in htdocs\comm\action\class\actioncomm.class.php:1025 (Expected bool|false $notrigger = false to have the same type as int $notrigger = 0 or a supertype) htdocs\eventorganization\class\conferenceorbooth.class.php:743 PhanParamSignatureMismatch Declaration of function initAsSpecimen() : void should be compatible with function initAsSpecimen() : int defined in htdocs\comm\action\class\actioncomm.class.php:2327 htdocs\expedition\class\expeditionstats.class.php:94 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\expedition\class\expeditionstats.class.php:141 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\expensereport\class\expensereportstats.class.php:113 PhanParamSignatureMismatch Declaration of function getNbByMonth(string $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 (Expected string $year to have the same type as int $year or a supertype) htdocs\expensereport\class\expensereportstats.class.php:135 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\fichinter\class\fichinterrec.class.php:468 PhanParamSignatureMismatch Declaration of function addline(string $desc, int $duration, string $date, int $rang = unknown, float|int $pu_ht = 0, float|int $qty = 0, float|int $txtva = 0, int $fk_product = 0, float|int $remise_percent = 0, string $price_base_type = 'HT', int $info_bits = 0, int|string $fk_remise_except = '', float|int $pu_ttc = 0, int $type = 0, int $special_code = 0, string $label = '', string $fk_unit = null) : int should be compatible with function addline(\User $user, int $fichinterid, string $desc, int $date_intervention, int $duration, array|string $array_options = '') : int defined in htdocs\fichinter\class\fichinter.class.php:1350 (Expected string $desc to have the same type as \User $user or a supertype) htdocs\fichinter\class\fichinterstats.class.php:95 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\fichinter\class\fichinterstats.class.php:142 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\mrp\class\mo.class.php:1573 PhanParamSignatureMismatch Declaration of function printOriginLine(\MoLine $line, string $var, string $restrictlist = '', string $defaulttpldir = '/core/tpl', array $selectedLines = []) : void should be compatible with function printOriginLine(\CommonObjectLine $line, string $var, string $restrictlist = '', string $defaulttpldir = '/core/tpl', array $selectedLines = []) : void defined in htdocs\core\class\commonobject.class.php:5215 (Expected \MoLine $line to have the same type as \CommonObjectLine $line or a supertype) htdocs\projet\class\projectstats.class.php:241 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\projet\class\projectstats.class.php:266 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\projet\class\taskstats.class.php:169 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\projet\class\taskstats.class.php:197 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\reception\class\receptionstats.class.php:91 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\reception\class\receptionstats.class.php:138 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\salaries\class\salariesstats.class.php:100 PhanParamSignatureMismatch Declaration of function getNbByMonth(string $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 (Expected string $year to have the same type as int $year or a supertype) htdocs\salaries\class\salariesstats.class.php:122 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\societe\class\companybankaccount.class.php:421 PhanParamSignatureMismatch Declaration of function fetch(int $id, int $socid = 0, int $default = 1, int|string $type = 'ban') : int should be compatible with function fetch(int $id, string $ref = '') : int defined in htdocs\compta\bank\class\account.class.php:999 (Expected int $socid = 0 to have the same type as string $ref = '' or a supertype) htdocs\ticket\class\ticketstats.class.php:98 PhanParamSignatureMismatch Declaration of function getNbByMonth(string $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 (Expected string $year to have the same type as int $year or a supertype) htdocs\ticket\class\ticketstats.class.php:119 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\user\class\user.class.php:1125 PhanParamSignatureMismatch Declaration of function getrights(string $moduletag = '', int $forcereload = 0) : void should be compatible with function getRights() : \stdClass defined in htdocs\core\class\commonobject.class.php:8684 htdocs\user\class\usergroup.class.php:573 PhanParamSignatureMismatch Declaration of function getrights(string $moduletag = '') : int should be compatible with function getRights() : \stdClass defined in htdocs\core\class\commonobject.class.php:8684 htdocs\variants\class\ProductAttribute.class.php:1315 PhanParamSignatureMismatch Declaration of function printObjectLines(string $action, string $seller, string $buyer, int $selected = 0, int $dateSelector = 0, string $defaulttpldir = '/variants/tpl', int $addcreateline = 0) : void should be compatible with function printObjectLines(string $action, \Societe $seller, \Societe $buyer, int $selected = 0, int $dateSelector = 0, string $defaulttpldir = '/core/tpl') : void defined in htdocs\core\class\commonobject.class.php:4945 (Expected string $seller to have the same type as \Societe $seller or a supertype) htdocs\variants\class\ProductAttribute.class.php:1398 PhanParamSignatureMismatch Declaration of function printObjectLine(string $action, \CommonObjectLine $line, string $var, int $num, int $i, int $dateSelector, string $seller, string $buyer, int $selected = 0, \Extrafields $extrafields = null, string $defaulttpldir = '/variants/tpl') : void should be compatible with function printObjectLine(string $action, \CommonObjectLine $line, string $var, int $num, int $i, int $dateSelector, \Societe $seller, \Societe $buyer, int $selected = 0, \Extrafields $extrafields = null, string $defaulttpldir = '/core/tpl') : void defined in htdocs\core\class\commonobject.class.php:5036 (Expected string $seller to have the same type as \Societe $seller or a supertype)  I can make a PR for this branch if you like, ignore more message types, etc.  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Phan static checks - merits attention  Bug I've added phan analysis support in [mdeweerd/test/phan](https://github.com/mdeweerd/Dolibarr/tree/test/phan). I think several messages merit attention: [phan.log](https://github.com/Dolibarr/dolibarr/files/13031629/phan.log) text htdocs\supplier_proposal\card.php:1342 PhanUndeclaredFunction Call to undeclared function \in_numeric() (Did you mean \is_numeric()) htdocs\public\onlinesign\newonlinesign.php:183 PhanUndeclaredMagicConstant Reference to magic constant __METHOD__ that is undeclared in the current scope: used outside of a functionlike htdocs\product\stock\stocktransfer\class\stocktransfer.class.php:345 PhanStaticCallToNonStatic Static call to non-static method \StockTransfer::cmp defined at htdocs\product\stock\stocktransfer\class\stocktransfer.class.php:356. This is an Error in PHP 8.0+. htdocs\comm\action\class\actioncomm.class.php:1337 PhanUndeclaredVariable Variable $db is undeclared (Did you mean $this->db) htdocs\core\menus\standard\empty.php:108 PhanUndeclaredVariable Variable $atarget is undeclared (Did you mean $this->atarget) htdocs\core\menus\standard\empty.php:128 PhanUndeclaredVariable Variable $atarget is undeclared (Did you mean $this->atarget) htdocs\expedition\class\expedition.class.php:1595 PhanUndeclaredVariable Variable $line is undeclared (Did you mean $lineindex) htdocs\expedition\class\expedition.class.php:1596 PhanUndeclaredVariable Variable $line is undeclared (Did you mean $lineindex) htdocs\fourn\class\fournisseur.facture-rec.class.php:1081 PhanUndeclaredVariable Variable $pu_ttc is undeclared (Did you mean $pu_ht) htdocs\fourn\class\fournisseur.facture-rec.class.php:1097 PhanUndeclaredVariable Variable $pu_ttc is undeclared (Did you mean $pu_ht) htdocs\hrm\position.php:1328 PhanUndeclaredVariable Variable $permissiontoread is undeclared (Did you mean $permissiontoadd) htdocs\mrp\class\mo.class.php:807 PhanUndeclaredVariable Variable $line is undeclared (Did you mean $this->line) htdocs\ticket\class\ticket.class.php:2931 PhanUndeclaredVariable Variable $user is undeclared (Did you mean $this->user) htdocs\intracommreport\card.php:120 PhanAccessPropertyStaticAsNonStatic Accessing static property \IntracommReport::$type as non static htdocs\intracommreport\list.php:569 PhanAccessPropertyStaticAsNonStatic Accessing static property \IntracommReport::$type as non static htdocs\core\actions_massactions.inc.php:1088 PhanParamTooFew Call with 0 arg(s) to \Facture::delete(\User $user, int $notrigger = 0, int $idwarehouse = unknown) which requires 1 arg(s) defined at htdocs\compta\facture\class\facture.class.php:2748 htdocs\don\class\don.class.php:1076 PhanParamTooMany Call with 6 arg(s) to \html_cerfafr::write_file(\Don $don, \Translate $outputlangs, string $currency = '') which only takes 3 arg(s) defined at htdocs\core\modules\dons\html_cerfafr.modules.php:76 htdocs\modulebuilder\index.php:3780 PhanParamTooMany Call with 2 arg(s) to \GETPOSTISSET(string $paramname) which only takes 1 arg(s) defined at htdocs\core\lib\functions.lib.php:520 htdocs\public\eventorganization\attendee_new.php:480 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\public\project\suggestbooth.php:274 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\public\project\suggestconference.php:275 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\societe\canvas\actions_card_common.class.php:167 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\societe\card.php:1961 PhanParamTooMany Call with 1 arg(s) to \mod_codeclient_leopard::__construct() which only takes 0 arg(s) defined at htdocs\core\modules\societe\mod_codeclient_leopard.php:69 htdocs\societe\consumption.php:516 PhanParamTooMany Call with 2 arg(s) to \Contrat::getLibStatut(int $mode) which only takes 1 arg(s) defined at htdocs\contrat\class\contrat.class.php:1948 htdocs\societe\consumption.php:518 PhanParamTooMany Call with 2 arg(s) to \Contrat::getLibStatut(int $mode) which only takes 1 arg(s) defined at htdocs\contrat\class\contrat.class.php:1948 htdocs\collab\index.php:131 PhanParamTooMany Call with 2 arg(s) to \Bookmark::fetch(int $id) which only takes 1 arg(s) defined at htdocs\bookmarks\class\bookmark.class.php:114 htdocs\admin\receiptprinter.php:67 PhanRedefineFunctionInternal Function gzdecode defined at htdocs\admin\receiptprinter.php:67 was previously defined internally htdocs\adherents\class\adherentstats.class.php:87 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\adherents\class\adherentstats.class.php:124 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\comm\propal\class\propalestats.class.php:119 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\comm\propal\class\propalestats.class.php:168 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\commande\class\commandestats.class.php:120 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\commande\class\commandestats.class.php:169 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\compta\deplacement\class\deplacementstats.class.php:101 PhanParamSignatureMismatch Declaration of function getNbByMonth(string $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 (Expected string $year to have the same type as int $year or a supertype) htdocs\compta\deplacement\class\deplacementstats.class.php:123 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\compta\facture\class\facturestats.class.php:133 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\compta\facture\class\facturestats.class.php:184 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\core\db\mysqli.class.php:243 PhanParamSignatureMismatch Declaration of function connect(string $host, string $login, string $passwd, string $name, int $port = 0) : \mysqli|null should be compatible with function connect(string $host, string $login, string $passwd, string $name, int $port = 0) : resource defined in htdocs\core\db\Database.interface.php:258 htdocs\core\db\mysqli.class.php:378 PhanParamSignatureMismatch Declaration of function fetch_object(\mysqli_result $resultset) : null|object should be compatible with function fetch_object(\Connection|resource $resultset) : object defined in htdocs\core\db\Database.interface.php:521 (Expected \mysqli_result $resultset to have the same type as \Connection|resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:396 PhanParamSignatureMismatch Declaration of function fetch_array(\mysqli_result $resultset) : array|null should be compatible with function fetch_array(resource $resultset) : array defined in htdocs\core\db\Database.interface.php:174 (Expected \mysqli_result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:413 PhanParamSignatureMismatch Declaration of function fetch_row(\mysqli_result $resultset) : array|int|null should be compatible with function fetch_row(resource $resultset) : array defined in htdocs\core\db\Database.interface.php:45 (Expected \mysqli_result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:436 PhanParamSignatureMismatch Declaration of function num_rows(\mysqli_result $resultset) : int should be compatible with function num_rows(resource $resultset) : int defined in htdocs\core\db\Database.interface.php:300 (Expected \mysqli_result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:454 PhanParamSignatureMismatch Declaration of function affected_rows(\mysqli_result $resultset) : int should be compatible with function affected_rows(resource $resultset) : int defined in htdocs\core\db\Database.interface.php:111 (Expected \mysqli_result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\mysqli.class.php:473 PhanParamSignatureMismatch Declaration of function free(\mysqli_result $resultset = null) : void should be compatible with function free(resource $resultset = null) : void defined in htdocs\core\db\Database.interface.php:488 (Expected \mysqli_result $resultset = unknown to have the same type as resource $resultset = unknown or a supertype) htdocs\core\db\mysqli.class.php:679 PhanParamSignatureMismatch Declaration of function DDLCreateDb(string $database, string $charset = '', string $collation = '', string $owner = '') : \mysqli_result|bool should be compatible with function DDLCreateDb(string $database, string $charset = '', string $collation = '', string $owner = '') : resource defined in htdocs\core\db\Database.interface.php:84 htdocs\core\db\mysqli.class.php:910 PhanParamSignatureMismatch Declaration of function DDLDescTable(string $table, string $field = '') : \mysqli_result|bool should be compatible with function DDLDescTable(string $table, string $field = '') : resource defined in htdocs\core\db\Database.interface.php:408 htdocs\core\db\pgsql.class.php:856 PhanParamSignatureMismatch Declaration of function last_insert_id(string $tab, string $fieldid = 'rowid') : string should be compatible with function last_insert_id(string $tab, string $fieldid = 'rowid') : int defined in htdocs\core\db\Database.interface.php:217 htdocs\core\db\pgsql.class.php:899 PhanParamSignatureMismatch Declaration of function decrypt(int $value) : string should be compatible with function decrypt(string $value) : string defined in htdocs\core\db\Database.interface.php:165 (Expected int $value to have the same type as string $value or a supertype) htdocs\core\db\sqlite3.class.php:322 PhanParamSignatureMismatch Declaration of function connect(string $host, string $login, string $passwd, string $name, int $port = 0) : \SQLite3|string should be compatible with function connect(string $host, string $login, string $passwd, string $name, int $port = 0) : resource defined in htdocs\core\db\Database.interface.php:258 htdocs\core\db\sqlite3.class.php:517 PhanParamSignatureMismatch Declaration of function fetch_object(\SQLite3Result $resultset) : false|object should be compatible with function fetch_object(\Connection|resource $resultset) : object defined in htdocs\core\db\Database.interface.php:521 (Expected \SQLite3Result $resultset to have the same type as \Connection|resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:540 PhanParamSignatureMismatch Declaration of function fetch_array(\SQLite3Result $resultset) : array|false should be compatible with function fetch_array(resource $resultset) : array defined in htdocs\core\db\Database.interface.php:174 (Expected \SQLite3Result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:559 PhanParamSignatureMismatch Declaration of function fetch_row(\SQLite3Result $resultset) : array|false should be compatible with function fetch_row(resource $resultset) : array defined in htdocs\core\db\Database.interface.php:45 (Expected \SQLite3Result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:582 PhanParamSignatureMismatch Declaration of function num_rows(\SQLite3Result $resultset) : int should be compatible with function num_rows(resource $resultset) : int defined in htdocs\core\db\Database.interface.php:300 (Expected \SQLite3Result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:605 PhanParamSignatureMismatch Declaration of function affected_rows(\SQLite3Result $resultset) : int should be compatible with function affected_rows(resource $resultset) : int defined in htdocs\core\db\Database.interface.php:111 (Expected \SQLite3Result $resultset to have the same type as resource $resultset or a supertype) htdocs\core\db\sqlite3.class.php:629 PhanParamSignatureMismatch Declaration of function free(\SQLite3Result $resultset = null) : void should be compatible with function free(resource $resultset = null) : void defined in htdocs\core\db\Database.interface.php:488 (Expected \SQLite3Result $resultset = unknown to have the same type as resource $resultset = unknown or a supertype) htdocs\core\db\sqlite3.class.php:847 PhanParamSignatureMismatch Declaration of function DDLCreateDb(string $database, string $charset = '', string $collation = '', string $owner = '') : \SQLite3Result should be compatible with function DDLCreateDb(string $database, string $charset = '', string $collation = '', string $owner = '') : resource defined in htdocs\core\db\Database.interface.php:84 htdocs\core\db\sqlite3.class.php:1066 PhanParamSignatureMismatch Declaration of function DDLDescTable(string $table, string $field = '') : \SQLite3Result|bool should be compatible with function DDLDescTable(string $table, string $field = '') : resource defined in htdocs\core\db\Database.interface.php:408 htdocs\core\modules\barcode\mod_barcode_thirdparty_standard.php:180 PhanParamSignatureMismatch Declaration of function getNextValue(\Societe $objthirdparty, string $type = '') : string should be compatible with function getNextValue(\Product $objproduct, string $type = '') : string defined in htdocs\core\modules\barcode\modules_barcode.class.php:63 (Expected \Societe $objthirdparty to have the same type as \Product $objproduct or a supertype) htdocs\core\modules\member\doc\pdf_standard.class.php:275 PhanParamSignatureMismatch Declaration of function write_file(\Adherent $object, \Translate $outputlangs, string $srctemplatepath, string $mode = 'member', int $nooutput = 0, string $filename = 'tmp_cards') : int should be compatible with function write_file(array $arrayofrecords, \Translate $outputlangs, string $srctemplatepath, string $outputdir = '') : int defined in htdocs\core\class\commonstickergenerator.class.php:129 (Expected \Adherent $object to have the same type as array $arrayofrecords or a supertype) htdocs\core\modules\syslog\mod_syslog_file.php:52 PhanParamSignatureMismatch Declaration of function isActive() : int should be compatible with function isActive() : bool defined in htdocs\core\modules\syslog\logHandler.php:63 htdocs\core\modules\syslog\mod_syslog_file.php:52 PhanParamSignatureMismatch Declaration of function isActive() : int should be compatible with function isActive() : bool defined in htdocs\core\modules\syslog\logHandlerInterface.php:77 htdocs\core\modules\syslog\mod_syslog_file.php:82 PhanParamSignatureMismatch Declaration of function checkConfiguration() : array should be compatible with function checkConfiguration() : bool defined in htdocs\core\modules\syslog\logHandlerInterface.php:70 htdocs\core\modules\syslog\mod_syslog_file.php:138 PhanParamSignatureMismatch Declaration of function export(array $content, string $suffixinfilename = '') : void should be compatible with function export(string $content) : void defined in htdocs\core\modules\syslog\logHandlerInterface.php:85 (Expected array $content to have the same type as string $content or a supertype) htdocs\core\modules\syslog\mod_syslog_syslog.php:49 PhanParamSignatureMismatch Declaration of function isActive() : int should be compatible with function isActive() : bool defined in htdocs\core\modules\syslog\logHandler.php:63 htdocs\core\modules\syslog\mod_syslog_syslog.php:49 PhanParamSignatureMismatch Declaration of function isActive() : int should be compatible with function isActive() : bool defined in htdocs\core\modules\syslog\logHandlerInterface.php:77 htdocs\core\modules\syslog\mod_syslog_syslog.php:84 PhanParamSignatureMismatch Declaration of function checkConfiguration() : array should be compatible with function checkConfiguration() : bool defined in htdocs\core\modules\syslog\logHandlerInterface.php:70 htdocs\core\modules\syslog\mod_syslog_syslog.php:111 PhanParamSignatureMismatch Declaration of function export(array $content) : void should be compatible with function export(string $content) : void defined in htdocs\core\modules\syslog\logHandlerInterface.php:85 (Expected array $content to have the same type as string $content or a supertype) htdocs\don\class\donstats.class.php:100 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\don\class\donstats.class.php:137 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\eventorganization\class\conferenceorbooth.class.php:185 PhanParamSignatureMismatch Declaration of function create(\User $user, bool|false $notrigger = false) : int should be compatible with function create(\User $user, int $notrigger = 0) : int defined in htdocs\comm\action\class\actioncomm.class.php:429 (Expected bool|false $notrigger = false to have the same type as int $notrigger = 0 or a supertype) htdocs\eventorganization\class\conferenceorbooth.class.php:351 PhanParamSignatureMismatch Declaration of function update(\User $user, bool|false $notrigger = false) : int should be compatible with function update(\User $user, int $notrigger = 0) : int defined in htdocs\comm\action\class\actioncomm.class.php:1123 (Expected bool|false $notrigger = false to have the same type as int $notrigger = 0 or a supertype) htdocs\eventorganization\class\conferenceorbooth.class.php:364 PhanParamSignatureMismatch Declaration of function delete(bool|false $notrigger = false) : int should be compatible with function delete(int $notrigger = 0) : int defined in htdocs\comm\action\class\actioncomm.class.php:1025 (Expected bool|false $notrigger = false to have the same type as int $notrigger = 0 or a supertype) htdocs\eventorganization\class\conferenceorbooth.class.php:743 PhanParamSignatureMismatch Declaration of function initAsSpecimen() : void should be compatible with function initAsSpecimen() : int defined in htdocs\comm\action\class\actioncomm.class.php:2327 htdocs\expedition\class\expeditionstats.class.php:94 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\expedition\class\expeditionstats.class.php:141 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\expensereport\class\expensereportstats.class.php:113 PhanParamSignatureMismatch Declaration of function getNbByMonth(string $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 (Expected string $year to have the same type as int $year or a supertype) htdocs\expensereport\class\expensereportstats.class.php:135 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\fichinter\class\fichinterrec.class.php:468 PhanParamSignatureMismatch Declaration of function addline(string $desc, int $duration, string $date, int $rang = unknown, float|int $pu_ht = 0, float|int $qty = 0, float|int $txtva = 0, int $fk_product = 0, float|int $remise_percent = 0, string $price_base_type = 'HT', int $info_bits = 0, int|string $fk_remise_except = '', float|int $pu_ttc = 0, int $type = 0, int $special_code = 0, string $label = '', string $fk_unit = null) : int should be compatible with function addline(\User $user, int $fichinterid, string $desc, int $date_intervention, int $duration, array|string $array_options = '') : int defined in htdocs\fichinter\class\fichinter.class.php:1350 (Expected string $desc to have the same type as \User $user or a supertype) htdocs\fichinter\class\fichinterstats.class.php:95 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\fichinter\class\fichinterstats.class.php:142 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\mrp\class\mo.class.php:1573 PhanParamSignatureMismatch Declaration of function printOriginLine(\MoLine $line, string $var, string $restrictlist = '', string $defaulttpldir = '/core/tpl', array $selectedLines = []) : void should be compatible with function printOriginLine(\CommonObjectLine $line, string $var, string $restrictlist = '', string $defaulttpldir = '/core/tpl', array $selectedLines = []) : void defined in htdocs\core\class\commonobject.class.php:5215 (Expected \MoLine $line to have the same type as \CommonObjectLine $line or a supertype) htdocs\projet\class\projectstats.class.php:241 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\projet\class\projectstats.class.php:266 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\projet\class\taskstats.class.php:169 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\projet\class\taskstats.class.php:197 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\reception\class\receptionstats.class.php:91 PhanParamSignatureMismatch Declaration of function getNbByMonth(int $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 htdocs\reception\class\receptionstats.class.php:138 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\salaries\class\salariesstats.class.php:100 PhanParamSignatureMismatch Declaration of function getNbByMonth(string $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 (Expected string $year to have the same type as int $year or a supertype) htdocs\salaries\class\salariesstats.class.php:122 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\societe\class\companybankaccount.class.php:421 PhanParamSignatureMismatch Declaration of function fetch(int $id, int $socid = 0, int $default = 1, int|string $type = 'ban') : int should be compatible with function fetch(int $id, string $ref = '') : int defined in htdocs\compta\bank\class\account.class.php:999 (Expected int $socid = 0 to have the same type as string $ref = '' or a supertype) htdocs\ticket\class\ticketstats.class.php:98 PhanParamSignatureMismatch Declaration of function getNbByMonth(string $year, int $format = 0) : array should be compatible with function getNbByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:82 (Expected string $year to have the same type as int $year or a supertype) htdocs\ticket\class\ticketstats.class.php:119 PhanParamSignatureMismatch Declaration of function getAmountByMonth(int $year, int $format = 0) : array should be compatible with function getAmountByMonth(int $year, int $format = 0) : int defined in htdocs\core\class\stats.class.php:177 htdocs\user\class\user.class.php:1125 PhanParamSignatureMismatch Declaration of function getrights(string $moduletag = '', int $forcereload = 0) : void should be compatible with function getRights() : \stdClass defined in htdocs\core\class\commonobject.class.php:8684 htdocs\user\class\usergroup.class.php:573 PhanParamSignatureMismatch Declaration of function getrights(string $moduletag = '') : int should be compatible with function getRights() : \stdClass defined in htdocs\core\class\commonobject.class.php:8684 htdocs\variants\class\ProductAttribute.class.php:1315 PhanParamSignatureMismatch Declaration of function printObjectLines(string $action, string $seller, string $buyer, int $selected = 0, int $dateSelector = 0, string $defaulttpldir = '/variants/tpl', int $addcreateline = 0) : void should be compatible with function printObjectLines(string $action, \Societe $seller, \Societe $buyer, int $selected = 0, int $dateSelector = 0, string $defaulttpldir = '/core/tpl') : void defined in htdocs\core\class\commonobject.class.php:4945 (Expected string $seller to have the same type as \Societe $seller or a supertype) htdocs\variants\class\ProductAttribute.class.php:1398 PhanParamSignatureMismatch Declaration of function printObjectLine(string $action, \CommonObjectLine $line, string $var, int $num, int $i, int $dateSelector, string $seller, string $buyer, int $selected = 0, \Extrafields $extrafields = null, string $defaulttpldir = '/variants/tpl') : void should be compatible with function printObjectLine(string $action, \CommonObjectLine $line, string $var, int $num, int $i, int $dateSelector, \Societe $seller, \Societe $buyer, int $selected = 0, \Extrafields $extrafields = null, string $defaulttpldir = '/core/tpl') : void defined in htdocs\core\class\commonobject.class.php:5036 (Expected string $seller to have the same type as \Societe $seller or a supertype)  I can make a PR for this branch if you like, ignore more message types, etc.  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.95
33101,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33101,White page on ticket card when we want to add a link by reference, Bug White page on ticket card when we want to add a link by reference  Dolibarr Version develop  Environment PHP PHP 7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. create a ticket 2. create a proposal 3. go on ticket card created and try to link to the created proposal ![Image](https://github.com/user-attachments/assets/12276367-a74c-4347-91c8-2ab5faa8f96c) 4. Search by reference and link to the selected proposal 5. you got a white page ![Image](https://github.com/user-attachments/assets/5b8c7fc7-a97a-42bc-8090-7908ed5a6fcc)  Attached files _No response_,other-file | other-file | other-file,White page on ticket card when we want to add a link by reference  Bug White page on ticket card when we want to add a link by reference  Dolibarr Version develop  Environment PHP PHP 7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. create a ticket 2. create a proposal 3. go on ticket card created and try to link to the created proposal ![Image](https://github.com/user-attachments/assets/12276367-a74c-4347-91c8-2ab5faa8f96c) 4. Search by reference and link to the selected proposal 5. you got a white page ![Image](https://github.com/user-attachments/assets/5b8c7fc7-a97a-42bc-8090-7908ed5a6fcc)  Attached files _No response_ other-file other-file other-file,no-bug,0.9
24256,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24256,Enhancement for product variants," Feature Request Hi Contributors, Upon creation of the product variants, you can select multiple variants at one run however when hitting Create it only considers the last chosen Variant attribute. It would be so much more quick and convenient if the system would consider all of the selected attributes and would create them all together. Thanks a lot! ![image](https://user-images.githubusercontent.com/21037425/226110795-90f069e0-8a16-4685-a0e0-e88bf475eb67.png)  Use case Less time consuming when many combinations must be created.  Suggested implementation _No response_  Suggested steps _No response_",other-file | other-file | other-file | other-file | config-file | other-file | other-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | other-file | other-file | database-file | other-file | other-file | config-file | config-file | other-file | other-file | config-file | other-file | config-file | other-file | other-file | documentation-file | documentation-file | config-file | config-file | other-file | documentation-file | other-file | documentation-file | other-file | config-file | other-file | documentation-file | config-file | database-file | database-file | config-file | config-file | config-file | config-file | other-file | other-file | documentation-file | documentation-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | other-file | test-file | test-file | test-file | test-file | test-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Enhancement for product variants  Feature Request Hi Contributors, Upon creation of the product variants, you can select multiple variants at one run however when hitting Create it only considers the last chosen Variant attribute. It would be so much more quick and convenient if the system would consider all of the selected attributes and would create them all together. Thanks a lot! ![image](https://user-images.githubusercontent.com/21037425/226110795-90f069e0-8a16-4685-a0e0-e88bf475eb67.png)  Use case Less time consuming when many combinations must be created.  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file config-file other-file other-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file other-file other-file database-file other-file other-file config-file config-file other-file other-file config-file other-file config-file other-file other-file documentation-file documentation-file config-file config-file other-file documentation-file other-file documentation-file other-file config-file other-file documentation-file config-file database-file database-file config-file config-file config-file config-file other-file other-file documentation-file documentation-file other-file config-file config-file config-file config-file config-file config-file other-file test-file test-file test-file test-file test-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
25416,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25416,the email subject is not replaced when an email template is applied in tickets," Bug Using the button SEND EMAIL in tickets module, offer the possibility to select and apply an email remplate. The email template already created in emails module setup selecting ""Tickets "" as type of template, have already defined a Subject and a content message, but only the content message is replaced and the Subject is not replaced.  Environment Version 17.0.2  Environment OS Linux  Environment Web server Apache2  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 5.5.5-10.3.31-MariaDB  Environment URL(s) https://YOURSERVER.COM/ticket/card.php?action=presend_addmessage&send_email=1&private_message=0&mode=init&token=XXXXXXXXXXXX_id=XXXXX#formmailbeforetitle  Expected and actual behavior The current behaviour is that after applying the email template only the content of the message is replaced, and the expected behavior is that both the Subject and the content of the message be replaced after applying an email template.  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"the email subject is not replaced when an email template is applied in tickets  Bug Using the button SEND EMAIL in tickets module, offer the possibility to select and apply an email remplate. The email template already created in emails module setup selecting ""Tickets "" as type of template, have already defined a Subject and a content message, but only the content message is replaced and the Subject is not replaced.  Environment Version 17.0.2  Environment OS Linux  Environment Web server Apache2  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 5.5.5-10.3.31-MariaDB  Environment URL(s) https://YOURSERVER.COM/ticket/card.php?action=presend_addmessage&send_email=1&private_message=0&mode=init&token=XXXXXXXXXXXX_id=XXXXX#formmailbeforetitle  Expected and actual behavior The current behaviour is that after applying the email template only the content of the message is replaced, and the expected behavior is that both the Subject and the content of the message be replaced after applying an email template.  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
23493,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23493,Contacts List - show Birthday, Feature Request Contacts list add option to show field Birthday htdocs/contact/list.php  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file | other-file | other-file,Contacts List - show Birthday  Feature Request Contacts list add option to show field Birthday htdocs/contact/list.php  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file,no-bug,0.95
24769,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24769,Suplier commercial proposal-External user-Acces refused," Bug Dear All, External user (with appropriate rules) show connection refused for supplier proposal (creation, modification). For other modules this works correctly, below message (in French sorry). Accs refus. Vous essayez daccder  une page, rgion ou fonctionnalit dun module dsactiv, ou sans tre dans une session authentifie, ou avec un utilisateur non autoris. Identifiant courant: XXXXXXXXX Les permissions pour cet identifiant peuvent tre attribues par ladministrateur Dolibarr via le menu Accueil  Utilisateurs.Remarque : effacez les cookies de votre navigateur pour dtruire les sessions existantes pour cette connexion. Regards  Environment Version 17.0.1  Environment OS Ubuntu Server 20.04  Environment Web server Apache  Environment PHP PHP8.1  Environment Database Postgresql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Suplier commercial proposal-External user-Acces refused  Bug Dear All, External user (with appropriate rules) show connection refused for supplier proposal (creation, modification). For other modules this works correctly, below message (in French sorry). Accs refus. Vous essayez daccder  une page, rgion ou fonctionnalit dun module dsactiv, ou sans tre dans une session authentifie, ou avec un utilisateur non autoris. Identifiant courant: XXXXXXXXX Les permissions pour cet identifiant peuvent tre attribues par ladministrateur Dolibarr via le menu Accueil  Utilisateurs.Remarque : effacez les cookies de votre navigateur pour dtruire les sessions existantes pour cette connexion. Regards  Environment Version 17.0.1  Environment OS Ubuntu Server 20.04  Environment Web server Apache  Environment PHP PHP8.1  Environment Database Postgresql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
31103,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31103,Auto assign user at creation, Feature Request Auto assign the user at creation if no user was set assigned at creation. Actually the option that exist TICKET_AUTO_ASSIGN_USER_CREATE force the user even if you select someone else as the assigned user at creation.  Use case You want to create a ticket and be sure that someone is assigned even if you forget to fill the assigned user field but have the possibility to assign whoever you want at creation  Suggested implementation Either : 1. Modify TICKET_AUTO_ASSIGN_USER_CREATE to check if a user is already assigned. 2. Have 2 options : - TICKET_AUTO_ASSIGN_USER_CREATE : Auto assign the user at creation if no user was set assigned at creation. - TICKET_FORCE_ASSIGN_USER_CREATE : Force the user as the assigned user (actual TICKET_AUTO_ASSIGN_USER_CREATE)  Suggested steps _No response_,other-file | other-file | other-file | other-file,Auto assign user at creation  Feature Request Auto assign the user at creation if no user was set assigned at creation. Actually the option that exist TICKET_AUTO_ASSIGN_USER_CREATE force the user even if you select someone else as the assigned user at creation.  Use case You want to create a ticket and be sure that someone is assigned even if you forget to fill the assigned user field but have the possibility to assign whoever you want at creation  Suggested implementation Either : 1. Modify TICKET_AUTO_ASSIGN_USER_CREATE to check if a user is already assigned. 2. Have 2 options : - TICKET_AUTO_ASSIGN_USER_CREATE : Auto assign the user at creation if no user was set assigned at creation. - TICKET_FORCE_ASSIGN_USER_CREATE : Force the user as the assigned user (actual TICKET_AUTO_ASSIGN_USER_CREATE)  Suggested steps _No response_ other-file other-file other-file other-file,no-bug,0.9
25793,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25793,V18.0.1 : Cannot add time spent," Bug Cannot add time spent  Environment Version 18.0.1  Environment OS Debian 10.10  Environment Web server nginx 1.23.1  Environment PHP 7.3.31  Environment Database PostgreSQL 13.12  Environment URL(s) /projet/tasks/time.php?action=createtime  Expected and actual behavior Expected : When user add time spent, everything is OK Actual : When user add time spent, there is a crash and error message : `ERREUR: 42P01: la relation  llx_element_time_rowid_seq  n'existe pas LINE 1: SELECT currval('llx_element_time_rowid_seq') ^ LOCATION: RangeVarGetRelidExtended, namespace.c:435`  Steps to reproduce the behavior Go to a project Choose time spent Click on add time Choose values and submit  Attached files Before add time spent ![2023-09-05_093419](https://github.com/Dolibarr/dolibarr/assets/11213740/559a92d9-c72c-4ff2-b7de-6ac5dec9f1dd) After submit ![2023-09-05_093813](https://github.com/Dolibarr/dolibarr/assets/11213740/ed921ab7-a36c-4f61-a286-fdebae293973)",database-file | database-file | database-file,"V18.0.1 : Cannot add time spent  Bug Cannot add time spent  Environment Version 18.0.1  Environment OS Debian 10.10  Environment Web server nginx 1.23.1  Environment PHP 7.3.31  Environment Database PostgreSQL 13.12  Environment URL(s) /projet/tasks/time.php?action=createtime  Expected and actual behavior Expected : When user add time spent, everything is OK Actual : When user add time spent, there is a crash and error message : `ERREUR: 42P01: la relation  llx_element_time_rowid_seq  n'existe pas LINE 1: SELECT currval('llx_element_time_rowid_seq') ^ LOCATION: RangeVarGetRelidExtended, namespace.c:435`  Steps to reproduce the behavior Go to a project Choose time spent Click on add time Choose values and submit  Attached files Before add time spent ![2023-09-05_093419](https://github.com/Dolibarr/dolibarr/assets/11213740/559a92d9-c72c-4ff2-b7de-6ac5dec9f1dd) After submit ![2023-09-05_093813](https://github.com/Dolibarr/dolibarr/assets/11213740/ed921ab7-a36c-4f61-a286-fdebae293973) database-file database-file database-file",no-bug,0.9
27273,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27273,MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND doesn't work as expected," Bug I wanted to use MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND=1 (tva calculated and rounded on general sums, cf ""mode 2"" described here https://wiki.dolibarr.org/index.php/R%C3%A8gles_de_param%C3%A9trage,_calcul_et_arrondi_de_TVA) But it doesn't run as expected. I examined the code of `function update_price()` in commonobject.class.php Even in mode 2 wih MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND=1, the sum of vat is calculated with sum of vat lines (rounded to 2 dec by default), and is eventualy corrected by $diff (see in the code). That's seems to me unlogical. I think the total(s) vat should be calculated at the end of the loop on lines using $total_ht_by_vats array * vat_rate I suggest like in the followig PR to add another mode MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND=2 which use total_ht_by_vats array, so that it doesn't break existing configurations Inspecting the code, I found in facture and in supplier facture some incoherencies : sometimes `update_price()` is called `update_price(1)` some other times, it's called `update_price(1, 'auto')` As the default value for 2nd param of update_price is 'none', the invoice's total may vary when validated. So I changed every call to `update_price(1, 'auto')`  Environment Version all (including develop branch)  Environment OS All  Environment Web server not applicable  Environment PHP all  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file,"MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND doesn't work as expected  Bug I wanted to use MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND=1 (tva calculated and rounded on general sums, cf ""mode 2"" described here https://wiki.dolibarr.org/index.php/R%C3%A8gles_de_param%C3%A9trage,_calcul_et_arrondi_de_TVA) But it doesn't run as expected. I examined the code of `function update_price()` in commonobject.class.php Even in mode 2 wih MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND=1, the sum of vat is calculated with sum of vat lines (rounded to 2 dec by default), and is eventualy corrected by $diff (see in the code). That's seems to me unlogical. I think the total(s) vat should be calculated at the end of the loop on lines using $total_ht_by_vats array * vat_rate I suggest like in the followig PR to add another mode MAIN_ROUNDOFTOTAL_NOT_TOTALOFROUND=2 which use total_ht_by_vats array, so that it doesn't break existing configurations Inspecting the code, I found in facture and in supplier facture some incoherencies : sometimes `update_price()` is called `update_price(1)` some other times, it's called `update_price(1, 'auto')` As the default value for 2nd param of update_price is 'none', the invoice's total may vary when validated. So I changed every call to `update_price(1, 'auto')`  Environment Version all (including develop branch)  Environment OS All  Environment Web server not applicable  Environment PHP all  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file",no-bug,0.8
23494,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23494,Thirdparty Contact List - show Birthday, Feature Request option to show Birthday on Thirdparty contacts view htdocs/societe/contact.php  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file | other-file,Thirdparty Contact List - show Birthday  Feature Request option to show Birthday on Thirdparty contacts view htdocs/societe/contact.php  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file,no-bug,0.9
29098,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29098,Contact pages does not set correct browser title," Bug Contact pages does not set correct browser title, where as the thirdparty pages (mostly) does set the correct title.  Dolibarr Version 19.0.0  Environment PHP 8.2.7  Environment Database 11.3.2-MariaDB-1:11.3.2+maria~ubu2204  Steps to reproduce the behavior and expected behavior Create thirdparty. Create contact for thirdparty. Find a list of contacts either all of them, or under thirdparty and contacts. Then go through all the tabs in the top: - Contact/Address, page title in browser is New Contact/Address - where's the new coming from? - Personal data, page title in browser is Contacts/Addresses, should be Personal data - Related Items, page title in browser is Contacts/Addresses, should be Related items - Note, page title in browser is Contacts/Addresses, should be Note - Linked files, page title in browser is Contact Label, should be Linked Files - Events/Agenda, page title in browser is Contacts/Addresses, should be Events/Agenda This one is as expected - Projects, page title in browser is projects, should be projects  Attached files ![contact_event_agenda](https://github.com/Dolibarr/dolibarr/assets/2551481/9ac137ff-7fbb-4aec-9538-e8d08c1491cd) ![contact_linked_files](https://github.com/Dolibarr/dolibarr/assets/2551481/a2263225-3e21-4f49-bf73-186db63abab1) ![contact_note](https://github.com/Dolibarr/dolibarr/assets/2551481/7ced3bff-0f5a-4fda-b83d-c8fdb0de33c3) ![contact_related_items](https://github.com/Dolibarr/dolibarr/assets/2551481/dd23750f-54d6-4e94-9d8a-7e91eacb6aa4) ![contact,address_should_be_personal_data](https://github.com/Dolibarr/dolibarr/assets/2551481/80fa1146-4587-4fa9-aaa4-7b001fcb664b) ![contact_projects](https://github.com/Dolibarr/dolibarr/assets/2551481/0ff1ff11-6f52-4557-ace9-1a3b3f10d3b7) ![new_contact_should_just_be_contact](https://github.com/Dolibarr/dolibarr/assets/2551481/d9f562af-a8b8-4394-913d-9cba32254806)",other-file,"Contact pages does not set correct browser title  Bug Contact pages does not set correct browser title, where as the thirdparty pages (mostly) does set the correct title.  Dolibarr Version 19.0.0  Environment PHP 8.2.7  Environment Database 11.3.2-MariaDB-1:11.3.2+maria~ubu2204  Steps to reproduce the behavior and expected behavior Create thirdparty. Create contact for thirdparty. Find a list of contacts either all of them, or under thirdparty and contacts. Then go through all the tabs in the top: - Contact/Address, page title in browser is New Contact/Address - where's the new coming from? - Personal data, page title in browser is Contacts/Addresses, should be Personal data - Related Items, page title in browser is Contacts/Addresses, should be Related items - Note, page title in browser is Contacts/Addresses, should be Note - Linked files, page title in browser is Contact Label, should be Linked Files - Events/Agenda, page title in browser is Contacts/Addresses, should be Events/Agenda This one is as expected - Projects, page title in browser is projects, should be projects  Attached files ![contact_event_agenda](https://github.com/Dolibarr/dolibarr/assets/2551481/9ac137ff-7fbb-4aec-9538-e8d08c1491cd) ![contact_linked_files](https://github.com/Dolibarr/dolibarr/assets/2551481/a2263225-3e21-4f49-bf73-186db63abab1) ![contact_note](https://github.com/Dolibarr/dolibarr/assets/2551481/7ced3bff-0f5a-4fda-b83d-c8fdb0de33c3) ![contact_related_items](https://github.com/Dolibarr/dolibarr/assets/2551481/dd23750f-54d6-4e94-9d8a-7e91eacb6aa4) ![contact,address_should_be_personal_data](https://github.com/Dolibarr/dolibarr/assets/2551481/80fa1146-4587-4fa9-aaa4-7b001fcb664b) ![contact_projects](https://github.com/Dolibarr/dolibarr/assets/2551481/0ff1ff11-6f52-4557-ace9-1a3b3f10d3b7) ![new_contact_should_just_be_contact](https://github.com/Dolibarr/dolibarr/assets/2551481/d9f562af-a8b8-4394-913d-9cba32254806) other-file",no-bug,0.95
29843,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29843,Bug: Warning: Division by zero,"# Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug [*Short description*] ## Environment - **Version**: 19.0.2 - **OS**: Linux - **Web server**: Apache - **PHP**: fpm-fcgi 7.4.33 - **Database**: MySQL or MariaDB 5.5.5-10.4.25-MariaDB-1:10.4.25+maria~stretch-log - **URL(s)**: /compta/stats/index.php?leftmenu=accountancy_report&modecompta=BOOKKEEPING ## Expected and actual behavior If I asked for turnover invoiced : the April month is providing me an error Warning: Division by zero in /home/clients/75b383e1e32cfcb0a1b615c70a4bac17/erp/compta/stats/index.php on line 465 +INF% ## Steps to reproduce the behavior When opening the report section for Turnover by customer in accounting menu, choose turnover by customer ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging informations) ![2024-05-22_18-27-19](https://github.com/Dolibarr/dolibarr/assets/58973675/e91fb560-0419-4653-a862-314f55beae4d) ## Report",other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Bug: Warning: Division by zero # Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug [*Short description*] ## Environment - **Version**: 19.0.2 - **OS**: Linux - **Web server**: Apache - **PHP**: fpm-fcgi 7.4.33 - **Database**: MySQL or MariaDB 5.5.5-10.4.25-MariaDB-1:10.4.25+maria~stretch-log - **URL(s)**: /compta/stats/index.php?leftmenu=accountancy_report&modecompta=BOOKKEEPING ## Expected and actual behavior If I asked for turnover invoiced : the April month is providing me an error Warning: Division by zero in /home/clients/75b383e1e32cfcb0a1b615c70a4bac17/erp/compta/stats/index.php on line 465 +INF% ## Steps to reproduce the behavior When opening the report section for Turnover by customer in accounting menu, choose turnover by customer ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging informations) ![2024-05-22_18-27-19](https://github.com/Dolibarr/dolibarr/assets/58973675/e91fb560-0419-4653-a862-314f55beae4d) ## Report other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
32408,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32408,Bug: Dictionnaries Types de contacts/adresses element not translated," Bug Version: 20.0.2 Hello, In Dictionnaries > Types de contacts/adresses some fields are not translated ![image](https://github.com/user-attachments/assets/2bb5db80-cd2c-47c4-aa99-75ba18dcd324) ![image](https://github.com/user-attachments/assets/40015d56-a308-417e-9cc3-bc6d5dcf84e7)  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"Bug: Dictionnaries Types de contacts/adresses element not translated  Bug Version: 20.0.2 Hello, In Dictionnaries > Types de contacts/adresses some fields are not translated ![image](https://github.com/user-attachments/assets/2bb5db80-cd2c-47c4-aa99-75ba18dcd324) ![image](https://github.com/user-attachments/assets/40015d56-a308-417e-9cc3-bc6d5dcf84e7)  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
24508,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24508,Label not reported when creating a supplier invoice template," Bug [English] If I create a template from a draft supplier invoice: The label is copied The label is not included when you save the template (the first time). If I modify the template label after its creation, it is saved in the template. If I create a supplier invoice manually from a template, I arrive on the draft creation page: The label is not included. If I add the label on the draft creation page (still from the template) and I create the draft: Still no label. Once the draft is created and by adding the label again and saving the changes to the draft, the label is finally memorized. Translated with www.DeepL.com/Translator (free version)  [french] Si je cre un modle depuis un brouillon de facture fournisseur : Le libell est recopi Le libell nest par contre pas repris quand on enregistre le modle (la premire fois). Si je modifie le libell du modle aprs sa cration, il est mmoris dans le modle. Si je cre une facture fournisseur manuellement depuis un modle, jarrive sur la page de cration du brouillon : Le libell nest pas repris. Si je rajoute le libell sur la page de cration du brouillon (toujours en tant parti du modle) et que je cre le brouillon : Toujours pas de libell. Cest une fois sur le brouillon cr et en renseignant  nouveau le libell et en enregistrant les modifications du brouillon que le libell est enfin mmoris. Link of the topic on the forum: https://www.dolibarr.fr/forum/t/bugs-dans-les-modeles-de-facture/42113/2  Environment Version 16.0.x  Environment OS Ubuntu Server 20.04 with Plesk  Environment Web server Apache  Environment PHP 8.0.28  Environment Database MySQL or MariaDB 10.3.38-MariaDB-0ubuntu0.20.04.1  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Label not reported when creating a supplier invoice template  Bug [English] If I create a template from a draft supplier invoice: The label is copied The label is not included when you save the template (the first time). If I modify the template label after its creation, it is saved in the template. If I create a supplier invoice manually from a template, I arrive on the draft creation page: The label is not included. If I add the label on the draft creation page (still from the template) and I create the draft: Still no label. Once the draft is created and by adding the label again and saving the changes to the draft, the label is finally memorized. Translated with www.DeepL.com/Translator (free version)  [french] Si je cre un modle depuis un brouillon de facture fournisseur : Le libell est recopi Le libell nest par contre pas repris quand on enregistre le modle (la premire fois). Si je modifie le libell du modle aprs sa cration, il est mmoris dans le modle. Si je cre une facture fournisseur manuellement depuis un modle, jarrive sur la page de cration du brouillon : Le libell nest pas repris. Si je rajoute le libell sur la page de cration du brouillon (toujours en tant parti du modle) et que je cre le brouillon : Toujours pas de libell. Cest une fois sur le brouillon cr et en renseignant  nouveau le libell et en enregistrant les modifications du brouillon que le libell est enfin mmoris. Link of the topic on the forum: https://www.dolibarr.fr/forum/t/bugs-dans-les-modeles-de-facture/42113/2  Environment Version 16.0.x  Environment OS Ubuntu Server 20.04 with Plesk  Environment Web server Apache  Environment PHP 8.0.28  Environment Database MySQL or MariaDB 10.3.38-MariaDB-0ubuntu0.20.04.1  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
23022,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23022,Translation inconsistent," Bug Translations in the companies are inconsistent. I'm using de_DE as language. If navigating to /societe/card.php, you can (with module `notifications` enabled) see a tab 'Benachrichtigungen'. But while accessing `societe/consumption.php` or `societe/paymentmodes.php`, it uses the default fallback 'Notifications'. I followed the paths in the code to `core/class/translate.class.php` (line 612, function `trans($key)`. The associative array `tab_translate` in the `translate.class.php` is different for the three frontend pages (`card.php`, `consumption.php` and `paymentmodes.php`). For `card.php`, the key 'Notifications' is set. But the key isn't present in the both other cases. As I first would have to read into the docs and the translation mechanism, I assume it would be much quicker if you just check it yourself. P.S.: In the `langs/de_DE/companies.lang` file is no 'Notifications' key set either.  Environment Version 16.0.2  Environment OS AlmaLinux release 8.6  Environment Web server Apache/2.4.37  Environment PHP PHP 7.4.33  Environment Database 10.6.10-MariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![image](https://user-images.githubusercontent.com/18233867/204256836-76c95634-c923-41fb-9582-c34cb1516457.png) ![image](https://user-images.githubusercontent.com/18233867/204256972-875ab6c9-1d2b-41b6-8186-3345591c05c7.png) ![image](https://user-images.githubusercontent.com/18233867/204256909-9fdda1ef-dff6-4f8b-8601-727e7c7372ec.png)",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Translation inconsistent  Bug Translations in the companies are inconsistent. I'm using de_DE as language. If navigating to /societe/card.php, you can (with module `notifications` enabled) see a tab 'Benachrichtigungen'. But while accessing `societe/consumption.php` or `societe/paymentmodes.php`, it uses the default fallback 'Notifications'. I followed the paths in the code to `core/class/translate.class.php` (line 612, function `trans($key)`. The associative array `tab_translate` in the `translate.class.php` is different for the three frontend pages (`card.php`, `consumption.php` and `paymentmodes.php`). For `card.php`, the key 'Notifications' is set. But the key isn't present in the both other cases. As I first would have to read into the docs and the translation mechanism, I assume it would be much quicker if you just check it yourself. P.S.: In the `langs/de_DE/companies.lang` file is no 'Notifications' key set either.  Environment Version 16.0.2  Environment OS AlmaLinux release 8.6  Environment Web server Apache/2.4.37  Environment PHP PHP 7.4.33  Environment Database 10.6.10-MariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![image](https://user-images.githubusercontent.com/18233867/204256836-76c95634-c923-41fb-9582-c34cb1516457.png) ![image](https://user-images.githubusercontent.com/18233867/204256972-875ab6c9-1d2b-41b6-8186-3345591c05c7.png) ![image](https://user-images.githubusercontent.com/18233867/204256909-9fdda1ef-dff6-4f8b-8601-727e7c7372ec.png) other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
27534,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27534,Undefined variable $mode, Bug After creating an advanced stock transfer I get an error in the List of all stock Transfers: Warning: Undefined variable $mode in \htdocs\product\stock\stocktransfer\stocktransfer_list.php on line 426 Warning: Undefined variable $mode in \htdocs\product\stock\stocktransfer\stocktransfer_list.php on line 473 Warning: Undefined variable $mode in \htdocs\product\stock\stocktransfer\stocktransfer_list.php on line 610 and in the detailled view I get these errors: Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 769 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 769 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 773 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 773 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 774 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 774 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 775 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 775 Warning: Undefined property: stdClass::$PRODUCT_USE_UNITS in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 776 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 779 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 779 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 780 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 780 Warning: Undefined property: stdClass::$PRODUCT_USE_UNITS in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 971  Environment Version 19.0.0  Environment OS Windows  Environment Web server XAMPP  Environment PHP 8.2.12  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,Undefined variable $mode  Bug After creating an advanced stock transfer I get an error in the List of all stock Transfers: Warning: Undefined variable $mode in \htdocs\product\stock\stocktransfer\stocktransfer_list.php on line 426 Warning: Undefined variable $mode in \htdocs\product\stock\stocktransfer\stocktransfer_list.php on line 473 Warning: Undefined variable $mode in \htdocs\product\stock\stocktransfer\stocktransfer_list.php on line 610 and in the detailled view I get these errors: Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 769 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 769 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 773 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 773 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 774 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 774 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 775 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 775 Warning: Undefined property: stdClass::$PRODUCT_USE_UNITS in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 776 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 779 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 779 Warning: Undefined variable $sortfield in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 780 Warning: Undefined variable $sortorder in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 780 Warning: Undefined property: stdClass::$PRODUCT_USE_UNITS in \htdocs\product\stock\stocktransfer\stocktransfer_card.php on line 971  Environment Version 19.0.0  Environment OS Windows  Environment Web server XAMPP  Environment PHP 8.2.12  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
30846,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30846,Special characters in email personalization," Bug I have set up an email template where the subject line says ""Pipomenut splatn faktury"" If I send the email to the customer manually, e.g. in the invoice, the characters are correct. But if this task is performed by the crone set in dolibar, the customer will receive this. ![image](https://github.com/user-attachments/assets/f71c7e66-349f-4770-9125-4d1f9f30243c) Mail set SMTP  Dolibarr Version 18.0.2  Environment PHP 8.x.x  Environment Database MySQL  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file,"Special characters in email personalization  Bug I have set up an email template where the subject line says ""Pipomenut splatn faktury"" If I send the email to the customer manually, e.g. in the invoice, the characters are correct. But if this task is performed by the crone set in dolibar, the customer will receive this. ![image](https://github.com/user-attachments/assets/f71c7e66-349f-4770-9125-4d1f9f30243c) Mail set SMTP  Dolibarr Version 18.0.2  Environment PHP 8.x.x  Environment Database MySQL  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
23120,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23120,Bug: LDAP fail on dol_syslog (wrong Argument as message), Bug The problem are in the following lines. https://github.com/Dolibarr/dolibarr/blob/4b55e390fbe072b7d81bf99c898d25d04a3f63a6/htdocs/core/class/ldap.class.php#L1061 and https://github.com/Dolibarr/dolibarr/blob/4b55e390fbe072b7d81bf99c898d25d04a3f63a6/htdocs/core/class/ldap.class.php#L1066 the argument `.$this->connection.` not working. It's not convertible to a string for the Message.  Environment Version 16  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,Bug: LDAP fail on dol_syslog (wrong Argument as message)  Bug The problem are in the following lines. https://github.com/Dolibarr/dolibarr/blob/4b55e390fbe072b7d81bf99c898d25d04a3f63a6/htdocs/core/class/ldap.class.php#L1061 and https://github.com/Dolibarr/dolibarr/blob/4b55e390fbe072b7d81bf99c898d25d04a3f63a6/htdocs/core/class/ldap.class.php#L1066 the argument `.$this->connection.` not working. It's not convertible to a string for the Message.  Environment Version 16  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
26104,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26104,dolibarr 15 / multicompany bad link for showOnlineSignatureUrl if not $object, Bug showOnlineSignatureUrl call getOnlineSignatureUrl to make links but in dolibarr-15.0 there was a strange commit #ade854a : to be multicompany compatible links now use a global $object in getOnlineSignatureUrl function. the big problem is that we can use other name of variables than $object and there is no mention about that need when we use showOnlineSignatureUrl for example  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file | other-file | other-file | other-file | other-file,dolibarr 15 / multicompany bad link for showOnlineSignatureUrl if not $object  Bug showOnlineSignatureUrl call getOnlineSignatureUrl to make links but in dolibarr-15.0 there was a strange commit #ade854a : to be multicompany compatible links now use a global $object in getOnlineSignatureUrl function. the big problem is that we can use other name of variables than $object and there is no mention about that need when we use showOnlineSignatureUrl for example  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file,no-bug,0.7
29279,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29279,Not admin that can create group have disabled button for group creation," Bug As not admin, I have a greyed ""New group"" button : ![image](https://github.com/Dolibarr/dolibarr/assets/17381066/d5e32baa-6488-4fa7-a3e8-be096e2f3a5c) But, the top right button stay available to click: ![image](https://github.com/Dolibarr/dolibarr/assets/17381066/74c3af99-7344-46fb-a4ac-3bc6bc04a484) And going to this page doesn't return 403. It seems I should have the permission to do it: ![image](https://github.com/Dolibarr/dolibarr/assets/17381066/cdca44db-731f-43de-be9a-946bfcf17188) So why is this button greyed ?  Dolibarr Version 18.0.5  Environment PHP 8.1.27  Environment Database MariaDB 10.11.6  Steps to reproduce the behavior and expected behavior - Login with not admin account - Clic on ""Users and groups"" - See disabled button  Attached files _No response_",other-file,"Not admin that can create group have disabled button for group creation  Bug As not admin, I have a greyed ""New group"" button : ![image](https://github.com/Dolibarr/dolibarr/assets/17381066/d5e32baa-6488-4fa7-a3e8-be096e2f3a5c) But, the top right button stay available to click: ![image](https://github.com/Dolibarr/dolibarr/assets/17381066/74c3af99-7344-46fb-a4ac-3bc6bc04a484) And going to this page doesn't return 403. It seems I should have the permission to do it: ![image](https://github.com/Dolibarr/dolibarr/assets/17381066/cdca44db-731f-43de-be9a-946bfcf17188) So why is this button greyed ?  Dolibarr Version 18.0.5  Environment PHP 8.1.27  Environment Database MariaDB 10.11.6  Steps to reproduce the behavior and expected behavior - Login with not admin account - Clic on ""Users and groups"" - See disabled button  Attached files _No response_ other-file",no-bug,0.8
26308,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26308,Lessc::parenValue Assignment to true in condition of $this->inParens,"https://github.com/Dolibarr/dolibarr/blob/b23dc8478c5122a038524e64ca08dc01d32f211c/htdocs/core/class/lessc.class.php#L3112 This assignment of true to inParens in the condition is likely wrong, ideally a test case should catch it.",other-file,"Lessc::parenValue Assignment to true in condition of $this->inParens https://github.com/Dolibarr/dolibarr/blob/b23dc8478c5122a038524e64ca08dc01d32f211c/htdocs/core/class/lessc.class.php#L3112 This assignment of true to inParens in the condition is likely wrong, ideally a test case should catch it. other-file",no-bug,0.9
30766,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30766,Extra field Can Always Be Edited Setting Not Working as Expected,"<img width=""1233"" alt=""Screenshot 2024-08-26 at 5 11 27 PM"" src=""https://github.com/user-attachments/assets/28a5572b-b4f7-4fe5-9eda-6a04946af445""> <img width=""1232"" alt=""Screenshot 2024-08-26 at 5 11 03 PM"" src=""https://github.com/user-attachments/assets/a8e70147-ba44-4ded-ba20-6c6069015d20""> <img width=""1253"" alt=""Screenshot 2024-08-26 at 5 10 10 PM"" src=""https://github.com/user-attachments/assets/1fd31885-9542-456f-8262-3bb55e5ece37"">  Bug Im experiencing an issue with the Can always be edited setting for extra fields in Dolibarr. Despite this option being unchecked, I am still able to edit the values of these extra fields even when the status is not set to Draft. This behavior is inconsistent with the expected functionality, where the extra field should only be editable when the status is Draft and the Can always be edited option is unchecked.  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database Mysql  Steps to reproduce the behavior and expected behavior 1. Go to the module where extra fields are used (e.g., Knowledge management). 2. Create an extra field and make sure the Can always be edited option is unchecked. 3. Create a record in the knowledge management and validate it 4. Try editing the extra field value without setting the record back to draft 5. its editable!  Attached files _No response_",other-file | other-file | other-file | other-file,"Extra field Can Always Be Edited Setting Not Working as Expected <img width=""1233"" alt=""Screenshot 2024-08-26 at 5 11 27 PM"" src=""https://github.com/user-attachments/assets/28a5572b-b4f7-4fe5-9eda-6a04946af445""> <img width=""1232"" alt=""Screenshot 2024-08-26 at 5 11 03 PM"" src=""https://github.com/user-attachments/assets/a8e70147-ba44-4ded-ba20-6c6069015d20""> <img width=""1253"" alt=""Screenshot 2024-08-26 at 5 10 10 PM"" src=""https://github.com/user-attachments/assets/1fd31885-9542-456f-8262-3bb55e5ece37"">  Bug Im experiencing an issue with the Can always be edited setting for extra fields in Dolibarr. Despite this option being unchecked, I am still able to edit the values of these extra fields even when the status is not set to Draft. This behavior is inconsistent with the expected functionality, where the extra field should only be editable when the status is Draft and the Can always be edited option is unchecked.  Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database Mysql  Steps to reproduce the behavior and expected behavior 1. Go to the module where extra fields are used (e.g., Knowledge management). 2. Create an extra field and make sure the Can always be edited option is unchecked. 3. Create a record in the knowledge management and validate it 4. Try editing the extra field value without setting the record back to draft 5. its editable!  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
26008,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26008,Wrong translation key used for product reference," Bug Products have a specific translation key for naming their reference: 'ProductRef'. In some places, instead of this specific key the generic key Ref has been used. From a technical point of view, also a product reference is a generic reference, but users are used to a specific wording for product references. In English this is 'Item number' and in German it is 'Artikelnummer'. The correct translations are already available in Dolibarr, just the right translation key has not been used.  Environment Version 18.0",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Wrong translation key used for product reference  Bug Products have a specific translation key for naming their reference: 'ProductRef'. In some places, instead of this specific key the generic key Ref has been used. From a technical point of view, also a product reference is a generic reference, but users are used to a specific wording for product references. In English this is 'Item number' and in German it is 'Artikelnummer'. The correct translations are already available in Dolibarr, just the right translation key has not been used.  Environment Version 18.0 other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
29229,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29229,PHP warning on updating html type extrafield," Bug On the update() function of extrafields.class.php file, when we update extrafield as html type, the variable $lengthdb is not set. It generate a php warning. This error doesn't appear on extrafield edit page (like ""/societe/admin/societe_extrafields.php"" page or others) because when we update, we reload the page but it is still present even if we can't see it. This is not a problem on these pages but if we update an extrafield from module descriptor, the page isn't reloaded and we can see this warning : ![Capture decran 2024-04-04 a 09 56 51](https://github.com/Dolibarr/dolibarr/assets/9167207/37a56e82-3aca-449f-9830-faf06058f162) The page can't be loaded because of the warning. The probleme comes from extrafields.class.php, in update() function l.606 : ![Capture decran 2024-04-04 a 14 26 04](https://github.com/Dolibarr/dolibarr/assets/9167207/3a53a311-bb5b-48fb-97d7-91c994d3d52e)  Dolibarr Version 19.0.01  Environment PHP 8.2.10  Environment Database MySQL or MariaDB 8.0.31-0ubuntu0.20.04.2  Steps to reproduce the behavior and expected behavior Update an extrafield in module descriptor : $extrafields = new Extrafields($this->db); $res = $extrafields->update(""extrafieldtest"", ""Test"", ""html"", 2000, societe); Activate the module.  Attached files _No response_",other-file,"PHP warning on updating html type extrafield  Bug On the update() function of extrafields.class.php file, when we update extrafield as html type, the variable $lengthdb is not set. It generate a php warning. This error doesn't appear on extrafield edit page (like ""/societe/admin/societe_extrafields.php"" page or others) because when we update, we reload the page but it is still present even if we can't see it. This is not a problem on these pages but if we update an extrafield from module descriptor, the page isn't reloaded and we can see this warning : ![Capture decran 2024-04-04 a 09 56 51](https://github.com/Dolibarr/dolibarr/assets/9167207/37a56e82-3aca-449f-9830-faf06058f162) The page can't be loaded because of the warning. The probleme comes from extrafields.class.php, in update() function l.606 : ![Capture decran 2024-04-04 a 14 26 04](https://github.com/Dolibarr/dolibarr/assets/9167207/3a53a311-bb5b-48fb-97d7-91c994d3d52e)  Dolibarr Version 19.0.01  Environment PHP 8.2.10  Environment Database MySQL or MariaDB 8.0.31-0ubuntu0.20.04.2  Steps to reproduce the behavior and expected behavior Update an extrafield in module descriptor : $extrafields = new Extrafields($this->db); $res = $extrafields->update(""extrafieldtest"", ""Test"", ""html"", 2000, societe); Activate the module.  Attached files _No response_ other-file",no-bug,0.9
28431,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28431,Access a third party from the contact list," Bug In the contact list: /contact/list.php If we display the Third Party column. If you choose a prospect/client company: no mistake. If you choose a company, neither prospect nor customer: error. I noticed that each time, we are redirected to a link: /comm/card.php?socid=12345 There is no error when using the following link: /societe/card.php?socid=12345 So, if the company is not a customer, the link must be /societe/card.php  Environment Version 18/19  Environment OS _No response_  Environment Web server _No response_  Environment PHP 8.2  Environment Database _No response_  Environment URL(s) /contact/list.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![image](https://github.com/Dolibarr/dolibarr/assets/16688970/a0f7a8a8-d6bd-41ef-94a3-79781139cef4)",other-file | other-file,"Access a third party from the contact list  Bug In the contact list: /contact/list.php If we display the Third Party column. If you choose a prospect/client company: no mistake. If you choose a company, neither prospect nor customer: error. I noticed that each time, we are redirected to a link: /comm/card.php?socid=12345 There is no error when using the following link: /societe/card.php?socid=12345 So, if the company is not a customer, the link must be /societe/card.php  Environment Version 18/19  Environment OS _No response_  Environment Web server _No response_  Environment PHP 8.2  Environment Database _No response_  Environment URL(s) /contact/list.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![image](https://github.com/Dolibarr/dolibarr/assets/16688970/a0f7a8a8-d6bd-41ef-94a3-79781139cef4) other-file other-file",no-bug,0.8
27670,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27670,Warning: Undefined array key ticket/class/ticket.class.php L 1426 + 1427, Bug Hi - I just Upgraded to Dolibarr 19 running on Apache / Linux / PHP 8.1 An get the mentioned warning on the Dashboard.  Environment Version 19.0  Environment OS Debian GNU/Linux 11  Environment Web server Apache  Environment PHP PHP Version 8.1.27  Environment Database 0.5.21-MariaDB-0+deb11u1  Environment URL(s) _No response_  Expected and actual behavior No Warning on the Dashboard  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file,Warning: Undefined array key ticket/class/ticket.class.php L 1426 + 1427  Bug Hi - I just Upgraded to Dolibarr 19 running on Apache / Linux / PHP 8.1 An get the mentioned warning on the Dashboard.  Environment Version 19.0  Environment OS Debian GNU/Linux 11  Environment Web server Apache  Environment PHP PHP Version 8.1.27  Environment Database 0.5.21-MariaDB-0+deb11u1  Environment URL(s) _No response_  Expected and actual behavior No Warning on the Dashboard  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file,no-bug,0.9
25714,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25714,Totals in propal not rounded according to MAIN_MAX_DECIMALS_SHOWN," Bug In propal card, not like in order card, totals (ht, tva, ttc) are not rounded.  Environment Version all  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Totals in propal not rounded according to MAIN_MAX_DECIMALS_SHOWN  Bug In propal card, not like in order card, totals (ht, tva, ttc) are not rounded.  Environment Version all  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
27777,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27777,mass action to create member subscriptions, Feature Request in member list select members to make mass action create new subscription  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file | other-file | other-file,mass action to create member subscriptions  Feature Request in member list select members to make mass action create new subscription  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file,no-bug,0.9
33554,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33554,[postgres] migration issue v21.x -> v22.x-dev," Bug  Erreur DB_ERROR_42883 (Req 83): INSERT INTO llx_const (name, entity, value, type, visible, note) SELECT DISTINCT 'STOCK_DISALLOW_NEGATIVE_TRANSFER', entity, 1, 'chaine', 0, '' FROM llx_const c1 WHERE NOT EXISTS (SELECT rowid FROM llx_const c2 WHERE c2.name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2.entity = c1.entity);ERROR: 42883: operator does not exist: text = integer LINE 1: me = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2 ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 -- Erreur DB_ERROR_42883 (Req 84): UPDATE llx_const SET name = 'STOCK_DISALLOW_NEGATIVE_TRANSFER', value = 1 WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0;ERROR: 42883: operator does not exist: text = integer LINE 1:  WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0; ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 Erreur DB_ERROR_42883 (Req 85): DELETE FROM llx_const WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1;ERROR: 42883: operator does not exist: text = integer LINE 1:  WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1; ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635   Dolibarr Version develop - db7a2ce4d553ce9dfcaa96238a0609290562b07e  Environment PHP dev/build/docker-dev/  Environment Database dev/build/docker-dev/  Steps to reproduce the behavior and expected behavior - 1/ backport docker-dev patches to v20 (probably reproducible with v21 otherwise) - 2/ in docker-dev/ folder, docker-compose -f docker-compose.yml -f postgres.yml up - 3/ install dolibarr v20 - 4/ upgrade to v21 - 5/ upgrade to v22 -> error appears during upgrade It's possible that just forcing the v22 upgrades displays the same error on the develop page.  Attached files  Request 1 sql='ALTER TABLE llx_societe_rib MODIFY COLUMN label varchar(180);' -- Request 2 sql='ALTER TABLE llx_societe_rib MODIFY COLUMN iban_prefix varchar(100);' Request 3 sql='ALTER TABLE llx_societe_account DROP INDEX uk_societe_account_login_website_soc;' Request 4 sql='ALTER TABLE llx_societe_account ADD UNIQUE INDEX uk_societe_account_login_website(entity, login, site, fk_website);' Request 5 sql='ALTER TABLE llx_c_country ADD COLUMN sepa tinyint DEFAULT 0 NOT NULL;' Request 6 sql='UPDATE llx_c_country SET sepa = 1 WHERE code IN ('AD','AT','BE','BG','CH','CY','CZ','DE','DK','EE','ES','FI','FR','GR','HR','HU','IE','IT','LT','LU','LV','MC','MT','NL','PL','PT','RO','SE','SI','SK','SM','VA');' Request 7 sql='UPDATE llx_c_type_contact set element='shipping' WHERE element='expedition';' Request 8 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'internal', 'SALESREPFOLL', 'Representative following-up shipping', 1);' Request 9 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'external', 'BILLING', 'Customer invoice contact', 1);' Request 10 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'external', 'CUSTOMER', 'Customer shipping contact', 1);' Request 11 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'external', 'SHIPPING', 'Loading facility', 1);' Request 12 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'external', 'DELIVERY', 'Delivery facility', 1);' Request 13 sql='ALTER TABLE llx_holiday_config DROP INDEX idx_holiday_config;' Request 14 sql='ALTER TABLE llx_holiday_config ADD COLUMN entity integer DEFAULT 1 NOT NULL AFTER rowid;' Request 15 sql='ALTER TABLE llx_holiday_config ADD UNIQUE INDEX idx_holiday_config (entity, name);' Request 16 sql='ALTER TABLE llx_societe_account ADD COLUMN ip varchar(250);' Request 17 sql='ALTER TABLE llx_product ADD COLUMN packaging float(24,8) DEFAULT NULL;' Request 18 sql='ALTER TABLE llx_categorie_member ADD COLUMN import_key varchar(14);' Request 19 sql='ALTER TABLE llx_category_bankline ADD COLUMN import_key varchar(14);' Request 20 sql='create table llx_categorie_order ( fk_categorie integer NOT NULL, fk_order integer NOT NULL, import_key varchar(14) )ENGINE=innodb;' Request 21 sql='ALTER TABLE llx_categorie_order ADD PRIMARY KEY pk_categorie_order(fk_categorie, fk_order);' Request 22 sql='ALTER TABLE llx_categorie_order ADD INDEX idx_categorie_order_fk_categorie (fk_categorie);' Request 23 sql='ALTER TABLE llx_categorie_order ADD INDEX idx_categorie_order_fk_order (fk_order);' Request 24 sql='ALTER TABLE llx_categorie_order ADD CONSTRAINT fk_categorie_order_categorie_rowid FOREIGN KEY (fk_categorie) REFERENCES llx_categorie (rowid);' Request 25 sql='ALTER TABLE llx_categorie_order ADD CONSTRAINT fk_categorie_order_fk_order_rowid FOREIGN KEY (fk_order) REFERENCES llx_commande (rowid);' Request 26 sql='create table llx_categorie_invoice ( fk_categorie integer NOT NULL, fk_invoice integer NOT NULL, import_key varchar(14) )ENGINE=innodb;' Request 27 sql='ALTER TABLE llx_categorie_invoice ADD PRIMARY KEY pk_categorie_invoice(fk_categorie, fk_invoice);' Request 28 sql='ALTER TABLE llx_categorie_invoice ADD INDEX idx_categorie_invoice_fk_categorie (fk_categorie);' Request 29 sql='ALTER TABLE llx_categorie_invoice ADD INDEX idx_categorie_invoice_fk_invoice (fk_invoice);' Request 30 sql='ALTER TABLE llx_categorie_invoice ADD CONSTRAINT fk_categorie_invoice_categorie_rowid FOREIGN KEY (fk_categorie) REFERENCES llx_categorie (rowid);' Request 31 sql='ALTER TABLE llx_categorie_invoice ADD CONSTRAINT fk_categorie_invoice_fk_invoice_rowid FOREIGN KEY (fk_invoice) REFERENCES llx_facture (rowid);' Request 32 sql='create table llx_categorie_supplier_order ( fk_categorie integer NOT NULL, fk_supplier_order integer NOT NULL, import_key varchar(14) )ENGINE=innodb;' Request 33 sql='ALTER TABLE llx_categorie_supplier_order ADD PRIMARY KEY pk_categorie_supplier_order(fk_categorie, fk_supplier_order);' Request 34 sql='ALTER TABLE llx_categorie_supplier_order ADD INDEX idx_categorie_supplier_order_fk_categorie (fk_categorie);' Request 35 sql='ALTER TABLE llx_categorie_supplier_order ADD INDEX idx_categorie_supplier_order_fk_supplier_order (fk_supplier_order);' Request 36 sql='ALTER TABLE llx_categorie_supplier_order ADD CONSTRAINT fk_categorie_supplier_order_categorie_rowid FOREIGN KEY (fk_categorie) REFERENCES llx_categorie (rowid);' Request 37 sql='ALTER TABLE llx_categorie_supplier_order ADD CONSTRAINT fk_categorie_supplier_order_fk_supplier_order_rowid FOREIGN KEY (fk_supplier_order) REFERENCES llx_commande_fournisseur (rowid);' Request 38 sql='create table llx_categorie_supplier_invoice ( fk_categorie integer NOT NULL, fk_supplier_invoice integer NOT NULL, import_key varchar(14) )ENGINE=innodb;' Request 39 sql='ALTER TABLE llx_categorie_supplier_invoice ADD PRIMARY KEY pk_categorie_supplier_invoice(fk_categorie, fk_supplier_invoice);' Request 40 sql='ALTER TABLE llx_categorie_supplier_invoice ADD INDEX idx_categorie_supplier_invoice_fk_categorie (fk_categorie);' Request 41 sql='ALTER TABLE llx_categorie_supplier_invoice ADD INDEX idx_categorie_supplier_invoice_fk_supplier_invoice (fk_supplier_invoice);' Request 42 sql='ALTER TABLE llx_categorie_supplier_invoice ADD CONSTRAINT fk_categorie_supplier_invoice_categorie_rowid FOREIGN KEY (fk_categorie) REFERENCES llx_categorie (rowid);' Request 43 sql='ALTER TABLE llx_categorie_supplier_invoice ADD CONSTRAINT fk_categorie_supplier_invoice_fk_supplier_invoice_rowid FOREIGN KEY (fk_supplier_invoice) REFERENCES llx_facture_fourn (rowid);' Request 44 sql='CREATE TABLE llx_bank_record ( rowid integer AUTO_INCREMENT PRIMARY KEY, ref varchar(50) NOT NULL, fk_bank integer NOT NULL, dt_from date NOT NULL, dt_to date NOT NULL, date_creation datetime NOT NULL, date_valid datetime NULL, tms timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP )ENGINE=innodb;' Request 45 sql='ALTER TABLE llx_bank_record ADD CONSTRAINT bank_record_fk_bank FOREIGN KEY (fk_bank) REFERENCES llx_bank_account (rowid);' Request 46 sql='CREATE TABLE llx_bank_record_link ( rowid integer AUTO_INCREMENT PRIMARY KEY, fk_bank_record integer NOT NULL, fk_bank_import integer NOT NULL )ENGINE=innodb;' Request 47 sql='ALTER TABLE llx_bank_record_link ADD CONSTRAINT fk_bank_record_bank_record FOREIGN KEY (fk_bank_record) REFERENCES llx_bank_record (rowid);' Request 48 sql='ALTER TABLE llx_bank_record_link ADD CONSTRAINT fk_bank_import_bank_import FOREIGN KEY (fk_bank_import) REFERENCES llx_bank_import (rowid);' Request 49 sql='ALTER TABLE llx_commandedet ADD COLUMN extraparams varchar(255);' Request 50 sql='ALTER TABLE llx_commande_fournisseurdet ADD COLUMN extraparams varchar(255);' Request 51 sql='ALTER TABLE llx_contratdet ADD COLUMN extraparams varchar(255);' Request 52 sql='ALTER TABLE llx_deliverydet ADD COLUMN extraparams varchar(255);' Request 53 sql='ALTER TABLE llx_expeditiondet ADD COLUMN extraparams varchar(255);' Request 54 sql='ALTER TABLE llx_facturedet ADD COLUMN extraparams varchar(255);' Request 55 sql='ALTER TABLE llx_facturedet_rec ADD COLUMN extraparams varchar(255);' Request 56 sql='ALTER TABLE llx_facture_fourn_det ADD COLUMN extraparams varchar(255);' Request 57 sql='ALTER TABLE llx_facture_fourn_det_rec ADD COLUMN extraparams varchar(255);' Request 58 sql='ALTER TABLE llx_fichinterdet ADD COLUMN extraparams varchar(255);' Request 59 sql='ALTER TABLE llx_fichinterdet_rec ADD COLUMN extraparams varchar(255);' Request 60 sql='ALTER TABLE llx_propaldet ADD COLUMN extraparams varchar(255);' Request 61 sql='ALTER TABLE llx_receptiondet_batch ADD COLUMN extraparams varchar(255);' Request 62 sql='ALTER TABLE llx_supplier_proposaldet ADD COLUMN extraparams varchar(255);' Request 63 sql='ALTER TABLE llx_facture_rec ADD COLUMN rule_for_lines_dates varchar(255) DEFAULT 'prepaid';' Request 64 sql='ALTER TABLE llx_product_customer_price ADD COLUMN date_begin date AFTER ref_customer;' Request 65 sql='ALTER TABLE llx_product_customer_price ADD COLUMN date_end date AFTER date_begin;' Request 66 sql='ALTER TABLE llx_product_customer_price ADD COLUMN discount_percent real DEFAULT 0 AFTER localtax2_type;' Request 67 sql='ALTER TABLE llx_product_customer_price_log ADD COLUMN date_begin date AFTER ref_customer;' Request 68 sql='ALTER TABLE llx_product_customer_price_log ADD COLUMN date_end date AFTER date_begin;' Request 69 sql='ALTER TABLE llx_product_customer_price_log ADD COLUMN discount_percent real DEFAULT 0 AFTER localtax2_type;' Request 70 sql='ALTER TABLE llx_product_customer_price DROP FOREIGN KEY fk_product_customer_price_fk_product;' Request 71 sql='ALTER TABLE llx_product_customer_price DROP FOREIGN KEY fk_product_customer_price_fk_soc;' Request 72 sql='ALTER TABLE llx_product_customer_price DROP FOREIGN KEY fk_customer_price_fk_product;' Request 73 sql='ALTER TABLE llx_product_customer_price DROP FOREIGN KEY fk_customer_price_fk_soc;' Request 74 sql='ALTER TABLE llx_product_customer_price DROP INDEX uk_customer_price_fk_product_fk_soc;' Request 75 sql='ALTER TABLE llx_product_customer_price ADD UNIQUE INDEX uk_customer_price_fk_product_fk_soc (fk_product, fk_soc, date_begin);' Request 76 sql='ALTER TABLE llx_product_customer_price ADD CONSTRAINT fk_product_customer_price_fk_product FOREIGN KEY (fk_product) REFERENCES llx_product(rowid);' Request 77 sql='ALTER TABLE llx_product_customer_price ADD CONSTRAINT fk_product_customer_price_fk_soc FOREIGN KEY (fk_soc) REFERENCES llx_societe(rowid);' Request 78 sql='UPDATE llx_product_customer_price SET date_begin = datec WHERE date_begin IS NULL;' Request 79 sql='UPDATE llx_product_customer_price_log SET date_begin = datec WHERE date_begin IS NULL;' Request 80 sql='ALTER TABLE llx_session ADD COLUMN date_creation datetime NOT NULL AFTER session_variable;' Request 81 sql='ALTER TABLE llx_accounting_account ADD COLUMN centralized tinyint DEFAULT 0 NOT NULL AFTER active;' Request 82 sql='UPDATE llx_accounting_account as acc SET acc.centralized = 1 WHERE acc.account_number in (SELECT value FROM llx_const WHERE name IN (__ENCRYPT('ACCOUNTING_ACCOUNT_CUSTOMER')__,__ENCRYPT('ACCOUNTING_ACCOUNT_SUPPLIER')__,__ENCRYPT('SALARIES_ACCOUNTING_ACCOUNT_PAYMENT')__));' Request 83 sql='INSERT INTO llx_const (name, entity, value, type, visible, note) SELECT DISTINCT 'STOCK_DISALLOW_NEGATIVE_TRANSFER', entity, 1, 'chaine', 0, '' FROM llx_const c1 WHERE NOT EXISTS (SELECT rowid FROM llx_const c2 WHERE c2.name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2.entity = c1.entity);' Erreur DB_ERROR_42883 (Req 83): INSERT INTO llx_const (name, entity, value, type, visible, note) SELECT DISTINCT 'STOCK_DISALLOW_NEGATIVE_TRANSFER', entity, 1, 'chaine', 0, '' FROM llx_const c1 WHERE NOT EXISTS (SELECT rowid FROM llx_const c2 WHERE c2.name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2.entity = c1.entity);ERROR: 42883: operator does not exist: text = integer LINE 1: me = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2 ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 Request 84 sql='UPDATE llx_const SET name = 'STOCK_DISALLOW_NEGATIVE_TRANSFER', value = 1 WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0;' Erreur DB_ERROR_42883 (Req 84): UPDATE llx_const SET name = 'STOCK_DISALLOW_NEGATIVE_TRANSFER', value = 1 WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0;ERROR: 42883: operator does not exist: text = integer LINE 1:  WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0; ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 Request 85 sql='DELETE FROM llx_const WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1;' Erreur DB_ERROR_42883 (Req 85): DELETE FROM llx_const WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1;ERROR: 42883: operator does not exist: text = integer LINE 1:  WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1; ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 Request 86 sql='ALTER TABLE llx_links ADD COLUMN share varchar(128) NULL AFTER objectid;' Request 87 sql='ALTER TABLE llx_links ADD COLUMN share_pass varchar(32) NULL AFTER share;' Request 88 sql='ALTER TABLE llx_expeditiondet ADD COLUMN fk_parent integer NULL AFTER fk_product;' Request 89 sql='ALTER TABLE llx_expeditiondet ADD INDEX idx_expeditiondet_fk_parent (fk_parent);' Request 90 sql='UPDATE llx_expeditiondet as ed SET ed.fk_product = (SELECT cd.fk_product FROM llx_commandedet as cd WHERE cd.rowid = ed.fk_elementdet AND ed.element_type = 'commande') WHERE ed.fk_product IS NULL;' Request 91 sql='ALTER TABLE llx_webhook_target ADD COLUMN type integer DEFAULT 0 NOT NULL AFTER label;' Request 92 sql='INSERT INTO llx_c_socialnetworks (entity, code, label, url, icon, active) VALUES (1, 'pixelfed', 'Pixelfed', '{socialid}', 'fa-pixelfed', 0);' ",database-file | database-file,"[postgres] migration issue v21.x -> v22.x-dev  Bug  Erreur DB_ERROR_42883 (Req 83): INSERT INTO llx_const (name, entity, value, type, visible, note) SELECT DISTINCT 'STOCK_DISALLOW_NEGATIVE_TRANSFER', entity, 1, 'chaine', 0, '' FROM llx_const c1 WHERE NOT EXISTS (SELECT rowid FROM llx_const c2 WHERE c2.name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2.entity = c1.entity);ERROR: 42883: operator does not exist: text = integer LINE 1: me = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2 ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 -- Erreur DB_ERROR_42883 (Req 84): UPDATE llx_const SET name = 'STOCK_DISALLOW_NEGATIVE_TRANSFER', value = 1 WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0;ERROR: 42883: operator does not exist: text = integer LINE 1:  WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0; ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 Erreur DB_ERROR_42883 (Req 85): DELETE FROM llx_const WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1;ERROR: 42883: operator does not exist: text = integer LINE 1:  WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1; ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635   Dolibarr Version develop - db7a2ce4d553ce9dfcaa96238a0609290562b07e  Environment PHP dev/build/docker-dev/  Environment Database dev/build/docker-dev/  Steps to reproduce the behavior and expected behavior - 1/ backport docker-dev patches to v20 (probably reproducible with v21 otherwise) - 2/ in docker-dev/ folder, docker-compose -f docker-compose.yml -f postgres.yml up - 3/ install dolibarr v20 - 4/ upgrade to v21 - 5/ upgrade to v22 -> error appears during upgrade It's possible that just forcing the v22 upgrades displays the same error on the develop page.  Attached files  Request 1 sql='ALTER TABLE llx_societe_rib MODIFY COLUMN label varchar(180);' -- Request 2 sql='ALTER TABLE llx_societe_rib MODIFY COLUMN iban_prefix varchar(100);' Request 3 sql='ALTER TABLE llx_societe_account DROP INDEX uk_societe_account_login_website_soc;' Request 4 sql='ALTER TABLE llx_societe_account ADD UNIQUE INDEX uk_societe_account_login_website(entity, login, site, fk_website);' Request 5 sql='ALTER TABLE llx_c_country ADD COLUMN sepa tinyint DEFAULT 0 NOT NULL;' Request 6 sql='UPDATE llx_c_country SET sepa = 1 WHERE code IN ('AD','AT','BE','BG','CH','CY','CZ','DE','DK','EE','ES','FI','FR','GR','HR','HU','IE','IT','LT','LU','LV','MC','MT','NL','PL','PT','RO','SE','SI','SK','SM','VA');' Request 7 sql='UPDATE llx_c_type_contact set element='shipping' WHERE element='expedition';' Request 8 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'internal', 'SALESREPFOLL', 'Representative following-up shipping', 1);' Request 9 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'external', 'BILLING', 'Customer invoice contact', 1);' Request 10 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'external', 'CUSTOMER', 'Customer shipping contact', 1);' Request 11 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'external', 'SHIPPING', 'Loading facility', 1);' Request 12 sql='INSERT INTO llx_c_type_contact (element, source, code, libelle, active ) VALUES ('shipping', 'external', 'DELIVERY', 'Delivery facility', 1);' Request 13 sql='ALTER TABLE llx_holiday_config DROP INDEX idx_holiday_config;' Request 14 sql='ALTER TABLE llx_holiday_config ADD COLUMN entity integer DEFAULT 1 NOT NULL AFTER rowid;' Request 15 sql='ALTER TABLE llx_holiday_config ADD UNIQUE INDEX idx_holiday_config (entity, name);' Request 16 sql='ALTER TABLE llx_societe_account ADD COLUMN ip varchar(250);' Request 17 sql='ALTER TABLE llx_product ADD COLUMN packaging float(24,8) DEFAULT NULL;' Request 18 sql='ALTER TABLE llx_categorie_member ADD COLUMN import_key varchar(14);' Request 19 sql='ALTER TABLE llx_category_bankline ADD COLUMN import_key varchar(14);' Request 20 sql='create table llx_categorie_order ( fk_categorie integer NOT NULL, fk_order integer NOT NULL, import_key varchar(14) )ENGINE=innodb;' Request 21 sql='ALTER TABLE llx_categorie_order ADD PRIMARY KEY pk_categorie_order(fk_categorie, fk_order);' Request 22 sql='ALTER TABLE llx_categorie_order ADD INDEX idx_categorie_order_fk_categorie (fk_categorie);' Request 23 sql='ALTER TABLE llx_categorie_order ADD INDEX idx_categorie_order_fk_order (fk_order);' Request 24 sql='ALTER TABLE llx_categorie_order ADD CONSTRAINT fk_categorie_order_categorie_rowid FOREIGN KEY (fk_categorie) REFERENCES llx_categorie (rowid);' Request 25 sql='ALTER TABLE llx_categorie_order ADD CONSTRAINT fk_categorie_order_fk_order_rowid FOREIGN KEY (fk_order) REFERENCES llx_commande (rowid);' Request 26 sql='create table llx_categorie_invoice ( fk_categorie integer NOT NULL, fk_invoice integer NOT NULL, import_key varchar(14) )ENGINE=innodb;' Request 27 sql='ALTER TABLE llx_categorie_invoice ADD PRIMARY KEY pk_categorie_invoice(fk_categorie, fk_invoice);' Request 28 sql='ALTER TABLE llx_categorie_invoice ADD INDEX idx_categorie_invoice_fk_categorie (fk_categorie);' Request 29 sql='ALTER TABLE llx_categorie_invoice ADD INDEX idx_categorie_invoice_fk_invoice (fk_invoice);' Request 30 sql='ALTER TABLE llx_categorie_invoice ADD CONSTRAINT fk_categorie_invoice_categorie_rowid FOREIGN KEY (fk_categorie) REFERENCES llx_categorie (rowid);' Request 31 sql='ALTER TABLE llx_categorie_invoice ADD CONSTRAINT fk_categorie_invoice_fk_invoice_rowid FOREIGN KEY (fk_invoice) REFERENCES llx_facture (rowid);' Request 32 sql='create table llx_categorie_supplier_order ( fk_categorie integer NOT NULL, fk_supplier_order integer NOT NULL, import_key varchar(14) )ENGINE=innodb;' Request 33 sql='ALTER TABLE llx_categorie_supplier_order ADD PRIMARY KEY pk_categorie_supplier_order(fk_categorie, fk_supplier_order);' Request 34 sql='ALTER TABLE llx_categorie_supplier_order ADD INDEX idx_categorie_supplier_order_fk_categorie (fk_categorie);' Request 35 sql='ALTER TABLE llx_categorie_supplier_order ADD INDEX idx_categorie_supplier_order_fk_supplier_order (fk_supplier_order);' Request 36 sql='ALTER TABLE llx_categorie_supplier_order ADD CONSTRAINT fk_categorie_supplier_order_categorie_rowid FOREIGN KEY (fk_categorie) REFERENCES llx_categorie (rowid);' Request 37 sql='ALTER TABLE llx_categorie_supplier_order ADD CONSTRAINT fk_categorie_supplier_order_fk_supplier_order_rowid FOREIGN KEY (fk_supplier_order) REFERENCES llx_commande_fournisseur (rowid);' Request 38 sql='create table llx_categorie_supplier_invoice ( fk_categorie integer NOT NULL, fk_supplier_invoice integer NOT NULL, import_key varchar(14) )ENGINE=innodb;' Request 39 sql='ALTER TABLE llx_categorie_supplier_invoice ADD PRIMARY KEY pk_categorie_supplier_invoice(fk_categorie, fk_supplier_invoice);' Request 40 sql='ALTER TABLE llx_categorie_supplier_invoice ADD INDEX idx_categorie_supplier_invoice_fk_categorie (fk_categorie);' Request 41 sql='ALTER TABLE llx_categorie_supplier_invoice ADD INDEX idx_categorie_supplier_invoice_fk_supplier_invoice (fk_supplier_invoice);' Request 42 sql='ALTER TABLE llx_categorie_supplier_invoice ADD CONSTRAINT fk_categorie_supplier_invoice_categorie_rowid FOREIGN KEY (fk_categorie) REFERENCES llx_categorie (rowid);' Request 43 sql='ALTER TABLE llx_categorie_supplier_invoice ADD CONSTRAINT fk_categorie_supplier_invoice_fk_supplier_invoice_rowid FOREIGN KEY (fk_supplier_invoice) REFERENCES llx_facture_fourn (rowid);' Request 44 sql='CREATE TABLE llx_bank_record ( rowid integer AUTO_INCREMENT PRIMARY KEY, ref varchar(50) NOT NULL, fk_bank integer NOT NULL, dt_from date NOT NULL, dt_to date NOT NULL, date_creation datetime NOT NULL, date_valid datetime NULL, tms timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP )ENGINE=innodb;' Request 45 sql='ALTER TABLE llx_bank_record ADD CONSTRAINT bank_record_fk_bank FOREIGN KEY (fk_bank) REFERENCES llx_bank_account (rowid);' Request 46 sql='CREATE TABLE llx_bank_record_link ( rowid integer AUTO_INCREMENT PRIMARY KEY, fk_bank_record integer NOT NULL, fk_bank_import integer NOT NULL )ENGINE=innodb;' Request 47 sql='ALTER TABLE llx_bank_record_link ADD CONSTRAINT fk_bank_record_bank_record FOREIGN KEY (fk_bank_record) REFERENCES llx_bank_record (rowid);' Request 48 sql='ALTER TABLE llx_bank_record_link ADD CONSTRAINT fk_bank_import_bank_import FOREIGN KEY (fk_bank_import) REFERENCES llx_bank_import (rowid);' Request 49 sql='ALTER TABLE llx_commandedet ADD COLUMN extraparams varchar(255);' Request 50 sql='ALTER TABLE llx_commande_fournisseurdet ADD COLUMN extraparams varchar(255);' Request 51 sql='ALTER TABLE llx_contratdet ADD COLUMN extraparams varchar(255);' Request 52 sql='ALTER TABLE llx_deliverydet ADD COLUMN extraparams varchar(255);' Request 53 sql='ALTER TABLE llx_expeditiondet ADD COLUMN extraparams varchar(255);' Request 54 sql='ALTER TABLE llx_facturedet ADD COLUMN extraparams varchar(255);' Request 55 sql='ALTER TABLE llx_facturedet_rec ADD COLUMN extraparams varchar(255);' Request 56 sql='ALTER TABLE llx_facture_fourn_det ADD COLUMN extraparams varchar(255);' Request 57 sql='ALTER TABLE llx_facture_fourn_det_rec ADD COLUMN extraparams varchar(255);' Request 58 sql='ALTER TABLE llx_fichinterdet ADD COLUMN extraparams varchar(255);' Request 59 sql='ALTER TABLE llx_fichinterdet_rec ADD COLUMN extraparams varchar(255);' Request 60 sql='ALTER TABLE llx_propaldet ADD COLUMN extraparams varchar(255);' Request 61 sql='ALTER TABLE llx_receptiondet_batch ADD COLUMN extraparams varchar(255);' Request 62 sql='ALTER TABLE llx_supplier_proposaldet ADD COLUMN extraparams varchar(255);' Request 63 sql='ALTER TABLE llx_facture_rec ADD COLUMN rule_for_lines_dates varchar(255) DEFAULT 'prepaid';' Request 64 sql='ALTER TABLE llx_product_customer_price ADD COLUMN date_begin date AFTER ref_customer;' Request 65 sql='ALTER TABLE llx_product_customer_price ADD COLUMN date_end date AFTER date_begin;' Request 66 sql='ALTER TABLE llx_product_customer_price ADD COLUMN discount_percent real DEFAULT 0 AFTER localtax2_type;' Request 67 sql='ALTER TABLE llx_product_customer_price_log ADD COLUMN date_begin date AFTER ref_customer;' Request 68 sql='ALTER TABLE llx_product_customer_price_log ADD COLUMN date_end date AFTER date_begin;' Request 69 sql='ALTER TABLE llx_product_customer_price_log ADD COLUMN discount_percent real DEFAULT 0 AFTER localtax2_type;' Request 70 sql='ALTER TABLE llx_product_customer_price DROP FOREIGN KEY fk_product_customer_price_fk_product;' Request 71 sql='ALTER TABLE llx_product_customer_price DROP FOREIGN KEY fk_product_customer_price_fk_soc;' Request 72 sql='ALTER TABLE llx_product_customer_price DROP FOREIGN KEY fk_customer_price_fk_product;' Request 73 sql='ALTER TABLE llx_product_customer_price DROP FOREIGN KEY fk_customer_price_fk_soc;' Request 74 sql='ALTER TABLE llx_product_customer_price DROP INDEX uk_customer_price_fk_product_fk_soc;' Request 75 sql='ALTER TABLE llx_product_customer_price ADD UNIQUE INDEX uk_customer_price_fk_product_fk_soc (fk_product, fk_soc, date_begin);' Request 76 sql='ALTER TABLE llx_product_customer_price ADD CONSTRAINT fk_product_customer_price_fk_product FOREIGN KEY (fk_product) REFERENCES llx_product(rowid);' Request 77 sql='ALTER TABLE llx_product_customer_price ADD CONSTRAINT fk_product_customer_price_fk_soc FOREIGN KEY (fk_soc) REFERENCES llx_societe(rowid);' Request 78 sql='UPDATE llx_product_customer_price SET date_begin = datec WHERE date_begin IS NULL;' Request 79 sql='UPDATE llx_product_customer_price_log SET date_begin = datec WHERE date_begin IS NULL;' Request 80 sql='ALTER TABLE llx_session ADD COLUMN date_creation datetime NOT NULL AFTER session_variable;' Request 81 sql='ALTER TABLE llx_accounting_account ADD COLUMN centralized tinyint DEFAULT 0 NOT NULL AFTER active;' Request 82 sql='UPDATE llx_accounting_account as acc SET acc.centralized = 1 WHERE acc.account_number in (SELECT value FROM llx_const WHERE name IN (__ENCRYPT('ACCOUNTING_ACCOUNT_CUSTOMER')__,__ENCRYPT('ACCOUNTING_ACCOUNT_SUPPLIER')__,__ENCRYPT('SALARIES_ACCOUNTING_ACCOUNT_PAYMENT')__));' Request 83 sql='INSERT INTO llx_const (name, entity, value, type, visible, note) SELECT DISTINCT 'STOCK_DISALLOW_NEGATIVE_TRANSFER', entity, 1, 'chaine', 0, '' FROM llx_const c1 WHERE NOT EXISTS (SELECT rowid FROM llx_const c2 WHERE c2.name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2.entity = c1.entity);' Erreur DB_ERROR_42883 (Req 83): INSERT INTO llx_const (name, entity, value, type, visible, note) SELECT DISTINCT 'STOCK_DISALLOW_NEGATIVE_TRANSFER', entity, 1, 'chaine', 0, '' FROM llx_const c1 WHERE NOT EXISTS (SELECT rowid FROM llx_const c2 WHERE c2.name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2.entity = c1.entity);ERROR: 42883: operator does not exist: text = integer LINE 1: me = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND c2.value = 1 AND c2 ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 Request 84 sql='UPDATE llx_const SET name = 'STOCK_DISALLOW_NEGATIVE_TRANSFER', value = 1 WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0;' Erreur DB_ERROR_42883 (Req 84): UPDATE llx_const SET name = 'STOCK_DISALLOW_NEGATIVE_TRANSFER', value = 1 WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0;ERROR: 42883: operator does not exist: text = integer LINE 1:  WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 0; ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 Request 85 sql='DELETE FROM llx_const WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1;' Erreur DB_ERROR_42883 (Req 85): DELETE FROM llx_const WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1;ERROR: 42883: operator does not exist: text = integer LINE 1:  WHERE name = 'STOCK_ALLOW_NEGATIVE_TRANSFER' AND value = 1; ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:635 Request 86 sql='ALTER TABLE llx_links ADD COLUMN share varchar(128) NULL AFTER objectid;' Request 87 sql='ALTER TABLE llx_links ADD COLUMN share_pass varchar(32) NULL AFTER share;' Request 88 sql='ALTER TABLE llx_expeditiondet ADD COLUMN fk_parent integer NULL AFTER fk_product;' Request 89 sql='ALTER TABLE llx_expeditiondet ADD INDEX idx_expeditiondet_fk_parent (fk_parent);' Request 90 sql='UPDATE llx_expeditiondet as ed SET ed.fk_product = (SELECT cd.fk_product FROM llx_commandedet as cd WHERE cd.rowid = ed.fk_elementdet AND ed.element_type = 'commande') WHERE ed.fk_product IS NULL;' Request 91 sql='ALTER TABLE llx_webhook_target ADD COLUMN type integer DEFAULT 0 NOT NULL AFTER label;' Request 92 sql='INSERT INTO llx_c_socialnetworks (entity, code, label, url, icon, active) VALUES (1, 'pixelfed', 'Pixelfed', '{socialid}', 'fa-pixelfed', 0);'  database-file database-file",no-bug,0.9
29297,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29297,TICKET ERROR WHEN TRY TO DELET, Bug ![image](https://github.com/Dolibarr/dolibarr/assets/164975907/50e901a3-8bf8-42b4-ac36-bca2a2259897) [dolibarr.log](https://github.com/Dolibarr/dolibarr/files/14921011/dolibarr.log) Error when try to delete ticket  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file | other-file | other-file | other-file,TICKET ERROR WHEN TRY TO DELET  Bug ![image](https://github.com/Dolibarr/dolibarr/assets/164975907/50e901a3-8bf8-42b4-ac36-bca2a2259897) [dolibarr.log](https://github.com/Dolibarr/dolibarr/files/14921011/dolibarr.log) Error when try to delete ticket  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file,no-bug,0.7
32096,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32096,linkedObjectsIds is null when doing a search," Bug The API return null for the `linkedObjectsIds` field when doing a search, but when querying the order directly, it returns the references correctly.  Dolibarr Version 20.0.2  Environment PHP 8.2.24  Environment Database MySQL or MariaDB 10.9.8-MariaDB-1:10.9.8+maria~deb11  Steps to reproduce the behavior and expected behavior Result of: `GET http://dolibarr_ip/dolibarr/api/index.php/orders?sqlfilters=ref:like:SO2411-0003` json [ { ""module"": null, ""id"": ""5"", ""entity"": ""1"", ""import_key"": null, ""array_options"": [], ""array_languages"": null, ""contacts_ids"": [], ""linkedObjectsIds"": null, ""canvas"": null, ""fk_project"": null, ""contact_id"": null, ""user"": null, ""origin_type"": null, ""origin_id"": null, ""ref"": ""SO2411-0003"" } ]  Result of: `GET http://dolibarr_ip/dolibarr/api/index.php/orders/5` json { ""module"": null, ""id"": ""5"", ""entity"": ""1"", ""import_key"": null, ""array_options"": [], ""array_languages"": null, ""contacts_ids"": [], ""linkedObjectsIds"": { ""shipping"": { ""3"": ""3"" } }, ""canvas"": null, ""fk_project"": null, ""contact_id"": null, ""user"": null, ""origin_type"": null, ""origin_id"": null, ""ref"": ""SO2411-0003"" } ]   Attached files _No response_",other-file | other-file,"linkedObjectsIds is null when doing a search  Bug The API return null for the `linkedObjectsIds` field when doing a search, but when querying the order directly, it returns the references correctly.  Dolibarr Version 20.0.2  Environment PHP 8.2.24  Environment Database MySQL or MariaDB 10.9.8-MariaDB-1:10.9.8+maria~deb11  Steps to reproduce the behavior and expected behavior Result of: `GET http://dolibarr_ip/dolibarr/api/index.php/orders?sqlfilters=ref:like:SO2411-0003` json [ { ""module"": null, ""id"": ""5"", ""entity"": ""1"", ""import_key"": null, ""array_options"": [], ""array_languages"": null, ""contacts_ids"": [], ""linkedObjectsIds"": null, ""canvas"": null, ""fk_project"": null, ""contact_id"": null, ""user"": null, ""origin_type"": null, ""origin_id"": null, ""ref"": ""SO2411-0003"" } ]  Result of: `GET http://dolibarr_ip/dolibarr/api/index.php/orders/5` json { ""module"": null, ""id"": ""5"", ""entity"": ""1"", ""import_key"": null, ""array_options"": [], ""array_languages"": null, ""contacts_ids"": [], ""linkedObjectsIds"": { ""shipping"": { ""3"": ""3"" } }, ""canvas"": null, ""fk_project"": null, ""contact_id"": null, ""user"": null, ""origin_type"": null, ""origin_id"": null, ""ref"": ""SO2411-0003"" } ]   Attached files _No response_ other-file other-file",bug,0.95
30513,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30513,Can't enable ticket module while Agenda module is already enabled, Bug Can't enable Ticket module while Agenda module is already enabled. This is happened on a fresh installed Dolibarr 20.0.0 software.  Dolibarr Version 20.0.0  Environment PHP 8.1.25  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Install fresh copy of Dolibarr 20.0.0\ 2. Enable Agenda module 3. Then try to enable Ticket module.  Attached files ![ticket-error](https://github.com/user-attachments/assets/21da07bb-944c-4d56-b517-f84f065335f8),database-file | database-file,Can't enable ticket module while Agenda module is already enabled  Bug Can't enable Ticket module while Agenda module is already enabled. This is happened on a fresh installed Dolibarr 20.0.0 software.  Dolibarr Version 20.0.0  Environment PHP 8.1.25  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Install fresh copy of Dolibarr 20.0.0\ 2. Enable Agenda module 3. Then try to enable Ticket module.  Attached files ![ticket-error](https://github.com/user-attachments/assets/21da07bb-944c-4d56-b517-f84f065335f8) database-file database-file,no-bug,0.9
33727,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33727,XSS in note field," Bug # Description Cross-site scripting (XSS) is a type of security vulnerability that allows attackers to inject malicious scripts into web pages viewed by other users. A stored (persistent) XSS vulnerability occurs when an attackers input is saved on the server and later displayed to other users without proper sanitization or encoding. In this case, a stored XSS vulnerability exists in the **note storage feature** of the web application, specifically on the page: **http://192.168.126.18/societe/note.php?id=1** The application allows users to store both **public** and **private** notes, which are vulnerable to persistent XSS.  Dolibarr Version 21.0.0  Environment PHP php8  Environment Database default  Steps to reproduce the behavior and expected behavior #  Proof of Concept  Vulnerable Parameters: - **note_private** (private notes) - **note_public** (public notes)  Affected Endpoint: **/societe/note.php** (via POST request)  Bypassed Filtering Mechanism: The filtering function `dol_htmlwithnojs()` in `functions.lib.php` is bypassable using the event attribute:  oncontentvisibilityautostatechange=alert(1)   Exploit Payload: Using an allowed `<a>` tag, an attacker can inject the following payload: html <a oncontentvisibilityautostatechange=alert(1) style=display:block;content-visibility:auto href=""/x"">X</a>   Attack Scenario: 1. An attacker submits the payload via the **note_private** or **note_public** fields. 2. The application stores the malicious input in its database. 3. When another user (or an administrator) views the stored note, the injected script executes. 4. The script can be used to steal session cookies, redirect users to phishing pages, or perform other malicious actions. # Impacts A successful stored XSS attack can lead to severe consequences, including: - **Session Hijacking:** If session cookies lack the `HttpOnly` flag, an attacker can steal them to take over user accounts. - **Phishing Attacks:** Users can be redirected to malicious websites. - **Content Manipulation:** The attacker can modify the displayed content, such as injecting fake login forms. - **Automatic Malware Downloads:** Scripts can trigger automatic downloads of malicious files. - **Access to User Data:** The attacker can request access to geolocation, camera, or other sensitive browser functionalities. # Mitigations To protect against stored XSS vulnerabilities, the following security measures should be implemented: 1. **Proper Input Validation & Sanitization:** - Use **`htmlspecialchars()`** in PHP to encode special characters. - Avoid allowing dangerous HTML attributes like `on*` event handlers. 2. **Contextual Output Encoding:** - Apply the appropriate escaping based on the output context (e.g., `htmlspecialchars()` for HTML, `json_encode()` for JSON). 3. **Implement a Content Security Policy (CSP):** - Restrict inline scripts using `Content-Security-Policy` headers. 4. **Use a Web Application Firewall (WAF):** - Block known XSS payload patterns in HTTP requests. # References - [OWASP - Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/) - [OWASP - XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html) - [PortSwigger - Stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored) - [Mozilla - Content Security Policy (CSP)](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP) # Credit Found by: - Arthur Deloffre ([Vozec](https://github.com/vozec)) - Clment Viard ([KlemouLeZoZo](https://github.com/requin-citron))  Attached files https://github.com/user-attachments/assets/bec27765-fd57-4d2e-a50b-6d44140494b2",other-file | other-file | other-file | other-file,"XSS in note field  Bug # Description Cross-site scripting (XSS) is a type of security vulnerability that allows attackers to inject malicious scripts into web pages viewed by other users. A stored (persistent) XSS vulnerability occurs when an attackers input is saved on the server and later displayed to other users without proper sanitization or encoding. In this case, a stored XSS vulnerability exists in the **note storage feature** of the web application, specifically on the page: **http://192.168.126.18/societe/note.php?id=1** The application allows users to store both **public** and **private** notes, which are vulnerable to persistent XSS.  Dolibarr Version 21.0.0  Environment PHP php8  Environment Database default  Steps to reproduce the behavior and expected behavior #  Proof of Concept  Vulnerable Parameters: - **note_private** (private notes) - **note_public** (public notes)  Affected Endpoint: **/societe/note.php** (via POST request)  Bypassed Filtering Mechanism: The filtering function `dol_htmlwithnojs()` in `functions.lib.php` is bypassable using the event attribute:  oncontentvisibilityautostatechange=alert(1)   Exploit Payload: Using an allowed `<a>` tag, an attacker can inject the following payload: html <a oncontentvisibilityautostatechange=alert(1) style=display:block;content-visibility:auto href=""/x"">X</a>   Attack Scenario: 1. An attacker submits the payload via the **note_private** or **note_public** fields. 2. The application stores the malicious input in its database. 3. When another user (or an administrator) views the stored note, the injected script executes. 4. The script can be used to steal session cookies, redirect users to phishing pages, or perform other malicious actions. # Impacts A successful stored XSS attack can lead to severe consequences, including: - **Session Hijacking:** If session cookies lack the `HttpOnly` flag, an attacker can steal them to take over user accounts. - **Phishing Attacks:** Users can be redirected to malicious websites. - **Content Manipulation:** The attacker can modify the displayed content, such as injecting fake login forms. - **Automatic Malware Downloads:** Scripts can trigger automatic downloads of malicious files. - **Access to User Data:** The attacker can request access to geolocation, camera, or other sensitive browser functionalities. # Mitigations To protect against stored XSS vulnerabilities, the following security measures should be implemented: 1. **Proper Input Validation & Sanitization:** - Use **`htmlspecialchars()`** in PHP to encode special characters. - Avoid allowing dangerous HTML attributes like `on*` event handlers. 2. **Contextual Output Encoding:** - Apply the appropriate escaping based on the output context (e.g., `htmlspecialchars()` for HTML, `json_encode()` for JSON). 3. **Implement a Content Security Policy (CSP):** - Restrict inline scripts using `Content-Security-Policy` headers. 4. **Use a Web Application Firewall (WAF):** - Block known XSS payload patterns in HTTP requests. # References - [OWASP - Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/) - [OWASP - XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html) - [PortSwigger - Stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored) - [Mozilla - Content Security Policy (CSP)](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP) # Credit Found by: - Arthur Deloffre ([Vozec](https://github.com/vozec)) - Clment Viard ([KlemouLeZoZo](https://github.com/requin-citron))  Attached files https://github.com/user-attachments/assets/bec27765-fd57-4d2e-a50b-6d44140494b2 other-file other-file other-file other-file",no-bug,0.9
30531,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30531,HTML input tag typo mistake at accountancy card page, Bug By mistake input tag is not closed correctly at htdocs/accountancy/admin/card.php  Dolibarr Version 20.0.0  Environment PHP 8.1.25  Environment Database MySQL  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | database-file,HTML input tag typo mistake at accountancy card page  Bug By mistake input tag is not closed correctly at htdocs/accountancy/admin/card.php  Dolibarr Version 20.0.0  Environment PHP 8.1.25  Environment Database MySQL  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file database-file,no-bug,0.9
32339,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32339,Incoherence in loan payment management," Bug On module loan (htdocs/loan/list.php) , deleting a payment causes issues : 1. The bank line still exists after deleting the payment. Should it still exist, or should it be deleted with the payment loan ? 2. The bank line is not linked to the payment anymore, but is still linked to the loan. As a consequence : - on the loan screen, the payment is not shown - but, if the line is reconciliated, the loan can't be deleted. Moreover, no error is displayed (see PR #32338). The user has no clue on what is going on. Even if there was an error, the user can't navigate from the loan to the faulty bank line, so they can't fix the problem.  Dolibarr Version 18.0, develop  Environment PHP any  Environment Database any  Steps to reproduce the behavior and expected behavior ## To reproduce - create a loan - create a payment for this loan. - Observe that this has created a bank line. (expected behavior) - delete the payment - navigate to the bank line. - Observe that it is still linked to the loan - navigate to the loan. - Observe that there is no payment shown, so the user can't navigate to the related bank line. - Try to delete it. - Observe that it can't be deleted. ## Expected behavior I think that, when we delete a payment loan, the related bank line should be also deleted. And if the bank line is reconciliated, one should not be able to delete the payment.  Attached files _No response_",other-file | other-file | other-file | other-file,"Incoherence in loan payment management  Bug On module loan (htdocs/loan/list.php) , deleting a payment causes issues : 1. The bank line still exists after deleting the payment. Should it still exist, or should it be deleted with the payment loan ? 2. The bank line is not linked to the payment anymore, but is still linked to the loan. As a consequence : - on the loan screen, the payment is not shown - but, if the line is reconciliated, the loan can't be deleted. Moreover, no error is displayed (see PR #32338). The user has no clue on what is going on. Even if there was an error, the user can't navigate from the loan to the faulty bank line, so they can't fix the problem.  Dolibarr Version 18.0, develop  Environment PHP any  Environment Database any  Steps to reproduce the behavior and expected behavior ## To reproduce - create a loan - create a payment for this loan. - Observe that this has created a bank line. (expected behavior) - delete the payment - navigate to the bank line. - Observe that it is still linked to the loan - navigate to the loan. - Observe that there is no payment shown, so the user can't navigate to the related bank line. - Try to delete it. - Observe that it can't be deleted. ## Expected behavior I think that, when we delete a payment loan, the related bank line should be also deleted. And if the bank line is reconciliated, one should not be able to delete the payment.  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
23966,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23966,"Error ""Param dbt_keyfield is required but not defined"" when external user clicks on ""show all events"" in contrat/card.php"," Bug Error Message: Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230220123606 Dolibarr: 16.0.4 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache/2.4.55 (Unix) PHP/7.4.33 OS: Darwin MacBook-gl.fritz.box 22.2.0 Darwin Kernel Version 22.2.0: Fri Nov 11 02:03:51 PST 2022; root:xnu-8792.61.2~4/RELEASE_ARM64_T6000 arm64 UserAgent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 Angefragte URL: /contrat/agenda.php?id=131 Referer: http://localhost:8000/contrat/card.php?id=131&save_lastsearch_values=1 Menverwaltung: eldy_menu.php Module/Anwendungen: api, syslog, propal, contrat, supplier_proposal, product, projet, bookmark, categorie, export, import, workflow, externalrss, fckeditor, notification, blockedlog, emailcollector, mailing, ldap, customizeforms, kawagencytodolistforcustomer, dolicalc, quicknotes, paymentbybanktransfer, prelevement, stock, reception, loan, tax, comptabilite, socialnetworks, clicktodial, multicurrency, ficheinter, productbatch, expedition, searcheverywhere, anexum, agenda, banque, cron, ecm, expensereport, holiday, margin, opensurvey, recruitment, resource, salaries, service, variants, societe, commande, ticket, facture, fournisseur, knowledgemanagement, advancedrules, user, fastsearchlists Message: Param dbt_keyfield is required but not defined XDebug informations: File: /Users/gl/Code/GitHub/doli-priv/htdocs/core/lib/security.lib.php Line: 617 Function: checkUserAccessToObject  Environment Version 16.0.x  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4  Environment Database _No response_  Environment URL(s) contrat/card.php  Expected and actual behavior _No response_  Steps to reproduce the behavior 1. Create and login as external user 2. Activate agenda (Events) module 3. Open a contract contrat/card.php 4. Click on ""Shwo all events"" on the right bottom corner of the page  Attached files _No response_",other-file | other-file | other-file,"Error ""Param dbt_keyfield is required but not defined"" when external user clicks on ""show all events"" in contrat/card.php  Bug Error Message: Das System hat einen technischen Fehler festgestellt. Diese Informationen knnen fr Diagnosezwecke ntzlich sein (Sie knnen die Option $dolibarr_main_prod auf '1' setzen, um sensible Informationen auszublenden): Datum: 20230220123606 Dolibarr: 16.0.4 - https://www.dolibarr.org Funktionslevel: 0 PHP: 7.4.33 Server: Apache/2.4.55 (Unix) PHP/7.4.33 OS: Darwin MacBook-gl.fritz.box 22.2.0 Darwin Kernel Version 22.2.0: Fri Nov 11 02:03:51 PST 2022; root:xnu-8792.61.2~4/RELEASE_ARM64_T6000 arm64 UserAgent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 Angefragte URL: /contrat/agenda.php?id=131 Referer: http://localhost:8000/contrat/card.php?id=131&save_lastsearch_values=1 Menverwaltung: eldy_menu.php Module/Anwendungen: api, syslog, propal, contrat, supplier_proposal, product, projet, bookmark, categorie, export, import, workflow, externalrss, fckeditor, notification, blockedlog, emailcollector, mailing, ldap, customizeforms, kawagencytodolistforcustomer, dolicalc, quicknotes, paymentbybanktransfer, prelevement, stock, reception, loan, tax, comptabilite, socialnetworks, clicktodial, multicurrency, ficheinter, productbatch, expedition, searcheverywhere, anexum, agenda, banque, cron, ecm, expensereport, holiday, margin, opensurvey, recruitment, resource, salaries, service, variants, societe, commande, ticket, facture, fournisseur, knowledgemanagement, advancedrules, user, fastsearchlists Message: Param dbt_keyfield is required but not defined XDebug informations: File: /Users/gl/Code/GitHub/doli-priv/htdocs/core/lib/security.lib.php Line: 617 Function: checkUserAccessToObject  Environment Version 16.0.x  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7.4  Environment Database _No response_  Environment URL(s) contrat/card.php  Expected and actual behavior _No response_  Steps to reproduce the behavior 1. Create and login as external user 2. Activate agenda (Events) module 3. Open a contract contrat/card.php 4. Click on ""Shwo all events"" on the right bottom corner of the page  Attached files _No response_ other-file other-file other-file",no-bug,0.8
30960,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30960,Salaries add custom fields not showing up in the list, Bug Salaries add custom fields not showing up in the list ![image](https://github.com/user-attachments/assets/f639b287-3cb8-48b4-a9d9-21ce09bee90c)  Dolibarr Version Dolibarr current version (Programs) 19.0.3  Environment PHP 8.2.7  Environment Database Mariadb  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file,Salaries add custom fields not showing up in the list  Bug Salaries add custom fields not showing up in the list ![image](https://github.com/user-attachments/assets/f639b287-3cb8-48b4-a9d9-21ce09bee90c)  Dolibarr Version Dolibarr current version (Programs) 19.0.3  Environment PHP 8.2.7  Environment Database Mariadb  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.7
26962,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26962,"Wrong value on total of ""Time Spent"" of Project Overview"," Bug The total time in ""List of time consumed on tasks of project"", inside the ""project / overview"" page, always show the last value in list. Eg.: if you have 3 time assignments of 10 minutes, instead of 30 minutes, the total field always shows 10 minutes (00:10). The problem is that the variable $total_time should be outside the foreach loop that starts on line 1.000. Actually the $total_time variable is always set to 0 in line 1.307.  Environment Version 18.0.3  Environment OS any  Environment Web server any  Environment PHP any  Environment Database any  Environment URL(s) projet/element.php  Expected and actual behavior Total time should be the sum of all time spents. Actually it only shows the last detail value.  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Wrong value on total of ""Time Spent"" of Project Overview  Bug The total time in ""List of time consumed on tasks of project"", inside the ""project / overview"" page, always show the last value in list. Eg.: if you have 3 time assignments of 10 minutes, instead of 30 minutes, the total field always shows 10 minutes (00:10). The problem is that the variable $total_time should be outside the foreach loop that starts on line 1.000. Actually the $total_time variable is always set to 0 in line 1.307.  Environment Version 18.0.3  Environment OS any  Environment Web server any  Environment PHP any  Environment Database any  Environment URL(s) projet/element.php  Expected and actual behavior Total time should be the sum of all time spents. Actually it only shows the last detail value.  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
26359,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26359,"Missing quantity in model ""merou"" for expedition"," Feature Request expedition/card.php For expedition if you activate ""print quantity of kit in pdf option "" that could be better to print quantity of each part like : ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/a8eef0a7-1edf-42d4-ba87-93428ab326bf)  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_",other-file,"Missing quantity in model ""merou"" for expedition  Feature Request expedition/card.php For expedition if you activate ""print quantity of kit in pdf option "" that could be better to print quantity of each part like : ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/a8eef0a7-1edf-42d4-ba87-93428ab326bf)  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file",no-bug,0.9
25195,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25195,BUG in ficherinterstats.class.php, Bug when user has not the permission $user->rights->societe->client->voir then stats cause sql error to fix this we need to change the line 75 of fichinterstats.class.php in /htdocs/fichinter change from if (empty($user->rights->societe->client->voir) && !$this->socid) { to if (!empty($user->rights->societe->client->voir) && !$this->socid) { will fix this BUG the ! before empty is important  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,BUG in ficherinterstats.class.php  Bug when user has not the permission $user->rights->societe->client->voir then stats cause sql error to fix this we need to change the line 75 of fichinterstats.class.php in /htdocs/fichinter change from if (empty($user->rights->societe->client->voir) && !$this->socid) { to if (!empty($user->rights->societe->client->voir) && !$this->socid) { will fix this BUG the ! before empty is important  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
31958,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31958,VCF/VCARD compatibility for accented characters," Bug When importing a VCARD in Outlook, I generally get this kind of import: plaintext Rue de l=E2=80=99Ermitage=0D=0A=0D=0A  Over the years I've only observed this when exchanging a VCF file generated by Dolibarr. So there is some incompatibility between dolibarr's format and outlook's format. I also tried Google contacts to check, the result is similar.  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"VCF/VCARD compatibility for accented characters  Bug When importing a VCARD in Outlook, I generally get this kind of import: plaintext Rue de l=E2=80=99Ermitage=0D=0A=0D=0A  Over the years I've only observed this when exchanging a VCF file generated by Dolibarr. So there is some incompatibility between dolibarr's format and outlook's format. I also tried Google contacts to check, the result is similar.  Dolibarr Version _No response_  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
24695,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24695,Missing translation key in ticket.lang," Bug The key TicketMessageMailSignatureText seems to be available only in a few languages, and is missing in many others, including fr_FR (in my case). I joined the translation team on Transifex, but the key is unavailable for french file (for example). How can I add this key? Or please can it be added?  Environment Version At least 17.0 and olders  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior The bug is related to this line: https://github.com/Dolibarr/dolibarr/blob/166f8039fd782d85f58630ccf188c59535104c54/htdocs/public/ticket/create_ticket.php#L400 As the key doesn't exist, the result returned by `getDolGlobalString('TICKET_MESSAGE_MAIL_SIGNATURE', $langs->transnoentities('TicketMessageMailSignatureText', $mysoc->name))` is 'TicketMessageMailSignatureText' instead of the default value (TICKET_MESSAGE_MAIL_SIGNATURE) or the string corresponding to the key.  Steps to reproduce the behavior Define your default language to fr_FR, create a new ticket from the public interface, and then check the email received.  Attached files ![Capture decran 2023-05-05 a 17 43 00](https://user-images.githubusercontent.com/121813548/236504864-2b40298e-618a-4aac-a9af-c733cddc276c.png)",other-file | other-file,"Missing translation key in ticket.lang  Bug The key TicketMessageMailSignatureText seems to be available only in a few languages, and is missing in many others, including fr_FR (in my case). I joined the translation team on Transifex, but the key is unavailable for french file (for example). How can I add this key? Or please can it be added?  Environment Version At least 17.0 and olders  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior The bug is related to this line: https://github.com/Dolibarr/dolibarr/blob/166f8039fd782d85f58630ccf188c59535104c54/htdocs/public/ticket/create_ticket.php#L400 As the key doesn't exist, the result returned by `getDolGlobalString('TICKET_MESSAGE_MAIL_SIGNATURE', $langs->transnoentities('TicketMessageMailSignatureText', $mysoc->name))` is 'TicketMessageMailSignatureText' instead of the default value (TICKET_MESSAGE_MAIL_SIGNATURE) or the string corresponding to the key.  Steps to reproduce the behavior Define your default language to fr_FR, create a new ticket from the public interface, and then check the email received.  Attached files ![Capture decran 2023-05-05 a 17 43 00](https://user-images.githubusercontent.com/121813548/236504864-2b40298e-618a-4aac-a9af-c733cddc276c.png) other-file other-file",no-bug,0.9
28518,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28518,"Issue in ticket closing while, Automatically notify thirdparty when closing a ticket, is ON"," Bug PHP returning **FATAL ERROR** while closing a open ticket and selecting, ** All related contacts** as the value for **_Contacts to notify while closing the ticket_**. And there should be option, **_Automatically notify thirdparty when closing a ticket_** should be ON.  Environment Version 18.0.5  Environment OS RHEL  Environment Web server Apache 2.4.58  Environment PHP 8.1.25  Environment Database _No response_  Environment URL(s) htdocs/ticket/card.php?track_id=rz7aw46ihpio2cx5&action=confirm_close&confirm=yes&token=0805b9791c63e4919416ed3bf01adf1f&contactid=-2  Expected and actual behavior All related contacts should get an email notification upon closing a ticket.  Steps to reproduce the behavior 1. Turn on the option, Automatically notify thirdparty when closing a ticket at Ticket SETUP 2. Now close the ticket. 3. Now confirm ticket closing. (Make sure there is no related contact of the ticket.)  Attached files ![close](https://github.com/Dolibarr/dolibarr/assets/1249577/56b22456-3288-4ffb-b422-73a1141d3ca4) ![confirm](https://github.com/Dolibarr/dolibarr/assets/1249577/e3bd6c32-57ef-4943-a57c-33c97e471f46) ![error](https://github.com/Dolibarr/dolibarr/assets/1249577/904e087c-2275-4eaf-a0f8-3f715f36fa7f)",other-file,"Issue in ticket closing while, Automatically notify thirdparty when closing a ticket, is ON  Bug PHP returning **FATAL ERROR** while closing a open ticket and selecting, ** All related contacts** as the value for **_Contacts to notify while closing the ticket_**. And there should be option, **_Automatically notify thirdparty when closing a ticket_** should be ON.  Environment Version 18.0.5  Environment OS RHEL  Environment Web server Apache 2.4.58  Environment PHP 8.1.25  Environment Database _No response_  Environment URL(s) htdocs/ticket/card.php?track_id=rz7aw46ihpio2cx5&action=confirm_close&confirm=yes&token=0805b9791c63e4919416ed3bf01adf1f&contactid=-2  Expected and actual behavior All related contacts should get an email notification upon closing a ticket.  Steps to reproduce the behavior 1. Turn on the option, Automatically notify thirdparty when closing a ticket at Ticket SETUP 2. Now close the ticket. 3. Now confirm ticket closing. (Make sure there is no related contact of the ticket.)  Attached files ![close](https://github.com/Dolibarr/dolibarr/assets/1249577/56b22456-3288-4ffb-b422-73a1141d3ca4) ![confirm](https://github.com/Dolibarr/dolibarr/assets/1249577/e3bd6c32-57ef-4943-a57c-33c97e471f46) ![error](https://github.com/Dolibarr/dolibarr/assets/1249577/904e087c-2275-4eaf-a0f8-3f715f36fa7f) other-file",no-bug,0.9
26066,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26066,No autorisation control on GET /multicurrencies through API," Bug No autorisation control on GET /multicurrencies through API, where as GET /multicurrencies/bycode/{code} has autorisation control.  Environment Version 18.0.1  Environment OS upshift dolibarr docker image 18.0.1  Environment Web server upshift dolibarr docker image 18.0.1  Environment PHP PHP 8.2.10 (cli) (built: Aug 31 2023 20:34:52) (NTS)  Environment Database 1:11.0.3+maria~ubu2204  Environment URL(s) /api/index.php/multicurrencies?sortfield=t.rowid&sortorder=ASC&limit=100  Expected and actual behavior Expected rejection given that my API key is from a user that only has 3 permissions: 1. read access to products 2. read access to services 3. read access to tags and categories but no, the actual behaviour was that if I just asked for all currencies, then I got the data, where as if I only asked for the EUR currency, then I get `""message"": ""Unauthorized: Insufficient rights to read currency""`  Steps to reproduce the behavior enable modules: products, categories and multicurrency. Setup DKK and Eur currencies.  Attached files ![get_all_currencies](https://github.com/Dolibarr/dolibarr/assets/2551481/d3b6e500-f765-48fa-9cf2-ff6b0780aa46) ![get_EUR_currency](https://github.com/Dolibarr/dolibarr/assets/2551481/e9c3b409-4ed6-4c7a-9b47-b421e502cc7c)",other-file,"No autorisation control on GET /multicurrencies through API  Bug No autorisation control on GET /multicurrencies through API, where as GET /multicurrencies/bycode/{code} has autorisation control.  Environment Version 18.0.1  Environment OS upshift dolibarr docker image 18.0.1  Environment Web server upshift dolibarr docker image 18.0.1  Environment PHP PHP 8.2.10 (cli) (built: Aug 31 2023 20:34:52) (NTS)  Environment Database 1:11.0.3+maria~ubu2204  Environment URL(s) /api/index.php/multicurrencies?sortfield=t.rowid&sortorder=ASC&limit=100  Expected and actual behavior Expected rejection given that my API key is from a user that only has 3 permissions: 1. read access to products 2. read access to services 3. read access to tags and categories but no, the actual behaviour was that if I just asked for all currencies, then I got the data, where as if I only asked for the EUR currency, then I get `""message"": ""Unauthorized: Insufficient rights to read currency""`  Steps to reproduce the behavior enable modules: products, categories and multicurrency. Setup DKK and Eur currencies.  Attached files ![get_all_currencies](https://github.com/Dolibarr/dolibarr/assets/2551481/d3b6e500-f765-48fa-9cf2-ff6b0780aa46) ![get_EUR_currency](https://github.com/Dolibarr/dolibarr/assets/2551481/e9c3b409-4ed6-4c7a-9b47-b421e502cc7c) other-file",bug,0.95
32178,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32178,"[19.0.4]: repair script, postgresql, results in Error DB_ERROR_SYNTAX (Req 159): create table tmp_bank_url_expense_user"," Bug repair.php results in the following error on 19.0.4 with a postgresql database:  Error DB_ERROR_SYNTAX (Req 159): create table tmp_bank_url_expense_user (select e.fk_user_author, bu2.fk_bank from llx_expensereport as e, llx_bank_url as bu2 where bu2.url_id = e.rowid and bu2.type = 'payment_expensereport'); ERROR: 42601: syntax error at or near ""select"" LINE 1: create table tmp_bank_url_expense_user (select e.fk_user_aut ^ LOCATION: scanner_yyerror, scan.l:1145   Dolibarr Version 19.0.4  Environment PHP 7.2  Environment Database Postgresql 12  Steps to reproduce the behavior and expected behavior Database originated from Dolibarr 15.0.x, updated to 16.0.x, then updated to 19.0.x (after 17.x and 18.x migration but from the 19.0.2 image), the problem appeared on 19.0.2, so I updated and tried to repair on 19.0.4. Start repairing resulted in the following SQL error:  Error DB_ERROR_SYNTAX (Req 159): create table tmp_bank_url_expense_user (select e.fk_user_author, bu2.fk_bank from llx_expensereport as e, llx_bank_url as bu2 where bu2.url_id = e.rowid and bu2.type = 'payment_expensereport'); ERROR: 42601: syntax error at or near ""select"" LINE 1: create table tmp_bank_url_expense_user (select e.fk_user_aut ^ LOCATION: scanner_yyerror, scan.l:1145  Full logs:  Database server version 12.20 (Debian 12.20-1.pgdg110+1) Please be patient  Script repair.sql Request 1 sql='UPDATE llx_user set api_key = null where api_key = '';' Request 2 sql='UPDATE llx_c_email_templates SET position = 0 WHERE position IS NULL;' Request 3 sql='ALTER TABLE llx_propal DROP FOREIGN KEY fk_propal_fk_currency;' Request 4 sql='ALTER TABLE llx_commande DROP FOREIGN KEY fk_commande_fk_currency;' Request 5 sql='ALTER TABLE llx_facture DROP FOREIGN KEY fk_facture_fk_currency;' Request 6 sql='delete from llx_facturedet where fk_facture in (select rowid from llx_facture where ref in ('(PROV)','ErrorBadMask'));' Request 7 sql='delete from llx_facture where ref in ('(PROV)','ErrorBadMask');' Request 8 sql='delete from llx_commandedet where fk_commande in (select rowid from llx_commande where ref in ('(PROV)','ErrorBadMask'));' Request 9 sql='delete from llx_commande where ref in ('(PROV)','ErrorBadMask');' Request 10 sql='delete from llx_propaldet where fk_propal in (select rowid from llx_propal where ref in ('(PROV)','ErrorBadMask'));' Request 11 sql='delete from llx_propal where ref in ('(PROV)','ErrorBadMask');' Request 12 sql='delete from llx_facturedet where fk_facture in (select rowid from llx_facture where ref = '');' Request 13 sql='delete from llx_facture where ref = '';' Request 14 sql='delete from llx_commandedet where fk_commande in (select rowid from llx_commande where ref = '');' Request 15 sql='delete from llx_commande where ref = '';' Request 16 sql='delete from llx_propaldet where fk_propal in (select rowid from llx_propal where ref = '');' Request 17 sql='delete from llx_propal where ref = '';' Request 18 sql='delete from llx_deliverydet where fk_delivery in (select rowid from llx_delivery where ref = '');' Request 19 sql='delete from llx_delivery where ref = '';' Request 20 sql='delete from llx_expeditiondet where fk_expedition in (select rowid from llx_expedition where ref = '');' Request 21 sql='delete from llx_expedition where ref = '';' Request 22 sql='delete from llx_holiday_logs where fk_user_update not IN (select rowid from llx_user);' Request 23 sql='delete from llx_rights_def where perms IS NULL;' Request 24 sql='delete from llx_user_rights where fk_user not IN (select rowid from llx_user);' Request 25 sql='delete from llx_usergroup_rights where fk_usergroup not in (select rowid from llx_usergroup);' Request 26 sql='delete from llx_usergroup_rights where fk_id not in (select id from llx_rights_def);' Request 27 sql='update llx_deplacement set dated='2010-01-01' where dated < '2000-01-01';' Request 28 sql='update llx_subscription set fk_bank = null where fk_bank not in (select rowid from llx_bank);' Request 29 sql='update llx_propal set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 30 sql='update llx_commande set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 31 sql='update llx_facture set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 32 sql='update llx_commande_fournisseur set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 33 sql='update llx_contrat set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 34 sql='update llx_deplacement set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 35 sql='update llx_facture_fourn set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 36 sql='update llx_facture_rec set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 37 sql='update llx_fichinter set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 38 sql='update llx_projet_task set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 39 sql='update llx_propal set fk_user_author = null where fk_user_author not in (select rowid from llx_user);' Request 40 sql='update llx_propal set fk_user_valid = null where fk_user_valid not in (select rowid from llx_user);' Request 41 sql='update llx_propal set fk_user_cloture = null where fk_user_cloture not in (select rowid from llx_user);' Request 42 sql='update llx_commande set fk_user_author = null where fk_user_author not in (select rowid from llx_user);' Request 43 sql='update llx_commande set fk_user_valid = null where fk_user_valid not in (select rowid from llx_user);' Request 44 sql='delete from llx_societe_extrafields where fk_object not in (select rowid from llx_societe);' Request 45 sql='delete from llx_adherent_extrafields where fk_object not in (select rowid from llx_adherent);' Request 46 sql='delete from llx_product_extrafields where fk_object not in (select rowid from llx_product);' Request 47 sql='UPDATE llx_product SET datec = tms WHERE datec IS NULL;' Request 48 sql='update llx_product_batch set batch = '' where batch = 'Non dfini';' Request 49 sql='update llx_product_batch set batch = '' where batch = 'Non dfini';' Request 50 sql='update llx_stock_mouvement set batch = null where batch = 'Non dfini';' Request 51 sql='update llx_stock_mouvement set batch = null where batch = 'Non dfini';' Request 52 sql='DELETE FROM llx_product_lot WHERE fk_product NOT IN (select rowid from llx_product);' Request 53 sql='DELETE FROM llx_product_stock WHERE fk_product NOT IN (select rowid from llx_product);' Request 54 sql='DELETE FROM llx_product_stock WHERE reel = 0 AND rowid NOT IN (SELECT fk_product_stock FROM llx_product_batch as pb);' Request 55 sql='DROP TABLE tmp_llx_product_batch;' Request 56 sql='DROP TABLE tmp_llx_product_batch2;' Request 57 sql='CREATE TABLE tmp_llx_product_batch AS select fk_product_stock, eatby, sellby, batch, SUM(qty) as qty, COUNT(rowid) as nb FROM llx_product_batch GROUP BY fk_product_stock, eatby, sellby, batch HAVING COUNT(rowid) > 1;' Request 58 sql='CREATE TABLE tmp_llx_product_batch2 AS select pb.rowid, pb.fk_product_stock, pb.eatby, pb.sellby, pb.batch, pb.qty from llx_product_batch as pb, tmp_llx_product_batch as tpb where pb.fk_product_stock = tpb.fk_product_stock and COALESCE(pb.eatby, '2000-01-01') = COALESCE(tpb.eatby,'2000-01-01') and COALESCE(pb.sellby, '2000-01-01') = COALESCE(tpb.sellby, '2000-01-01') and pb.batch = tpb.batch;' Request 59 sql='DELETE FROM llx_product_batch WHERE rowid IN (select rowid FROM tmp_llx_product_batch2);' Request 60 sql='INSERT INTO llx_product_batch(fk_product_stock, eatby, sellby, batch, qty) SELECT fk_product_stock, eatby, sellby, batch, qty FROM tmp_llx_product_batch;' Request 61 sql='DELETE FROM llx_product_stock WHERE reel = 0 AND rowid NOT IN (SELECT fk_product_stock FROM llx_product_batch as pb);' Request 62 sql='DELETE FROM llx_product_batch WHERE qty = 0;' Request 63 sql='UPDATE llx_product p SET p.stock= (SELECT SUM(ps.reel) FROM llx_product_stock ps WHERE ps.fk_product = p.rowid);' Request 64 sql='delete from llx_product_association where fk_product_pere NOT IN (select rowid from llx_product);' Request 65 sql='delete from llx_product_association where fk_product_fils NOT IN (select rowid from llx_product);' Request 66 sql='drop table tmp_categorie;' Request 67 sql='create table tmp_categorie as select * from llx_categorie;' Request 68 sql='delete from llx_categorie where fk_parent not in (select rowid from tmp_categorie) and fk_parent is not null and fk_parent <> 0;' Request 69 sql='drop table tmp_categorie;' Request 70 sql='delete from llx_categorie_product where fk_categorie not in (select rowid from llx_categorie where type = 0);' Request 71 sql='delete from llx_categorie_fournisseur where fk_categorie not in (select rowid from llx_categorie where type = 1);' Request 72 sql='delete from llx_categorie_societe where fk_categorie not in (select rowid from llx_categorie where type = 2);' Request 73 sql='delete from llx_categorie_member where fk_categorie not in (select rowid from llx_categorie where type = 3);' Request 74 sql='delete from llx_categorie_contact where fk_categorie not in (select rowid from llx_categorie where type = 4);' Request 75 sql='delete from llx_categorie_project where fk_categorie not in (select rowid from llx_categorie where type = 6);' Request 76 sql='delete from llx_ecm_files where src_object_type = 'expensereport' and src_object_id NOT IN (select rowid from llx_expensereport);' Request 77 sql='delete from llx_ecm_files where (src_object_type = 'contrat' OR src_object_type = 'contract') and src_object_id NOT IN (select rowid from llx_contrat);' Request 78 sql='delete from llx_deliverydet where fk_delivery not in (select fk_target from llx_element_element where targettype = 'delivery') AND fk_delivery not in (select fk_source from llx_element_element where sourcetype = 'delivery');' Request 79 sql='delete from llx_delivery where rowid not in (select fk_target from llx_element_element where targettype = 'delivery') AND rowid not in (select fk_source from llx_element_element where sourcetype = 'delivery');' Request 80 sql='delete from llx_element_element where targettype='shipping' and fk_target not in (select rowid from llx_expedition);' Request 81 sql='delete from llx_element_element where targettype='delivery' and fk_target not in (select rowid from llx_delivery);' Request 82 sql='delete from llx_element_element where targettype='propal' and fk_target not in (select rowid from llx_propal);' Request 83 sql='delete from llx_element_element where targettype='facture' and fk_target not in (select rowid from llx_facture);' Request 84 sql='delete from llx_element_element where targettype='commande' and fk_target not in (select rowid from llx_commande);' Request 85 sql='delete from llx_element_element where sourcetype='shipping' and fk_source not in (select rowid from llx_expedition);' Request 86 sql='delete from llx_element_element where sourcetype='delivery' and fk_source not in (select rowid from llx_delivery);' Request 87 sql='delete from llx_element_element where sourcetype='propal' and fk_source not in (select rowid from llx_propal);' Request 88 sql='delete from llx_element_element where sourcetype='facture' and fk_source not in (select rowid from llx_facture);' Request 89 sql='delete from llx_element_element where sourcetype='commande' and fk_source not in (select rowid from llx_commande);' Request 90 sql='DELETE FROM llx_actioncomm_resources WHERE fk_actioncomm not in (select id from llx_actioncomm);' Request 91 sql='DELETE from llx_bank_url where type = 'payment' and url_id not in (select rowid from llx_paiement);' Request 92 sql='DELETE from llx_bank_url where type = 'payment_supplier' and url_id not in (select rowid from llx_paiementfourn);' Request 93 sql='DELETE from llx_bank_url where type = 'company' and url_id not in (select rowid from llx_societe);' Request 94 sql='DELETE FROM llx_bank WHERE fk_account NOT IN (select rowid from llx_bank_account);' Request 95 sql='DROP table tmp_user;' Request 96 sql='CREATE TABLE tmp_user as (select * from llx_user);' Request 97 sql='UPDATE llx_user SET fk_user = NULL where fk_user NOT IN (select rowid from tmp_user);' Request 98 sql='UPDATE llx_product SET canvas = NULL where canvas = 'default@product';' Request 99 sql='UPDATE llx_product SET canvas = NULL where canvas = 'service@product';' Request 100 sql='DELETE FROM llx_boxes where box_id NOT IN (SELECT rowid FROM llx_boxes_def);' Request 101 sql='update llx_document_model set nom = 'typhon' where (nom = '' OR nom is null) and type = 'delivery';' Request 102 sql='DELETE FROM llx_document_model WHERE nom ='elevement' AND type='delivery';' Request 103 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 1, 'AC_TEL', 'system', 'Phone call' ,NULL, 2);' Request 104 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 2, 'AC_FAX', 'system', 'Send Fax' ,NULL, 3);' Request 105 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 3, 'AC_PROP', 'systemauto', 'Send commercial proposal by email' ,'propal', 10);' Request 106 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 4, 'AC_EMAIL', 'system', 'Send Email' ,NULL, 4);' Request 107 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 5, 'AC_RDV', 'system', 'Rendez-vous' ,NULL, 1);' Request 108 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 8, 'AC_COM', 'systemauto', 'Send customer order by email' ,'order', 8);' Request 109 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 9, 'AC_FAC', 'systemauto', 'Send customer invoice by email' ,'invoice', 6);' Request 110 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 10, 'AC_SHIP', 'systemauto', 'Send shipping by email' ,'shipping', 11);' Request 111 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 30, 'AC_SUP_ORD', 'systemauto', 'Send supplier order by email' ,'order_supplier', 9);' Request 112 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values (31, 'AC_SUP_INV', 'systemauto', 'Send supplier invoice by email' ,'invoice_supplier', 7);' Request 113 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 50, 'AC_OTH', 'system', 'Other' ,NULL, 5);' Request 114 sql='DELETE FROM llx_boxes_def as T1 WHERE rowid NOT IN (SELECT min(rowid) FROM llx_boxes_def GROUP BY file, entity, note);' Request 115 sql='ALTER TABLE llx_product_fournisseur_price DROP COLUMN fk_product_fournisseur;' Request 116 sql='ALTER TABLE llx_product_fournisseur_price DROP FOREIGN KEY fk_product_fournisseur;' Request 117 sql='update llx_opensurvey_sondage set format = 'D' where format = 'D+';' Request 118 sql='update llx_opensurvey_sondage set format = 'A' where format = 'A+';' Request 119 sql='update llx_opensurvey_sondage set tms = now();' Request 120 sql='update llx_product set barcode = null where barcode in ('', '-1', '0');' Request 121 sql='update llx_societe set barcode = null where barcode in ('', '-1', '0');' Request 122 sql='drop table tmp_links_double;' Request 123 sql='create table tmp_links_double as (select objectid, label, max(rowid) as max_rowid, count(rowid) as count_rowid from llx_links where label is not null group by objectid, label having count(rowid) >= 2);' Request 124 sql='delete from llx_links where (rowid, label) in (select max_rowid, label from tmp_links_double);' Request 125 sql='drop table tmp_links_double;' Request 126 sql='drop table tmp_product_double;' Request 127 sql='create table tmp_product_double as (select barcode, max(rowid) as max_rowid, count(rowid) as count_rowid from llx_product where barcode is not null group by barcode having count(rowid) >= 2);' Request 128 sql='update llx_product set barcode = null where (rowid, barcode) in (select max_rowid, barcode from tmp_product_double);' Request 129 sql='drop table tmp_product_double;' Request 130 sql='drop table tmp_societe_double;' Request 131 sql='create table tmp_societe_double as (select barcode, max(rowid) as max_rowid, count(rowid) as count_rowid from llx_societe where barcode is not null group by barcode having count(rowid) >= 2);' Request 132 sql='update llx_societe set barcode = null where (rowid, barcode) in (select max_rowid, barcode from tmp_societe_double);' Request 133 sql='drop table tmp_societe_double;' Request 134 sql='drop table tmp_accounting_account_double;' Request 135 sql='create table tmp_accounting_account_double as (select account_number, fk_pcg_version, entity, max(rowid) as max_rowid, count(rowid) as count_rowid from llx_accounting_account where label is not null group by account_number, fk_pcg_version, entity having count(rowid) >= 2);' Request 136 sql='delete from llx_accounting_account where (rowid) in (select max_rowid from tmp_accounting_account_double);' Request 137 sql='drop table tmp_accounting_account_double;' Request 138 sql='UPDATE llx_projet_task SET fk_task_parent = 0 WHERE fk_task_parent = rowid;' Request 139 sql='UPDATE llx_actioncomm set fk_user_action = fk_user_done where fk_user_done > 0 and (fk_user_action is null or fk_user_action = 0);' Request 140 sql='UPDATE llx_actioncomm set fk_user_action = fk_user_author where fk_user_author > 0 and (fk_user_action is null or fk_user_action = 0);' Request 141 sql='UPDATE llx_element_time set element_datehour = element_date where element_datehour IS NULL and element_date IS NOT NULL;' Request 142 sql='UPDATE llx_projet set fk_opp_status = NULL where fk_opp_status = -1;' Request 143 sql='UPDATE llx_projet set fk_opp_status = (SELECT rowid FROM llx_c_lead_status WHERE code='PROSP') where fk_opp_status IS NULL and opp_amount > 0;' Request 144 sql='UPDATE llx_c_lead_status set code = 'WON' where code = 'WIN';' Request 145 sql='update llx_propaldet set product_type = 1 where product_type = 2;' Request 146 sql='update llx_commandedet set product_type = 1 where product_type = 2;' Request 147 sql='update llx_facturedet set product_type = 1 where product_type = 2;' Request 148 sql='update llx_propal set fk_statut = 1 where fk_statut = -1;' Request 149 sql='delete from llx_commande_fournisseur_dispatch where fk_commandefourndet = 0 or fk_commandefourndet IS NULL;' Request 150 sql='delete from llx_menu where menu_handler = 'smartphone';' Request 151 sql='update llx_expedition set date_valid = date_creation where fk_statut = 1 and date_valid IS NULL;' Request 152 sql='update llx_expedition set date_valid = NOW() where fk_statut = 1 and date_valid IS NULL;' Request 153 sql='update llx_projet_task as pt set pt.duration_effective = (select SUM(ptt.element_duration) as y from llx_element_time as ptt where ptt.fk_element = pt.rowid and ptt.elementtype = 'task') where pt.duration_effective <> (select SUM(ptt.element_duration) as y from llx_element_time as ptt where ptt.fk_element = pt.rowid and ptt.elementtype = 'task');' Request 154 sql='drop table tmp_c_shipment_mode;' Request 155 sql='create table tmp_c_shipment_mode as (select code, tracking from llx_c_shipment_mode);' Request 156 sql='DELETE FROM llx_c_shipment_mode where code IN (select code from tmp_c_shipment_mode WHERE tracking is NULL OR tracking = '') AND code IN (select code from tmp_c_shipment_mode WHERE tracking is NOT NULL AND tracking != '') AND (tracking IS NULL OR tracking = '');' Request 157 sql='drop table tmp_c_shipment_mode;' Request 158 sql='drop table tmp_bank_url_expense_user;' Request 159 sql='create table tmp_bank_url_expense_user (select e.fk_user_author, bu2.fk_bank from llx_expensereport as e, llx_bank_url as bu2 where bu2.url_id = e.rowid and bu2.type = 'payment_expensereport');' Error DB_ERROR_SYNTAX (Req 159): create table tmp_bank_url_expense_user (select e.fk_user_author, bu2.fk_bank from llx_expensereport as e, llx_bank_url as bu2 where bu2.url_id = e.rowid and bu2.type = 'payment_expensereport'); ERROR: 42601: syntax error at or near ""select"" LINE 1: create table tmp_bank_url_expense_user (select e.fk_user_aut ^ LOCATION: scanner_yyerror, scan.l:1145 Request 160 sql='update llx_bank_url as bu set url_id = (select e.fk_user_author from tmp_bank_url_expense_user as e where e.fk_bank = bu.fk_bank) where (bu.url_id = 0 OR bu.url_id IS NULL) and bu.type ='user';' Request 161 sql='drop table tmp_bank_url_expense_user;' Request 162 sql='DROP TABLE tmp_llx_accouting_account;' Request 163 sql='CREATE TABLE tmp_llx_accouting_account AS SELECT MIN(rowid) as MINID, account_number, entity, fk_pcg_version, count(*) AS NB FROM llx_accounting_account group BY account_number, entity, fk_pcg_version HAVING count(*) >= 2 order by account_number, entity, fk_pcg_version;' Request 164 sql='DELETE from llx_accounting_account where rowid in (select minid from tmp_llx_accouting_account where minid NOT IN (SELECT fk_code_ventilation from llx_facturedet) AND minid NOT IN (SELECT fk_code_ventilation from llx_facture_fourn_det) AND minid NOT IN (SELECT fk_code_ventilation from llx_expensereport_det));' Request 165 sql='ALTER TABLE llx_accounting_account DROP INDEX uk_accounting_account;' Request 166 sql='ALTER TABLE llx_accounting_account ADD UNIQUE INDEX uk_accounting_account (account_number, entity, fk_pcg_version);' Request 167 sql='UPDATE llx_facturedet SET fk_code_ventilation = 0 WHERE fk_code_ventilation > 0 AND fk_code_ventilation NOT IN (select rowid FROM llx_accounting_account);' Request 168 sql='UPDATE llx_facture_fourn_det SET fk_code_ventilation = 0 WHERE fk_code_ventilation > 0 AND fk_code_ventilation NOT IN (select rowid FROM llx_accounting_account);' Request 169 sql='UPDATE llx_expensereport_det SET fk_code_ventilation = 0 WHERE fk_code_ventilation > 0 AND fk_code_ventilation NOT IN (select rowid FROM llx_accounting_account);' Request 170 sql='UPDATE llx_chargesociales SET date_creation = tms WHERE date_creation IS NULL;' Request 171 sql='update llx_facturedet set product_type = 0 where product_type = 1 AND fk_product > 0 AND fk_product IN (SELECT rowid FROM llx_product WHERE fk_product_type = 0);' Request 172 sql='update llx_facturedet set product_type = 1 where product_type = 0 AND fk_product > 0 AND fk_product IN (SELECT rowid FROM llx_product WHERE fk_product_type = 1);' Request 173 sql='update llx_facture_fourn_det set product_type = 0 where product_type = 1 AND fk_product > 0 AND fk_product IN (SELECT rowid FROM llx_product WHERE fk_product_type = 0);' Request 174 sql='update llx_facture_fourn_det set product_type = 1 where product_type = 0 AND fk_product > 0 AND fk_product IN (SELECT rowid FROM llx_product WHERE fk_product_type = 1);' Request 175 sql='DELETE FROM llx_mrp_production where qty = 0;' Request 176 sql='UPDATE llx_accounting_bookkeeping set date_creation = tms where date_creation IS NULL;' Request 177 sql='UPDATE llx_facturedet SET multicurrency_subprice = -multicurrency_subprice WHERE ((multicurrency_subprice < 0 and subprice > 0) OR (multicurrency_subprice > 0 and subprice < 0));' Request 178 sql='UPDATE llx_facturedet SET multicurrency_total_ht = -multicurrency_total_ht WHERE ((multicurrency_total_ht < 0 and total_ht > 0) OR (multicurrency_total_ht > 0 and total_ht < 0));' Request 179 sql='UPDATE llx_facturedet SET multicurrency_total_tva = -multicurrency_total_tva WHERE ((multicurrency_total_tva < 0 and total_tva > 0) OR (multicurrency_total_tva > 0 and total_tva < 0));' Request 180 sql='UPDATE llx_facturedet SET multicurrency_total_ttc = -multicurrency_total_ttc WHERE ((multicurrency_total_ttc < 0 and total_ttc > 0) OR (multicurrency_total_ttc > 0 and total_ttc < 0));' Request 181 sql='UPDATE llx_facture SET multicurrency_total_ht = -multicurrency_total_ht WHERE ((multicurrency_total_ht < 0 and total_ht > 0) OR (multicurrency_total_ht > 0 and total_ht < 0));' Request 182 sql='UPDATE llx_facture SET multicurrency_total_tva = -multicurrency_total_tva WHERE ((multicurrency_total_tva < 0 and total_tva > 0) OR (multicurrency_total_tva > 0 and total_tva < 0));' Request 183 sql='UPDATE llx_facture SET multicurrency_total_ttc = -multicurrency_total_ttc WHERE ((multicurrency_total_ttc < 0 and total_ttc > 0) OR (multicurrency_total_ttc > 0 and total_ttc < 0));' Request 184 sql='UPDATE llx_facture_fourn_det SET multicurrency_subprice = -multicurrency_subprice WHERE ((multicurrency_subprice < 0 and pu_ht > 0) OR (multicurrency_subprice > 0 and pu_ht < 0));' Request 185 sql='UPDATE llx_facture_fourn_det SET multicurrency_total_ht = -multicurrency_total_ht WHERE ((multicurrency_total_ht < 0 and total_ht > 0) OR (multicurrency_total_ht > 0 and total_ht < 0));' Request 186 sql='UPDATE llx_facture_fourn_det SET multicurrency_total_tva = -multicurrency_total_tva WHERE ((multicurrency_total_tva < 0 and tva > 0) OR (multicurrency_total_tva > 0 and tva < 0));' Request 187 sql='UPDATE llx_facture_fourn_det SET multicurrency_total_ttc = -multicurrency_total_ttc WHERE ((multicurrency_total_ttc < 0 and total_ttc > 0) OR (multicurrency_total_ttc > 0 and total_ttc < 0));' Request 188 sql='UPDATE llx_facture_fourn SET multicurrency_total_ht = -multicurrency_total_ht WHERE ((multicurrency_total_ht < 0 and total_ht > 0) OR (multicurrency_total_ht > 0 and total_ht < 0));' Request 189 sql='UPDATE llx_facture_fourn SET multicurrency_total_tva = -multicurrency_total_tva WHERE ((multicurrency_total_tva < 0 and total_tva > 0) OR (multicurrency_total_tva > 0 and total_tva < 0));' Request 190 sql='UPDATE llx_facture_fourn SET multicurrency_total_ttc = -multicurrency_total_ttc WHERE ((multicurrency_total_ttc < 0 and total_ttc > 0) OR (multicurrency_total_ttc > 0 and total_ttc < 0));' Request 191 sql='UPDATE llx_facturedet SET situation_percent = 100 WHERE situation_percent IS NULL AND fk_prev_id IS NULL;' Request 192 sql='DELETE FROM llx_rights_def WHERE module = 'hrm' AND perms = 'employee';' Request 193 sql='DELETE FROM llx_c_transport_mode as T1 WHERE rowid NOT IN (SELECT min(rowid) FROM llx_c_transport_mode GROUP BY code, entity);' Request 194 sql='DELETE FROM llx_c_departements WHERE fk_region <> 0 AND fk_region IN (select code_region FROM llx_c_regions WHERE fk_pays NOT IN (select rowid from llx_c_country));' Request 195 sql='DELETE from llx_c_regions WHERE fk_pays NOT IN (select rowid from llx_c_country);' Request 196 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combination;' Request 197 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_2;' Request 198 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_3;' Request 199 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_4;' Request 200 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_5;' Request 201 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_6;' Request 202 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_7;' Request 203 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_8;' Request 204 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_9;' Request 205 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_10;' Request 206 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_11;' Request 207 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_12;' Request 208 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_13;' Request 209 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_14;' Request 210 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_15;' Request 211 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_16;' Request 212 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_17;' Request 213 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_18;' Request 214 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_19;' Request 215 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_20;' Request 216 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_21;' Request 217 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_22;' Request 218 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_23;' Request 219 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_24;' Request 220 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_25;' Request 221 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_26;' Request 222 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_27;' Request 223 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_28;' Request 224 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_29;' Request 225 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_30;' Request 226 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_31;' Request 227 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_32;' Request 228 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_33;' Request 229 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_34;' Request 230 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_35;' Request 231 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_36;' Request 232 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_37;' Request 233 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_38;' Request 234 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_39;' Request 235 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_40;' Request 236 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_41;' Request 237 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_42;' Request 238 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_43;' Request 239 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_44;' Request 240 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_45;' Request 241 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_46;' Request 242 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_47;' Request 243 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_48;' Request 244 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_49;' Request 245 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_50;' Request 246 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_51;' Request 247 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_52;' Request 248 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_53;' Request 249 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_54;' Request 250 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_55;' Request 251 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_56;' Request 252 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_57;' Request 253 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_58;' Request 254 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_59;' Request 255 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_60;' Request 256 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_61;' Request 257 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_62;' Request 258 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_63;' Request 259 sql='ALTER TABLE llx_product_attribute_combination_price_level ADD UNIQUE INDEX uk_prod_att_comb_price_level(fk_product_attribute_combination, fk_price_level);'   Attached files _No response_",database-file | database-file,"[19.0.4]: repair script, postgresql, results in Error DB_ERROR_SYNTAX (Req 159): create table tmp_bank_url_expense_user  Bug repair.php results in the following error on 19.0.4 with a postgresql database:  Error DB_ERROR_SYNTAX (Req 159): create table tmp_bank_url_expense_user (select e.fk_user_author, bu2.fk_bank from llx_expensereport as e, llx_bank_url as bu2 where bu2.url_id = e.rowid and bu2.type = 'payment_expensereport'); ERROR: 42601: syntax error at or near ""select"" LINE 1: create table tmp_bank_url_expense_user (select e.fk_user_aut ^ LOCATION: scanner_yyerror, scan.l:1145   Dolibarr Version 19.0.4  Environment PHP 7.2  Environment Database Postgresql 12  Steps to reproduce the behavior and expected behavior Database originated from Dolibarr 15.0.x, updated to 16.0.x, then updated to 19.0.x (after 17.x and 18.x migration but from the 19.0.2 image), the problem appeared on 19.0.2, so I updated and tried to repair on 19.0.4. Start repairing resulted in the following SQL error:  Error DB_ERROR_SYNTAX (Req 159): create table tmp_bank_url_expense_user (select e.fk_user_author, bu2.fk_bank from llx_expensereport as e, llx_bank_url as bu2 where bu2.url_id = e.rowid and bu2.type = 'payment_expensereport'); ERROR: 42601: syntax error at or near ""select"" LINE 1: create table tmp_bank_url_expense_user (select e.fk_user_aut ^ LOCATION: scanner_yyerror, scan.l:1145  Full logs:  Database server version 12.20 (Debian 12.20-1.pgdg110+1) Please be patient  Script repair.sql Request 1 sql='UPDATE llx_user set api_key = null where api_key = '';' Request 2 sql='UPDATE llx_c_email_templates SET position = 0 WHERE position IS NULL;' Request 3 sql='ALTER TABLE llx_propal DROP FOREIGN KEY fk_propal_fk_currency;' Request 4 sql='ALTER TABLE llx_commande DROP FOREIGN KEY fk_commande_fk_currency;' Request 5 sql='ALTER TABLE llx_facture DROP FOREIGN KEY fk_facture_fk_currency;' Request 6 sql='delete from llx_facturedet where fk_facture in (select rowid from llx_facture where ref in ('(PROV)','ErrorBadMask'));' Request 7 sql='delete from llx_facture where ref in ('(PROV)','ErrorBadMask');' Request 8 sql='delete from llx_commandedet where fk_commande in (select rowid from llx_commande where ref in ('(PROV)','ErrorBadMask'));' Request 9 sql='delete from llx_commande where ref in ('(PROV)','ErrorBadMask');' Request 10 sql='delete from llx_propaldet where fk_propal in (select rowid from llx_propal where ref in ('(PROV)','ErrorBadMask'));' Request 11 sql='delete from llx_propal where ref in ('(PROV)','ErrorBadMask');' Request 12 sql='delete from llx_facturedet where fk_facture in (select rowid from llx_facture where ref = '');' Request 13 sql='delete from llx_facture where ref = '';' Request 14 sql='delete from llx_commandedet where fk_commande in (select rowid from llx_commande where ref = '');' Request 15 sql='delete from llx_commande where ref = '';' Request 16 sql='delete from llx_propaldet where fk_propal in (select rowid from llx_propal where ref = '');' Request 17 sql='delete from llx_propal where ref = '';' Request 18 sql='delete from llx_deliverydet where fk_delivery in (select rowid from llx_delivery where ref = '');' Request 19 sql='delete from llx_delivery where ref = '';' Request 20 sql='delete from llx_expeditiondet where fk_expedition in (select rowid from llx_expedition where ref = '');' Request 21 sql='delete from llx_expedition where ref = '';' Request 22 sql='delete from llx_holiday_logs where fk_user_update not IN (select rowid from llx_user);' Request 23 sql='delete from llx_rights_def where perms IS NULL;' Request 24 sql='delete from llx_user_rights where fk_user not IN (select rowid from llx_user);' Request 25 sql='delete from llx_usergroup_rights where fk_usergroup not in (select rowid from llx_usergroup);' Request 26 sql='delete from llx_usergroup_rights where fk_id not in (select id from llx_rights_def);' Request 27 sql='update llx_deplacement set dated='2010-01-01' where dated < '2000-01-01';' Request 28 sql='update llx_subscription set fk_bank = null where fk_bank not in (select rowid from llx_bank);' Request 29 sql='update llx_propal set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 30 sql='update llx_commande set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 31 sql='update llx_facture set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 32 sql='update llx_commande_fournisseur set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 33 sql='update llx_contrat set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 34 sql='update llx_deplacement set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 35 sql='update llx_facture_fourn set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 36 sql='update llx_facture_rec set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 37 sql='update llx_fichinter set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 38 sql='update llx_projet_task set fk_projet = null where fk_projet not in (select rowid from llx_projet);' Request 39 sql='update llx_propal set fk_user_author = null where fk_user_author not in (select rowid from llx_user);' Request 40 sql='update llx_propal set fk_user_valid = null where fk_user_valid not in (select rowid from llx_user);' Request 41 sql='update llx_propal set fk_user_cloture = null where fk_user_cloture not in (select rowid from llx_user);' Request 42 sql='update llx_commande set fk_user_author = null where fk_user_author not in (select rowid from llx_user);' Request 43 sql='update llx_commande set fk_user_valid = null where fk_user_valid not in (select rowid from llx_user);' Request 44 sql='delete from llx_societe_extrafields where fk_object not in (select rowid from llx_societe);' Request 45 sql='delete from llx_adherent_extrafields where fk_object not in (select rowid from llx_adherent);' Request 46 sql='delete from llx_product_extrafields where fk_object not in (select rowid from llx_product);' Request 47 sql='UPDATE llx_product SET datec = tms WHERE datec IS NULL;' Request 48 sql='update llx_product_batch set batch = '' where batch = 'Non dfini';' Request 49 sql='update llx_product_batch set batch = '' where batch = 'Non dfini';' Request 50 sql='update llx_stock_mouvement set batch = null where batch = 'Non dfini';' Request 51 sql='update llx_stock_mouvement set batch = null where batch = 'Non dfini';' Request 52 sql='DELETE FROM llx_product_lot WHERE fk_product NOT IN (select rowid from llx_product);' Request 53 sql='DELETE FROM llx_product_stock WHERE fk_product NOT IN (select rowid from llx_product);' Request 54 sql='DELETE FROM llx_product_stock WHERE reel = 0 AND rowid NOT IN (SELECT fk_product_stock FROM llx_product_batch as pb);' Request 55 sql='DROP TABLE tmp_llx_product_batch;' Request 56 sql='DROP TABLE tmp_llx_product_batch2;' Request 57 sql='CREATE TABLE tmp_llx_product_batch AS select fk_product_stock, eatby, sellby, batch, SUM(qty) as qty, COUNT(rowid) as nb FROM llx_product_batch GROUP BY fk_product_stock, eatby, sellby, batch HAVING COUNT(rowid) > 1;' Request 58 sql='CREATE TABLE tmp_llx_product_batch2 AS select pb.rowid, pb.fk_product_stock, pb.eatby, pb.sellby, pb.batch, pb.qty from llx_product_batch as pb, tmp_llx_product_batch as tpb where pb.fk_product_stock = tpb.fk_product_stock and COALESCE(pb.eatby, '2000-01-01') = COALESCE(tpb.eatby,'2000-01-01') and COALESCE(pb.sellby, '2000-01-01') = COALESCE(tpb.sellby, '2000-01-01') and pb.batch = tpb.batch;' Request 59 sql='DELETE FROM llx_product_batch WHERE rowid IN (select rowid FROM tmp_llx_product_batch2);' Request 60 sql='INSERT INTO llx_product_batch(fk_product_stock, eatby, sellby, batch, qty) SELECT fk_product_stock, eatby, sellby, batch, qty FROM tmp_llx_product_batch;' Request 61 sql='DELETE FROM llx_product_stock WHERE reel = 0 AND rowid NOT IN (SELECT fk_product_stock FROM llx_product_batch as pb);' Request 62 sql='DELETE FROM llx_product_batch WHERE qty = 0;' Request 63 sql='UPDATE llx_product p SET p.stock= (SELECT SUM(ps.reel) FROM llx_product_stock ps WHERE ps.fk_product = p.rowid);' Request 64 sql='delete from llx_product_association where fk_product_pere NOT IN (select rowid from llx_product);' Request 65 sql='delete from llx_product_association where fk_product_fils NOT IN (select rowid from llx_product);' Request 66 sql='drop table tmp_categorie;' Request 67 sql='create table tmp_categorie as select * from llx_categorie;' Request 68 sql='delete from llx_categorie where fk_parent not in (select rowid from tmp_categorie) and fk_parent is not null and fk_parent <> 0;' Request 69 sql='drop table tmp_categorie;' Request 70 sql='delete from llx_categorie_product where fk_categorie not in (select rowid from llx_categorie where type = 0);' Request 71 sql='delete from llx_categorie_fournisseur where fk_categorie not in (select rowid from llx_categorie where type = 1);' Request 72 sql='delete from llx_categorie_societe where fk_categorie not in (select rowid from llx_categorie where type = 2);' Request 73 sql='delete from llx_categorie_member where fk_categorie not in (select rowid from llx_categorie where type = 3);' Request 74 sql='delete from llx_categorie_contact where fk_categorie not in (select rowid from llx_categorie where type = 4);' Request 75 sql='delete from llx_categorie_project where fk_categorie not in (select rowid from llx_categorie where type = 6);' Request 76 sql='delete from llx_ecm_files where src_object_type = 'expensereport' and src_object_id NOT IN (select rowid from llx_expensereport);' Request 77 sql='delete from llx_ecm_files where (src_object_type = 'contrat' OR src_object_type = 'contract') and src_object_id NOT IN (select rowid from llx_contrat);' Request 78 sql='delete from llx_deliverydet where fk_delivery not in (select fk_target from llx_element_element where targettype = 'delivery') AND fk_delivery not in (select fk_source from llx_element_element where sourcetype = 'delivery');' Request 79 sql='delete from llx_delivery where rowid not in (select fk_target from llx_element_element where targettype = 'delivery') AND rowid not in (select fk_source from llx_element_element where sourcetype = 'delivery');' Request 80 sql='delete from llx_element_element where targettype='shipping' and fk_target not in (select rowid from llx_expedition);' Request 81 sql='delete from llx_element_element where targettype='delivery' and fk_target not in (select rowid from llx_delivery);' Request 82 sql='delete from llx_element_element where targettype='propal' and fk_target not in (select rowid from llx_propal);' Request 83 sql='delete from llx_element_element where targettype='facture' and fk_target not in (select rowid from llx_facture);' Request 84 sql='delete from llx_element_element where targettype='commande' and fk_target not in (select rowid from llx_commande);' Request 85 sql='delete from llx_element_element where sourcetype='shipping' and fk_source not in (select rowid from llx_expedition);' Request 86 sql='delete from llx_element_element where sourcetype='delivery' and fk_source not in (select rowid from llx_delivery);' Request 87 sql='delete from llx_element_element where sourcetype='propal' and fk_source not in (select rowid from llx_propal);' Request 88 sql='delete from llx_element_element where sourcetype='facture' and fk_source not in (select rowid from llx_facture);' Request 89 sql='delete from llx_element_element where sourcetype='commande' and fk_source not in (select rowid from llx_commande);' Request 90 sql='DELETE FROM llx_actioncomm_resources WHERE fk_actioncomm not in (select id from llx_actioncomm);' Request 91 sql='DELETE from llx_bank_url where type = 'payment' and url_id not in (select rowid from llx_paiement);' Request 92 sql='DELETE from llx_bank_url where type = 'payment_supplier' and url_id not in (select rowid from llx_paiementfourn);' Request 93 sql='DELETE from llx_bank_url where type = 'company' and url_id not in (select rowid from llx_societe);' Request 94 sql='DELETE FROM llx_bank WHERE fk_account NOT IN (select rowid from llx_bank_account);' Request 95 sql='DROP table tmp_user;' Request 96 sql='CREATE TABLE tmp_user as (select * from llx_user);' Request 97 sql='UPDATE llx_user SET fk_user = NULL where fk_user NOT IN (select rowid from tmp_user);' Request 98 sql='UPDATE llx_product SET canvas = NULL where canvas = 'default@product';' Request 99 sql='UPDATE llx_product SET canvas = NULL where canvas = 'service@product';' Request 100 sql='DELETE FROM llx_boxes where box_id NOT IN (SELECT rowid FROM llx_boxes_def);' Request 101 sql='update llx_document_model set nom = 'typhon' where (nom = '' OR nom is null) and type = 'delivery';' Request 102 sql='DELETE FROM llx_document_model WHERE nom ='elevement' AND type='delivery';' Request 103 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 1, 'AC_TEL', 'system', 'Phone call' ,NULL, 2);' Request 104 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 2, 'AC_FAX', 'system', 'Send Fax' ,NULL, 3);' Request 105 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 3, 'AC_PROP', 'systemauto', 'Send commercial proposal by email' ,'propal', 10);' Request 106 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 4, 'AC_EMAIL', 'system', 'Send Email' ,NULL, 4);' Request 107 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 5, 'AC_RDV', 'system', 'Rendez-vous' ,NULL, 1);' Request 108 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 8, 'AC_COM', 'systemauto', 'Send customer order by email' ,'order', 8);' Request 109 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 9, 'AC_FAC', 'systemauto', 'Send customer invoice by email' ,'invoice', 6);' Request 110 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 10, 'AC_SHIP', 'systemauto', 'Send shipping by email' ,'shipping', 11);' Request 111 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 30, 'AC_SUP_ORD', 'systemauto', 'Send supplier order by email' ,'order_supplier', 9);' Request 112 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values (31, 'AC_SUP_INV', 'systemauto', 'Send supplier invoice by email' ,'invoice_supplier', 7);' Request 113 sql='insert into llx_c_actioncomm (id, code, type, libelle, module, position) values ( 50, 'AC_OTH', 'system', 'Other' ,NULL, 5);' Request 114 sql='DELETE FROM llx_boxes_def as T1 WHERE rowid NOT IN (SELECT min(rowid) FROM llx_boxes_def GROUP BY file, entity, note);' Request 115 sql='ALTER TABLE llx_product_fournisseur_price DROP COLUMN fk_product_fournisseur;' Request 116 sql='ALTER TABLE llx_product_fournisseur_price DROP FOREIGN KEY fk_product_fournisseur;' Request 117 sql='update llx_opensurvey_sondage set format = 'D' where format = 'D+';' Request 118 sql='update llx_opensurvey_sondage set format = 'A' where format = 'A+';' Request 119 sql='update llx_opensurvey_sondage set tms = now();' Request 120 sql='update llx_product set barcode = null where barcode in ('', '-1', '0');' Request 121 sql='update llx_societe set barcode = null where barcode in ('', '-1', '0');' Request 122 sql='drop table tmp_links_double;' Request 123 sql='create table tmp_links_double as (select objectid, label, max(rowid) as max_rowid, count(rowid) as count_rowid from llx_links where label is not null group by objectid, label having count(rowid) >= 2);' Request 124 sql='delete from llx_links where (rowid, label) in (select max_rowid, label from tmp_links_double);' Request 125 sql='drop table tmp_links_double;' Request 126 sql='drop table tmp_product_double;' Request 127 sql='create table tmp_product_double as (select barcode, max(rowid) as max_rowid, count(rowid) as count_rowid from llx_product where barcode is not null group by barcode having count(rowid) >= 2);' Request 128 sql='update llx_product set barcode = null where (rowid, barcode) in (select max_rowid, barcode from tmp_product_double);' Request 129 sql='drop table tmp_product_double;' Request 130 sql='drop table tmp_societe_double;' Request 131 sql='create table tmp_societe_double as (select barcode, max(rowid) as max_rowid, count(rowid) as count_rowid from llx_societe where barcode is not null group by barcode having count(rowid) >= 2);' Request 132 sql='update llx_societe set barcode = null where (rowid, barcode) in (select max_rowid, barcode from tmp_societe_double);' Request 133 sql='drop table tmp_societe_double;' Request 134 sql='drop table tmp_accounting_account_double;' Request 135 sql='create table tmp_accounting_account_double as (select account_number, fk_pcg_version, entity, max(rowid) as max_rowid, count(rowid) as count_rowid from llx_accounting_account where label is not null group by account_number, fk_pcg_version, entity having count(rowid) >= 2);' Request 136 sql='delete from llx_accounting_account where (rowid) in (select max_rowid from tmp_accounting_account_double);' Request 137 sql='drop table tmp_accounting_account_double;' Request 138 sql='UPDATE llx_projet_task SET fk_task_parent = 0 WHERE fk_task_parent = rowid;' Request 139 sql='UPDATE llx_actioncomm set fk_user_action = fk_user_done where fk_user_done > 0 and (fk_user_action is null or fk_user_action = 0);' Request 140 sql='UPDATE llx_actioncomm set fk_user_action = fk_user_author where fk_user_author > 0 and (fk_user_action is null or fk_user_action = 0);' Request 141 sql='UPDATE llx_element_time set element_datehour = element_date where element_datehour IS NULL and element_date IS NOT NULL;' Request 142 sql='UPDATE llx_projet set fk_opp_status = NULL where fk_opp_status = -1;' Request 143 sql='UPDATE llx_projet set fk_opp_status = (SELECT rowid FROM llx_c_lead_status WHERE code='PROSP') where fk_opp_status IS NULL and opp_amount > 0;' Request 144 sql='UPDATE llx_c_lead_status set code = 'WON' where code = 'WIN';' Request 145 sql='update llx_propaldet set product_type = 1 where product_type = 2;' Request 146 sql='update llx_commandedet set product_type = 1 where product_type = 2;' Request 147 sql='update llx_facturedet set product_type = 1 where product_type = 2;' Request 148 sql='update llx_propal set fk_statut = 1 where fk_statut = -1;' Request 149 sql='delete from llx_commande_fournisseur_dispatch where fk_commandefourndet = 0 or fk_commandefourndet IS NULL;' Request 150 sql='delete from llx_menu where menu_handler = 'smartphone';' Request 151 sql='update llx_expedition set date_valid = date_creation where fk_statut = 1 and date_valid IS NULL;' Request 152 sql='update llx_expedition set date_valid = NOW() where fk_statut = 1 and date_valid IS NULL;' Request 153 sql='update llx_projet_task as pt set pt.duration_effective = (select SUM(ptt.element_duration) as y from llx_element_time as ptt where ptt.fk_element = pt.rowid and ptt.elementtype = 'task') where pt.duration_effective <> (select SUM(ptt.element_duration) as y from llx_element_time as ptt where ptt.fk_element = pt.rowid and ptt.elementtype = 'task');' Request 154 sql='drop table tmp_c_shipment_mode;' Request 155 sql='create table tmp_c_shipment_mode as (select code, tracking from llx_c_shipment_mode);' Request 156 sql='DELETE FROM llx_c_shipment_mode where code IN (select code from tmp_c_shipment_mode WHERE tracking is NULL OR tracking = '') AND code IN (select code from tmp_c_shipment_mode WHERE tracking is NOT NULL AND tracking != '') AND (tracking IS NULL OR tracking = '');' Request 157 sql='drop table tmp_c_shipment_mode;' Request 158 sql='drop table tmp_bank_url_expense_user;' Request 159 sql='create table tmp_bank_url_expense_user (select e.fk_user_author, bu2.fk_bank from llx_expensereport as e, llx_bank_url as bu2 where bu2.url_id = e.rowid and bu2.type = 'payment_expensereport');' Error DB_ERROR_SYNTAX (Req 159): create table tmp_bank_url_expense_user (select e.fk_user_author, bu2.fk_bank from llx_expensereport as e, llx_bank_url as bu2 where bu2.url_id = e.rowid and bu2.type = 'payment_expensereport'); ERROR: 42601: syntax error at or near ""select"" LINE 1: create table tmp_bank_url_expense_user (select e.fk_user_aut ^ LOCATION: scanner_yyerror, scan.l:1145 Request 160 sql='update llx_bank_url as bu set url_id = (select e.fk_user_author from tmp_bank_url_expense_user as e where e.fk_bank = bu.fk_bank) where (bu.url_id = 0 OR bu.url_id IS NULL) and bu.type ='user';' Request 161 sql='drop table tmp_bank_url_expense_user;' Request 162 sql='DROP TABLE tmp_llx_accouting_account;' Request 163 sql='CREATE TABLE tmp_llx_accouting_account AS SELECT MIN(rowid) as MINID, account_number, entity, fk_pcg_version, count(*) AS NB FROM llx_accounting_account group BY account_number, entity, fk_pcg_version HAVING count(*) >= 2 order by account_number, entity, fk_pcg_version;' Request 164 sql='DELETE from llx_accounting_account where rowid in (select minid from tmp_llx_accouting_account where minid NOT IN (SELECT fk_code_ventilation from llx_facturedet) AND minid NOT IN (SELECT fk_code_ventilation from llx_facture_fourn_det) AND minid NOT IN (SELECT fk_code_ventilation from llx_expensereport_det));' Request 165 sql='ALTER TABLE llx_accounting_account DROP INDEX uk_accounting_account;' Request 166 sql='ALTER TABLE llx_accounting_account ADD UNIQUE INDEX uk_accounting_account (account_number, entity, fk_pcg_version);' Request 167 sql='UPDATE llx_facturedet SET fk_code_ventilation = 0 WHERE fk_code_ventilation > 0 AND fk_code_ventilation NOT IN (select rowid FROM llx_accounting_account);' Request 168 sql='UPDATE llx_facture_fourn_det SET fk_code_ventilation = 0 WHERE fk_code_ventilation > 0 AND fk_code_ventilation NOT IN (select rowid FROM llx_accounting_account);' Request 169 sql='UPDATE llx_expensereport_det SET fk_code_ventilation = 0 WHERE fk_code_ventilation > 0 AND fk_code_ventilation NOT IN (select rowid FROM llx_accounting_account);' Request 170 sql='UPDATE llx_chargesociales SET date_creation = tms WHERE date_creation IS NULL;' Request 171 sql='update llx_facturedet set product_type = 0 where product_type = 1 AND fk_product > 0 AND fk_product IN (SELECT rowid FROM llx_product WHERE fk_product_type = 0);' Request 172 sql='update llx_facturedet set product_type = 1 where product_type = 0 AND fk_product > 0 AND fk_product IN (SELECT rowid FROM llx_product WHERE fk_product_type = 1);' Request 173 sql='update llx_facture_fourn_det set product_type = 0 where product_type = 1 AND fk_product > 0 AND fk_product IN (SELECT rowid FROM llx_product WHERE fk_product_type = 0);' Request 174 sql='update llx_facture_fourn_det set product_type = 1 where product_type = 0 AND fk_product > 0 AND fk_product IN (SELECT rowid FROM llx_product WHERE fk_product_type = 1);' Request 175 sql='DELETE FROM llx_mrp_production where qty = 0;' Request 176 sql='UPDATE llx_accounting_bookkeeping set date_creation = tms where date_creation IS NULL;' Request 177 sql='UPDATE llx_facturedet SET multicurrency_subprice = -multicurrency_subprice WHERE ((multicurrency_subprice < 0 and subprice > 0) OR (multicurrency_subprice > 0 and subprice < 0));' Request 178 sql='UPDATE llx_facturedet SET multicurrency_total_ht = -multicurrency_total_ht WHERE ((multicurrency_total_ht < 0 and total_ht > 0) OR (multicurrency_total_ht > 0 and total_ht < 0));' Request 179 sql='UPDATE llx_facturedet SET multicurrency_total_tva = -multicurrency_total_tva WHERE ((multicurrency_total_tva < 0 and total_tva > 0) OR (multicurrency_total_tva > 0 and total_tva < 0));' Request 180 sql='UPDATE llx_facturedet SET multicurrency_total_ttc = -multicurrency_total_ttc WHERE ((multicurrency_total_ttc < 0 and total_ttc > 0) OR (multicurrency_total_ttc > 0 and total_ttc < 0));' Request 181 sql='UPDATE llx_facture SET multicurrency_total_ht = -multicurrency_total_ht WHERE ((multicurrency_total_ht < 0 and total_ht > 0) OR (multicurrency_total_ht > 0 and total_ht < 0));' Request 182 sql='UPDATE llx_facture SET multicurrency_total_tva = -multicurrency_total_tva WHERE ((multicurrency_total_tva < 0 and total_tva > 0) OR (multicurrency_total_tva > 0 and total_tva < 0));' Request 183 sql='UPDATE llx_facture SET multicurrency_total_ttc = -multicurrency_total_ttc WHERE ((multicurrency_total_ttc < 0 and total_ttc > 0) OR (multicurrency_total_ttc > 0 and total_ttc < 0));' Request 184 sql='UPDATE llx_facture_fourn_det SET multicurrency_subprice = -multicurrency_subprice WHERE ((multicurrency_subprice < 0 and pu_ht > 0) OR (multicurrency_subprice > 0 and pu_ht < 0));' Request 185 sql='UPDATE llx_facture_fourn_det SET multicurrency_total_ht = -multicurrency_total_ht WHERE ((multicurrency_total_ht < 0 and total_ht > 0) OR (multicurrency_total_ht > 0 and total_ht < 0));' Request 186 sql='UPDATE llx_facture_fourn_det SET multicurrency_total_tva = -multicurrency_total_tva WHERE ((multicurrency_total_tva < 0 and tva > 0) OR (multicurrency_total_tva > 0 and tva < 0));' Request 187 sql='UPDATE llx_facture_fourn_det SET multicurrency_total_ttc = -multicurrency_total_ttc WHERE ((multicurrency_total_ttc < 0 and total_ttc > 0) OR (multicurrency_total_ttc > 0 and total_ttc < 0));' Request 188 sql='UPDATE llx_facture_fourn SET multicurrency_total_ht = -multicurrency_total_ht WHERE ((multicurrency_total_ht < 0 and total_ht > 0) OR (multicurrency_total_ht > 0 and total_ht < 0));' Request 189 sql='UPDATE llx_facture_fourn SET multicurrency_total_tva = -multicurrency_total_tva WHERE ((multicurrency_total_tva < 0 and total_tva > 0) OR (multicurrency_total_tva > 0 and total_tva < 0));' Request 190 sql='UPDATE llx_facture_fourn SET multicurrency_total_ttc = -multicurrency_total_ttc WHERE ((multicurrency_total_ttc < 0 and total_ttc > 0) OR (multicurrency_total_ttc > 0 and total_ttc < 0));' Request 191 sql='UPDATE llx_facturedet SET situation_percent = 100 WHERE situation_percent IS NULL AND fk_prev_id IS NULL;' Request 192 sql='DELETE FROM llx_rights_def WHERE module = 'hrm' AND perms = 'employee';' Request 193 sql='DELETE FROM llx_c_transport_mode as T1 WHERE rowid NOT IN (SELECT min(rowid) FROM llx_c_transport_mode GROUP BY code, entity);' Request 194 sql='DELETE FROM llx_c_departements WHERE fk_region <> 0 AND fk_region IN (select code_region FROM llx_c_regions WHERE fk_pays NOT IN (select rowid from llx_c_country));' Request 195 sql='DELETE from llx_c_regions WHERE fk_pays NOT IN (select rowid from llx_c_country);' Request 196 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combination;' Request 197 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_2;' Request 198 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_3;' Request 199 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_4;' Request 200 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_5;' Request 201 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_6;' Request 202 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_7;' Request 203 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_8;' Request 204 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_9;' Request 205 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_10;' Request 206 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_11;' Request 207 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_12;' Request 208 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_13;' Request 209 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_14;' Request 210 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_15;' Request 211 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_16;' Request 212 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_17;' Request 213 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_18;' Request 214 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_19;' Request 215 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_20;' Request 216 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_21;' Request 217 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_22;' Request 218 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_23;' Request 219 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_24;' Request 220 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_25;' Request 221 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_26;' Request 222 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_27;' Request 223 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_28;' Request 224 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_29;' Request 225 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_30;' Request 226 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_31;' Request 227 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_32;' Request 228 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_33;' Request 229 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_34;' Request 230 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_35;' Request 231 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_36;' Request 232 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_37;' Request 233 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_38;' Request 234 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_39;' Request 235 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_40;' Request 236 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_41;' Request 237 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_42;' Request 238 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_43;' Request 239 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_44;' Request 240 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_45;' Request 241 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_46;' Request 242 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_47;' Request 243 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_48;' Request 244 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_49;' Request 245 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_50;' Request 246 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_51;' Request 247 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_52;' Request 248 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_53;' Request 249 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_54;' Request 250 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_55;' Request 251 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_56;' Request 252 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_57;' Request 253 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_58;' Request 254 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_59;' Request 255 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_60;' Request 256 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_61;' Request 257 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_62;' Request 258 sql='alter table llx_product_attribute_combination_price_level drop index fk_product_attribute_combinati_63;' Request 259 sql='ALTER TABLE llx_product_attribute_combination_price_level ADD UNIQUE INDEX uk_prod_att_comb_price_level(fk_product_attribute_combination, fk_price_level);'   Attached files _No response_ database-file database-file",no-bug,0.9
32206,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32206,Bug: Incorrect Discounts or Credit is applied in a multicurrency Invoice," Bug If an invoice is created in a currency other than Dolibarr installation's default currency and then when we apply the available discount or credit in this invoice then the discount line is inserted in this invoice without converting the discount/credit to the invoice currency  Dolibarr Version 20.0  Environment PHP 8.2  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Dolibarr default currency is USD 2. Create a customer with currency GBP 3. Add Absolute discount to this customer created in step 2. Absolute discount is created in USD as that is the only option in Dolibarr (e.g., 100 USD) 4. Create invoice for this customer in GBP (127 GBP). Conversion between USD to GBP is defined as 1.27 in the system. 5. Apply the discount in the invoice. Invoice will still show the unpaid amount  Attached files ![image](https://github.com/user-attachments/assets/16903c3e-47a1-4e4d-95a7-64dfcc2596ee)",other-file | other-file | other-file | other-file | other-file,"Bug: Incorrect Discounts or Credit is applied in a multicurrency Invoice  Bug If an invoice is created in a currency other than Dolibarr installation's default currency and then when we apply the available discount or credit in this invoice then the discount line is inserted in this invoice without converting the discount/credit to the invoice currency  Dolibarr Version 20.0  Environment PHP 8.2  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. Dolibarr default currency is USD 2. Create a customer with currency GBP 3. Add Absolute discount to this customer created in step 2. Absolute discount is created in USD as that is the only option in Dolibarr (e.g., 100 USD) 4. Create invoice for this customer in GBP (127 GBP). Conversion between USD to GBP is defined as 1.27 in the system. 5. Apply the discount in the invoice. Invoice will still show the unpaid amount  Attached files ![image](https://github.com/user-attachments/assets/16903c3e-47a1-4e4d-95a7-64dfcc2596ee) other-file other-file other-file other-file other-file",no-bug,0.9
25275,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25275,Migration 12.0 - 13.0 forget tms update field for emailcollector," Bug Here is the problem, detected on dolibarr 17.0 but ""old"" install updated from version < 12  sql=INSERT INTO llx_emailcollector_emailcollector (entity, ref, label, description, source_directory, date_creation, fk_user_creat, status) VALUES (1, 'Collect_Ticket_Requests', 'Exemple de collecte de d\'email pour ticket (premier message uniquement)', 'Collectez les e-mails qui correspondent &agrave; certaines r&egrave;gles et cr&eacute;ez automatiquement un ticket (Module Ticket doit &ecirc;tre activ&eacute;) avec les informations de l\'e-mail. Vous pouvez utiliser ce collecteur si vous fournissez une assistance par e-mail, ainsi votre demande de ticket sera automatiquement g&eacute;n&eacute;r&eacute;e. Activez &eacute;galement Collect_Responses pour collecter les r&eacute;ponses de votre client directement sur la vue du ticket (vous devez r&eacute;pondre depuis Dolibarr).', 'INBOX', '2023-07-05 11:21:39', 1, 0) DoliDBMysqli::query SQL Error message: DB_ERROR_1364 Field 'tms' doesn't have a default value   Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior There is a problem on migration database from 12 to 13 on llx_emailcollector_emailcollector table: dolibarr 12  / tms timestamp, /  dolibarr 13  / tms timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, /  and there is no ALTER on migration sql file  Steps to reproduce the behavior _No response_  Attached files _No response_",database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file,"Migration 12.0 - 13.0 forget tms update field for emailcollector  Bug Here is the problem, detected on dolibarr 17.0 but ""old"" install updated from version < 12  sql=INSERT INTO llx_emailcollector_emailcollector (entity, ref, label, description, source_directory, date_creation, fk_user_creat, status) VALUES (1, 'Collect_Ticket_Requests', 'Exemple de collecte de d\'email pour ticket (premier message uniquement)', 'Collectez les e-mails qui correspondent &agrave; certaines r&egrave;gles et cr&eacute;ez automatiquement un ticket (Module Ticket doit &ecirc;tre activ&eacute;) avec les informations de l\'e-mail. Vous pouvez utiliser ce collecteur si vous fournissez une assistance par e-mail, ainsi votre demande de ticket sera automatiquement g&eacute;n&eacute;r&eacute;e. Activez &eacute;galement Collect_Responses pour collecter les r&eacute;ponses de votre client directement sur la vue du ticket (vous devez r&eacute;pondre depuis Dolibarr).', 'INBOX', '2023-07-05 11:21:39', 1, 0) DoliDBMysqli::query SQL Error message: DB_ERROR_1364 Field 'tms' doesn't have a default value   Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior There is a problem on migration database from 12 to 13 on llx_emailcollector_emailcollector table: dolibarr 12  / tms timestamp, /  dolibarr 13  / tms timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, /  and there is no ALTER on migration sql file  Steps to reproduce the behavior _No response_  Attached files _No response_ database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file database-file",no-bug,0.9
29035,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29035,"Converting customer order to supplier order, customers payment terms are used instead of supplier terms", Bug When converting a customer order to a supplier order the payment terms are incorrect. The payment terms of the customer are used insted of the payment terms of the supplier.  Dolibarr Version 19.0.1 running on Windows11  Environment PHP 7.3.33  Environment Database mariadb 10.6.5  Steps to reproduce the behavior and expected behavior - Navigate to customer order - Create a supplier order out of the customer order - After the supplier order is generated you can see the wrong payment terms.  Attached files _No response_,other-file,"Converting customer order to supplier order, customers payment terms are used instead of supplier terms  Bug When converting a customer order to a supplier order the payment terms are incorrect. The payment terms of the customer are used insted of the payment terms of the supplier.  Dolibarr Version 19.0.1 running on Windows11  Environment PHP 7.3.33  Environment Database mariadb 10.6.5  Steps to reproduce the behavior and expected behavior - Navigate to customer order - Create a supplier order out of the customer order - After the supplier order is generated you can see the wrong payment terms.  Attached files _No response_ other-file",no-bug,0.9
31159,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31159,TVA Account by country is not used," Bug When you are in the mode SERVICE_ARE_ECOMMERCE_200238EC activated, you must vetiled TVA on account spcified here : /admin/dict.php?id=10&from=accountancy&search_country_id=1&mainmenu=accountancy&leftmenu=accountancy_admin But it doesn't work and return the seller country account. I think we need to add condition on the **SERVICE_ARE_ECOMMERCE_200238EC** in the **getTaxedFromId** function in core/lib/functions.lib.php line 6597. And use `$buyer->country_code rather than seller->country_code` And when this function is called line 227 in accountancy/journal/sellsjournal.php, change : `$vatdata = getTaxesFromId($tax_id, $mysoc, $mysoc, 0); ` by `$vatdata = getTaxesFromId($tax_id, $mysoc, $thirdparty, 0);` we need to create a $thirdparty object just before. In fact if we want to respect UE legacy, we need to use delivery country address linked into the invoice contact and if not, use the thirdparty country. see : https://www.impots.gouv.fr/professionnel/achatvente-de-biens  Dolibarr Version 19.3  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"TVA Account by country is not used  Bug When you are in the mode SERVICE_ARE_ECOMMERCE_200238EC activated, you must vetiled TVA on account spcified here : /admin/dict.php?id=10&from=accountancy&search_country_id=1&mainmenu=accountancy&leftmenu=accountancy_admin But it doesn't work and return the seller country account. I think we need to add condition on the **SERVICE_ARE_ECOMMERCE_200238EC** in the **getTaxedFromId** function in core/lib/functions.lib.php line 6597. And use `$buyer->country_code rather than seller->country_code` And when this function is called line 227 in accountancy/journal/sellsjournal.php, change : `$vatdata = getTaxesFromId($tax_id, $mysoc, $mysoc, 0); ` by `$vatdata = getTaxesFromId($tax_id, $mysoc, $thirdparty, 0);` we need to create a $thirdparty object just before. In fact if we want to respect UE legacy, we need to use delivery country address linked into the invoice contact and if not, use the thirdparty country. see : https://www.impots.gouv.fr/professionnel/achatvente-de-biens  Dolibarr Version 19.3  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
30576,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30576,Salary payment date not displayed in card, Bug When looking at the card of a salary payment the date is not displayed. Thus editing is working.  Dolibarr Version 19.01  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior look at a salary payment  Attached files _No response_,other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,Salary payment date not displayed in card  Bug When looking at the card of a salary payment the date is not displayed. Thus editing is working.  Dolibarr Version 19.01  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior look at a salary payment  Attached files _No response_ other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file,no-bug,0.9
24985,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24985,Thirdparty merging doesn't work if Donation module or Ticket module is not activated," Bug When trying to merge two thirdparties: - if Donation module is not activated then Dolibarr throws an error message stating that table `dolibarr.llx_don` doesn't exist. - if Ticket module is not activated then Dolibarr throws an error message stating that table `dolibarr.llx_ticket` doesn't exist. Activating both modules solves the issue but is probably not the right behaviour. Refer also to this message on the French Dolibarr forum: [Fusion de tiers table dont exist](https://www.dolibarr.fr/forum/t/fusion-de-tiers-table-dont-exist/41814).  Environment Version 16.0.5  Environment OS Linux  Environment Web server Apache  Environment PHP 7.4  Environment Database MariaDB  Environment URL(s) _No response_  Expected and actual behavior Thirdparties shall merge flawlessly, with no error message prompted.  Steps to reproduce the behavior  Step 1 - Go to a thirdparty card (/societe/card.php?socid=n) - Click ""Merge"". - Select the thirdparty to be merged with. - Click Yes. Dolibarr prompts an error message:  Table 'dolibarr.llx_don' doesn't exist Echec de la fusion de 2 enregistrements. Demande annule.  (please also note that the first sentence of the error message is not translated).  Step 2 - Activate the Donation module. - Repeat Step 1. Dolibarr prompts another error message:  Table 'dolibarr.llx_ticket' doesn't exist Echec de la fusion de 2 enregistrements. Demande annule.    Step 3 - Activate the Ticket module. - Repeat Step 1. Now Dolibarr prompts an OK message: `Les tiers ont t fusionns`.  Attached files _No response_",other-file | other-file,"Thirdparty merging doesn't work if Donation module or Ticket module is not activated  Bug When trying to merge two thirdparties: - if Donation module is not activated then Dolibarr throws an error message stating that table `dolibarr.llx_don` doesn't exist. - if Ticket module is not activated then Dolibarr throws an error message stating that table `dolibarr.llx_ticket` doesn't exist. Activating both modules solves the issue but is probably not the right behaviour. Refer also to this message on the French Dolibarr forum: [Fusion de tiers table dont exist](https://www.dolibarr.fr/forum/t/fusion-de-tiers-table-dont-exist/41814).  Environment Version 16.0.5  Environment OS Linux  Environment Web server Apache  Environment PHP 7.4  Environment Database MariaDB  Environment URL(s) _No response_  Expected and actual behavior Thirdparties shall merge flawlessly, with no error message prompted.  Steps to reproduce the behavior  Step 1 - Go to a thirdparty card (/societe/card.php?socid=n) - Click ""Merge"". - Select the thirdparty to be merged with. - Click Yes. Dolibarr prompts an error message:  Table 'dolibarr.llx_don' doesn't exist Echec de la fusion de 2 enregistrements. Demande annule.  (please also note that the first sentence of the error message is not translated).  Step 2 - Activate the Donation module. - Repeat Step 1. Dolibarr prompts another error message:  Table 'dolibarr.llx_ticket' doesn't exist Echec de la fusion de 2 enregistrements. Demande annule.    Step 3 - Activate the Ticket module. - Repeat Step 1. Now Dolibarr prompts an OK message: `Les tiers ont t fusionns`.  Attached files _No response_ other-file other-file",no-bug,0.9
33863,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33863,Error urlencode(): Passing null to parameter #1 ($string) of type string is deprecated (/core/tpl/extrafields_list_search_param.tpl.php:53)," Bug PHP reports an error on /core/tpl/extrafields_list_search_param.tpl.php:53 when $val is null  Dolibarr Version 21.0.1  Environment PHP 8.2  Environment Database mariaDB 11.4  Steps to reproduce the behavior and expected behavior - Create a 'Complementary attribute' of String (1 Line) type. - On the list view, activate de complementary attibute. Now when a registrer has its complementary attribute empty, the error is logged on DebugBar You must activate the DegubBar and DebugLogs modules to see the log  Attached files _No response_",other-file | other-file | other-file,"Error urlencode(): Passing null to parameter #1 ($string) of type string is deprecated (/core/tpl/extrafields_list_search_param.tpl.php:53)  Bug PHP reports an error on /core/tpl/extrafields_list_search_param.tpl.php:53 when $val is null  Dolibarr Version 21.0.1  Environment PHP 8.2  Environment Database mariaDB 11.4  Steps to reproduce the behavior and expected behavior - Create a 'Complementary attribute' of String (1 Line) type. - On the list view, activate de complementary attibute. Now when a registrer has its complementary attribute empty, the error is logged on DebugBar You must activate the DegubBar and DebugLogs modules to see the log  Attached files _No response_ other-file other-file other-file",no-bug,0.9
29470,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29470,We can no longer relate if the previously free format had not been initiated in YYYMM," Bug see that : https://github.com/Dolibarr/dolibarr/commit/65b0086cfb7b5cd666a1f523397f89bd9aac27ff @klugfr said : Could it be possible to have a way to disable/enable this from the admin? We've been naming our bank receipt according to the bank for years. For this month we have for example: BPOP202310, SG202310, CIC202310, etc. Forcing this change means changing our naming convention and that all bank receipts for the same month will have the same name (YYYYMM), less easy to read/check.  Dolibarr Version 19  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"We can no longer relate if the previously free format had not been initiated in YYYMM  Bug see that : https://github.com/Dolibarr/dolibarr/commit/65b0086cfb7b5cd666a1f523397f89bd9aac27ff @klugfr said : Could it be possible to have a way to disable/enable this from the admin? We've been naming our bank receipt according to the bank for years. For this month we have for example: BPOP202310, SG202310, CIC202310, etc. Forcing this change means changing our naming convention and that all bank receipts for the same month will have the same name (YYYYMM), less easy to read/check.  Dolibarr Version 19  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
32155,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32155,Error forging a SQL request on page eventorganization/conferenceorboothattendee_list.php," Bug Error forging a SQL request on page eventorganization/conferenceorboothattendee_list.php  Dolibarr Version 20.0  Environment PHP n/a  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Enable module event organization 2. Create a new project and select ""used for event organization"" 3. Navigate to the project and select card ""event organization"". 4. Select ""participants"" 5. You should now be on the page eventorganization/conferenceorboothattendee_list.php and see the error message ""Error forging a SQL request""  Attached files <img width=""1431"" alt=""Bildschirmfoto 2024-11-29 um 18 06 01"" src=""https://github.com/user-attachments/assets/ca9354e0-8048-4a58-b2c7-a7b3bad72e0c"">",other-file | other-file,"Error forging a SQL request on page eventorganization/conferenceorboothattendee_list.php  Bug Error forging a SQL request on page eventorganization/conferenceorboothattendee_list.php  Dolibarr Version 20.0  Environment PHP n/a  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Enable module event organization 2. Create a new project and select ""used for event organization"" 3. Navigate to the project and select card ""event organization"". 4. Select ""participants"" 5. You should now be on the page eventorganization/conferenceorboothattendee_list.php and see the error message ""Error forging a SQL request""  Attached files <img width=""1431"" alt=""Bildschirmfoto 2024-11-29 um 18 06 01"" src=""https://github.com/user-attachments/assets/ca9354e0-8048-4a58-b2c7-a7b3bad72e0c""> other-file other-file",no-bug,0.9
27771,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27771,vcard issues, Bug The vcard feature is very prominent now in in version 18- There are some issues: - [ ] encoding issue (problems with umlauts in vcf download file) - [ ] email is not usermail but company mail - [ ] personal address in vcf file -- should at least be selectable to use company address  Environment Version 18.x (git)  Environment OS linux  Environment Web server apache  Environment PHP 7.4/8.1 Replaces #16945,other-file | other-file | other-file | other-file | other-file,vcard issues  Bug The vcard feature is very prominent now in in version 18- There are some issues: - [ ] encoding issue (problems with umlauts in vcf download file) - [ ] email is not usermail but company mail - [ ] personal address in vcf file -- should at least be selectable to use company address  Environment Version 18.x (git)  Environment OS linux  Environment Web server apache  Environment PHP 7.4/8.1 Replaces #16945 other-file other-file other-file other-file other-file,no-bug,0.9
23383,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23383,Bug: Internal Error 500 on a Sales Order Position changing, Bug ![image](https://user-images.githubusercontent.com/78662388/210172693-f4a0aaa6-557c-4044-a0cf-27938e0c9b16.png) ![image](https://user-images.githubusercontent.com/78662388/210172705-806e6efc-1828-4205-bfbf-90de4d82571a.png)  Environment Version 18  Environment OS Windows 10  Environment Web server xampp  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file,Bug: Internal Error 500 on a Sales Order Position changing  Bug ![image](https://user-images.githubusercontent.com/78662388/210172693-f4a0aaa6-557c-4044-a0cf-27938e0c9b16.png) ![image](https://user-images.githubusercontent.com/78662388/210172705-806e6efc-1828-4205-bfbf-90de4d82571a.png)  Environment Version 18  Environment OS Windows 10  Environment Web server xampp  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file,no-bug,0.7
32840,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32840,BUG: Unknown column 't.ref' in 'field list' object link to category for a project," Bug I added a complementary attribute to my projects, an link to an object with this definition: `Categorie:categories/class/categorie.class.php` ![Image](https://github.com/user-attachments/assets/ba200df4-17d9-4505-a1eb-fddb0460d66a) And I got this error in the GUI when I tried to modify a project, even before trying to modify this new complementary attribute. ![Image](https://github.com/user-attachments/assets/913854e4-0ee6-4ec8-b144-7d53a494443f) In dolibarr.log I got this error:  2025-01-28 22:24:11 WARNING 10.0.2.100 9354 33 functions::dol_include_once Tried to load unexisting file: /categorie/class/categorie.class.php 2025-01-28 22:24:11 ERR 10.0.2.100 9354 33 DoliDBMysqli::query Exception in query instead of returning an error: Unknown column 't.ref' in 'field list' 2025-01-28 22:24:11 ERR 10.0.2.100 9354 33 DoliDBMysqli::query SQL Error query: SELECT t.rowid, t.ref FROM llx_categorie as t WHERE 1=1 ORDER BY t.ref ASC 2025-01-28 22:24:11 ERR 10.0.2.100 9354 33 DoliDBMysqli::query SQL Error message: DB_ERROR_NOSUCHFIELD Unknown column 't.ref' in 'field list' From /var/www/html/core/class/html.form.class.php:8547. 2025-01-28 22:24:11 ERR 10.0.2.100 9354 33 Error url=/projet/card.php?action=edit&amp;token=&amp;id=21, query_string=action=edit&amp;token=&amp;id=21,  but after doing this command `ln -s categories/ categorie` the WARNING disappeared. But the error message is still there, The text of the GUI error message is  This website or feature is currently temporarily not available or failed after a technical error. This may be due to a maintenance operation. Current status of operation (2025-01-28T23:26:18Z) are on next line Dolibarr has detected a technical error. You can read log file or set option $dolibarr_main_prod to '0' in your config file to get more information.   Dolibarr Version v.20.0.2 docker image  Environment PHP v.20.0.2 docker image  Environment Database MariaDB 11.5.2-MariaDB-ubu2404  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"BUG: Unknown column 't.ref' in 'field list' object link to category for a project  Bug I added a complementary attribute to my projects, an link to an object with this definition: `Categorie:categories/class/categorie.class.php` ![Image](https://github.com/user-attachments/assets/ba200df4-17d9-4505-a1eb-fddb0460d66a) And I got this error in the GUI when I tried to modify a project, even before trying to modify this new complementary attribute. ![Image](https://github.com/user-attachments/assets/913854e4-0ee6-4ec8-b144-7d53a494443f) In dolibarr.log I got this error:  2025-01-28 22:24:11 WARNING 10.0.2.100 9354 33 functions::dol_include_once Tried to load unexisting file: /categorie/class/categorie.class.php 2025-01-28 22:24:11 ERR 10.0.2.100 9354 33 DoliDBMysqli::query Exception in query instead of returning an error: Unknown column 't.ref' in 'field list' 2025-01-28 22:24:11 ERR 10.0.2.100 9354 33 DoliDBMysqli::query SQL Error query: SELECT t.rowid, t.ref FROM llx_categorie as t WHERE 1=1 ORDER BY t.ref ASC 2025-01-28 22:24:11 ERR 10.0.2.100 9354 33 DoliDBMysqli::query SQL Error message: DB_ERROR_NOSUCHFIELD Unknown column 't.ref' in 'field list' From /var/www/html/core/class/html.form.class.php:8547. 2025-01-28 22:24:11 ERR 10.0.2.100 9354 33 Error url=/projet/card.php?action=edit&amp;token=&amp;id=21, query_string=action=edit&amp;token=&amp;id=21,  but after doing this command `ln -s categories/ categorie` the WARNING disappeared. But the error message is still there, The text of the GUI error message is  This website or feature is currently temporarily not available or failed after a technical error. This may be due to a maintenance operation. Current status of operation (2025-01-28T23:26:18Z) are on next line Dolibarr has detected a technical error. You can read log file or set option $dolibarr_main_prod to '0' in your config file to get more information.   Dolibarr Version v.20.0.2 docker image  Environment PHP v.20.0.2 docker image  Environment Database MariaDB 11.5.2-MariaDB-ubu2404  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.8
30516,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30516,Error: When creating an invoice for a supplier order with a negative value," Bug <h2>Guide to reproduce the error:</h2> When you try to create an invoice for an order with a negative value, an error occurs: ![image](https://github.com/user-attachments/assets/2c9f231c-5f90-4218-9fb0-8556486cd991) I proceed to create the invoice: ![image](https://github.com/user-attachments/assets/a1117247-af72-4409-b3b7-23396d3a86e0) I create the invoice: ![image](https://github.com/user-attachments/assets/4527f897-e343-485a-b36d-5e74d025aa9c) <h2> the error:</h2> ![image](https://github.com/user-attachments/assets/647d964c-c626-4ed3-9878-50127ec9fa2f) <h2>Cause of the error</h2> The error occurs when using instantiate the DiscountAbsolute object on line 471 of the htdocs/fourn/commande/list.php file. <h2>The solution:</h2> To fix the error, you must import the class file of the instance that initially produces the error. (require_once DOL_DOCUMENT_ROOT.'/core/class/discount.class.php';)  Dolibarr Version 19.2  Environment PHP 8.1.29  Environment Database 10.2.44-MariaDB  Steps to reproduce the behavior and expected behavior ![image](https://github.com/user-attachments/assets/2c9f231c-5f90-4218-9fb0-8556486cd991) I proceed to create the invoice: ![image](https://github.com/user-attachments/assets/a1117247-af72-4409-b3b7-23396d3a86e0) I create the invoice: ![image](https://github.com/user-attachments/assets/4527f897-e343-485a-b36d-5e74d025aa9c) Error: ![image](https://github.com/user-attachments/assets/647d964c-c626-4ed3-9878-50127ec9fa2f)  Attached files _No response_",other-file,"Error: When creating an invoice for a supplier order with a negative value  Bug <h2>Guide to reproduce the error:</h2> When you try to create an invoice for an order with a negative value, an error occurs: ![image](https://github.com/user-attachments/assets/2c9f231c-5f90-4218-9fb0-8556486cd991) I proceed to create the invoice: ![image](https://github.com/user-attachments/assets/a1117247-af72-4409-b3b7-23396d3a86e0) I create the invoice: ![image](https://github.com/user-attachments/assets/4527f897-e343-485a-b36d-5e74d025aa9c) <h2> the error:</h2> ![image](https://github.com/user-attachments/assets/647d964c-c626-4ed3-9878-50127ec9fa2f) <h2>Cause of the error</h2> The error occurs when using instantiate the DiscountAbsolute object on line 471 of the htdocs/fourn/commande/list.php file. <h2>The solution:</h2> To fix the error, you must import the class file of the instance that initially produces the error. (require_once DOL_DOCUMENT_ROOT.'/core/class/discount.class.php';)  Dolibarr Version 19.2  Environment PHP 8.1.29  Environment Database 10.2.44-MariaDB  Steps to reproduce the behavior and expected behavior ![image](https://github.com/user-attachments/assets/2c9f231c-5f90-4218-9fb0-8556486cd991) I proceed to create the invoice: ![image](https://github.com/user-attachments/assets/a1117247-af72-4409-b3b7-23396d3a86e0) I create the invoice: ![image](https://github.com/user-attachments/assets/4527f897-e343-485a-b36d-5e74d025aa9c) Error: ![image](https://github.com/user-attachments/assets/647d964c-c626-4ed3-9878-50127ec9fa2f)  Attached files _No response_ other-file",no-bug,0.9
23795,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23795,External users are not able to open proposals, Bug External users are not able to open proposals  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior External users should be able to open proposals if they have the permission  Steps to reproduce the behavior 1. Create an external user 2. Try to open a proposal  Attached files _No response_,other-file | other-file,External users are not able to open proposals  Bug External users are not able to open proposals  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior External users should be able to open proposals if they have the permission  Steps to reproduce the behavior 1. Create an external user 2. Try to open a proposal  Attached files _No response_ other-file other-file,no-bug,0.7
23392,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23392,Bug: No AJAX result's on product selection at a new BOM (endless turning), Bug ![image](https://user-images.githubusercontent.com/78662388/210274270-045b2002-461f-442a-b9fa-2939e8a2cfdc.png)  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) /bom/bom_card.php?leftmenu=bom&action=create  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,Bug: No AJAX result's on product selection at a new BOM (endless turning)  Bug ![image](https://user-images.githubusercontent.com/78662388/210274270-045b2002-461f-442a-b9fa-2939e8a2cfdc.png)  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) /bom/bom_card.php?leftmenu=bom&action=create  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file,no-bug,0.8
23531,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23531,v16.0.3 : Unable to update BomLines from the import file," Bug From the import ""Bill of Materials lines"" page URL : https://xxxx/imports/import.php?step=2&datatoimport=bom_lines_2&excludefirstline=2&enclosure=%22 The template doesn't include the Bomline ID wich should be used to update lines. As of today only creation of lines can be made from the import screen.  Environment Version 16.0.3  Environment OS Debian  Environment Web server Apache2  Environment PHP 7.4  Environment Database MySQL  Environment URL(s) https://xxxx/imports/import.php?step=2&datatoimport=bom_lines_2  Expected and actual behavior The template should add a ""BOMLINE ID"" in order to be able to update the bom lines  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"v16.0.3 : Unable to update BomLines from the import file  Bug From the import ""Bill of Materials lines"" page URL : https://xxxx/imports/import.php?step=2&datatoimport=bom_lines_2&excludefirstline=2&enclosure=%22 The template doesn't include the Bomline ID wich should be used to update lines. As of today only creation of lines can be made from the import screen.  Environment Version 16.0.3  Environment OS Debian  Environment Web server Apache2  Environment PHP 7.4  Environment Database MySQL  Environment URL(s) https://xxxx/imports/import.php?step=2&datatoimport=bom_lines_2  Expected and actual behavior The template should add a ""BOMLINE ID"" in order to be able to update the bom lines  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
25671,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25671,Error 500 when cloning a product," Bug A 500 error appears when cloning a product. Tested on several environments, the result is always the same  Environment Version 18.0.0  Environment OS Linux  Environment Web server Apache/2.4.37 () Phusion_Passenger/6.0.14  Environment PHP 7.4  Environment Database MySQL or MariaDB 8.0.33-cll-lve  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Test to clone a product  Attached files _No response_",other-file | other-file,"Error 500 when cloning a product  Bug A 500 error appears when cloning a product. Tested on several environments, the result is always the same  Environment Version 18.0.0  Environment OS Linux  Environment Web server Apache/2.4.37 () Phusion_Passenger/6.0.14  Environment PHP 7.4  Environment Database MySQL or MariaDB 8.0.33-cll-lve  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Test to clone a product  Attached files _No response_ other-file other-file",no-bug,0.7
30274,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30274,before the ajax line the reference to the error function is missing from dolibarr 13 to current,"https://github.com/Dolibarr/dolibarr/blob/ac136ec1aeee17edf8ab5f02e567fabdbb320600/htdocs/main.inc.php#L1814 current if (GETPOST('dol_resetcache')) { dolibarr_set_const($db, ""MAIN_IHM_PARAMS_REV"", getDolGlobalInt('MAIN_IHM_PARAMS_REV') + 1, 'chaine', 0, '', $conf->entity); } correction if (GETPOST('dol_resetcache')) { include_once DOL_DOCUMENT_ROOT.'/core/lib/admin.lib.php'; dolibarr_set_const($db, ""MAIN_IHM_PARAMS_REV"", getDolGlobalInt('MAIN_IHM_PARAMS_REV') + 1, 'chaine', 0, '', $conf->entity); }",other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"before the ajax line the reference to the error function is missing from dolibarr 13 to current https://github.com/Dolibarr/dolibarr/blob/ac136ec1aeee17edf8ab5f02e567fabdbb320600/htdocs/main.inc.php#L1814 current if (GETPOST('dol_resetcache')) { dolibarr_set_const($db, ""MAIN_IHM_PARAMS_REV"", getDolGlobalInt('MAIN_IHM_PARAMS_REV') + 1, 'chaine', 0, '', $conf->entity); } correction if (GETPOST('dol_resetcache')) { include_once DOL_DOCUMENT_ROOT.'/core/lib/admin.lib.php'; dolibarr_set_const($db, ""MAIN_IHM_PARAMS_REV"", getDolGlobalInt('MAIN_IHM_PARAMS_REV') + 1, 'chaine', 0, '', $conf->entity); } other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
26508,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26508,Delivery Receipt could not saved after updating, Bug After uptating from 17.0.3 to 18.0.3 after updating from 17.0.3 to 18.0.3 delivery receipt could be issued but when click in the same sales order again there is no delivery receipt nor tab and i have to create another one the folder permission is correct as i can create and find the related file moreover in shipments->list the column [Ref Delivery] is empty. It used to show and link to the delivery receipt Please note as well that tab delivery receipt is no more translated (we use Italian) and shown as stock receipt. In addition the list of shipments shows the same expedition as many times as per every delivery receipt created. this issue appears on fresh intallation as well in 18.0.3 and 19.0 more on this [https://www.dolibarr.org/forum/t/delivery-receipt-could-not-saved-after-updating/24245](https://www.dolibarr.org/forum/t/delivery-receipt-could-not-saved-after-updating/24245)  Environment Version 18.0.1 +  Environment OS freeBSD 12.4  Environment Web server apache  Environment PHP 8.1  Environment Database 10.6-MariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior update from 17.0.3 to 18.0.3 or fresh installation `git clone https://github.com/Dolibarr/dolibarr.git cd dolibarr git checkout 18.0` testing with 18.0.3 testing with 19.0 `git checkout develop`  Attached files _No response_,other-file | other-file | other-file,Delivery Receipt could not saved after updating  Bug After uptating from 17.0.3 to 18.0.3 after updating from 17.0.3 to 18.0.3 delivery receipt could be issued but when click in the same sales order again there is no delivery receipt nor tab and i have to create another one the folder permission is correct as i can create and find the related file moreover in shipments->list the column [Ref Delivery] is empty. It used to show and link to the delivery receipt Please note as well that tab delivery receipt is no more translated (we use Italian) and shown as stock receipt. In addition the list of shipments shows the same expedition as many times as per every delivery receipt created. this issue appears on fresh intallation as well in 18.0.3 and 19.0 more on this [https://www.dolibarr.org/forum/t/delivery-receipt-could-not-saved-after-updating/24245](https://www.dolibarr.org/forum/t/delivery-receipt-could-not-saved-after-updating/24245)  Environment Version 18.0.1 +  Environment OS freeBSD 12.4  Environment Web server apache  Environment PHP 8.1  Environment Database 10.6-MariaDB  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior update from 17.0.3 to 18.0.3 or fresh installation `git clone https://github.com/Dolibarr/dolibarr.git cd dolibarr git checkout 18.0` testing with 18.0.3 testing with 19.0 `git checkout develop`  Attached files _No response_ other-file other-file other-file,no-bug,0.8
25780,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25780,Miscellaneous payment in billing/payment is broken with PHP 8+, Bug The miscellaneous payment page appears blank when using PHP 8+ but works fine on PHP 7.4  Environment Version 18.0.0 - 18.0.1  Environment OS Ubuntu 22.04 LTS  Environment Web server Apache/2.4.57  Environment PHP 8.0 - 8.2  Environment Database MariaDB 10.11.5  Environment URL(s) /compta/bank/various_payment/list.php?leftmenu=tax_various&mainmenu=billing  Expected and actual behavior Expected behavior : The page should list all the recorded miscellaneous payments. Actual behavior : The page is broken  Steps to reproduce the behavior /compta/bank/various_payment/list.php?leftmenu=tax_various&mainmenu=billing  Attached files ![Screenshot_1](https://github.com/Dolibarr/dolibarr/assets/131163465/5a71e2fe-6ed4-457a-9ec8-b7bbd6f5fe9a),other-file,Miscellaneous payment in billing/payment is broken with PHP 8+  Bug The miscellaneous payment page appears blank when using PHP 8+ but works fine on PHP 7.4  Environment Version 18.0.0 - 18.0.1  Environment OS Ubuntu 22.04 LTS  Environment Web server Apache/2.4.57  Environment PHP 8.0 - 8.2  Environment Database MariaDB 10.11.5  Environment URL(s) /compta/bank/various_payment/list.php?leftmenu=tax_various&mainmenu=billing  Expected and actual behavior Expected behavior : The page should list all the recorded miscellaneous payments. Actual behavior : The page is broken  Steps to reproduce the behavior /compta/bank/various_payment/list.php?leftmenu=tax_various&mainmenu=billing  Attached files ![Screenshot_1](https://github.com/Dolibarr/dolibarr/assets/131163465/5a71e2fe-6ed4-457a-9ec8-b7bbd6f5fe9a) other-file,no-bug,0.9
25828,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25828,odt Generator Problem wrong colors and styles," Bug When generating odt it happens wrong and mixed styles and colors when using html code. To Fix this we need to change line 299 ff. from $key = floatval(str_replace('.', '', microtime(true + rand(0, 10); $key = str_replace('.', '', microtime(true)) . uniqid() . rand(0, 10); // fixed by tronx2100 now it will work perfect without errors.  Environment Version 18.0.1  Environment OS linux debian bookworm  Environment Web server nginx  Environment PHP 8.2.7  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"odt Generator Problem wrong colors and styles  Bug When generating odt it happens wrong and mixed styles and colors when using html code. To Fix this we need to change line 299 ff. from $key = floatval(str_replace('.', '', microtime(true + rand(0, 10); $key = str_replace('.', '', microtime(true)) . uniqid() . rand(0, 10); // fixed by tronx2100 now it will work perfect without errors.  Environment Version 18.0.1  Environment OS linux debian bookworm  Environment Web server nginx  Environment PHP 8.2.7  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
25853,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25853,Thirdparty Massaction v17 vs. v18, Bug Maybe a bug In a Dolibarr 17.0.3 installation we have on Thirdparty list the massaction add category and in Dolibarr 18.0.1 we have not.  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file | other-file,Thirdparty Massaction v17 vs. v18  Bug Maybe a bug In a Dolibarr 17.0.3 installation we have on Thirdparty list the massaction add category and in Dolibarr 18.0.1 we have not.  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file,no-bug,0.7
31997,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31997,FROM field becomes empty upon saving email template [EASY FIX PROPOSED AND TESTED]," Bug When modifying an email template (on Admin Tools) the ""email_from"" field is being saved as empty value. It worked fine on version 20.0.0 but on 20.0.1 & 20.0.2 it fails. The problem and solutions is very easy @eldy , i think that it was a simple missing fault, just on file bash /htdocs/admin/mail_templates.php (line #477)  now appears this: PHP if ($field == 'topic') { $_POST['topic'] = GETPOST('topic-'.$rowid); } if ($field == 'joinfiles') { $_POST['joinfiles'] = GETPOST('joinfiles-'.$rowid); } if ($field == 'content') { $_POST['content'] = GETPOST('content-'.$rowid, 'restricthtml'); } if ($field == 'content_lines') { $_POST['content_lines'] = GETPOST('content_lines-'.$rowid, 'restricthtml'); }  And it's missing another IF for `email_from` field: PHP if ($field == 'email_from') { $_POST['email_from'] = GETPOST('email_from-'.$rowid); }  Perhaps you also would like to add somekind of ""well-formed email address"" check before to save the email i don't know. But in any case, this simple patch solve the problem saving this field of the email template.  Dolibarr Version 20.0.1 & 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. try to modify an existing email template 2. set a ""From"" email address and save changes 3. modify again the same template and you will see that ""From"" box is empty Note: the saving works fine when CREATING a template, but not when MODIFYING it.  Attached files _No response_",other-file,"FROM field becomes empty upon saving email template [EASY FIX PROPOSED AND TESTED]  Bug When modifying an email template (on Admin Tools) the ""email_from"" field is being saved as empty value. It worked fine on version 20.0.0 but on 20.0.1 & 20.0.2 it fails. The problem and solutions is very easy @eldy , i think that it was a simple missing fault, just on file bash /htdocs/admin/mail_templates.php (line #477)  now appears this: PHP if ($field == 'topic') { $_POST['topic'] = GETPOST('topic-'.$rowid); } if ($field == 'joinfiles') { $_POST['joinfiles'] = GETPOST('joinfiles-'.$rowid); } if ($field == 'content') { $_POST['content'] = GETPOST('content-'.$rowid, 'restricthtml'); } if ($field == 'content_lines') { $_POST['content_lines'] = GETPOST('content_lines-'.$rowid, 'restricthtml'); }  And it's missing another IF for `email_from` field: PHP if ($field == 'email_from') { $_POST['email_from'] = GETPOST('email_from-'.$rowid); }  Perhaps you also would like to add somekind of ""well-formed email address"" check before to save the email i don't know. But in any case, this simple patch solve the problem saving this field of the email template.  Dolibarr Version 20.0.1 & 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. try to modify an existing email template 2. set a ""From"" email address and save changes 3. modify again the same template and you will see that ""From"" box is empty Note: the saving works fine when CREATING a template, but not when MODIFYING it.  Attached files _No response_ other-file",no-bug,0.9
26050,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26050,"In Accounting > Reporting, if I click on a month expenses, the dates are incorrectly loaded"," Bug I want to go Accounting > reporting and click on a month to see the details of that month. It goes to this url: /compta/resultat/clientfourn.php?year=2023&month=6&modecompta=CREANCES-DETTES But the first date of the reporting period is a year in the future and I don't see the data  Environment Version 18.0.1  Environment OS CloudLinux 7.x Linux hl109.lucushost.org 3.10.0-962.3.2.lve1.5.77.el7.x86_64 #1 SMP Mon Dec 12 07:06:14 EST 2022 x86_64  Environment Web server LiteSpeed  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 10.6.11-MariaDB-cll-lve  Environment URL(s) /compta/resultat/clientfourn.php?year=2023&month=6&modecompta=CREANCES-DETTES  Expected and actual behavior To load the detailed expenses for the month 6 of the year 2023  Steps to reproduce the behavior - Go to Accounting > Reporting - Click on a month's detail  Attached files <img width=""503"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/7525839/8a2aaf52-10fa-4ae6-8376-54c439626af5"">",other-file,"In Accounting > Reporting, if I click on a month expenses, the dates are incorrectly loaded  Bug I want to go Accounting > reporting and click on a month to see the details of that month. It goes to this url: /compta/resultat/clientfourn.php?year=2023&month=6&modecompta=CREANCES-DETTES But the first date of the reporting period is a year in the future and I don't see the data  Environment Version 18.0.1  Environment OS CloudLinux 7.x Linux hl109.lucushost.org 3.10.0-962.3.2.lve1.5.77.el7.x86_64 #1 SMP Mon Dec 12 07:06:14 EST 2022 x86_64  Environment Web server LiteSpeed  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 10.6.11-MariaDB-cll-lve  Environment URL(s) /compta/resultat/clientfourn.php?year=2023&month=6&modecompta=CREANCES-DETTES  Expected and actual behavior To load the detailed expenses for the month 6 of the year 2023  Steps to reproduce the behavior - Go to Accounting > Reporting - Click on a month's detail  Attached files <img width=""503"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/7525839/8a2aaf52-10fa-4ae6-8376-54c439626af5""> other-file",no-bug,0.8
30655,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30655,Fatal php error in create loan schedule," Bug Creating loan schedules is failing  Fatal error: Uncaught TypeError: count(): Argument #1 ($value) must be of type Countable|array, null given in /var/www/html/loan/schedule.php:234 Stack trace: #0 {main} thrown in /var/www/html/loan/schedule.php on line 234   Dolibarr Version 19.0.2,19.0.3,20.0.0  Environment PHP 8.2  Environment Database mariadb:latest  Steps to reproduce the behavior and expected behavior 1. Install dolibarr 2. Activate bank and loan module 3. Create a bank account 4. Create a loan 5. Try to create a schedule  Attached files <img width=""1255"" alt=""image"" src=""https://github.com/user-attachments/assets/0d5d4981-9f5a-4d72-8d51-f159b80d1cfb""> <img width=""1329"" alt=""image"" src=""https://github.com/user-attachments/assets/c3d48e3b-8aaf-4001-a204-bc426af319f3""> <img width=""1544"" alt=""image"" src=""https://github.com/user-attachments/assets/8b9c18ea-75f9-4fd6-bc86-2433a71f952d"">",other-file | other-file | other-file | other-file,"Fatal php error in create loan schedule  Bug Creating loan schedules is failing  Fatal error: Uncaught TypeError: count(): Argument #1 ($value) must be of type Countable|array, null given in /var/www/html/loan/schedule.php:234 Stack trace: #0 {main} thrown in /var/www/html/loan/schedule.php on line 234   Dolibarr Version 19.0.2,19.0.3,20.0.0  Environment PHP 8.2  Environment Database mariadb:latest  Steps to reproduce the behavior and expected behavior 1. Install dolibarr 2. Activate bank and loan module 3. Create a bank account 4. Create a loan 5. Try to create a schedule  Attached files <img width=""1255"" alt=""image"" src=""https://github.com/user-attachments/assets/0d5d4981-9f5a-4d72-8d51-f159b80d1cfb""> <img width=""1329"" alt=""image"" src=""https://github.com/user-attachments/assets/c3d48e3b-8aaf-4001-a204-bc426af319f3""> <img width=""1544"" alt=""image"" src=""https://github.com/user-attachments/assets/8b9c18ea-75f9-4fd6-bc86-2433a71f952d""> other-file other-file other-file other-file",no-bug,0.9
33967,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33967,Product Statistics don't save some settings," Bug product/stats/card.php does not save some settings  Dolibarr Version 18.0 and higher  Environment PHP n/a  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Navigate to product/stats/card.php 2. Select a category 3. Press ""Update"" 4. Select a different statistics In this case the setting for category is lost  Attached files _No response_",other-file | other-file,"Product Statistics don't save some settings  Bug product/stats/card.php does not save some settings  Dolibarr Version 18.0 and higher  Environment PHP n/a  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Navigate to product/stats/card.php 2. Select a category 3. Press ""Update"" 4. Select a different statistics In this case the setting for category is lost  Attached files _No response_ other-file other-file",no-bug,0.9
30132,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30132,Variables not taken into account for email models for Tickets," Bug If you configure an email model associated with a ticket, the variables are not taken into acount for the subject while it is ok in the email body.  Dolibarr Version 18.0.5 and 19.0.2 at least  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 5.5.5-10.5.23-MariaDB-0+deb11u1  Steps to reproduce the behavior and expected behavior Create an email model associated with a ticket : ![image](https://github.com/Dolibarr/dolibarr/assets/46503289/729f622b-6d7d-4fa5-864b-61795fe03be0) Try to send an email using this model : ![image](https://github.com/Dolibarr/dolibarr/assets/46503289/1528d330-abf6-4f66-81ca-a7a4539178dc)  Attached files _No response_",other-file | other-file,"Variables not taken into account for email models for Tickets  Bug If you configure an email model associated with a ticket, the variables are not taken into acount for the subject while it is ok in the email body.  Dolibarr Version 18.0.5 and 19.0.2 at least  Environment PHP 7.4.33  Environment Database MySQL or MariaDB 5.5.5-10.5.23-MariaDB-0+deb11u1  Steps to reproduce the behavior and expected behavior Create an email model associated with a ticket : ![image](https://github.com/Dolibarr/dolibarr/assets/46503289/729f622b-6d7d-4fa5-864b-61795fe03be0) Try to send an email using this model : ![image](https://github.com/Dolibarr/dolibarr/assets/46503289/1528d330-abf6-4f66-81ca-a7a4539178dc)  Attached files _No response_ other-file other-file",no-bug,0.9
29421,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29421,BUG: API GET /members/types/{id} says it deletes member type," Bug BUG: API GET /members/types/{id} says it deletes member type { ""success"": { ""code"": 200, ""message"": ""Member type deleted"" } } but GET should never do that, only DELETE  Dolibarr Version 20.0.0-alpha  Environment PHP 8.2.7  Environment Database 10.11.7-MariaDB-1:10.11.7+maria~ubu2204  Steps to reproduce the behavior and expected behavior enable API module, create API key for user, visit the API explorer, scroll down and find GET /members/types/{id}, fill in a number, any number, even 89327434 and it says { ""success"": { ""code"": 200, ""message"": ""Member type deleted"" } }  Attached files ![get_member_types_says_delete_membeR_types](https://github.com/Dolibarr/dolibarr/assets/2551481/0cb13c2d-7408-4a73-a7a4-4c45c77f9b64)",other-file | other-file | other-file | other-file,"BUG: API GET /members/types/{id} says it deletes member type  Bug BUG: API GET /members/types/{id} says it deletes member type { ""success"": { ""code"": 200, ""message"": ""Member type deleted"" } } but GET should never do that, only DELETE  Dolibarr Version 20.0.0-alpha  Environment PHP 8.2.7  Environment Database 10.11.7-MariaDB-1:10.11.7+maria~ubu2204  Steps to reproduce the behavior and expected behavior enable API module, create API key for user, visit the API explorer, scroll down and find GET /members/types/{id}, fill in a number, any number, even 89327434 and it says { ""success"": { ""code"": 200, ""message"": ""Member type deleted"" } }  Attached files ![get_member_types_says_delete_membeR_types](https://github.com/Dolibarr/dolibarr/assets/2551481/0cb13c2d-7408-4a73-a7a4-4c45c77f9b64) other-file other-file other-file other-file",bug,0.95
31974,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31974,Bug: Warning: Undefined variable $search_all - Loan Module," Bug Version: 20.0.2 Hello, When I dispay the loans I see a warning. If I search 165 in the column capital the warning disapears ![image](https://github.com/user-attachments/assets/83051a62-61d3-463c-a095-f132aca58daa)  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Bug: Warning: Undefined variable $search_all - Loan Module  Bug Version: 20.0.2 Hello, When I dispay the loans I see a warning. If I search 165 in the column capital the warning disapears ![image](https://github.com/user-attachments/assets/83051a62-61d3-463c-a095-f132aca58daa)  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
23202,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23202,Editing an existing third party - Parent company is removed on save," Bug When editing an existing third party the parent company is removed when saved, as the edit form has no field for parent company. Version used Dolibarr 16.0.3  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected The non edited fields including parent company would remain untouched Actual: the third party was saved, however the parent company was removed.  Steps to reproduce the behavior Pre-Requisite: Third party exists with a parent company linked. Steps: Open Third Party select modify change any field save  Attached files _No response_",other-file | other-file,"Editing an existing third party - Parent company is removed on save  Bug When editing an existing third party the parent company is removed when saved, as the edit form has no field for parent company. Version used Dolibarr 16.0.3  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected The non edited fields including parent company would remain untouched Actual: the third party was saved, however the parent company was removed.  Steps to reproduce the behavior Pre-Requisite: Third party exists with a parent company linked. Steps: Open Third Party select modify change any field save  Attached files _No response_ other-file other-file",no-bug,0.9
28710,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28710,date in buy price update doesn't update on changes !," Bug As you change a purchase price, the new date to apply on this price is not updated in the product card -> buy price  Dolibarr Version _No response_  Environment PHP 8.2.7  Environment Database mariadb 10.11.4  Steps to reproduce the behavior and expected behavior update a buy price in product card  Attached files _No response_",other-file | other-file | other-file | other-file | other-file,"date in buy price update doesn't update on changes !  Bug As you change a purchase price, the new date to apply on this price is not updated in the product card -> buy price  Dolibarr Version _No response_  Environment PHP 8.2.7  Environment Database mariadb 10.11.4  Steps to reproduce the behavior and expected behavior update a buy price in product card  Attached files _No response_ other-file other-file other-file other-file other-file",no-bug,0.8
32007,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32007,Select menu tasks, Bug Select menu tasks  Dolibarr Version 20.0.1  Environment PHP 7.4.33  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files ![image](https://github.com/user-attachments/assets/fd18fcb8-9ab6-4e09-89a0-4d3bc9c82edc),other-file | other-file,Select menu tasks  Bug Select menu tasks  Dolibarr Version 20.0.1  Environment PHP 7.4.33  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files ![image](https://github.com/user-attachments/assets/fd18fcb8-9ab6-4e09-89a0-4d3bc9c82edc) other-file other-file,no-bug,0.8
23248,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23248,Prices not updated when external user (client) create a propal or command," Bug I just found (and hope to have resolved) a quite tricky bug: In one of my projects, we allow some clients to connect to Dolibarr to create themselves their commands They can add lines to the command, but if they choose a predefined product or service, its price is not copied in #price_ht input A dive in the code shows that /core/tpl/objectline_create.tpl.php make an ajax call to /product/ajax/products.php In this file line ~68 (65 in dev branch) `restrictedArea($user, 'produit|service', 0, 'product&product');` doesnt allow access to external users, and the ajax call throw an error which in not logged :-\ (because of line ~320 `if (!empty($user->socid) && !empty($conf->global->MAIN_MODULES_FOR_EXTERNAL) && !in_array($featureforlistofmodule, $listofmodules)) { // If limits on modules for external users, module must be into list of modules for external users` in /core/lib/security.lib.php) I suggest after tests to change line ~68 in /product/ajax/products.php to `restrictedArea($user, 'produit|service|commande|propal', 0, 'product&product');`  Environment Version All including dev  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Prices not updated when external user (client) create a propal or command  Bug I just found (and hope to have resolved) a quite tricky bug: In one of my projects, we allow some clients to connect to Dolibarr to create themselves their commands They can add lines to the command, but if they choose a predefined product or service, its price is not copied in #price_ht input A dive in the code shows that /core/tpl/objectline_create.tpl.php make an ajax call to /product/ajax/products.php In this file line ~68 (65 in dev branch) `restrictedArea($user, 'produit|service', 0, 'product&product');` doesnt allow access to external users, and the ajax call throw an error which in not logged :-\ (because of line ~320 `if (!empty($user->socid) && !empty($conf->global->MAIN_MODULES_FOR_EXTERNAL) && !in_array($featureforlistofmodule, $listofmodules)) { // If limits on modules for external users, module must be into list of modules for external users` in /core/lib/security.lib.php) I suggest after tests to change line ~68 in /product/ajax/products.php to `restrictedArea($user, 'produit|service|commande|propal', 0, 'product&product');`  Environment Version All including dev  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",bug,0.9
23179,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23179,Bug: Products REST API don't update the Notes (Private and Public) Property," Bug The /products/{id} REST Call is not Updateing the Notes.  Environment Version 17 beta  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior ![image](https://user-images.githubusercontent.com/78662388/206912078-d69691ac-639a-4838-b782-23442458c811.png) See in the ""Response Body"": ""note_public"": ""note_private"": the old values are avalible.  Attached files _No response_",other-file | other-file,"Bug: Products REST API don't update the Notes (Private and Public) Property  Bug The /products/{id} REST Call is not Updateing the Notes.  Environment Version 17 beta  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior ![image](https://user-images.githubusercontent.com/78662388/206912078-d69691ac-639a-4838-b782-23442458c811.png) See in the ""Response Body"": ""note_public"": ""note_private"": the old values are avalible.  Attached files _No response_ other-file other-file",bug,0.85
29292,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29292,The colon char is breaking sqlfilters search," Bug If you try :  http://my-dolibarr.local/api/index.php/orders?sortfield=t.rowid&sortorder=ASC&limit=100&sqlfilters=t.ref_client%3A%3D%3A'a%3Ab'  With sqlfilters which is `t.ref_client:=:'a:b'`, the `:` make everything breaks. With this filter, it find order with those client ref: ""LAvionJaune"", ""test"", ""htrh"", ""Mathis55109"". I don't understand why or how it works, but it's very strange.  Dolibarr Version 18.0.5  Environment PHP 8.1.27  Environment Database MariaDB 10.11.6  Steps to reproduce the behavior and expected behavior Call API with this : `api/index.php/orders?sortfield=t.rowid&sortorder=ASC&limit=100&sqlfilters=t.ref_client%3A%3D%3A'a%3Ab'`, in general with a `:` in the ref client  Attached files _No response_",other-file | test-file | other-file | test-file,"The colon char is breaking sqlfilters search  Bug If you try :  http://my-dolibarr.local/api/index.php/orders?sortfield=t.rowid&sortorder=ASC&limit=100&sqlfilters=t.ref_client%3A%3D%3A'a%3Ab'  With sqlfilters which is `t.ref_client:=:'a:b'`, the `:` make everything breaks. With this filter, it find order with those client ref: ""LAvionJaune"", ""test"", ""htrh"", ""Mathis55109"". I don't understand why or how it works, but it's very strange.  Dolibarr Version 18.0.5  Environment PHP 8.1.27  Environment Database MariaDB 10.11.6  Steps to reproduce the behavior and expected behavior Call API with this : `api/index.php/orders?sortfield=t.rowid&sortorder=ASC&limit=100&sqlfilters=t.ref_client%3A%3D%3A'a%3Ab'`, in general with a `:` in the ref client  Attached files _No response_ other-file test-file other-file test-file",bug,0.9
31269,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31269,New interventions not more linked with ticket," Bug Hi, On v20 we add a new ticket and then a new intervention from ticket, they are no more automaticly llinked. Ok 19.0.2 One idea ? Thanks  Dolibarr Version 20.0  Environment PHP 8.3.6  Environment Database MySQL or MariaDB 8.0.39-0ubuntu0.24.04.1  Steps to reproduce the behavior and expected behavior Create new ticket, then click create intervention, no linked to original ticket  Attached files _No response_",other-file | other-file | other-file,"New interventions not more linked with ticket  Bug Hi, On v20 we add a new ticket and then a new intervention from ticket, they are no more automaticly llinked. Ok 19.0.2 One idea ? Thanks  Dolibarr Version 20.0  Environment PHP 8.3.6  Environment Database MySQL or MariaDB 8.0.39-0ubuntu0.24.04.1  Steps to reproduce the behavior and expected behavior Create new ticket, then click create intervention, no linked to original ticket  Attached files _No response_ other-file other-file other-file",no-bug,0.8
23331,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23331,Nested projects," Feature Request For a project that consists of multiple sub projects, it would be a nice feature to be able to assign a 'parent' project. When loading the parent project, the card and overview screen give a total overview including the status of the child projects. This way, more structure can be added.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_",database-file | database-file | database-file | database-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file,"Nested projects  Feature Request For a project that consists of multiple sub projects, it would be a nice feature to be able to assign a 'parent' project. When loading the parent project, the card and overview screen give a total overview including the status of the child projects. This way, more structure can be added.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ database-file database-file database-file database-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file",no-bug,0.95
30010,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30010,"When sending ticket by mail, TicketMessageMailIntroText is forced in the message"," Bug When you notify a user by mail when adding a new message in ticket, the message sent has the translation of TicketMessageMailIntroText on top of your message everytime. It doesn't take the const TICKET_MESSAGE_MAIL_INTRO into account.  Dolibarr Version 17 - develop  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"When sending ticket by mail, TicketMessageMailIntroText is forced in the message  Bug When you notify a user by mail when adding a new message in ticket, the message sent has the translation of TicketMessageMailIntroText on top of your message everytime. It doesn't take the const TICKET_MESSAGE_MAIL_INTRO into account.  Dolibarr Version 17 - develop  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
33169,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33169,Anyone can cancel vacation requests?," Bug A user with rights to read all vacation requests can cancel requests of other users.  Dolibarr Version 20.0.4  Environment PHP 7.3  Environment Database MariaDB 10.3.39  Steps to reproduce the behavior and expected behavior Here are the rights of my user : ![Image](https://github.com/user-attachments/assets/22688afa-6212-42b5-a9f9-2fc1cf15b38b) And here is a vacation request for someone that is not me, and for whom I am not the hierarchical superior : ![Image](https://github.com/user-attachments/assets/ce5b9791-4b5e-4cc1-baa2-4082abe82198) I tested this with other profiles (with the same rights) and it's the same. I also tested on an old version (18.0.4) and it's the same. Is this intended? Is there any other right that might have an impact on this?  Attached files _No response_",other-file,"Anyone can cancel vacation requests?  Bug A user with rights to read all vacation requests can cancel requests of other users.  Dolibarr Version 20.0.4  Environment PHP 7.3  Environment Database MariaDB 10.3.39  Steps to reproduce the behavior and expected behavior Here are the rights of my user : ![Image](https://github.com/user-attachments/assets/22688afa-6212-42b5-a9f9-2fc1cf15b38b) And here is a vacation request for someone that is not me, and for whom I am not the hierarchical superior : ![Image](https://github.com/user-attachments/assets/ce5b9791-4b5e-4cc1-baa2-4082abe82198) I tested this with other profiles (with the same rights) and it's the same. I also tested on an old version (18.0.4) and it's the same. Is this intended? Is there any other right that might have an impact on this?  Attached files _No response_ other-file",no-bug,0.8
32145,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32145,Ticket module - Condition validation is wrong," Bug In the ticket/card.php file there is a condition that is evaluated incorrectly because the ""private_message"" parameter is compared to an unexpected value. `if ($action == 'add_message' && GETPOSTISSET('btn_add_message') && $permissiontoread) {` `$ret = $object->newMessage($user, $action, (GETPOST('private_message', 'alpha') == ""on"" ? 1 : 0), 0);` GETPOST('private_message', 'alpha') is always ""1"" or ""0"", never is ""on"" This violates the scenario that if a comment is marked private, the status should not change.  Dolibarr Version 20.0.2  Environment PHP 8.0  Environment Database MySQL  Steps to reproduce the behavior and expected behavior **Behavior** Add a new message in ticket card and mark it as private. The status changes to ""IN PROGRESS"" **Expected** The status does not change. The same state is maintained.  Attached files _No response_",other-file | other-file,"Ticket module - Condition validation is wrong  Bug In the ticket/card.php file there is a condition that is evaluated incorrectly because the ""private_message"" parameter is compared to an unexpected value. `if ($action == 'add_message' && GETPOSTISSET('btn_add_message') && $permissiontoread) {` `$ret = $object->newMessage($user, $action, (GETPOST('private_message', 'alpha') == ""on"" ? 1 : 0), 0);` GETPOST('private_message', 'alpha') is always ""1"" or ""0"", never is ""on"" This violates the scenario that if a comment is marked private, the status should not change.  Dolibarr Version 20.0.2  Environment PHP 8.0  Environment Database MySQL  Steps to reproduce the behavior and expected behavior **Behavior** Add a new message in ticket card and mark it as private. The status changes to ""IN PROGRESS"" **Expected** The status does not change. The same state is maintained.  Attached files _No response_ other-file other-file",bug,0.8
24429,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24429,Focus lost after clicking select2 field, Bug Focus lost after clicking select2 field see screenshot https://user-images.githubusercontent.com/25256186/229614677-72308a8b-1aa2-4d98-b9f2-8a1a677fb45c.mp4  Environment Version 16.0.x  Environment OS na  Environment Web server na  Environment PHP na  Environment Database na  Environment URL(s) every list.php  Expected and actual behavior Focus should stay at input field  Steps to reproduce the behavior 1. Open a list.php (eg ticket/list.php) 2. Click into a select2 field (eg ticket status) 3. Click into a normal input field (eg thirdparty) see screenshot in bug description  Attached files _No response_,other-file | other-file | other-file | other-file,Focus lost after clicking select2 field  Bug Focus lost after clicking select2 field see screenshot https://user-images.githubusercontent.com/25256186/229614677-72308a8b-1aa2-4d98-b9f2-8a1a677fb45c.mp4  Environment Version 16.0.x  Environment OS na  Environment Web server na  Environment PHP na  Environment Database na  Environment URL(s) every list.php  Expected and actual behavior Focus should stay at input field  Steps to reproduce the behavior 1. Open a list.php (eg ticket/list.php) 2. Click into a select2 field (eg ticket status) 3. Click into a normal input field (eg thirdparty) see screenshot in bug description  Attached files _No response_ other-file other-file other-file other-file,no-bug,0.95
24459,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24459,Issues with recurrent supplier invoices (llx_facture_fourn_rec related)," Bug I got this in dolibarr.log, likely related to Supplier invoice generation which is not generating the invoices automatically.  2023-04-06 22:23:50 ERR <IP> DoliDBMysqli::query SQL Error query: SELECT MAX(te.title) FROM llx_facture_fourn_rec as te WHERE te.title < 'Parking 38 RDP' 2023-04-06 22:23:50 ERR <IP> DoliDBMysqli::query SQL Error message: DB_ERROR_NOSUCHFIELD Unknown column 'te.title' in 'field list'  I am under the impression that the column is ""titre"", but I did not find the source code where ""title"" is defind for this query.  Environment Version 16.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"Issues with recurrent supplier invoices (llx_facture_fourn_rec related)  Bug I got this in dolibarr.log, likely related to Supplier invoice generation which is not generating the invoices automatically.  2023-04-06 22:23:50 ERR <IP> DoliDBMysqli::query SQL Error query: SELECT MAX(te.title) FROM llx_facture_fourn_rec as te WHERE te.title < 'Parking 38 RDP' 2023-04-06 22:23:50 ERR <IP> DoliDBMysqli::query SQL Error message: DB_ERROR_NOSUCHFIELD Unknown column 'te.title' in 'field list'  I am under the impression that the column is ""titre"", but I did not find the source code where ""title"" is defind for this query.  Environment Version 16.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.9
23946,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23946,Create warehouse from new product blank screen," Bug When you click on + to create a new warehouse when creating a new product, after warehouse creation (wich is ok) when you return on product, the screen is blank Cause : the return link (backtopage) passed in product page is something like /product/card.php?id=&action=edit and the id is empty (normal 'cause it's a new product) Solution : disable the [+] link to create a new warehouse when creating a new product. Arround line #1471 of /htdocs/product/card.php add a test. replace  print ' <a href=""'.DOL_URL_ROOT.'/product/stock/card.php?action=create&token='.newToken().'&backtopage='.urlencode($_SERVER['PHP_SELF'].'?id='.$object->id.'&action=edit&token='.newToken()).'"">'; print '<span class=""fa fa-plus-circle valignmiddle paddingleft"" title=""'.$langs->trans(""AddWarehouse"").'""></span>'; print '</a>';  by  if ($object->id>0) { print ' <a href=""'.DOL_URL_ROOT.'/product/stock/card.php?action=create&token='.newToken().'&backtopage='.urlencode($_SERVER['PHP_SELF'].'?id='.$object->id.'&action=edit&token='.newToken()).'"">'; print '<span class=""fa fa-plus-circle valignmiddle paddingleft"" title=""'.$langs->trans(""AddWarehouse"").'""></span>'; print '</a>'; }   Environment Version all  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Create warehouse from new product blank screen  Bug When you click on + to create a new warehouse when creating a new product, after warehouse creation (wich is ok) when you return on product, the screen is blank Cause : the return link (backtopage) passed in product page is something like /product/card.php?id=&action=edit and the id is empty (normal 'cause it's a new product) Solution : disable the [+] link to create a new warehouse when creating a new product. Arround line #1471 of /htdocs/product/card.php add a test. replace  print ' <a href=""'.DOL_URL_ROOT.'/product/stock/card.php?action=create&token='.newToken().'&backtopage='.urlencode($_SERVER['PHP_SELF'].'?id='.$object->id.'&action=edit&token='.newToken()).'"">'; print '<span class=""fa fa-plus-circle valignmiddle paddingleft"" title=""'.$langs->trans(""AddWarehouse"").'""></span>'; print '</a>';  by  if ($object->id>0) { print ' <a href=""'.DOL_URL_ROOT.'/product/stock/card.php?action=create&token='.newToken().'&backtopage='.urlencode($_SERVER['PHP_SELF'].'?id='.$object->id.'&action=edit&token='.newToken()).'"">'; print '<span class=""fa fa-plus-circle valignmiddle paddingleft"" title=""'.$langs->trans(""AddWarehouse"").'""></span>'; print '</a>'; }   Environment Version all  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
27048,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27048,"Add Yes/No Form to Variations Module to globally set ""VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT"" variable - concerns Issue #26965"," Feature Request In Issue #26965 the missing check for the Variable ""VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT"" was discussed and fixed in the PR #26967 Now I propose a change in the Variants module settings page to allow the user to set this global variable. This would also be the first and only way to set this variable via an option.  Use case When a user activates the variations module and checks the possible options inside the module the user will be able to see that there is a possibility to allow the stock movements for the variant parent products as well.  Suggested implementation Use the same syntax as with the ""HideProductCombinations"": https://github.com/Dolibarr/dolibarr/blob/e4536e0a2ebb87a91a09bf595242c2181889c0b4/htdocs/variants/admin/admin.php#L75-L76 Generally add a form with a yes/no option to the options page php $form->selectyesno()  Together with a similar syntax as in the Lines 40-56 one could implement and set the variable globally: https://github.com/Dolibarr/dolibarr/blob/e4536e0a2ebb87a91a09bf595242c2181889c0b4/htdocs/variants/admin/admin.php#L40-L56  Suggested steps - add Option to variants/admin/admin.php via $form->selectyesno() - add translationkey for new option to langs/en_US",other-file | other-file | other-file | other-file,"Add Yes/No Form to Variations Module to globally set ""VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT"" variable - concerns Issue #26965  Feature Request In Issue #26965 the missing check for the Variable ""VARIANT_ALLOW_STOCK_MOVEMENT_ON_VARIANT_PARENT"" was discussed and fixed in the PR #26967 Now I propose a change in the Variants module settings page to allow the user to set this global variable. This would also be the first and only way to set this variable via an option.  Use case When a user activates the variations module and checks the possible options inside the module the user will be able to see that there is a possibility to allow the stock movements for the variant parent products as well.  Suggested implementation Use the same syntax as with the ""HideProductCombinations"": https://github.com/Dolibarr/dolibarr/blob/e4536e0a2ebb87a91a09bf595242c2181889c0b4/htdocs/variants/admin/admin.php#L75-L76 Generally add a form with a yes/no option to the options page php $form->selectyesno()  Together with a similar syntax as in the Lines 40-56 one could implement and set the variable globally: https://github.com/Dolibarr/dolibarr/blob/e4536e0a2ebb87a91a09bf595242c2181889c0b4/htdocs/variants/admin/admin.php#L40-L56  Suggested steps - add Option to variants/admin/admin.php via $form->selectyesno() - add translationkey for new option to langs/en_US other-file other-file other-file other-file",no-bug,0.95
27942,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27942,Wrong Salary folder/files in Export Accounting," Bug When exporting source document files linked to PaymentSalary are invalid when ID of PaymentSalary is different of ID of Salary In file /compta/accounting-files.php around line 342, $subdir is made with $objd->id `$subdir .= ($subdir ? '/' : '').dol_sanitizeFileName($objd->id);` This is wrong because $subdir should use ID of Salary and in $objd->id we got ID of PaymentSalary  Environment Version >=18 for sure  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Files displayed should be those linked to Salary of PaymentSalary  Steps to reproduce the behavior Example configuration : Salary ID 1 with PayementSalary ID 2 Salary ID 2 with file linked Export source document with payments salary In the result table you will have Payment 2 (linked to Salary 1) displayed with file of Salary 2 (which is wrong)  Attached files ![image](https://github.com/Dolibarr/dolibarr/assets/109668929/e6e74a86-da3b-4dd2-9e9f-23fd685f8e05) ![image](https://github.com/Dolibarr/dolibarr/assets/109668929/deb7685c-af71-4570-9bde-2b42b9e508f0) ![image](https://github.com/Dolibarr/dolibarr/assets/109668929/b2c6f43b-5ae0-4b82-aa0d-413693246e43)",other-file,"Wrong Salary folder/files in Export Accounting  Bug When exporting source document files linked to PaymentSalary are invalid when ID of PaymentSalary is different of ID of Salary In file /compta/accounting-files.php around line 342, $subdir is made with $objd->id `$subdir .= ($subdir ? '/' : '').dol_sanitizeFileName($objd->id);` This is wrong because $subdir should use ID of Salary and in $objd->id we got ID of PaymentSalary  Environment Version >=18 for sure  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Files displayed should be those linked to Salary of PaymentSalary  Steps to reproduce the behavior Example configuration : Salary ID 1 with PayementSalary ID 2 Salary ID 2 with file linked Export source document with payments salary In the result table you will have Payment 2 (linked to Salary 1) displayed with file of Salary 2 (which is wrong)  Attached files ![image](https://github.com/Dolibarr/dolibarr/assets/109668929/e6e74a86-da3b-4dd2-9e9f-23fd685f8e05) ![image](https://github.com/Dolibarr/dolibarr/assets/109668929/deb7685c-af71-4570-9bde-2b42b9e508f0) ![image](https://github.com/Dolibarr/dolibarr/assets/109668929/b2c6f43b-5ae0-4b82-aa0d-413693246e43) other-file",no-bug,0.9
26553,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26553,Supplier invoice - Dolibarr shall not display a button to delete a payment when this one is reconciled," Bug If you reopen a paid supplier invoice, Dolibarr displays a button to delete the existing payment. However a reconciled payment can't be deleted and wouldn't be: in that case Dolibarr would display an error message. So maybe Dolibarr shall not display a delete button for reconciled payment in the first place.  Environment Version v18.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Supplier invoice - Dolibarr shall not display a button to delete a payment when this one is reconciled  Bug If you reopen a paid supplier invoice, Dolibarr displays a button to delete the existing payment. However a reconciled payment can't be deleted and wouldn't be: in that case Dolibarr would display an error message. So maybe Dolibarr shall not display a delete button for reconciled payment in the first place.  Environment Version v18.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
31367,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31367,Feature Request: Bank account label is too short," Feature Request version: 20.0.1 Hello, My bank account label looks like this ![image](https://github.com/user-attachments/assets/6c73ac15-fd9c-47a0-9399-05cec8a4f179) But when I created it I wanted it to be like this `BOUR Compte Courant d'associ  Prnom Nom` Because I have multiple comptes courant d'associs, I also specify their bank in case they have multiple banks and I specify Compte courant d'associ A label is supposed to be easily readable and not full of acronyms such as ""BOUR CCA - P.Nom"" (16 caracters here) When looking at the table llx_bank_account I see that the label is 30 caracters ` label | varchar(30) | NO | MUL | NULL` In my initial example BOUR Compte Courant d'associ  Prnom Nom is 43 caracters long but that also depends on the name of the person I think varchar(64) should be enough Also, the box field should be blocked so that we cannot insert anything above 64 caracters, for the field Ref the length is blocked to 12 during account creation. But for the field label, we can add as many letters we want but after validation the label is truncated to 30.  Use case _No response_  Suggested implementation `label | varchar(64) | NO | MUL | NULL` instead of `label | varchar(30) | NO | MUL | NULL` in table llx_bank_account + limit GUI box to 64 caracters (during creation and also during edition)  Suggested steps _No response_",database-file | database-file,"Feature Request: Bank account label is too short  Feature Request version: 20.0.1 Hello, My bank account label looks like this ![image](https://github.com/user-attachments/assets/6c73ac15-fd9c-47a0-9399-05cec8a4f179) But when I created it I wanted it to be like this `BOUR Compte Courant d'associ  Prnom Nom` Because I have multiple comptes courant d'associs, I also specify their bank in case they have multiple banks and I specify Compte courant d'associ A label is supposed to be easily readable and not full of acronyms such as ""BOUR CCA - P.Nom"" (16 caracters here) When looking at the table llx_bank_account I see that the label is 30 caracters ` label | varchar(30) | NO | MUL | NULL` In my initial example BOUR Compte Courant d'associ  Prnom Nom is 43 caracters long but that also depends on the name of the person I think varchar(64) should be enough Also, the box field should be blocked so that we cannot insert anything above 64 caracters, for the field Ref the length is blocked to 12 during account creation. But for the field label, we can add as many letters we want but after validation the label is truncated to 30.  Use case _No response_  Suggested implementation `label | varchar(64) | NO | MUL | NULL` instead of `label | varchar(30) | NO | MUL | NULL` in table llx_bank_account + limit GUI box to 64 caracters (during creation and also during edition)  Suggested steps _No response_ database-file database-file",no-bug,0.9
23212,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23212,Operator does not exist when generating income/expense report in accounting," Bug The income/expense report cannot be created due to a database error Probably related to #22566  Environment Version 17.0 beta  Environment OS Debian 11  Environment Web server nginx  Environment PHP 7.4  Environment Database PostgreSQL 13  Environment URL(s) /compta/resultat/index.php?leftmenu=accountancy_report  Expected and actual behavior Expected behaviour should be clear. Actual behaviour: plain Error ERROR: 42883: operator does not exist: character varying = integer LINE 1: eping as t WHERE t.entity = 1 AND t.numero_compte IN (8200,8 ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:647   Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Operator does not exist when generating income/expense report in accounting  Bug The income/expense report cannot be created due to a database error Probably related to #22566  Environment Version 17.0 beta  Environment OS Debian 11  Environment Web server nginx  Environment PHP 7.4  Environment Database PostgreSQL 13  Environment URL(s) /compta/resultat/index.php?leftmenu=accountancy_report  Expected and actual behavior Expected behaviour should be clear. Actual behaviour: plain Error ERROR: 42883: operator does not exist: character varying = integer LINE 1: eping as t WHERE t.entity = 1 AND t.numero_compte IN (8200,8 ^ HINT: No operator matches the given name and argument types. You might need to add explicit type casts. LOCATION: op_error, parse_oper.c:647   Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
32801,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32801,VAT tax type upside-down," Bug New field in VAT dictionnary ""VAT accounts"" -> Tax type (""all"", ""buy"", ""sell"") seem to work upside-down. ""Buy"" codes are only usable in sells actions, and ""sell"" codes in buy actions.  Dolibarr Version 20.0.3  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior Create a new ""VAT accounts"" in the VAT dictionnary, with Tax type ""Sell"" : ![Image](https://github.com/user-attachments/assets/07de2cf4-f155-4cb2-abca-f4905685c3e5) This new VAT code is now only display in Vendor Invoices lines and purchase orders lines. ![Image](https://github.com/user-attachments/assets/984b16ce-798e-40cd-aa2c-ed5374bb5ff1) On the contrary, if the tax type is ""Buy"", the VAT code is only display in Sales Order and Customer Invoices. ![Image](https://github.com/user-attachments/assets/1c4908c9-c2a6-460b-a437-9e5f76dd8504)  Attached files _No response_",other-file | other-file,"VAT tax type upside-down  Bug New field in VAT dictionnary ""VAT accounts"" -> Tax type (""all"", ""buy"", ""sell"") seem to work upside-down. ""Buy"" codes are only usable in sells actions, and ""sell"" codes in buy actions.  Dolibarr Version 20.0.3  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior Create a new ""VAT accounts"" in the VAT dictionnary, with Tax type ""Sell"" : ![Image](https://github.com/user-attachments/assets/07de2cf4-f155-4cb2-abca-f4905685c3e5) This new VAT code is now only display in Vendor Invoices lines and purchase orders lines. ![Image](https://github.com/user-attachments/assets/984b16ce-798e-40cd-aa2c-ed5374bb5ff1) On the contrary, if the tax type is ""Buy"", the VAT code is only display in Sales Order and Customer Invoices. ![Image](https://github.com/user-attachments/assets/1c4908c9-c2a6-460b-a437-9e5f76dd8504)  Attached files _No response_ other-file other-file",no-bug,0.9
29274,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29274,Add possibility to have several mail for autocopy," Feature Request Add possibility to have several mail for autocopy, Let me explain myself, it's currently possible to define a mail added in hidden copy each time a mail is send via dolibarr in Home > Setup > Mails > Others options. What I want to add is the possibility to change this email according to the situation.  Use case Here is an example to better understand: Until now, this email was set up on commercial@my-compagny.com, but I recently added the holiday module manage leaves and my emails were polluted by leave requests and validation, so I need to be able to set up many emails. This feature is necessary for large companies that have different services to manage the commercial side, human resource management and where each service has its own email address  Suggested implementation Add a parameter ($autocopyTo) to __construct function of CMailFile class (/core/class/CMailFile.class.php). This param is set to main by default (so if not specified, it just work as always) Further in the function, just before the value of MAIN_MAIL_AUTOCOPY_TO is added to the list, we get the corresponding [$autocopyTo]_MAIL_AUTOCOPY_TO Then we can add option of configuration in Setup > Mails > Others options (Otherwise it's possible to add your own option in Setup > Other Setup)  Suggested steps _No response_",other-file | other-file,"Add possibility to have several mail for autocopy  Feature Request Add possibility to have several mail for autocopy, Let me explain myself, it's currently possible to define a mail added in hidden copy each time a mail is send via dolibarr in Home > Setup > Mails > Others options. What I want to add is the possibility to change this email according to the situation.  Use case Here is an example to better understand: Until now, this email was set up on commercial@my-compagny.com, but I recently added the holiday module manage leaves and my emails were polluted by leave requests and validation, so I need to be able to set up many emails. This feature is necessary for large companies that have different services to manage the commercial side, human resource management and where each service has its own email address  Suggested implementation Add a parameter ($autocopyTo) to __construct function of CMailFile class (/core/class/CMailFile.class.php). This param is set to main by default (so if not specified, it just work as always) Further in the function, just before the value of MAIN_MAIL_AUTOCOPY_TO is added to the list, we get the corresponding [$autocopyTo]_MAIL_AUTOCOPY_TO Then we can add option of configuration in Setup > Mails > Others options (Otherwise it's possible to add your own option in Setup > Other Setup)  Suggested steps _No response_ other-file other-file",no-bug,0.9
26312,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26312,[bank accounts & invoicing modules] Missing Intermediary BIC / BIC intermdiaire," Bug Hi, Intermediary BIC field is missing in the bank accounts & invoicing modules. It should be added as default.  Environment Version 18.0.2  Environment OS ArchLinux  Environment Web server Nginx 1.25.2  Environment PHP 8.2.11  Environment Database mariadb from 11.1.2-MariaDB, client 15.2 for Linux (x86_64) using readline 5.1  Environment URL(s) _No response_  Expected and actual behavior Intermediary BIC field should be present in the bank accounts & invoicing modules after the BIC field. It is not the case and they should be added as default.  Steps to reproduce the behavior Go into the bank accounts or the invoicing module. Issue an invoice or look at your bank details. Intermediary BIC is missing.  Attached files _No response_",database-file | database-file | database-file | database-file | database-file | database-file | database-file | database-file,"[bank accounts & invoicing modules] Missing Intermediary BIC / BIC intermdiaire  Bug Hi, Intermediary BIC field is missing in the bank accounts & invoicing modules. It should be added as default.  Environment Version 18.0.2  Environment OS ArchLinux  Environment Web server Nginx 1.25.2  Environment PHP 8.2.11  Environment Database mariadb from 11.1.2-MariaDB, client 15.2 for Linux (x86_64) using readline 5.1  Environment URL(s) _No response_  Expected and actual behavior Intermediary BIC field should be present in the bank accounts & invoicing modules after the BIC field. It is not the case and they should be added as default.  Steps to reproduce the behavior Go into the bank accounts or the invoicing module. Issue an invoice or look at your bank details. Intermediary BIC is missing.  Attached files _No response_ database-file database-file database-file database-file database-file database-file database-file database-file",no-bug,0.8
24240,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24240,Dolibarr V17.0.0 PHP8 fatal error, Bug When I add a product on an existing recurant invoice it fail with error 500: PHP Fatal error: Uncaught TypeError: Unsupported operand types: string / int in /var/www/html/compta/facture/card-rec.php With V17.0.0 and PHP 7.3.3 no problem  Environment Version 17.0.0  Environment OS linux  Environment Web server apache  Environment PHP 8.0  Environment Database mysql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file | other-file,Dolibarr V17.0.0 PHP8 fatal error  Bug When I add a product on an existing recurant invoice it fail with error 500: PHP Fatal error: Uncaught TypeError: Unsupported operand types: string / int in /var/www/html/compta/facture/card-rec.php With V17.0.0 and PHP 7.3.3 no problem  Environment Version 17.0.0  Environment OS linux  Environment Web server apache  Environment PHP 8.0  Environment Database mysql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file,no-bug,0.9
31975,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31975,Bug: Warning: Undefined property: stdClass::$BANKADDON_PDF - Bank configuration module," Bug Version: 20.0.2 Hello, When I go to the bank configuration module (thumbnail Divers) I see a warning ![image](https://github.com/user-attachments/assets/547f6531-019b-45fa-86e9-9de71994d453) Line 383 in the code is `if ($conf->global->BANKADDON_PDF == $name) {`  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"Bug: Warning: Undefined property: stdClass::$BANKADDON_PDF - Bank configuration module  Bug Version: 20.0.2 Hello, When I go to the bank configuration module (thumbnail Divers) I see a warning ![image](https://github.com/user-attachments/assets/547f6531-019b-45fa-86e9-9de71994d453) Line 383 in the code is `if ($conf->global->BANKADDON_PDF == $name) {`  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
33765,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33765,Supplier order creation from project," Bug We can't select a supplier when we want to create an order from an existing project linked to a customer. It's the same problem for an invoice or a proposal.  Dolibarr Version 21  Environment PHP Any  Environment Database Any  Steps to reproduce the behavior and expected behavior From a project linked to a customer, click on create and select supplier order. On the card, we can't select any supplier and, by default, customer is selected as a supplier, even if he's not (see video).  Attached files https://github.com/user-attachments/assets/085b6857-a1bf-4919-9d3f-7ef82ea1c660",other-file | other-file,"Supplier order creation from project  Bug We can't select a supplier when we want to create an order from an existing project linked to a customer. It's the same problem for an invoice or a proposal.  Dolibarr Version 21  Environment PHP Any  Environment Database Any  Steps to reproduce the behavior and expected behavior From a project linked to a customer, click on create and select supplier order. On the card, we can't select any supplier and, by default, customer is selected as a supplier, even if he's not (see video).  Attached files https://github.com/user-attachments/assets/085b6857-a1bf-4919-9d3f-7ef82ea1c660 other-file other-file",no-bug,0.8
29249,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29249,"Wish API could add, change and remove extrafields / Complementary attributes"," Feature Request I wish I could add, change and remove extrafields / Complementary attributes using the API.  Use case Replicating my dev, test and production setup automatically by having the extrafields and their configuration in version control.  Suggested implementation expand /api/index.php/explorer/#/setup with POST, PUT, DELETE under the /setup/extrafields area  Suggested steps _No response_",other-file | other-file | other-file,"Wish API could add, change and remove extrafields / Complementary attributes  Feature Request I wish I could add, change and remove extrafields / Complementary attributes using the API.  Use case Replicating my dev, test and production setup automatically by having the extrafields and their configuration in version control.  Suggested implementation expand /api/index.php/explorer/#/setup with POST, PUT, DELETE under the /setup/extrafields area  Suggested steps _No response_ other-file other-file other-file",no-bug,0.95
27188,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27188,Total amount of invoices shown to users without right to read invoices," Bug On Third Party card on the vendor tab, there are summary boxes for total amounts and outstanding invoice payments. Users who do not have the right to read invoices can see the total invoiced amount <img width=""812"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/10772984/2f870410-e650-4928-967c-6693a22569db"">  Environment Version 18.0.4",config-file | other-file,"Total amount of invoices shown to users without right to read invoices  Bug On Third Party card on the vendor tab, there are summary boxes for total amounts and outstanding invoice payments. Users who do not have the right to read invoices can see the total invoiced amount <img width=""812"" alt=""image"" src=""https://github.com/Dolibarr/dolibarr/assets/10772984/2f870410-e650-4928-967c-6693a22569db"">  Environment Version 18.0.4 config-file other-file",no-bug,0.8
28303,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28303,Solved or closed ticket should automatically open by Email Collecter module upon further email from customer," Feature Request Email collector module doesn't re-open after getting further reply via email from customer email.  Use case Generally ticket are closed by organizational employee after the problem is solved. Now the same ticket can be opened by the customer after reply on the same ticket after few days. Dolibarr adds the new message using the help of Email Collector Class to closed ticket, but don't re-open the ticket again automatically.  Suggested implementation Upon collecting response by **Collect_Responses_In**, closed or solved ticket should be re-opened. Other wise employee would not know about the new reply. If the ticket is not assigned, then the re-opened ticket status should be **Unread**. And if the ticket is assigned, then the re-opened ticket status should be **Assigned**.  Suggested steps _No response_",other-file | other-file,"Solved or closed ticket should automatically open by Email Collecter module upon further email from customer  Feature Request Email collector module doesn't re-open after getting further reply via email from customer email.  Use case Generally ticket are closed by organizational employee after the problem is solved. Now the same ticket can be opened by the customer after reply on the same ticket after few days. Dolibarr adds the new message using the help of Email Collector Class to closed ticket, but don't re-open the ticket again automatically.  Suggested implementation Upon collecting response by **Collect_Responses_In**, closed or solved ticket should be re-opened. Other wise employee would not know about the new reply. If the ticket is not assigned, then the re-opened ticket status should be **Unread**. And if the ticket is assigned, then the re-opened ticket status should be **Assigned**.  Suggested steps _No response_ other-file other-file",no-bug,0.9
28560,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28560,"Bug: Virtual stock calculation is wrong if a MoLine was marked as ""Stock changed disabled"""," Bug If a MoLine is marked with ""Stock changed disabled"", the ""Virtual stock"" at the product is also reduced. The ""Virtual stock"" must untouched in this case. Mo: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/c78fcd1b-0742-4681-bd82-3542dcae0cf6) Product: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/40ee76a2-89a2-4db3-b5a6-eb31fd222b05)  Environment Version 19  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | test-file,"Bug: Virtual stock calculation is wrong if a MoLine was marked as ""Stock changed disabled""  Bug If a MoLine is marked with ""Stock changed disabled"", the ""Virtual stock"" at the product is also reduced. The ""Virtual stock"" must untouched in this case. Mo: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/c78fcd1b-0742-4681-bd82-3542dcae0cf6) Product: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/40ee76a2-89a2-4db3-b5a6-eb31fd222b05)  Environment Version 19  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file test-file",no-bug,0.9
23115,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23115,Linked files in the Project tasks show access denied," Bug Under Project & Collaboration module, if you directly access the Task List and select any task. After selecting the task, go to the Linked Files tab and see the list of Attached files and documents, there you see the thumbnail of the image files is not shown.  Environment Version 16.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP 8.1.10  Environment Database mariaDB  Environment URL(s) https://[[HOSTNAME]]/projet/tasks/document.php?id=1&withproject=1&uploadform=1  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![Untitled](https://user-images.githubusercontent.com/82569386/205830920-3ff62a6e-785e-4213-8a9c-09cefa70fb6f.png)",other-file | other-file,"Linked files in the Project tasks show access denied  Bug Under Project & Collaboration module, if you directly access the Task List and select any task. After selecting the task, go to the Linked Files tab and see the list of Attached files and documents, there you see the thumbnail of the image files is not shown.  Environment Version 16.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP 8.1.10  Environment Database mariaDB  Environment URL(s) https://[[HOSTNAME]]/projet/tasks/document.php?id=1&withproject=1&uploadform=1  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files ![Untitled](https://user-images.githubusercontent.com/82569386/205830920-3ff62a6e-785e-4213-8a9c-09cefa70fb6f.png) other-file other-file",no-bug,0.8
23716,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23716,newpayment & hooks," Bug newpayment has some hooks, that's good but that is incomplete ! for example  $reshook = $hookmanager->executeHooks('doPayment', $parameters, $object, $action);  but no tests on $reshook value, no error handling  just ""call and forget""  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"newpayment & hooks  Bug newpayment has some hooks, that's good but that is incomplete ! for example  $reshook = $hookmanager->executeHooks('doPayment', $parameters, $object, $action);  but no tests on $reshook value, no error handling  just ""call and forget""  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
24355,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24355,Update Contract Line : discount is not updated," Bug Update contract line : price_ht (subprice with discount) is not updated. To update a contract line, function update() is used instead of updateline() function  Environment Version 17.0  Environment OS linux  Environment Web server _No response_  Environment PHP php 8.1  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Actual behavior : if I update a contract line, only subprice is updated Expected behavior : if I update a contract line, subprice and price_ht must be updated  Steps to reproduce the behavior - In a contract, edit the subprice of a line with a discount - In database, check the price_ht  Attached files _No response_",other-file | other-file,"Update Contract Line : discount is not updated  Bug Update contract line : price_ht (subprice with discount) is not updated. To update a contract line, function update() is used instead of updateline() function  Environment Version 17.0  Environment OS linux  Environment Web server _No response_  Environment PHP php 8.1  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Actual behavior : if I update a contract line, only subprice is updated Expected behavior : if I update a contract line, subprice and price_ht must be updated  Steps to reproduce the behavior - In a contract, edit the subprice of a line with a discount - In database, check the price_ht  Attached files _No response_ other-file other-file",no-bug,0.9
33595,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33595,Can't add component in a virtual product," Bug Can't add component in a virtual product - go on virtual product and try to add a component - you got a new blank page with only ""[object Object] "" as content  Dolibarr Version develop  Environment PHP PHP 7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Cretae a virtual product 2. Try to add a component 3. Click on ""+"" button ![Image](https://github.com/user-attachments/assets/ae41c1ec-b271-49cb-ace5-f64fa14e7c1c) The you got a new blank page with only this content : ![Image](https://github.com/user-attachments/assets/70304b62-ac75-4dbc-9a05-cc2f956c20bc)  Attached files _No response_",other-file | other-file,"Can't add component in a virtual product  Bug Can't add component in a virtual product - go on virtual product and try to add a component - you got a new blank page with only ""[object Object] "" as content  Dolibarr Version develop  Environment PHP PHP 7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Cretae a virtual product 2. Try to add a component 3. Click on ""+"" button ![Image](https://github.com/user-attachments/assets/ae41c1ec-b271-49cb-ace5-f64fa14e7c1c) The you got a new blank page with only this content : ![Image](https://github.com/user-attachments/assets/70304b62-ac75-4dbc-9a05-cc2f956c20bc)  Attached files _No response_ other-file other-file",no-bug,0.8
24260,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24260,DynamicPrices: Hook in function parseExpression does not use returned values," Bug In the module DynamicPrices the function parseExpression translates a formula for a dynamic price into a value. A hook exists to modify this function. However, when the function that is called by the hook is finished, the value of the call of the hook (reshook) is returned as the value of parseExpression instead of the result that was calculated by the hooked function (returned in resArray). This is in particular a problem, if the hook is used to replace the existing code (reshook > 0), but the return value is a 0. The existing code will then be executed and its result returned, which is not the intent.. Since the hook cannot modify the relevant input values, as they are not in the object but in parameters (values, expression), it can effectively only be used to replace the existing code, but with the return problem, in the current state, the hook is useless.  Environment Version 17  Expected and actual behavior Hook shall either replace the existing function and return a result like the existing function (i.e. the value of the parsed expression) (reshook > 0) or it should preprocess and modify some of the input values of the existing function, before it is executed (reshook == 0).",other-file,"DynamicPrices: Hook in function parseExpression does not use returned values  Bug In the module DynamicPrices the function parseExpression translates a formula for a dynamic price into a value. A hook exists to modify this function. However, when the function that is called by the hook is finished, the value of the call of the hook (reshook) is returned as the value of parseExpression instead of the result that was calculated by the hooked function (returned in resArray). This is in particular a problem, if the hook is used to replace the existing code (reshook > 0), but the return value is a 0. The existing code will then be executed and its result returned, which is not the intent.. Since the hook cannot modify the relevant input values, as they are not in the object but in parameters (values, expression), it can effectively only be used to replace the existing code, but with the return problem, in the current state, the hook is useless.  Environment Version 17  Expected and actual behavior Hook shall either replace the existing function and return a result like the existing function (i.e. the value of the parsed expression) (reshook > 0) or it should preprocess and modify some of the input values of the existing function, before it is executed (reshook == 0). other-file",no-bug,0.9
31152,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31152,Add SERVICE new line on a BOM tiny DB error when not enabled Workstations module [EASY FIX PROPOSED]," Bug **If you have not enabled STILL the Workstations module**, then there is database error when you access to BoM still in draft mode: ![imagen](https://github.com/user-attachments/assets/f818afcf-8518-46e4-99ce-954b0bc807e8) This is because in the `/bom/tpl/objectline_create.tpl.php` appear this:  print $formproduct->selectWorkstations('', 'idworkstations', 1);  before to check if the module Workstations is enabled. So it could be fixed adding this:  if (isModEnabled('workstation')) { $coldisplay++; print '<td class=""bordertop nobottom nowrap linecolworkstation"">'; print $formproduct->selectWorkstations('', 'idworkstations', 1); print '</td>'; }  as it appears on `/product/card.php` , but if you ask me would be a better solution (to avoid similar error on the future) to modify the function `selectWorkstations()` to **return empty string** when the module workstations is not enabled:  public function selectWorkstations($selected = '', $htmlname = 'idworkstations', ) { global $conf, $langs, $user, $hookmanager; if (!isModEnabled('workstation')) return ''; // < my proposed solution to avoid this error in the future  }  Note: this function is defined on `/product/class/html.formproduct.class.php`.  Dolibarr Version 19, 20  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. create a BoM draft, without having enabled the module Workstations Note: if you have enabled ONCE the module Workstations, then the table workstatiosn_workstations has been created and then you will not get the error. So, **this error only happens when you have not enabled never this module**.  Attached files _No response_",other-file,"Add SERVICE new line on a BOM tiny DB error when not enabled Workstations module [EASY FIX PROPOSED]  Bug **If you have not enabled STILL the Workstations module**, then there is database error when you access to BoM still in draft mode: ![imagen](https://github.com/user-attachments/assets/f818afcf-8518-46e4-99ce-954b0bc807e8) This is because in the `/bom/tpl/objectline_create.tpl.php` appear this:  print $formproduct->selectWorkstations('', 'idworkstations', 1);  before to check if the module Workstations is enabled. So it could be fixed adding this:  if (isModEnabled('workstation')) { $coldisplay++; print '<td class=""bordertop nobottom nowrap linecolworkstation"">'; print $formproduct->selectWorkstations('', 'idworkstations', 1); print '</td>'; }  as it appears on `/product/card.php` , but if you ask me would be a better solution (to avoid similar error on the future) to modify the function `selectWorkstations()` to **return empty string** when the module workstations is not enabled:  public function selectWorkstations($selected = '', $htmlname = 'idworkstations', ) { global $conf, $langs, $user, $hookmanager; if (!isModEnabled('workstation')) return ''; // < my proposed solution to avoid this error in the future  }  Note: this function is defined on `/product/class/html.formproduct.class.php`.  Dolibarr Version 19, 20  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. create a BoM draft, without having enabled the module Workstations Note: if you have enabled ONCE the module Workstations, then the table workstatiosn_workstations has been created and then you will not get the error. So, **this error only happens when you have not enabled never this module**.  Attached files _No response_ other-file",no-bug,0.9
28645,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28645,API bankaccounts/transfer POST missing the cheque_number field so it can be re-conciliated easily with the bank statement," Bug Hello, Into https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/compta/bank/class/api_bankaccounts.class.php#L202 it will be nice to have also the cheque_number field so it will be easier to compare with the bank statement and also make the reconciliation easily. Thanks,  Dolibarr Version 19.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"API bankaccounts/transfer POST missing the cheque_number field so it can be re-conciliated easily with the bank statement  Bug Hello, Into https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/compta/bank/class/api_bankaccounts.class.php#L202 it will be nice to have also the cheque_number field so it will be easier to compare with the bank statement and also make the reconciliation easily. Thanks,  Dolibarr Version 19.0  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
23064,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23064,List of interventions - Search and total," Bug Hye Sorry for my english. On the list, the search dont work with version 16.0.2 and 16.0.3 The search and after no result. And dont have the total on bottom -- Francais Dans la liste des interventions, on ne peux plus filtrer Quand on renseigne un tiers, on fait recherch, il sort un ecran blanc, sans resultat. De plus il n'y a plus le total des temps d'intervention en bas de la page. Version 16.0.2 et 16.0.3 Merci  Environment Version 16.0.3  Environment OS Ubuntu  Environment Web server Apache 2.4.52  Environment PHP 7.4.32  Environment Database MySQL or MariaDB 5.5.5-10.6.11-MariaDB-0ubuntu0.22.04.1  Environment URL(s) fichinter/list.php?leftmenu=ficheinter  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"List of interventions - Search and total  Bug Hye Sorry for my english. On the list, the search dont work with version 16.0.2 and 16.0.3 The search and after no result. And dont have the total on bottom -- Francais Dans la liste des interventions, on ne peux plus filtrer Quand on renseigne un tiers, on fait recherch, il sort un ecran blanc, sans resultat. De plus il n'y a plus le total des temps d'intervention en bas de la page. Version 16.0.2 et 16.0.3 Merci  Environment Version 16.0.3  Environment OS Ubuntu  Environment Web server Apache 2.4.52  Environment PHP 7.4.32  Environment Database MySQL or MariaDB 5.5.5-10.6.11-MariaDB-0ubuntu0.22.04.1  Environment URL(s) fichinter/list.php?leftmenu=ficheinter  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
31305,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31305,"[EPC-QR, Sponge]: No translation of ""INVOICE_ADD_EPC_QR_CODEPay"", Runtime error/misplaced text when INVOICE_ADD_EPC_QR_CODE==bottom"," Bug Hi, While playing with the account name issue in EPC QR, I also noticed that there is no translation of ""INVOICE_ADD_EPC_QR_CODEPay"" due to a missing domain in loadlangs. When placing the QR code at the bottom with ""INVOICE_ADD_EPC_QR_CODE""==bottom I got a runtime error because $langs was not available there (outputlangs is) and the descriptory text was placed within the QR code. The attached patch fixes all issues for me. Maybe it's of some use. Cheers, Michael  Dolibarr Version 20.0  Environment PHP 8.2.20-1~deb12u1  Environment Database PostgreSQL 15.8-0+deb12u1  Steps to reproduce the behavior and expected behavior _No response_  Attached files Patch fixing translation, QR Text placement (bottom) and runtime error (bottom) [epc-translation.patch.txt](https://github.com/user-attachments/files/17281419/epc-translation.patch.txt)",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"[EPC-QR, Sponge]: No translation of ""INVOICE_ADD_EPC_QR_CODEPay"", Runtime error/misplaced text when INVOICE_ADD_EPC_QR_CODE==bottom  Bug Hi, While playing with the account name issue in EPC QR, I also noticed that there is no translation of ""INVOICE_ADD_EPC_QR_CODEPay"" due to a missing domain in loadlangs. When placing the QR code at the bottom with ""INVOICE_ADD_EPC_QR_CODE""==bottom I got a runtime error because $langs was not available there (outputlangs is) and the descriptory text was placed within the QR code. The attached patch fixes all issues for me. Maybe it's of some use. Cheers, Michael  Dolibarr Version 20.0  Environment PHP 8.2.20-1~deb12u1  Environment Database PostgreSQL 15.8-0+deb12u1  Steps to reproduce the behavior and expected behavior _No response_  Attached files Patch fixing translation, QR Text placement (bottom) and runtime error (bottom) [epc-translation.patch.txt](https://github.com/user-attachments/files/17281419/epc-translation.patch.txt) other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
29338,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29338,v19.0.1 : Cannot view turnover invoiced by third parties, Bug Cannot view turnover invoiced by third parties URL : /compta/stats/casoc.php?leftmenu=report&modecompta=CREANCES-DETTES  Dolibarr Version 19.0.1  Environment PHP 8.2.7  Environment Database PostgreSQL 15.6  Steps to reproduce the behavior and expected behavior Go to Accounting > Reporting > Turnover invoiced > By third parties Expected : You should see all row Actual : Crash during first line In log : PHP Fatal error: Uncaught Error: Array callback must have exactly two elements in /home/crm/dolibarr-19.0.1/htdocs/compta/stats/casoc.php:638  Attached files ![image](https://github.com/Dolibarr/dolibarr/assets/11213740/02693f6d-b0bf-4dd4-a8e4-7c9f04b8652a),other-file,v19.0.1 : Cannot view turnover invoiced by third parties  Bug Cannot view turnover invoiced by third parties URL : /compta/stats/casoc.php?leftmenu=report&modecompta=CREANCES-DETTES  Dolibarr Version 19.0.1  Environment PHP 8.2.7  Environment Database PostgreSQL 15.6  Steps to reproduce the behavior and expected behavior Go to Accounting > Reporting > Turnover invoiced > By third parties Expected : You should see all row Actual : Crash during first line In log : PHP Fatal error: Uncaught Error: Array callback must have exactly two elements in /home/crm/dolibarr-19.0.1/htdocs/compta/stats/casoc.php:638  Attached files ![image](https://github.com/Dolibarr/dolibarr/assets/11213740/02693f6d-b0bf-4dd4-a8e4-7c9f04b8652a) other-file,no-bug,0.9
26504,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26504,"Default value for extrafields of lines of object (propal, invoice, etc) doesn't work"," Bug If I create an extrafield for a line of an object such as proposal, invoice, etc, and set up a default value, it doesn't work as intended. For example : a boolean extrafield checked by default. I'm creating this issue and I'll push my PR with the solution right away  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"Default value for extrafields of lines of object (propal, invoice, etc) doesn't work  Bug If I create an extrafield for a line of an object such as proposal, invoice, etc, and set up a default value, it doesn't work as intended. For example : a boolean extrafield checked by default. I'm creating this issue and I'll push my PR with the solution right away  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.8
29314,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29314,"Massaction ""Send E-Mail"" to attendees not working in Event Organization"," Bug Massaction ""Send E-Mail"" to attendees not working in Event Organization  Dolibarr Version 18.0, 19.0, develop  Environment PHP 8.1  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Create a project and enable event organization 2. Navigate to eventorganization/conferenceorboothattendee_list.php 3. Add 2 or more attendees with e-mail adresses 4. Select the attendees in the list 5. Select mass-action ""send email"" and click confirm Current behavior: form to send mail is not showing up Expected behavior: form to send mail should be displayed to allow to send mass mail to all attendees Root-cause of this bug is, that in the function `getCommonSubstitutionArray` the method `getFullName` is called for the object which is an instance of `ConferenceOrBoothAttendee` in this case. But this method is not implemented for `ConferenceOrBoothAttendee`.  Attached files _No response_",other-file | other-file,"Massaction ""Send E-Mail"" to attendees not working in Event Organization  Bug Massaction ""Send E-Mail"" to attendees not working in Event Organization  Dolibarr Version 18.0, 19.0, develop  Environment PHP 8.1  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Create a project and enable event organization 2. Navigate to eventorganization/conferenceorboothattendee_list.php 3. Add 2 or more attendees with e-mail adresses 4. Select the attendees in the list 5. Select mass-action ""send email"" and click confirm Current behavior: form to send mail is not showing up Expected behavior: form to send mail should be displayed to allow to send mass mail to all attendees Root-cause of this bug is, that in the function `getCommonSubstitutionArray` the method `getFullName` is called for the object which is an instance of `ConferenceOrBoothAttendee` in this case. But this method is not implemented for `ConferenceOrBoothAttendee`.  Attached files _No response_ other-file other-file",no-bug,0.9
25335,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25335,Tools --> Email Templates section visible for all users," Bug All users can see the Tools --> Email Templates section. The section is empty for the users with no authorization, but still visible, even with the setting to hide all sections with no authorizations.  Environment Version 17.0.2  Environment OS Linux br-asc-web888.main-hosting.eu 4.18.0-425.3.1.lve.3.el8.x86_64  Environment Web server LiteSpeed  Environment PHP 8.0.28  Environment Database MariaDB 10.6.12-MariaDB-cll-lve  Environment URL(s) admin/mails_templates.php?leftmenu=email_templates  Expected and actual behavior Section shuold be hidden, or have an option to hide it  Steps to reproduce the behavior Login with a user with no authorizations, and check the Tools --> Email Templates section.  Attached files ![email templates](https://github.com/Dolibarr/dolibarr/assets/13504962/fdaf398c-fb71-42f3-8ba1-93e9fdba6491)",other-file | other-file,"Tools --> Email Templates section visible for all users  Bug All users can see the Tools --> Email Templates section. The section is empty for the users with no authorization, but still visible, even with the setting to hide all sections with no authorizations.  Environment Version 17.0.2  Environment OS Linux br-asc-web888.main-hosting.eu 4.18.0-425.3.1.lve.3.el8.x86_64  Environment Web server LiteSpeed  Environment PHP 8.0.28  Environment Database MariaDB 10.6.12-MariaDB-cll-lve  Environment URL(s) admin/mails_templates.php?leftmenu=email_templates  Expected and actual behavior Section shuold be hidden, or have an option to hide it  Steps to reproduce the behavior Login with a user with no authorizations, and check the Tools --> Email Templates section.  Attached files ![email templates](https://github.com/Dolibarr/dolibarr/assets/13504962/fdaf398c-fb71-42f3-8ba1-93e9fdba6491) other-file other-file",no-bug,0.9
30161,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30161,Ticket API endpoints are not working - getByRef and getByTrackID," Bug API Endpoints for the ticket module `getByRef` and `getByTrackId` are not working at all. They always returns a specimen ticket even when provided a known ref or track_id. The problem lies in the `api_tickets.class.php` file, in the `getCommon` function and its calls: php private function getCommon($id = 0, $track_id = '', $ref = '') { if (!DolibarrApiAccess::$user->hasRight('ticket', 'read')) { throw new RestException(403); } if (($id < 0) && !$track_id && !$ref) { throw new RestException(400, 'Wrong parameters'); } if ($id == 0) { $result = $this->ticket->initAsSpecimen(); } else { $result = $this->ticket->fetch($id, $ref, $track_id); } if (!$result) { throw new RestException(404, 'Ticket not found'); }  php public function getByRef($ref) { return $this->getCommon(0, '', $ref); } public function getByTrackId($track_id) { return $this->getCommon(0, $track_id, ''); }  Since `id` is always 0, the condition `id == 0` is always true in these cases and never try to fetch the ticket with the provided property. The condition should check for the lack of ref and track_id in order to return a specimen ticket. diff -if ($id == 0) { +if ($id == 0 && empty($ref) && empty($track_id)) {   Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. With the ticket module and API module enabled 2. Create one or more tickets 3. Open the API Explorer 4. Try the endpoints with - An existing ref - An non existing ref  Attached files _No response_",other-file,"Ticket API endpoints are not working - getByRef and getByTrackID  Bug API Endpoints for the ticket module `getByRef` and `getByTrackId` are not working at all. They always returns a specimen ticket even when provided a known ref or track_id. The problem lies in the `api_tickets.class.php` file, in the `getCommon` function and its calls: php private function getCommon($id = 0, $track_id = '', $ref = '') { if (!DolibarrApiAccess::$user->hasRight('ticket', 'read')) { throw new RestException(403); } if (($id < 0) && !$track_id && !$ref) { throw new RestException(400, 'Wrong parameters'); } if ($id == 0) { $result = $this->ticket->initAsSpecimen(); } else { $result = $this->ticket->fetch($id, $ref, $track_id); } if (!$result) { throw new RestException(404, 'Ticket not found'); }  php public function getByRef($ref) { return $this->getCommon(0, '', $ref); } public function getByTrackId($track_id) { return $this->getCommon(0, $track_id, ''); }  Since `id` is always 0, the condition `id == 0` is always true in these cases and never try to fetch the ticket with the provided property. The condition should check for the lack of ref and track_id in order to return a specimen ticket. diff -if ($id == 0) { +if ($id == 0 && empty($ref) && empty($track_id)) {   Dolibarr Version 19.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior 1. With the ticket module and API module enabled 2. Create one or more tickets 3. Open the API Explorer 4. Try the endpoints with - An existing ref - An non existing ref  Attached files _No response_ other-file",bug,0.95
26009,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26009,Closed job positions still available for a new application," Bug When you create a new job application, closed (canceld & recruited) job positions are still available to select.  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected: show only the opened job positions  Steps to reproduce the behavior _No response_  Attached files ![Screenshot 2023-09-23 13 26 34](https://github.com/Dolibarr/dolibarr/assets/115941074/75e679b0-4896-47d5-9c90-d5e98e95a147) ![Screenshot 2023-09-23 13 26 49](https://github.com/Dolibarr/dolibarr/assets/115941074/2abfa10c-c03f-49c1-8611-23c20f2eb697)",other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Closed job positions still available for a new application  Bug When you create a new job application, closed (canceld & recruited) job positions are still available to select.  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected: show only the opened job positions  Steps to reproduce the behavior _No response_  Attached files ![Screenshot 2023-09-23 13 26 34](https://github.com/Dolibarr/dolibarr/assets/115941074/75e679b0-4896-47d5-9c90-d5e98e95a147) ![Screenshot 2023-09-23 13 26 49](https://github.com/Dolibarr/dolibarr/assets/115941074/2abfa10c-c03f-49c1-8611-23c20f2eb697) other-file other-file other-file other-file other-file other-file other-file",no-bug,0.8
28533,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28533,"BUG: Mo::deleteLine removes the ""main"" MoLine if consumed line is delete + GETPOST in class"," Bug At MoLine with Product type ""Services"": Delete consumed line ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/8e675231-bcd6-4a43-a12a-4a7882e783b5) The result the parent MoLine is deleted: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/6a71fe01-e1ac-41fc-8713-c28b71b190a8) In the database is the main MoLine deleted, but the linked MoLine is existing! ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/4f976b08-02aa-404b-9c64-856f54bca170)  Environment Version 19  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | test-file | other-file,"BUG: Mo::deleteLine removes the ""main"" MoLine if consumed line is delete + GETPOST in class  Bug At MoLine with Product type ""Services"": Delete consumed line ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/8e675231-bcd6-4a43-a12a-4a7882e783b5) The result the parent MoLine is deleted: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/6a71fe01-e1ac-41fc-8713-c28b71b190a8) In the database is the main MoLine deleted, but the linked MoLine is existing! ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/4f976b08-02aa-404b-9c64-856f54bca170)  Environment Version 19  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file test-file other-file",no-bug,0.9
25127,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25127,Unable to use cancel action on form with mandatory fields defined in llx_default_values table," Bug If you set a field as mandatory on the /admin/defaultvalues.php page, you can't use the CANCEL button on the form without filling out the mandatory field. Issue is due to the fact that the CANCEL button is a SUBMIT button with name set to cancel. So you have to submit the form if you want to cancel your action. And because the field has now the property ""required"", the browser will not allow you to submit the form. Property required is set with the following JS code https://github.com/Dolibarr/dolibarr/blob/128b31feccd9edc7c1087c55b9eba9e1800b2dad/htdocs/core/lib/functions.lib.php#L9834  Environment Version 16, 17, 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Actual behavior : unable to use the cancel button without filling out user configured mandatory fields Expected behavior : ability to use the cancel button without filling out the form  Steps to reproduce the behavior 1. Define the field `accountancy_code_sell` as mandatory on url `product/card.php` on the admin page `/admin/defaultvalues.php` 2. Create a new product 3. Clic on cancel button  Attached files _No response_",other-file,"Unable to use cancel action on form with mandatory fields defined in llx_default_values table  Bug If you set a field as mandatory on the /admin/defaultvalues.php page, you can't use the CANCEL button on the form without filling out the mandatory field. Issue is due to the fact that the CANCEL button is a SUBMIT button with name set to cancel. So you have to submit the form if you want to cancel your action. And because the field has now the property ""required"", the browser will not allow you to submit the form. Property required is set with the following JS code https://github.com/Dolibarr/dolibarr/blob/128b31feccd9edc7c1087c55b9eba9e1800b2dad/htdocs/core/lib/functions.lib.php#L9834  Environment Version 16, 17, 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Actual behavior : unable to use the cancel button without filling out user configured mandatory fields Expected behavior : ability to use the cancel button without filling out the form  Steps to reproduce the behavior 1. Define the field `accountancy_code_sell` as mandatory on url `product/card.php` on the admin page `/admin/defaultvalues.php` 2. Create a new product 3. Clic on cancel button  Attached files _No response_ other-file",no-bug,0.9
26740,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26740,MAIN_DIRECT_STATUS_UPDATE has failed on v18.0.3, Bug The quick status button for product are not working on v 18.0.3 sine i just upgrade from 16.0.5 .  Environment Version 18.0.3  Environment OS Debian 4.19.67-2+deb10u2  Environment Web server Apache/2.4.38 (Debian)  Environment PHP 7.4.3  Environment Database MariaDB 5.5.5-10.3.39  Environment URL(s) /product/card.php?id=550  Expected and actual behavior Should could change status of product by click quick button .  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,MAIN_DIRECT_STATUS_UPDATE has failed on v18.0.3  Bug The quick status button for product are not working on v 18.0.3 sine i just upgrade from 16.0.5 .  Environment Version 18.0.3  Environment OS Debian 4.19.67-2+deb10u2  Environment Web server Apache/2.4.38 (Debian)  Environment PHP 7.4.3  Environment Database MariaDB 5.5.5-10.3.39  Environment URL(s) /product/card.php?id=550  Expected and actual behavior Should could change status of product by click quick button .  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.7
28582,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28582,"Bug: Contribution details for a membership contributions contains a label field with contents, but it is not shown"," Bug Bug: Contribution details for a membership contributions contains a label field with contents, but it is not shown in the detailed view of a contribution. It is shown in the overview of all contributions though.  Environment Version docker.io/tuxgasy/dolibarr:18.0.4  Environment OS docker.io/tuxgasy/dolibarr:18.0.4  Environment Web server docker.io/tuxgasy/dolibarr:18.0.4  Environment PHP PHP 8.1.20 (cli) (built: Jun 13 2023 12:02:18) (NTS)  Environment Database 1:11.0.3+maria~ubu2204  Environment URL(s) /adherents/subscription/card.php?rowid=  Expected and actual behavior I would expect the label field to contain the same data as in the overview. Actual behaviour is an empty field.  Steps to reproduce the behavior Find an existing contribution or create a contribution for membership. Preferably one which has a label ![contribution_overview](https://github.com/Dolibarr/dolibarr/assets/2551481/4a9e42c6-edd2-4092-95ca-43ba730a3495) click on the contribution ref and see that label field is empty ![contribution_details](https://github.com/Dolibarr/dolibarr/assets/2551481/81572374-579e-47b3-9c94-5da494fd2cdf) click modify and fill out a new label ![modify_label](https://github.com/Dolibarr/dolibarr/assets/2551481/ea03ab7a-9767-445d-9081-5ee882780123) Save and you get back to the contribution details - but you still can not see the label in the contribution details view. However back in the Contribution overview the label will be changed.  Attached files _No response_",other-file,"Bug: Contribution details for a membership contributions contains a label field with contents, but it is not shown  Bug Bug: Contribution details for a membership contributions contains a label field with contents, but it is not shown in the detailed view of a contribution. It is shown in the overview of all contributions though.  Environment Version docker.io/tuxgasy/dolibarr:18.0.4  Environment OS docker.io/tuxgasy/dolibarr:18.0.4  Environment Web server docker.io/tuxgasy/dolibarr:18.0.4  Environment PHP PHP 8.1.20 (cli) (built: Jun 13 2023 12:02:18) (NTS)  Environment Database 1:11.0.3+maria~ubu2204  Environment URL(s) /adherents/subscription/card.php?rowid=  Expected and actual behavior I would expect the label field to contain the same data as in the overview. Actual behaviour is an empty field.  Steps to reproduce the behavior Find an existing contribution or create a contribution for membership. Preferably one which has a label ![contribution_overview](https://github.com/Dolibarr/dolibarr/assets/2551481/4a9e42c6-edd2-4092-95ca-43ba730a3495) click on the contribution ref and see that label field is empty ![contribution_details](https://github.com/Dolibarr/dolibarr/assets/2551481/81572374-579e-47b3-9c94-5da494fd2cdf) click modify and fill out a new label ![modify_label](https://github.com/Dolibarr/dolibarr/assets/2551481/ea03ab7a-9767-445d-9081-5ee882780123) Save and you get back to the contribution details - but you still can not see the label in the contribution details view. However back in the Contribution overview the label will be changed.  Attached files _No response_ other-file",no-bug,0.8
25005,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25005,Invalid Security Key when opening the Public Attendee Subscription Global Page, Bug When an event is created and you click on the link for the public page you get the following error message : La cl de scurit est invalide ou manquante The key appears in the url of the page.  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,Invalid Security Key when opening the Public Attendee Subscription Global Page  Bug When an event is created and you click on the link for the public page you get the following error message : La cl de scurit est invalide ou manquante The key appears in the url of the page.  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.8
26660,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26660,Hook on task getNomUrl, Feature Request Add a hook on the getNomUrl of task object like others  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file,Hook on task getNomUrl  Feature Request Add a hook on the getNomUrl of task object like others  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file,no-bug,0.9
26225,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26225,"Accountancy report : ""from date"" after ""to date"" - wrong year", Bug accountancy report > Net income by years (Rsultat / exercice in french) When I click an the amont on a specific month to see the detail (ie: month of december 2023) ![image](https://github.com/Dolibarr/dolibarr/assets/63582926/5860861f-3979-4858-b2d3-22d5d852a790) THe from date is on next year ( ie : 01/12/2024 . expected 01/12/2023) ![image](https://github.com/Dolibarr/dolibarr/assets/63582926/83643de3-8f1c-42ae-89b4-110e8f33beb8)  Environment Version 18.0.2  Environment OS LINUX (RASPBIAN 11 bullseye)  Environment Web server APACHE  Environment PHP PHP 8.1.20  Environment Database MARIADB 10.11  Environment URL(s) _No response_  Expected and actual behavior see description  Steps to reproduce the behavior Comptabilit > rapport > Rsultat/exercice Cliquer sur le montant afficher pour un mois.  Attached files _No response_,other-file | other-file,"Accountancy report : ""from date"" after ""to date"" - wrong year  Bug accountancy report > Net income by years (Rsultat / exercice in french) When I click an the amont on a specific month to see the detail (ie: month of december 2023) ![image](https://github.com/Dolibarr/dolibarr/assets/63582926/5860861f-3979-4858-b2d3-22d5d852a790) THe from date is on next year ( ie : 01/12/2024 . expected 01/12/2023) ![image](https://github.com/Dolibarr/dolibarr/assets/63582926/83643de3-8f1c-42ae-89b4-110e8f33beb8)  Environment Version 18.0.2  Environment OS LINUX (RASPBIAN 11 bullseye)  Environment Web server APACHE  Environment PHP PHP 8.1.20  Environment Database MARIADB 10.11  Environment URL(s) _No response_  Expected and actual behavior see description  Steps to reproduce the behavior Comptabilit > rapport > Rsultat/exercice Cliquer sur le montant afficher pour un mois.  Attached files _No response_ other-file other-file",no-bug,0.9
32355,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32355,LNE-202407 - missing number of POS, Feature Request Il est dans la facture mais pas de la block log Enregristre le RowID ![image](https://github.com/user-attachments/assets/33cda04f-1434-42c9-bf35-f9875bef689f) ![image](https://github.com/user-attachments/assets/11097486-eae1-41f2-8b2b-85841fdc0953),other-file | other-file,LNE-202407 - missing number of POS  Feature Request Il est dans la facture mais pas de la block log Enregristre le RowID ![image](https://github.com/user-attachments/assets/33cda04f-1434-42c9-bf35-f9875bef689f) ![image](https://github.com/user-attachments/assets/11097486-eae1-41f2-8b2b-85841fdc0953) other-file other-file,no-bug,0.9
25242,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25242,BOM - Calculate quantity on line of services with service data to keep the consistency of the data, Feature Request Add field quantity calculed Qt (unit) * Dure (Unit) = Quantity calculed ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/d48b94a0-6791-4116-bf7b-6dbf063927f0)  Use case We find the same operation in the invoicing of time in the tasks The operation is identical for the time calculated from the time of the tasks via a service ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/101660ba-62ce-43d8-939f-fdb7b2e33799) In invoice ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/ca54b4d1-33f3-4c2b-b68c-ccd2f3e2e670)  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,BOM - Calculate quantity on line of services with service data to keep the consistency of the data  Feature Request Add field quantity calculed Qt (unit) * Dure (Unit) = Quantity calculed ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/d48b94a0-6791-4116-bf7b-6dbf063927f0)  Use case We find the same operation in the invoicing of time in the tasks The operation is identical for the time calculated from the time of the tasks via a service ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/101660ba-62ce-43d8-939f-fdb7b2e33799) In invoice ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/ca54b4d1-33f3-4c2b-b68c-ccd2f3e2e670)  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file other-file other-file other-file other-file,no-bug,0.95
26215,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26215,Fatal PHP error on saving modified intervention line," Bug When trying to save a modified line in an intervention the following PHP error is generated: `Fatal error: Uncaught TypeError: array_merge(): Argument #2 must be of type array, int given in \devDolibarr\htdocs\fichinter\card.php:629 Stack trace: #0 \devDolibarr\htdocs\fichinter\card.php(629): array_merge(Array, 0) #1 {main} thrown in \devDolibarr\htdocs\fichinter\card.php on line 629` **Remarks:** - Bug doesn't exist if intervention lines have extrafields - This might be linked to commit ef4000b in PR #24329  Environment Version 19.0  Environment OS Ubuntu 20.04  Environment Web server Apache 2.4  Environment PHP 8.0  Environment Database MariaDB 10.4  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior 1. Create a new intervention 2. Add a new line to the intervention 3. Modify the date, the time, the duration or the description 4. Save the modified intervention line  Attached files _No response_",other-file,"Fatal PHP error on saving modified intervention line  Bug When trying to save a modified line in an intervention the following PHP error is generated: `Fatal error: Uncaught TypeError: array_merge(): Argument #2 must be of type array, int given in \devDolibarr\htdocs\fichinter\card.php:629 Stack trace: #0 \devDolibarr\htdocs\fichinter\card.php(629): array_merge(Array, 0) #1 {main} thrown in \devDolibarr\htdocs\fichinter\card.php on line 629` **Remarks:** - Bug doesn't exist if intervention lines have extrafields - This might be linked to commit ef4000b in PR #24329  Environment Version 19.0  Environment OS Ubuntu 20.04  Environment Web server Apache 2.4  Environment PHP 8.0  Environment Database MariaDB 10.4  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior 1. Create a new intervention 2. Add a new line to the intervention 3. Modify the date, the time, the duration or the description 4. Save the modified intervention line  Attached files _No response_ other-file",no-bug,0.8
23415,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23415,REST BOM API - It's able to have a wrong value on the 'ref' Field," Bug It's able to have a wrong value on the 'ref' Field by adding or updating a BOM.  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP PHP 8.1.10  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior **Actual behavior / Problems:** - **If you update a BOM with the API you can change the the status from DRAFT to a other Status, with the same ref e.g. '(PROV54)'** - Currently the 'ref' Field is required. So you can not use the Dolibarr NextNum Generator. **Expected behavior** - If no 'ref' is set on create and the status is 0 (DRAFT) then create a ref '(PROF)'. - If no 'ref' is set on create and the status is grater then > 0, then create a 'ref' with number generator. - If 'ref' is set, use the value from the REST-Call.  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"REST BOM API - It's able to have a wrong value on the 'ref' Field  Bug It's able to have a wrong value on the 'ref' Field by adding or updating a BOM.  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP PHP 8.1.10  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior **Actual behavior / Problems:** - **If you update a BOM with the API you can change the the status from DRAFT to a other Status, with the same ref e.g. '(PROV54)'** - Currently the 'ref' Field is required. So you can not use the Dolibarr NextNum Generator. **Expected behavior** - If no 'ref' is set on create and the status is 0 (DRAFT) then create a ref '(PROF)'. - If no 'ref' is set on create and the status is grater then > 0, then create a 'ref' with number generator. - If 'ref' is set, use the value from the REST-Call.  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file",bug,0.85
28168,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28168,SecurityTest::testGetURLContent fails - ftp connection is allowed despite default options," Bug The test case wants to validate the an ftp request is not possible, however it gets a ""Connection refused back"" with a port number. To make sure that an attempt to connect was made, I added a valid ftp server and got the following reply:  1) SecurityTest::testGetURLContent Did not get 'not supported' in Access denied: 530 Failed asserting that 0 is true.  The reason this is possible is not obvious from the code.  Environment Version develop/8592f6ba492/ed1e818ada9  Environment OS Windows 10  Environment PHP c:\wamp64\bin\php\php7.4.33\ phpunit 9.5  Steps to reproduce the behavior Run SecurityTest with phpunit (on windows).",other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file,"SecurityTest::testGetURLContent fails - ftp connection is allowed despite default options  Bug The test case wants to validate the an ftp request is not possible, however it gets a ""Connection refused back"" with a port number. To make sure that an attempt to connect was made, I added a valid ftp server and got the following reply:  1) SecurityTest::testGetURLContent Did not get 'not supported' in Access denied: 530 Failed asserting that 0 is true.  The reason this is possible is not obvious from the code.  Environment Version develop/8592f6ba492/ed1e818ada9  Environment OS Windows 10  Environment PHP c:\wamp64\bin\php\php7.4.33\ phpunit 9.5  Steps to reproduce the behavior Run SecurityTest with phpunit (on windows). other-file test-file other-file test-file other-file test-file other-file test-file other-file test-file other-file test-file",no-bug,0.9
25860,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25860,Can't decrypt encrypted data if instance_unique_id is not defined, Bug [dolEncrypt](https://github.com/Dolibarr/dolibarr/blob/9c903ecf56d3650bcacce4b47eb0e4e26f8f3a1b/htdocs/core/lib/security.lib.php#L122C10-L122C20) function allows to encrypt data even if instance_unique_id is not defined. But [dolDecrypt](https://github.com/Dolibarr/dolibarr/blob/9c903ecf56d3650bcacce4b47eb0e4e26f8f3a1b/htdocs/core/lib/security.lib.php#L177) function fails if it is empty. https://github.com/Dolibarr/dolibarr/blob/9c903ecf56d3650bcacce4b47eb0e4e26f8f3a1b/htdocs/core/lib/security.lib.php#L193C4-L195 I'm not sure what is the best solution: allow to decrypt data even or not allow to encrypt data if instance_unique_id is empty.  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,Can't decrypt encrypted data if instance_unique_id is not defined  Bug [dolEncrypt](https://github.com/Dolibarr/dolibarr/blob/9c903ecf56d3650bcacce4b47eb0e4e26f8f3a1b/htdocs/core/lib/security.lib.php#L122C10-L122C20) function allows to encrypt data even if instance_unique_id is not defined. But [dolDecrypt](https://github.com/Dolibarr/dolibarr/blob/9c903ecf56d3650bcacce4b47eb0e4e26f8f3a1b/htdocs/core/lib/security.lib.php#L177) function fails if it is empty. https://github.com/Dolibarr/dolibarr/blob/9c903ecf56d3650bcacce4b47eb0e4e26f8f3a1b/htdocs/core/lib/security.lib.php#L193C4-L195 I'm not sure what is the best solution: allow to decrypt data even or not allow to encrypt data if instance_unique_id is empty.  Environment Version 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
25926,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25926,Error on the uk_links index of the llx_links table," Bug When adding a new URL link to an object, if this object has the same ID as another object of a different type and the link has the same label as the other object's link, the link is not added.  Environment Version 18.0.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Actual index :  CREATE UNIQUE INDEX IF NOT EXISTS uk_links ON public.llx_links USING btree (objectid ASC NULLS LAST, label COLLATE pg_catalog.""default"" ASC NULLS LAST) TABLESPACE pg_default;  Expected index :  CREATE UNIQUE INDEX IF NOT EXISTS uk_links ON public.llx_links USING btree (objectid ASC NULLS LAST, objecttype COLLATE pg_catalog.""default"" ASC NULLS LAST, label COLLATE pg_catalog.""default"" ASC NULLS LAST) TABLESPACE pg_default;   Steps to reproduce the behavior _No response_  Attached files Link in table : ![image](https://github.com/Dolibarr/dolibarr/assets/145106194/60920756-52dd-4c15-b024-04702780c50e) Link to add : ![image](https://github.com/Dolibarr/dolibarr/assets/145106194/85c334c6-7ba1-450b-8de7-8d2055bb600d)",database-file | database-file | database-file | database-file,"Error on the uk_links index of the llx_links table  Bug When adding a new URL link to an object, if this object has the same ID as another object of a different type and the link has the same label as the other object's link, the link is not added.  Environment Version 18.0.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Actual index :  CREATE UNIQUE INDEX IF NOT EXISTS uk_links ON public.llx_links USING btree (objectid ASC NULLS LAST, label COLLATE pg_catalog.""default"" ASC NULLS LAST) TABLESPACE pg_default;  Expected index :  CREATE UNIQUE INDEX IF NOT EXISTS uk_links ON public.llx_links USING btree (objectid ASC NULLS LAST, objecttype COLLATE pg_catalog.""default"" ASC NULLS LAST, label COLLATE pg_catalog.""default"" ASC NULLS LAST) TABLESPACE pg_default;   Steps to reproduce the behavior _No response_  Attached files Link in table : ![image](https://github.com/Dolibarr/dolibarr/assets/145106194/60920756-52dd-4c15-b024-04702780c50e) Link to add : ![image](https://github.com/Dolibarr/dolibarr/assets/145106194/85c334c6-7ba1-450b-8de7-8d2055bb600d) database-file database-file database-file database-file",no-bug,0.9
28481,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28481,"BUG: REST API ""/mos/{id}/produceandconsume"" not working and have a confuse behavior"," Bug Hi,. either I don't understand the API function or it doesn't work. I tried now a few hours id: 21 request_data: `{ ""inventorylabel"": ""Produce and consume using API"", ""inventorycode"": ""PRODUCEAPI-YY-MM-DD"", ""autoclose"": 1, ""arraytoconsume"": [{ ""objectid"": ""203"", ""fk_warehouse"": ""677"", ""qty"": ""1"" }], ""arraytoproduce"": [] }` The data origin: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/ead6cc0c-b020-4eec-b2bb-cfe66d7ae7d5) **I hope anyone can help me, its very import for my project.** Thank you together! Best regards Christian  Environment Version 1719  Environment OS Ubuntu  Environment Web server _No response_  Environment PHP 8.2  Environment Database mariaDB  Environment URL(s) http://localhost/dolibarr/htdocs/api/index.php/mos/{ID}/produceandconsume  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",config-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"BUG: REST API ""/mos/{id}/produceandconsume"" not working and have a confuse behavior  Bug Hi,. either I don't understand the API function or it doesn't work. I tried now a few hours id: 21 request_data: `{ ""inventorylabel"": ""Produce and consume using API"", ""inventorycode"": ""PRODUCEAPI-YY-MM-DD"", ""autoclose"": 1, ""arraytoconsume"": [{ ""objectid"": ""203"", ""fk_warehouse"": ""677"", ""qty"": ""1"" }], ""arraytoproduce"": [] }` The data origin: ![image](https://github.com/Dolibarr/dolibarr/assets/78662388/ead6cc0c-b020-4eec-b2bb-cfe66d7ae7d5) **I hope anyone can help me, its very import for my project.** Thank you together! Best regards Christian  Environment Version 1719  Environment OS Ubuntu  Environment Web server _No response_  Environment PHP 8.2  Environment Database mariaDB  Environment URL(s) http://localhost/dolibarr/htdocs/api/index.php/mos/{ID}/produceandconsume  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ config-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.8
30432,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30432,Unable to modify client_code through thirdparties rest API,"Hello, I am currently trying to modify a client_code through the Thirdparties Rest API. I have adjusted Dolibarr's Thirdparties configuration to allow custom client codes (via the Leopard Module). However, it appears that modifying the client code through the API is not allowed. Could you please explain the reasoning behind this restriction? Additionally, is there any solution to bypass this issue without having to manually modify every code? After some investigation, it seems the issue originates from the following line: https://github.com/Dolibarr/dolibarr/blame/1b5eb2de22ccee5377549a219d0448f1e3026117/htdocs/societe/class/api_thirdparties.class.php#L299 **Steps to Reproduce:** - Execute the following CURL command : curl -X PUT --header 'Content-Type: application/json' --header 'Accept: application/json' --header 'DOLAPIKEY: key' -d '{ ""code_client"" : ""new code"" }' 'https://dolibarr-server.fr/api/index.php/thirdparties/id' - Attempt to modify the client code via the API, the Swagger UI, or the above CURL command - Observe that the API returns a 200 code without modifying the client. **Expected Behavior:** I expected to be able to update the client code through the API. **Actual Behavior:** The client code remains unchanged and the modification is blocked. Thank you very much for your assistance. Best regards, Lorenzo",other-file | other-file,"Unable to modify client_code through thirdparties rest API Hello, I am currently trying to modify a client_code through the Thirdparties Rest API. I have adjusted Dolibarr's Thirdparties configuration to allow custom client codes (via the Leopard Module). However, it appears that modifying the client code through the API is not allowed. Could you please explain the reasoning behind this restriction? Additionally, is there any solution to bypass this issue without having to manually modify every code? After some investigation, it seems the issue originates from the following line: https://github.com/Dolibarr/dolibarr/blame/1b5eb2de22ccee5377549a219d0448f1e3026117/htdocs/societe/class/api_thirdparties.class.php#L299 **Steps to Reproduce:** - Execute the following CURL command : curl -X PUT --header 'Content-Type: application/json' --header 'Accept: application/json' --header 'DOLAPIKEY: key' -d '{ ""code_client"" : ""new code"" }' 'https://dolibarr-server.fr/api/index.php/thirdparties/id' - Attempt to modify the client code via the API, the Swagger UI, or the above CURL command - Observe that the API returns a 200 code without modifying the client. **Expected Behavior:** I expected to be able to update the client code through the API. **Actual Behavior:** The client code remains unchanged and the modification is blocked. Thank you very much for your assistance. Best regards, Lorenzo other-file other-file",bug,0.9
25580,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25580,install/step1.php : wrong command line argument used for $main_dir," Bug In `install/step1.php`, when calling this initial setup script in command line, `$main_dir` is (re)set to `$argv[1]`, which stands for `$action`, instead of `$argv[3]`. This results in producing an error and exiting when testing that directory exists and is a dolibarr one.  Environment Version All from 11.0 and above  Environment OS Linux ubuntu 22.04  Environment Web server Apache/2.4.57 (Ubuntu)  Environment PHP PHP 7.4.33  Environment Database MySQL or MariaDB 8.0.32  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"install/step1.php : wrong command line argument used for $main_dir  Bug In `install/step1.php`, when calling this initial setup script in command line, `$main_dir` is (re)set to `$argv[1]`, which stands for `$action`, instead of `$argv[3]`. This results in producing an error and exiting when testing that directory exists and is a dolibarr one.  Environment Version All from 11.0 and above  Environment OS Linux ubuntu 22.04  Environment Web server Apache/2.4.57 (Ubuntu)  Environment PHP PHP 7.4.33  Environment Database MySQL or MariaDB 8.0.32  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.9
23785,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23785,"Box ""Last changed vendors"": External users can see all suppliers on htdocs/comm/index.php"," Bug Box ""Last changed vendors"": External users can see all suppliers on htdocs/comm/index.php  Environment Version 16.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) htdocs/comm/index.php  Expected and actual behavior External users should see only their own company  Steps to reproduce the behavior 1. Create an external user 2. Navigate to htdocs/comm/index.php  Attached files _No response_",other-file,"Box ""Last changed vendors"": External users can see all suppliers on htdocs/comm/index.php  Bug Box ""Last changed vendors"": External users can see all suppliers on htdocs/comm/index.php  Environment Version 16.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) htdocs/comm/index.php  Expected and actual behavior External users should see only their own company  Steps to reproduce the behavior 1. Create an external user 2. Navigate to htdocs/comm/index.php  Attached files _No response_ other-file",no-bug,0.8
26961,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26961,llx_c_departements error with ISO_3166 / romania," Bug There is at least one error on llx_c_departements with Bucuresti:  INSERT INTO llx_c_departements (fk_region, code_departement, cheflieu, tncc, ncc, nom) VALUES (18801, 'BU', '', 0, '', 'Bucuresti');  But in https://fr.wikipedia.org/wiki/ISO_3166-2:RO there is no ""-BU"" for Bucuresti, only ""-B""  maybe others errors like that, so what do we have to do in such situation ? The main problem for me is about peppol xml electronic invoices for Romania, RO-BU is refused by official system when invoices comes so we have to change dolibarr database to use RO-B  are your ok for such PR ?  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",database-file,"llx_c_departements error with ISO_3166 / romania  Bug There is at least one error on llx_c_departements with Bucuresti:  INSERT INTO llx_c_departements (fk_region, code_departement, cheflieu, tncc, ncc, nom) VALUES (18801, 'BU', '', 0, '', 'Bucuresti');  But in https://fr.wikipedia.org/wiki/ISO_3166-2:RO there is no ""-BU"" for Bucuresti, only ""-B""  maybe others errors like that, so what do we have to do in such situation ? The main problem for me is about peppol xml electronic invoices for Romania, RO-BU is refused by official system when invoices comes so we have to change dolibarr database to use RO-B  are your ok for such PR ?  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ database-file",no-bug,0.9
28702,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28702,Send email from module Project fail," Bug Error 500 apear while sending email to Project participants. There is no error in Dolibarr log file, even debug is selected (there are only SQL queries). Error apears in the Nginx log as missing variable:  2024/03/08 08:05:34 [error] 1057296#1057296: *368268 FastCGI sent in stderr: ""PHP message: PHP Fatal error: Uncaught Error: Call to a member function contact_get_property() on null in /var/www/dolibarr/htdocs/core/actions_sendmails.inc.php:207 Stack trace: #0 /var/www/dolibarr/htdocs/projet/card.php(520): include() #1 {main} thrown in /var/www/dolibarr/htdocs/core/actions_sendmails.inc.php on line 207"" while reading response header from upstream, client: 94.241.90.97, server: is..cz, request: ""POST /projet/card.php?id=12 HTTP/2.0"", upstream: ""fastcgi://unix:/run/php/php7.4-fpm.sock:"", host: ""is.eglearn.cz"", referrer: ""https://is..cz/projet/card.php?action=presend&token=c2d6efe671c9c87e402ba5bc8e79eadc&id=12&mode=init""  It looks like there are missing email addresses. Send email from other modules works well.  Dolibarr Version 19.0.0  Environment PHP 7.2  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior Current behaviour: 1. Navigate to project 2. Select ""Email"" 3. Choose contact from Project contacts list 4. Send email 5. Blank page apears with 500 error and no email is sent to participants Expected behaviour: Email is sent to participants  Attached files Here screenshots from browser: ![Screenshot1](https://github.com/Dolibarr/dolibarr/assets/60854082/142bb068-9a8a-48fd-bdc4-fc2d7161aebc) ![Screnshot2](https://github.com/Dolibarr/dolibarr/assets/60854082/6e94a3c6-24be-4ca1-8fac-e767f58e2896) ![Screenshot3](https://github.com/Dolibarr/dolibarr/assets/60854082/f0f25ad7-dc6e-42f5-a6a9-3bfdb272c940)",other-file | other-file,"Send email from module Project fail  Bug Error 500 apear while sending email to Project participants. There is no error in Dolibarr log file, even debug is selected (there are only SQL queries). Error apears in the Nginx log as missing variable:  2024/03/08 08:05:34 [error] 1057296#1057296: *368268 FastCGI sent in stderr: ""PHP message: PHP Fatal error: Uncaught Error: Call to a member function contact_get_property() on null in /var/www/dolibarr/htdocs/core/actions_sendmails.inc.php:207 Stack trace: #0 /var/www/dolibarr/htdocs/projet/card.php(520): include() #1 {main} thrown in /var/www/dolibarr/htdocs/core/actions_sendmails.inc.php on line 207"" while reading response header from upstream, client: 94.241.90.97, server: is..cz, request: ""POST /projet/card.php?id=12 HTTP/2.0"", upstream: ""fastcgi://unix:/run/php/php7.4-fpm.sock:"", host: ""is.eglearn.cz"", referrer: ""https://is..cz/projet/card.php?action=presend&token=c2d6efe671c9c87e402ba5bc8e79eadc&id=12&mode=init""  It looks like there are missing email addresses. Send email from other modules works well.  Dolibarr Version 19.0.0  Environment PHP 7.2  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior Current behaviour: 1. Navigate to project 2. Select ""Email"" 3. Choose contact from Project contacts list 4. Send email 5. Blank page apears with 500 error and no email is sent to participants Expected behaviour: Email is sent to participants  Attached files Here screenshots from browser: ![Screenshot1](https://github.com/Dolibarr/dolibarr/assets/60854082/142bb068-9a8a-48fd-bdc4-fc2d7161aebc) ![Screnshot2](https://github.com/Dolibarr/dolibarr/assets/60854082/6e94a3c6-24be-4ca1-8fac-e767f58e2896) ![Screenshot3](https://github.com/Dolibarr/dolibarr/assets/60854082/f0f25ad7-dc6e-42f5-a6a9-3bfdb272c940) other-file other-file",no-bug,0.9
23075,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23075,Wrong invoice amount when billing Project task spent time," Bug When creating an invoice for project tasks time spent, the amount in the invoice is wrong.  Environment Version 14-16  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior When the task is for 10 hours and the user pay rate is 15 currency/h, the invoice line should be for QTY = 10 and U.P net = 15. In reality, the invoice QTY is correct, but the U.P net is not the hourly rate, but the total for the task (i.e. 150)  Steps to reproduce the behavior Create a project, create a task, add time spent to this task, and then bill it. ![1](https://user-images.githubusercontent.com/4587305/205131290-09b97066-b0c0-4559-902a-ec8c3ec48f8d.png) ![2](https://user-images.githubusercontent.com/4587305/205131304-e52121f7-d96d-4a1b-b211-c43fdd31fe04.png) ![3](https://user-images.githubusercontent.com/4587305/205131313-0977fd8a-5d5c-4213-aec6-3b5703adf623.png)  Attached files _No response_",other-file | other-file | other-file | other-file,"Wrong invoice amount when billing Project task spent time  Bug When creating an invoice for project tasks time spent, the amount in the invoice is wrong.  Environment Version 14-16  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior When the task is for 10 hours and the user pay rate is 15 currency/h, the invoice line should be for QTY = 10 and U.P net = 15. In reality, the invoice QTY is correct, but the U.P net is not the hourly rate, but the total for the task (i.e. 150)  Steps to reproduce the behavior Create a project, create a task, add time spent to this task, and then bill it. ![1](https://user-images.githubusercontent.com/4587305/205131290-09b97066-b0c0-4559-902a-ec8c3ec48f8d.png) ![2](https://user-images.githubusercontent.com/4587305/205131304-e52121f7-d96d-4a1b-b211-c43fdd31fe04.png) ![3](https://user-images.githubusercontent.com/4587305/205131313-0977fd8a-5d5c-4213-aec6-3b5703adf623.png)  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
27774,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27774,Project contacts add UserGroup, Feature Request add the possibility to add usergroups as contacts to projects  Use case you can add a usergroup (with all members) in one step and do not have to add the members of this individually  Suggested implementation 1. insert a line to select groups at /projet/contact.php 2. after selection & adding: i see two options to handle A) copy all members of the group into contacts or B) keep the group and link always to actual group members  Suggested steps _No response_,other-file | other-file | other-file | other-file | other-file | other-file,Project contacts add UserGroup  Feature Request add the possibility to add usergroups as contacts to projects  Use case you can add a usergroup (with all members) in one step and do not have to add the members of this individually  Suggested implementation 1. insert a line to select groups at /projet/contact.php 2. after selection & adding: i see two options to handle A) copy all members of the group into contacts or B) keep the group and link always to actual group members  Suggested steps _No response_ other-file other-file other-file other-file other-file other-file,no-bug,0.95
24014,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24014,Feature request : Sorting field and order in List of Tasks section," Feature Request In the task list, Under the Project card. The list of tasks is not able to do the field-wise sorting functionality. If the no. of the task list is too many then we want to sort the table by budget and so on  Use case In the task tab, Under the Project card. The list of tasks is not able to do the field-wise sorting functionality. If the no. of the task list is too many then we want to sort the table by budget and so on  Suggested implementation _No response_  Suggested steps _No response_",other-file | other-file,"Feature request : Sorting field and order in List of Tasks section  Feature Request In the task list, Under the Project card. The list of tasks is not able to do the field-wise sorting functionality. If the no. of the task list is too many then we want to sort the table by budget and so on  Use case In the task tab, Under the Project card. The list of tasks is not able to do the field-wise sorting functionality. If the no. of the task list is too many then we want to sort the table by budget and so on  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file",no-bug,0.95
28319,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28319,The return of error,The return of error plaintext _pagehead() (void) But there is no more such function. All _pagehead are now return float|int  _Originally posted by @eldy in https://github.com/Dolibarr/dolibarr/issues/28315#issuecomment-1954852971_ Was it gone? It's back for a reason: https://github.com/Dolibarr/dolibarr/blob/b343181789a1cc278d8baa9882c3cfbf71594aaf/htdocs/core/modules/product/doc/pdf_standard.modules.php#L706,other-file | other-file,The return of error The return of error plaintext _pagehead() (void) But there is no more such function. All _pagehead are now return float|int  _Originally posted by @eldy in https://github.com/Dolibarr/dolibarr/issues/28315#issuecomment-1954852971_ Was it gone? It's back for a reason: https://github.com/Dolibarr/dolibarr/blob/b343181789a1cc278d8baa9882c3cfbf71594aaf/htdocs/core/modules/product/doc/pdf_standard.modules.php#L706 other-file other-file,no-bug,0.8
23753,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23753,"Bug: Can't create invoice from ODT template - Error ""Nothing to parse - Check that the content.xml file is correctly formed in source file '/var/lib/dolibarr/documents/doctemplates/invoices/template_invoice.odt'"" - Ubuntu 22.04 - PHP 8.1.2 - Dolibarr Deb 16.0.3-4","Dear Dolibarr community, I've been using Dolibarr on Ubuntu 20.x and PHP 7.4 for a long time without any problem, and very stable. Since the migration to Ubuntu 22.x and PHP 8.1, I experience the following issue: every time I try to generate an invoice based on an ODT template, the following error occurs on the GUI: `Nothing to parse - Check that the content.xml file is correctly formed in source file '/var/lib/dolibarr/documents/doctemplates/invoices/template_invoice.odt'` The PHP error: ` [Wed Feb 01 18:37:50.154062 2023] [php:warn] [pid 57527] [client xxx.xxx.xxx.xxx:52755] PHP Warning: Undefined array key ""propal"" in /usr/share/dolibarr/htdocs/core/modules/facture/doc/doc_generic_invoice_odt.modules.php on line 337, referer: https://xxx.xxx.xx/dolibarr/compta/facture/card.php?facid=113&mainmenu=home [Wed Feb 01 18:37:50.154130 2023] [php:warn] [pid 57527] [client xxx.xxx.xxx.xxx:52755] PHP Warning: Trying to access array offset on value of type null in /usr/share/dolibarr/htdocs/core/modules/facture/doc/doc_generic_invoice_odt.modules.php on line 337, referer: https://xxx.xxx.xx/dolibarr/compta/facture/card.php?facid=113&mainmenu=home ` The thing is that the ODT templates have not been modified at all, and they were working perfectly with Ubuntu 20.x and PHP 7.4. OS: 22.04.1 LTS PHP version: 8.1.2 Dolibarr: Deb 16.0.3-4 Any idea on how to fix this? Thank you and best regards. Alexandre",other-file | other-file,"Bug: Can't create invoice from ODT template - Error ""Nothing to parse - Check that the content.xml file is correctly formed in source file '/var/lib/dolibarr/documents/doctemplates/invoices/template_invoice.odt'"" - Ubuntu 22.04 - PHP 8.1.2 - Dolibarr Deb 16.0.3-4 Dear Dolibarr community, I've been using Dolibarr on Ubuntu 20.x and PHP 7.4 for a long time without any problem, and very stable. Since the migration to Ubuntu 22.x and PHP 8.1, I experience the following issue: every time I try to generate an invoice based on an ODT template, the following error occurs on the GUI: `Nothing to parse - Check that the content.xml file is correctly formed in source file '/var/lib/dolibarr/documents/doctemplates/invoices/template_invoice.odt'` The PHP error: ` [Wed Feb 01 18:37:50.154062 2023] [php:warn] [pid 57527] [client xxx.xxx.xxx.xxx:52755] PHP Warning: Undefined array key ""propal"" in /usr/share/dolibarr/htdocs/core/modules/facture/doc/doc_generic_invoice_odt.modules.php on line 337, referer: https://xxx.xxx.xx/dolibarr/compta/facture/card.php?facid=113&mainmenu=home [Wed Feb 01 18:37:50.154130 2023] [php:warn] [pid 57527] [client xxx.xxx.xxx.xxx:52755] PHP Warning: Trying to access array offset on value of type null in /usr/share/dolibarr/htdocs/core/modules/facture/doc/doc_generic_invoice_odt.modules.php on line 337, referer: https://xxx.xxx.xx/dolibarr/compta/facture/card.php?facid=113&mainmenu=home ` The thing is that the ODT templates have not been modified at all, and they were working perfectly with Ubuntu 20.x and PHP 7.4. OS: 22.04.1 LTS PHP version: 8.1.2 Dolibarr: Deb 16.0.3-4 Any idea on how to fix this? Thank you and best regards. Alexandre other-file other-file",no-bug,0.9
27223,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27223,"E-Mailcollector: Filter ""is an answer"" not working in languages other than English"," Bug see htdocs/emailcollector/class/emailcollector.class.php, line #1675 (V18):  $isanswer = 0; if (preg_match('/Re\s*:\s+/i', $headers['Subject'])) { $isanswer = 1; }  This solution to check if there is a ""Re"" in the subject of the mail is not working if the language of the mail-client is different than English. Eg in German there is ""AW"" instead of ""Re""  Environment Version V18  Environment OS n/a  Environment Web server n/a  Environment PHP n/a  Environment Database n/a  Environment URL(s) _No response_  Expected and actual behavior There should be a solution that does not refer to the text in the subject of the mail. Two lines are also commented out in the code, but it is not clear why:  //if ($headers['In-Reply-To'] != $headers['Message-ID'] && empty($headers['References'])) $isanswer = 1; // If in-reply-to differs of message-id, this is a reply //if ($headers['In-Reply-To'] != $headers['Message-ID'] && !empty($headers['References']) && strpos($headers['References'], $headers['Message-ID']) !== false) $isanswer = 1;  @eldy Do you know why these two lines are commented out? For me it seems that this would be a much better solution  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"E-Mailcollector: Filter ""is an answer"" not working in languages other than English  Bug see htdocs/emailcollector/class/emailcollector.class.php, line #1675 (V18):  $isanswer = 0; if (preg_match('/Re\s*:\s+/i', $headers['Subject'])) { $isanswer = 1; }  This solution to check if there is a ""Re"" in the subject of the mail is not working if the language of the mail-client is different than English. Eg in German there is ""AW"" instead of ""Re""  Environment Version V18  Environment OS n/a  Environment Web server n/a  Environment PHP n/a  Environment Database n/a  Environment URL(s) _No response_  Expected and actual behavior There should be a solution that does not refer to the text in the subject of the mail. Two lines are also commented out in the code, but it is not clear why:  //if ($headers['In-Reply-To'] != $headers['Message-ID'] && empty($headers['References'])) $isanswer = 1; // If in-reply-to differs of message-id, this is a reply //if ($headers['In-Reply-To'] != $headers['Message-ID'] && !empty($headers['References']) && strpos($headers['References'], $headers['Message-ID']) !== false) $isanswer = 1;  @eldy Do you know why these two lines are commented out? For me it seems that this would be a much better solution  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
25150,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25150,Wrong language," Bug Under Security Setup -> Default Permissions, API / Web services (REST server) It shows ""Gnrer / modifier la cl API des utilisateurs"" This is not English.  Environment Version 17.0.1  Environment OS Ubuntu Linux  Environment Web server Apache  Environment PHP 8.1  Environment Database Postgres 9.5  Environment URL(s) http://localhost/dolibarr/admin/perms.php  Expected and actual behavior Should show in english. Google translate shows ""Generate/modify users API key""  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"Wrong language  Bug Under Security Setup -> Default Permissions, API / Web services (REST server) It shows ""Gnrer / modifier la cl API des utilisateurs"" This is not English.  Environment Version 17.0.1  Environment OS Ubuntu Linux  Environment Web server Apache  Environment PHP 8.1  Environment Database Postgres 9.5  Environment URL(s) http://localhost/dolibarr/admin/perms.php  Expected and actual behavior Should show in english. Google translate shows ""Generate/modify users API key""  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
32495,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32495,Bug modify product: unit kg/m dissapears and database is updated from 0 to NULL, Bug When modifying a product: /product/card.php?action=edit Change any field or do not change anything. Save the page. kg or meter is no longer visble as the database has been updated from 0 to NULL Problem started when testing from empty was added. Empty testing for 0 results in TRUE and makes it an empty string. php $this->net_measure = price2num($this->net_measure); $this->net_measure_units = (empty($this->net_measure_units) ? '' : trim($this->net_measure_units)); $this->weight = price2num($this->weight); $this->weight_units = (empty($this->weight_units) ? '' : trim($this->weight_units)); $this->length = price2num($this->length); $this->length_units = (empty($this->length_units) ? '' : trim($this->length_units)); $this->width = price2num($this->width); $this->width_units = (empty($this->width_units) ? '' : trim($this->width_units)); $this->height = price2num($this->height); $this->height_units = (empty($this->height_units) ? '' : trim($this->height_units)); $this->surface = price2num($this->surface); $this->surface_units = (empty($this->surface_units) ? '' : trim($this->surface_units)); $this->volume = price2num($this->volume); $this->volume_units = (empty($this->volume_units) ? '' : trim($this->volume_units));  Please advise to remove the empty function and immedialtely call trim function (as before) or rewrite the fuctions to is_null:  $this->net_measure_units = (is_null($this->net_measure_units) ? '' : trim($this->net_measure_units));  https://github.com/Dolibarr/dolibarr/blob/b579ff9cd81f0b140fa68f8c3ee2a03146738e7d/htdocs/product/class/product.class.php#L1368  Dolibarr Version 20.0.3  Environment PHP PHP8.1  Environment Database mysql  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file,Bug modify product: unit kg/m dissapears and database is updated from 0 to NULL  Bug When modifying a product: /product/card.php?action=edit Change any field or do not change anything. Save the page. kg or meter is no longer visble as the database has been updated from 0 to NULL Problem started when testing from empty was added. Empty testing for 0 results in TRUE and makes it an empty string. php $this->net_measure = price2num($this->net_measure); $this->net_measure_units = (empty($this->net_measure_units) ? '' : trim($this->net_measure_units)); $this->weight = price2num($this->weight); $this->weight_units = (empty($this->weight_units) ? '' : trim($this->weight_units)); $this->length = price2num($this->length); $this->length_units = (empty($this->length_units) ? '' : trim($this->length_units)); $this->width = price2num($this->width); $this->width_units = (empty($this->width_units) ? '' : trim($this->width_units)); $this->height = price2num($this->height); $this->height_units = (empty($this->height_units) ? '' : trim($this->height_units)); $this->surface = price2num($this->surface); $this->surface_units = (empty($this->surface_units) ? '' : trim($this->surface_units)); $this->volume = price2num($this->volume); $this->volume_units = (empty($this->volume_units) ? '' : trim($this->volume_units));  Please advise to remove the empty function and immedialtely call trim function (as before) or rewrite the fuctions to is_null:  $this->net_measure_units = (is_null($this->net_measure_units) ? '' : trim($this->net_measure_units));  https://github.com/Dolibarr/dolibarr/blob/b579ff9cd81f0b140fa68f8c3ee2a03146738e7d/htdocs/product/class/product.class.php#L1368  Dolibarr Version 20.0.3  Environment PHP PHP8.1  Environment Database mysql  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.8
33365,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33365,Search for a shipment without result," Bug When you run a search on a shipping customer, the right page (search result) remains blank if the search result is positive, if the result is negative, the page is displayed correctly.  Dolibarr Version 21.0  Environment PHP 7.4.28  Environment Database MySQL 8.2.0  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"Search for a shipment without result  Bug When you run a search on a shipping customer, the right page (search result) remains blank if the search result is positive, if the result is negative, the page is displayed correctly.  Dolibarr Version 21.0  Environment PHP 7.4.28  Environment Database MySQL 8.2.0  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
24653,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24653,modulebuilder: template for new object doesn't include the correct class," Bug When trying to create a new object from a newly created module from modulebuilder:  Fatal error: Uncaught Error: Class ""DemoObject"" not found in /var/www/html/custom/demobug/demoobject_card.php:105 Stack trace: #0 {main} thrown in /var/www/html/custom/demobug/demoobject_card.php on line 105   Environment Version 17.0.1-3317-ga4563c7ad4f  Environment OS archlinux docker  Environment Web server docker-web from the hash  Environment PHP docker-web from the php  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior The file `demobug/demoobject_card.php` should have:  dol_include_once('/demobug/class/demoobject.class.php'); dol_include_once('/demobug/lib/demobug_demoobject.lib.php');  instead of  dol_include_once('/demobug/class/myobject.class.php'); dol_include_once('/demobug/lib/demobug_myobject.lib.php');   Steps to reproduce the behavior After creating an object: ![scrn-2023-05-01-15-18-28](https://user-images.githubusercontent.com/413037/235457048-1b21085c-505c-4d38-947a-e7b394be7fef.png) Enable the module, and try creating a new object from there, the page returns:  Fatal error: Uncaught Error: Class ""DemoObject"" not found in /var/www/html/custom/demobug/demoobject_card.php:105 Stack trace: #0 {main} thrown in /var/www/html/custom/demobug/demoobject_card.php on line 105   Attached files _No response_",other-file | other-file,"modulebuilder: template for new object doesn't include the correct class  Bug When trying to create a new object from a newly created module from modulebuilder:  Fatal error: Uncaught Error: Class ""DemoObject"" not found in /var/www/html/custom/demobug/demoobject_card.php:105 Stack trace: #0 {main} thrown in /var/www/html/custom/demobug/demoobject_card.php on line 105   Environment Version 17.0.1-3317-ga4563c7ad4f  Environment OS archlinux docker  Environment Web server docker-web from the hash  Environment PHP docker-web from the php  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior The file `demobug/demoobject_card.php` should have:  dol_include_once('/demobug/class/demoobject.class.php'); dol_include_once('/demobug/lib/demobug_demoobject.lib.php');  instead of  dol_include_once('/demobug/class/myobject.class.php'); dol_include_once('/demobug/lib/demobug_myobject.lib.php');   Steps to reproduce the behavior After creating an object: ![scrn-2023-05-01-15-18-28](https://user-images.githubusercontent.com/413037/235457048-1b21085c-505c-4d38-947a-e7b394be7fef.png) Enable the module, and try creating a new object from there, the page returns:  Fatal error: Uncaught Error: Class ""DemoObject"" not found in /var/www/html/custom/demobug/demoobject_card.php:105 Stack trace: #0 {main} thrown in /var/www/html/custom/demobug/demoobject_card.php on line 105   Attached files _No response_ other-file other-file",no-bug,0.9
31369,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31369,Bug: date_solde not taken when creating a bank account via API," Bug Version: 20.0.1 Hello, I'm able to create a bank account via API but although initialising a solde value works, initialising a date_solde doesn't. This results in having the solde initial with the date of today, always. ![image](https://github.com/user-attachments/assets/b3b4cece-6d25-4c35-b275-ca908f722561) I looked at the code in `/htdocs/compta/bank/class/api_bankaccounts.class.php` And at line 172 I have `$account->date_solde = time();` I checked that hardcoding setting $account->date_solde to some value have the desired effect. So the problem is that instead of retrieving date_solde from the API call, it always set $account->date_solde to the date of right now I replaced `$account->date_solde = time();` by  if (isset($request_data['date_solde'])) { $account->date_solde = $this->_checkValForAPI('date_solde', $request_data['date_solde'], $account); } else { $account->date_solde = time(); }  Then it works properly  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"Bug: date_solde not taken when creating a bank account via API  Bug Version: 20.0.1 Hello, I'm able to create a bank account via API but although initialising a solde value works, initialising a date_solde doesn't. This results in having the solde initial with the date of today, always. ![image](https://github.com/user-attachments/assets/b3b4cece-6d25-4c35-b275-ca908f722561) I looked at the code in `/htdocs/compta/bank/class/api_bankaccounts.class.php` And at line 172 I have `$account->date_solde = time();` I checked that hardcoding setting $account->date_solde to some value have the desired effect. So the problem is that instead of retrieving date_solde from the API call, it always set $account->date_solde to the date of right now I replaced `$account->date_solde = time();` by  if (isset($request_data['date_solde'])) { $account->date_solde = $this->_checkValForAPI('date_solde', $request_data['date_solde'], $account); } else { $account->date_solde = time(); }  Then it works properly  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file",bug,0.95
30828,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30828,"On Ticket creation, contract origin is printed twice if contract is preselected"," Bug To set a contract by default on ticket creation, we use GET parameter : - origin (object type) - originid (object id) In contract form file, we can see that we print contract selector only if $subelement is not ""contract"" ![Capture decran 2024-09-02 a 12 01 23](https://github.com/user-attachments/assets/e2f9dbb2-0d0c-40b0-a5d5-c48c730f61b8) $subelement comes from GET parameter ""origin"" ![Capture decran 2024-09-02 a 12 03 50](https://github.com/user-attachments/assets/65d94389-3e9a-4dc9-bb40-a9a0b47603be) The contract class name is ""Contrat"". If we pass as parameter contract origin, the contract will be shown twice. ![Capture decran 2024-09-02 a 12 11 15](https://github.com/user-attachments/assets/3d70c785-1707-4c7b-8e25-32e2d63623a8) To avoid this error, we have to replace ""contract"" bye ""contrat"" in html.formticket.class.php line 701. The second problem is that this field does not link the ticket to the selected contract and/or no ""contract"" field exists on the ticket. ![Capture decran 2024-09-04 a 17 33 45](https://github.com/user-attachments/assets/31677662-05cd-4ae5-b50e-a1699ed0eefb) ![Capture decran 2024-09-04 a 17 34 22](https://github.com/user-attachments/assets/bc5dab1f-4fc0-4238-a0df-7101161eb7a9)  Dolibarr Version develop  Environment PHP 8.2.14  Environment Database 8.0.35-0ubuntu0.22.04.1  Steps to reproduce the behavior and expected behavior Go on ticket card with GET parameters : - action=create - origin=contrat - originid=x  Attached files _No response_",other-file | other-file | other-file | other-file,"On Ticket creation, contract origin is printed twice if contract is preselected  Bug To set a contract by default on ticket creation, we use GET parameter : - origin (object type) - originid (object id) In contract form file, we can see that we print contract selector only if $subelement is not ""contract"" ![Capture decran 2024-09-02 a 12 01 23](https://github.com/user-attachments/assets/e2f9dbb2-0d0c-40b0-a5d5-c48c730f61b8) $subelement comes from GET parameter ""origin"" ![Capture decran 2024-09-02 a 12 03 50](https://github.com/user-attachments/assets/65d94389-3e9a-4dc9-bb40-a9a0b47603be) The contract class name is ""Contrat"". If we pass as parameter contract origin, the contract will be shown twice. ![Capture decran 2024-09-02 a 12 11 15](https://github.com/user-attachments/assets/3d70c785-1707-4c7b-8e25-32e2d63623a8) To avoid this error, we have to replace ""contract"" bye ""contrat"" in html.formticket.class.php line 701. The second problem is that this field does not link the ticket to the selected contract and/or no ""contract"" field exists on the ticket. ![Capture decran 2024-09-04 a 17 33 45](https://github.com/user-attachments/assets/31677662-05cd-4ae5-b50e-a1699ed0eefb) ![Capture decran 2024-09-04 a 17 34 22](https://github.com/user-attachments/assets/bc5dab1f-4fc0-4238-a0df-7101161eb7a9)  Dolibarr Version develop  Environment PHP 8.2.14  Environment Database 8.0.35-0ubuntu0.22.04.1  Steps to reproduce the behavior and expected behavior Go on ticket card with GET parameters : - action=create - origin=contrat - originid=x  Attached files _No response_ other-file other-file other-file other-file",bug,0.9
25348,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25348,Credit note radio is activated from the new invoice creation card," Bug In the new invoice creation card the following message is displayed ![1](https://github.com/Dolibarr/dolibarr/assets/93765174/c512a82d-e5b5-45ce-89ec-8aae6d92e1d6) But as soon as you choose a client with already validated invoices the credit note radio gets activated ![2](https://github.com/Dolibarr/dolibarr/assets/93765174/3048750f-1abb-49db-9947-02153332ead6) @eldy What should the correct action be here?  Environment Version 17, 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7,4  Environment Database _No response_  Environment URL(s) /compta/facture/card.php  Expected and actual behavior User is not expecting the creation of credit note but it gets enabled anyway  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Credit note radio is activated from the new invoice creation card  Bug In the new invoice creation card the following message is displayed ![1](https://github.com/Dolibarr/dolibarr/assets/93765174/c512a82d-e5b5-45ce-89ec-8aae6d92e1d6) But as soon as you choose a client with already validated invoices the credit note radio gets activated ![2](https://github.com/Dolibarr/dolibarr/assets/93765174/3048750f-1abb-49db-9947-02153332ead6) @eldy What should the correct action be here?  Environment Version 17, 18  Environment OS _No response_  Environment Web server _No response_  Environment PHP 7,4  Environment Database _No response_  Environment URL(s) /compta/facture/card.php  Expected and actual behavior User is not expecting the creation of credit note but it gets enabled anyway  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
23099,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23099,Error on doPreMassActions hook : missing massaction parameter," Bug here is the hookmanager call : $reshook = $hookmanager->executeHooks('doPreMassActions', $parameters, $object, $action); but $action is not set  i think (and PR soon) it could be $massaction  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"Error on doPreMassActions hook : missing massaction parameter  Bug here is the hookmanager call : $reshook = $hookmanager->executeHooks('doPreMassActions', $parameters, $object, $action); but $action is not set  i think (and PR soon) it could be $massaction  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
27883,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27883,"getDolGlobalString and string ""0"" returns '' or default value"," Bug Hello i think there is a big fail on getDolGlobalString function in race condition where we store ""0"" string as value   return (string) (empty($conf->global->$key) ? $default : $conf->global->$key);  -> empty(0) return true then the function return default value, not ""0"" just try that php code:  echo 'empty(""0"") returns ' . empty(""0"") . ""\n""; echo 'empty(0) returns ' . empty(0) . ""\n""; echo ""empty('0') returns "" . empty('0') . ""\n"";  results:  empty(""0"") returns 1 empty(0) returns 1 empty('0') returns 1   Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"getDolGlobalString and string ""0"" returns '' or default value  Bug Hello i think there is a big fail on getDolGlobalString function in race condition where we store ""0"" string as value   return (string) (empty($conf->global->$key) ? $default : $conf->global->$key);  -> empty(0) return true then the function return default value, not ""0"" just try that php code:  echo 'empty(""0"") returns ' . empty(""0"") . ""\n""; echo 'empty(0) returns ' . empty(0) . ""\n""; echo ""empty('0') returns "" . empty('0') . ""\n"";  results:  empty(""0"") returns 1 empty(0) returns 1 empty('0') returns 1   Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
25704,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25704,Critical Bug: Bugfix for Taxes Deleted from Vendor Invoices," Bug In Spain, we use the field localtax2 for a type of tax (IRPF) that needs to be withheld and accounted for in some vendor invoices. The tax is properly applied to vendor invoices, but is then deleted from these invoices if the ""Label"" field of vendor invoices is added or edited after the invoice has been validated.  Environment Version 17.0.3  Environment OS _No response_  Environment Web server Version Apache/2.4.41 (Ubuntu)  Environment PHP 7.4.33 and 8.1 (tested both)  Environment Database MariaDB 5.5.5-10.3.38  Environment URL(s) dolibarr/fourn/facture/card.php  Expected and actual behavior When creating or editing a label of a vendor invoice, that field should be edited without any other change to existing invoice. What actually happens is that ""localtax2"" **taxes are deleted from invoice.** We have **fixed the error** by doing the following: Find line 437 of the file: htdocs/fourm/facture/card.php `} elseif ($action == 'setlabel' && $usercancreate){ $object->fetch($id);` And add the following code right after the above line to correct the issue: `$object->localtax2=$object->total_localtax2;` The problem seems to be that when the page is loaded for editing, the variable localtax does not load any value (NULL) and instead the following nonexisting variable is used: **total_localtax2**. The update of the field is actually carried out in the database field localtal2, not with **total_localtax2** as Dolibarr is wrongly using. If our analysis is wrong or if you find a more elegant way to solve it, we are all ears. We would appreciate it if our fix or a better one could be included in future releases as wrong taxes are a total showstopper.  Steps to reproduce the behavior Edit any vendor invoice that has localtax2 taxes after it has been validated.  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file,"Critical Bug: Bugfix for Taxes Deleted from Vendor Invoices  Bug In Spain, we use the field localtax2 for a type of tax (IRPF) that needs to be withheld and accounted for in some vendor invoices. The tax is properly applied to vendor invoices, but is then deleted from these invoices if the ""Label"" field of vendor invoices is added or edited after the invoice has been validated.  Environment Version 17.0.3  Environment OS _No response_  Environment Web server Version Apache/2.4.41 (Ubuntu)  Environment PHP 7.4.33 and 8.1 (tested both)  Environment Database MariaDB 5.5.5-10.3.38  Environment URL(s) dolibarr/fourn/facture/card.php  Expected and actual behavior When creating or editing a label of a vendor invoice, that field should be edited without any other change to existing invoice. What actually happens is that ""localtax2"" **taxes are deleted from invoice.** We have **fixed the error** by doing the following: Find line 437 of the file: htdocs/fourm/facture/card.php `} elseif ($action == 'setlabel' && $usercancreate){ $object->fetch($id);` And add the following code right after the above line to correct the issue: `$object->localtax2=$object->total_localtax2;` The problem seems to be that when the page is loaded for editing, the variable localtax does not load any value (NULL) and instead the following nonexisting variable is used: **total_localtax2**. The update of the field is actually carried out in the database field localtal2, not with **total_localtax2** as Dolibarr is wrongly using. If our analysis is wrong or if you find a more elegant way to solve it, we are all ears. We would appreciate it if our fix or a better one could be included in future releases as wrong taxes are a total showstopper.  Steps to reproduce the behavior Edit any vendor invoice that has localtax2 taxes after it has been validated.  Attached files _No response_ other-file other-file other-file other-file other-file other-file",no-bug,0.9
23077,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23077,Cannot update subscription note from subscription card," Bug One the page /adherents/subscription/card.php we cannot any change made to the subscription label is ignored.  Environment Version 15.0.2 to current developpement version  Environment OS Debian 11  Environment Web server Apache2 2.4.54  Environment PHP php 7.4.30  Environment Database mardiab 15.1  Environment URL(s) /adherents/subscription/card.php  Expected and actual behavior The field should be updated on change  Steps to reproduce the behavior Create a subscription with a note, go to it's card and try to change it.  Attached files This is due to a difference between `/adherents/subscription/card.php` and `/adherents/class/subscription.class.php` : in the first the label `$note` is stored in the object field `note` but in the second, the `update` function saves in note the object field `note_public`. The following patch fixes the issue:  diff --git a/htdocs/adherents/subscription/card.php b/htdocs/adherents/subscription/card.php index 5967d670856..37d0f2a9b5b 100644  a/htdocs/adherents/subscription/card.php  b/htdocs/adherents/subscription/card.php @@ -108,7 +108,7 @@ if ($user->rights->adherent->cotisation->creer && $action == 'update' && !$cance $object->dateh = dol_mktime($_POST['datesubhour'], $_POST['datesubmin'], 0, $_POST['datesubmonth'], $_POST['datesubday'], $_POST['datesubyear']); $object->datef = dol_mktime($_POST['datesubendhour'], $_POST['datesubendmin'], 0, $_POST['datesubendmonth'], $_POST['datesubendday'], $_POST['datesubendyear']); $object->fk_type = $typeid; - $object->note = $note; + $object->note_public = $note; $object->amount = $amount; //print 'datef='.$object->datef.' '.$_POST['datesubendday']; ",other-file | other-file,"Cannot update subscription note from subscription card  Bug One the page /adherents/subscription/card.php we cannot any change made to the subscription label is ignored.  Environment Version 15.0.2 to current developpement version  Environment OS Debian 11  Environment Web server Apache2 2.4.54  Environment PHP php 7.4.30  Environment Database mardiab 15.1  Environment URL(s) /adherents/subscription/card.php  Expected and actual behavior The field should be updated on change  Steps to reproduce the behavior Create a subscription with a note, go to it's card and try to change it.  Attached files This is due to a difference between `/adherents/subscription/card.php` and `/adherents/class/subscription.class.php` : in the first the label `$note` is stored in the object field `note` but in the second, the `update` function saves in note the object field `note_public`. The following patch fixes the issue:  diff --git a/htdocs/adherents/subscription/card.php b/htdocs/adherents/subscription/card.php index 5967d670856..37d0f2a9b5b 100644  a/htdocs/adherents/subscription/card.php  b/htdocs/adherents/subscription/card.php @@ -108,7 +108,7 @@ if ($user->rights->adherent->cotisation->creer && $action == 'update' && !$cance $object->dateh = dol_mktime($_POST['datesubhour'], $_POST['datesubmin'], 0, $_POST['datesubmonth'], $_POST['datesubday'], $_POST['datesubyear']); $object->datef = dol_mktime($_POST['datesubendhour'], $_POST['datesubendmin'], 0, $_POST['datesubendmonth'], $_POST['datesubendday'], $_POST['datesubendyear']); $object->fk_type = $typeid; - $object->note = $note; + $object->note_public = $note; $object->amount = $amount; //print 'datef='.$object->datef.' '.$_POST['datesubendday'];  other-file other-file",no-bug,0.8
23980,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23980,Gnration du RUM dpasse la taille de la BDD," Bug Lors de la gnration d'un RUM pour les prlvements, le RUM gnr est trop long (>32 car)  Environment Version 16.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Crer un client avec un code client long Exemple : PERFORMANCECONSEIL Saisir un compte bancaire avec gnration du RUM `Data too long for column 'rum' at row 1`  Attached files _No response_",other-file,"Gnration du RUM dpasse la taille de la BDD  Bug Lors de la gnration d'un RUM pour les prlvements, le RUM gnr est trop long (>32 car)  Environment Version 16.0.3  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Crer un client avec un code client long Exemple : PERFORMANCECONSEIL Saisir un compte bancaire avec gnration du RUM `Data too long for column 'rum' at row 1`  Attached files _No response_ other-file",no-bug,0.9
25996,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25996,odt project document creation crashes when the model does not have a projectfiles section, Bug It is not possible to use odt dcument models wich do not have all sections : 'projectrefs' segment not found in the document. The tag [!-- BEGIN xxx --] or [!-- END xxx --] is not present into content file.  Environment Version from 15.0 perhaps earlier  Environment OS all  Environment Web server all  Environment PHP all  Environment Database all  Environment URL(s) _No response_  Expected and actual behavior It should be possible to generate odt documents without sections wich are not used  Steps to reproduce the behavior made a copy of the standard template delete section (ex projectrefs) try to generate document  Attached files [template_project1.odt](https://github.com/Dolibarr/dolibarr/files/12701237/template_project1.odt),other-file | other-file,odt project document creation crashes when the model does not have a projectfiles section  Bug It is not possible to use odt dcument models wich do not have all sections : 'projectrefs' segment not found in the document. The tag [!-- BEGIN xxx --] or [!-- END xxx --] is not present into content file.  Environment Version from 15.0 perhaps earlier  Environment OS all  Environment Web server all  Environment PHP all  Environment Database all  Environment URL(s) _No response_  Expected and actual behavior It should be possible to generate odt documents without sections wich are not used  Steps to reproduce the behavior made a copy of the standard template delete section (ex projectrefs) try to generate document  Attached files [template_project1.odt](https://github.com/Dolibarr/dolibarr/files/12701237/template_project1.odt) other-file other-file,no-bug,0.9
32803,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32803,Add new Austrian business entity type FlexKapG, Feature Request Add new Austrian business entity type: [FlexKapG - Flexible Kapitalgesellschaft](https://www.wko.at/gruendung/flexible-kapitalgesellschaft-flexkapg-) It's a new business entity type which exists since the 1st of January 2024.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,database-file | database-file,Add new Austrian business entity type FlexKapG  Feature Request Add new Austrian business entity type: [FlexKapG - Flexible Kapitalgesellschaft](https://www.wko.at/gruendung/flexible-kapitalgesellschaft-flexkapg-) It's a new business entity type which exists since the 1st of January 2024.  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ database-file database-file,no-bug,0.9
32030,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32030,Add option to hide only Volume (and keep weight) in shipping PDF," Feature Request Add an option (like SHIPPING_PDF_HIDE_VOLUME) to hide only Volume (and keep weight) in shipping PDF. At this moment, we have an option to hide only both weight and volume (and hide the whole column in product list).  Use case Some people do not want to see the volume, this is sometimes useless, but the weigh is still important.  Suggested implementation Use the presence of an option SHIPPING_PDF_HIDE_VOLUME in the PDF templates.  Suggested steps Implement the use of the option in the PDF templates.",other-file | other-file,"Add option to hide only Volume (and keep weight) in shipping PDF  Feature Request Add an option (like SHIPPING_PDF_HIDE_VOLUME) to hide only Volume (and keep weight) in shipping PDF. At this moment, we have an option to hide only both weight and volume (and hide the whole column in product list).  Use case Some people do not want to see the volume, this is sometimes useless, but the weigh is still important.  Suggested implementation Use the presence of an option SHIPPING_PDF_HIDE_VOLUME in the PDF templates.  Suggested steps Implement the use of the option in the PDF templates. other-file other-file",no-bug,0.95
26015,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26015,Email-Collector depends on an activated Recruitment module," Bug When testing the Email-Collector to fetch ticket related emails, we faced a problem: Behavior: When the Recruitment module was **deactivated** - Clicking the ""Test collect"" or ""Collect now"" buttons in one of our collectors led to a blank screen. - The dolibarr.log showed an error message indicating that no table ""llx_recruitment_recruitmentcandidature"" could be found in the database - When the Recruitment module was **activated**, the ""Test collect"" and ""Collect now"" procedures worked fine and processed the incoming emails as expected  Environment Version 17.0  Environment OS Ubuntu",other-file,"Email-Collector depends on an activated Recruitment module  Bug When testing the Email-Collector to fetch ticket related emails, we faced a problem: Behavior: When the Recruitment module was **deactivated** - Clicking the ""Test collect"" or ""Collect now"" buttons in one of our collectors led to a blank screen. - The dolibarr.log showed an error message indicating that no table ""llx_recruitment_recruitmentcandidature"" could be found in the database - When the Recruitment module was **activated**, the ""Test collect"" and ""Collect now"" procedures worked fine and processed the incoming emails as expected  Environment Version 17.0  Environment OS Ubuntu other-file",no-bug,0.9
32292,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32292,Product list search not working," Bug When viewing the product list and searching by any of the available criteria (category, reference, label, etc) no results appear after clicking the search button (magnifying glass). However, after then clicking the change view buttons, the results show up normally. For subsequent searches I must change the keyword, click the search button (no results), and then click the view (list or tile) button to be presented with the search results.  Dolibarr Version 20.0.1  Environment PHP 7.1.33  Environment Database MySQL or MariaDB 8.0.22  Steps to reproduce the behavior and expected behavior Navigate to product list (/htdocs/product/list.php?leftmenu=product&type=0) Enter keyword or select filter criteria Click magnifying glass to search/refresh results This will return ""No record found"" result Click 'list view' or 'tile view' button Nominal search/filter results will appear  Attached files Uploading Dolibarr Product Search Bug.mp4",other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Product list search not working  Bug When viewing the product list and searching by any of the available criteria (category, reference, label, etc) no results appear after clicking the search button (magnifying glass). However, after then clicking the change view buttons, the results show up normally. For subsequent searches I must change the keyword, click the search button (no results), and then click the view (list or tile) button to be presented with the search results.  Dolibarr Version 20.0.1  Environment PHP 7.1.33  Environment Database MySQL or MariaDB 8.0.22  Steps to reproduce the behavior and expected behavior Navigate to product list (/htdocs/product/list.php?leftmenu=product&type=0) Enter keyword or select filter criteria Click magnifying glass to search/refresh results This will return ""No record found"" result Click 'list view' or 'tile view' button Nominal search/filter results will appear  Attached files Uploading Dolibarr Product Search Bug.mp4 other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
23787,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23787,External user can see users from other companies in agenda view per user, Bug External user can see users from other companies in agenda view per user  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) htdocs/comm/action/peruser.php  Expected and actual behavior External users should see only users from own company in agenda view per user  Steps to reproduce the behavior 1. create external user 2. navigate to comm/action/peruser.php  Attached files _No response_,other-file,External user can see users from other companies in agenda view per user  Bug External user can see users from other companies in agenda view per user  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) htdocs/comm/action/peruser.php  Expected and actual behavior External users should see only users from own company in agenda view per user  Steps to reproduce the behavior 1. create external user 2. navigate to comm/action/peruser.php  Attached files _No response_ other-file,no-bug,0.8
23783,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23783,"Box ""Last changed vendors"" is shown on comm/index.php even if user has no permission"," Bug Box ""Last changed vendors"" is shown on comm/index.php even if user has no permission  Environment Version 16.0.x  Environment OS na  Environment Web server na  Environment PHP na  Environment Database na  Environment URL(s) htdocs/comm/index.php  Expected and actual behavior User should not see box of last changed suppliers if he has no permission to see suppliers  Steps to reproduce the behavior 1. Remove right fournisseur->lire on a specific user 2. Navigate to htdocs/comm/index.php  Attached files _No response_",other-file,"Box ""Last changed vendors"" is shown on comm/index.php even if user has no permission  Bug Box ""Last changed vendors"" is shown on comm/index.php even if user has no permission  Environment Version 16.0.x  Environment OS na  Environment Web server na  Environment PHP na  Environment Database na  Environment URL(s) htdocs/comm/index.php  Expected and actual behavior User should not see box of last changed suppliers if he has no permission to see suppliers  Steps to reproduce the behavior 1. Remove right fournisseur->lire on a specific user 2. Navigate to htdocs/comm/index.php  Attached files _No response_ other-file",no-bug,0.9
34038,dolibarr,https://github.com/Dolibarr/dolibarr/issues/34038,Donation payment form doesn't permit to save emiter nor bank of an check or transfer," Bug Contrary to a payment for a facture, the donation payment form doesn't show transmitter name nor bank name to be saved.  Dolibarr Version 21.0.1, dev  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior create a payment for a donation  Attached files _No response_",other-file,"Donation payment form doesn't permit to save emiter nor bank of an check or transfer  Bug Contrary to a payment for a facture, the donation payment form doesn't show transmitter name nor bank name to be saved.  Dolibarr Version 21.0.1, dev  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior create a payment for a donation  Attached files _No response_ other-file",no-bug,0.8
23036,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23036,Import projects, Feature Request Could someone say me why an import of projects doesn't exists yet ? Nobody needed it until now or there is problem which could prevent us to do it ?  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file,Import projects  Feature Request Could someone say me why an import of projects doesn't exists yet ? Nobody needed it until now or there is problem which could prevent us to do it ?  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file,no-bug,0.9
28222,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28222,Bug on the display of date extrafields," Bug After modifying a line on a contract, the date extrafields appear identical on all lines of the contract. This is a bug only at the display level, as the data in the database is correct.  Environment Version 18.0.3  Environment OS Linux  Environment Web server Apache  Environment PHP 8.1  Environment Database MariaDB 10.3.39  Environment URL(s) _No response_  Expected and actual behavior When updating a date extrafield on an invoice, order, contract, or other entity, after submitting the modification, the display of this extrafield on all lines of the contract, for example, is identical as if it had been modified for all lines. If the page is reloaded, it is evident that the values are different, and the modification has been correctly applied only to the line that was edited.  Steps to reproduce the behavior To replicate the issue, add a date-type extrafield to an object (contract, invoice, order, etc.). For the example of a contract, create a contract and add multiple lines to it. Validate the contract and then modify the date-type extrafield on one of the contract lines and save the modification. In terms of display, the extrafield seems to have the same value on all lines of the contract. Reloading the page reveals the correct values, and it becomes apparent that the extrafield no longer has the same value on all lines.  Attached files Before modification: ![Before modification](https://github.com/Dolibarr/dolibarr/assets/132068748/988d979a-a2e0-4660-925a-e8e2b3863710) during modification: ![during modification](https://github.com/Dolibarr/dolibarr/assets/132068748/6dc452fd-51e9-4f88-96f6-14839b03dbec) after modification: ![after modification](https://github.com/Dolibarr/dolibarr/assets/132068748/07dcd8f5-ecda-4406-9b10-6780b608d0b1) once the page is reloaded: ![once the page is reloaded](https://github.com/Dolibarr/dolibarr/assets/132068748/67fcba23-3529-4c7a-a5a6-61839bede8a7)",other-file | other-file,"Bug on the display of date extrafields  Bug After modifying a line on a contract, the date extrafields appear identical on all lines of the contract. This is a bug only at the display level, as the data in the database is correct.  Environment Version 18.0.3  Environment OS Linux  Environment Web server Apache  Environment PHP 8.1  Environment Database MariaDB 10.3.39  Environment URL(s) _No response_  Expected and actual behavior When updating a date extrafield on an invoice, order, contract, or other entity, after submitting the modification, the display of this extrafield on all lines of the contract, for example, is identical as if it had been modified for all lines. If the page is reloaded, it is evident that the values are different, and the modification has been correctly applied only to the line that was edited.  Steps to reproduce the behavior To replicate the issue, add a date-type extrafield to an object (contract, invoice, order, etc.). For the example of a contract, create a contract and add multiple lines to it. Validate the contract and then modify the date-type extrafield on one of the contract lines and save the modification. In terms of display, the extrafield seems to have the same value on all lines of the contract. Reloading the page reveals the correct values, and it becomes apparent that the extrafield no longer has the same value on all lines.  Attached files Before modification: ![Before modification](https://github.com/Dolibarr/dolibarr/assets/132068748/988d979a-a2e0-4660-925a-e8e2b3863710) during modification: ![during modification](https://github.com/Dolibarr/dolibarr/assets/132068748/6dc452fd-51e9-4f88-96f6-14839b03dbec) after modification: ![after modification](https://github.com/Dolibarr/dolibarr/assets/132068748/07dcd8f5-ecda-4406-9b10-6780b608d0b1) once the page is reloaded: ![once the page is reloaded](https://github.com/Dolibarr/dolibarr/assets/132068748/67fcba23-3529-4c7a-a5a6-61839bede8a7) other-file other-file",no-bug,0.9
32113,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32113,"selectForForms: Error bad setup of field objectdescorig=Adherent, objectfield=partnership@partnership:fk_member, objectdesc=Adherent:adherents/class/adherent.class.php:1"," Bug In the new association there is an error when displaying the membership list. `selectForForms: Error bad setup of field objectdescorig=Adherent, objectfield=partnership@partnership:fk_member, objectdesc=Adherent:adherents/class/adherent.class.php:1` I am sending a screenshot to see how it could be corrected. <img width=""1660"" alt=""Captura de pantalla 2024-11-26 a las 20 36 46"" src=""https://github.com/user-attachments/assets/90151125-f08f-445e-ac1f-36158e4fe5d1"">  Dolibarr Version 20.0.1  Environment PHP 8.2.25  Environment Database MySQL or MariaDB 10.5.26-MariaDB  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file,"selectForForms: Error bad setup of field objectdescorig=Adherent, objectfield=partnership@partnership:fk_member, objectdesc=Adherent:adherents/class/adherent.class.php:1  Bug In the new association there is an error when displaying the membership list. `selectForForms: Error bad setup of field objectdescorig=Adherent, objectfield=partnership@partnership:fk_member, objectdesc=Adherent:adherents/class/adherent.class.php:1` I am sending a screenshot to see how it could be corrected. <img width=""1660"" alt=""Captura de pantalla 2024-11-26 a las 20 36 46"" src=""https://github.com/user-attachments/assets/90151125-f08f-445e-ac1f-36158e4fe5d1"">  Dolibarr Version 20.0.1  Environment PHP 8.2.25  Environment Database MySQL or MariaDB 10.5.26-MariaDB  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
28505,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28505,Problem in societe/project.php. Blank page from thirparty to projects or projects to thirdparty," Bug Users, not administrators, have a blank page to open project from third  Environment Version 19.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP 8.2  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior PHP Warning: Undefined variable $arrayofmassactions in /dolibarr/htdocs/societe/project.php on line 105 PHP Fatal error: Uncaught TypeError: count(): Argument #1 ($value) must be of type Countable|array, null given in /dolibarr/htdocs/core/class/html.form.class.php:833 Stack trace: #0 /dolibarr/htdocs/societe/project.php(105): Form->selectMassAction() #1 {main} thrown in /dolibarr/htdocs/core/class/html.form.class.php on line 833 I can work if I put $arrayofmassactions = array(); in line 105 before $massactionbutton = $form->selectMassAction('', $arrayofmassactions); of /htdocs/societe/project.php  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Problem in societe/project.php. Blank page from thirparty to projects or projects to thirdparty  Bug Users, not administrators, have a blank page to open project from third  Environment Version 19.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP 8.2  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior PHP Warning: Undefined variable $arrayofmassactions in /dolibarr/htdocs/societe/project.php on line 105 PHP Fatal error: Uncaught TypeError: count(): Argument #1 ($value) must be of type Countable|array, null given in /dolibarr/htdocs/core/class/html.form.class.php:833 Stack trace: #0 /dolibarr/htdocs/societe/project.php(105): Form->selectMassAction() #1 {main} thrown in /dolibarr/htdocs/core/class/html.form.class.php on line 833 I can work if I put $arrayofmassactions = array(); in line 105 before $massactionbutton = $form->selectMassAction('', $arrayofmassactions); of /htdocs/societe/project.php  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
26942,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26942,API: add GET method for /bankaccounts/{id}/lines/{line_id}/links," Feature Request Add an endpoint to list the links of a bank entry.  Use case At the moment it's not possible to link invoices to bank entries through the API. We are missing the payments endpoints and also we can't read the links of a bank entry (even though we can create them). As a first step, I'd like to add an endpoint to get the bank entry links.  Suggested implementation Add a method to `/compta/bank/class/api_bankaccounts.class.php`  Suggested steps _No response_",other-file | other-file | other-file,"API: add GET method for /bankaccounts/{id}/lines/{line_id}/links  Feature Request Add an endpoint to list the links of a bank entry.  Use case At the moment it's not possible to link invoices to bank entries through the API. We are missing the payments endpoints and also we can't read the links of a bank entry (even though we can create them). As a first step, I'd like to add an endpoint to get the bank entry links.  Suggested implementation Add a method to `/compta/bank/class/api_bankaccounts.class.php`  Suggested steps _No response_ other-file other-file other-file",no-bug,0.9
33506,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33506,ODT logo size : be able to accommodate the DPI of the source image," Feature Request Hello, When using the logo within a ODT template the odf.php sets a constat for the pixel to cm ratio assuming 96 DPI. This leads to a poor image quality in the resulting file, since printed mostly in 300DPI on printers. Would it be possible to have a Dolibarr Const that add another value the resulting image width and height is multiplied with ? Since the odf.php is outside of the dolibarr scope such a dolibarr constant can not be retrieved there. The setImage method is called from each doc_generic_*_odt_modules.php so it requires a lot of files to change.  Use case _No response_  Suggested implementation I'm not a professional PHP developer so i do not know if the suggested approach is good but i tried to come up with something that i could test with success :)  Suggested steps modify the setImage method in odf.php to have one more parameter called ratio `public function setImage($key, $value, $ratio=1)` Use this ratio to compute the image size  $width *= self::PIXEL_TO_CM * $ratio; $height *= self::PIXEL_TO_CM * $ratio;  Change all setImage calls in the doc_generic_*_odt_modules.php files after getting the Dolibarr constant with the defined ratio like  if (getDolGlobalString('MAIN_DOC_ODT_IMAGE_RATIO')) { $ratio = getDolGlobalString('MAIN_DOC_ODT_IMAGE_RATIO') * 1; } else { $ratio = 1; } $odfHandler->setImage($key, $value, $ratio); ",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"ODT logo size : be able to accommodate the DPI of the source image  Feature Request Hello, When using the logo within a ODT template the odf.php sets a constat for the pixel to cm ratio assuming 96 DPI. This leads to a poor image quality in the resulting file, since printed mostly in 300DPI on printers. Would it be possible to have a Dolibarr Const that add another value the resulting image width and height is multiplied with ? Since the odf.php is outside of the dolibarr scope such a dolibarr constant can not be retrieved there. The setImage method is called from each doc_generic_*_odt_modules.php so it requires a lot of files to change.  Use case _No response_  Suggested implementation I'm not a professional PHP developer so i do not know if the suggested approach is good but i tried to come up with something that i could test with success :)  Suggested steps modify the setImage method in odf.php to have one more parameter called ratio `public function setImage($key, $value, $ratio=1)` Use this ratio to compute the image size  $width *= self::PIXEL_TO_CM * $ratio; $height *= self::PIXEL_TO_CM * $ratio;  Change all setImage calls in the doc_generic_*_odt_modules.php files after getting the Dolibarr constant with the defined ratio like  if (getDolGlobalString('MAIN_DOC_ODT_IMAGE_RATIO')) { $ratio = getDolGlobalString('MAIN_DOC_ODT_IMAGE_RATIO') * 1; } else { $ratio = 1; } $odfHandler->setImage($key, $value, $ratio);  other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.95
27249,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27249,Missing hook contact.php and contact.tpl, Feature Request Missing hook contact.php and contact.tpl  Use case allow to target every line in php and js ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/e3ddf1c9-9800-46a7-a9ad-216a20a1280f)  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file,Missing hook contact.php and contact.tpl  Feature Request Missing hook contact.php and contact.tpl  Use case allow to target every line in php and js ![image](https://github.com/Dolibarr/dolibarr/assets/3288514/e3ddf1c9-9800-46a7-a9ad-216a20a1280f)  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file,no-bug,0.9
23117,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23117,Unable to bulk delete leave requests," Bug From the Awaiting approval list of leave requests, selecting records with the checkbox and using the Select action drop-down menu to delete them does not actually delete the records. It prompts for validation and then returns 'No records deleted' in green like the front-end did not include the list of leave items to delete when POSTing to the server.  Environment Version 16.0.3  Environment OS Debian Bullseye  Environment Web server Apache 2.4.54  Environment PHP 8.0.24  Environment Database MariaDB 10.9.3  Environment URL(s) /holiday/list.php  Expected and actual behavior The selected leave should be deleted  Steps to reproduce the behavior 1. Go to HRM 2. Click on Leave -> List -> Awaiting approval 3. Select a leave request using the checkbox at the end of the row 4. Select Delete from the Select action dropdown and click Confirm 5. Are you sure you want to delete the 2 selected record(s)? Select Yes and click Validate 6. See bubble reporting 'No record deleted'  Attached files _No response_",other-file | other-file | other-file | other-file,"Unable to bulk delete leave requests  Bug From the Awaiting approval list of leave requests, selecting records with the checkbox and using the Select action drop-down menu to delete them does not actually delete the records. It prompts for validation and then returns 'No records deleted' in green like the front-end did not include the list of leave items to delete when POSTing to the server.  Environment Version 16.0.3  Environment OS Debian Bullseye  Environment Web server Apache 2.4.54  Environment PHP 8.0.24  Environment Database MariaDB 10.9.3  Environment URL(s) /holiday/list.php  Expected and actual behavior The selected leave should be deleted  Steps to reproduce the behavior 1. Go to HRM 2. Click on Leave -> List -> Awaiting approval 3. Select a leave request using the checkbox at the end of the row 4. Select Delete from the Select action dropdown and click Confirm 5. Are you sure you want to delete the 2 selected record(s)? Select Yes and click Validate 6. See bubble reporting 'No record deleted'  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
27190,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27190,Inventory : Setting it back to draft clears the inventory," Bug Bug: - Setting an inventory back to ""Draft"" will empty the inventory without confirmation I had problems with users inadvertently (or because they wanted to edit the label ) clicking the ""Back to draft"" button and therefore clearing the inventory ( and they had to start over the whole inventory). There is no confirmation, as soon as they click the button, the inventory is cleared. Expected behavior: - We should be able to edit the label of the inventory without clearing it. - Ask for confirmation before clearing Version : 18.0.4 ( I checked the code for the master branch, it does not appear to be fixed ) This file: https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/product/inventory/card.php that button:  // Back to draft if ($object->status == $object::STATUS_VALIDATED) { if ($permissiontoadd) { print '<a class=""butAction"" href=""'.$_SERVER['PHP_SELF'].'?id='.$object->id.'&action=confirm_setdraft&confirm=yes&token='.newToken().'"">'.$langs->trans(""SetToDraft"").'</a>'; } }   Environment Version 18.0.4  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Inventory : Setting it back to draft clears the inventory  Bug Bug: - Setting an inventory back to ""Draft"" will empty the inventory without confirmation I had problems with users inadvertently (or because they wanted to edit the label ) clicking the ""Back to draft"" button and therefore clearing the inventory ( and they had to start over the whole inventory). There is no confirmation, as soon as they click the button, the inventory is cleared. Expected behavior: - We should be able to edit the label of the inventory without clearing it. - Ask for confirmation before clearing Version : 18.0.4 ( I checked the code for the master branch, it does not appear to be fixed ) This file: https://github.com/Dolibarr/dolibarr/blob/develop/htdocs/product/inventory/card.php that button:  // Back to draft if ($object->status == $object::STATUS_VALIDATED) { if ($permissiontoadd) { print '<a class=""butAction"" href=""'.$_SERVER['PHP_SELF'].'?id='.$object->id.'&action=confirm_setdraft&confirm=yes&token='.newToken().'"">'.$langs->trans(""SetToDraft"").'</a>'; } }   Environment Version 18.0.4  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file source-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
26194,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26194,Advanced Stock Transfer: Adding a line causes an HTTP ERROR 500," Bug I would like to transfer some items from one warehouse to another one. I am using the experimental Module `Advanced Stock Transfer `. As soon as I have inserted the desired quantity and click add line, I am getting an HTTP 500 error.  Environment Version 18.0.2  Environment OS Ubuntu 23.04  Environment Web server Apache/2.4.55 (Ubuntu)  Environment PHP PHP 8.1.12-1ubuntu4.3  Environment Database MariaDB 1:11.1.2+maria~ubu2204  Environment URL(s) /dolibarr/product/stock/stocktransfer/stocktransfer_card.php?id=2#addline  Expected and actual behavior 1. In `Products` under `Advanced Stock Transfer` click on `New stock transfer` 2. Fill out the `Label` and select an existing `Project` as well as the Warehouses `Entrept source` and `Entrept de destination` 3. A new window opens. Insert the desired `Qty ` you want to move and click `Add` 4. The line with the desired quantity will be added to the `Advanced Stock Transfer` and continue adding further items.  Steps to reproduce the behavior 1. In `Products` under `Advanced Stock Transfer` click on `New stock transfer` 2. Fill out the `Label` and select an existing `Project` as well as the Warehouses `Entrept source` and `Entrept de destination` 3. A new window opens. Insert the desired `Qty ` you want to move and click `Add` 4. Getting the HTTP Error 500 `/dolibarr/product/stock/stocktransfer/stocktransfer_card.php?id=2#addline`  Attached files _No response_",other-file,"Advanced Stock Transfer: Adding a line causes an HTTP ERROR 500  Bug I would like to transfer some items from one warehouse to another one. I am using the experimental Module `Advanced Stock Transfer `. As soon as I have inserted the desired quantity and click add line, I am getting an HTTP 500 error.  Environment Version 18.0.2  Environment OS Ubuntu 23.04  Environment Web server Apache/2.4.55 (Ubuntu)  Environment PHP PHP 8.1.12-1ubuntu4.3  Environment Database MariaDB 1:11.1.2+maria~ubu2204  Environment URL(s) /dolibarr/product/stock/stocktransfer/stocktransfer_card.php?id=2#addline  Expected and actual behavior 1. In `Products` under `Advanced Stock Transfer` click on `New stock transfer` 2. Fill out the `Label` and select an existing `Project` as well as the Warehouses `Entrept source` and `Entrept de destination` 3. A new window opens. Insert the desired `Qty ` you want to move and click `Add` 4. The line with the desired quantity will be added to the `Advanced Stock Transfer` and continue adding further items.  Steps to reproduce the behavior 1. In `Products` under `Advanced Stock Transfer` click on `New stock transfer` 2. Fill out the `Label` and select an existing `Project` as well as the Warehouses `Entrept source` and `Entrept de destination` 3. A new window opens. Insert the desired `Qty ` you want to move and click `Add` 4. Getting the HTTP Error 500 `/dolibarr/product/stock/stocktransfer/stocktransfer_card.php?id=2#addline`  Attached files _No response_ other-file",no-bug,0.9
30819,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30819,Adherent address update crashes when LDAP sync is active," Bug If I try to update a postal address, I get a blank page and the address isnt changed. The error log is in the filed at the end of the form.  Dolibarr Version 19.0.2  Environment PHP 8.2  Environment Database 5.5.5-10.6.14-MariaDB-log  Steps to reproduce the behavior and expected behavior Update a postal address from adherents/card.php  Attached files  2024/08/31 20:03:56 [error] 13069#13069: *3417218 FastCGI sent in stderr: ""PHP message: PHP Warning: Undefined array key """" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1359; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1359; PHP message: PHP Warning: Undefined array key """" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1360; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1360; PHP message: PHP Warning: Undefined array key """" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1362; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1362; PHP message: PHP Warning: Undefined array key ""useraccountcontrol"" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1364; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1364; PHP message: PHP Warning: Undefined array key ""badpasswordtime"" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1373; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1373"" while reading response header from upstream, client: 172.17.0.2, server: dolibarr.grif, request: ""POST /index.php?mainmenu=home HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php-fpm-dolibarr.sock:"", host: ""dolibarr.grif"", referrer: ""https://dolibarr.grif/"" 2024/08/31 20:04:27 [error] 13069#13069: *3417218 FastCGI sent in stderr: ""PHP message: PHP Warning: Attempt to read property ""rowid"" on null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/lib/functions.lib.php(9788) : eval()'d code on line 1"" while reading upstream, client: 172.17.0.2, server: dolibarr.grif, request: ""GET /adherents/card.php?rowid=350&save_lastsearch_values=1 HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php-fpm-dolibarr.sock:"", host: ""dolibarr.grif"", referrer: ""https://dolibarr.grif/"" 2024/08/31 20:04:59 [error] 13069#13069: *3417218 FastCGI sent in stderr: ""PHP message: PHP Warning: Attempt to read property ""rowid"" on null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/lib/functions.lib.php(9788) : eval()'d code on line 1; PHP message: PHP Fatal error: Uncaught Error: Call to undefined method stdClass::_load_ldap_info() in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/triggers/interface_50_modLdap_Ldapsynchro.class.php:514 Stack trace: #0 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/interfaces.class.php(187): InterfaceLdapsynchro->runTrigger() #1 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/commonobject.class.php(6025): Interfaces->run_triggers() #2 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/adherents/class/adherent.class.php(949): CommonObject->call_trigger() #3 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/adherents/card.php(373): Adherent->update() #4 {main} thrown in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/triggers/interface_50_modLdap_Ldapsynchro.class.php on line 514"" while reading response header from upstream, client: 172.17.0.2, server: dolibarr.grif, request: ""POST /adherents/card.php HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php-fpm-dolibarr.sock:"", host: ""dolibarr.grif"", referrer: ""https://dolibarr.grif/"" ",other-file | other-file,"Adherent address update crashes when LDAP sync is active  Bug If I try to update a postal address, I get a blank page and the address isnt changed. The error log is in the filed at the end of the form.  Dolibarr Version 19.0.2  Environment PHP 8.2  Environment Database 5.5.5-10.6.14-MariaDB-log  Steps to reproduce the behavior and expected behavior Update a postal address from adherents/card.php  Attached files  2024/08/31 20:03:56 [error] 13069#13069: *3417218 FastCGI sent in stderr: ""PHP message: PHP Warning: Undefined array key """" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1359; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1359; PHP message: PHP Warning: Undefined array key """" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1360; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1360; PHP message: PHP Warning: Undefined array key """" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1362; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1362; PHP message: PHP Warning: Undefined array key ""useraccountcontrol"" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1364; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1364; PHP message: PHP Warning: Undefined array key ""badpasswordtime"" in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1373; PHP message: PHP Warning: Trying to access array offset on value of type null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/ldap.class.php on line 1373"" while reading response header from upstream, client: 172.17.0.2, server: dolibarr.grif, request: ""POST /index.php?mainmenu=home HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php-fpm-dolibarr.sock:"", host: ""dolibarr.grif"", referrer: ""https://dolibarr.grif/"" 2024/08/31 20:04:27 [error] 13069#13069: *3417218 FastCGI sent in stderr: ""PHP message: PHP Warning: Attempt to read property ""rowid"" on null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/lib/functions.lib.php(9788) : eval()'d code on line 1"" while reading upstream, client: 172.17.0.2, server: dolibarr.grif, request: ""GET /adherents/card.php?rowid=350&save_lastsearch_values=1 HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php-fpm-dolibarr.sock:"", host: ""dolibarr.grif"", referrer: ""https://dolibarr.grif/"" 2024/08/31 20:04:59 [error] 13069#13069: *3417218 FastCGI sent in stderr: ""PHP message: PHP Warning: Attempt to read property ""rowid"" on null in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/lib/functions.lib.php(9788) : eval()'d code on line 1; PHP message: PHP Fatal error: Uncaught Error: Call to undefined method stdClass::_load_ldap_info() in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/triggers/interface_50_modLdap_Ldapsynchro.class.php:514 Stack trace: #0 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/interfaces.class.php(187): InterfaceLdapsynchro->runTrigger() #1 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/class/commonobject.class.php(6025): Interfaces->run_triggers() #2 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/adherents/class/adherent.class.php(949): CommonObject->call_trigger() #3 /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/adherents/card.php(373): Adherent->update() #4 {main} thrown in /var/www/localhost/htdocs/dolibarr-19.0.2/htdocs/core/triggers/interface_50_modLdap_Ldapsynchro.class.php on line 514"" while reading response header from upstream, client: 172.17.0.2, server: dolibarr.grif, request: ""POST /adherents/card.php HTTP/2.0"", upstream: ""fastcgi://unix:/var/run/php-fpm-dolibarr.sock:"", host: ""dolibarr.grif"", referrer: ""https://dolibarr.grif/""  other-file other-file",no-bug,0.9
27529,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27529,Error PHP8.1 : Type Error in /space/www/2cvp/Dolibarr/htdocs/main.inc.php:2202," Bug [15-Jan-2024 10:42:37 Europe/Berlin] PHP Fatal error: Uncaught TypeError: urlencode(): Argument #1 ($string) must be of type string, array given in /space/www/2cvp/Dolibarr/htdocs/main.inc.php:2202 Stack trace: #0 /space/www/2cvp/Dolibarr/htdocs/main.inc.php(2202): urlencode() #1 /space/www/2cvp/Dolibarr/htdocs/main.inc.php(1506): top_menu() #2 /space/www/2cvp/Dolibarr/htdocs/admin/const.php(162): llxHeader() #3 {main} thrown in /space/www/2cvp/Dolibarr/htdocs/main.inc.php on line 2202  Environment Version 19.0  Environment OS Linux Debian  Environment Web server Linux Deban  Environment PHP 8.1  Environment Database 5.7  Environment URL(s) /admin/const.php  Expected and actual behavior _No response_  Steps to reproduce the behavior Add, edit or delete a constant from the uri admin/const.php  Attached files _No response_",other-file | other-file | other-file,"Error PHP8.1 : Type Error in /space/www/2cvp/Dolibarr/htdocs/main.inc.php:2202  Bug [15-Jan-2024 10:42:37 Europe/Berlin] PHP Fatal error: Uncaught TypeError: urlencode(): Argument #1 ($string) must be of type string, array given in /space/www/2cvp/Dolibarr/htdocs/main.inc.php:2202 Stack trace: #0 /space/www/2cvp/Dolibarr/htdocs/main.inc.php(2202): urlencode() #1 /space/www/2cvp/Dolibarr/htdocs/main.inc.php(1506): top_menu() #2 /space/www/2cvp/Dolibarr/htdocs/admin/const.php(162): llxHeader() #3 {main} thrown in /space/www/2cvp/Dolibarr/htdocs/main.inc.php on line 2202  Environment Version 19.0  Environment OS Linux Debian  Environment Web server Linux Deban  Environment PHP 8.1  Environment Database 5.7  Environment URL(s) /admin/const.php  Expected and actual behavior _No response_  Steps to reproduce the behavior Add, edit or delete a constant from the uri admin/const.php  Attached files _No response_ other-file other-file other-file",no-bug,0.9
28892,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28892,Dictionary created by module builder fails to search," Bug On dictionaries created by a module that was created with Module Builder, the search by code field fails with the following error message: `Unknown column 't.code' in 'where clause'`  Dolibarr Version 19.1  Environment PHP 8.2.16  Environment Database MariaDB 10.4.31  Steps to reproduce the behavior and expected behavior 1. Crete a new module with the Module Builder 2. Add a new dictionary with some data 3. Activate the new module 4. Go to Dictionaries and open the new dictionary 5. Try searching some code in the new dictionary  Attached files _No response_",other-file | other-file | other-file,"Dictionary created by module builder fails to search  Bug On dictionaries created by a module that was created with Module Builder, the search by code field fails with the following error message: `Unknown column 't.code' in 'where clause'`  Dolibarr Version 19.1  Environment PHP 8.2.16  Environment Database MariaDB 10.4.31  Steps to reproduce the behavior and expected behavior 1. Crete a new module with the Module Builder 2. Add a new dictionary with some data 3. Activate the new module 4. Go to Dictionaries and open the new dictionary 5. Try searching some code in the new dictionary  Attached files _No response_ other-file other-file other-file",no-bug,0.9
33038,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33038,Drag and drop files are not prefixed with object reference," Bug Uploaded files are not prefixed with object reference even if const MAIN_DISABLE_SUGGEST_REF_AS_PREFIX is not enabled - when you drag and drop a file on supplier invoice card, the file uploaded is not prefixed with the object reference - and if the file name is not prefixed with object reference, when you want to export in accountancy (for example : using ""Quadratus"" format), you haven't the supplier invoices pieces (joined files) in archived file (ZIP)  Dolibarr Version 18.0 until develop  Environment PHP 7.4  Environment Database Mysql  Steps to reproduce the behavior and expected behavior The const MAIN_DISABLE_SUGGEST_REF_AS_PREFIX is not enabled. Since v18 of Dolibarr, you can drag and drop directly from supplier invoice card : ![Image](https://github.com/user-attachments/assets/3fb80be7-a6d3-4ffd-9d2f-1147cb230648) **-> the uploaded file name is not prefixed with reference of this card** And if you upload a file from document tab : ![Image](https://github.com/user-attachments/assets/86be8f0b-fc0c-428e-a330-f4662824106f) **-> the uploaded file name is prefixed with the reference of this card**  Attached files _No response_",other-file | other-file,"Drag and drop files are not prefixed with object reference  Bug Uploaded files are not prefixed with object reference even if const MAIN_DISABLE_SUGGEST_REF_AS_PREFIX is not enabled - when you drag and drop a file on supplier invoice card, the file uploaded is not prefixed with the object reference - and if the file name is not prefixed with object reference, when you want to export in accountancy (for example : using ""Quadratus"" format), you haven't the supplier invoices pieces (joined files) in archived file (ZIP)  Dolibarr Version 18.0 until develop  Environment PHP 7.4  Environment Database Mysql  Steps to reproduce the behavior and expected behavior The const MAIN_DISABLE_SUGGEST_REF_AS_PREFIX is not enabled. Since v18 of Dolibarr, you can drag and drop directly from supplier invoice card : ![Image](https://github.com/user-attachments/assets/3fb80be7-a6d3-4ffd-9d2f-1147cb230648) **-> the uploaded file name is not prefixed with reference of this card** And if you upload a file from document tab : ![Image](https://github.com/user-attachments/assets/86be8f0b-fc0c-428e-a330-f4662824106f) **-> the uploaded file name is prefixed with the reference of this card**  Attached files _No response_ other-file other-file",no-bug,0.9
23345,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23345,[API] - Get shipment return DB informations," Bug The call {{host}}/api/index.php/shipments?sortfield=t.rowid&sortorder=ASC&limit=100 responds each line with Db information !! This is a security issue!! The respond contains   ""lines"": [ { ""origin_line_id"": ""2719"", ""fk_origin_line"": ""2719"", ""fk_expedition"": ""638"", ""qty"": ""1"", ""qty_shipped"": ""1"", ""fk_product"": ""127"", ""detail_batch"": [  ""db"": { ""db"": {  }, ""type"": ""mysqli"",   Environment Version 16.0.3  Environment OS Debian  Environment Web server Apache/2.4.38 (Debian)  Environment PHP 7.3.31-1~deb10u2  Environment Database MariaDB 5.5.5-10.3.36-MariaDB-0+deb10u2  Environment URL(s) /api/index.php/shipments  Expected and actual behavior _No response_  Steps to reproduce the behavior curl -X GET --header 'Accept: application/json' --header 'DOLAPIKEY: {passkey}' '{host}/api/index.php/shipments/{id}' where id is a shipment which include product with a serial number  Attached files _No response_",other-file | other-file | other-file | other-file | other-file,"[API] - Get shipment return DB informations  Bug The call {{host}}/api/index.php/shipments?sortfield=t.rowid&sortorder=ASC&limit=100 responds each line with Db information !! This is a security issue!! The respond contains   ""lines"": [ { ""origin_line_id"": ""2719"", ""fk_origin_line"": ""2719"", ""fk_expedition"": ""638"", ""qty"": ""1"", ""qty_shipped"": ""1"", ""fk_product"": ""127"", ""detail_batch"": [  ""db"": { ""db"": {  }, ""type"": ""mysqli"",   Environment Version 16.0.3  Environment OS Debian  Environment Web server Apache/2.4.38 (Debian)  Environment PHP 7.3.31-1~deb10u2  Environment Database MariaDB 5.5.5-10.3.36-MariaDB-0+deb10u2  Environment URL(s) /api/index.php/shipments  Expected and actual behavior _No response_  Steps to reproduce the behavior curl -X GET --header 'Accept: application/json' --header 'DOLAPIKEY: {passkey}' '{host}/api/index.php/shipments/{id}' where id is a shipment which include product with a serial number  Attached files _No response_ other-file other-file other-file other-file other-file",bug,0.95
31798,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31798,End of month incorrect (clone salary)," Bug Detected in 19.0.2, but still valid in online demo (20.0.1). I cloned the latest salary entry, chose to update the ""END DATE"" with the proposed link, and I get 1998: https://demo.dolibarr.org/salaries/card.php?action=clone&token=9a96d666924ec0e685d205c00fddfbc4&id=182 ![{AE7E402B-830D-4277-A1E2-089AFDC0B7A1}](https://github.com/user-attachments/assets/9a3d2ba5-3aff-485c-92df-a224e6a01caf)  Dolibarr Version demo.dolibarr.org  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"End of month incorrect (clone salary)  Bug Detected in 19.0.2, but still valid in online demo (20.0.1). I cloned the latest salary entry, chose to update the ""END DATE"" with the proposed link, and I get 1998: https://demo.dolibarr.org/salaries/card.php?action=clone&token=9a96d666924ec0e685d205c00fddfbc4&id=182 ![{AE7E402B-830D-4277-A1E2-089AFDC0B7A1}](https://github.com/user-attachments/assets/9a3d2ba5-3aff-485c-92df-a224e6a01caf)  Dolibarr Version demo.dolibarr.org  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
23436,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23436,"Group social networks field on a thirdparty creation into one link ""Social networks"""," Feature Request On creation of a thirdparty: Group social networks field on a thirdparty creation into one link ""Social networks"" Clicking on link show all social networks fields under the link, and change text into ""Hide social networks links"" Next step is saving a cookie called DOLUSER_SOCIALNETWORKS_SHOW when links are shown or not so next time, the links are automatically shown or hidden depending on last situation.  Use case _No response_  Suggested implementation See example of show/hide link into the page ""Backup database"" to show/hide advanced option  Suggested steps _No response_",other-file | other-file | other-file | other-file,"Group social networks field on a thirdparty creation into one link ""Social networks""  Feature Request On creation of a thirdparty: Group social networks field on a thirdparty creation into one link ""Social networks"" Clicking on link show all social networks fields under the link, and change text into ""Hide social networks links"" Next step is saving a cookie called DOLUSER_SOCIALNETWORKS_SHOW when links are shown or not so next time, the links are automatically shown or hidden depending on last situation.  Use case _No response_  Suggested implementation See example of show/hide link into the page ""Backup database"" to show/hide advanced option  Suggested steps _No response_ other-file other-file other-file other-file",no-bug,0.95
26033,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26033,[BUG] Stock Movement associated with project doesn't show up in Project / Overview window," Bug Stock movements associated with a Project do not display, although the code appears to exist for it already in htdocs/projet/element.php Likely this functionality was broken at some point in the past, but since I find a need for it I will see if I can resolve this and create a pull request.  Environment Version 18.0.1  Environment OS Linux  Environment Web server Linux  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected: Stock movements associated with a project to appear in the Projects / Overview Tab, but it is missing ![image](https://github.com/Dolibarr/dolibarr/assets/84393940/34d8fb02-0f4b-426f-a112-658d081c3663)  Steps to reproduce the behavior Enable Projects, Stocks, Advanced Stock Transfer Create new Project Create new stock movement associated with project (Using the Advanced Stock Transfer) The project is visible when viewing the stock transfers page, but is not visible from the overview page of the Project.  Attached files There is a check for the module around Line 88  if (isModEnabled('stock')) { require_once DOL_DOCUMENT_ROOT.'/product/stock/class/entrepot.class.php'; require_once DOL_DOCUMENT_ROOT.'/product/stock/class/mouvementstock.class.php'; }  Around line 615 appears to encode this functionality  'stock_mouvement'=>array( 'name'=>""MouvementStockAssociated"", 'title'=>""ListMouvementStockProject"", 'class'=>'MouvementStock', 'table'=>'stock_mouvement', 'datefieldname'=>'datem', 'margin'=>'minus', 'disableamount'=>0, 'test'=>isModEnabled('stock') && $user->hasRight('stock', 'mouvement', 'lire') && !empty($conf->global->STOCK_MOVEMENT_INTO_PROJECT_OVERVIEW) ), ",other-file | other-file,"[BUG] Stock Movement associated with project doesn't show up in Project / Overview window  Bug Stock movements associated with a Project do not display, although the code appears to exist for it already in htdocs/projet/element.php Likely this functionality was broken at some point in the past, but since I find a need for it I will see if I can resolve this and create a pull request.  Environment Version 18.0.1  Environment OS Linux  Environment Web server Linux  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Expected: Stock movements associated with a project to appear in the Projects / Overview Tab, but it is missing ![image](https://github.com/Dolibarr/dolibarr/assets/84393940/34d8fb02-0f4b-426f-a112-658d081c3663)  Steps to reproduce the behavior Enable Projects, Stocks, Advanced Stock Transfer Create new Project Create new stock movement associated with project (Using the Advanced Stock Transfer) The project is visible when viewing the stock transfers page, but is not visible from the overview page of the Project.  Attached files There is a check for the module around Line 88  if (isModEnabled('stock')) { require_once DOL_DOCUMENT_ROOT.'/product/stock/class/entrepot.class.php'; require_once DOL_DOCUMENT_ROOT.'/product/stock/class/mouvementstock.class.php'; }  Around line 615 appears to encode this functionality  'stock_mouvement'=>array( 'name'=>""MouvementStockAssociated"", 'title'=>""ListMouvementStockProject"", 'class'=>'MouvementStock', 'table'=>'stock_mouvement', 'datefieldname'=>'datem', 'margin'=>'minus', 'disableamount'=>0, 'test'=>isModEnabled('stock') && $user->hasRight('stock', 'mouvement', 'lire') && !empty($conf->global->STOCK_MOVEMENT_INTO_PROJECT_OVERVIEW) ),  other-file other-file",no-bug,0.8
25302,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25302,Sum of tasks time spent on project referrers page (projet/element.php)," Bug On project referrers page, the display of time spent by task differs from the computing of total of time spent. For total of time spent :  if ($idofelementuser) { $tmp = $element->getSumOfAmount($elementuser, $dates, $datee); $total_ht_by_line = price2num($tmp['amount'], 'MT'); } else { $tmp = $element->getSumOfAmount('', $dates, $datee); $total_ht_by_line = price2num($tmp['amount'], 'MT'); }  () but in detail section, there's  $tmpprojtime = $element->getSumOfAmount($elementuser, $dates, $datee); // $element is a task. $elementuser may be empty  which had to be replaced by  $tmpprojtime = $element->getSumOfAmount($idofelementuser ? $elementuser : '', $dates, $datee); // $element is a task. $elementuser may be empty  I will make a PR for that  Environment Version All () this section may be much simplified with  $tmp = $element->getSumOfAmount($idofelementuser ? $elementuser : '' , $dates, $datee); $total_ht_by_line = price2num($tmp['amount'], 'MT'); ",other-file | other-file,"Sum of tasks time spent on project referrers page (projet/element.php)  Bug On project referrers page, the display of time spent by task differs from the computing of total of time spent. For total of time spent :  if ($idofelementuser) { $tmp = $element->getSumOfAmount($elementuser, $dates, $datee); $total_ht_by_line = price2num($tmp['amount'], 'MT'); } else { $tmp = $element->getSumOfAmount('', $dates, $datee); $total_ht_by_line = price2num($tmp['amount'], 'MT'); }  () but in detail section, there's  $tmpprojtime = $element->getSumOfAmount($elementuser, $dates, $datee); // $element is a task. $elementuser may be empty  which had to be replaced by  $tmpprojtime = $element->getSumOfAmount($idofelementuser ? $elementuser : '', $dates, $datee); // $element is a task. $elementuser may be empty  I will make a PR for that  Environment Version All () this section may be much simplified with  $tmp = $element->getSumOfAmount($idofelementuser ? $elementuser : '' , $dates, $datee); $total_ht_by_line = price2num($tmp['amount'], 'MT');  other-file other-file",no-bug,0.9
23092,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23092,"Bug: The ""Vendor SKU"" in a Purchase Order is erased if the VAT is refreshing."," Bug If you refresh the VAT in a Purchase Order the Vendor SKU is erased.  Environment Version 17.0.0-beta  Environment OS Windows 10  Environment Web server xampp  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) _No response_  Expected and actual behavior The Vendor SKU must keep in the line.  Steps to reproduce the behavior 1. Create a Purchase Order 2. Add a Product with a Vendor SKU, so looks like this ![image](https://user-images.githubusercontent.com/78662388/205461662-130aede5-7113-4375-8155-5d5782e7fba8.png) 3. Change the VAT like this ![image](https://user-images.githubusercontent.com/78662388/205461686-8c931181-a05f-47fc-87fc-58fca74768d9.png) 4. Now the Vendor SKU is erased ![image](https://user-images.githubusercontent.com/78662388/205461703-3bbd03ea-1421-4278-8ee3-0699f2065995.png)  Attached files _No response_",other-file | other-file,"Bug: The ""Vendor SKU"" in a Purchase Order is erased if the VAT is refreshing.  Bug If you refresh the VAT in a Purchase Order the Vendor SKU is erased.  Environment Version 17.0.0-beta  Environment OS Windows 10  Environment Web server xampp  Environment PHP PHP 8.1.10  Environment Database mariaDB  Environment URL(s) _No response_  Expected and actual behavior The Vendor SKU must keep in the line.  Steps to reproduce the behavior 1. Create a Purchase Order 2. Add a Product with a Vendor SKU, so looks like this ![image](https://user-images.githubusercontent.com/78662388/205461662-130aede5-7113-4375-8155-5d5782e7fba8.png) 3. Change the VAT like this ![image](https://user-images.githubusercontent.com/78662388/205461686-8c931181-a05f-47fc-87fc-58fca74768d9.png) 4. Now the Vendor SKU is erased ![image](https://user-images.githubusercontent.com/78662388/205461703-3bbd03ea-1421-4278-8ee3-0699f2065995.png)  Attached files _No response_ other-file other-file",no-bug,0.9
32888,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32888,Ticket list shows all tickets instead of open tickets only when selected from left menu, Bug If you open the ticket list from left menu all tickets are shwon instead of open tickets only  Dolibarr Version 20.0  Environment PHP PHP 8.x  Environment Database n/a  Steps to reproduce the behavior and expected behavior Enable Ticket module Select Top Menu Ticket Select Ticket List from left menu All tickets are shown instead of open tickets only  Attached files _No response_,other-file,Ticket list shows all tickets instead of open tickets only when selected from left menu  Bug If you open the ticket list from left menu all tickets are shwon instead of open tickets only  Dolibarr Version 20.0  Environment PHP PHP 8.x  Environment Database n/a  Steps to reproduce the behavior and expected behavior Enable Ticket module Select Top Menu Ticket Select Ticket List from left menu All tickets are shown instead of open tickets only  Attached files _No response_ other-file,no-bug,0.8
27375,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27375,dol_eval - Invalid Regex replacement," Bug Phan reports: text PhanPluginInvalidPregRegexReplacement: Call to \preg_replace was passed an invalid replacement reference '$1' to pattern '/^!?[a-zA-Z0-9_]+\\(/'  The match expressions do not have a group, so '$1' does not exist - '$0' probably exists. The intention of the replacement is not clear with limited analysis so I leave it up to someone more familiar with the code to determine the proper fixes for these 4 lines: https://github.com/Dolibarr/dolibarr/blame/f45f5c3291b060bdd25df3777b5957a5e5e00317/htdocs/core/lib/functions.lib.php#L9615-L9616 https://github.com/Dolibarr/dolibarr/blame/f45f5c3291b060bdd25df3777b5957a5e5e00317/htdocs/core/lib/functions.lib.php#L9642-L9643  Environment Version 19.0 upto develop included  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"dol_eval - Invalid Regex replacement  Bug Phan reports: text PhanPluginInvalidPregRegexReplacement: Call to \preg_replace was passed an invalid replacement reference '$1' to pattern '/^!?[a-zA-Z0-9_]+\\(/'  The match expressions do not have a group, so '$1' does not exist - '$0' probably exists. The intention of the replacement is not clear with limited analysis so I leave it up to someone more familiar with the code to determine the proper fixes for these 4 lines: https://github.com/Dolibarr/dolibarr/blame/f45f5c3291b060bdd25df3777b5957a5e5e00317/htdocs/core/lib/functions.lib.php#L9615-L9616 https://github.com/Dolibarr/dolibarr/blame/f45f5c3291b060bdd25df3777b5957a5e5e00317/htdocs/core/lib/functions.lib.php#L9642-L9643  Environment Version 19.0 upto develop included  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
29372,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29372,HRM : User have access to monthly statement without permission," Bug Even if a user doesn't have the right to read all leave requests [1], the user can still access them by using the associated URI that goes to the monthly statement. I can handle the PR if you'd like :) [1] : ![image](https://github.com/Dolibarr/dolibarr/assets/57806687/4bec1157-1632-4a16-a3d2-62098884e22c) [2] ![image](https://github.com/Dolibarr/dolibarr/assets/57806687/87f0e8d8-fada-4d8a-a497-4d486a7f7473)  Dolibarr Version 19.0.1  Environment PHP 8.1  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior Create a user that has no access except ""read leaves request"" Log with this account and access to the URI : https://yourdomain.com/holiday/month_report.php?mainmenu=hrm&leftmenu=holiday  Attached files _No response_",other-file | other-file,"HRM : User have access to monthly statement without permission  Bug Even if a user doesn't have the right to read all leave requests [1], the user can still access them by using the associated URI that goes to the monthly statement. I can handle the PR if you'd like :) [1] : ![image](https://github.com/Dolibarr/dolibarr/assets/57806687/4bec1157-1632-4a16-a3d2-62098884e22c) [2] ![image](https://github.com/Dolibarr/dolibarr/assets/57806687/87f0e8d8-fada-4d8a-a497-4d486a7f7473)  Dolibarr Version 19.0.1  Environment PHP 8.1  Environment Database MariaDB  Steps to reproduce the behavior and expected behavior Create a user that has no access except ""read leaves request"" Log with this account and access to the URI : https://yourdomain.com/holiday/month_report.php?mainmenu=hrm&leftmenu=holiday  Attached files _No response_ other-file other-file",bug,0.9
30122,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30122,any reason to round rebates percent to 3 digits for proposals ?," Bug the rebates percent is rounded to 3 digits when inserting a line in a proposal, any reason for this ? https://github.com/Dolibarr/dolibarr/blob/e5566609ea38da8a6e899e7b17c081e811746804/htdocs/comm/propal/class/propal.class.php#L4333  Dolibarr Version latest  Environment PHP N/A  Environment Database N/A  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"any reason to round rebates percent to 3 digits for proposals ?  Bug the rebates percent is rounded to 3 digits when inserting a line in a proposal, any reason for this ? https://github.com/Dolibarr/dolibarr/blob/e5566609ea38da8a6e899e7b17c081e811746804/htdocs/comm/propal/class/propal.class.php#L4333  Dolibarr Version latest  Environment PHP N/A  Environment Database N/A  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
32477,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32477,Bug: Inssurance of a loan not properly taken when there are decimals - Loan," Bug Version: 20.0.2 Hello, I have created a loan and I had forgotten to add the price of the insurance of the loan. So I edit the loan and change the value of the insurance by 12,70 ![image](https://github.com/user-attachments/assets/09410cbd-195c-4683-97fe-cbed75273737) After validation of the change, the insurance is 12,00 instead of 12,70 ![image](https://github.com/user-attachments/assets/40fd4faf-b7bd-4d16-bb2a-2e98cea45e94) Also when I edit the loan there are two small problems: - A dot is used to separate the decimals but when I'm not in edit mode it's a coma (coma is what I want in both cases) - There are too many zeros for decimals, you can see on the screeshot 75989.000000, but 75989,00 should be expected. Regards  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file,"Bug: Inssurance of a loan not properly taken when there are decimals - Loan  Bug Version: 20.0.2 Hello, I have created a loan and I had forgotten to add the price of the insurance of the loan. So I edit the loan and change the value of the insurance by 12,70 ![image](https://github.com/user-attachments/assets/09410cbd-195c-4683-97fe-cbed75273737) After validation of the change, the insurance is 12,00 instead of 12,70 ![image](https://github.com/user-attachments/assets/40fd4faf-b7bd-4d16-bb2a-2e98cea45e94) Also when I edit the loan there are two small problems: - A dot is used to separate the decimals but when I'm not in edit mode it's a coma (coma is what I want in both cases) - There are too many zeros for decimals, you can see on the screeshot 75989.000000, but 75989,00 should be expected. Regards  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
27312,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27312,the link to the objects (Project:project/class/project.class.php:1 or Company:company/class/company.class.php:0) is not correctly included," Bug The various links to the objects tested return an error and no longer display the list of companies or projects (displays an error of type selectForForms: Error bad setup of field objectdescorig=  in the additional attributes (project_extrafields.php) or in the modulebuilder module  Environment Version 19.0  Environment OS linux  Environment Web server Apache2  Environment PHP php 8.1.14  Environment Database MariaDB 5.5.5-10.6.12  Environment URL(s) project_extrafields.php?action=edit&token=xxx&attrname=societeatrib#formeditextrafield  Expected and actual behavior Should return a selection list, but returns a selectForForms error: Error bad setup of field objectdescorig= After searching, the function selectForForms() returns an error, generated by the function fetchObjectByElement(0, strtolower($tmparray[0])); where $tmparray[0]='project' which points to the function fetchObjectByElement() then the function fetchObjectByElement () fails with 'project', but not with 'project', the function dol_buildpath() fails because the class file /projet/class/projet. class.php does not exist (only project.class.php exists).  Steps to reproduce the behavior Create an attribute of type extrafields Project:project/class/project.class.php or the same thing in Module Builder  Attached files _No response_",other-file | other-file | other-file,"the link to the objects (Project:project/class/project.class.php:1 or Company:company/class/company.class.php:0) is not correctly included  Bug The various links to the objects tested return an error and no longer display the list of companies or projects (displays an error of type selectForForms: Error bad setup of field objectdescorig=  in the additional attributes (project_extrafields.php) or in the modulebuilder module  Environment Version 19.0  Environment OS linux  Environment Web server Apache2  Environment PHP php 8.1.14  Environment Database MariaDB 5.5.5-10.6.12  Environment URL(s) project_extrafields.php?action=edit&token=xxx&attrname=societeatrib#formeditextrafield  Expected and actual behavior Should return a selection list, but returns a selectForForms error: Error bad setup of field objectdescorig= After searching, the function selectForForms() returns an error, generated by the function fetchObjectByElement(0, strtolower($tmparray[0])); where $tmparray[0]='project' which points to the function fetchObjectByElement() then the function fetchObjectByElement () fails with 'project', but not with 'project', the function dol_buildpath() fails because the class file /projet/class/projet. class.php does not exist (only project.class.php exists).  Steps to reproduce the behavior Create an attribute of type extrafields Project:project/class/project.class.php or the same thing in Module Builder  Attached files _No response_ other-file other-file other-file",no-bug,0.9
29115,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29115,API PUT call issue (product extra fields)," Bug Unexpected behavior of PUT method upon updating product's extra fields  Dolibarr Version 19.0.1  Environment PHP 8.1.27  Environment Database MariaDB 10.6.17-MariaDB-cll-lve  Steps to reproduce the behavior and expected behavior Trying to call a product update through PUT method to update an extra field of the product: 1. Extrafield (checkbox) underlined: API must uncheck the box ![image](https://github.com/Dolibarr/dolibarr/assets/21037425/1875d81d-321c-48c3-b40d-cbd43c45230a) 2. API request body: ![image](https://github.com/Dolibarr/dolibarr/assets/21037425/ea436e65-20b3-492a-98c0-f7e5b7ac5c79) 3. After the call checkbox is unchecked which is right, however, previously set values for extra fields are now gone. NOTE: some of the extra fields didn't lose their values and it seems that those fields having _default value_ defined in extrafield settings don't lose the values, in fact, they **change** to default value from settings, regardless of what was set before or defined in API schema. ![image](https://github.com/Dolibarr/dolibarr/assets/21037425/d0341db0-3d4a-4468-9dbd-863b0b7fd67e) Obviously, standard fields are not affected, they're not changing (unless defined in schema) or loosing the values.  Attached files _No response_",other-file | other-file,"API PUT call issue (product extra fields)  Bug Unexpected behavior of PUT method upon updating product's extra fields  Dolibarr Version 19.0.1  Environment PHP 8.1.27  Environment Database MariaDB 10.6.17-MariaDB-cll-lve  Steps to reproduce the behavior and expected behavior Trying to call a product update through PUT method to update an extra field of the product: 1. Extrafield (checkbox) underlined: API must uncheck the box ![image](https://github.com/Dolibarr/dolibarr/assets/21037425/1875d81d-321c-48c3-b40d-cbd43c45230a) 2. API request body: ![image](https://github.com/Dolibarr/dolibarr/assets/21037425/ea436e65-20b3-492a-98c0-f7e5b7ac5c79) 3. After the call checkbox is unchecked which is right, however, previously set values for extra fields are now gone. NOTE: some of the extra fields didn't lose their values and it seems that those fields having _default value_ defined in extrafield settings don't lose the values, in fact, they **change** to default value from settings, regardless of what was set before or defined in API schema. ![image](https://github.com/Dolibarr/dolibarr/assets/21037425/d0341db0-3d4a-4468-9dbd-863b0b7fd67e) Obviously, standard fields are not affected, they're not changing (unless defined in schema) or loosing the values.  Attached files _No response_ other-file other-file",bug,0.9
26307,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26307,Undefined property: Contact::$gender," Bug When I was trying to create a user from a contact in the Rest API, I was getting a 500 error. I analyzed the error and it turns out that with PHP 8.1 you must have variables declared, so I went to contact.class.php and declared the variable and I can now create users without problem. /** * @var string gender */ public $gender = '';  Environment Version 17  Environment OS Linux  Environment Web server Apache  Environment PHP 8.1  Environment Database MySQL  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Create a contact from the API and then create your user  Attached files _No response_",other-file | other-file,"Undefined property: Contact::$gender  Bug When I was trying to create a user from a contact in the Rest API, I was getting a 500 error. I analyzed the error and it turns out that with PHP 8.1 you must have variables declared, so I went to contact.class.php and declared the variable and I can now create users without problem. /** * @var string gender */ public $gender = '';  Environment Version 17  Environment OS Linux  Environment Web server Apache  Environment PHP 8.1  Environment Database MySQL  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior Create a contact from the API and then create your user  Attached files _No response_ other-file other-file",bug,0.9
29142,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29142,Rang gets arbitrary numbers when Invoice is created from massaction ''BILL ORDERS' button," Bug Rang gets arbitrary numbers like 0,1 or 1,3,5,7 instead of 1,2,3,4 when Invoice is created from massaction ''BILL ORDERS' button  Dolibarr Version 18,19+  Environment PHP all  Environment Database MariaDB/MySQLi  Steps to reproduce the behavior and expected behavior Create 2 orders for the same customer and validate them Press ''BILL ORDERS' button in third party's customer tab Redirection to commande/list.php?socid=2&search_billed=0&autoselectall=1 happens There choose massaction ""bill orders"" and press confirm ![1](https://github.com/Dolibarr/dolibarr/assets/93765174/78da2fca-5102-4976-a1ac-9161dfd48c1f) In the update screen choose yes for Create one invoice per third party (otherwise, one invoice per selected object) and finally press ''BILL ORDERS' button for the last time ![2](https://github.com/Dolibarr/dolibarr/assets/93765174/af041b61-1959-44f0-87d7-7b83e3eb7bb1) Generated invoice rang numbers are arbitrary ![3](https://github.com/Dolibarr/dolibarr/assets/93765174/8d18273a-6580-4bd4-9cb7-f0d9b38c3790)  Attached files _No response_",other-file,"Rang gets arbitrary numbers when Invoice is created from massaction ''BILL ORDERS' button  Bug Rang gets arbitrary numbers like 0,1 or 1,3,5,7 instead of 1,2,3,4 when Invoice is created from massaction ''BILL ORDERS' button  Dolibarr Version 18,19+  Environment PHP all  Environment Database MariaDB/MySQLi  Steps to reproduce the behavior and expected behavior Create 2 orders for the same customer and validate them Press ''BILL ORDERS' button in third party's customer tab Redirection to commande/list.php?socid=2&search_billed=0&autoselectall=1 happens There choose massaction ""bill orders"" and press confirm ![1](https://github.com/Dolibarr/dolibarr/assets/93765174/78da2fca-5102-4976-a1ac-9161dfd48c1f) In the update screen choose yes for Create one invoice per third party (otherwise, one invoice per selected object) and finally press ''BILL ORDERS' button for the last time ![2](https://github.com/Dolibarr/dolibarr/assets/93765174/af041b61-1959-44f0-87d7-7b83e3eb7bb1) Generated invoice rang numbers are arbitrary ![3](https://github.com/Dolibarr/dolibarr/assets/93765174/8d18273a-6580-4bd4-9cb7-f0d9b38c3790)  Attached files _No response_ other-file",no-bug,0.9
30768,dolibarr,https://github.com/Dolibarr/dolibarr/issues/30768,invoice_line_id is the same for every timespent invoiced from a task," Bug When I create an invoice from timespent and ask for every timespent to be a invoice line, the invoice_line_id is the same for every timespent included  Dolibarr Version 17,18,19,20  Environment PHP 7.4  Environment Database _No response_  Steps to reproduce the behavior and expected behavior I create an invoice with the selected timespent ![image](https://github.com/user-attachments/assets/93c52c76-e14d-4fcc-af88-0e3115994d18) (the link between invoice and timespent is well created) I open the created invoice and delete the LAST invoice_line corresponding to the last timespent ![image](https://github.com/user-attachments/assets/a13a1d57-2f29-4808-bca8-8a473b3406fc) After I delete the last invoice_line, every other link are deleted (because in database the invoice_line_id for every timespent was the same instead to have invoice_line_id corresponding to only one factureline) ![image](https://github.com/user-attachments/assets/bb62457f-3458-421c-a5b3-47929944d765)  Attached files _No response_",other-file | other-file,"invoice_line_id is the same for every timespent invoiced from a task  Bug When I create an invoice from timespent and ask for every timespent to be a invoice line, the invoice_line_id is the same for every timespent included  Dolibarr Version 17,18,19,20  Environment PHP 7.4  Environment Database _No response_  Steps to reproduce the behavior and expected behavior I create an invoice with the selected timespent ![image](https://github.com/user-attachments/assets/93c52c76-e14d-4fcc-af88-0e3115994d18) (the link between invoice and timespent is well created) I open the created invoice and delete the LAST invoice_line corresponding to the last timespent ![image](https://github.com/user-attachments/assets/a13a1d57-2f29-4808-bca8-8a473b3406fc) After I delete the last invoice_line, every other link are deleted (because in database the invoice_line_id for every timespent was the same instead to have invoice_line_id corresponding to only one factureline) ![image](https://github.com/user-attachments/assets/bb62457f-3458-421c-a5b3-47929944d765)  Attached files _No response_ other-file other-file",no-bug,0.9
29740,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29740,Bug: Fatal error: Uncaught Error: Function name must be a string,"# Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug When opening the report section for Turnover invoiced by customer in accounting menu, I have the following message : Fatal error: Uncaught Error: Function name must be a string in /home/clients/75b383e1e32cfcb0a1b615c70a4bac17/erp/compta/stats/casoc.php:638 Stack trace: #0 {main} thrown in /home/clients/75b383e1e32cfcb0a1b615c70a4bac17/erp/compta/stats/casoc.php on line 638 or If I asked for turnover invoiced : the April month is providing me an error Warning: Division by zero in /home/clients/75b383e1e32cfcb0a1b615c70a4bac17/erp/compta/stats/index.php on line 465 +INF% ## Environment - **Version**: 19.0.2 - **OS**: Linux - **Web server**: Apache - **PHP**: fpm-fcgi 7.4.33 - **Database**: MySQL or MariaDB 5.5.5-10.4.25-MariaDB-1:10.4.25+maria~stretch-log - **URL(s)**: /compta/stats/casoc.php?leftmenu=accountancy_report&modecompta=BOOKKEEPING ## Expected and actual behavior Should get the customer turnover breakdown but I don't have any report. ## Steps to reproduce the behavior When opening the report section for Turnover by customer in accounting menu, choose turnover by customer ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging informations) [*Files*] ![2024-05-22_18-28-11](https://github.com/Dolibarr/dolibarr/assets/58973675/228f1bbd-49e2-493e-aa5e-1b90c24710a9) ![2024-05-22_18-27-19](https://github.com/Dolibarr/dolibarr/assets/58973675/955182dc-fd8e-4cef-af53-84c46147d666) ## Report",other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Bug: Fatal error: Uncaught Error: Function name must be a string # Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug When opening the report section for Turnover invoiced by customer in accounting menu, I have the following message : Fatal error: Uncaught Error: Function name must be a string in /home/clients/75b383e1e32cfcb0a1b615c70a4bac17/erp/compta/stats/casoc.php:638 Stack trace: #0 {main} thrown in /home/clients/75b383e1e32cfcb0a1b615c70a4bac17/erp/compta/stats/casoc.php on line 638 or If I asked for turnover invoiced : the April month is providing me an error Warning: Division by zero in /home/clients/75b383e1e32cfcb0a1b615c70a4bac17/erp/compta/stats/index.php on line 465 +INF% ## Environment - **Version**: 19.0.2 - **OS**: Linux - **Web server**: Apache - **PHP**: fpm-fcgi 7.4.33 - **Database**: MySQL or MariaDB 5.5.5-10.4.25-MariaDB-1:10.4.25+maria~stretch-log - **URL(s)**: /compta/stats/casoc.php?leftmenu=accountancy_report&modecompta=BOOKKEEPING ## Expected and actual behavior Should get the customer turnover breakdown but I don't have any report. ## Steps to reproduce the behavior When opening the report section for Turnover by customer in accounting menu, choose turnover by customer ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging informations) [*Files*] ![2024-05-22_18-28-11](https://github.com/Dolibarr/dolibarr/assets/58973675/228f1bbd-49e2-493e-aa5e-1b90c24710a9) ![2024-05-22_18-27-19](https://github.com/Dolibarr/dolibarr/assets/58973675/955182dc-fd8e-4cef-af53-84c46147d666) ## Report other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
32171,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32171,"Reverse charge checkbox cleared, if created supplier invoice cannot be submitted due to error"," Bug While creating a new supplier invoice, if the reverse charge checkbox is activated and the form submitted, but with an error, the value of the checkbox is cleared, while all other entries are persisted",other-file | other-file,"Reverse charge checkbox cleared, if created supplier invoice cannot be submitted due to error  Bug While creating a new supplier invoice, if the reverse charge checkbox is activated and the form submitted, but with an error, the value of the checkbox is cleared, while all other entries are persisted other-file other-file",no-bug,0.8
28070,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28070,Missing Mobile Phone field on thirdParty, Feature Request Missing Mobile Phone field on thirdParty  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_,other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | database-file | database-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,Missing Mobile Phone field on thirdParty  Feature Request Missing Mobile Phone field on thirdParty  Use case _No response_  Suggested implementation _No response_  Suggested steps _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file database-file database-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file,no-bug,0.9
29099,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29099,Thirdparty ticket page does not show same title as the other thirdparty pages," Bug For any given thirdparty, if you switch through each individual page most of them have a good page title, but not the ticket page, it is just ticket, making it's style different than the others.  Dolibarr Version 19.0.0  Environment PHP 8.2.7  Environment Database 11.3.2-MariaDB-1:11.3.2+maria~ubu2204  Steps to reproduce the behavior and expected behavior create thirdparty, switch between thirdparty pages in the submenys and notice that ticket page has a title style that is different than the rest  Attached files ![thirdparty_tickets](https://github.com/Dolibarr/dolibarr/assets/2551481/23d31d72-ce03-49ea-b852-acf861a65ea9) ![thirdparty](https://github.com/Dolibarr/dolibarr/assets/2551481/e46e83f0-3098-4b37-8b69-03f8df53c68b)",other-file | other-file,"Thirdparty ticket page does not show same title as the other thirdparty pages  Bug For any given thirdparty, if you switch through each individual page most of them have a good page title, but not the ticket page, it is just ticket, making it's style different than the others.  Dolibarr Version 19.0.0  Environment PHP 8.2.7  Environment Database 11.3.2-MariaDB-1:11.3.2+maria~ubu2204  Steps to reproduce the behavior and expected behavior create thirdparty, switch between thirdparty pages in the submenys and notice that ticket page has a title style that is different than the rest  Attached files ![thirdparty_tickets](https://github.com/Dolibarr/dolibarr/assets/2551481/23d31d72-ce03-49ea-b852-acf861a65ea9) ![thirdparty](https://github.com/Dolibarr/dolibarr/assets/2551481/e46e83f0-3098-4b37-8b69-03f8df53c68b) other-file other-file",no-bug,0.9
23364,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23364,Incorrect Virtual Stock - Not impacted by Draft Orders," Bug In stock management, the virtual stock is not impacted by draft orders.  Environment Version 16.0.3  Environment OS WIndows 2012 & 2019 / Debian /  Environment Web server IIS / Apache  Environment PHP No impact  Environment Database No impact  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Incorrect Virtual Stock - Not impacted by Draft Orders  Bug In stock management, the virtual stock is not impacted by draft orders.  Environment Version 16.0.3  Environment OS WIndows 2012 & 2019 / Debian /  Environment Web server IIS / Apache  Environment PHP No impact  Environment Database No impact  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
28552,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28552,Impossible to add a new tab in expense report, Bug Impossible to add a tab in expense report because of bad declaration in core/lib/expensereport.lib.php  Environment Version 17  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,Impossible to add a new tab in expense report  Bug Impossible to add a tab in expense report because of bad declaration in core/lib/expensereport.lib.php  Environment Version 17  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
29029,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29029,Impossible to delete an order line," Bug In an order when you try to delete a line, you go through the normal Dolibarr process with the form confirm but the line is never deleted  Dolibarr Version 18  Environment PHP 7.4  Environment Database _No response_  Steps to reproduce the behavior and expected behavior Add a line in an order and try to delete it  Attached files _No response_",other-file | other-file,"Impossible to delete an order line  Bug In an order when you try to delete a line, you go through the normal Dolibarr process with the form confirm but the line is never deleted  Dolibarr Version 18  Environment PHP 7.4  Environment Database _No response_  Steps to reproduce the behavior and expected behavior Add a line in an order and try to delete it  Attached files _No response_ other-file other-file",no-bug,0.8
26844,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26844,"BANK, Account statements : loose linked files if change Ref."," Bug If we change or correct the reference name of an Account statement on the Bank account, the linked files were not available anymore. But if we change back the ref for the previous name, the files will be refund.  Environment Version 18.03  Environment OS _No response_  Environment Web server Debian GNU/Linux 8.11 (jessie)  Environment PHP 8.1.22  Environment Database MariaDB 10.4.18  Environment URL(s) _No response_  Expected and actual behavior We expect that the attached files were all the time available independently of the ref name.  Steps to reproduce the behavior 1. On the 'Bank entries' make a 'reconcile' with few of your entries and use the value '20231113' 2. On the 'Account statement' open the statement '20231113' and upload an attached file ex. 'EXTRACT_20231112.pdf' 3. On the 'Account statement' edit the statement '20231113' and change the name of it for '20231112' Now you can check back the attached file of the account statement '20231112' and there is no attached file.. But if you change back the ref for '20231113' and check again, the attached file will be back.  Attached files _No response_",other-file | other-file,"BANK, Account statements : loose linked files if change Ref.  Bug If we change or correct the reference name of an Account statement on the Bank account, the linked files were not available anymore. But if we change back the ref for the previous name, the files will be refund.  Environment Version 18.03  Environment OS _No response_  Environment Web server Debian GNU/Linux 8.11 (jessie)  Environment PHP 8.1.22  Environment Database MariaDB 10.4.18  Environment URL(s) _No response_  Expected and actual behavior We expect that the attached files were all the time available independently of the ref name.  Steps to reproduce the behavior 1. On the 'Bank entries' make a 'reconcile' with few of your entries and use the value '20231113' 2. On the 'Account statement' open the statement '20231113' and upload an attached file ex. 'EXTRACT_20231112.pdf' 3. On the 'Account statement' edit the statement '20231113' and change the name of it for '20231112' Now you can check back the attached file of the account statement '20231112' and there is no attached file.. But if you change back the ref for '20231113' and check again, the attached file will be back.  Attached files _No response_ other-file other-file",no-bug,0.9
31198,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31198,State dropdown is not working on User card," Bug While we are going to Edit or Add an user in Dolibarr and after selecting the desired country, the state drop-down is not popped up correctly. Please the attached screenshot below. ![state-dropdown-error](https://github.com/user-attachments/assets/203a7874-e907-46a6-8deb-009ddc873b19)  Dolibarr Version 20.0  Environment PHP 8.1.25  Environment Database MySQL  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file,"State dropdown is not working on User card  Bug While we are going to Edit or Add an user in Dolibarr and after selecting the desired country, the state drop-down is not popped up correctly. Please the attached screenshot below. ![state-dropdown-error](https://github.com/user-attachments/assets/203a7874-e907-46a6-8deb-009ddc873b19)  Dolibarr Version 20.0  Environment PHP 8.1.25  Environment Database MySQL  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file",no-bug,0.9
31973,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31973,Bug: Warning: Undefined variable $morehtmlright - Loan Module," Bug Version: 20.0.2 Hello, I see a warning when I display the Notes of a loan that I have previously created ![image](https://github.com/user-attachments/assets/81ee8941-d5dc-4eac-8e53-d17034a94a31) The code at line 133 and 134 is  $morehtmlstatus = $morehtmlright; dol_banner_tab($object, 'id', $linkback, 1, 'rowid', 'ref', $morehtmlref, '', 0, '', $morehtmlstatus);  I don't know what is $morehtmlright In other modules I see `dol_banner_tab($object, 'id', $linkback, 1, 'rowid', 'ref', $morehtmlref);`  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Bug: Warning: Undefined variable $morehtmlright - Loan Module  Bug Version: 20.0.2 Hello, I see a warning when I display the Notes of a loan that I have previously created ![image](https://github.com/user-attachments/assets/81ee8941-d5dc-4eac-8e53-d17034a94a31) The code at line 133 and 134 is  $morehtmlstatus = $morehtmlright; dol_banner_tab($object, 'id', $linkback, 1, 'rowid', 'ref', $morehtmlref, '', 0, '', $morehtmlstatus);  I don't know what is $morehtmlright In other modules I see `dol_banner_tab($object, 'id', $linkback, 1, 'rowid', 'ref', $morehtmlref);`  Dolibarr Version 20.0.2  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
27705,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27705,Parent company field value not shown in list," Bug When selected the parent company field to be shown in Third Party list, the values are not shown in the list. If the filter is used, the behavior is correct (the list is filtered) however the parent company value is not shown. This applies to any of the third parties list: general, prospects, customers and vendors.  Environment Version 18.0.4  Environment OS Ubuntu 22.04.3 LTS  Environment Web server Apache/2.4.52 (Ubuntu)  Environment PHP PHP 8.1.2-1ubuntu2.14  Environment Database mysql Ver 8.0.35-0ubuntu0.22.04.1 for Linux on x86_64 ((Ubuntu))  Environment URL(s) crm.treverdo.es  Expected and actual behavior When selected the parent company field to appear in the list, the name of the parent companies should appear in the list instead of all blanks.  Steps to reproduce the behavior Go to Third Party and click any list. Within the list, you should have the parent company selected to appear.  Attached files _No response_",other-file,"Parent company field value not shown in list  Bug When selected the parent company field to be shown in Third Party list, the values are not shown in the list. If the filter is used, the behavior is correct (the list is filtered) however the parent company value is not shown. This applies to any of the third parties list: general, prospects, customers and vendors.  Environment Version 18.0.4  Environment OS Ubuntu 22.04.3 LTS  Environment Web server Apache/2.4.52 (Ubuntu)  Environment PHP PHP 8.1.2-1ubuntu2.14  Environment Database mysql Ver 8.0.35-0ubuntu0.22.04.1 for Linux on x86_64 ((Ubuntu))  Environment URL(s) crm.treverdo.es  Expected and actual behavior When selected the parent company field to appear in the list, the name of the parent companies should appear in the list instead of all blanks.  Steps to reproduce the behavior Go to Third Party and click any list. Within the list, you should have the parent company selected to appear.  Attached files _No response_ other-file",no-bug,0.8
24138,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24138,"Migration issue 15.0.4 -> 17.0.0: SQL error on ""birthday for this month"""," Bug After migrating from 15.0.4 to 17.0.0, the following error happens in the birthday panel (in french ""anniversaire de ce mois"").  ERROR: 0A000: invalid UNION/INTERSECT/EXCEPT ORDER BY clause LINE 1: te_format( u.dateemployment, '%c') = '3' ORDER BY DAY(datea) ^ DETAIL: Only result column names can be used, not expressions or functions. HINT: Add the expression/function to every SELECT, or move the UNION into a FROM clause. LOCATION: transformSetOperationStmt, analyze.c:1776 sql=SELECT u.rowid, u.firstname, u.lastname, u.birth as datea, 'birth' as typea,  There were no errors in 15.0.4.  Environment Version 17.0.0  Environment OS Debian bullseye  Environment Web server Nginx  Environment PHP PHP 7.4  Environment Database Postgres Scaleway  Environment URL(s) _No response_  Expected and actual behavior Expected : no birthday this month Actual behaviour: SQL error message  Steps to reproduce the behavior Install a 15.0.4 instance, upgrade to 17.0.0 with `php upgrade.php / upgrade2.php 15.0.4 17.0.0`. I can produce such instance in a few days to ensure it can be reproduced from scratch, and share database anyway.  Attached files In 15.0.4: ![image](https://user-images.githubusercontent.com/413037/223069421-93b1c754-966c-4674-a9aa-36cb23d4b650.png) In 17.0.0: ![image](https://user-images.githubusercontent.com/413037/223069325-11441485-d1f8-4458-a795-4c766e18e795.png)",other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Migration issue 15.0.4 -> 17.0.0: SQL error on ""birthday for this month""  Bug After migrating from 15.0.4 to 17.0.0, the following error happens in the birthday panel (in french ""anniversaire de ce mois"").  ERROR: 0A000: invalid UNION/INTERSECT/EXCEPT ORDER BY clause LINE 1: te_format( u.dateemployment, '%c') = '3' ORDER BY DAY(datea) ^ DETAIL: Only result column names can be used, not expressions or functions. HINT: Add the expression/function to every SELECT, or move the UNION into a FROM clause. LOCATION: transformSetOperationStmt, analyze.c:1776 sql=SELECT u.rowid, u.firstname, u.lastname, u.birth as datea, 'birth' as typea,  There were no errors in 15.0.4.  Environment Version 17.0.0  Environment OS Debian bullseye  Environment Web server Nginx  Environment PHP PHP 7.4  Environment Database Postgres Scaleway  Environment URL(s) _No response_  Expected and actual behavior Expected : no birthday this month Actual behaviour: SQL error message  Steps to reproduce the behavior Install a 15.0.4 instance, upgrade to 17.0.0 with `php upgrade.php / upgrade2.php 15.0.4 17.0.0`. I can produce such instance in a few days to ensure it can be reproduced from scratch, and share database anyway.  Attached files In 15.0.4: ![image](https://user-images.githubusercontent.com/413037/223069421-93b1c754-966c-4674-a9aa-36cb23d4b650.png) In 17.0.0: ![image](https://user-images.githubusercontent.com/413037/223069325-11441485-d1f8-4458-a795-4c766e18e795.png) other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
23027,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23027,too long?," Bug when filling the survey to select a date , we get an error : DB_ERROR_1406 Information sur le dernier accs en base en erreur: Data too long for column 'reponses' at row 1  Environment Version Dolibarr: 16.0.2  Environment OS Linux 5.4.0-132-generic #148-Ubuntu  Environment Web server Server: Apache OS: Linux  Environment PHP PHP: 7.4.3  Environment Database mariadb  Environment URL(s) https://dolibarr.iefc.net/public/opensurvey/studs.php?sondage=8tcu9z3o3v4g6knp  Expected and actual behavior that it records data when survey is filled  Steps to reproduce the behavior _No response_  Attached files _No response_",database-file | database-file | other-file,"too long?  Bug when filling the survey to select a date , we get an error : DB_ERROR_1406 Information sur le dernier accs en base en erreur: Data too long for column 'reponses' at row 1  Environment Version Dolibarr: 16.0.2  Environment OS Linux 5.4.0-132-generic #148-Ubuntu  Environment Web server Server: Apache OS: Linux  Environment PHP PHP: 7.4.3  Environment Database mariadb  Environment URL(s) https://dolibarr.iefc.net/public/opensurvey/studs.php?sondage=8tcu9z3o3v4g6knp  Expected and actual behavior that it records data when survey is filled  Steps to reproduce the behavior _No response_  Attached files _No response_ database-file database-file other-file",no-bug,0.8
29031,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29031,Purchase Order Back to list produces DB_ERROR_NOSUCHFIELD," Bug I am receiving DB_ERROR_NOSUCHFIELD Unknown column 'Array' in 'where clause' when I click the link ""Back to list"" on Purchase Orders.  Dolibarr Version 18.06  Environment PHP 7.2.24  Environment Database 0.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior On the Purchase Orders list page: fourn/commande/list.php I will set a single status or multiple statuses to filter the list of Purchase Orders in my website, I will get updated results and then open the card for one of the Purchase Orders. On the Purchase Order card, I will then click on ""Back to list"" link and get taken: fourn/commande/list.php?restore_lastsearch_values=1 I then get an error reading:  Latest database access request error: SELECT s.rowid as socid, s.nom as name, s.name_alias as alias, s.town, s.zip, s.fk_pays, s.client, s.fournisseur, s.code_client, s.email, typent.code as typent_code, state.code_departement as state_code, state.nom as state_name, cf.rowid, cf.ref, cf.ref_supplier, cf.fk_statut, cf.billed, cf.total_ht, cf.total_tva, cf.total_ttc, cf.fk_user_author, cf.date_commande as date_commande, cf.date_livraison as date_livraison,cf.date_valid, cf.date_approve, cf.localtax1 as total_localtax1, cf.localtax2 as total_localtax2, cf.fk_multicurrency, cf.multicurrency_code, cf.multicurrency_tx, cf.multicurrency_total_ht, cf.multicurrency_total_tva, cf.multicurrency_total_ttc, cf.date_creation as date_creation, cf.tms as date_update, cf.note_public, cf.note_private, p.rowid as project_id, p.ref as project_ref, p.title as project_title, u.firstname, u.lastname, u.photo, u.login, u.email as user_email, u.statut as user_status, ef.signature_link as options_signature_link, ef.yardi_po_number as options_yardi_po_number, ef.tracking_number as options_tracking_number FROM llx_societe as s LEFT JOIN llx_c_country as country on (country.rowid = s.fk_pays) LEFT JOIN llx_c_typent as typent on (typent.id = s.fk_typent) LEFT JOIN llx_c_departements as state on (state.rowid = s.fk_departement), llx_commande_fournisseur as cf LEFT JOIN llx_commande_fournisseur_extrafields as ef on (cf.rowid = ef.fk_object) LEFT JOIN llx_user as u ON cf.fk_user_author = u.rowid LEFT JOIN llx_projet as p ON p.rowid = cf.fk_projet WHERE cf.fk_soc = s.rowid AND cf.entity IN (1) AND cf.fk_statut IN (Array) AND s.fk_pays IN (11) ORDER BY cf.ref DESC LIMIT 26 Return code for latest database access request error: DB_ERROR_NOSUCHFIELD Information for latest database access request error: Unknown column 'Array' in 'where clause'   Attached files _No response_",other-file,"Purchase Order Back to list produces DB_ERROR_NOSUCHFIELD  Bug I am receiving DB_ERROR_NOSUCHFIELD Unknown column 'Array' in 'where clause' when I click the link ""Back to list"" on Purchase Orders.  Dolibarr Version 18.06  Environment PHP 7.2.24  Environment Database 0.11.3-MariaDB-1 - Debian 12  Steps to reproduce the behavior and expected behavior On the Purchase Orders list page: fourn/commande/list.php I will set a single status or multiple statuses to filter the list of Purchase Orders in my website, I will get updated results and then open the card for one of the Purchase Orders. On the Purchase Order card, I will then click on ""Back to list"" link and get taken: fourn/commande/list.php?restore_lastsearch_values=1 I then get an error reading:  Latest database access request error: SELECT s.rowid as socid, s.nom as name, s.name_alias as alias, s.town, s.zip, s.fk_pays, s.client, s.fournisseur, s.code_client, s.email, typent.code as typent_code, state.code_departement as state_code, state.nom as state_name, cf.rowid, cf.ref, cf.ref_supplier, cf.fk_statut, cf.billed, cf.total_ht, cf.total_tva, cf.total_ttc, cf.fk_user_author, cf.date_commande as date_commande, cf.date_livraison as date_livraison,cf.date_valid, cf.date_approve, cf.localtax1 as total_localtax1, cf.localtax2 as total_localtax2, cf.fk_multicurrency, cf.multicurrency_code, cf.multicurrency_tx, cf.multicurrency_total_ht, cf.multicurrency_total_tva, cf.multicurrency_total_ttc, cf.date_creation as date_creation, cf.tms as date_update, cf.note_public, cf.note_private, p.rowid as project_id, p.ref as project_ref, p.title as project_title, u.firstname, u.lastname, u.photo, u.login, u.email as user_email, u.statut as user_status, ef.signature_link as options_signature_link, ef.yardi_po_number as options_yardi_po_number, ef.tracking_number as options_tracking_number FROM llx_societe as s LEFT JOIN llx_c_country as country on (country.rowid = s.fk_pays) LEFT JOIN llx_c_typent as typent on (typent.id = s.fk_typent) LEFT JOIN llx_c_departements as state on (state.rowid = s.fk_departement), llx_commande_fournisseur as cf LEFT JOIN llx_commande_fournisseur_extrafields as ef on (cf.rowid = ef.fk_object) LEFT JOIN llx_user as u ON cf.fk_user_author = u.rowid LEFT JOIN llx_projet as p ON p.rowid = cf.fk_projet WHERE cf.fk_soc = s.rowid AND cf.entity IN (1) AND cf.fk_statut IN (Array) AND s.fk_pays IN (11) ORDER BY cf.ref DESC LIMIT 26 Return code for latest database access request error: DB_ERROR_NOSUCHFIELD Information for latest database access request error: Unknown column 'Array' in 'where clause'   Attached files _No response_ other-file",no-bug,0.9
24314,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24314,Attribute 'charges' of ProductFournisseurPrice (buying price) cannot be displayed as list column," Bug Buying prices (ProductFournisseurPrice) can optionally have the attribute 'charges' to store transportation costs and other related charges for a supplier price. The attribute is only shown, if PRODUCT_CHARGES is set. product/fournisseurs.php displays a list of vendor prices with selectable columns, but it's not possible to show a column for charges, even if the option is set correctly.  Environment Version 17.0",other-file,"Attribute 'charges' of ProductFournisseurPrice (buying price) cannot be displayed as list column  Bug Buying prices (ProductFournisseurPrice) can optionally have the attribute 'charges' to store transportation costs and other related charges for a supplier price. The attribute is only shown, if PRODUCT_CHARGES is set. product/fournisseurs.php displays a list of vendor prices with selectable columns, but it's not possible to show a column for charges, even if the option is set correctly.  Environment Version 17.0 other-file",no-bug,0.9
26011,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26011,Period selecting in accounting personalized groups reporting goes wrong, Bug It is not possible to select a part of a year in personalized groups. It always display the whole year.  Environment Version already from 16.x  Environment OS Linux Ubunty 22.04.01  Environment Web server Apache  Environment PHP 7.4.33  Environment Database MySQ L8.0.34  Environment URL(s) _No response_  Expected and actual behavior Normal selection of a period  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file,Period selecting in accounting personalized groups reporting goes wrong  Bug It is not possible to select a part of a year in personalized groups. It always display the whole year.  Environment Version already from 16.x  Environment OS Linux Ubunty 22.04.01  Environment Web server Apache  Environment PHP 7.4.33  Environment Database MySQ L8.0.34  Environment URL(s) _No response_  Expected and actual behavior Normal selection of a period  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file,no-bug,0.9
28296,dolibarr,https://github.com/Dolibarr/dolibarr/issues/28296,"Warning: Undefined array key ""totalbalance"" in htdocs/accountancy/bookkeeping/listbyaccount.php on line 1278"," Bug Warning: Undefined array key ""totalbalance"" in htdocs/accountancy/bookkeeping/listbyaccount.php on line 1278 ![Screenshot 2024-02-20 001131](https://github.com/Dolibarr/dolibarr/assets/74211972/7621f68f-7ecb-45e4-bfd8-23d757995f94)  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file,"Warning: Undefined array key ""totalbalance"" in htdocs/accountancy/bookkeeping/listbyaccount.php on line 1278  Bug Warning: Undefined array key ""totalbalance"" in htdocs/accountancy/bookkeeping/listbyaccount.php on line 1278 ![Screenshot 2024-02-20 001131](https://github.com/Dolibarr/dolibarr/assets/74211972/7621f68f-7ecb-45e4-bfd8-23d757995f94)  Environment Version _No response_  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file",no-bug,0.9
31365,dolibarr,https://github.com/Dolibarr/dolibarr/issues/31365,Bug: Bank account max length is 12 caraceters when created but not anymore after edition," Bug Version: 20.0.1 Hello, I create a new bank account with 12 caracters as a Ref, like this ![image](https://github.com/user-attachments/assets/d0e7627e-fe5a-4cae-a84c-99db7af8206a) And I cannot write more than 12 caracters After creation I have ![image](https://github.com/user-attachments/assets/96f2cca7-7cfb-43c0-8fdf-e6de9ab6787c) Then I edit again this account, but I'm able to write more than 12 caracters ![image](https://github.com/user-attachments/assets/a223acae-1b0a-4c7a-ac09-f23d08cdb29d) And after modification I have this ![image](https://github.com/user-attachments/assets/764c571a-19a1-4fcd-a511-c63dfc29ab70) Then I edit it again and I see that Ref is truncated to 12 caracters ![image](https://github.com/user-attachments/assets/9c9dc49d-787c-4329-a222-eb361af59da7) In database, if I do > desc llx_bank_account; I see that ref is varchar(12) So either Ref should be blocked to 12 caracters after editing, or it should be longer in the database but also blocked to a specific length  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"Bug: Bank account max length is 12 caraceters when created but not anymore after edition  Bug Version: 20.0.1 Hello, I create a new bank account with 12 caracters as a Ref, like this ![image](https://github.com/user-attachments/assets/d0e7627e-fe5a-4cae-a84c-99db7af8206a) And I cannot write more than 12 caracters After creation I have ![image](https://github.com/user-attachments/assets/96f2cca7-7cfb-43c0-8fdf-e6de9ab6787c) Then I edit again this account, but I'm able to write more than 12 caracters ![image](https://github.com/user-attachments/assets/a223acae-1b0a-4c7a-ac09-f23d08cdb29d) And after modification I have this ![image](https://github.com/user-attachments/assets/764c571a-19a1-4fcd-a511-c63dfc29ab70) Then I edit it again and I see that Ref is truncated to 12 caracters ![image](https://github.com/user-attachments/assets/9c9dc49d-787c-4329-a222-eb361af59da7) In database, if I do > desc llx_bank_account; I see that ref is varchar(12) So either Ref should be blocked to 12 caracters after editing, or it should be longer in the database but also blocked to a specific length  Dolibarr Version 20.0.1  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
23916,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23916,No hook result treatment by class eldy in case of left menu," Bug I tried to modify a redirection of a left menu by hooking to ""menuLeftMenuItems"" but that didn't work very well. if I set my hook return at 0, nothing change and if I set it at 1 I have the following error `Warning: count(): Parameter must be an array or an object that implements Countable in /home/server/public_html/dev/htdocs/core/menus/standard/eldy.lib.php on line 2037`  Environment Version 15.0.3 -> dev (verified)  Environment OS cpanel  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior after investigation i found there is a call in eldy.lib.php to `$hookmanager->results` that don't exist (anymore?) and there are no other call with it by replacing `if ($reshook == 0 && !empty($hookmanager->results)) { $menu_array[] = $hookmanager->results; // add } elseif ($reshook == 1) { $menu_array = $hookmanager->results; // replace }` by `if ($reshook == 0 && !empty($hookmanager->resArray)) { $menu_array[] = $hookmanager->resArray; // add } elseif ($reshook == 1) { $menu_array = $hookmanager->resArray; // replace }` it work just fine  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file,"No hook result treatment by class eldy in case of left menu  Bug I tried to modify a redirection of a left menu by hooking to ""menuLeftMenuItems"" but that didn't work very well. if I set my hook return at 0, nothing change and if I set it at 1 I have the following error `Warning: count(): Parameter must be an array or an object that implements Countable in /home/server/public_html/dev/htdocs/core/menus/standard/eldy.lib.php on line 2037`  Environment Version 15.0.3 -> dev (verified)  Environment OS cpanel  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior after investigation i found there is a call in eldy.lib.php to `$hookmanager->results` that don't exist (anymore?) and there are no other call with it by replacing `if ($reshook == 0 && !empty($hookmanager->results)) { $menu_array[] = $hookmanager->results; // add } elseif ($reshook == 1) { $menu_array = $hookmanager->results; // replace }` by `if ($reshook == 0 && !empty($hookmanager->resArray)) { $menu_array[] = $hookmanager->resArray; // add } elseif ($reshook == 1) { $menu_array = $hookmanager->resArray; // replace }` it work just fine  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
32186,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32186,"Bug: External Login thirdpart filter clears when the ""x"" is clicked and all thirdparties are visible to the vendor.","# Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug [*Short description*] ## Environment - **Version**: 20.0.1 - **OS**: Windows NT - **Web server**: Apache/2.4.51 (Win64) PHP/7.3.33 - **PHP**: apache2handler 7.3.33 - **Database**: MySQL or MariaDB 5.5.5-10.6.5-MariaDB - **URL(s)**: /dolibarr/fourn/facture/list.php?leftmenu=suppliers_bills ## Expected and actual behavior [*Verbose description*] ## Steps to reproduce the behavior [*Verbose description*] ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging information) [*Files*] ## Report",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Bug: External Login thirdpart filter clears when the ""x"" is clicked and all thirdparties are visible to the vendor. # Instructions *This is a template to help you report good issues. You may use [Github Markdown](https://help.github.com/articles/getting-started-with-writing-and-formatting-on-github/) syntax to format your issue report.* *Please:* - *replace the bracket enclosed texts with meaningful information* - *remove any unused sub-section* # Bug [*Short description*] ## Environment - **Version**: 20.0.1 - **OS**: Windows NT - **Web server**: Apache/2.4.51 (Win64) PHP/7.3.33 - **PHP**: apache2handler 7.3.33 - **Database**: MySQL or MariaDB 5.5.5-10.6.5-MariaDB - **URL(s)**: /dolibarr/fourn/facture/list.php?leftmenu=suppliers_bills ## Expected and actual behavior [*Verbose description*] ## Steps to reproduce the behavior [*Verbose description*] ## [Attached files](https://help.github.com/articles/issue-attachments) (Screenshots, screencasts, dolibarr.log, debugging information) [*Files*] ## Report other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
33949,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33949,BUG: default value not changed when updating an extrafield using the API," Bug BUG: the default value is not changed when updating an extrafield Did a PUT to this API endpoint `/api/index.php/setup/extrafields/projet/call_to_action` with these request_data  { ""type"": ""varchar"", ""label"": ""Call_to_action"", ""size"": ""26"", ""default"": ""Begin Registration"", ""unique"": ""0"", ""required"": ""0"", ""pos"": ""160"", ""alwayseditable"": ""0"", ""list"": ""1"", ""printable"": ""0"", ""totalizable"": ""0"" }  But if you then do a GET to this API endpoint `http://localhost:22180/api/index.php/setup/extrafields/projet/call_to_action` and I get this reply where the default value is null  { ""projet"": { ""call_to_action"": { ""id"": ""521"", ""type"": ""varchar"", ""label"": ""Call_to_action"", ""size"": ""26"", ""elementtype"": ""projet"", ""default"": null, ""computed"": null, ""unique"": ""0"", ""required"": ""0"", ""param"": """", ""pos"": ""160"", ""alwayseditable"": ""0"", ""perms"": null, ""list"": ""1"", ""printable"": ""0"", ""totalizable"": ""0"", ""langs"": null, ""help"": null, ""css"": null, ""cssview"": null, ""csslist"": null, ""fk_user_author"": ""2"", ""fk_user_modif"": ""2"", ""datec"": ""2025-04-22 18:38:09"", ""tms"": ""2025-04-22 18:38:09"" } } }   Dolibarr Version 22.0.0-alpha  Environment PHP official docker devel image version  Environment Database mariadb latest  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"BUG: default value not changed when updating an extrafield using the API  Bug BUG: the default value is not changed when updating an extrafield Did a PUT to this API endpoint `/api/index.php/setup/extrafields/projet/call_to_action` with these request_data  { ""type"": ""varchar"", ""label"": ""Call_to_action"", ""size"": ""26"", ""default"": ""Begin Registration"", ""unique"": ""0"", ""required"": ""0"", ""pos"": ""160"", ""alwayseditable"": ""0"", ""list"": ""1"", ""printable"": ""0"", ""totalizable"": ""0"" }  But if you then do a GET to this API endpoint `http://localhost:22180/api/index.php/setup/extrafields/projet/call_to_action` and I get this reply where the default value is null  { ""projet"": { ""call_to_action"": { ""id"": ""521"", ""type"": ""varchar"", ""label"": ""Call_to_action"", ""size"": ""26"", ""elementtype"": ""projet"", ""default"": null, ""computed"": null, ""unique"": ""0"", ""required"": ""0"", ""param"": """", ""pos"": ""160"", ""alwayseditable"": ""0"", ""perms"": null, ""list"": ""1"", ""printable"": ""0"", ""totalizable"": ""0"", ""langs"": null, ""help"": null, ""css"": null, ""cssview"": null, ""csslist"": null, ""fk_user_author"": ""2"", ""fk_user_modif"": ""2"", ""datec"": ""2025-04-22 18:38:09"", ""tms"": ""2025-04-22 18:38:09"" } } }   Dolibarr Version 22.0.0-alpha  Environment PHP official docker devel image version  Environment Database mariadb latest  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",bug,0.95
24186,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24186,"V17.0.0 Product listing, Barcode column appears empty."," Bug After upgrading from v16.04 to v17. In the product list, the display of the corresponding testo barcode is not shown, even though it is entered in the product form. This is a serious problem for us, as we have items that can only be identified by the text shown in this column.  Environment Version Versin actual 17.0.0  Environment OS W10 (Win64)  Environment Web server Apache/2.4.48 (Win64)  Environment PHP PHP/7.4.23  Environment Database MariaDB 5.5.5-10.10.2-MariaDB  Environment URL(s) localhost  Expected and actual behavior That the problem be corrected and the column be displayed.  Steps to reproduce the behavior display a list of products showing the list of barcodes  Attached files ![Dolibarr no muestra columna codigo de barras](https://user-images.githubusercontent.com/73311267/224476498-64464018-7691-4837-9c80-882457754843.jpg)",other-file,"V17.0.0 Product listing, Barcode column appears empty.  Bug After upgrading from v16.04 to v17. In the product list, the display of the corresponding testo barcode is not shown, even though it is entered in the product form. This is a serious problem for us, as we have items that can only be identified by the text shown in this column.  Environment Version Versin actual 17.0.0  Environment OS W10 (Win64)  Environment Web server Apache/2.4.48 (Win64)  Environment PHP PHP/7.4.23  Environment Database MariaDB 5.5.5-10.10.2-MariaDB  Environment URL(s) localhost  Expected and actual behavior That the problem be corrected and the column be displayed.  Steps to reproduce the behavior display a list of products showing the list of barcodes  Attached files ![Dolibarr no muestra columna codigo de barras](https://user-images.githubusercontent.com/73311267/224476498-64464018-7691-4837-9c80-882457754843.jpg) other-file",no-bug,0.8
26283,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26283,"Contract list services filter error with ""expired service"""," Bug ![image](https://github.com/Dolibarr/dolibarr/assets/1215488/ca6f14f2-5b1f-40b3-858b-3142b99a5e4b) With filter EXPIRED, in list we see also ""NOT EXPIRED"". I suppose that sql query is not correct.  Environment Version Dolibarr >= 18.x  Environment OS all version  Environment Web server all version  Environment PHP all version  Environment Database all version  Environment URL(s) /contrat/services_list.php?leftmenu=contracts&search_status=4&filter=expired  Expected and actual behavior Do not show ""not expired"" services.  Steps to reproduce the behavior Click on top menu ""COMMERCIAL"" Click on left menu ""Expired Services""  Attached files _No response_",other-file,"Contract list services filter error with ""expired service""  Bug ![image](https://github.com/Dolibarr/dolibarr/assets/1215488/ca6f14f2-5b1f-40b3-858b-3142b99a5e4b) With filter EXPIRED, in list we see also ""NOT EXPIRED"". I suppose that sql query is not correct.  Environment Version Dolibarr >= 18.x  Environment OS all version  Environment Web server all version  Environment PHP all version  Environment Database all version  Environment URL(s) /contrat/services_list.php?leftmenu=contracts&search_status=4&filter=expired  Expected and actual behavior Do not show ""not expired"" services.  Steps to reproduce the behavior Click on top menu ""COMMERCIAL"" Click on left menu ""Expired Services""  Attached files _No response_ other-file",bug,0.85
26862,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26862,sendEmailsRemindersOnInvoiceDueDate attachment not present," Bug When send mail with cron, not attachment present.  Environment Version 18.0.2  Environment OS Ubuntu server 22.04  Environment Web server _No response_  Environment PHP 8.1  Environment Database mysql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"sendEmailsRemindersOnInvoiceDueDate attachment not present  Bug When send mail with cron, not attachment present.  Environment Version 18.0.2  Environment OS Ubuntu server 22.04  Environment Web server _No response_  Environment PHP 8.1  Environment Database mysql  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.8
25046,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25046,wrong url for Landingpage for user setting," Bug When setting landing page on InvoiceArea (label says Facturation et paiement), url is compta/index.php?mainmenu=compta&leftmenu= we are not in invoice managementarea, and we have no left menu  Environment Version 18-beta  Environment OS linux  Environment Web server apache  Environment PHP php 7.3  Environment Database MariaDB  Environment URL(s) /user/param_ihm.php?id=1  Expected and actual behavior add link for invoie area /compta/index.php?mainmenu=billing&leftmenu= correct link for Acountancy area to /accountancy/index.php?mainmenu=accountancy&leftmenu=  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file,"wrong url for Landingpage for user setting  Bug When setting landing page on InvoiceArea (label says Facturation et paiement), url is compta/index.php?mainmenu=compta&leftmenu= we are not in invoice managementarea, and we have no left menu  Environment Version 18-beta  Environment OS linux  Environment Web server apache  Environment PHP php 7.3  Environment Database MariaDB  Environment URL(s) /user/param_ihm.php?id=1  Expected and actual behavior add link for invoie area /compta/index.php?mainmenu=billing&leftmenu= correct link for Acountancy area to /accountancy/index.php?mainmenu=accountancy&leftmenu=  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file",no-bug,0.9
33397,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33397,Action buttons on shipment card don't work," Bug Action buttons on shipment card don't work  Dolibarr Version develop  Environment PHP 7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior Create a shipment and try to validate : ![Image](https://github.com/user-attachments/assets/498288cb-9584-4972-bf99-b33fcd85b5a8) -> You got a white page It's the same problem on the most of action buttons If you want to send an email, classify billed, close, cancel or delete a shipment, you got the same problem (white page with no error message)  Attached files _No response_",other-file,"Action buttons on shipment card don't work  Bug Action buttons on shipment card don't work  Dolibarr Version develop  Environment PHP 7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior Create a shipment and try to validate : ![Image](https://github.com/user-attachments/assets/498288cb-9584-4972-bf99-b33fcd85b5a8) -> You got a white page It's the same problem on the most of action buttons If you want to send an email, classify billed, close, cancel or delete a shipment, you got the same problem (white page with no error message)  Attached files _No response_ other-file",no-bug,0.9
26342,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26342,Sort by payment type in the table dolibarr/compta/payment/list.php," Bug When I modify the file dolibarr/compta/payment/list.php by adding 'c.libelle' to the query: // DISTINCT is to avoid duplicate when there is a link to sales representatives $sql = ""SELECT DISTINCT p.rowid, p.ref, p.datep, p.fk_bank, p.amount, p.statut, p.num_paiement, c.libelle""; $sql .= "", c.code as paiement_code""; $sql .= "", ba.rowid as bid, ba.ref as bref, ba.label as blabel, ba.number, ba.account_number as account_number, ba.fk_accountancy_journal as accountancy_journal""; $sql .= "", s.rowid as socid, s.nom as name, s.email""; The sorting is done correctly, and I no longer encounter any errors.  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior When I click on 'type' in the payments table to sort it in ascending or descending order, I expect the data to be sorted correctly. However, instead, I receive the following error: Requested URL: /dolibarr/compta/payment/list.php?sortfield=c.libelle&sortorder=asc&begin=&contextpage=paymentlist Referer: http://localhost/dolibarr/compta/payment/list.php?sortfield=c.libelle&sortorder=desc&begin=&contextpage=paymentlist Menu Handler: eldy_menu.php Modules/Applications: syslog, user, api, contract, ficheinter, supplier_proposal, incoterm, tax, loan, propal, productbatch, stock, product, expedition, project, mailing, workflow, import, export, bookmark, fckeditor, gravatar, paypal, notification, clicktodial, blockedlog, agenda, bank, barcode, cron, order, donation, ecm, expensereport, supplier, holiday, margin, opensurvey, paybox, printing, resource, salaries, service, company, modulebuilder, webhook, emailcollector, debugbar, knowledgemanagement, externalids, ticket, invoice, direct_debit, recovery Database Manager Type: mysqli Error in the last database access: SELECT DISTINCT p.rowid, p.ref, p.datep, p.fk_bank, p.amount, p.statut, p.num_paiement, c.code as payment_code, ba.rowid as bid, ba.ref as bref, ba.label as blabel, ba.number, ba.account_number as account_number, ba.fk_accountancy_journal as accountancy_journal, s.rowid as socid, s.nom as name, s.email FROM llx_paiement as p LEFT JOIN llx_c_paiement as c ON p.fk_paiement = c.id LEFT JOIN llx_bank as b ON p.fk_bank = b.rowid LEFT JOIN llx_bank_account as ba ON b.fk_account = ba.rowid LEFT JOIN llx_payment_invoice as pf ON p.rowid = pf.fk_payment LEFT JOIN llx_invoice as f ON pf.fk_invoice = f.rowid LEFT JOIN llx_company as s ON f.fk_soc = s.rowid WHERE p.entity IN (1) ORDER BY c.libelle ASC LIMIT 26 Last database access return code in error: DB_ERROR_3065 Information on the last database access error: Expression #1 of ORDER BY clause is not in SELECT list, references column 'dolibarr18.0.1.c.libelle' which is not in SELECT list; this is incompatible with DISTINCT.""  Steps to reproduce the behavior ""The error occurs when I click on the 'type' column in the payment table dolibarr/compta/payment/list.php.  Attached files _No response_",other-file | other-file | other-file,"Sort by payment type in the table dolibarr/compta/payment/list.php  Bug When I modify the file dolibarr/compta/payment/list.php by adding 'c.libelle' to the query: // DISTINCT is to avoid duplicate when there is a link to sales representatives $sql = ""SELECT DISTINCT p.rowid, p.ref, p.datep, p.fk_bank, p.amount, p.statut, p.num_paiement, c.libelle""; $sql .= "", c.code as paiement_code""; $sql .= "", ba.rowid as bid, ba.ref as bref, ba.label as blabel, ba.number, ba.account_number as account_number, ba.fk_accountancy_journal as accountancy_journal""; $sql .= "", s.rowid as socid, s.nom as name, s.email""; The sorting is done correctly, and I no longer encounter any errors.  Environment Version 18.0.1  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior When I click on 'type' in the payments table to sort it in ascending or descending order, I expect the data to be sorted correctly. However, instead, I receive the following error: Requested URL: /dolibarr/compta/payment/list.php?sortfield=c.libelle&sortorder=asc&begin=&contextpage=paymentlist Referer: http://localhost/dolibarr/compta/payment/list.php?sortfield=c.libelle&sortorder=desc&begin=&contextpage=paymentlist Menu Handler: eldy_menu.php Modules/Applications: syslog, user, api, contract, ficheinter, supplier_proposal, incoterm, tax, loan, propal, productbatch, stock, product, expedition, project, mailing, workflow, import, export, bookmark, fckeditor, gravatar, paypal, notification, clicktodial, blockedlog, agenda, bank, barcode, cron, order, donation, ecm, expensereport, supplier, holiday, margin, opensurvey, paybox, printing, resource, salaries, service, company, modulebuilder, webhook, emailcollector, debugbar, knowledgemanagement, externalids, ticket, invoice, direct_debit, recovery Database Manager Type: mysqli Error in the last database access: SELECT DISTINCT p.rowid, p.ref, p.datep, p.fk_bank, p.amount, p.statut, p.num_paiement, c.code as payment_code, ba.rowid as bid, ba.ref as bref, ba.label as blabel, ba.number, ba.account_number as account_number, ba.fk_accountancy_journal as accountancy_journal, s.rowid as socid, s.nom as name, s.email FROM llx_paiement as p LEFT JOIN llx_c_paiement as c ON p.fk_paiement = c.id LEFT JOIN llx_bank as b ON p.fk_bank = b.rowid LEFT JOIN llx_bank_account as ba ON b.fk_account = ba.rowid LEFT JOIN llx_payment_invoice as pf ON p.rowid = pf.fk_payment LEFT JOIN llx_invoice as f ON pf.fk_invoice = f.rowid LEFT JOIN llx_company as s ON f.fk_soc = s.rowid WHERE p.entity IN (1) ORDER BY c.libelle ASC LIMIT 26 Last database access return code in error: DB_ERROR_3065 Information on the last database access error: Expression #1 of ORDER BY clause is not in SELECT list, references column 'dolibarr18.0.1.c.libelle' which is not in SELECT list; this is incompatible with DISTINCT.""  Steps to reproduce the behavior ""The error occurs when I click on the 'type' column in the payment table dolibarr/compta/payment/list.php.  Attached files _No response_ other-file other-file other-file",no-bug,0.9
29900,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29900,Billing status not checked on Project's Task tab List of Tasks when Billing is True, Bug Same as title.  Dolibarr Version develop  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file,Billing status not checked on Project's Task tab List of Tasks when Billing is True  Bug Same as title.  Dolibarr Version develop  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file,no-bug,0.7
23806,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23806,Contact Dictionnary- Position not take in account into Projects/TASKS page," Bug Hi, Currently the POSTION attribute available in Dictionnary Type of contact is not trully managed into Project/Tasks htdocs/projet/tasks/contact.php AS IS : $formcompany->selectTypeContact($object, '', 'type', 'internal', 'rowid'); TO BE : $formcompany->selectTypeContact($object, '', 'type', 'internal', 'position'); Same for external : $formcompany->selectTypeContact($object, '', 'typecontact', 'external', 'rowid'); Regards, Fred  Environment Version 16.0.4  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Contact Dictionnary- Position not take in account into Projects/TASKS page  Bug Hi, Currently the POSTION attribute available in Dictionnary Type of contact is not trully managed into Project/Tasks htdocs/projet/tasks/contact.php AS IS : $formcompany->selectTypeContact($object, '', 'type', 'internal', 'rowid'); TO BE : $formcompany->selectTypeContact($object, '', 'type', 'internal', 'position'); Same for external : $formcompany->selectTypeContact($object, '', 'typecontact', 'external', 'rowid'); Regards, Fred  Environment Version 16.0.4  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.8
33403,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33403,E-Mailcollector doesn't find Thirdparty by E-Mail Address of Contact," Bug When using action ""loadthirdparty"" there are different attempts to find the right thirdparty. if parameter ""email"" is specified, also contacts of thirdparties are searched using the method findNearest. This method declares a local instance of the Contact object and does not return the ID found  Dolibarr Version 20.0  Environment PHP na  Environment Database na  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"E-Mailcollector doesn't find Thirdparty by E-Mail Address of Contact  Bug When using action ""loadthirdparty"" there are different attempts to find the right thirdparty. if parameter ""email"" is specified, also contacts of thirdparties are searched using the method findNearest. This method declares a local instance of the Contact object and does not return the ID found  Dolibarr Version 20.0  Environment PHP na  Environment Database na  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.8
32176,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32176,PHP Warning in eventorganization/conferenceorboothattendee_list.php, Bug Warning: Undefined property: stdClass::$MAIN_AGENDA_XCAL_EXPORTKEY in /Users/gl/Code/GitHub/doli-priv/htdocs/eventorganization/conferenceorboothattendee_list.php on line 606  Dolibarr Version 20.0  Environment PHP 8.1  Environment Database n/a  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file,PHP Warning in eventorganization/conferenceorboothattendee_list.php  Bug Warning: Undefined property: stdClass::$MAIN_AGENDA_XCAL_EXPORTKEY in /Users/gl/Code/GitHub/doli-priv/htdocs/eventorganization/conferenceorboothattendee_list.php on line 606  Dolibarr Version 20.0  Environment PHP 8.1  Environment Database n/a  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
27313,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27313,Impossible de modifier une fiche d'intervention une fois qu'elle a t valide," Bug Hello, When I want to update an intervention that I have validated, I got a server error 500. Please find the message log I had from Apache: [Sat Jan 06 22:09:26.135078 2024] [proxy_fcgi:error] [pid 20255] [client xxx.xxx.xxx.xx:53727] AH01071: Got error 'PHP message: PHP Fatal error: Uncaught Exception: Serialization of 'PgSql\\Connection' is not allowed in /var/www/dolibarr/htdocs/core/lib/functions.lib.php:1272\nStack trace:\n#0 /var/www/dolibarr/htdocs/core/lib/functions.lib.php(1272): serialize()\n#1 /var/www/dolibarr/htdocs/fichinter/class/fichinter.class.php(529): dol_clone()\n#2 /var/www/dolibarr/htdocs/fichinter/card.php(203): Fichinter->setDraft()\n#3 {main}\n thrown in /var/www/dolibarr/htdocs/core/lib/functions.lib.php on line 1272', referer: https://xxxx/fichinter/card.php?id=87&action=modify I try with another record marked as Done, I can re-open it but if I want to modify, I receive the same error. I have updated my version (18.0.4) and the error still present.  Environment Version 18.0.3, 18.0.4  Environment OS Linux ubuntu server  Environment Web server apache2  Environment PHP 8.1.2  Environment Database postgresql 12.12  Environment URL(s) fichinter/card.php?id=89&save_lastsearch_values=1  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file | other-file | other-file | other-file,"Impossible de modifier une fiche d'intervention une fois qu'elle a t valide  Bug Hello, When I want to update an intervention that I have validated, I got a server error 500. Please find the message log I had from Apache: [Sat Jan 06 22:09:26.135078 2024] [proxy_fcgi:error] [pid 20255] [client xxx.xxx.xxx.xx:53727] AH01071: Got error 'PHP message: PHP Fatal error: Uncaught Exception: Serialization of 'PgSql\\Connection' is not allowed in /var/www/dolibarr/htdocs/core/lib/functions.lib.php:1272\nStack trace:\n#0 /var/www/dolibarr/htdocs/core/lib/functions.lib.php(1272): serialize()\n#1 /var/www/dolibarr/htdocs/fichinter/class/fichinter.class.php(529): dol_clone()\n#2 /var/www/dolibarr/htdocs/fichinter/card.php(203): Fichinter->setDraft()\n#3 {main}\n thrown in /var/www/dolibarr/htdocs/core/lib/functions.lib.php on line 1272', referer: https://xxxx/fichinter/card.php?id=87&action=modify I try with another record marked as Done, I can re-open it but if I want to modify, I receive the same error. I have updated my version (18.0.4) and the error still present.  Environment Version 18.0.3, 18.0.4  Environment OS Linux ubuntu server  Environment Web server apache2  Environment PHP 8.1.2  Environment Database postgresql 12.12  Environment URL(s) fichinter/card.php?id=89&save_lastsearch_values=1  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.8
33160,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33160,dol_check_secure_access_document bad value for sharing link on productlot," Bug ![Image](https://github.com/user-attachments/assets/3a6de3a3-2533-4648-bf3d-8f2f26a38683)  Dolibarr Version 20, 21, develop  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",other-file | other-file,"dol_check_secure_access_document bad value for sharing link on productlot  Bug ![Image](https://github.com/user-attachments/assets/3a6de3a3-2533-4648-bf3d-8f2f26a38683)  Dolibarr Version 20, 21, develop  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file",no-bug,0.9
32765,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32765,JS Error: Uncaught TypeError: Cannot read properties of undefined (reading 'submitter') on function printCommonFooter()," Bug When a ""Mandatory Form Field"" is defined for purchase order; happen two things: 1- Mandatory fields defined of type INPUT does not being mandatory 2- The auto update when change vendor select, stops working  Dolibarr Version 20.0.3  Environment PHP 8.1.31  Environment Database 11.4.4-MariaDB  Steps to reproduce the behavior and expected behavior 1. Set **Wait until a key is pressed before loading content of Project combo list** on Module Project Setup to value 2 ![Image](https://github.com/user-attachments/assets/712e7a7d-cf08-41fe-8aed-1a2b2be4b97a) 2. Define a mandory field for purchase order; > Setup -> Default values/filters/sorting -> Mandatory form fields ![Image](https://github.com/user-attachments/assets/7255b382-c8bd-4801-95ba-8d12eedc00f4) **Relative URL =** fourn/commande/card.php?action=create **Field =** projectid 3. On Commerce create new purchase order > Commerce -> New Order 4. Select Vendor ![Image](https://github.com/user-attachments/assets/5ae53030-d652-4012-9cf2-2902f3412bed) When vendor is selected a error is registred on console log ![Image](https://github.com/user-attachments/assets/823be59f-6289-48a9-be26-cf015da88683) 5. Let Project empty 6. Press CREATE DRAFT button Instead of create a draft document, the vendor info is refreshed; that should be refreshed on selecting vendor 7. Let Project empty 8. Press CREATE DRAFT again to create the draft document, but the mandatory field ""Project"" does not checked and remains empty  Attached files _No response_",other-file | other-file,"JS Error: Uncaught TypeError: Cannot read properties of undefined (reading 'submitter') on function printCommonFooter()  Bug When a ""Mandatory Form Field"" is defined for purchase order; happen two things: 1- Mandatory fields defined of type INPUT does not being mandatory 2- The auto update when change vendor select, stops working  Dolibarr Version 20.0.3  Environment PHP 8.1.31  Environment Database 11.4.4-MariaDB  Steps to reproduce the behavior and expected behavior 1. Set **Wait until a key is pressed before loading content of Project combo list** on Module Project Setup to value 2 ![Image](https://github.com/user-attachments/assets/712e7a7d-cf08-41fe-8aed-1a2b2be4b97a) 2. Define a mandory field for purchase order; > Setup -> Default values/filters/sorting -> Mandatory form fields ![Image](https://github.com/user-attachments/assets/7255b382-c8bd-4801-95ba-8d12eedc00f4) **Relative URL =** fourn/commande/card.php?action=create **Field =** projectid 3. On Commerce create new purchase order > Commerce -> New Order 4. Select Vendor ![Image](https://github.com/user-attachments/assets/5ae53030-d652-4012-9cf2-2902f3412bed) When vendor is selected a error is registred on console log ![Image](https://github.com/user-attachments/assets/823be59f-6289-48a9-be26-cf015da88683) 5. Let Project empty 6. Press CREATE DRAFT button Instead of create a draft document, the vendor info is refreshed; that should be refreshed on selecting vendor 7. Let Project empty 8. Press CREATE DRAFT again to create the draft document, but the mandatory field ""Project"" does not checked and remains empty  Attached files _No response_ other-file other-file",no-bug,0.8
32376,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32376,[20.0.2][pgsql] SQL error when transferring lines from selling journal to accountancy.," Bug SQL error when transferring lines from selling journal to accountancy, making the transfer fails, when running on postgresql database.  Dolibarr Version 19.0.3 - 20.0.2  Environment PHP 8.2  Environment Database Postgresql 15  Steps to reproduce the behavior and expected behavior - Same base as https://github.com/Dolibarr/dolibarr/issues/32375#issue-2740746018, ie: - Create a thirdparty client - Create an invoice - Pay the invoice - Transfer the customer invoice (it somehow says it fails to add every lines) - Reload PCG plan, ensure every accounts are setup - transfer to accountancy In practice, I also reproduce on production while trying to transfer to accountancy, after the upgrade to dolibarr 19.0.3.  Attached files  Error ERROR: 42804: argument of CASE/WHEN must be type boolean, not type integer LINE 1: k, tl2.fk_doc FROM ( SELECT DISTINCT (CASE WHEN tll.fk_fac ^ LOCATION: coerce_to_boolean, parse_coerce.c:1176  Happens since 19.0.3, reproduced on 20.0.2. Dolibarr logs:  Dec 15 16:27:20 dolibarr[125]: 33 BEGIN Transaction Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping::create Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT date_start, date_end FROM llx_accounting_fiscalyear WHERE entity = 1 AND statut = 0 Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT count(*) as nb FROM llx_accounting_bookkeeping WHERE doc_type = 'customer_invoice' AND fk_doc = 8 AND numero_compte = '411' AND label_operation = 'test - F010001 - Compte auxiliaire' AND entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping:: create sqlnum=SELECT piece_num FROM llx_accounting_bookkeeping WHERE doc_type = 'customer_invoice' AND fk_doc = 8 AND doc_ref = 'F010001' AND entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT piece_num FROM llx_accounting_bookkeeping WHERE doc_type = 'customer_invoice' AND fk_doc = 8 AND doc_ref = 'F010001' AND entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping::create this->piece_num= Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT MAX(piece_num)+1 as maxpiecenum FROM llx_accounting_bookkeeping WHERE entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping:: create now this->piece_num= Dec 15 16:27:20 dolibarr[125]: 33 sql=INSERT INTO llx_accounting_bookkeeping (doc_date, date_lim_reglement, doc_type, doc_ref, fk_doc, fk_docdet, thirdparty_code, subledger_account, subledger_label, numero_compte, label_compte, label_operation, debit, credit, montant, sens, fk_user_author, date_creation, code_journal, journal_label, piece_num, entity) VALUES ('2024-12-01 00:00:00', '2024-12-31 00:00:00', 'customer_invoice', 'F010001', 8, 0, 'C000001', 'C000001', 'test', '411', 'Clients', 'test - F010001 - Compte auxiliaire', 7247.1, 0, 7247.1, 'D', '2', '2024-12-15 16:27:20', 'VT', 'Ventes', 1, 1) Dec 15 16:27:20 dolibarr[125]: 33 Lettering::getLinkedLines - Get all bookkeeping lines Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT DISTINCT ab.doc_type, ab.fk_doc FROM llx_accounting_bookkeeping AS ab WHERE ab.entity IN (1) AND ab.fk_doc > 0 AND EXISTS ( SELECT rowid FROM llx_accounting_bookkeeping AS pn WHERE pn.entity IN (1) AND pn.rowid IN (4) AND pn.piece_num = ab.piece_num ) AND ab.subledger_account != '' Dec 15 16:27:20 dolibarr[125]: 33 Lettering::getLinkedDocumentByGroup - Get document lines Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT DISTINCT tl2.fk_paiement AS fk_link, tl2.fk_facture AS fk_doc FROM llx_paiement_facture AS tl LEFT JOIN llx_paiement_facture AS tl2 ON tl2.fk_paiement = tl.fk_paiement WHERE tl.fk_facture IN (8) Dec 15 16:27:20 dolibarr[125]: 33 Lettering::getLinkedDocumentByGroup - Get document lines Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT DISTINCT tl2.fk_link, tl2.fk_doc FROM ( SELECT DISTINCT (CASE WHEN tll.fk_facture THEN tll.fk_facture ELSE tl.fk_facture END) AS fk_link, tl.fk_facture_source AS fk_doc FROM llx_societe_remise_except AS tl LEFT JOIN llx_facturedet AS tll ON tll.rowid = tl.fk_facture_line) AS tl LEFT JOIN ( SELECT DISTINCT (CASE WHEN tll.fk_facture THEN tll.fk_facture ELSE tl.fk_facture END) AS fk_link, tl.fk_facture_source AS fk_doc FROM llx_societe_remise_except AS tl LEFT JOIN llx_facturedet AS tll ON tll.rowid = tl.fk_facture_line) AS tl2 ON tl2.fk_link = tl.fk_link WHERE tl.fk_doc IN (8) AND tl2.fk_doc IS NOT NULL Dec 15 16:27:20 dolibarr[125]: 33 DoliDBPgsql::query SQL Error message: ERROR: 42804: argument of CASE/WHEN must be type boolean, not type integer Dec 15 16:27:20 dolibarr[125]: LINE 1: k, tl2.fk_doc FROM ( SELECT DISTINCT (CASE WHEN tll.fk_fac Dec 15 16:27:20 dolibarr[125]: ^ Dec 15 16:27:20 dolibarr[125]: LOCATION: coerce_to_boolean, parse_coerce.c:1176 (DB_ERROR_42804) Dec 15 16:27:20 dolibarr[125]: 33 DoliDBPgsql::query SQL Error usesavepoint = 0 Dec 15 16:27:20 dolibarr[125]: 33 AccountingAccount::fetch rowid=0 account_number=707002 Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT a.rowid as rowid, a.datec, a.tms, a.fk_pcg_version, a.pcg_type, a.account_number, a.account_parent, a.label, a.labelshort, a.fk_accounting_category, a.fk_user_author, a.fk_user_modif, a.active, a.reconcilable, ca.label as category_label FROM llx_accounting_account as a LEFT JOIN llx_c_accounting_category as ca ON a.fk_accounting_category = ca.rowid WHERE a.account_number = '707002' AND a.entity = 1 AND a.fk_pcg_version IN (SELECT pcg_version FROM llx_accounting_system WHERE rowid = 2) Dec 15 16:27:20 dolibarr[125]: 33 AccountingAccount::fetch rowid= account_number=445712 Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT a.rowid as rowid, a.datec, a.tms, a.fk_pcg_version, a.pcg_type, a.account_number, a.account_parent, a.label, a.labelshort, a.fk_accounting_category, a.fk_user_author, a.fk_user_modif, a.active, a.reconcilable, ca.label as category_label FROM llx_accounting_account as a LEFT JOIN llx_c_accounting_category as ca ON a.fk_accounting_category = ca.rowid WHERE a.account_number = '445712' AND a.entity = 1 AND a.fk_pcg_version IN (SELECT pcg_version FROM llx_accounting_system WHERE rowid = 2) Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping::create Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT count(*) as nb FROM llx_accounting_bookkeeping WHERE doc_type = 'customer_invoice' AND fk_doc = 8 AND numero_compte = '445712' AND label_operation = 'test - F010001 - Taxes 20 %' AND entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping::create Error ERROR: 42804: argument of CASE/WHEN must be type boolean, not type integer Dec 15 16:27:20 dolibarr[125]: LINE 1: k, tl2.fk_doc FROM ( SELECT DISTINCT (CASE WHEN tll.fk_fac Dec 15 16:27:20 dolibarr[125]: ^ Dec 15 16:27:20 dolibarr[125]: LOCATION: coerce_to_boolean, parse_coerce.c:1176 Dec 15 16:27:20 dolibarr[125]: 33 ROLLBACK Transaction  ![image](https://github.com/user-attachments/assets/0db515a1-1b0f-4948-86a0-86ad46af55dd)",other-file | other-file | other-file,"[20.0.2][pgsql] SQL error when transferring lines from selling journal to accountancy.  Bug SQL error when transferring lines from selling journal to accountancy, making the transfer fails, when running on postgresql database.  Dolibarr Version 19.0.3 - 20.0.2  Environment PHP 8.2  Environment Database Postgresql 15  Steps to reproduce the behavior and expected behavior - Same base as https://github.com/Dolibarr/dolibarr/issues/32375#issue-2740746018, ie: - Create a thirdparty client - Create an invoice - Pay the invoice - Transfer the customer invoice (it somehow says it fails to add every lines) - Reload PCG plan, ensure every accounts are setup - transfer to accountancy In practice, I also reproduce on production while trying to transfer to accountancy, after the upgrade to dolibarr 19.0.3.  Attached files  Error ERROR: 42804: argument of CASE/WHEN must be type boolean, not type integer LINE 1: k, tl2.fk_doc FROM ( SELECT DISTINCT (CASE WHEN tll.fk_fac ^ LOCATION: coerce_to_boolean, parse_coerce.c:1176  Happens since 19.0.3, reproduced on 20.0.2. Dolibarr logs:  Dec 15 16:27:20 dolibarr[125]: 33 BEGIN Transaction Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping::create Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT date_start, date_end FROM llx_accounting_fiscalyear WHERE entity = 1 AND statut = 0 Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT count(*) as nb FROM llx_accounting_bookkeeping WHERE doc_type = 'customer_invoice' AND fk_doc = 8 AND numero_compte = '411' AND label_operation = 'test - F010001 - Compte auxiliaire' AND entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping:: create sqlnum=SELECT piece_num FROM llx_accounting_bookkeeping WHERE doc_type = 'customer_invoice' AND fk_doc = 8 AND doc_ref = 'F010001' AND entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT piece_num FROM llx_accounting_bookkeeping WHERE doc_type = 'customer_invoice' AND fk_doc = 8 AND doc_ref = 'F010001' AND entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping::create this->piece_num= Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT MAX(piece_num)+1 as maxpiecenum FROM llx_accounting_bookkeeping WHERE entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping:: create now this->piece_num= Dec 15 16:27:20 dolibarr[125]: 33 sql=INSERT INTO llx_accounting_bookkeeping (doc_date, date_lim_reglement, doc_type, doc_ref, fk_doc, fk_docdet, thirdparty_code, subledger_account, subledger_label, numero_compte, label_compte, label_operation, debit, credit, montant, sens, fk_user_author, date_creation, code_journal, journal_label, piece_num, entity) VALUES ('2024-12-01 00:00:00', '2024-12-31 00:00:00', 'customer_invoice', 'F010001', 8, 0, 'C000001', 'C000001', 'test', '411', 'Clients', 'test - F010001 - Compte auxiliaire', 7247.1, 0, 7247.1, 'D', '2', '2024-12-15 16:27:20', 'VT', 'Ventes', 1, 1) Dec 15 16:27:20 dolibarr[125]: 33 Lettering::getLinkedLines - Get all bookkeeping lines Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT DISTINCT ab.doc_type, ab.fk_doc FROM llx_accounting_bookkeeping AS ab WHERE ab.entity IN (1) AND ab.fk_doc > 0 AND EXISTS ( SELECT rowid FROM llx_accounting_bookkeeping AS pn WHERE pn.entity IN (1) AND pn.rowid IN (4) AND pn.piece_num = ab.piece_num ) AND ab.subledger_account != '' Dec 15 16:27:20 dolibarr[125]: 33 Lettering::getLinkedDocumentByGroup - Get document lines Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT DISTINCT tl2.fk_paiement AS fk_link, tl2.fk_facture AS fk_doc FROM llx_paiement_facture AS tl LEFT JOIN llx_paiement_facture AS tl2 ON tl2.fk_paiement = tl.fk_paiement WHERE tl.fk_facture IN (8) Dec 15 16:27:20 dolibarr[125]: 33 Lettering::getLinkedDocumentByGroup - Get document lines Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT DISTINCT tl2.fk_link, tl2.fk_doc FROM ( SELECT DISTINCT (CASE WHEN tll.fk_facture THEN tll.fk_facture ELSE tl.fk_facture END) AS fk_link, tl.fk_facture_source AS fk_doc FROM llx_societe_remise_except AS tl LEFT JOIN llx_facturedet AS tll ON tll.rowid = tl.fk_facture_line) AS tl LEFT JOIN ( SELECT DISTINCT (CASE WHEN tll.fk_facture THEN tll.fk_facture ELSE tl.fk_facture END) AS fk_link, tl.fk_facture_source AS fk_doc FROM llx_societe_remise_except AS tl LEFT JOIN llx_facturedet AS tll ON tll.rowid = tl.fk_facture_line) AS tl2 ON tl2.fk_link = tl.fk_link WHERE tl.fk_doc IN (8) AND tl2.fk_doc IS NOT NULL Dec 15 16:27:20 dolibarr[125]: 33 DoliDBPgsql::query SQL Error message: ERROR: 42804: argument of CASE/WHEN must be type boolean, not type integer Dec 15 16:27:20 dolibarr[125]: LINE 1: k, tl2.fk_doc FROM ( SELECT DISTINCT (CASE WHEN tll.fk_fac Dec 15 16:27:20 dolibarr[125]: ^ Dec 15 16:27:20 dolibarr[125]: LOCATION: coerce_to_boolean, parse_coerce.c:1176 (DB_ERROR_42804) Dec 15 16:27:20 dolibarr[125]: 33 DoliDBPgsql::query SQL Error usesavepoint = 0 Dec 15 16:27:20 dolibarr[125]: 33 AccountingAccount::fetch rowid=0 account_number=707002 Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT a.rowid as rowid, a.datec, a.tms, a.fk_pcg_version, a.pcg_type, a.account_number, a.account_parent, a.label, a.labelshort, a.fk_accounting_category, a.fk_user_author, a.fk_user_modif, a.active, a.reconcilable, ca.label as category_label FROM llx_accounting_account as a LEFT JOIN llx_c_accounting_category as ca ON a.fk_accounting_category = ca.rowid WHERE a.account_number = '707002' AND a.entity = 1 AND a.fk_pcg_version IN (SELECT pcg_version FROM llx_accounting_system WHERE rowid = 2) Dec 15 16:27:20 dolibarr[125]: 33 AccountingAccount::fetch rowid= account_number=445712 Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT a.rowid as rowid, a.datec, a.tms, a.fk_pcg_version, a.pcg_type, a.account_number, a.account_parent, a.label, a.labelshort, a.fk_accounting_category, a.fk_user_author, a.fk_user_modif, a.active, a.reconcilable, ca.label as category_label FROM llx_accounting_account as a LEFT JOIN llx_c_accounting_category as ca ON a.fk_accounting_category = ca.rowid WHERE a.account_number = '445712' AND a.entity = 1 AND a.fk_pcg_version IN (SELECT pcg_version FROM llx_accounting_system WHERE rowid = 2) Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping::create Dec 15 16:27:20 dolibarr[125]: 33 sql=SELECT count(*) as nb FROM llx_accounting_bookkeeping WHERE doc_type = 'customer_invoice' AND fk_doc = 8 AND numero_compte = '445712' AND label_operation = 'test - F010001 - Taxes 20 %' AND entity = 1 Dec 15 16:27:20 dolibarr[125]: 33 BookKeeping::create Error ERROR: 42804: argument of CASE/WHEN must be type boolean, not type integer Dec 15 16:27:20 dolibarr[125]: LINE 1: k, tl2.fk_doc FROM ( SELECT DISTINCT (CASE WHEN tll.fk_fac Dec 15 16:27:20 dolibarr[125]: ^ Dec 15 16:27:20 dolibarr[125]: LOCATION: coerce_to_boolean, parse_coerce.c:1176 Dec 15 16:27:20 dolibarr[125]: 33 ROLLBACK Transaction  ![image](https://github.com/user-attachments/assets/0db515a1-1b0f-4948-86a0-86ad46af55dd) other-file other-file other-file",no-bug,0.95
33145,dolibarr,https://github.com/Dolibarr/dolibarr/issues/33145,Wrong label status buy on product tooltip when creating a customer order from proposal, Bug Wrong label status buy on product tooltip when creating a customer order from proposal  Dolibarr Version 18.0 until develop  Environment PHP PHP7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Create a propoal and add a product whose status is in sell and to buy 2. Create a customer order from proposal 3. You got a wrong selling status and a wrong buying status on product tooltip **The product is not in sell and not to buy**  Attached files _No response_,other-file | other-file,Wrong label status buy on product tooltip when creating a customer order from proposal  Bug Wrong label status buy on product tooltip when creating a customer order from proposal  Dolibarr Version 18.0 until develop  Environment PHP PHP7.4 and 8.2  Environment Database MySQL  Steps to reproduce the behavior and expected behavior 1. Create a propoal and add a product whose status is in sell and to buy 2. Create a customer order from proposal 3. You got a wrong selling status and a wrong buying status on product tooltip **The product is not in sell and not to buy**  Attached files _No response_ other-file other-file,no-bug,0.8
25230,dolibarr,https://github.com/Dolibarr/dolibarr/issues/25230,REST POST /supplierinvoices/{id}/payments ability to add partial payment," Feature Request Currently with the API endpoint `POST /supplierinvoices/{id}/payments` you can only add a payment to a supplier invoice with the remain to pay as amount. Request : ability to add a partial payment on supplier invoices API as on the customer invoice API  Use case Supplier invoices are often payed with 2 (or more) partials payments, one payment before the supplier ships the order and one payment after order delivery  Suggested implementation _No response_  Suggested steps _No response_",other-file,"REST POST /supplierinvoices/{id}/payments ability to add partial payment  Feature Request Currently with the API endpoint `POST /supplierinvoices/{id}/payments` you can only add a payment to a supplier invoice with the remain to pay as amount. Request : ability to add a partial payment on supplier invoices API as on the customer invoice API  Use case Supplier invoices are often payed with 2 (or more) partials payments, one payment before the supplier ships the order and one payment after order delivery  Suggested implementation _No response_  Suggested steps _No response_ other-file",no-bug,0.95
29028,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29028,User icon and name is covering the bookmark icon in md-theme, Bug We are using the md-theme. Since the upgrade to 19.0.1 the user icon and name is covering the bookmark-star-icon. So the bookmarks are no more selectable. When selecting the bookmark icon with a mouse click the user data is shown (because it is overlaying the bookmark icon). ![Bild1](https://github.com/Dolibarr/dolibarr/assets/164546990/8e04a801-b001-4dda-86fd-6b28741b6da9)  Dolibarr Version 19.0.1 running on WIN11  Environment PHP 7.3.33  Environment Database mariadb 10.6.5  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_,other-file | other-file | other-file | other-file | other-file | other-file,User icon and name is covering the bookmark icon in md-theme  Bug We are using the md-theme. Since the upgrade to 19.0.1 the user icon and name is covering the bookmark-star-icon. So the bookmarks are no more selectable. When selecting the bookmark icon with a mouse click the user data is shown (because it is overlaying the bookmark icon). ![Bild1](https://github.com/Dolibarr/dolibarr/assets/164546990/8e04a801-b001-4dda-86fd-6b28741b6da9)  Dolibarr Version 19.0.1 running on WIN11  Environment PHP 7.3.33  Environment Database mariadb 10.6.5  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ other-file other-file other-file other-file other-file other-file,no-bug,0.95
23548,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23548,[ Invoice ] Credits can be null," Feature Request As Invoice, credits can be null.  Use case For exemple, in our case. Society create 0 invoice to move stock, sometime it's necessary for stock correction to create a credits 0 to adapt stock mouvement.  Suggested implementation Modify file https://github.com/Dolibarr/dolibarr/blob/a074c89960b506e60aa2f7b33c5c8717342a6bae/htdocs/compta/facture/card.php#L325 remove equals for result `if ($object->total_ht > 0) {`  Suggested steps I will create a PR linked if you think this could be usefull for others.",other-file,"[ Invoice ] Credits can be null  Feature Request As Invoice, credits can be null.  Use case For exemple, in our case. Society create 0 invoice to move stock, sometime it's necessary for stock correction to create a credits 0 to adapt stock mouvement.  Suggested implementation Modify file https://github.com/Dolibarr/dolibarr/blob/a074c89960b506e60aa2f7b33c5c8717342a6bae/htdocs/compta/facture/card.php#L325 remove equals for result `if ($object->total_ht > 0) {`  Suggested steps I will create a PR linked if you think this could be usefull for others. other-file",no-bug,0.9
24908,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24908,White screen when pressing preview of supplier payment pdf," Bug This occurs only in php 8.0 and 8.1. In php 7.4 it works as expected and preview pdf is generated  Environment Version 17.0.2  Environment OS Debian 5.10.178-3 (2023-04-22) x86_64  Environment Web server Apache  Environment PHP php 8.0, php 8.1  Environment Database MySQL or MariaDB 5.5.5-10.5.19  Environment URL(s) admin/supplier_payment.php?action=specimen&module=standard  Expected and actual behavior _No response_  Steps to reproduce the behavior See attached screenshot  Attached files ![v](https://github.com/Dolibarr/dolibarr/assets/93765174/de5da2d2-12df-46ed-abc2-3e4170d65c53)",other-file | other-file,"White screen when pressing preview of supplier payment pdf  Bug This occurs only in php 8.0 and 8.1. In php 7.4 it works as expected and preview pdf is generated  Environment Version 17.0.2  Environment OS Debian 5.10.178-3 (2023-04-22) x86_64  Environment Web server Apache  Environment PHP php 8.0, php 8.1  Environment Database MySQL or MariaDB 5.5.5-10.5.19  Environment URL(s) admin/supplier_payment.php?action=specimen&module=standard  Expected and actual behavior _No response_  Steps to reproduce the behavior See attached screenshot  Attached files ![v](https://github.com/Dolibarr/dolibarr/assets/93765174/de5da2d2-12df-46ed-abc2-3e4170d65c53) other-file other-file",no-bug,0.9
29624,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29624,Substitution KEY __DATE_DELIVERY__ return null," Bug Hello, you need to change the line 8265 in htdocs/core/lib/functions.lib.php Change $substitutionarray['__DATE_DELIVERY__'] = (isset($object->date_delivery) ? dol_print_date($object->date_delivery, 'day', 0, $outputlangs) : ''); To $substitutionarray['__DATE_DELIVERY__'] = (isset($object->delivery_date) ? dol_print_date($object->date_delivery, 'day', 0, $outputlangs) : ''); And all the times date_delivery is used in PROPAL,. Thanks.  Dolibarr Version 19.0.1  Environment PHP All  Environment Database Mysql  Steps to reproduce the behavior and expected behavior Try to used the KEY __DATE_DELIVERY__ in email templates. It return all the time nothing.  Attached files _No response_",other-file | other-file,"Substitution KEY __DATE_DELIVERY__ return null  Bug Hello, you need to change the line 8265 in htdocs/core/lib/functions.lib.php Change $substitutionarray['__DATE_DELIVERY__'] = (isset($object->date_delivery) ? dol_print_date($object->date_delivery, 'day', 0, $outputlangs) : ''); To $substitutionarray['__DATE_DELIVERY__'] = (isset($object->delivery_date) ? dol_print_date($object->date_delivery, 'day', 0, $outputlangs) : ''); And all the times date_delivery is used in PROPAL,. Thanks.  Dolibarr Version 19.0.1  Environment PHP All  Environment Database Mysql  Steps to reproduce the behavior and expected behavior Try to used the KEY __DATE_DELIVERY__ in email templates. It return all the time nothing.  Attached files _No response_ other-file other-file",no-bug,0.9
24489,dolibarr,https://github.com/Dolibarr/dolibarr/issues/24489,Extrafields of BOM lines are shown additionally on top of list," Bug Extrafields of BOM lines are not only shown for each line, but additionally on top of all BOM lines: <img width=""189"" alt=""image"" src=""https://user-images.githubusercontent.com/10772984/231450816-8aed7804-3e97-45f9-86f0-2424433bbd0a.png"">  Environment Version 17",other-file | other-file | other-file | config-file | other-file | other-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | other-file | other-file | database-file | other-file | other-file | config-file | config-file | other-file | other-file | config-file | other-file | config-file | other-file | other-file | documentation-file | documentation-file | config-file | config-file | other-file | documentation-file | other-file | documentation-file | other-file | config-file | other-file | documentation-file | config-file | database-file | database-file | config-file | config-file | config-file | config-file | other-file | other-file | documentation-file | documentation-file | other-file | config-file | config-file | config-file | config-file | config-file | config-file | other-file | test-file | test-file | test-file | test-file | test-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Extrafields of BOM lines are shown additionally on top of list  Bug Extrafields of BOM lines are not only shown for each line, but additionally on top of all BOM lines: <img width=""189"" alt=""image"" src=""https://user-images.githubusercontent.com/10772984/231450816-8aed7804-3e97-45f9-86f0-2424433bbd0a.png"">  Environment Version 17 other-file other-file other-file config-file other-file other-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file other-file other-file database-file other-file other-file config-file config-file other-file other-file config-file other-file config-file other-file other-file documentation-file documentation-file config-file config-file other-file documentation-file other-file documentation-file other-file config-file other-file documentation-file config-file database-file database-file config-file config-file config-file config-file other-file other-file documentation-file documentation-file other-file config-file config-file config-file config-file config-file config-file other-file test-file test-file test-file test-file test-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.9
26000,dolibarr,https://github.com/Dolibarr/dolibarr/issues/26000,Gnrer intervention," Bug Dans les temps consomm sur un projet, quand on veux gnrer une intervention il y a une erreure: PHP Fatal error: Uncaught TypeError: date(): Argument #2 ($timestamp) must be of type ?int, string given projet/tasks/time.php:842  Environment Version 18.0.0 & 18.0.1  Environment OS Ubuntu server 22.04  Environment Web server _No response_  Environment PHP 8.1  Environment Database mysql  Environment URL(s) /projet/tasks/time.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_",other-file,"Gnrer intervention  Bug Dans les temps consomm sur un projet, quand on veux gnrer une intervention il y a une erreure: PHP Fatal error: Uncaught TypeError: date(): Argument #2 ($timestamp) must be of type ?int, string given projet/tasks/time.php:842  Environment Version 18.0.0 & 18.0.1  Environment OS Ubuntu server 22.04  Environment Web server _No response_  Environment PHP 8.1  Environment Database mysql  Environment URL(s) /projet/tasks/time.php  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file",no-bug,0.9
23466,dolibarr,https://github.com/Dolibarr/dolibarr/issues/23466,Payement pages uses the wrong conf variable for email adress sender," Bug The pages /public/paymentok.php and /public/paymentko.php uses the configuration variable `$conf->global->MAILING_EMAIL_FROM` which is the configuration of the emailing module instead of the global email sender address resulting on mail from dolibarr@domain.com if this module is not configured.  Environment Version 15.0.2  Environment OS Debian 11  Environment Web server Apache/2.4.54 (Debian)  Environment PHP PHP 7.4.30  Environment Database mysql Ver 15.1 Distrib 10.9.3-MariaDB,  Environment URL(s) /public/paymentok.php /public/paymentko.php  Expected and actual behavior The pages /public/paymentok.php and /public/paymentko.php uses the configuration variable `$conf->global->MAILING_EMAIL_FROM` which is the configuration of the emailing module instead of the global email sender address resulting on mail from dolibarr@domain.com if this module is not configured. They should use `$conf->global->MAIN_MAIL_EMAIL_FROM` instead  Steps to reproduce the behavior 1. Change the configuration value for the emailing module 2. Generate an online payment 3. The sender adress is the one from the emailing module not the global variable for the instance  Attached files _No response_",other-file | other-file | other-file | other-file,"Payement pages uses the wrong conf variable for email adress sender  Bug The pages /public/paymentok.php and /public/paymentko.php uses the configuration variable `$conf->global->MAILING_EMAIL_FROM` which is the configuration of the emailing module instead of the global email sender address resulting on mail from dolibarr@domain.com if this module is not configured.  Environment Version 15.0.2  Environment OS Debian 11  Environment Web server Apache/2.4.54 (Debian)  Environment PHP PHP 7.4.30  Environment Database mysql Ver 15.1 Distrib 10.9.3-MariaDB,  Environment URL(s) /public/paymentok.php /public/paymentko.php  Expected and actual behavior The pages /public/paymentok.php and /public/paymentko.php uses the configuration variable `$conf->global->MAILING_EMAIL_FROM` which is the configuration of the emailing module instead of the global email sender address resulting on mail from dolibarr@domain.com if this module is not configured. They should use `$conf->global->MAIN_MAIL_EMAIL_FROM` instead  Steps to reproduce the behavior 1. Change the configuration value for the emailing module 2. Generate an online payment 3. The sender adress is the one from the emailing module not the global variable for the instance  Attached files _No response_ other-file other-file other-file other-file",no-bug,0.9
32158,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32158,PHP Warning when creating a proposal from project, Bug There are sveral PHP warning when creating a proposal from project: Warning: Undefined variable $objectsrc in /Users/gl/Code/GitHub/doli-priv/htdocs/comm/propal/card.php on line 2090  Dolibarr Version 19.0  Environment PHP 8.1  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Create a new project 2. Navigate to project overview 3. Press the + button to create a new proposal  Attached files _No response_,other-file | other-file,PHP Warning when creating a proposal from project  Bug There are sveral PHP warning when creating a proposal from project: Warning: Undefined variable $objectsrc in /Users/gl/Code/GitHub/doli-priv/htdocs/comm/propal/card.php on line 2090  Dolibarr Version 19.0  Environment PHP 8.1  Environment Database n/a  Steps to reproduce the behavior and expected behavior 1. Create a new project 2. Navigate to project overview 3. Press the + button to create a new proposal  Attached files _No response_ other-file other-file,no-bug,0.9
32890,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32890,Emailcollector does not save attachments for tickets, Bug Emailcollector does not save attachments for tickets  Dolibarr Version 20.0  Environment PHP PHP 8.x  Environment Database n/a  Steps to reproduce the behavior and expected behavior Configure module Emailcollector to receive mails and create tickets Send an email with attachment to the configured address Ticket is created without attachment  Attached files _No response_,other-file | other-file,Emailcollector does not save attachments for tickets  Bug Emailcollector does not save attachments for tickets  Dolibarr Version 20.0  Environment PHP PHP 8.x  Environment Database n/a  Steps to reproduce the behavior and expected behavior Configure module Emailcollector to receive mails and create tickets Send an email with attachment to the configured address Ticket is created without attachment  Attached files _No response_ other-file other-file,no-bug,0.8
27256,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27256,BOM show product thumb in header, Feature Request In products when a jpg or png is uploaded this is shown in the card.php has a thumb nail. In the BOM this is not the case. As a BOM is in most cases just a product it would be nice to see a picture: ![product-thumb](https://github.com/Dolibarr/dolibarr/assets/7335299/b260879f-3e49-4ced-939b-b33ac3116d2d) versus ![product-thumb-2](https://github.com/Dolibarr/dolibarr/assets/7335299/a73a37ab-7e52-4ea4-87c6-ff8dd56cad35)  Use case Especially when a lot of sub-boms are used its good to know which part those BOM's is referring to of the total product  Suggested implementation _No response_  Suggested steps _No response_,other-file,BOM show product thumb in header  Feature Request In products when a jpg or png is uploaded this is shown in the card.php has a thumb nail. In the BOM this is not the case. As a BOM is in most cases just a product it would be nice to see a picture: ![product-thumb](https://github.com/Dolibarr/dolibarr/assets/7335299/b260879f-3e49-4ced-939b-b33ac3116d2d) versus ![product-thumb-2](https://github.com/Dolibarr/dolibarr/assets/7335299/a73a37ab-7e52-4ea4-87c6-ff8dd56cad35)  Use case Especially when a lot of sub-boms are used its good to know which part those BOM's is referring to of the total product  Suggested implementation _No response_  Suggested steps _No response_ other-file,no-bug,0.95
29389,dolibarr,https://github.com/Dolibarr/dolibarr/issues/29389,Wrong State Code," Bug Romania Department Code for Bucuresti is wrong in table llx_c_departements (rowid 1182). According to ISO_3166-2:RO (which is used by Romanian gov), the correct code should be ""B"" instead of ""BU"" now. The rest of the code are correct.  Dolibarr Version 13.0.2 and 18.0.4  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_",database-file,"Wrong State Code  Bug Romania Department Code for Bucuresti is wrong in table llx_c_departements (rowid 1182). According to ISO_3166-2:RO (which is used by Romanian gov), the correct code should be ""B"" instead of ""BU"" now. The rest of the code are correct.  Dolibarr Version 13.0.2 and 18.0.4  Environment PHP _No response_  Environment Database _No response_  Steps to reproduce the behavior and expected behavior _No response_  Attached files _No response_ database-file",no-bug,0.9
27224,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27224,E-Mailcollector: Fatal PHP Error with external PHPIMAP Library, Bug File `htdocs/emailcollector/class/emailcollector.class.php` There are 4 lines where `$imapemail` is casted as string `(string) $imapemail` In case of the external IMAP PHP library `$imapemail` is of type `Webklex\PHPIMAP\Message` and cannot be converted to a string  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_,other-file | other-file,E-Mailcollector: Fatal PHP Error with external PHPIMAP Library  Bug File `htdocs/emailcollector/class/emailcollector.class.php` There are 4 lines where `$imapemail` is casted as string `(string) $imapemail` In case of the external IMAP PHP library `$imapemail` is of type `Webklex\PHPIMAP\Message` and cannot be converted to a string  Environment Version 18.0  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior _No response_  Steps to reproduce the behavior _No response_  Attached files _No response_ other-file other-file,no-bug,0.9
32454,dolibarr,https://github.com/Dolibarr/dolibarr/issues/32454,Third party creating vendor from (NEW VENDOR)," Bug When we try to create a vendor from the third party module by clicking (NEW VENDOR) on the left side, the vendor select (Yes No) is not becoming (Yes) by default.  Dolibarr Version 20.0.2  Environment PHP 8.3  Environment Database Mysql  Steps to reproduce the behavior and expected behavior Go to third party module - click on NEW VENDOR on the left side - The vendor select Yes or No should become YES by default just like when creating customer or prospect! ![IMG_6208](https://github.com/user-attachments/assets/fd77e2af-aa14-4e0d-98a9-9cc958217ef4)  Attached files _No response_",other-file,"Third party creating vendor from (NEW VENDOR)  Bug When we try to create a vendor from the third party module by clicking (NEW VENDOR) on the left side, the vendor select (Yes No) is not becoming (Yes) by default.  Dolibarr Version 20.0.2  Environment PHP 8.3  Environment Database Mysql  Steps to reproduce the behavior and expected behavior Go to third party module - click on NEW VENDOR on the left side - The vendor select Yes or No should become YES by default just like when creating customer or prospect! ![IMG_6208](https://github.com/user-attachments/assets/fd77e2af-aa14-4e0d-98a9-9cc958217ef4)  Attached files _No response_ other-file",no-bug,0.9
27034,dolibarr,https://github.com/Dolibarr/dolibarr/issues/27034,Thirdparty email missing in send message form for ticket," Bug Code error in /core/class/html.formticket.class.php @ line 1535 Actual code : if (**is_array**($ticketstat->thirdparty->email) && !in_array($ticketstat->thirdparty->email, $sendto)) { Correct code : if (**!empty**($ticketstat->thirdparty->email) && !in_array($ticketstat->thirdparty->email, $sendto)) {  Environment Version >=18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Should include thirdparty email address  Steps to reproduce the behavior From any ticket issued on thirdparty having an email address : add message and check ""send by mail"" Should send to thirdparty mail by default  Attached files _No response_",other-file | other-file,"Thirdparty email missing in send message form for ticket  Bug Code error in /core/class/html.formticket.class.php @ line 1535 Actual code : if (**is_array**($ticketstat->thirdparty->email) && !in_array($ticketstat->thirdparty->email, $sendto)) { Correct code : if (**!empty**($ticketstat->thirdparty->email) && !in_array($ticketstat->thirdparty->email, $sendto)) {  Environment Version >=18  Environment OS _No response_  Environment Web server _No response_  Environment PHP _No response_  Environment Database _No response_  Environment URL(s) _No response_  Expected and actual behavior Should include thirdparty email address  Steps to reproduce the behavior From any ticket issued on thirdparty having an email address : add message and check ""send by mail"" Should send to thirdparty mail by default  Attached files _No response_ other-file other-file",no-bug,0.8
