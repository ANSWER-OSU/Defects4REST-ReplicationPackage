issue_no,repo,issue_url,title,description,patched_file_types,text_for_topic_modeling,prediction,confidence
11953,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/11953,InvalidOperationException when using responseWrite scripting method,"I'm getting **InvalidOperationException** when using **responseWrite** scripting method.  info: Microsoft.AspNetCore.Hosting.Diagnostics[1] Request starting HTTP/1.1 GET https://localhost:5001/workflows/Invoke?token=CfDJ8Eccv2rzJ8pOsQGIv-oI-6cWwyOvjunMaqTWq_jcEcY0NkLbf5JNyYB2ZbY1fj27bFXUunUUNKXl2FSfHa4zfffO0VytS91u4s7j3ozewqW_M_JPrPST0i4urJCrPTzFKoIvKA95lC1Pl0SashQXbhL_9TaWCOiK6YaNYRwGWkGY8jf8HENyNCOWm3aqD8PCDO2lpbnTr4ky9_GWDQTkMrbxTkqYMVQE41AM-0ez343a - - Microsoft.AspNetCore.Hosting.Diagnostics: Information: Request starting HTTP/1.1 GET https://localhost:5001/workflows/Invoke?token=CfDJ8Eccv2rzJ8pOsQGIv-oI-6cWwyOvjunMaqTWq_jcEcY0NkLbf5JNyYB2ZbY1fj27bFXUunUUNKXl2FSfHa4zfffO0VytS91u4s7j3ozewqW_M_JPrPST0i4urJCrPTzFKoIvKA95lC1Pl0SashQXbhL_9TaWCOiK6YaNYRwGWkGY8jf8HENyNCOWm3aqD8PCDO2lpbnTr4ky9_GWDQTkMrbxTkqYMVQE41AM-0ez343a - - OrchardCore.Modules.ModularTenantRouterMiddleware: Information: Begin Routing Request info: OrchardCore.Modules.ModularTenantRouterMiddleware[0] Begin Routing Request Microsoft.AspNetCore.Routing.EndpointMiddleware: Information: Executing endpoint 'OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows)' info: Microsoft.AspNetCore.Routing.EndpointMiddleware[0] Executing endpoint 'OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows)' Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker: Information: Route matched with {area = ""OrchardCore.Workflows"", action = ""Invoke"", controller = ""HttpWorkflow""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Invoke(System.String) on controller OrchardCore.Workflows.Http.Controllers.HttpWorkflowController (OrchardCore.Workflows). info: Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker[3] Route matched with {area = ""OrchardCore.Workflows"", action = ""Invoke"", controller = ""HttpWorkflow""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Invoke(System.String) on controller OrchardCore.Workflows.Http.Controllers.HttpWorkflowController (OrchardCore.Workflows). OrchardCore.Workflows.Http.Controllers.HttpWorkflowController: Debug: Invoking new workflow of type '4qcvrdnwpnck85v99s6cypg3ws' with start activity '4vpxs6hpwaxc45qzeqzbqh95dh' dbug: OrchardCore.Workflows.Http.Controllers.HttpWorkflowController[0] Invoking new workflow of type '4qcvrdnwpnck85v99s6cypg3ws' with start activity '4vpxs6hpwaxc45qzeqzbqh95dh' Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor: Information: Executing AcceptedResult, writing value of type 'null'. info: Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor[1] Executing AcceptedResult, writing value of type 'null'. Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker: Information: Executed action OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows) in 17.1947ms info: Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker[2] Executed action OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows) in 17.1947ms Microsoft.AspNetCore.Routing.EndpointMiddleware: Information: Executed endpoint 'OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows)' info: Microsoft.AspNetCore.Routing.EndpointMiddleware[1] Executed endpoint 'OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows)' Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware: Error: An unhandled exception has occurred while executing the request. System.InvalidOperationException: StatusCode cannot be set because the response has already started. at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.Microsoft.AspNetCore.Http.Features.IHttpResponseFeature.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Mvc.ObjectResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.AcceptedResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result) at Microsoft.AspNetCore.Mvc.ObjectResult.ExecuteResultAsync(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger) at SixLabors.ImageSharp.Web.Middleware.ImageSharpMiddleware.Invoke(HttpContext httpContext, Boolean retry) at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context) at OrchardCore.Apis.GraphQL.GraphQLMiddleware.Invoke(HttpContext context, IAuthorizationService authorizationService, IAuthenticationService authenticationService, ISchemaFactory schemaService) at OrchardCore.Liquid.ScriptsMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context) at OrchardCore.Diagnostics.DiagnosticsStartupFilter.<>c__DisplayClass3_0.<<Configure>b__1>d.MoveNext()  End of stack trace from previous location  at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context) at OrchardCore.ContentPreview.PreviewStartupFilter.<>c.<<Configure>b__1_1>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Modules.ModularTenantRouterMiddleware.Invoke(HttpContext httpContext) at OrchardCore.Modules.ModularTenantContainerMiddleware.<>c__DisplayClass4_0.<<Invoke>b__0>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Modules.ModularTenantContainerMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) fail: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware[1] An unhandled exception has occurred while executing the request. System.InvalidOperationException: StatusCode cannot be set because the response has already started. at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.Microsoft.AspNetCore.Http.Features.IHttpResponseFeature.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Mvc.ObjectResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.AcceptedResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result) at Microsoft.AspNetCore.Mvc.ObjectResult.ExecuteResultAsync(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger) at SixLabors.ImageSharp.Web.Middleware.ImageSharpMiddleware.Invoke(HttpContext httpContext, Boolean retry) at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context) at OrchardCore.Apis.GraphQL.GraphQLMiddleware.Invoke(HttpContext context, IAuthorizationService authorizationService, IAuthenticationService authenticationService, ISchemaFactory schemaService) at OrchardCore.Liquid.ScriptsMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context) at OrchardCore.Diagnostics.DiagnosticsStartupFilter.<>c__DisplayClass3_0.<<Configure>b__1>d.MoveNext()  End of stack trace from previous location  at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context) at OrchardCore.ContentPreview.PreviewStartupFilter.<>c.<<Configure>b__1_1>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Modules.ModularTenantRouterMiddleware.Invoke(HttpContext httpContext) at OrchardCore.Modules.ModularTenantContainerMiddleware.<>c__DisplayClass4_0.<<Invoke>b__0>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Modules.ModularTenantContainerMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware: Warning: The response has already started, the error page middleware will not be executed. warn: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware[2] The response has already started, the error page middleware will not be executed. fail: Microsoft.AspNetCore.Server.Kestrel[13] Connection id ""0HMITFOP71NAH"", Request id ""0HMITFOP71NAH:00000002"": An unhandled exception was thrown by the application. System.InvalidOperationException: StatusCode cannot be set because the response has already started. at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.Microsoft.AspNetCore.Http.Features.IHttpResponseFeature.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Mvc.ObjectResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.AcceptedResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result) at Microsoft.AspNetCore.Mvc.ObjectResult.ExecuteResultAsync(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger) at SixLabors.ImageSharp.Web.Middleware.ImageSharpMiddleware.Invoke(HttpContext httpContext, Boolean retry) at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context) at OrchardCore.Apis.GraphQL.GraphQLMiddleware.Invoke(HttpContext context, IAuthorizationService authorizationService, IAuthenticationService authenticationService, ISchemaFactory schemaService) at OrchardCore.Liquid.ScriptsMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context) at OrchardCore.Diagnostics.DiagnosticsStartupFilter.<>c__DisplayClass3_0.<<Configure>b__1>d.MoveNext()  End of stack trace from previous location  at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context) at OrchardCore.ContentPreview.PreviewStartupFilter.<>c.<<Configure>b__1_1>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Modules.ModularTenantRouterMiddleware.Invoke(HttpContext httpContext) at OrchardCore.Modules.ModularTenantContainerMiddleware.<>c__DisplayClass4_0.<<Invoke>b__0>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Modules.ModularTenantContainerMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application) Microsoft.AspNetCore.Server.Kestrel: Error: Connection id ""0HMITFOP71NAH"", Request id ""0HMITFOP71NAH:00000002"": An unhandled exception was thrown by the application. System.InvalidOperationException: StatusCode cannot be set because the response has already started. at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.Microsoft.AspNetCore.Http.Features.IHttpResponseFeature.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Mvc.ObjectResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.AcceptedResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result) at Microsoft.AspNetCore.Mvc.ObjectResult.ExecuteResultAsync(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger) at SixLabors.ImageSharp.Web.Middleware.ImageSharpMiddleware.Invoke(HttpContext httpContext, Boolean retry) at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context) at OrchardCore.Apis.GraphQL.GraphQLMiddleware.Invoke(HttpContext context, IAuthorizationService authorizationService, IAuthenticationService authenticationService, ISchemaFactory schemaService) at OrchardCore.Liquid.ScriptsMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context) at OrchardCore.Diagnostics.DiagnosticsStartupFilter.<>c__DisplayClass3_0.<<Configure>b__1>d.MoveNext()  End of stack trace from previous location  at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context) at OrchardCore.ContentPreview.PreviewStartupFilter.<>c.<<Configure>b__1_1>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Modules.ModularTenantRouterMiddleware.Invoke(HttpContext httpContext) at OrchardCore.Modules.ModularTenantContainerMiddleware.<>c__DisplayClass4_0.<<Invoke>b__0>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Modules.ModularTenantContainerMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application) Microsoft.AspNetCore.Hosting.Diagnostics: Information: Request finished HTTP/1.1 GET https://localhost:5001/workflows/Invoke?token=CfDJ8Eccv2rzJ8pOsQGIv-oI-6cWwyOvjunMaqTWq_jcEcY0NkLbf5JNyYB2ZbY1fj27bFXUunUUNKXl2FSfHa4zfffO0VytS91u4s7j3ozewqW_M_JPrPST0i4urJCrPTzFKoIvKA95lC1Pl0SashQXbhL_9TaWCOiK6YaNYRwGWkGY8jf8HENyNCOWm3aqD8PCDO2lpbnTr4ky9_GWDQTkMrbxTkqYMVQE41AM-0ez343a - - - 200 - - 237.3082ms info: Microsoft.AspNetCore.Hosting.Diagnostics[2] Request finished HTTP/1.1 GET https://localhost:5001/workflows/Invoke?token=CfDJ8Eccv2rzJ8pOsQGIv-oI-6cWwyOvjunMaqTWq_jcEcY0NkLbf5JNyYB2ZbY1fj27bFXUunUUNKXl2FSfHa4zfffO0VytS91u4s7j3ozewqW_M_JPrPST0i4urJCrPTzFKoIvKA95lC1Pl0SashQXbhL_9TaWCOiK6YaNYRwGWkGY8jf8HENyNCOWm3aqD8PCDO2lpbnTr4ky9_GWDQTkMrbxTkqYMVQE41AM-0ez343a - - - 200 - - 237.3082ms info: OrchardCore.Modules.ModularBackgroundService[0] Start processing background task 'OrchardCore.Workflows.Timers.TimerBackgroundTask' on tenant 'Default'. OrchardCore.Modules.ModularBackgroundService: Information: Start processing background task 'OrchardCore.Workflows.Timers.TimerBackgroundTask' on tenant 'Default'. info: OrchardCore.Modules.ModularBackgroundService[0] Finished processing background task 'OrchardCore.Workflows.Timers.TimerBackgroundTask' on tenant 'Default'. OrchardCore.Modules.ModularBackgroundService: Information: Finished processing background task 'OrchardCore.Workflows.Timers.TimerBackgroundTask' on tenant 'Default'.  you can try to repro this issue, using simple workflow:  { ""name"": """", ""displayName"": """", ""description"": """", ""author"": """", ""website"": """", ""version"": """", ""issetuprecipe"": false, ""categories"": [], ""tags"": [], ""steps"": [ { ""name"": ""Feature"", ""enable"": [ ""Application.Default"", ""TryOrchardCore.Web"", ""OrchardCore.Settings"", ""OrchardCore.Admin"", ""OrchardCore.Liquid"", ""OrchardCore.Contents"", ""OrchardCore.ContentTypes"", ""OrchardCore.Templates"", ""OrchardCore.Alias"", ""OrchardCore.Autoroute"", ""OrchardCore.Resources"", ""OrchardCore.Features"", ""OrchardCore.Scripting"", ""OrchardCore.Recipes"", ""OrchardCore.Shortcodes"", ""OrchardCore.ContentFields"", ""OrchardCore.Users"", ""OrchardCore.ContentPreview"", ""OrchardCore.Deployment"", ""OrchardCore.CustomSettings"", ""OrchardCore.Deployment.Remote"", ""OrchardCore.Diagnostics"", ""OrchardCore.DynamicCache"", ""OrchardCore.Widgets"", ""OrchardCore.Flows"", ""OrchardCore.HomeRoute"", ""OrchardCore.Html"", ""OrchardCore.Rules"", ""OrchardCore.Layers"", ""OrchardCore.Lists"", ""OrchardCore.Markdown"", ""OrchardCore.Media"", ""OrchardCore.Title"", ""OrchardCore.Menu"", ""OrchardCore.Navigation"", ""OrchardCore.Placements"", ""OrchardCore.Queries"", ""OrchardCore.Roles"", ""OrchardCore.Security"", ""OrchardCore.Shortcodes.Templates"", ""OrchardCore.Themes"", ""OrchardCore.Workflows"", ""OrchardCore.Workflows.Http"", ""SafeMode"", ""TheAdmin"", ""TheAgencyTheme"" ] }, { ""name"": ""WorkflowType"", ""data"": [ { ""WorkflowTypeId"": ""4qcvrdnwpnck85v99s6cypg3ws"", ""Name"": ""responseWriteTest"", ""IsEnabled"": true, ""IsSingleton"": false, ""LockTimeout"": 0, ""LockExpiration"": 0, ""DeleteFinishedWorkflows"": true, ""Activities"": [ { ""ActivityId"": ""4vpxs6hpwaxc45qzeqzbqh95dh"", ""Name"": ""HttpRequestEvent"", ""X"": 0, ""Y"": 0, ""IsStart"": true, ""Properties"": { ""ActivityMetadata"": { ""Title"": null }, ""HttpMethod"": ""GET"", ""Url"": ""/mv33qwd2/workflows/Invoke?token=CfDJ8ERCgEhYWqBJtj7bUEDc0fqUPbpgxfg6fGm5_29QA9X0adxzwJYSBMqpF7lqjVg57ZwZ4YWHONHLTaJxdnsv0Cg07i6xZpqyttyqYbUzYg50oc86WgCB4XlH3MFREe90ITOBeiQEKsfTASx_dlkmCpDY28Y-VQwbMqYmtd7LfNAHUOZk9NUS7B2ptdaJ1ehrnKyljz2DuJRJBGGTCfp37MtTo4BfOFPsOEqz7a2F15MH"", ""ValidateAntiforgeryToken"": false, ""TokenLifeSpan"": 0 } }, { ""ActivityId"": ""407yt6pq132en6n1p71art555v"", ""Name"": ""ScriptTask"", ""X"": 460, ""Y"": 10, ""IsStart"": false, ""Properties"": { ""ActivityMetadata"": { ""Title"": null }, ""AvailableOutcomes"": [ ""Done"" ], ""Script"": { ""Expression"": ""responseWrite(\""<h1>hello world</h1>\"");\r\nsetOutcome('Done');"" } } } ], ""Transitions"": [ { ""Id"": 0, ""SourceActivityId"": ""4vpxs6hpwaxc45qzeqzbqh95dh"", ""SourceOutcomeName"": ""Done"", ""DestinationActivityId"": ""407yt6pq132en6n1p71art555v"" } ] } ] } ] }  (You may need to regenerate HttpRequestEvent url.)",other-file,"InvalidOperationException when using responseWrite scripting method I'm getting **InvalidOperationException** when using **responseWrite** scripting method.  info: Microsoft.AspNetCore.Hosting.Diagnostics[1] Request starting HTTP/1.1 GET https://localhost:5001/workflows/Invoke?token=CfDJ8Eccv2rzJ8pOsQGIv-oI-6cWwyOvjunMaqTWq_jcEcY0NkLbf5JNyYB2ZbY1fj27bFXUunUUNKXl2FSfHa4zfffO0VytS91u4s7j3ozewqW_M_JPrPST0i4urJCrPTzFKoIvKA95lC1Pl0SashQXbhL_9TaWCOiK6YaNYRwGWkGY8jf8HENyNCOWm3aqD8PCDO2lpbnTr4ky9_GWDQTkMrbxTkqYMVQE41AM-0ez343a - - Microsoft.AspNetCore.Hosting.Diagnostics: Information: Request starting HTTP/1.1 GET https://localhost:5001/workflows/Invoke?token=CfDJ8Eccv2rzJ8pOsQGIv-oI-6cWwyOvjunMaqTWq_jcEcY0NkLbf5JNyYB2ZbY1fj27bFXUunUUNKXl2FSfHa4zfffO0VytS91u4s7j3ozewqW_M_JPrPST0i4urJCrPTzFKoIvKA95lC1Pl0SashQXbhL_9TaWCOiK6YaNYRwGWkGY8jf8HENyNCOWm3aqD8PCDO2lpbnTr4ky9_GWDQTkMrbxTkqYMVQE41AM-0ez343a - - OrchardCore.Modules.ModularTenantRouterMiddleware: Information: Begin Routing Request info: OrchardCore.Modules.ModularTenantRouterMiddleware[0] Begin Routing Request Microsoft.AspNetCore.Routing.EndpointMiddleware: Information: Executing endpoint 'OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows)' info: Microsoft.AspNetCore.Routing.EndpointMiddleware[0] Executing endpoint 'OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows)' Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker: Information: Route matched with {area = ""OrchardCore.Workflows"", action = ""Invoke"", controller = ""HttpWorkflow""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Invoke(System.String) on controller OrchardCore.Workflows.Http.Controllers.HttpWorkflowController (OrchardCore.Workflows). info: Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker[3] Route matched with {area = ""OrchardCore.Workflows"", action = ""Invoke"", controller = ""HttpWorkflow""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Invoke(System.String) on controller OrchardCore.Workflows.Http.Controllers.HttpWorkflowController (OrchardCore.Workflows). OrchardCore.Workflows.Http.Controllers.HttpWorkflowController: Debug: Invoking new workflow of type '4qcvrdnwpnck85v99s6cypg3ws' with start activity '4vpxs6hpwaxc45qzeqzbqh95dh' dbug: OrchardCore.Workflows.Http.Controllers.HttpWorkflowController[0] Invoking new workflow of type '4qcvrdnwpnck85v99s6cypg3ws' with start activity '4vpxs6hpwaxc45qzeqzbqh95dh' Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor: Information: Executing AcceptedResult, writing value of type 'null'. info: Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor[1] Executing AcceptedResult, writing value of type 'null'. Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker: Information: Executed action OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows) in 17.1947ms info: Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker[2] Executed action OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows) in 17.1947ms Microsoft.AspNetCore.Routing.EndpointMiddleware: Information: Executed endpoint 'OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows)' info: Microsoft.AspNetCore.Routing.EndpointMiddleware[1] Executed endpoint 'OrchardCore.Workflows.Http.Controllers.HttpWorkflowController.Invoke (OrchardCore.Workflows)' Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware: Error: An unhandled exception has occurred while executing the request. System.InvalidOperationException: StatusCode cannot be set because the response has already started. at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.Microsoft.AspNetCore.Http.Features.IHttpResponseFeature.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Mvc.ObjectResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.AcceptedResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result) at Microsoft.AspNetCore.Mvc.ObjectResult.ExecuteResultAsync(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger) at SixLabors.ImageSharp.Web.Middleware.ImageSharpMiddleware.Invoke(HttpContext httpContext, Boolean retry) at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context) at OrchardCore.Apis.GraphQL.GraphQLMiddleware.Invoke(HttpContext context, IAuthorizationService authorizationService, IAuthenticationService authenticationService, ISchemaFactory schemaService) at OrchardCore.Liquid.ScriptsMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context) at OrchardCore.Diagnostics.DiagnosticsStartupFilter.<>c__DisplayClass3_0.<<Configure>b__1>d.MoveNext()  End of stack trace from previous location  at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context) at OrchardCore.ContentPreview.PreviewStartupFilter.<>c.<<Configure>b__1_1>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Modules.ModularTenantRouterMiddleware.Invoke(HttpContext httpContext) at OrchardCore.Modules.ModularTenantContainerMiddleware.<>c__DisplayClass4_0.<<Invoke>b__0>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Modules.ModularTenantContainerMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) fail: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware[1] An unhandled exception has occurred while executing the request. System.InvalidOperationException: StatusCode cannot be set because the response has already started. at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.Microsoft.AspNetCore.Http.Features.IHttpResponseFeature.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Mvc.ObjectResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.AcceptedResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result) at Microsoft.AspNetCore.Mvc.ObjectResult.ExecuteResultAsync(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger) at SixLabors.ImageSharp.Web.Middleware.ImageSharpMiddleware.Invoke(HttpContext httpContext, Boolean retry) at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context) at OrchardCore.Apis.GraphQL.GraphQLMiddleware.Invoke(HttpContext context, IAuthorizationService authorizationService, IAuthenticationService authenticationService, ISchemaFactory schemaService) at OrchardCore.Liquid.ScriptsMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context) at OrchardCore.Diagnostics.DiagnosticsStartupFilter.<>c__DisplayClass3_0.<<Configure>b__1>d.MoveNext()  End of stack trace from previous location  at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context) at OrchardCore.ContentPreview.PreviewStartupFilter.<>c.<<Configure>b__1_1>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Modules.ModularTenantRouterMiddleware.Invoke(HttpContext httpContext) at OrchardCore.Modules.ModularTenantContainerMiddleware.<>c__DisplayClass4_0.<<Invoke>b__0>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Modules.ModularTenantContainerMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware: Warning: The response has already started, the error page middleware will not be executed. warn: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware[2] The response has already started, the error page middleware will not be executed. fail: Microsoft.AspNetCore.Server.Kestrel[13] Connection id ""0HMITFOP71NAH"", Request id ""0HMITFOP71NAH:00000002"": An unhandled exception was thrown by the application. System.InvalidOperationException: StatusCode cannot be set because the response has already started. at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.Microsoft.AspNetCore.Http.Features.IHttpResponseFeature.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Mvc.ObjectResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.AcceptedResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result) at Microsoft.AspNetCore.Mvc.ObjectResult.ExecuteResultAsync(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger) at SixLabors.ImageSharp.Web.Middleware.ImageSharpMiddleware.Invoke(HttpContext httpContext, Boolean retry) at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context) at OrchardCore.Apis.GraphQL.GraphQLMiddleware.Invoke(HttpContext context, IAuthorizationService authorizationService, IAuthenticationService authenticationService, ISchemaFactory schemaService) at OrchardCore.Liquid.ScriptsMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context) at OrchardCore.Diagnostics.DiagnosticsStartupFilter.<>c__DisplayClass3_0.<<Configure>b__1>d.MoveNext()  End of stack trace from previous location  at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context) at OrchardCore.ContentPreview.PreviewStartupFilter.<>c.<<Configure>b__1_1>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Modules.ModularTenantRouterMiddleware.Invoke(HttpContext httpContext) at OrchardCore.Modules.ModularTenantContainerMiddleware.<>c__DisplayClass4_0.<<Invoke>b__0>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Modules.ModularTenantContainerMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application) Microsoft.AspNetCore.Server.Kestrel: Error: Connection id ""0HMITFOP71NAH"", Request id ""0HMITFOP71NAH:00000002"": An unhandled exception was thrown by the application. System.InvalidOperationException: StatusCode cannot be set because the response has already started. at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.Microsoft.AspNetCore.Http.Features.IHttpResponseFeature.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value) at Microsoft.AspNetCore.Mvc.ObjectResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.AcceptedResult.OnFormatting(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsyncCore(ActionContext context, ObjectResult result, Type objectType, Object value) at Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor.ExecuteAsync(ActionContext context, ObjectResult result) at Microsoft.AspNetCore.Mvc.ObjectResult.ExecuteResultAsync(ActionContext context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()  End of stack trace from previous location  at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker) at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger) at SixLabors.ImageSharp.Web.Middleware.ImageSharpMiddleware.Invoke(HttpContext httpContext, Boolean retry) at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context) at OrchardCore.Apis.GraphQL.GraphQLMiddleware.Invoke(HttpContext context, IAuthorizationService authorizationService, IAuthenticationService authenticationService, ISchemaFactory schemaService) at OrchardCore.Liquid.ScriptsMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context) at OrchardCore.Diagnostics.DiagnosticsStartupFilter.<>c__DisplayClass3_0.<<Configure>b__1>d.MoveNext()  End of stack trace from previous location  at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context) at OrchardCore.ContentPreview.PreviewStartupFilter.<>c.<<Configure>b__1_1>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Modules.ModularTenantRouterMiddleware.Invoke(HttpContext httpContext) at OrchardCore.Modules.ModularTenantContainerMiddleware.<>c__DisplayClass4_0.<<Invoke>b__0>d.MoveNext()  End of stack trace from previous location  at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Environment.Shell.Scope.ShellScope.UsingAsync(Func`2 execute, Boolean activateShell) at OrchardCore.Modules.ModularTenantContainerMiddleware.Invoke(HttpContext httpContext) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context) at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application) Microsoft.AspNetCore.Hosting.Diagnostics: Information: Request finished HTTP/1.1 GET https://localhost:5001/workflows/Invoke?token=CfDJ8Eccv2rzJ8pOsQGIv-oI-6cWwyOvjunMaqTWq_jcEcY0NkLbf5JNyYB2ZbY1fj27bFXUunUUNKXl2FSfHa4zfffO0VytS91u4s7j3ozewqW_M_JPrPST0i4urJCrPTzFKoIvKA95lC1Pl0SashQXbhL_9TaWCOiK6YaNYRwGWkGY8jf8HENyNCOWm3aqD8PCDO2lpbnTr4ky9_GWDQTkMrbxTkqYMVQE41AM-0ez343a - - - 200 - - 237.3082ms info: Microsoft.AspNetCore.Hosting.Diagnostics[2] Request finished HTTP/1.1 GET https://localhost:5001/workflows/Invoke?token=CfDJ8Eccv2rzJ8pOsQGIv-oI-6cWwyOvjunMaqTWq_jcEcY0NkLbf5JNyYB2ZbY1fj27bFXUunUUNKXl2FSfHa4zfffO0VytS91u4s7j3ozewqW_M_JPrPST0i4urJCrPTzFKoIvKA95lC1Pl0SashQXbhL_9TaWCOiK6YaNYRwGWkGY8jf8HENyNCOWm3aqD8PCDO2lpbnTr4ky9_GWDQTkMrbxTkqYMVQE41AM-0ez343a - - - 200 - - 237.3082ms info: OrchardCore.Modules.ModularBackgroundService[0] Start processing background task 'OrchardCore.Workflows.Timers.TimerBackgroundTask' on tenant 'Default'. OrchardCore.Modules.ModularBackgroundService: Information: Start processing background task 'OrchardCore.Workflows.Timers.TimerBackgroundTask' on tenant 'Default'. info: OrchardCore.Modules.ModularBackgroundService[0] Finished processing background task 'OrchardCore.Workflows.Timers.TimerBackgroundTask' on tenant 'Default'. OrchardCore.Modules.ModularBackgroundService: Information: Finished processing background task 'OrchardCore.Workflows.Timers.TimerBackgroundTask' on tenant 'Default'.  you can try to repro this issue, using simple workflow:  { ""name"": """", ""displayName"": """", ""description"": """", ""author"": """", ""website"": """", ""version"": """", ""issetuprecipe"": false, ""categories"": [], ""tags"": [], ""steps"": [ { ""name"": ""Feature"", ""enable"": [ ""Application.Default"", ""TryOrchardCore.Web"", ""OrchardCore.Settings"", ""OrchardCore.Admin"", ""OrchardCore.Liquid"", ""OrchardCore.Contents"", ""OrchardCore.ContentTypes"", ""OrchardCore.Templates"", ""OrchardCore.Alias"", ""OrchardCore.Autoroute"", ""OrchardCore.Resources"", ""OrchardCore.Features"", ""OrchardCore.Scripting"", ""OrchardCore.Recipes"", ""OrchardCore.Shortcodes"", ""OrchardCore.ContentFields"", ""OrchardCore.Users"", ""OrchardCore.ContentPreview"", ""OrchardCore.Deployment"", ""OrchardCore.CustomSettings"", ""OrchardCore.Deployment.Remote"", ""OrchardCore.Diagnostics"", ""OrchardCore.DynamicCache"", ""OrchardCore.Widgets"", ""OrchardCore.Flows"", ""OrchardCore.HomeRoute"", ""OrchardCore.Html"", ""OrchardCore.Rules"", ""OrchardCore.Layers"", ""OrchardCore.Lists"", ""OrchardCore.Markdown"", ""OrchardCore.Media"", ""OrchardCore.Title"", ""OrchardCore.Menu"", ""OrchardCore.Navigation"", ""OrchardCore.Placements"", ""OrchardCore.Queries"", ""OrchardCore.Roles"", ""OrchardCore.Security"", ""OrchardCore.Shortcodes.Templates"", ""OrchardCore.Themes"", ""OrchardCore.Workflows"", ""OrchardCore.Workflows.Http"", ""SafeMode"", ""TheAdmin"", ""TheAgencyTheme"" ] }, { ""name"": ""WorkflowType"", ""data"": [ { ""WorkflowTypeId"": ""4qcvrdnwpnck85v99s6cypg3ws"", ""Name"": ""responseWriteTest"", ""IsEnabled"": true, ""IsSingleton"": false, ""LockTimeout"": 0, ""LockExpiration"": 0, ""DeleteFinishedWorkflows"": true, ""Activities"": [ { ""ActivityId"": ""4vpxs6hpwaxc45qzeqzbqh95dh"", ""Name"": ""HttpRequestEvent"", ""X"": 0, ""Y"": 0, ""IsStart"": true, ""Properties"": { ""ActivityMetadata"": { ""Title"": null }, ""HttpMethod"": ""GET"", ""Url"": ""/mv33qwd2/workflows/Invoke?token=CfDJ8ERCgEhYWqBJtj7bUEDc0fqUPbpgxfg6fGm5_29QA9X0adxzwJYSBMqpF7lqjVg57ZwZ4YWHONHLTaJxdnsv0Cg07i6xZpqyttyqYbUzYg50oc86WgCB4XlH3MFREe90ITOBeiQEKsfTASx_dlkmCpDY28Y-VQwbMqYmtd7LfNAHUOZk9NUS7B2ptdaJ1ehrnKyljz2DuJRJBGGTCfp37MtTo4BfOFPsOEqz7a2F15MH"", ""ValidateAntiforgeryToken"": false, ""TokenLifeSpan"": 0 } }, { ""ActivityId"": ""407yt6pq132en6n1p71art555v"", ""Name"": ""ScriptTask"", ""X"": 460, ""Y"": 10, ""IsStart"": false, ""Properties"": { ""ActivityMetadata"": { ""Title"": null }, ""AvailableOutcomes"": [ ""Done"" ], ""Script"": { ""Expression"": ""responseWrite(\""<h1>hello world</h1>\"");\r\nsetOutcome('Done');"" } } } ], ""Transitions"": [ { ""Id"": 0, ""SourceActivityId"": ""4vpxs6hpwaxc45qzeqzbqh95dh"", ""SourceOutcomeName"": ""Done"", ""DestinationActivityId"": ""407yt6pq132en6n1p71art555v"" } ] } ] } ] }  (You may need to regenerate HttpRequestEvent url.) other-file",bug,0.9
16059,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/16059,Support deserializing string to numeric property,"Previously using Newtonsoft, we ere able to deserialize a string from a string to numeric. In other words the following two json worked  {""name"":""One"",""value"":""1"",""Weight"":1}   {""name"":""One"",""value"":""1"",""Weight"":""1""}  when deserializing to  public sealed class CustomListValueOption : ListValueOption { public string Name { get; set; } public string Value { get; set; } public double? Weight { get; set; } }  This no longer works after converting to using System Json Text.",other-file | test-file,"Support deserializing string to numeric property Previously using Newtonsoft, we ere able to deserialize a string from a string to numeric. In other words the following two json worked  {""name"":""One"",""value"":""1"",""Weight"":1}   {""name"":""One"",""value"":""1"",""Weight"":""1""}  when deserializing to  public sealed class CustomListValueOption : ListValueOption { public string Name { get; set; } public string Value { get; set; } public double? Weight { get; set; } }  This no longer works after converting to using System Json Text. other-file test-file",bug,0.9
16434,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/16434,Sitemap import/export does not work," Describe the bug I've found two STJ problems with sitemap import & export. Both are related to polymorphic deserialization so it's the same bug. 1. If you try to export a new site map, the sitemap source will only contain the `Id` property, all other details are lost. It seems like the object is serialized as just `SitemapSource` instead of the derived type `ContentTypesSitemapSource`. See in the repro below. 2. When the site tries to parse a recipe from OC 1.8 containing the `""Sitemaps""` step, it throws the following, even before the recipe is executed. You can find the example error and the JSON that causes it below:  Orchard Core version The latest `main` branch and 2.0.0-preview-18268 Cloudsmith package.  To Reproduce Steps to reproduce the export error: 1. Create a site (example using Blog recipe). 2. Enable the ""Sitemaps"" feature. 3. Go to Admin > Configuration > SEO > Sitemaps. 4. Add a sitemap and a ""Sitemap Content Types"" source (I unchecked ""Index All Content Types"" and picked just Page and BlogPost). 5. Go to Admin > Configuration > Import/Export > Deployment Plans. 6. Create a deployment plan and add the ""All Sitemaps"" step. 7. Execute the deployment and open the resulting JSON. 8. Observe, that the `SitemapSources` is missing all details (expected something similar to the JSON in the logs section instead): json { ""name"": """", ""displayName"": """", ""description"": """", ""author"": """", ""website"": """", ""version"": """", ""issetuprecipe"": false, ""categories"": [], ""tags"": [], ""steps"": [ { ""name"": ""Sitemaps"", ""data"": [ { ""SitemapId"": ""4g45p23q02vgpvm40vznd49t56"", ""Name"": ""Sitemap"", ""Enabled"": true, ""Path"": ""sitemap.xml"", ""SitemapSources"": [ { ""Id"": ""4nqc3qwb76te707aq12qapkh4y"" } ], ""Identifier"": ""4vtsxzdvm15qmxv5fbttrhh054"" } ] } ] }  9. Go to Admin > Configuration > Import/Export > JSON Import 10. Paste the freshly exported site map. 11. Observe the error message **Unexpected error occurred while executing the 'Sitemaps' step.** 12. Observe the error in the log: Unable to import a recipe from JSON input. OrchardCore.Recipes.Models.RecipeExecutionException: Deserialization of types without a parameterless constructor, a singular parameterized constructor, or a parameterized constructor annotated with 'JsonConstructorAttribute' is not supported. Type 'OrchardCore.Sitemaps.Models.SitemapType'. Path: $ | LineNumber: 0 | BytePositionInLine: 1.  Expected behavior If possible, import from OC 1.x recipe should work. If that's not feasible, a note should be added into the release notes breaking changes section. Export should include all  Logs and screenshots If applicable, add log files, browser console logs, and screenshots (or screen recording videos) to help explain your problem. This is example sitemap recipe from OC 1.8 that used to work: json { ""name"": ""Redacted.Sitemaps"", ""displayName"": ""Redacted - Content - Sitemaps Definition"", ""description"": ""Sitemaps for Redacted site."", ""author"": ""Lombiq"", ""version"": ""1.0"", ""categories"": [ ""content"" ], ""tags"": [ ""sitemaps"" ], ""steps"": [ { ""name"": ""Sitemaps"", ""data"": [ { ""$type"": ""OrchardCore.Sitemaps.Models.Sitemap, OrchardCore.Sitemaps.Abstractions"", ""SitemapId"": ""4vbscpv3kgcnz192hnwwggh0d7"", ""Name"": ""Sitemap"", ""Enabled"": true, ""Path"": ""sitemap.xml"", ""SitemapSources"": [ { ""$type"": ""OrchardCore.Sitemaps.Models.ContentTypesSitemapSource, OrchardCore.Sitemaps.Abstractions"", ""IndexAll"": false, ""LimitItems"": false, ""ChangeFrequency"": 0, ""Priority"": 5, ""ContentTypes"": [ { ""ContentTypeName"": ""BlogPost"", ""ChangeFrequency"": 0, ""Priority"": 0 }, { ""ContentTypeName"": ""Page"", ""ChangeFrequency"": 0, ""Priority"": 0 } ], ""Id"": ""45naf8my0kdgd3tsf5vwtf94xq"" } ], ""Identifier"": ""4mg5ntbxrs9c57w8nybtgvyvcf"" } ] } ] }  This is the error log that shows up now:  2024-07-12 16:21:28.3105|test|00-6c4d175cf6fcafcbc633522a4d8c5e63-82c762aa10e7f9c7-00||OrchardCore.Setup.Services.SetupService|ERROR|Unable to import a recipe during setup. OrchardCore.Recipes.Models.RecipeExecutionException: Deserialization of types without a parameterless constructor, a singular parameterized constructor, or a parameterized constructor annotated with 'JsonConstructorAttribute' is not supported. Type 'OrchardCore.Sitemaps.Models.SitemapType'. Path: $ | LineNumber: 0 | BytePositionInLine: 1. > System.NotSupportedException: Deserialization of types without a parameterless constructor, a singular parameterized constructor, or a parameterized constructor annotated with 'JsonConstructorAttribute' is not supported. Type 'OrchardCore.Sitemaps.Models.SitemapType'. Path: $ | LineNumber: 0 | BytePositionInLine: 1. > System.NotSupportedException: Deserialization of types without a parameterless constructor, a singular parameterized constructor, or a parameterized constructor annotated with 'JsonConstructorAttribute' is not supported. Type 'OrchardCore.Sitemaps.Models.SitemapType'.  End of inner exception stack trace  at System.Text.Json.ThrowHelper.ThrowNotSupportedException(ReadStack& state, Utf8JsonReader& reader, NotSupportedException ex) at System.Text.Json.ThrowHelper.ThrowNotSupportedException_DeserializeNoConstructor(Type type, Utf8JsonReader& reader, ReadStack& state) at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value) at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue) at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state) at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.Deserialize(Utf8JsonReader& reader, ReadStack& state) at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount) at System.Text.Json.JsonSerializer.ReadFromNode[TValue](JsonNode node, JsonTypeInfo`1 jsonTypeInfo) at System.Text.Json.JsonSerializer.Deserialize[TValue](JsonNode node, JsonSerializerOptions options) at System.Text.Json.Nodes.JNode.ToObject[T](JsonNode jsonNode, JsonSerializerOptions options) at OrchardCore.Sitemaps.Recipes.SitemapsStep.ExecuteAsync(RecipeExecutionContext context) at OrchardCore.Recipes.Services.RecipeExecutor.<>c__DisplayClass8_0.<<ExecuteStepAsync>b__0>d.MoveNext() ",other-file | other-file | other-file | other-file | other-file | other-file,"Sitemap import/export does not work  Describe the bug I've found two STJ problems with sitemap import & export. Both are related to polymorphic deserialization so it's the same bug. 1. If you try to export a new site map, the sitemap source will only contain the `Id` property, all other details are lost. It seems like the object is serialized as just `SitemapSource` instead of the derived type `ContentTypesSitemapSource`. See in the repro below. 2. When the site tries to parse a recipe from OC 1.8 containing the `""Sitemaps""` step, it throws the following, even before the recipe is executed. You can find the example error and the JSON that causes it below:  Orchard Core version The latest `main` branch and 2.0.0-preview-18268 Cloudsmith package.  To Reproduce Steps to reproduce the export error: 1. Create a site (example using Blog recipe). 2. Enable the ""Sitemaps"" feature. 3. Go to Admin > Configuration > SEO > Sitemaps. 4. Add a sitemap and a ""Sitemap Content Types"" source (I unchecked ""Index All Content Types"" and picked just Page and BlogPost). 5. Go to Admin > Configuration > Import/Export > Deployment Plans. 6. Create a deployment plan and add the ""All Sitemaps"" step. 7. Execute the deployment and open the resulting JSON. 8. Observe, that the `SitemapSources` is missing all details (expected something similar to the JSON in the logs section instead): json { ""name"": """", ""displayName"": """", ""description"": """", ""author"": """", ""website"": """", ""version"": """", ""issetuprecipe"": false, ""categories"": [], ""tags"": [], ""steps"": [ { ""name"": ""Sitemaps"", ""data"": [ { ""SitemapId"": ""4g45p23q02vgpvm40vznd49t56"", ""Name"": ""Sitemap"", ""Enabled"": true, ""Path"": ""sitemap.xml"", ""SitemapSources"": [ { ""Id"": ""4nqc3qwb76te707aq12qapkh4y"" } ], ""Identifier"": ""4vtsxzdvm15qmxv5fbttrhh054"" } ] } ] }  9. Go to Admin > Configuration > Import/Export > JSON Import 10. Paste the freshly exported site map. 11. Observe the error message **Unexpected error occurred while executing the 'Sitemaps' step.** 12. Observe the error in the log: Unable to import a recipe from JSON input. OrchardCore.Recipes.Models.RecipeExecutionException: Deserialization of types without a parameterless constructor, a singular parameterized constructor, or a parameterized constructor annotated with 'JsonConstructorAttribute' is not supported. Type 'OrchardCore.Sitemaps.Models.SitemapType'. Path: $ | LineNumber: 0 | BytePositionInLine: 1.  Expected behavior If possible, import from OC 1.x recipe should work. If that's not feasible, a note should be added into the release notes breaking changes section. Export should include all  Logs and screenshots If applicable, add log files, browser console logs, and screenshots (or screen recording videos) to help explain your problem. This is example sitemap recipe from OC 1.8 that used to work: json { ""name"": ""Redacted.Sitemaps"", ""displayName"": ""Redacted - Content - Sitemaps Definition"", ""description"": ""Sitemaps for Redacted site."", ""author"": ""Lombiq"", ""version"": ""1.0"", ""categories"": [ ""content"" ], ""tags"": [ ""sitemaps"" ], ""steps"": [ { ""name"": ""Sitemaps"", ""data"": [ { ""$type"": ""OrchardCore.Sitemaps.Models.Sitemap, OrchardCore.Sitemaps.Abstractions"", ""SitemapId"": ""4vbscpv3kgcnz192hnwwggh0d7"", ""Name"": ""Sitemap"", ""Enabled"": true, ""Path"": ""sitemap.xml"", ""SitemapSources"": [ { ""$type"": ""OrchardCore.Sitemaps.Models.ContentTypesSitemapSource, OrchardCore.Sitemaps.Abstractions"", ""IndexAll"": false, ""LimitItems"": false, ""ChangeFrequency"": 0, ""Priority"": 5, ""ContentTypes"": [ { ""ContentTypeName"": ""BlogPost"", ""ChangeFrequency"": 0, ""Priority"": 0 }, { ""ContentTypeName"": ""Page"", ""ChangeFrequency"": 0, ""Priority"": 0 } ], ""Id"": ""45naf8my0kdgd3tsf5vwtf94xq"" } ], ""Identifier"": ""4mg5ntbxrs9c57w8nybtgvyvcf"" } ] } ] }  This is the error log that shows up now:  2024-07-12 16:21:28.3105|test|00-6c4d175cf6fcafcbc633522a4d8c5e63-82c762aa10e7f9c7-00||OrchardCore.Setup.Services.SetupService|ERROR|Unable to import a recipe during setup. OrchardCore.Recipes.Models.RecipeExecutionException: Deserialization of types without a parameterless constructor, a singular parameterized constructor, or a parameterized constructor annotated with 'JsonConstructorAttribute' is not supported. Type 'OrchardCore.Sitemaps.Models.SitemapType'. Path: $ | LineNumber: 0 | BytePositionInLine: 1. > System.NotSupportedException: Deserialization of types without a parameterless constructor, a singular parameterized constructor, or a parameterized constructor annotated with 'JsonConstructorAttribute' is not supported. Type 'OrchardCore.Sitemaps.Models.SitemapType'. Path: $ | LineNumber: 0 | BytePositionInLine: 1. > System.NotSupportedException: Deserialization of types without a parameterless constructor, a singular parameterized constructor, or a parameterized constructor annotated with 'JsonConstructorAttribute' is not supported. Type 'OrchardCore.Sitemaps.Models.SitemapType'.  End of inner exception stack trace  at System.Text.Json.ThrowHelper.ThrowNotSupportedException(ReadStack& state, Utf8JsonReader& reader, NotSupportedException ex) at System.Text.Json.ThrowHelper.ThrowNotSupportedException_DeserializeNoConstructor(Type type, Utf8JsonReader& reader, ReadStack& state) at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value) at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue) at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state) at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.Deserialize(Utf8JsonReader& reader, ReadStack& state) at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount) at System.Text.Json.JsonSerializer.ReadFromNode[TValue](JsonNode node, JsonTypeInfo`1 jsonTypeInfo) at System.Text.Json.JsonSerializer.Deserialize[TValue](JsonNode node, JsonSerializerOptions options) at System.Text.Json.Nodes.JNode.ToObject[T](JsonNode jsonNode, JsonSerializerOptions options) at OrchardCore.Sitemaps.Recipes.SitemapsStep.ExecuteAsync(RecipeExecutionContext context) at OrchardCore.Recipes.Services.RecipeExecutor.<>c__DisplayClass8_0.<<ExecuteStepAsync>b__0>d.MoveNext()  other-file other-file other-file other-file other-file other-file",bug,0.95
5694,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/5694,"""Attached"" Media Field No Longer Able to Upload File","I am trying to determine what changed and will add an update here when available. As of right now though (code updated a couple of days ago) a Media Field set up as ""Attached"" will throw an error of  {Field Name}: There was an error handling the files. ",other-file | other-file | other-file | other-file,"""Attached"" Media Field No Longer Able to Upload File I am trying to determine what changed and will add an update here when available. As of right now though (code updated a couple of days ago) a Media Field set up as ""Attached"" will throw an error of  {Field Name}: There was an error handling the files.  other-file other-file other-file other-file",bug,0.8
5533,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/5533,Ajax call to 'api/queries/{name}' fails,"Hello everyone, I'm currently trying to receive query results using an AJAX call: javascript var products = $.ajax({ type: ""POST"", url: ""api/queries/ProductList"", contentType: ""application/json; charset=utf-8"", dataType: ""json"", data: JSON.stringify({ parameters: { from: 0, size: 8 }}), });  but it fails with _""System.InvalidCastException: Null object cannot be converted to a value type.""_ This happens because Task<IActionResult> Query( string name, string parameters) always get parameters equals to null and instantiate an empty Dictionary. LuceneQueryService tries to get the value at the var size = sizeProperty?.Value<int>() ?? 50; line and fails. All the required permissions for Queries are granted. Could someone point me on what I'm doing wrong, please?",other-file | other-file | other-file | config-file | config-file | documentation-file | other-file | other-file | config-file | documentation-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | source-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | test-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | config-file | config-file | test-file | config-file | config-file | config-file | config-file | config-file | source-file | documentation-file | documentation-file | container-file | container-file | other-file | other-file | documentation-file | config-file | documentation-file | documentation-file | other-file | other-file | other-file | other-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Ajax call to 'api/queries/{name}' fails Hello everyone, I'm currently trying to receive query results using an AJAX call: javascript var products = $.ajax({ type: ""POST"", url: ""api/queries/ProductList"", contentType: ""application/json; charset=utf-8"", dataType: ""json"", data: JSON.stringify({ parameters: { from: 0, size: 8 }}), });  but it fails with _""System.InvalidCastException: Null object cannot be converted to a value type.""_ This happens because Task<IActionResult> Query( string name, string parameters) always get parameters equals to null and instantiate an empty Dictionary. LuceneQueryService tries to get the value at the var size = sizeProperty?.Value<int>() ?? 50; line and fails. All the required permissions for Queries are granted. Could someone point me on what I'm doing wrong, please? other-file other-file other-file config-file config-file documentation-file other-file other-file config-file documentation-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file source-file source-file source-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file documentation-file source-file source-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file source-file source-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file test-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file source-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file config-file config-file config-file test-file config-file config-file config-file config-file config-file source-file documentation-file documentation-file container-file container-file other-file other-file documentation-file config-file documentation-file documentation-file other-file other-file other-file other-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file documentation-file source-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file documentation-file source-file source-file source-file source-file source-file source-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file documentation-file source-file source-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file",bug,0.9
8986,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/8986,"TaxonomyField with Tags display, error 400"," Describe the bug Taxonomy field with Tags display placed in ContentPart inside Widget throws error while saving content item.  To Reproduce Steps to reproduce the behavior: 1. Create content part with taxonomy field and tags display 2. Create widget, add content part from step 1 3. Add widget to flow of some content item 4. Try save = throws error 400  Expected behavior Content item should be saved. Also, it works when Standard display is used.",other-file,"TaxonomyField with Tags display, error 400  Describe the bug Taxonomy field with Tags display placed in ContentPart inside Widget throws error while saving content item.  To Reproduce Steps to reproduce the behavior: 1. Create content part with taxonomy field and tags display 2. Create widget, add content part from step 1 3. Add widget to flow of some content item 4. Try save = throws error 400  Expected behavior Content item should be saved. Also, it works when Standard display is used. other-file",bug,0.8
15381,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/15381,"OrchardCore.Contents API: Admin user is not able to GET a content, an error 401 unauthorized is returned, but if I grant all privileges to the ""anonymous"" user role, it works"," Describe the bug According to what discussed [here](https://github.com/OrchardCMS/OrchardCore/discussions/15372#discussioncomment-8544179) with @hishamco, I'm opening this issue to verify it. The module `OrchardCore.Contents` exposes an `ApiController.cs` with endpoints to _create_, _update_, and _delete_ content items created in the ""Admin"" backoffice. Using _Postman_, it's possible to call the `ApiController.cs` endpoints after configuring the ""OpenID Connect"" `OpenID Authorization Server` module. I tested this using the ""Try Orchard"" website. **The authentication** process **is successful**, and I receive a valid OAuth 2 token. **But, when attempting to use the ""Admin"" user**, which is supposed to have the highest privileges, **I cannot perform GET, UPDATE, or DELETE operations**, I receive a 401 unauthorized error. **Instead, if I grant all privileges to the ""anonymous"" user role** to call the API, and remove the OAuth token, **it works**.  To Reproduce Steps to reproduce the behavior: NOTE: _As mentioned, I'm using a temporary ""try.orchardcore"" website, which is why I'm sharing the credentials here. They will expire along with the temporary website._ 1. Import the Postman collection attached [Test.postman_collection.zip](https://github.com/OrchardCMS/OrchardCore/files/14362999/Test.postman_collection.zip) (it already contains the Client Id and Secret); 2. Get an authorization token via Postman ""Authorization"" blade (all the fields should be already set) 3. Try to call this endpoint using GET method: https://try.orchardcore.net/jgjn0h2r/api/content/455vmd500wgrj7nqqpysw3px4s 4. You will get error 401 Unauthorized  Expected behavior The ""Admin"" user**, which is supposed to have the highest privileges, must be able to retrieve a content from the GET endpoint.  Screenshots Postman Authorization blade configuration ![image](https://github.com/OrchardCMS/OrchardCore/assets/19241483/26058490-0add-404f-8481-b2c4a0f35871)",other-file,"OrchardCore.Contents API: Admin user is not able to GET a content, an error 401 unauthorized is returned, but if I grant all privileges to the ""anonymous"" user role, it works  Describe the bug According to what discussed [here](https://github.com/OrchardCMS/OrchardCore/discussions/15372#discussioncomment-8544179) with @hishamco, I'm opening this issue to verify it. The module `OrchardCore.Contents` exposes an `ApiController.cs` with endpoints to _create_, _update_, and _delete_ content items created in the ""Admin"" backoffice. Using _Postman_, it's possible to call the `ApiController.cs` endpoints after configuring the ""OpenID Connect"" `OpenID Authorization Server` module. I tested this using the ""Try Orchard"" website. **The authentication** process **is successful**, and I receive a valid OAuth 2 token. **But, when attempting to use the ""Admin"" user**, which is supposed to have the highest privileges, **I cannot perform GET, UPDATE, or DELETE operations**, I receive a 401 unauthorized error. **Instead, if I grant all privileges to the ""anonymous"" user role** to call the API, and remove the OAuth token, **it works**.  To Reproduce Steps to reproduce the behavior: NOTE: _As mentioned, I'm using a temporary ""try.orchardcore"" website, which is why I'm sharing the credentials here. They will expire along with the temporary website._ 1. Import the Postman collection attached [Test.postman_collection.zip](https://github.com/OrchardCMS/OrchardCore/files/14362999/Test.postman_collection.zip) (it already contains the Client Id and Secret); 2. Get an authorization token via Postman ""Authorization"" blade (all the fields should be already set) 3. Try to call this endpoint using GET method: https://try.orchardcore.net/jgjn0h2r/api/content/455vmd500wgrj7nqqpysw3px4s 4. You will get error 401 Unauthorized  Expected behavior The ""Admin"" user**, which is supposed to have the highest privileges, must be able to retrieve a content from the GET endpoint.  Screenshots Postman Authorization blade configuration ![image](https://github.com/OrchardCMS/OrchardCore/assets/19241483/26058490-0add-404f-8481-b2c4a0f35871) other-file",bug,0.95
6364,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/6364,OpenId Deployment and Recipes have some issues,"There are a number of issues with the OpenId Recipe and Deployment Steps - The Deployment Step for the Server Settings produces **completely incorrect** JSON to match what the Recipe Step is expecting (the settings directly, when the step expects a Model) - Some of the Steps use Models, some use `CreateViewModels` - Most of the Steps are storing their data directly in the step property, where they should be keyed. (Minor issue) - The Application Step can only be run once, as it does not check to see if the application already exists, so throws an exception the second time.",other-file | test-file | test-file,"OpenId Deployment and Recipes have some issues There are a number of issues with the OpenId Recipe and Deployment Steps - The Deployment Step for the Server Settings produces **completely incorrect** JSON to match what the Recipe Step is expecting (the settings directly, when the step expects a Model) - Some of the Steps use Models, some use `CreateViewModels` - Most of the Steps are storing their data directly in the step property, where they should be keyed. (Minor issue) - The Application Step can only be run once, as it does not check to see if the application already exists, so throws an exception the second time. other-file test-file test-file",bug,0.85
9508,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/9508,Workflow : Recaptcha with application/json header Content-Type fails.,"Here is the issue I get when using application/json with the reCaptcha : ![MicrosoftTeams-image](https://user-images.githubusercontent.com/3228637/119055846-b4d52580-b997-11eb-9843-797c418c42a3.png) So basically I'm trying to validate the recaptcha with it's data-callback method to get it's validation token. Send it to the Workflow as g-recaptcha-response form value so that it passes. As soon as I add the reCaptcha task to the Workflow it faults with an error message saying : ""Incorrect Content Type : application/json""",other-file | other-file | other-file | other-file | other-file | other-file,"Workflow : Recaptcha with application/json header Content-Type fails. Here is the issue I get when using application/json with the reCaptcha : ![MicrosoftTeams-image](https://user-images.githubusercontent.com/3228637/119055846-b4d52580-b997-11eb-9843-797c418c42a3.png) So basically I'm trying to validate the recaptcha with it's data-callback method to get it's validation token. Send it to the Workflow as g-recaptcha-response form value so that it passes. As soon as I add the reCaptcha task to the Workflow it faults with an error message saying : ""Incorrect Content Type : application/json"" other-file other-file other-file other-file other-file other-file",bug,0.85
9362,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/9362,OpenId don't handles inherited (ImpliedBy) permissions,"Testing Application access with OpenId module with Client Credentials flow, it appears that ImpliedBy permission are not honored.  To Reproduce 1. Create a tenant with at least one content 2. Enable ""OpenID Authorization Server"" & ""OpenID Token Validation"" 3. Create a role for your app and check ""Access content via the api"" & ""Publish or unpublish content for others"" (note the ""Edit content for others"" is implied) 4. Enable ""Allow Client Credentials Flow"" in OpenID Connect 5. Add an Application in OpenID Connect with ""Allow Client Credentials Flow"" and check the role you created at step 3 6. Retrieve a token and a content item using the Contents API controller 7. Try to update the content using the Contents API controller You will receive a 403Forbidden  Expected behavior It should be allowed",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"OpenId don't handles inherited (ImpliedBy) permissions Testing Application access with OpenId module with Client Credentials flow, it appears that ImpliedBy permission are not honored.  To Reproduce 1. Create a tenant with at least one content 2. Enable ""OpenID Authorization Server"" & ""OpenID Token Validation"" 3. Create a role for your app and check ""Access content via the api"" & ""Publish or unpublish content for others"" (note the ""Edit content for others"" is implied) 4. Enable ""Allow Client Credentials Flow"" in OpenID Connect 5. Add an Application in OpenID Connect with ""Allow Client Credentials Flow"" and check the role you created at step 3 6. Retrieve a token and a content item using the Contents API controller 7. Try to update the content using the Contents API controller You will receive a 403Forbidden  Expected behavior It should be allowed other-file other-file other-file other-file other-file other-file other-file other-file",bug,0.9
6520,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/6520,Lucene Query Api the the endpoints work with get only i can't get to work with post requests,"what type of body do we use when querying the endpoint because i tried most and nothing work with post here is the get request :  https://localhost:5001/api/lucene/content?query={ ""query"": { ""bool"": { ""must"" :[ {""term"": { ""Content.ContentItem.ContentType"": ""Meal"" }}, { ""term"": { ""Meal.AdType"": ""{{type}}"" }}, ] } }, ""sort"": { ""Content.ContentItem.CreatedUtc"": { ""order"": ""desc"", ""type"": ""double"" } }, ""size"": 3 }&indexName=Meal&parameters={""type"": ""Rent"" }  This works fine in postman but when i try it using post items null I also noticed the endpoints result is not consistent the content return the items with count and the document doesn't",other-file,"Lucene Query Api the the endpoints work with get only i can't get to work with post requests what type of body do we use when querying the endpoint because i tried most and nothing work with post here is the get request :  https://localhost:5001/api/lucene/content?query={ ""query"": { ""bool"": { ""must"" :[ {""term"": { ""Content.ContentItem.ContentType"": ""Meal"" }}, { ""term"": { ""Meal.AdType"": ""{{type}}"" }}, ] } }, ""sort"": { ""Content.ContentItem.CreatedUtc"": { ""order"": ""desc"", ""type"": ""double"" } }, ""size"": 3 }&indexName=Meal&parameters={""type"": ""Rent"" }  This works fine in postman but when i try it using post items null I also noticed the endpoints result is not consistent the content return the items with count and the document doesn't other-file",bug,0.85
16542,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/16542,CreateContentTask evaluation will not remove illegal characters,"While upgrading to 2.0 i had a workflow with a CreateContentTask activity to create a specific content type with following liquid expression :  {% capture full_name %} {{Workflow.Input.User.Properties.UserProfileSettings.UserProfileSettings.FirstName.Text}} {{Workflow.Input.User.Properties.UserProfileSettings.UserProfileSettings.LastName.Text}} {% endcapture %} { ""DisplayText"": ""{{full_name}}"", ""Owner"":""{{Workflow.Input.User.UserId}}"", ""Author"": ""{{Workflow.Input.User.UserName}}"", }  when ContentProperties is evaluated from :  var contentProperties = await _expressionEvaluator.EvaluateAsync(ContentProperties, workflowContext, _javaScriptEncoder);  the json to be merged is returned like this (with carriage return inside the json) :  { ""DisplayText"": "" qqqqqqqqfname qqqqqqqqlname "", }  this results in the following error when merging with content item :  System.Text.Json.JsonReaderException: '0x0D' (CARRIAGE RETURN) is invalid within a JSON string. The string should be correctly escaped.  This was handeled automatically before 2.0 . Is there a way to remove automatically invalid json characters like previous ?",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"CreateContentTask evaluation will not remove illegal characters While upgrading to 2.0 i had a workflow with a CreateContentTask activity to create a specific content type with following liquid expression :  {% capture full_name %} {{Workflow.Input.User.Properties.UserProfileSettings.UserProfileSettings.FirstName.Text}} {{Workflow.Input.User.Properties.UserProfileSettings.UserProfileSettings.LastName.Text}} {% endcapture %} { ""DisplayText"": ""{{full_name}}"", ""Owner"":""{{Workflow.Input.User.UserId}}"", ""Author"": ""{{Workflow.Input.User.UserName}}"", }  when ContentProperties is evaluated from :  var contentProperties = await _expressionEvaluator.EvaluateAsync(ContentProperties, workflowContext, _javaScriptEncoder);  the json to be merged is returned like this (with carriage return inside the json) :  { ""DisplayText"": "" qqqqqqqqfname qqqqqqqqlname "", }  this results in the following error when merging with content item :  System.Text.Json.JsonReaderException: '0x0D' (CARRIAGE RETURN) is invalid within a JSON string. The string should be correctly escaped.  This was handeled automatically before 2.0 . Is there a way to remove automatically invalid json characters like previous ? other-file other-file other-file other-file other-file other-file other-file other-file",bug,0.85
16888,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/16888,Azure email provider can't handle display names in email addresses," Describe the bug The Azure email provider surfaces an exception from `Azure.Communication.Email` when it passes in email addresses that include a display name to the constructor of the `EmailAddress` class in `AzureEmailProviderBase`.  Orchard Core version 2.0  To Reproduce 1. Configure the application to use Azure Email Communication Services and enable the `Orchard.Email.Azure` feature. 2. Use the email test settings screen (`/Admin/Email/Test`) and provide an email address in the `Display Name <email@domain.com>` format in any of the fields that accept an email address.  Expected behavior The provider should deconstruct such email addresses and use the other overload of the `AzureEmailProviderBase` constructor which accepts a separate display name parameter too. `Orchard.Email.Smtp` handles this correctly, because MimeKit takes care of deconstructing such email addresses. The display name for the sender field is simply dropped, because the SDK doesn't support it: https://github.com/Azure/azure-sdk-for-net/issues/43847",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | documentation-file | other-file | config-file | documentation-file | documentation-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | source-file | source-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | documentation-file | documentation-file | documentation-file | other-file | test-file | test-file,"Azure email provider can't handle display names in email addresses  Describe the bug The Azure email provider surfaces an exception from `Azure.Communication.Email` when it passes in email addresses that include a display name to the constructor of the `EmailAddress` class in `AzureEmailProviderBase`.  Orchard Core version 2.0  To Reproduce 1. Configure the application to use Azure Email Communication Services and enable the `Orchard.Email.Azure` feature. 2. Use the email test settings screen (`/Admin/Email/Test`) and provide an email address in the `Display Name <email@domain.com>` format in any of the fields that accept an email address.  Expected behavior The provider should deconstruct such email addresses and use the other overload of the `AzureEmailProviderBase` constructor which accepts a separate display name parameter too. `Orchard.Email.Smtp` handles this correctly, because MimeKit takes care of deconstructing such email addresses. The display name for the sender field is simply dropped, because the SDK doesn't support it: https://github.com/Azure/azure-sdk-for-net/issues/43847 other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file documentation-file documentation-file other-file config-file documentation-file documentation-file other-file other-file other-file other-file other-file documentation-file documentation-file source-file source-file other-file other-file other-file other-file other-file other-file other-file documentation-file source-file source-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file source-file source-file source-file source-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file other-file documentation-file documentation-file documentation-file documentation-file documentation-file other-file test-file test-file",bug,0.9
13671,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/13671,Setting Authority value in OpenId server does not reflect server endpoints in the well-known info," Describe the bug When using OpenId Server feature, one of the available settings is **Authority** or **Issuer**. When providing a specific value, the values the URI's showing for `authorization_endpoint`, `token_endpoint`, `introspection_endpoint`, `end_session_endpoint`, `revocation_endpoint`, `userinfo_endpoint`, and `jwks_uri` will still reflect the current site URL. For example, my OC app is running locally using `https://custom-domain.NET` this domain is accessible only when users on the internal network access my app. However, external apps must use `https://custom-domain.COM` in order to get to the same website. To allow external apps to connect to my app, I set the `Issuer` to `https://custom-domain.com/` which is the domain anyone can use to connect to my server. However, the value for the other endpoints still reflect the `.NET` domain not the `.COM` as I would expect. Here is the output of the `https://custom-domain.com/.well-known/openid-configuration`  { ""issuer"": ""https://custom-domain.com/"", ""authorization_endpoint"": ""https://custom-domain.NET/connect/authorize"", ""token_endpoint"": ""https://custom-domain.NET/connect/token"", ""introspection_endpoint"": ""https://custom-domain.NET/connect/introspect"", ""end_session_endpoint"": ""https://custom-domain.NET/connect/logout"", ""revocation_endpoint"": ""https://custom-domain.NET/connect/revoke"", ""userinfo_endpoint"": ""https://custom-domain.NET/connect/userinfo"", ""jwks_uri"": ""https://custom-domain.NET/.well-known/jwks"", ""grant_types_supported"": [ ""authorization_code"", ""refresh_token"" ], ""response_types_supported"": [ ""code"" ], ""response_modes_supported"": [ ""form_post"", ""fragment"", ""query"" ], ""scopes_supported"": [ ""openid"", ""offline_access"", ""email"", ""phone"", ""profile"", ""roles"" ], ""claims_supported"": [ ""aud"", ""exp"", ""iat"", ""iss"", ""sub"" ], ""id_token_signing_alg_values_supported"": [ ""RS256"" ], ""code_challenge_methods_supported"": [ ""S256"" ], ""subject_types_supported"": [ ""public"" ], ""token_endpoint_auth_methods_supported"": [ ""client_secret_basic"", ""client_secret_post"" ], ""introspection_endpoint_auth_methods_supported"": [ ""client_secret_basic"", ""client_secret_post"" ], ""revocation_endpoint_auth_methods_supported"": [ ""client_secret_basic"", ""client_secret_post"" ], ""claims_parameter_supported"": false, ""request_parameter_supported"": false, ""request_uri_parameter_supported"": false, ""authorization_response_iss_parameter_supported"": true }   Expected behavior I think anytime an `Authority` settings is different than the current host, the value for `authorization_endpoint`, `token_endpoint`, `introspection_endpoint`, `end_session_endpoint`, `revocation_endpoint`, `userinfo_endpoint`, and `jwks_uri` should be based on the Issue not the current site.",other-file,"Setting Authority value in OpenId server does not reflect server endpoints in the well-known info  Describe the bug When using OpenId Server feature, one of the available settings is **Authority** or **Issuer**. When providing a specific value, the values the URI's showing for `authorization_endpoint`, `token_endpoint`, `introspection_endpoint`, `end_session_endpoint`, `revocation_endpoint`, `userinfo_endpoint`, and `jwks_uri` will still reflect the current site URL. For example, my OC app is running locally using `https://custom-domain.NET` this domain is accessible only when users on the internal network access my app. However, external apps must use `https://custom-domain.COM` in order to get to the same website. To allow external apps to connect to my app, I set the `Issuer` to `https://custom-domain.com/` which is the domain anyone can use to connect to my server. However, the value for the other endpoints still reflect the `.NET` domain not the `.COM` as I would expect. Here is the output of the `https://custom-domain.com/.well-known/openid-configuration`  { ""issuer"": ""https://custom-domain.com/"", ""authorization_endpoint"": ""https://custom-domain.NET/connect/authorize"", ""token_endpoint"": ""https://custom-domain.NET/connect/token"", ""introspection_endpoint"": ""https://custom-domain.NET/connect/introspect"", ""end_session_endpoint"": ""https://custom-domain.NET/connect/logout"", ""revocation_endpoint"": ""https://custom-domain.NET/connect/revoke"", ""userinfo_endpoint"": ""https://custom-domain.NET/connect/userinfo"", ""jwks_uri"": ""https://custom-domain.NET/.well-known/jwks"", ""grant_types_supported"": [ ""authorization_code"", ""refresh_token"" ], ""response_types_supported"": [ ""code"" ], ""response_modes_supported"": [ ""form_post"", ""fragment"", ""query"" ], ""scopes_supported"": [ ""openid"", ""offline_access"", ""email"", ""phone"", ""profile"", ""roles"" ], ""claims_supported"": [ ""aud"", ""exp"", ""iat"", ""iss"", ""sub"" ], ""id_token_signing_alg_values_supported"": [ ""RS256"" ], ""code_challenge_methods_supported"": [ ""S256"" ], ""subject_types_supported"": [ ""public"" ], ""token_endpoint_auth_methods_supported"": [ ""client_secret_basic"", ""client_secret_post"" ], ""introspection_endpoint_auth_methods_supported"": [ ""client_secret_basic"", ""client_secret_post"" ], ""revocation_endpoint_auth_methods_supported"": [ ""client_secret_basic"", ""client_secret_post"" ], ""claims_parameter_supported"": false, ""request_parameter_supported"": false, ""request_uri_parameter_supported"": false, ""authorization_response_iss_parameter_supported"": true }   Expected behavior I think anytime an `Authority` settings is different than the current host, the value for `authorization_endpoint`, `token_endpoint`, `introspection_endpoint`, `end_session_endpoint`, `revocation_endpoint`, `userinfo_endpoint`, and `jwks_uri` should be based on the Issue not the current site. other-file",bug,0.95
10190,OrchardCore,https://github.com/OrchardCMS/OrchardCore/issues/10190,Can't get access token via email address as user name," Describe the bug  To Reproduce Get access token via POST https://localhost:44391/connect/token - grant_type - scope - username - password - client_id If I use the user name, It works. However, if I use user email. It doesn't work.  Expected behavior - According to this discussion thread: https://github.com/OrchardCMS/OrchardCore/pull/7645. There is a change to not allow the username = email. However, there should be a fallback to authenticate by username or email. - I expect I can use username or email as to login.  Screenshots ![image](https://user-images.githubusercontent.com/11371581/131404090-dc0ab09c-5269-479f-8dd4-b5fe8b3ffb43.png)",other-file | other-file | other-file | other-file | other-file,"Can't get access token via email address as user name  Describe the bug  To Reproduce Get access token via POST https://localhost:44391/connect/token - grant_type - scope - username - password - client_id If I use the user name, It works. However, if I use user email. It doesn't work.  Expected behavior - According to this discussion thread: https://github.com/OrchardCMS/OrchardCore/pull/7645. There is a change to not allow the username = email. However, there should be a fallback to authenticate by username or email. - I expect I can use username or email as to login.  Screenshots ![image](https://user-images.githubusercontent.com/11371581/131404090-dc0ab09c-5269-479f-8dd4-b5fe8b3ffb43.png) other-file other-file other-file other-file other-file",bug,0.9
