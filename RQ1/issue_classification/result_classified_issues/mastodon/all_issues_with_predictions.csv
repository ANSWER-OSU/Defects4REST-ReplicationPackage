issue_no,repo,issue_url,title,description,patched_file_types,text_for_topic_modeling,prediction,confidence
27622,mastodon,https://github.com/mastodon/mastodon/issues/27622,NoMethodError (undefined method `title' for #<CustomFilter," Steps to reproduce the problem 1. Upgrade to main version at [a918208](https://github.com/mastodon/mastodon/commit/a918208ec61836f911bd9775d2f2dd6db72ac1a5) 2. Run bundle install && rm -rfv public/packs && yarn install --frozen-lockfile && RAILS_ENV=production bundle exec rails assets:precompile 3. Restart services  Expected behaviour Mastodon should work without errors  Actual behaviour Fatal error and ""500"" notification present  Detailed description I noticed it takes time for Explore etc. tabs to populate, but after a while they appear. Got a fatal error couple of times (log below). I haven't seen this before in prior versions, even in 4.3.0-alpha.0. Is it a regression? What causes it? It's related to my muted words in the filter ""War, death and destruction"". There are normal words there, why does it throw that?  Mastodon instance mementomori.social  Mastodon version v4.3.0-alpha.0  Browser name and version Google Chrome 118.0.5993.70 (Official Build) (64-bit)  Operating system Pop!_OS Linux 22.04 LTS  Technical details  Oct 30 18:11:49 mementomori bundle[786873]: F, [2023-10-30T18:11:49.098377 #786873] FATAL -- : [7d20891b-5303-4486-b404-2fddd2aa2882] Oct 30 18:11:49 mementomori bundle[786873]: [7d20891b-5303-4486-b404-2fddd2aa2882] NoMethodError (undefined method `title' for #<CustomFilter id: 93, account_id: 109293050593156468, expires_at: nil, phrase: ""War, death and destruction"", context: [""home"", ""notifications"", ""public"", ""thread"", ""account""], created_at: ""2023-10-19 16:04:59.040990000 +0000"", updated_at: ""2023-10-19 16:08:48.866924000 +0000"", action: ""hide"">): ",source-file | source-file,"NoMethodError (undefined method `title' for #<CustomFilter  Steps to reproduce the problem 1. Upgrade to main version at [a918208](https://github.com/mastodon/mastodon/commit/a918208ec61836f911bd9775d2f2dd6db72ac1a5) 2. Run bundle install && rm -rfv public/packs && yarn install --frozen-lockfile && RAILS_ENV=production bundle exec rails assets:precompile 3. Restart services  Expected behaviour Mastodon should work without errors  Actual behaviour Fatal error and ""500"" notification present  Detailed description I noticed it takes time for Explore etc. tabs to populate, but after a while they appear. Got a fatal error couple of times (log below). I haven't seen this before in prior versions, even in 4.3.0-alpha.0. Is it a regression? What causes it? It's related to my muted words in the filter ""War, death and destruction"". There are normal words there, why does it throw that?  Mastodon instance mementomori.social  Mastodon version v4.3.0-alpha.0  Browser name and version Google Chrome 118.0.5993.70 (Official Build) (64-bit)  Operating system Pop!_OS Linux 22.04 LTS  Technical details  Oct 30 18:11:49 mementomori bundle[786873]: F, [2023-10-30T18:11:49.098377 #786873] FATAL -- : [7d20891b-5303-4486-b404-2fddd2aa2882] Oct 30 18:11:49 mementomori bundle[786873]: [7d20891b-5303-4486-b404-2fddd2aa2882] NoMethodError (undefined method `title' for #<CustomFilter id: 93, account_id: 109293050593156468, expires_at: nil, phrase: ""War, death and destruction"", context: [""home"", ""notifications"", ""public"", ""thread"", ""account""], created_at: ""2023-10-19 16:04:59.040990000 +0000"", updated_at: ""2023-10-19 16:08:48.866924000 +0000"", action: ""hide"">):  source-file source-file",no-bug,0.9
29127,mastodon,https://github.com/mastodon/mastodon/issues/29127,Possible to create domain blocks when a stricter limit already exists in Admin UI," Steps to reproduce the problem 1. Go to `/admin/instances?limited=1` to manage federation 2. Add a domain block for `example` (noop/none severity) 3. Using the API try to create a domain block for `test.example` observe that an error is returned 4. Go back to the admin UI and create a domain block for `test.example` observe that no error is returned and the block is successfully created.  Expected behaviour Both methods for creating domain blocks should have same behaviour  Actual behaviour The API failed whilst the Admin UI succeeded  Detailed description This bug affects IFTAS FediCheck, where we weren't observing the same logic as `DomainBlock.rule_for` when attempting to create a domain block, which meant an existing block of `example` would fail the block creation of `test.example` leaving us out of sync with the Mastodon server (we also weren't handling the error response from the API correctly.  Mastodon instance _No response_  Mastodon version main  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: v 3.2.3 - Node.js version: v20.11.0",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,"Possible to create domain blocks when a stricter limit already exists in Admin UI  Steps to reproduce the problem 1. Go to `/admin/instances?limited=1` to manage federation 2. Add a domain block for `example` (noop/none severity) 3. Using the API try to create a domain block for `test.example` observe that an error is returned 4. Go back to the admin UI and create a domain block for `test.example` observe that no error is returned and the block is successfully created.  Expected behaviour Both methods for creating domain blocks should have same behaviour  Actual behaviour The API failed whilst the Admin UI succeeded  Detailed description This bug affects IFTAS FediCheck, where we weren't observing the same logic as `DomainBlock.rule_for` when attempting to create a domain block, which meant an existing block of `example` would fail the block creation of `test.example` leaving us out of sync with the Mastodon server (we also weren't handling the error response from the API correctly.  Mastodon instance _No response_  Mastodon version main  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: v 3.2.3 - Node.js version: v20.11.0 source-file source-file source-file source-file source-file source-file source-file source-file",bug,0.9
31392,mastodon,https://github.com/mastodon/mastodon/issues/31392,Browser crashes on Windows 11," Steps to reproduce the problem 1. Browse to mastodon.social 2. Log in  Expected behaviour Log in and use Mastodon  Actual behaviour My home page flashed, then I got a crash.  Detailed description ![image](https://github.com/user-attachments/assets/67d2a3d9-3cba-4955-980a-26e9dc4df927) Here's the traceback:  TypeError: n is undefined @https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1357289 @https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:112298 e@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1543509 t.useSyncExternalStoreWithSelector/d</<@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1543714 useSyncExternalStore@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1448121 t.useSyncExternalStore@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1515745 t.useSyncExternalStoreWithSelector@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1543785 n@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:112339 Ee@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1357230 mi@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1441138 jc@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1500107 yl@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1489357 bl@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1489285 ml@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1489146 ol@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1485981 cl@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1486363 Ba@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1427512 rl/<@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1483936 LabelRenderer (webpack:app/javascript/mastodon/features/notifications_v2/components/notification_mention.tsx:43:6) selector.name] (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:123:36) useSyncExternalStoreWithSelector (webpack:node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.production.min.js:11:203) useSyncExternalStoreWithSelector (webpack:node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.production.min.js:11:419) useDeferredValue (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:178:367) useMemo (webpack:node_modules/react/cjs/react.production.min.js:26:308) useSyncExternalStoreWithSelector (webpack:node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.production.min.js:11:490) subscription (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:177:6) LabelRenderer (webpack:app/javascript/mastodon/features/notifications_v2/components/notification_mention.tsx:39:30) Nh (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:160:136) Vk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:289:336) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:391) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:322) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:179) Nk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:270:87) Ck (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:272:299) jg (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:127:104) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:272)   Mastodon instance https://mastodon.social  Mastodon version Mastodon v4.3.0-nightly.2024-08-12  Browser name and version Firefox 129.0 (64-bit). It also crashes on Edge, Chrome and Vivaldi. It's probably not a browser problem!  Operating system Windows 11  Technical details _No response_",other-file | source-file | source-file | other-file | other-file | source-file,"Browser crashes on Windows 11  Steps to reproduce the problem 1. Browse to mastodon.social 2. Log in  Expected behaviour Log in and use Mastodon  Actual behaviour My home page flashed, then I got a crash.  Detailed description ![image](https://github.com/user-attachments/assets/67d2a3d9-3cba-4955-980a-26e9dc4df927) Here's the traceback:  TypeError: n is undefined @https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1357289 @https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:112298 e@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1543509 t.useSyncExternalStoreWithSelector/d</<@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1543714 useSyncExternalStore@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1448121 t.useSyncExternalStore@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1515745 t.useSyncExternalStoreWithSelector@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1543785 n@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:112339 Ee@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1357230 mi@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1441138 jc@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1500107 yl@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1489357 bl@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1489285 ml@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1489146 ol@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1485981 cl@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1486363 Ba@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1427512 rl/<@https://mastodon.social/packs/js/common-81e30f7b38745cf6b34f.js:2:1483936 LabelRenderer (webpack:app/javascript/mastodon/features/notifications_v2/components/notification_mention.tsx:43:6) selector.name] (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:123:36) useSyncExternalStoreWithSelector (webpack:node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.production.min.js:11:203) useSyncExternalStoreWithSelector (webpack:node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.production.min.js:11:419) useDeferredValue (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:178:367) useMemo (webpack:node_modules/react/cjs/react.production.min.js:26:308) useSyncExternalStoreWithSelector (webpack:node_modules/use-sync-external-store/cjs/use-sync-external-store-with-selector.production.min.js:11:490) subscription (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:177:6) LabelRenderer (webpack:app/javascript/mastodon/features/notifications_v2/components/notification_mention.tsx:39:30) Nh (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:160:136) Vk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:289:336) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:391) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:322) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:179) Nk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:270:87) Ck (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:272:299) jg (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:127:104) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:272)   Mastodon instance https://mastodon.social  Mastodon version Mastodon v4.3.0-nightly.2024-08-12  Browser name and version Firefox 129.0 (64-bit). It also crashes on Edge, Chrome and Vivaldi. It's probably not a browser problem!  Operating system Windows 11  Technical details _No response_ other-file source-file source-file other-file other-file source-file",no-bug,0.95
28233,mastodon,https://github.com/mastodon/mastodon/issues/28233,"LinkCrawlWorker throws a NoMethodError `[]` for `nilClass` because Link Oembed json resolves to ""null""","This is mostly a reproducibility report for a certain bug that'll cause `LinkCrawlWorker`s to pile up in the dead queue. Given a status which contains the following link; - https://www.fimfiction.net/oembed\?url\=https%3A%2F%2Fwww.fimfiction.net%2Fblog%2F1027689%2Fasking-for-help It'll eventually crash a `LinkCrawlWorker` with the following error; `NoMethodError: undefined method '[]' for nil:NilClass` Because of the following backtrace; <details> <summary>Backtrace</summary>  live/app/services/fetch_oembed_service.rb:103:in `validate' live/app/services/fetch_oembed_service.rb:88:in `fetch!' live/app/services/fetch_oembed_service.rb:19:in `call' live/app/services/fetch_link_card_service.rb:107:in `attempt_oembed' live/app/services/fetch_link_card_service.rb:42:in `process_url' live/app/services/fetch_link_card_service.rb:28:in `block in call' live/app/models/concerns/lockable.rb:12:in `block (2 levels) in with_redis_lock' live/vendor/bundle/ruby/3.0.0/gems/mario-redis-lock-1.2.1/lib/redis_lock.rb:44:in `acquire' live/app/models/concerns/lockable.rb:10:in `block in with_redis_lock' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:110:in `block (2 levels) in with' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:109:in `handle_interrupt' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:109:in `block in with' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:106:in `handle_interrupt' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:106:in `with' live/app/lib/redis_configuration.rb:10:in `with' live/app/models/concerns/redisable.rb:9:in `with_redis' live/app/models/concerns/lockable.rb:9:in `with_redis_lock' live/app/services/fetch_link_card_service.rb:26:in `call' live/app/workers/link_crawl_worker.rb:9:in `perform'  </details> Because `body` on the following line will become the string `""null""`; https://github.com/mastodon/mastodon/blob/89a8e6e6227eb901b5811d8417d81dc8ab1427a9/app/services/fetch_oembed_service.rb#L84",source-file,"LinkCrawlWorker throws a NoMethodError `[]` for `nilClass` because Link Oembed json resolves to ""null"" This is mostly a reproducibility report for a certain bug that'll cause `LinkCrawlWorker`s to pile up in the dead queue. Given a status which contains the following link; - https://www.fimfiction.net/oembed\?url\=https%3A%2F%2Fwww.fimfiction.net%2Fblog%2F1027689%2Fasking-for-help It'll eventually crash a `LinkCrawlWorker` with the following error; `NoMethodError: undefined method '[]' for nil:NilClass` Because of the following backtrace; <details> <summary>Backtrace</summary>  live/app/services/fetch_oembed_service.rb:103:in `validate' live/app/services/fetch_oembed_service.rb:88:in `fetch!' live/app/services/fetch_oembed_service.rb:19:in `call' live/app/services/fetch_link_card_service.rb:107:in `attempt_oembed' live/app/services/fetch_link_card_service.rb:42:in `process_url' live/app/services/fetch_link_card_service.rb:28:in `block in call' live/app/models/concerns/lockable.rb:12:in `block (2 levels) in with_redis_lock' live/vendor/bundle/ruby/3.0.0/gems/mario-redis-lock-1.2.1/lib/redis_lock.rb:44:in `acquire' live/app/models/concerns/lockable.rb:10:in `block in with_redis_lock' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:110:in `block (2 levels) in with' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:109:in `handle_interrupt' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:109:in `block in with' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:106:in `handle_interrupt' live/vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:106:in `with' live/app/lib/redis_configuration.rb:10:in `with' live/app/models/concerns/redisable.rb:9:in `with_redis' live/app/models/concerns/lockable.rb:9:in `with_redis_lock' live/app/services/fetch_link_card_service.rb:26:in `call' live/app/workers/link_crawl_worker.rb:9:in `perform'  </details> Because `body` on the following line will become the string `""null""`; https://github.com/mastodon/mastodon/blob/89a8e6e6227eb901b5811d8417d81dc8ab1427a9/app/services/fetch_oembed_service.rb#L84 source-file",bug,0.9
29568,mastodon,https://github.com/mastodon/mastodon/issues/29568,Notifications icon has an undefined class.," Steps to reproduce the problem Inspect the Notifications icon in the navigation panel. ![Safari - 2024-03-13 a 12 01@2x](https://github.com/mastodon/mastodon/assets/914451/123be21b-1d58-43a7-9775-56d9015874bf)  Expected behaviour The Notifications icon class should be ""icon-bell""  Actual behaviour The Notifications icon class is ""icon-undefined""  Detailed description The class of the Notifications icon is ""icon-undefined"" instead of ""icon-bell"". This breaks custom theme compatibility.  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-03-13  Browser name and version Safari 17.4  Operating system macOS Sonoma 14.4  Technical details _No response_",other-file | other-file,"Notifications icon has an undefined class.  Steps to reproduce the problem Inspect the Notifications icon in the navigation panel. ![Safari - 2024-03-13 a 12 01@2x](https://github.com/mastodon/mastodon/assets/914451/123be21b-1d58-43a7-9775-56d9015874bf)  Expected behaviour The Notifications icon class should be ""icon-bell""  Actual behaviour The Notifications icon class is ""icon-undefined""  Detailed description The class of the Notifications icon is ""icon-undefined"" instead of ""icon-bell"". This breaks custom theme compatibility.  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-03-13  Browser name and version Safari 17.4  Operating system macOS Sonoma 14.4  Technical details _No response_ other-file other-file",no-bug,0.95
32865,mastodon,https://github.com/mastodon/mastodon/issues/32865,ffmpeg crashes when higher-than-wide GIF is uploaded as pfp," Steps to reproduce the problem 1. Run mastodon in docker/k8s 2. try and upload this (attached) file as a pfp ![Image](https://github.com/user-attachments/assets/87e83c0c-8b84-45a4-bfab-75bf53b6637a) 3. 500 error, with ffmpeg on the backend crashing Also, side note: if I run this gif through a png converter it uploads just fine  Expected behaviour the gif can be uploaded  Actual behaviour user sees a 500  Detailed description logs:  [2024-11-12T14:37:27.314178 #19] ERROR -- : [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] Paperclip::Error (Error while optimizing 92a1c954cb258bcbc1b126bf10cf9be820241112-19-xectsq: Command 'ffmpeg -nostdin -i '/tmp/92a1c954cb258bcbc1b126bf10cf9be820241112-19-xectsq.gif' -map_metadata -1 -fpsmax '60' -frames:v '3000' -filter_complex 'scale=iw:ih:force_original_aspect_ratio=increase,crop=ih:ih,split[a][b];[a]palettegen=max_colors=32[p];[b][p]paletteuse=dither=bayer' -y '/tmp/b4a2fb7a116512b3a1a479cc46cacd1820241112-19-y9clmr.gif'' returned 234. Expected 0 Here is the command output: STDOUT: STDERR: ffmpeg version 7.0.2 Copyright (c) 2000-2024 the FFmpeg developers built with gcc 12 (Debian 12.2.0-14) configuration: --prefix=/usr/local/ffmpeg --toolchain=hardened --disable-debug --disable-devices --disable-doc --disable-ffplay --disable-network --disable-static --enable-ffmpeg --enable-ffprobe --enable-gpl --enable-libdav1d --enable-libmp3lame --enable-libopus --enable-libsnappy --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 --enable-libx265 --enable-shared --enable-version3 libavutil 59. 8.100 / 59. 8.100 libavcodec 61. 3.100 / 61. 3.100 libavformat 61. 1.100 / 61. 1.100 libavdevice 61. 1.100 / 61. 1.100 libavfilter 10. 1.100 / 10. 1.100 libswscale 8. 1.100 / 8. 1.100 libswresample 5. 1.100 / 5. 1.100 libpostproc 58. 1.100 / 58. 1.100 Input #0, gif, from '/tmp/92a1c954cb258bcbc1b126bf10cf9be820241112-19-xectsq.gif': Duration: 00:00:00.10, start: 0.000000, bitrate: 2002 kb/s Stream #0:0: Video: gif, bgra, 228x286, 10 fps, 100 tbr, 100 tbn Stream mapping: Stream #0:0 (gif) -> scale:default paletteuse:default -> Stream #0:0 (gif) [Parsed_crop_1 @ 0x564aa6618100] Invalid too big or non positive size for width '286' or height '286' [Parsed_crop_1 @ 0x564aa6618100] Failed to configure input pad on Parsed_crop_1 [fc#0 @ 0x564aa6618240] Error reinitializing filters! [fc#0 @ 0x564aa6618240] Task finished with error code: -22 (Invalid argument) [vost#0:0/gif @ 0x564aa661ce40] Could not open encoder before EOF [vost#0:0/gif @ 0x564aa661ce40] Task finished with error code: -22 (Invalid argument) [vost#0:0/gif @ 0x564aa661ce40] Terminating thread with return code -22 (Invalid argument) [fc#0 @ 0x564aa6618240] Terminating thread with return code -22 (Invalid argument) [out#0/gif @ 0x564aa661c380] Nothing was written into output file, because at least one of its streams received no packets. frame= 0 fps=0.0 q=0.0 Lsize= 0KiB time=N/A bitrate=N/A speed=N/A Conversion failed! ): [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/vips_lazy_thumbnail.rb:72:in `rescue in make' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/vips_lazy_thumbnail.rb:35:in `make' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/attachment_extensions.rb:21:in `block in post_process_style' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/attachment_extensions.rb:20:in `each' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/attachment_extensions.rb:20:in `inject' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/attachment_extensions.rb:20:in `post_process_style' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] app/services/update_account_service.rb:8:in `call' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] app/controllers/settings/profiles_controller.rb:11:in `update' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] app/controllers/concerns/localized.rb:11:in `set_locale' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/mastodon/rack_middleware.rb:9:in `call' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/public_file_server_middleware.rb:18:in `call'   Mastodon instance masto.nyc  Mastodon version v4.3.1  Technical details Infra: https://github.com/Five-Borough-Fedi-Project/masto.nyc-docean/tree/main",source-file | source-file | source-file | other-file | source-file,"ffmpeg crashes when higher-than-wide GIF is uploaded as pfp  Steps to reproduce the problem 1. Run mastodon in docker/k8s 2. try and upload this (attached) file as a pfp ![Image](https://github.com/user-attachments/assets/87e83c0c-8b84-45a4-bfab-75bf53b6637a) 3. 500 error, with ffmpeg on the backend crashing Also, side note: if I run this gif through a png converter it uploads just fine  Expected behaviour the gif can be uploaded  Actual behaviour user sees a 500  Detailed description logs:  [2024-11-12T14:37:27.314178 #19] ERROR -- : [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] Paperclip::Error (Error while optimizing 92a1c954cb258bcbc1b126bf10cf9be820241112-19-xectsq: Command 'ffmpeg -nostdin -i '/tmp/92a1c954cb258bcbc1b126bf10cf9be820241112-19-xectsq.gif' -map_metadata -1 -fpsmax '60' -frames:v '3000' -filter_complex 'scale=iw:ih:force_original_aspect_ratio=increase,crop=ih:ih,split[a][b];[a]palettegen=max_colors=32[p];[b][p]paletteuse=dither=bayer' -y '/tmp/b4a2fb7a116512b3a1a479cc46cacd1820241112-19-y9clmr.gif'' returned 234. Expected 0 Here is the command output: STDOUT: STDERR: ffmpeg version 7.0.2 Copyright (c) 2000-2024 the FFmpeg developers built with gcc 12 (Debian 12.2.0-14) configuration: --prefix=/usr/local/ffmpeg --toolchain=hardened --disable-debug --disable-devices --disable-doc --disable-ffplay --disable-network --disable-static --enable-ffmpeg --enable-ffprobe --enable-gpl --enable-libdav1d --enable-libmp3lame --enable-libopus --enable-libsnappy --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 --enable-libx265 --enable-shared --enable-version3 libavutil 59. 8.100 / 59. 8.100 libavcodec 61. 3.100 / 61. 3.100 libavformat 61. 1.100 / 61. 1.100 libavdevice 61. 1.100 / 61. 1.100 libavfilter 10. 1.100 / 10. 1.100 libswscale 8. 1.100 / 8. 1.100 libswresample 5. 1.100 / 5. 1.100 libpostproc 58. 1.100 / 58. 1.100 Input #0, gif, from '/tmp/92a1c954cb258bcbc1b126bf10cf9be820241112-19-xectsq.gif': Duration: 00:00:00.10, start: 0.000000, bitrate: 2002 kb/s Stream #0:0: Video: gif, bgra, 228x286, 10 fps, 100 tbr, 100 tbn Stream mapping: Stream #0:0 (gif) -> scale:default paletteuse:default -> Stream #0:0 (gif) [Parsed_crop_1 @ 0x564aa6618100] Invalid too big or non positive size for width '286' or height '286' [Parsed_crop_1 @ 0x564aa6618100] Failed to configure input pad on Parsed_crop_1 [fc#0 @ 0x564aa6618240] Error reinitializing filters! [fc#0 @ 0x564aa6618240] Task finished with error code: -22 (Invalid argument) [vost#0:0/gif @ 0x564aa661ce40] Could not open encoder before EOF [vost#0:0/gif @ 0x564aa661ce40] Task finished with error code: -22 (Invalid argument) [vost#0:0/gif @ 0x564aa661ce40] Terminating thread with return code -22 (Invalid argument) [fc#0 @ 0x564aa6618240] Terminating thread with return code -22 (Invalid argument) [out#0/gif @ 0x564aa661c380] Nothing was written into output file, because at least one of its streams received no packets. frame= 0 fps=0.0 q=0.0 Lsize= 0KiB time=N/A bitrate=N/A speed=N/A Conversion failed! ): [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/vips_lazy_thumbnail.rb:72:in `rescue in make' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/vips_lazy_thumbnail.rb:35:in `make' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/attachment_extensions.rb:21:in `block in post_process_style' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/attachment_extensions.rb:20:in `each' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/attachment_extensions.rb:20:in `inject' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/paperclip/attachment_extensions.rb:20:in `post_process_style' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] app/services/update_account_service.rb:8:in `call' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] app/controllers/settings/profiles_controller.rb:11:in `update' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] app/controllers/concerns/localized.rb:11:in `set_locale' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/mastodon/rack_middleware.rb:9:in `call' [22f707d3-a75a-4b92-86ba-b34dc8fe1c34] lib/public_file_server_middleware.rb:18:in `call'   Mastodon instance masto.nyc  Mastodon version v4.3.1  Technical details Infra: https://github.com/Five-Borough-Fedi-Project/masto.nyc-docean/tree/main source-file source-file source-file other-file source-file",no-bug,0.9
30922,mastodon,https://github.com/mastodon/mastodon/issues/30922,Right-to-left text display in link previews, Steps to reproduce the problem 1. Sending a link in Mastodon that contains Persian or Arabic content. 2. Waiting for the preview to be generated.  Expected behaviour Persian or Arabic texts in link previews should be right-to-left.  Actual behaviour Persian or Arabic texts in link previews are displayed left-to-right.  Detailed description ![Screenshot 2024-07-04 21 30 51](https://github.com/mastodon/mastodon/assets/87318660/cb2c1c5e-9b3d-4707-94cf-be90a5553d8b) https://khiar.net/@drcode/112729514922262834 ![Screenshot 2024-07-04 21 30 19](https://github.com/mastodon/mastodon/assets/87318660/810f3e59-b837-4391-839a-2c467745c809) https://khiar.net/@drcode/112729520487495122  Mastodon instance any instance - khiar.net  Mastodon version v4 and up - v4.2.10  Browser name and version any browser - Google chrome Version 128.0.6558.0 (Official Build) dev (64-bit)  Operating system any os - Google chrome OS Version 128.0.6558.0 (Official Build) dev (64-bit)  Technical details _No response_,other-file | other-file | other-file | other-file,Right-to-left text display in link previews  Steps to reproduce the problem 1. Sending a link in Mastodon that contains Persian or Arabic content. 2. Waiting for the preview to be generated.  Expected behaviour Persian or Arabic texts in link previews should be right-to-left.  Actual behaviour Persian or Arabic texts in link previews are displayed left-to-right.  Detailed description ![Screenshot 2024-07-04 21 30 51](https://github.com/mastodon/mastodon/assets/87318660/cb2c1c5e-9b3d-4707-94cf-be90a5553d8b) https://khiar.net/@drcode/112729514922262834 ![Screenshot 2024-07-04 21 30 19](https://github.com/mastodon/mastodon/assets/87318660/810f3e59-b837-4391-839a-2c467745c809) https://khiar.net/@drcode/112729520487495122  Mastodon instance any instance - khiar.net  Mastodon version v4 and up - v4.2.10  Browser name and version any browser - Google chrome Version 128.0.6558.0 (Official Build) dev (64-bit)  Operating system any os - Google chrome OS Version 128.0.6558.0 (Official Build) dev (64-bit)  Technical details _No response_ other-file other-file other-file other-file,no-bug,0.9
27313,mastodon,https://github.com/mastodon/mastodon/issues/27313,Clicking on a thread post leads to the top of the thread," Steps to reproduce the problem 1. On your timeline, click on a post deep in a thread (or a reply deep enough) 2. See that it loads the thread, scrolled to the reply 3. Press ""back"" 4. Click again on the same post  Expected behaviour I see the post I clicked in the thread  Actual behaviour The thread load, but scrolled to top  Detailed description _No response_  Mastodon instance oisaur.com  Mastodon version v4.2.0  Browser name and version Safari  Operating system macOS  Technical details This probably happens when the thread is already loaded in Redux, and `scrollIntoView` is not called somehow.",other-file,"Clicking on a thread post leads to the top of the thread  Steps to reproduce the problem 1. On your timeline, click on a post deep in a thread (or a reply deep enough) 2. See that it loads the thread, scrolled to the reply 3. Press ""back"" 4. Click again on the same post  Expected behaviour I see the post I clicked in the thread  Actual behaviour The thread load, but scrolled to top  Detailed description _No response_  Mastodon instance oisaur.com  Mastodon version v4.2.0  Browser name and version Safari  Operating system macOS  Technical details This probably happens when the thread is already loaded in Redux, and `scrollIntoView` is not called somehow. other-file",no-bug,0.9
32790,mastodon,https://github.com/mastodon/mastodon/issues/32790,"tootctl error ""uninitialized constant HttpLog"" when trying to use the tool"," Steps to reproduce the problem 1. Try to run some `tootctl` command 2. An error `uninitialized constant HttpLog` appears after a few seconds  Expected behaviour The tootctl command to sucessfully run  Actual behaviour The `uninitialized constant HttpLog` error appears and halts the command  Detailed description Every `tootctl` command I try to run end up like this:  bash $ live/bin/tootctl cache clear /home/mastodon/live/lib/mastodon/cli/progress_helper.rb:8:in `<main>': uninitialized constant HttpLog (NameError) HttpLog.configuration.logger = dev_null  Did you mean? HTTPClient from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `<main>' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `<main>' from live/bin/tootctl:5:in `require_relative' from live/bin/tootctl:5:in `<main>' $ live/bin/tootctl --version /home/mastodon/live/lib/mastodon/cli/progress_helper.rb:8:in `<main>': uninitialized constant HttpLog (NameError) HttpLog.configuration.logger = dev_null  Did you mean? HTTPClient from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `<main>' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `<main>' from live/bin/tootctl:5:in `require_relative' from live/bin/tootctl:5:in `<main>' $ live/bin/tootctl media usage /home/mastodon/live/lib/mastodon/cli/progress_helper.rb:8:in `<main>': uninitialized constant HttpLog (NameError) HttpLog.configuration.logger = dev_null  Did you mean? HTTPClient from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `<main>' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `<main>' from live/bin/tootctl:5:in `require_relative' from live/bin/tootctl:5:in `<main>' $ live/bin/tootctl search deploy --clean /home/mastodon/live/lib/mastodon/cli/progress_helper.rb:8:in `<main>': uninitialized constant HttpLog (NameError) HttpLog.configuration.logger = dev_null  Did you mean? HTTPClient from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `<main>' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `<main>' from live/bin/tootctl:5:in `require_relative' from live/bin/tootctl:5:in `<main>'  When I edit the file `progress_helper.rb` and comment the line 8, the error disappears, and the command runs without a glitch. It didn't happen at least until `v4.4.0-alpha.1-0a1b5df`.  Mastodon instance bolha.one, ursal.zone  Mastodon version v4.4.0-alpha.1-d482211  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: `ruby 3.3.6 (2024-11-05 revision 75015d4c1f) [x86_64-linux]` - Node.js version: `v20.18.0`",source-file | other-file | other-file,"tootctl error ""uninitialized constant HttpLog"" when trying to use the tool  Steps to reproduce the problem 1. Try to run some `tootctl` command 2. An error `uninitialized constant HttpLog` appears after a few seconds  Expected behaviour The tootctl command to sucessfully run  Actual behaviour The `uninitialized constant HttpLog` error appears and halts the command  Detailed description Every `tootctl` command I try to run end up like this:  bash $ live/bin/tootctl cache clear /home/mastodon/live/lib/mastodon/cli/progress_helper.rb:8:in `<main>': uninitialized constant HttpLog (NameError) HttpLog.configuration.logger = dev_null  Did you mean? HTTPClient from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `<main>' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `<main>' from live/bin/tootctl:5:in `require_relative' from live/bin/tootctl:5:in `<main>' $ live/bin/tootctl --version /home/mastodon/live/lib/mastodon/cli/progress_helper.rb:8:in `<main>': uninitialized constant HttpLog (NameError) HttpLog.configuration.logger = dev_null  Did you mean? HTTPClient from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `<main>' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `<main>' from live/bin/tootctl:5:in `require_relative' from live/bin/tootctl:5:in `<main>' $ live/bin/tootctl media usage /home/mastodon/live/lib/mastodon/cli/progress_helper.rb:8:in `<main>': uninitialized constant HttpLog (NameError) HttpLog.configuration.logger = dev_null  Did you mean? HTTPClient from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `<main>' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `<main>' from live/bin/tootctl:5:in `require_relative' from live/bin/tootctl:5:in `<main>' $ live/bin/tootctl search deploy --clean /home/mastodon/live/lib/mastodon/cli/progress_helper.rb:8:in `<main>': uninitialized constant HttpLog (NameError) HttpLog.configuration.logger = dev_null  Did you mean? HTTPClient from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/base.rb:8:in `<main>' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `require_relative' from /home/mastodon/live/lib/mastodon/cli/main.rb:3:in `<main>' from live/bin/tootctl:5:in `require_relative' from live/bin/tootctl:5:in `<main>'  When I edit the file `progress_helper.rb` and comment the line 8, the error disappears, and the command runs without a glitch. It didn't happen at least until `v4.4.0-alpha.1-0a1b5df`.  Mastodon instance bolha.one, ursal.zone  Mastodon version v4.4.0-alpha.1-d482211  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: `ruby 3.3.6 (2024-11-05 revision 75015d4c1f) [x86_64-linux]` - Node.js version: `v20.18.0` source-file other-file other-file",no-bug,0.9
31230,mastodon,https://github.com/mastodon/mastodon/issues/31230,Notifications not generated for mention received from NodeBB," Steps to reproduce the problem 1. [NodeBB] Create a new post and tag a user on a mastodon instance (in this case, it was @julian@bb.devnull.land to @devnull@crag.social) 2. [Mastodon] Navigate to the sender's profile (https://crag.social/@julian@bb.devnull.land) 3. [Mastodon] Note that the post has been correctly received, and contains a mention, but that your notification inbox remains empty  Expected behaviour I should have been notified due to the mention  Actual behaviour I was not notified  Detailed description Additional details here: https://community.nodebb.org/topic/18210/mentions-and-notifications-over-the-fediverse Here is the full Note object containing two mentions, when queried via S2S API:  { ""@context"":""https://www.w3.org/ns/activitystreams"", ""id"":""https://bb.devnull.land/post/72"", ""type"":""Note"", ""to"":[ ""https://www.w3.org/ns/activitystreams#Public"", ""https://bb.devnull.land/uid/1"" ], ""cc"":[ ""https://bb.devnull.land/uid/1/followers"", ""https://crag.social/users/devnull"", ""https://activitypub.academy/users/babeta_zondaist"" ], ""inReplyTo"":""https://bb.devnull.land/post/71"", ""published"":""2024-07-30T02:49:42.616Z"", ""url"":""https://bb.devnull.land/post/72"", ""attributedTo"":""https://bb.devnull.land/uid/1"", ""context"":""https://bb.devnull.land/topic/38"", ""audience"":""https://bb.devnull.land/category/-1"", ""sensitive"":false, ""summary"":null, ""name"":""Re: Testing a notification"", ""content"":""<p>no context or audience <a href=\""https://crag.social/@devnull\"">@devnull@crag.social</a> <a href=\""https://activitypub.academy/@babeta_zondaist\"">@babeta_zondaist@activitypub.academy</a></p> "", ""source"":{ ""content"":""no context or audience @devnull@crag.social @babeta_zondaist@activitypub.academy"", ""mediaType"":""text/markdown"" }, ""tag"":[ { ""type"":""Mention"", ""href"":""https://crag.social/users/devnull"", ""name"":""@devnull@crag.social"" }, { ""type"":""Mention"", ""href"":""https://activitypub.academy/users/babeta_zondaist"", ""name"":""@babeta_zondaist@activitypub.academy"" } ], ""attachment"":[ ], ""replies"":[ ] }   Mastodon instance crag.social, mastodon.social  Mastodon version v4.2.10  Technical details `crag.social` is hosted via masto.host, but @trwnh, who originally notified me of this issue, has an account on `mastodon.social`. I was directed to post an issue here by @renchap",source-file,"Notifications not generated for mention received from NodeBB  Steps to reproduce the problem 1. [NodeBB] Create a new post and tag a user on a mastodon instance (in this case, it was @julian@bb.devnull.land to @devnull@crag.social) 2. [Mastodon] Navigate to the sender's profile (https://crag.social/@julian@bb.devnull.land) 3. [Mastodon] Note that the post has been correctly received, and contains a mention, but that your notification inbox remains empty  Expected behaviour I should have been notified due to the mention  Actual behaviour I was not notified  Detailed description Additional details here: https://community.nodebb.org/topic/18210/mentions-and-notifications-over-the-fediverse Here is the full Note object containing two mentions, when queried via S2S API:  { ""@context"":""https://www.w3.org/ns/activitystreams"", ""id"":""https://bb.devnull.land/post/72"", ""type"":""Note"", ""to"":[ ""https://www.w3.org/ns/activitystreams#Public"", ""https://bb.devnull.land/uid/1"" ], ""cc"":[ ""https://bb.devnull.land/uid/1/followers"", ""https://crag.social/users/devnull"", ""https://activitypub.academy/users/babeta_zondaist"" ], ""inReplyTo"":""https://bb.devnull.land/post/71"", ""published"":""2024-07-30T02:49:42.616Z"", ""url"":""https://bb.devnull.land/post/72"", ""attributedTo"":""https://bb.devnull.land/uid/1"", ""context"":""https://bb.devnull.land/topic/38"", ""audience"":""https://bb.devnull.land/category/-1"", ""sensitive"":false, ""summary"":null, ""name"":""Re: Testing a notification"", ""content"":""<p>no context or audience <a href=\""https://crag.social/@devnull\"">@devnull@crag.social</a> <a href=\""https://activitypub.academy/@babeta_zondaist\"">@babeta_zondaist@activitypub.academy</a></p> "", ""source"":{ ""content"":""no context or audience @devnull@crag.social @babeta_zondaist@activitypub.academy"", ""mediaType"":""text/markdown"" }, ""tag"":[ { ""type"":""Mention"", ""href"":""https://crag.social/users/devnull"", ""name"":""@devnull@crag.social"" }, { ""type"":""Mention"", ""href"":""https://activitypub.academy/users/babeta_zondaist"", ""name"":""@babeta_zondaist@activitypub.academy"" } ], ""attachment"":[ ], ""replies"":[ ] }   Mastodon instance crag.social, mastodon.social  Mastodon version v4.2.10  Technical details `crag.social` is hosted via masto.host, but @trwnh, who originally notified me of this issue, has an account on `mastodon.social`. I was directed to post an issue here by @renchap source-file",no-bug,0.8
32349,mastodon,https://github.com/mastodon/mastodon/issues/32349,Filtered notification does not disappear if user is suspended," Steps to reproduce the problem 1. Get notified by a filtered notification 2. Instance-wide suspend user in question (removing the post)  Expected behaviour Filter notification disappears when user is suspended  Actual behaviour Filtered notification is still there, even if clicking on it returns nothing  Detailed description _No response_  Mastodon instance masto.donte.com.br  Mastodon version v4.3.0+donte  Browser name and version Version 129.0.6668.58 (Official Build, ungoogled-chromium) Arch Linux (64-bit)  Operating system Linux  Technical details _No response_",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,"Filtered notification does not disappear if user is suspended  Steps to reproduce the problem 1. Get notified by a filtered notification 2. Instance-wide suspend user in question (removing the post)  Expected behaviour Filter notification disappears when user is suspended  Actual behaviour Filtered notification is still there, even if clicking on it returns nothing  Detailed description _No response_  Mastodon instance masto.donte.com.br  Mastodon version v4.3.0+donte  Browser name and version Version 129.0.6668.58 (Official Build, ungoogled-chromium) Arch Linux (64-bit)  Operating system Linux  Technical details _No response_ source-file source-file source-file source-file source-file source-file source-file source-file",no-bug,0.8
34275,mastodon,https://github.com/mastodon/mastodon/issues/34275,Cannot disable animations of custom emojis in user name," Steps to reproduce the problem 1. Disable ""Auto-play animated GIFs"" at Preference > Appearance 2. Enable ""Reduce motion in animations"" at Preference > Appearance 3. Visit a post or profile of someone whose name has animated custom emojis + Example: Accessing <https://mystical.garden/@fionafokus/114224269339074787> from the search box (as of 2025-03-26) (contains `:loading:` custom emoji in the user name) 4. You'll see the animated loading animation regardless of the preference.  Expected behaviour web UI shows still image instead of playing animated custom emojis  Actual behaviour animated emojis in the user name are always played  Detailed description Account icons are not auto-played (if some options set?) even when they are animated images. User can play them by mouse hover if they want. This is the expected behaviour of disabled ""auto-play animated GIFs"" (and/or enabled ""Reduce motions in animation"") for images in general, not only for account icons but also for custom emojis in user names. However, this option does not work to the custom emojis in the user name, so currently users cannot disable animations in that position. This is very distracting.  Mastodon instance mastodon.cardina1.red  Mastodon version v4.3.6  Browser name and version Firefox 136.0.2  Operating system Gentoo Linux (amd64, Linux 6.13.8)  Technical details _No response_",source-file,"Cannot disable animations of custom emojis in user name  Steps to reproduce the problem 1. Disable ""Auto-play animated GIFs"" at Preference > Appearance 2. Enable ""Reduce motion in animations"" at Preference > Appearance 3. Visit a post or profile of someone whose name has animated custom emojis + Example: Accessing <https://mystical.garden/@fionafokus/114224269339074787> from the search box (as of 2025-03-26) (contains `:loading:` custom emoji in the user name) 4. You'll see the animated loading animation regardless of the preference.  Expected behaviour web UI shows still image instead of playing animated custom emojis  Actual behaviour animated emojis in the user name are always played  Detailed description Account icons are not auto-played (if some options set?) even when they are animated images. User can play them by mouse hover if they want. This is the expected behaviour of disabled ""auto-play animated GIFs"" (and/or enabled ""Reduce motions in animation"") for images in general, not only for account icons but also for custom emojis in user names. However, this option does not work to the custom emojis in the user name, so currently users cannot disable animations in that position. This is very distracting.  Mastodon instance mastodon.cardina1.red  Mastodon version v4.3.6  Browser name and version Firefox 136.0.2  Operating system Gentoo Linux (amd64, Linux 6.13.8)  Technical details _No response_ source-file",no-bug,0.9
27273,mastodon,https://github.com/mastodon/mastodon/issues/27273,search for posts 'broken' when not logged in (4.2.0)," Steps to reproduce the problem 1. Go to a server running Mastodon 4.2 without logging in (https://mastodon.social/search) 2. Enter a search term. For instance, I used ""Gaetz"" since he's in the news today. 3. View the search results. There will be no posts listed under the ""all"" tab, and the 'posts' tab will provide the misleading message ""Could not find anything for these search terms""   Expected behaviour Either show search results the same as for logged-in users, or clarify the response to say that search is turned off for anonymous users  Actual behaviour ""post"" search results are not shown. Instead shows misleading message ""Could not find anything for these search terms""  Detailed description Note, this is not a problem with search itself. When logged in, I see plenty of search results (mstdn.science). It also is not a problem with displaying posts to anonymous users - the hashtag search works as expected and displays the posts properly (https://mastodon.social/tags/gaetz) If this behavior is intentional, then the website should be clear about why it is not returning any results. The current response could give the wrong impression to someone who is curious about Mastodon and uses the search function to see what sort of activity is on Mastodon (concluding either that there is no activity, or that search is broken). I tested on both mastodon.social (v4.2.1-rc1+pr-27261-dd5f312) and mstdn.sciesce (4.2.0)  Mastodon instance mastodon.social  Mastodon version v4.2.1-rc1+pr-27261-dd5f312  Browser name and version Firefox 118.0.1 (64-bit)  Operating system Windows 11  Technical details _No response_",other-file | other-file | documentation-file | other-file | documentation-file | other-file | documentation-file,"search for posts 'broken' when not logged in (4.2.0)  Steps to reproduce the problem 1. Go to a server running Mastodon 4.2 without logging in (https://mastodon.social/search) 2. Enter a search term. For instance, I used ""Gaetz"" since he's in the news today. 3. View the search results. There will be no posts listed under the ""all"" tab, and the 'posts' tab will provide the misleading message ""Could not find anything for these search terms""   Expected behaviour Either show search results the same as for logged-in users, or clarify the response to say that search is turned off for anonymous users  Actual behaviour ""post"" search results are not shown. Instead shows misleading message ""Could not find anything for these search terms""  Detailed description Note, this is not a problem with search itself. When logged in, I see plenty of search results (mstdn.science). It also is not a problem with displaying posts to anonymous users - the hashtag search works as expected and displays the posts properly (https://mastodon.social/tags/gaetz) If this behavior is intentional, then the website should be clear about why it is not returning any results. The current response could give the wrong impression to someone who is curious about Mastodon and uses the search function to see what sort of activity is on Mastodon (concluding either that there is no activity, or that search is broken). I tested on both mastodon.social (v4.2.1-rc1+pr-27261-dd5f312) and mstdn.sciesce (4.2.0)  Mastodon instance mastodon.social  Mastodon version v4.2.1-rc1+pr-27261-dd5f312  Browser name and version Firefox 118.0.1 (64-bit)  Operating system Windows 11  Technical details _No response_ other-file other-file documentation-file other-file documentation-file other-file documentation-file",no-bug,0.9
27974,mastodon,https://github.com/mastodon/mastodon/issues/27974,Steps descriptions in the welcome page are cut off if the column width isnt enough," Steps to reproduce the problem 1. Optionally switch to a language that has relatively long description lines (I saw Japanese). 2. Go to the Youve made it page (URL path /start). 3. Reduce browser width so the main column is narrow. 4. See the steps description lines (e.g. Boost your interactions by having).  Expected behaviour Description text wraps and takes up two or more lines if the width is not enough.  Actual behaviour The latter part of description lines are ellipsized and there is no way to read the entire text.  Detailed description Ellipsis is OK only when the text is an excerpt of what you will get after a click, but these descriptions are supposed to be read right here, so it doesnt make sense to be cut off. Removing `white-space: nowrap` (and optionally other related rules) from the stylesheet will fix this.  Mastodon instance mofu.kemo.no with the custom CSS disabled  Mastodon version v4.2.1  Browser name and version Google Chrome 116.0.5845.187  Operating system macOS 10.13.6  Technical details _No response_",other-file,"Steps descriptions in the welcome page are cut off if the column width isnt enough  Steps to reproduce the problem 1. Optionally switch to a language that has relatively long description lines (I saw Japanese). 2. Go to the Youve made it page (URL path /start). 3. Reduce browser width so the main column is narrow. 4. See the steps description lines (e.g. Boost your interactions by having).  Expected behaviour Description text wraps and takes up two or more lines if the width is not enough.  Actual behaviour The latter part of description lines are ellipsized and there is no way to read the entire text.  Detailed description Ellipsis is OK only when the text is an excerpt of what you will get after a click, but these descriptions are supposed to be read right here, so it doesnt make sense to be cut off. Removing `white-space: nowrap` (and optionally other related rules) from the stylesheet will fix this.  Mastodon instance mofu.kemo.no with the custom CSS disabled  Mastodon version v4.2.1  Browser name and version Google Chrome 116.0.5845.187  Operating system macOS 10.13.6  Technical details _No response_ other-file",no-bug,0.95
32877,mastodon,https://github.com/mastodon/mastodon/issues/32877,<title> on toots is double quoted," Steps to reproduce the problem 1. Go to https://mastodon.social/@ircv3/113476882448853258  Expected behaviour The HTML should contain `<title>IRCv3: &quot;We missed doing one of these last year, but here&#39;&quot; - Mastodon</title>`  Actual behaviour The HTML contains `<title>IRCv3: &amp;quot;We missed doing one of these last year, but here&amp;#39;&amp;quot; - Mastodon</title>`  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.4.0-nightly.2024-11-13  Technical details _No response_",source-file | source-file | source-file,"<title> on toots is double quoted  Steps to reproduce the problem 1. Go to https://mastodon.social/@ircv3/113476882448853258  Expected behaviour The HTML should contain `<title>IRCv3: &quot;We missed doing one of these last year, but here&#39;&quot; - Mastodon</title>`  Actual behaviour The HTML contains `<title>IRCv3: &amp;quot;We missed doing one of these last year, but here&amp;#39;&amp;quot; - Mastodon</title>`  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.4.0-nightly.2024-11-13  Technical details _No response_ source-file source-file source-file",no-bug,0.9
27362,mastodon,https://github.com/mastodon/mastodon/issues/27362,The onboarding quotas are completely arbitrary," Steps to reproduce the problem (This is about the prompt introduced in #25267) The prompt pops up when the home feed is not going fast enough. Problem is, I'm subscribed to English speakers - geographically mostly American and European. There is a clear lull hour, about 1pm GMT, when Americans are still sleepy and Europeans just don't post much, so the home feed is stalling.  Expected behaviour do not show this text for people who already know how to subscribe  Actual behaviour i see the toast  Detailed description My account is 6 years old, I'm subscribed to 900+ accounts, I'm perfectly fine catching up with the old posts. And every day, about the same time, I see this piece of condescending foolishness. ![1](https://github.com/mastodon/mastodon/assets/308627/79ced1fd-6301-45a2-9d5b-a5996a6bd019)  Mastodon instance icosahedron.website  Mastodon version v4.2.0  Browser name and version Librewolf 118  Operating system Arch Linux  Technical details _No response_",other-file,"The onboarding quotas are completely arbitrary  Steps to reproduce the problem (This is about the prompt introduced in #25267) The prompt pops up when the home feed is not going fast enough. Problem is, I'm subscribed to English speakers - geographically mostly American and European. There is a clear lull hour, about 1pm GMT, when Americans are still sleepy and Europeans just don't post much, so the home feed is stalling.  Expected behaviour do not show this text for people who already know how to subscribe  Actual behaviour i see the toast  Detailed description My account is 6 years old, I'm subscribed to 900+ accounts, I'm perfectly fine catching up with the old posts. And every day, about the same time, I see this piece of condescending foolishness. ![1](https://github.com/mastodon/mastodon/assets/308627/79ced1fd-6301-45a2-9d5b-a5996a6bd019)  Mastodon instance icosahedron.website  Mastodon version v4.2.0  Browser name and version Librewolf 118  Operating system Arch Linux  Technical details _No response_ other-file",no-bug,0.9
32380,mastodon,https://github.com/mastodon/mastodon/issues/32380,Follow recommendations page defaults to first alphabetical language (Afrikaans)," Steps to reproduce the problem 1. Navigate to the ""Follow recommendations"" moderation page  Expected behaviour List is not filtered by Afrikaans  Actual behaviour List is filtered by Afrikaans  Detailed description More sensible default would probably be: no filter selected (as in trending posts), my current user language, or the server default locale.  Mastodon instance sunny.garden  Mastodon version v4.3.0  Browser name and version Firefox 131.0.2  Operating system Microsoft Windows [Version 10.0.19045.4894]  Technical details _No response_",source-file | source-file,"Follow recommendations page defaults to first alphabetical language (Afrikaans)  Steps to reproduce the problem 1. Navigate to the ""Follow recommendations"" moderation page  Expected behaviour List is not filtered by Afrikaans  Actual behaviour List is filtered by Afrikaans  Detailed description More sensible default would probably be: no filter selected (as in trending posts), my current user language, or the server default locale.  Mastodon instance sunny.garden  Mastodon version v4.3.0  Browser name and version Firefox 131.0.2  Operating system Microsoft Windows [Version 10.0.19045.4894]  Technical details _No response_ source-file source-file",no-bug,0.9
29535,mastodon,https://github.com/mastodon/mastodon/issues/29535,hashtags_recent_count needs plural forms," Steps to reproduce the problem I have to translate ""`%{people}` people in the past `%{days}` days"" as ""People in the past `%{days}` day(s): `%{people}`"" to avoid grammar errors, which is really bad UX. c.f. [Issue on Crowdin](https://crowdin.com/editor/mastodon/54/en-gd?view=comfortable#28120).  Expected behaviour Plural form syntax used  Actual behaviour Plural form syntax not used  Detailed description This actually needs splitting into 2 separate strings, because there are 2 plural-controlling placeholders in there. Key: `user_mailer.welcome.hashtags_recent_count root -> user_mailer -> welcome -> hashtags_recent_count` File: [en.yml](https://crowdin.com/editor/mastodon/54/en-gd)  Mastodon instance mastodon.social  Mastodon version v4.3.0.x  Browser name and version Any  Operating system Any  Technical details _No response_",other-file | other-file | config-file,"hashtags_recent_count needs plural forms  Steps to reproduce the problem I have to translate ""`%{people}` people in the past `%{days}` days"" as ""People in the past `%{days}` day(s): `%{people}`"" to avoid grammar errors, which is really bad UX. c.f. [Issue on Crowdin](https://crowdin.com/editor/mastodon/54/en-gd?view=comfortable#28120).  Expected behaviour Plural form syntax used  Actual behaviour Plural form syntax not used  Detailed description This actually needs splitting into 2 separate strings, because there are 2 plural-controlling placeholders in there. Key: `user_mailer.welcome.hashtags_recent_count root -> user_mailer -> welcome -> hashtags_recent_count` File: [en.yml](https://crowdin.com/editor/mastodon/54/en-gd)  Mastodon instance mastodon.social  Mastodon version v4.3.0.x  Browser name and version Any  Operating system Any  Technical details _No response_ other-file other-file config-file",no-bug,0.9
33100,mastodon,https://github.com/mastodon/mastodon/issues/33100,Aggressive new tab opening when scroll-clicking in Mastodon suddenly," Steps to reproduce the problem I have a laptop and a Windows PC with a mouse. When I use the mouse, because of my RSI I scroll by clicking down the middle mouse button to enter <img src=""https://github.com/user-attachments/assets/eec01268-15dc-479a-9443-de25bde7dcdf"" width=24> scroll mode. Unfortunately click with middle mouse also is the verb in a web browser for ""open new link"". I just spent a month (oct 27 - nov 27) traveling during which time I used only my laptop. When I came back I noticed a slight difference in Mastodon's Advanced Interface. I think something changed. Now if I click almost anywhere to scroll, it opens a new mastodon tab. Since scroll is a frequent action, this means as I use Mastodon many clone tabs pile up unless I am very careful to click on the margins of posts. I see this in both Firefox and Chrome so I think the change must have been in Mastodon.  Expected behaviour Scroll  Actual behaviour New Window  Detailed description It might be this is just a byproduct of improvements on the ""click to focus on this post"" hitboxes in Advanced Mode and there is nothing you can do about this, but I haven't seen this behavior before today.  Mastodon instance mastodon.social  Mastodon version v4.4.0-nightly.2024-11-27  Browser name and version Chrome 131.0.6778.86 64bit  Operating system Windows 10  Technical details _No response_",other-file | other-file | other-file | other-file,"Aggressive new tab opening when scroll-clicking in Mastodon suddenly  Steps to reproduce the problem I have a laptop and a Windows PC with a mouse. When I use the mouse, because of my RSI I scroll by clicking down the middle mouse button to enter <img src=""https://github.com/user-attachments/assets/eec01268-15dc-479a-9443-de25bde7dcdf"" width=24> scroll mode. Unfortunately click with middle mouse also is the verb in a web browser for ""open new link"". I just spent a month (oct 27 - nov 27) traveling during which time I used only my laptop. When I came back I noticed a slight difference in Mastodon's Advanced Interface. I think something changed. Now if I click almost anywhere to scroll, it opens a new mastodon tab. Since scroll is a frequent action, this means as I use Mastodon many clone tabs pile up unless I am very careful to click on the margins of posts. I see this in both Firefox and Chrome so I think the change must have been in Mastodon.  Expected behaviour Scroll  Actual behaviour New Window  Detailed description It might be this is just a byproduct of improvements on the ""click to focus on this post"" hitboxes in Advanced Mode and there is nothing you can do about this, but I haven't seen this behavior before today.  Mastodon instance mastodon.social  Mastodon version v4.4.0-nightly.2024-11-27  Browser name and version Chrome 131.0.6778.86 64bit  Operating system Windows 10  Technical details _No response_ other-file other-file other-file other-file",no-bug,0.9
27401,mastodon,https://github.com/mastodon/mastodon/issues/27401,LinkCrawlWorker NoMethodError undefined method 'to_sym'," Steps to reproduce the problem Starting about one week ago, noticed these types of errors appearing in Sidekiq dead queue.  NoMethodError: undefined method `to_sym' for [{""@type""=>""Language"", ""name""=>""Dutch""}]:Array NoMethodError: undefined method `to_sym' for {""@type""=>""Language"", ""name""=>""Indonesian"", ""alternateName""=>""id""}:Hash NoMethodError: undefined method `to_sym' for {""@type""=>""Language"", ""name""=>""Russian"", ""alternateName""=>""ru""}:Hash  ![image](https://github.com/mastodon/mastodon/assets/3002053/fb435620-d815-45ea-a2cd-e989a9a9af0b) ![CleanShot 2023-10-13 at 11 48 45@2x](https://github.com/mastodon/mastodon/assets/3002053/3ab07212-cab8-403a-a33b-c0acb29d3c97)  Expected behaviour No errors  Actual behaviour These errors  Detailed description _No response_  Mastodon instance vmst.io  Mastodon version main  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.2.2 +YJIT) - Node.js version: (from `node --version`, eg. v20)",source-file | source-file,"LinkCrawlWorker NoMethodError undefined method 'to_sym'  Steps to reproduce the problem Starting about one week ago, noticed these types of errors appearing in Sidekiq dead queue.  NoMethodError: undefined method `to_sym' for [{""@type""=>""Language"", ""name""=>""Dutch""}]:Array NoMethodError: undefined method `to_sym' for {""@type""=>""Language"", ""name""=>""Indonesian"", ""alternateName""=>""id""}:Hash NoMethodError: undefined method `to_sym' for {""@type""=>""Language"", ""name""=>""Russian"", ""alternateName""=>""ru""}:Hash  ![image](https://github.com/mastodon/mastodon/assets/3002053/fb435620-d815-45ea-a2cd-e989a9a9af0b) ![CleanShot 2023-10-13 at 11 48 45@2x](https://github.com/mastodon/mastodon/assets/3002053/3ab07212-cab8-403a-a33b-c0acb29d3c97)  Expected behaviour No errors  Actual behaviour These errors  Detailed description _No response_  Mastodon instance vmst.io  Mastodon version main  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.2.2 +YJIT) - Node.js version: (from `node --version`, eg. v20) source-file source-file",no-bug,0.8
32340,mastodon,https://github.com/mastodon/mastodon/issues/32340,Hide completely checkbox in filters doesn't hide completely in notifications," Steps to reproduce the problem 1. Make a filter, check hide completely. 2. Check your Notifications ![Screenshot 2024-10-09 160133](https://github.com/user-attachments/assets/b349ceed-09cc-4946-adc8-666db41b98c3)  Expected behaviour They should be hidden completely  Actual behaviour A container with @ Mention shows up  Detailed description _No response_  Mastodon instance masto.byrd.ws  Mastodon version v4.3  Browser name and version Firefox 132  Operating system Windows 11  Technical details _No response_",other-file | source-file | source-file | other-file | source-file | source-file,"Hide completely checkbox in filters doesn't hide completely in notifications  Steps to reproduce the problem 1. Make a filter, check hide completely. 2. Check your Notifications ![Screenshot 2024-10-09 160133](https://github.com/user-attachments/assets/b349ceed-09cc-4946-adc8-666db41b98c3)  Expected behaviour They should be hidden completely  Actual behaviour A container with @ Mention shows up  Detailed description _No response_  Mastodon instance masto.byrd.ws  Mastodon version v4.3  Browser name and version Firefox 132  Operating system Windows 11  Technical details _No response_ other-file source-file source-file other-file source-file source-file",no-bug,0.8
28821,mastodon,https://github.com/mastodon/mastodon/issues/28821,LinkCrawlWorker fails with Errno::ENAMETOOLONG," Steps to reproduce the problem 1. Let LinkCrawlWorker in Sidekiq process a link that is affected, the following post seems to trigger this issue: https://very.tastytea.de/notes/9o0dw2kljs  Expected behaviour LinkCrawler should've given the temporary file a correct name  Actual behaviour LinkCrawler ended up with the filename containing all headers, making it too long. The operation fails and ends up in the dead queue  Detailed description _No response_  Mastodon instance woof.tech  Mastodon version v4.1.11-3-woof  Technical details - Ruby 3.0.4p208 - Node.js v16.20.2 Using some backported changes from main onto v4.1.11 (Like #28788), but this issue seems to happen on mainline mastodon as well Logs:  Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.065Z pid=4091868 tid=1yb5g class=LinkCrawlWorker jid=9febc4943b665a5240d5540a INFO: start Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.345Z pid=4091868 tid=1yb5g class=LinkCrawlWorker jid=9febc4943b665a5240d5540a INFO: Adding dead LinkCrawlWorker job 9febc4943b665a5240d5540a Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.347Z pid=4091868 tid=1yb5g class=LinkCrawlWorker jid=9febc4943b665a5240d5540a elapsed=0.281 INFO: fail Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.347Z pid=4091868 tid=1yb5g WARN: {""context"":""Job raised exception"",""job"":{""retry"":0,""queue"":""pull"",""class"":""LinkCrawlWorker"",""args"":[111688311417973189],""jid"":""9febc4943b665a5240d5540a"",""created_at"":1704228394.274077,""enqueued_at"":1705677347.065164,""error_message"":""File name too long @ rb_sysopen - /tmp/d603ba193612fc3ba84766851f3938c920240119-4091868-wwu875.png22response-content-typeimage2FpngExpires1704866743SignatureTOuki<part of sig>qDdV2LRe0kMjCZLAVHMmzdGSeMjRjSlPMnd1S-dRLeCjI62qA__Key-Pair-IdAP<part of key pair>5A"",""error_class"":""Errno::ENAMETOOLONG"",""failed_at"":1704228412.275545,""retry_count"":-1,""retried_at"":1705677240.856181}} Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.347Z pid=4091868 tid=1yb5g WARN: Errno::ENAMETOOLONG: File name too long @ rb_sysopen - /tmp/d603ba193612fc3ba84766851f3938c920240119-4091868-4gdtvo.png22response-content-typeimage2FpngExpires1704866743SignatureTOuki<part of sig>qDdV2LRe0kMjCZLAVHMmzdGSeMjRjSlPMnd1S-dRLeCjI62qA__Key-Pair-IdAP<part of key pair>5A Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.347Z pid=4091868 tid=1yb5g WARN: /home/mastodon/.rbenv/versions/3.0.6/lib/ruby/3.0.0/tempfile.rb:141:in `initialize' Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: /home/mastodon/.rbenv/versions/3.0.6/lib/ruby/3.0.0/tempfile.rb:141:in `open' Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: /home/mastodon/.rbenv/versions/3.0.6/lib/ruby/3.0.0/tempfile.rb:141:in `block in initialize'  Sidekiq:  Errno::ENAMETOOLONG: File name too long @ rb_sysopen - /tmp/d603ba193612fc3ba84766851f3938c920240119-4091868-4gdtvo.png22response-content-typeimage2FpngExpires1704866743SignatureTOukiuVPhRnvSiQFunalnM3[] ",source-file | source-file | source-file,"LinkCrawlWorker fails with Errno::ENAMETOOLONG  Steps to reproduce the problem 1. Let LinkCrawlWorker in Sidekiq process a link that is affected, the following post seems to trigger this issue: https://very.tastytea.de/notes/9o0dw2kljs  Expected behaviour LinkCrawler should've given the temporary file a correct name  Actual behaviour LinkCrawler ended up with the filename containing all headers, making it too long. The operation fails and ends up in the dead queue  Detailed description _No response_  Mastodon instance woof.tech  Mastodon version v4.1.11-3-woof  Technical details - Ruby 3.0.4p208 - Node.js v16.20.2 Using some backported changes from main onto v4.1.11 (Like #28788), but this issue seems to happen on mainline mastodon as well Logs:  Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.065Z pid=4091868 tid=1yb5g class=LinkCrawlWorker jid=9febc4943b665a5240d5540a INFO: start Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.345Z pid=4091868 tid=1yb5g class=LinkCrawlWorker jid=9febc4943b665a5240d5540a INFO: Adding dead LinkCrawlWorker job 9febc4943b665a5240d5540a Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.347Z pid=4091868 tid=1yb5g class=LinkCrawlWorker jid=9febc4943b665a5240d5540a elapsed=0.281 INFO: fail Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.347Z pid=4091868 tid=1yb5g WARN: {""context"":""Job raised exception"",""job"":{""retry"":0,""queue"":""pull"",""class"":""LinkCrawlWorker"",""args"":[111688311417973189],""jid"":""9febc4943b665a5240d5540a"",""created_at"":1704228394.274077,""enqueued_at"":1705677347.065164,""error_message"":""File name too long @ rb_sysopen - /tmp/d603ba193612fc3ba84766851f3938c920240119-4091868-wwu875.png22response-content-typeimage2FpngExpires1704866743SignatureTOuki<part of sig>qDdV2LRe0kMjCZLAVHMmzdGSeMjRjSlPMnd1S-dRLeCjI62qA__Key-Pair-IdAP<part of key pair>5A"",""error_class"":""Errno::ENAMETOOLONG"",""failed_at"":1704228412.275545,""retry_count"":-1,""retried_at"":1705677240.856181}} Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.347Z pid=4091868 tid=1yb5g WARN: Errno::ENAMETOOLONG: File name too long @ rb_sysopen - /tmp/d603ba193612fc3ba84766851f3938c920240119-4091868-4gdtvo.png22response-content-typeimage2FpngExpires1704866743SignatureTOuki<part of sig>qDdV2LRe0kMjCZLAVHMmzdGSeMjRjSlPMnd1S-dRLeCjI62qA__Key-Pair-IdAP<part of key pair>5A Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: 2024-01-19T15:15:47.347Z pid=4091868 tid=1yb5g WARN: /home/mastodon/.rbenv/versions/3.0.6/lib/ruby/3.0.0/tempfile.rb:141:in `initialize' Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: /home/mastodon/.rbenv/versions/3.0.6/lib/ruby/3.0.0/tempfile.rb:141:in `open' Jan 19 15:15:47 woof-tech-mastodon-prod bundle[4091868]: /home/mastodon/.rbenv/versions/3.0.6/lib/ruby/3.0.0/tempfile.rb:141:in `block in initialize'  Sidekiq:  Errno::ENAMETOOLONG: File name too long @ rb_sysopen - /tmp/d603ba193612fc3ba84766851f3938c920240119-4091868-4gdtvo.png22response-content-typeimage2FpngExpires1704866743SignatureTOukiuVPhRnvSiQFunalnM3[]  source-file source-file source-file",no-bug,0.9
28381,mastodon,https://github.com/mastodon/mastodon/issues/28381,/api/v1/directory returning 500 on Mastodon 4.1.11," Steps to reproduce the problem On a Mastodon 4.1.11 instance: 1. Go to `your-domain.tld/directory` on a browser. A `GET` request is made to `/api/v1/directory?order=active&local=false&limit=20` 2. Check the mastodon-web logs and the database logs  Expected behaviour The `/directory` page shows some profiles  Actual behaviour The `/directory` page loads, but doesn't show any profile  Detailed description The API call to `/api/v1/directory?order=active&local=false&limit=20` gives a `500` error mastodon-web logs:  [3f261ece-7921-40e8-83a1-15a7577819f0] ActiveRecord::StatementInvalid (PG::AmbiguousColumn: ERROR: column reference ""last_status_at"" is ambiguous LINE 1:  NULL AND ""accounts"".""discoverable"" = $2 ORDER BY last_statu ^ ): [3f261ece-7921-40e8-83a1-15a7577819f0] [3f261ece-7921-40e8-83a1-15a7577819f0] app/controllers/api/v1/directories_controller.rb:8:in `show' [3f261ece-7921-40e8-83a1-15a7577819f0] app/controllers/concerns/localized.rb:11:in `set_locale' [3f261ece-7921-40e8-83a1-15a7577819f0] lib/mastodon/rack_middleware.rb:9:in `call' [3f261ece-7921-40e8-83a1-15a7577819f0] lib/public_file_server_middleware.rb:18:in `call'  Postgres logs:  2023-12-15T12:11:50.926973550+01:00 2023-12-15 11:11:50.926 UTC [789030] ERROR: column reference ""last_status_at"" is ambiguous at character 2689 2023-12-15T12:11:50.927009728+01:00 2023-12-15 11:11:50.926 UTC [789030] STATEMENT: SELECT ""accounts"".""username"" AS t0_r0, ""accounts"".""domain"" AS t0_r1, ""accounts"".""private_key"" AS t0_r2, ""accounts"".""public_key"" AS t0_r3, ""accounts"".""created_at"" AS t0_r4, ""accounts"".""updated_at"" AS t0_r5, ""accounts"".""note"" AS t0_r6, ""accounts"".""display_name"" AS t0_r7, ""accounts"".""uri"" AS t0_r8, ""accounts"".""url"" AS t0_r9, ""accounts"".""avatar_file_name"" AS t0_r10, ""accounts"".""avatar_content_type"" AS t0_r11, ""accounts"".""avatar_file_size"" AS t0_r12, ""accounts"".""avatar_updated_at"" AS t0_r13, ""accounts"".""header_file_name"" AS t0_r14, ""accounts"".""header_content_type"" AS t0_r15, ""accounts"".""header_file_size"" AS t0_r16, ""accounts"".""header_updated_at"" AS t0_r17, ""accounts"".""avatar_remote_url"" AS t0_r18, ""accounts"".""locked"" AS t0_r19, ""accounts"".""header_remote_url"" AS t0_r20, ""accounts"".""last_webfingered_at"" AS t0_r21, ""accounts"".""inbox_url"" AS t0_r22, ""accounts"".""outbox_url"" AS t0_r23, ""accounts"".""shared_inbox_url"" AS t0_r24, ""accounts"".""followers_url"" AS t0_r25, ""accounts"".""protocol"" AS t0_r26, ""accounts"".""id"" AS t0_r27, ""accounts"".""memorial"" AS t0_r28, ""accounts"".""moved_to_account_id"" AS t0_r29, ""accounts"".""featured_collection_url"" AS t0_r30, ""accounts"".""fields"" AS t0_r31, ""accounts"".""actor_type"" AS t0_r32, ""accounts"".""discoverable"" AS t0_r33, ""accounts"".""also_known_as"" AS t0_r34, ""accounts"".""silenced_at"" AS t0_r35, ""accounts"".""suspended_at"" AS t0_r36, ""accounts"".""hide_collections"" AS t0_r37, ""accounts"".""avatar_storage_schema_version"" AS t0_r38, ""accounts"".""header_storage_schema_version"" AS t0_r39, ""accounts"".""devices_url"" AS t0_r40, ""accounts"".""sensitized_at"" AS t0_r41, ""accounts"".""suspension_origin"" AS t0_r42, ""accounts"".""trendable"" AS t0_r43, ""accounts"".""reviewed_at"" AS t0_r44, ""accounts"".""requested_review_at"" AS t0_r45, ""account_stats_accounts"".""id"" AS t1_r0, ""account_stats_accounts"".""account_id"" AS t1_r1, ""account_stats_accounts"".""statuses_count"" AS t1_r2, ""account_stats_accounts"".""following_count"" AS t1_r3, ""account_stats_accounts"".""followers_count"" AS t1_r4, ""account_stats_accounts"".""created_at"" AS t1_r5, ""account_stats_accounts"".""updated_at"" AS t1_r6, ""account_stats_accounts"".""last_status_at"" AS t1_r7 FROM ""accounts"" LEFT OUTER JOIN ""users"" ON ""users"".""account_id"" = ""accounts"".""id"" LEFT OUTER JOIN ""account_stats"" ON ""account_stats"".""account_id"" = ""accounts"".""id"" LEFT OUTER JOIN ""account_stats"" ""account_stats_accounts"" ON ""account_stats_accounts"".""account_id"" = ""accounts"".""id"" WHERE (""accounts"".""domain"" IS NOT NULL OR ""users"".""approved"" = $1 AND ""users"".""confirmed_at"" IS NOT NULL) AND ""accounts"".""suspended_at"" IS NULL AND ""accounts"".""moved_to_account_id"" IS NULL AND ""accounts"".""silenced_at"" IS NULL AND ""accounts"".""discoverable"" = $2 ORDER BY last_status_at DESC NULLS LAST LIMIT $3  In the generated query, the `LEFT OUTER JOIN ""account_stats"" ON ""account_stats"".""account_id"" = ""accounts"".""id"" LEFT OUTER JOIN ""account_stats"" ""account_stats_accounts"" ON ""account_stats_accounts"".""account_id"" = ""accounts"".""id""` seems weird.  Mastodon instance https://mastodon.libre-entreprise.com  Mastodon version v4.1.11  Technical details Mastodon running with Docker, using official image",source-file | source-file,"/api/v1/directory returning 500 on Mastodon 4.1.11  Steps to reproduce the problem On a Mastodon 4.1.11 instance: 1. Go to `your-domain.tld/directory` on a browser. A `GET` request is made to `/api/v1/directory?order=active&local=false&limit=20` 2. Check the mastodon-web logs and the database logs  Expected behaviour The `/directory` page shows some profiles  Actual behaviour The `/directory` page loads, but doesn't show any profile  Detailed description The API call to `/api/v1/directory?order=active&local=false&limit=20` gives a `500` error mastodon-web logs:  [3f261ece-7921-40e8-83a1-15a7577819f0] ActiveRecord::StatementInvalid (PG::AmbiguousColumn: ERROR: column reference ""last_status_at"" is ambiguous LINE 1:  NULL AND ""accounts"".""discoverable"" = $2 ORDER BY last_statu ^ ): [3f261ece-7921-40e8-83a1-15a7577819f0] [3f261ece-7921-40e8-83a1-15a7577819f0] app/controllers/api/v1/directories_controller.rb:8:in `show' [3f261ece-7921-40e8-83a1-15a7577819f0] app/controllers/concerns/localized.rb:11:in `set_locale' [3f261ece-7921-40e8-83a1-15a7577819f0] lib/mastodon/rack_middleware.rb:9:in `call' [3f261ece-7921-40e8-83a1-15a7577819f0] lib/public_file_server_middleware.rb:18:in `call'  Postgres logs:  2023-12-15T12:11:50.926973550+01:00 2023-12-15 11:11:50.926 UTC [789030] ERROR: column reference ""last_status_at"" is ambiguous at character 2689 2023-12-15T12:11:50.927009728+01:00 2023-12-15 11:11:50.926 UTC [789030] STATEMENT: SELECT ""accounts"".""username"" AS t0_r0, ""accounts"".""domain"" AS t0_r1, ""accounts"".""private_key"" AS t0_r2, ""accounts"".""public_key"" AS t0_r3, ""accounts"".""created_at"" AS t0_r4, ""accounts"".""updated_at"" AS t0_r5, ""accounts"".""note"" AS t0_r6, ""accounts"".""display_name"" AS t0_r7, ""accounts"".""uri"" AS t0_r8, ""accounts"".""url"" AS t0_r9, ""accounts"".""avatar_file_name"" AS t0_r10, ""accounts"".""avatar_content_type"" AS t0_r11, ""accounts"".""avatar_file_size"" AS t0_r12, ""accounts"".""avatar_updated_at"" AS t0_r13, ""accounts"".""header_file_name"" AS t0_r14, ""accounts"".""header_content_type"" AS t0_r15, ""accounts"".""header_file_size"" AS t0_r16, ""accounts"".""header_updated_at"" AS t0_r17, ""accounts"".""avatar_remote_url"" AS t0_r18, ""accounts"".""locked"" AS t0_r19, ""accounts"".""header_remote_url"" AS t0_r20, ""accounts"".""last_webfingered_at"" AS t0_r21, ""accounts"".""inbox_url"" AS t0_r22, ""accounts"".""outbox_url"" AS t0_r23, ""accounts"".""shared_inbox_url"" AS t0_r24, ""accounts"".""followers_url"" AS t0_r25, ""accounts"".""protocol"" AS t0_r26, ""accounts"".""id"" AS t0_r27, ""accounts"".""memorial"" AS t0_r28, ""accounts"".""moved_to_account_id"" AS t0_r29, ""accounts"".""featured_collection_url"" AS t0_r30, ""accounts"".""fields"" AS t0_r31, ""accounts"".""actor_type"" AS t0_r32, ""accounts"".""discoverable"" AS t0_r33, ""accounts"".""also_known_as"" AS t0_r34, ""accounts"".""silenced_at"" AS t0_r35, ""accounts"".""suspended_at"" AS t0_r36, ""accounts"".""hide_collections"" AS t0_r37, ""accounts"".""avatar_storage_schema_version"" AS t0_r38, ""accounts"".""header_storage_schema_version"" AS t0_r39, ""accounts"".""devices_url"" AS t0_r40, ""accounts"".""sensitized_at"" AS t0_r41, ""accounts"".""suspension_origin"" AS t0_r42, ""accounts"".""trendable"" AS t0_r43, ""accounts"".""reviewed_at"" AS t0_r44, ""accounts"".""requested_review_at"" AS t0_r45, ""account_stats_accounts"".""id"" AS t1_r0, ""account_stats_accounts"".""account_id"" AS t1_r1, ""account_stats_accounts"".""statuses_count"" AS t1_r2, ""account_stats_accounts"".""following_count"" AS t1_r3, ""account_stats_accounts"".""followers_count"" AS t1_r4, ""account_stats_accounts"".""created_at"" AS t1_r5, ""account_stats_accounts"".""updated_at"" AS t1_r6, ""account_stats_accounts"".""last_status_at"" AS t1_r7 FROM ""accounts"" LEFT OUTER JOIN ""users"" ON ""users"".""account_id"" = ""accounts"".""id"" LEFT OUTER JOIN ""account_stats"" ON ""account_stats"".""account_id"" = ""accounts"".""id"" LEFT OUTER JOIN ""account_stats"" ""account_stats_accounts"" ON ""account_stats_accounts"".""account_id"" = ""accounts"".""id"" WHERE (""accounts"".""domain"" IS NOT NULL OR ""users"".""approved"" = $1 AND ""users"".""confirmed_at"" IS NOT NULL) AND ""accounts"".""suspended_at"" IS NULL AND ""accounts"".""moved_to_account_id"" IS NULL AND ""accounts"".""silenced_at"" IS NULL AND ""accounts"".""discoverable"" = $2 ORDER BY last_status_at DESC NULLS LAST LIMIT $3  In the generated query, the `LEFT OUTER JOIN ""account_stats"" ON ""account_stats"".""account_id"" = ""accounts"".""id"" LEFT OUTER JOIN ""account_stats"" ""account_stats_accounts"" ON ""account_stats_accounts"".""account_id"" = ""accounts"".""id""` seems weird.  Mastodon instance https://mastodon.libre-entreprise.com  Mastodon version v4.1.11  Technical details Mastodon running with Docker, using official image source-file source-file",bug,0.95
34426,mastodon,https://github.com/mastodon/mastodon/issues/34426,"On mobile, ""Copy link to post"" item opens a new window"," Steps to reproduce the problem 1. Open the timeline on mobile 2. Click on the  menu on a post 3. Click ""Copy link to post""  Expected behaviour The link is copied, no new window opens  Actual behaviour A new window opens to `/home#`  Detailed description This does not happen on the web (latest Safari)  Mastodon instance oisaur.com  Mastodon version nightly  Browser name and version Latest Safari  Operating system Latest iOS  Technical details This is probably caused by the recent dropdown refactor",other-file,"On mobile, ""Copy link to post"" item opens a new window  Steps to reproduce the problem 1. Open the timeline on mobile 2. Click on the  menu on a post 3. Click ""Copy link to post""  Expected behaviour The link is copied, no new window opens  Actual behaviour A new window opens to `/home#`  Detailed description This does not happen on the web (latest Safari)  Mastodon instance oisaur.com  Mastodon version nightly  Browser name and version Latest Safari  Operating system Latest iOS  Technical details This is probably caused by the recent dropdown refactor other-file",no-bug,0.9
30937,mastodon,https://github.com/mastodon/mastodon/issues/30937,LinkCrawlWorker NoMethodError: undefined method `encode' for an instance of Array, Steps to reproduce the problem Seen on these pages: https://www.smithsonianmag.com/history/how-the-rise-of-the-camera-launched-a-fight-to-protect-gilded-age-americans-privacy-180984656/ https://www.bostonglobe.com/2024/07/05/metro/wampanoag-plymouth-dei-cape-cod/ ![CleanShot 2024-07-05 at 17 51 00@2x](https://github.com/mastodon/mastodon/assets/3002053/e05b590b-ccb5-4866-9bba-ee020283d867)  Expected behaviour No error  Actual behaviour Error  Detailed description I seems like these are triggered from the author details on the page being listed in an array.  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha.5  Technical details Latest `main`,source-file | source-file | source-file | source-file,LinkCrawlWorker NoMethodError: undefined method `encode' for an instance of Array  Steps to reproduce the problem Seen on these pages: https://www.smithsonianmag.com/history/how-the-rise-of-the-camera-launched-a-fight-to-protect-gilded-age-americans-privacy-180984656/ https://www.bostonglobe.com/2024/07/05/metro/wampanoag-plymouth-dei-cape-cod/ ![CleanShot 2024-07-05 at 17 51 00@2x](https://github.com/mastodon/mastodon/assets/3002053/e05b590b-ccb5-4866-9bba-ee020283d867)  Expected behaviour No error  Actual behaviour Error  Detailed description I seems like these are triggered from the author details on the page being listed in an array.  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha.5  Technical details Latest `main` source-file source-file source-file source-file,no-bug,0.9
27552,mastodon,https://github.com/mastodon/mastodon/issues/27552,hash-tag bar appears on posts ending with (containing?) a link with a fragment," Steps to reproduce the problem 1. post `lets go https://gcc.gnu.org/bugzilla/show_bug.cgi?id=111895#c4`  Expected behaviour the post contains `lets go https://gcc.gnu.org/bugzilla/show_bug.cgi?id=111895#c4`  Actual behaviour the post contains `lets go https://gcc.gnu.org/bugzilla/show_bug.cgi?id=111895#c4`, then vertical space, then the hash-tag bar with `#c4` in it  Detailed description github is saying that ""Something went really wrong, and we can't process that file. Try again."" for my screenshot, and it's refusing to accept URLs with a data scheme, so here's a data URL with a scrussy to open separately via pasting: <data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA54AAAEqAQAAAABVMLIAAAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAACxMAAAsTAQCanBgAAAfiSURBVHja7d3NTuNIAgfwsrxq94HBc0zUEB/2BYiQtkGb4HmAeQhakYbLiKaFNAoi3WUU7XIJ7StoaPIKjfrCqLMTt1jhC0uuHFZgFGl8GXUcRdo4il21VU6gE3oMgeCyNNRfAiWx5B/16Y9UCACPJ2+AaDFHPaB4rE3BAhBrrFFDxJh1/QqagrHHHMUkjOtXoCbr+u2hLn04yRhFvREbdRaGUNwbsVEHaxODqCbNd4zoa9XIXEP9yEsq6lZhGP37OxQ5+g/re9UbROemTyJHN5wJFQ2iHf8oalQqOhPzR4NolwFacybSR8NtGn314q9QH7FH573ohwy2hlEmU64XAwqwEQMKhyd8NujTOFDAUY5ydFxUFLbJ70XyM8sIRRQ9vUQ1Jqhga0AMXqHoDJuSihv6Yb257RbQ0klugVH1igs1u9XZ8RBa+m1VZYQ++en4h9nkTuloavmn1dUPjNAfjhdnp7e/MRI//u1/L1ihx98vtaZ3fGPuZesMMkOPl2and/5jrLysn8FZZujybPLn0tHi8l/3XrFC8fFSv/e2dlVW1QtLS63mjkfG6UWJ1ZDpzUYJthO++G/6bI7xUSa4qMjzg/hDX19c3dJhGHh184qHh4eHh4eHh+dannz1yjf0DDF5ABKi9ofbHwS9fnNjuo/OsUST1BIOwEyEqFpw5bql1ExDVbeNNwso6ZlqdecXN91yC0czkp14+HcznsDXnmw76nnNggSFKkp7JqzufHRzXQ/ZK1I7GQG6ul+aWp6bP/19JZfeNurpt+m35upm8mMi92zr6OXik+fJ0sOjuX2LoDOnE6BO0EOC/tN8sZk8SOQOt0yKPosAhe+9xHJiAH1B0LfJX9xPra1NgqrRoJnhklJ0N/nx1FjfMtesaEr6av5am168tVe3kx+Th6RN541o2hT+q997f4Pp8glMo08epr23U+yW0LwhtTreyemDj9MprzdOj9S0fvJmhqCQjlN/o1UqELTueif/jWCCeLoIBAP0b/vK9JHW+yHPHAAmIpn0ZQuoWv9tOIFOBfDLJqf3SgSoARTtcjkJXc6iDt2dcPmxmIeHh4eHhyfOQMwmgyc9gsWocKmBx70zTQaRbrznEFEELWZ0glmPNWJGnzJDv+MoRznKUY5ylKN/RlQtK0K3U5JrVZZotVqkaAMzRFf394vP3pWmfswxRHPvZ0SCJv78aCzVSzrSh+47v/Y7ZDtk0t1dv3asMkTp1WOwOFRkWVLCBdfNkC0qOPTBAp/wHwiVol+K+kfo+zjQgzjQShzor3Gg1VhQ7bEMGaxx9NGhggVWrp7Q/1ogGf0NxtXLKQCCgyKw6DmAQX5PkQfyCKio5aUNTzkcWKRPP3sh2NowKg+ikjaAim4PbdyCGsoVqhZdtYjU+m2oYjghqORdotIu2TBKSSm6ieCtaAqEoTK6H1pes7Vb2nQIHWpTeeGyTW9GB6p3tph/vqnn21pwOnpeq3eNdZRvN+2yI19g2W65WPcQQGoR6/DQhUJlHStmuYtINxA8bDb9RspQdRcaNVjzFNuR3dE60uZZvh2sYjk/P28RFK81OnbVUTq43G57uOZjAVeLuAZtD2uZdaza5S75hUSEax3fWgCEw4YMG5bScGVvNLSIXreRiA18fo6H0Wobe/jcxxs9tOH30WoXw8YlmiGo30fxHVAYoE2sZLoX2nota2XtirOwZlegMdU6y9pFew+0ztYaSpugZsWurNfyOCXpTSvrGAUgNLJ1QyYdQ9oryJkRqxepjkJLilKZdQOsm6rp25WVTNas4qJXP8si8fAMNNGrBkaAoNXNyroOA9T2LeAC9TNF8xTNyKkRUX3SoZ2OoHM9tObbBwQ9rOJNgmZwD11pIFq9ZtU+6KFas+Fb5FwdXqG7N6FgGBVsijqpfkmV82yvpBVJ3yUoLFLUe9UAKkV1Ur16XqYozlqiBTojlHT4AoqiImkzANyzVKb7SSPoXr9Nf32uZ0j1mrRNHW+tsWVTtEPRwktavShrmQZofkFJm+a+HQklI4/OSPgspbYODYKW/cveq3v1oPfuAc8Leq/SNTHpvXrQe5vYv2gggD9nMUUtifbetjsKWkS9CR+ilBKgst5Hy2RmqAfjlKAutFGAVsk41dU2RRsBCj9n+igdp3TM346So0ywoE3dS8n1AJV9OiM1yYy0ieo1MiPhFCjk6YwE5K5ZJjOSHsxIX1BI0Lol0hmpfTDOBdTAPEvjfJmNE+6dD+L3Q8UBVHFiQFVmqDVQUotfiXOUoxzlKEfjQ0VevRzl6P3Qx7Oa7vGskIxlAWosS21jWVTMw8PDw8PDw8PzqHPK6t8qDqN55qbkxYAK+64bB3rKHv3wbpt9m3ZF9qiYE70Y0HIM6As38ThQHh4eHh4eHh4enkeRwTfeRs6430Nzr3f4wm5TyCN++6Z0HzQ/JiqHo+HvlxfGRJXwjytPh+7CGxNVsXX5cZDrWQjbhYDGRCF2JCtskxX2h7rjou7kYsimjQdDldfWtR2EoTgMVbBzZ9QZ3kEYKuBP1h33PSoqF72wkqakkF4qYWM8VNIKoagc0kvFsA9MhaKT89bwNJgJ672hJb07+tWEnwkbp0rXjQi94bt7FN8Ja9MwtDEqmgifIe+MmuOjKGQXkhmGFkdFbzgifxeCCiG9YHLkpTDfPtxpyF/C/kweHh4eHh4eHp6Q/B8tfcJrc83nCAAAAABJRU5ErkJggg==>  Mastodon instance 101010.pl  Mastodon version v4.3.0-alpha.0  Browser name and version firefox deved 87.0b9 (64-bit)  Operating system windows 10  Technical details _No response_",source-file | source-file,"hash-tag bar appears on posts ending with (containing?) a link with a fragment  Steps to reproduce the problem 1. post `lets go https://gcc.gnu.org/bugzilla/show_bug.cgi?id=111895#c4`  Expected behaviour the post contains `lets go https://gcc.gnu.org/bugzilla/show_bug.cgi?id=111895#c4`  Actual behaviour the post contains `lets go https://gcc.gnu.org/bugzilla/show_bug.cgi?id=111895#c4`, then vertical space, then the hash-tag bar with `#c4` in it  Detailed description github is saying that ""Something went really wrong, and we can't process that file. Try again."" for my screenshot, and it's refusing to accept URLs with a data scheme, so here's a data URL with a scrussy to open separately via pasting: <data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA54AAAEqAQAAAABVMLIAAAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAACxMAAAsTAQCanBgAAAfiSURBVHja7d3NTuNIAgfwsrxq94HBc0zUEB/2BYiQtkGb4HmAeQhakYbLiKaFNAoi3WUU7XIJ7StoaPIKjfrCqLMTt1jhC0uuHFZgFGl8GXUcRdo4il21VU6gE3oMgeCyNNRfAiWx5B/16Y9UCACPJ2+AaDFHPaB4rE3BAhBrrFFDxJh1/QqagrHHHMUkjOtXoCbr+u2hLn04yRhFvREbdRaGUNwbsVEHaxODqCbNd4zoa9XIXEP9yEsq6lZhGP37OxQ5+g/re9UbROemTyJHN5wJFQ2iHf8oalQqOhPzR4NolwFacybSR8NtGn314q9QH7FH573ohwy2hlEmU64XAwqwEQMKhyd8NujTOFDAUY5ydFxUFLbJ70XyM8sIRRQ9vUQ1Jqhga0AMXqHoDJuSihv6Yb257RbQ0klugVH1igs1u9XZ8RBa+m1VZYQ++en4h9nkTuloavmn1dUPjNAfjhdnp7e/MRI//u1/L1ihx98vtaZ3fGPuZesMMkOPl2and/5jrLysn8FZZujybPLn0tHi8l/3XrFC8fFSv/e2dlVW1QtLS63mjkfG6UWJ1ZDpzUYJthO++G/6bI7xUSa4qMjzg/hDX19c3dJhGHh184qHh4eHh4eHh+dannz1yjf0DDF5ABKi9ofbHwS9fnNjuo/OsUST1BIOwEyEqFpw5bql1ExDVbeNNwso6ZlqdecXN91yC0czkp14+HcznsDXnmw76nnNggSFKkp7JqzufHRzXQ/ZK1I7GQG6ul+aWp6bP/19JZfeNurpt+m35upm8mMi92zr6OXik+fJ0sOjuX2LoDOnE6BO0EOC/tN8sZk8SOQOt0yKPosAhe+9xHJiAH1B0LfJX9xPra1NgqrRoJnhklJ0N/nx1FjfMtesaEr6av5am168tVe3kx+Th6RN541o2hT+q997f4Pp8glMo08epr23U+yW0LwhtTreyemDj9MprzdOj9S0fvJmhqCQjlN/o1UqELTueif/jWCCeLoIBAP0b/vK9JHW+yHPHAAmIpn0ZQuoWv9tOIFOBfDLJqf3SgSoARTtcjkJXc6iDt2dcPmxmIeHh4eHhyfOQMwmgyc9gsWocKmBx70zTQaRbrznEFEELWZ0glmPNWJGnzJDv+MoRznKUY5ylKN/RlQtK0K3U5JrVZZotVqkaAMzRFf394vP3pWmfswxRHPvZ0SCJv78aCzVSzrSh+47v/Y7ZDtk0t1dv3asMkTp1WOwOFRkWVLCBdfNkC0qOPTBAp/wHwiVol+K+kfo+zjQgzjQShzor3Gg1VhQ7bEMGaxx9NGhggVWrp7Q/1ogGf0NxtXLKQCCgyKw6DmAQX5PkQfyCKio5aUNTzkcWKRPP3sh2NowKg+ikjaAim4PbdyCGsoVqhZdtYjU+m2oYjghqORdotIu2TBKSSm6ieCtaAqEoTK6H1pes7Vb2nQIHWpTeeGyTW9GB6p3tph/vqnn21pwOnpeq3eNdZRvN+2yI19g2W65WPcQQGoR6/DQhUJlHStmuYtINxA8bDb9RspQdRcaNVjzFNuR3dE60uZZvh2sYjk/P28RFK81OnbVUTq43G57uOZjAVeLuAZtD2uZdaza5S75hUSEax3fWgCEw4YMG5bScGVvNLSIXreRiA18fo6H0Wobe/jcxxs9tOH30WoXw8YlmiGo30fxHVAYoE2sZLoX2nota2XtirOwZlegMdU6y9pFew+0ztYaSpugZsWurNfyOCXpTSvrGAUgNLJ1QyYdQ9oryJkRqxepjkJLilKZdQOsm6rp25WVTNas4qJXP8si8fAMNNGrBkaAoNXNyroOA9T2LeAC9TNF8xTNyKkRUX3SoZ2OoHM9tObbBwQ9rOJNgmZwD11pIFq9ZtU+6KFas+Fb5FwdXqG7N6FgGBVsijqpfkmV82yvpBVJ3yUoLFLUe9UAKkV1Ur16XqYozlqiBTojlHT4AoqiImkzANyzVKb7SSPoXr9Nf32uZ0j1mrRNHW+tsWVTtEPRwktavShrmQZofkFJm+a+HQklI4/OSPgspbYODYKW/cveq3v1oPfuAc8Leq/SNTHpvXrQe5vYv2gggD9nMUUtifbetjsKWkS9CR+ilBKgst5Hy2RmqAfjlKAutFGAVsk41dU2RRsBCj9n+igdp3TM346So0ywoE3dS8n1AJV9OiM1yYy0ieo1MiPhFCjk6YwE5K5ZJjOSHsxIX1BI0Lol0hmpfTDOBdTAPEvjfJmNE+6dD+L3Q8UBVHFiQFVmqDVQUotfiXOUoxzlKEfjQ0VevRzl6P3Qx7Oa7vGskIxlAWosS21jWVTMw8PDw8PDw8PzqHPK6t8qDqN55qbkxYAK+64bB3rKHv3wbpt9m3ZF9qiYE70Y0HIM6As38ThQHh4eHh4eHh4enkeRwTfeRs6430Nzr3f4wm5TyCN++6Z0HzQ/JiqHo+HvlxfGRJXwjytPh+7CGxNVsXX5cZDrWQjbhYDGRCF2JCtskxX2h7rjou7kYsimjQdDldfWtR2EoTgMVbBzZ9QZ3kEYKuBP1h33PSoqF72wkqakkF4qYWM8VNIKoagc0kvFsA9MhaKT89bwNJgJ672hJb07+tWEnwkbp0rXjQi94bt7FN8Ja9MwtDEqmgifIe+MmuOjKGQXkhmGFkdFbzgifxeCCiG9YHLkpTDfPtxpyF/C/kweHh4eHh4eHp6Q/B8tfcJrc83nCAAAAABJRU5ErkJggg==>  Mastodon instance 101010.pl  Mastodon version v4.3.0-alpha.0  Browser name and version firefox deved 87.0b9 (64-bit)  Operating system windows 10  Technical details _No response_ source-file source-file",no-bug,0.9
33764,mastodon,https://github.com/mastodon/mastodon/issues/33764,LinkCrawlWorker jobs stall leading to Sidekiq queue exhaustion," Steps to reproduce the problem Posts with links to some sites are spawning LinkCrawlWorker jobs that stall and eventually exhaust all the Sidekiq `pull` queue workers. ![Image](https://github.com/user-attachments/assets/d22578e5-a4b3-4980-be70-5f13290f6d40) Sampling of statues that cause this issue.  https://mastodon.social/users/kmpiw/statuses/113904991094873288 https://flipboard.com/users/npr/statuses/-tlFx41WTceXH_iurRZdiA:a:3195441 https://mstdn.social/users/mtlgazette/statuses/113907480354297871 https://flipboard.com/users/npr/statuses/RXOMLhODRj-HUx0GxevmBg:a:3195441 https://flipboard.com/users/npr/statuses/6rEZ0qNgQbiBWoG1mm4u2w:a:3195441 https://mastodon.world/users/verdantsquare/statuses/113907534835747953  Examples of links that don't finish processing are anything on montrealgazette.com, www.dfat.gov.au, Akamai blog, and tons from NPR.org Rolling back to an image based on Jan 27 `main` results in job completion.  Expected behaviour LinkedCrawlWorker job completes successfully  Actual behaviour LinkedCrawlWorker job stalls  Detailed description Suspect it's related to changes in #33757 although these links don't appear to have any redirects.  Mastodon instance vmst.io  Mastodon version main @ [5b291fc](https://github.com/mastodon/mastodon/commit/5b291fcbe41564264954618fb1f4086a3be1c600)  Technical details _No response_",source-file,"LinkCrawlWorker jobs stall leading to Sidekiq queue exhaustion  Steps to reproduce the problem Posts with links to some sites are spawning LinkCrawlWorker jobs that stall and eventually exhaust all the Sidekiq `pull` queue workers. ![Image](https://github.com/user-attachments/assets/d22578e5-a4b3-4980-be70-5f13290f6d40) Sampling of statues that cause this issue.  https://mastodon.social/users/kmpiw/statuses/113904991094873288 https://flipboard.com/users/npr/statuses/-tlFx41WTceXH_iurRZdiA:a:3195441 https://mstdn.social/users/mtlgazette/statuses/113907480354297871 https://flipboard.com/users/npr/statuses/RXOMLhODRj-HUx0GxevmBg:a:3195441 https://flipboard.com/users/npr/statuses/6rEZ0qNgQbiBWoG1mm4u2w:a:3195441 https://mastodon.world/users/verdantsquare/statuses/113907534835747953  Examples of links that don't finish processing are anything on montrealgazette.com, www.dfat.gov.au, Akamai blog, and tons from NPR.org Rolling back to an image based on Jan 27 `main` results in job completion.  Expected behaviour LinkedCrawlWorker job completes successfully  Actual behaviour LinkedCrawlWorker job stalls  Detailed description Suspect it's related to changes in #33757 although these links don't appear to have any redirects.  Mastodon instance vmst.io  Mastodon version main @ [5b291fc](https://github.com/mastodon/mastodon/commit/5b291fcbe41564264954618fb1f4086a3be1c600)  Technical details _No response_ source-file",no-bug,0.9
30103,mastodon,https://github.com/mastodon/mastodon/issues/30103,API to subscribe to push notification does not seem to delete previous subscription?," Steps to reproduce the problem 1. [POST `/api/v1/push/subscription`](https://docs.joinmastodon.org/methods/push/#create) many times. (Not sure if many times in a short time matters though, just stating based on what I (accidentally) did) 2. Send a post via another account, tagging the logged in user. 3. Wait for notification to arrive 4. Realised that tons of notifications came flooding in, only one decoded correctly (non unexpected, since my app only saved the latest keys)  Expected behaviour 1 notification with correct contents.  Actual behaviour hundreds? of notifications.  Detailed description Now, I am not entirely sure if the fault is on my end, but I am somewhat confident that it is the API's fault. Please advise if I'm doing something terribly wrong without noticing I am referring to the [POST `/api/v1/push/subscription`](https://docs.joinmastodon.org/methods/push/#create) endpoint. So the story here is that, new (unreleased) app here, where a bug occurred, which resulted in an endless loop, causing the app to accidentally send out many requests. I realised this probably after like 2 seconds, shut the app down, fixed the issue, and relaunched the app. I sent a post out using another account, tagging my app's logged in account, the rest is explained in the steps to reproduce section. The documentation for that, states: > If you create a new subscription, the old subscription is deleted. In this case, it didn't seem to be true? Eventually, I also tried calling [DELETE `/api/v1/push/subscription`](https://docs.joinmastodon.org/methods/push/#delete), but symptoms remains. My setup is for a watchOS app. Notifications are relayed using [metatext-apns](https://github.com/metabolist/metatext-apns), which by the looks of it is just a simple relay so that shouldn't be the cause, right? I am very new to this Mastodon/Web Push notifications stuff, so please let me know if you believe it's an issue from my end. Thank you!  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-04-18  Technical details - watchOS 10.2 - Both accounts are on mastodon.social",source-file,"API to subscribe to push notification does not seem to delete previous subscription?  Steps to reproduce the problem 1. [POST `/api/v1/push/subscription`](https://docs.joinmastodon.org/methods/push/#create) many times. (Not sure if many times in a short time matters though, just stating based on what I (accidentally) did) 2. Send a post via another account, tagging the logged in user. 3. Wait for notification to arrive 4. Realised that tons of notifications came flooding in, only one decoded correctly (non unexpected, since my app only saved the latest keys)  Expected behaviour 1 notification with correct contents.  Actual behaviour hundreds? of notifications.  Detailed description Now, I am not entirely sure if the fault is on my end, but I am somewhat confident that it is the API's fault. Please advise if I'm doing something terribly wrong without noticing I am referring to the [POST `/api/v1/push/subscription`](https://docs.joinmastodon.org/methods/push/#create) endpoint. So the story here is that, new (unreleased) app here, where a bug occurred, which resulted in an endless loop, causing the app to accidentally send out many requests. I realised this probably after like 2 seconds, shut the app down, fixed the issue, and relaunched the app. I sent a post out using another account, tagging my app's logged in account, the rest is explained in the steps to reproduce section. The documentation for that, states: > If you create a new subscription, the old subscription is deleted. In this case, it didn't seem to be true? Eventually, I also tried calling [DELETE `/api/v1/push/subscription`](https://docs.joinmastodon.org/methods/push/#delete), but symptoms remains. My setup is for a watchOS app. Notifications are relayed using [metatext-apns](https://github.com/metabolist/metatext-apns), which by the looks of it is just a simple relay so that shouldn't be the cause, right? I am very new to this Mastodon/Web Push notifications stuff, so please let me know if you believe it's an issue from my end. Thank you!  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-04-18  Technical details - watchOS 10.2 - Both accounts are on mastodon.social source-file",bug,0.9
27697,mastodon,https://github.com/mastodon/mastodon/issues/27697,any url returns an empty page if no cookie is previously existant," Steps to reproduce the problem try any page on my instance, like : [https://lepoulsdumonde.com/@nico](nico) or [https://lepoulsdumonde.com/](home) Only a grey window is displayed. the console logs : Uncaught Error: No current user (me) defined when calling `accountsReducer` at accounts (accounts.ts:51:11) But when you already have an existing connection to the server (I guess when you have an existing cookie), everything works fine. For example, on my main browser, firefox 119 on win 11, I can log in and out, get any url because I've been using it with an account for a long time. But if I go to chrome which I never used to access my instance, or on my phone, or if a friend tries to connect to my instance, I get this error, and only a grey empty window is displayed. I don't get any error logs in journalctl. I tried pulling main again, and deleting the packs and cache and recompiling, restarting all services with no success. I'm using the latest nightly main branch from source pull. I don't know when the problem appeared exactly.  Expected behaviour display the web page  Actual behaviour empty window  Detailed description _No response_  Mastodon instance lepoulsdumonde.com  Mastodon version v4.3.0alpha nightly from source  Browser name and version firefox 119, chrome 119  Operating system win 11, ios, win10  Technical details _No response_",source-file | source-file | source-file | source-file,"any url returns an empty page if no cookie is previously existant  Steps to reproduce the problem try any page on my instance, like : [https://lepoulsdumonde.com/@nico](nico) or [https://lepoulsdumonde.com/](home) Only a grey window is displayed. the console logs : Uncaught Error: No current user (me) defined when calling `accountsReducer` at accounts (accounts.ts:51:11) But when you already have an existing connection to the server (I guess when you have an existing cookie), everything works fine. For example, on my main browser, firefox 119 on win 11, I can log in and out, get any url because I've been using it with an account for a long time. But if I go to chrome which I never used to access my instance, or on my phone, or if a friend tries to connect to my instance, I get this error, and only a grey empty window is displayed. I don't get any error logs in journalctl. I tried pulling main again, and deleting the packs and cache and recompiling, restarting all services with no success. I'm using the latest nightly main branch from source pull. I don't know when the problem appeared exactly.  Expected behaviour display the web page  Actual behaviour empty window  Detailed description _No response_  Mastodon instance lepoulsdumonde.com  Mastodon version v4.3.0alpha nightly from source  Browser name and version firefox 119, chrome 119  Operating system win 11, ios, win10  Technical details _No response_ source-file source-file source-file source-file",no-bug,0.8
33296,mastodon,https://github.com/mastodon/mastodon/issues/33296,Odd theming makes interface elements unusable when listening to audio on media page," Steps to reproduce the problem I'm on mastodon.social. I am using light mode. I normally use advanced mode but for purposes of this bug, I am not. I go to [this specific url, the media page](https://mastodon.social/@t36s@social.ordinal.garden/media) for [this user](https://social.ordinal.garden/@t36s). In other words, I'm looking at the page on my home instance mastodon.social not on the user's instance. Notice the user has many audio posts. I click on the photo in the upper right. It is presented in a ""lightbox"", like this. ![Image](https://github.com/user-attachments/assets/23783198-3f9c-442e-811e-23a38fdbf557) Notice the row of buttons along the bottom. I exit the lightbox and click on any of the audio posts. I get this. ![Image](https://github.com/user-attachments/assets/cc405476-eab4-43fc-ace2-f92493bf0183)  Expected behaviour Row of buttons so I can go to original post and such.  Actual behaviour Oh no! Buttons are gone!  Detailed description Actually, the buttons are there, they're just drawn as white-on-white so it's really hard to see them. I fiddled for a couple minutes when I encountered this trying to figure out why the buttons that are normally there were gone. I didn't notice the pale shadow. If you go to Karlsson's home instance and look at the audio posts there, you don't have this problem. This could be because of a different software version, but I think it's because social.ordinal.garden presents dark theme to logged out users. I didn't test but I hypothesize if I switched to dark theme, this problem would go away.  Mastodon instance mastodon.social  Mastodon version v4.4.0-alpha.1+pr-33266-17e66a4  Browser name and version Chrome 131.0.6778.109 Stable 64-bit  Operating system Windows 10  Technical details _No response_",other-file | other-file,"Odd theming makes interface elements unusable when listening to audio on media page  Steps to reproduce the problem I'm on mastodon.social. I am using light mode. I normally use advanced mode but for purposes of this bug, I am not. I go to [this specific url, the media page](https://mastodon.social/@t36s@social.ordinal.garden/media) for [this user](https://social.ordinal.garden/@t36s). In other words, I'm looking at the page on my home instance mastodon.social not on the user's instance. Notice the user has many audio posts. I click on the photo in the upper right. It is presented in a ""lightbox"", like this. ![Image](https://github.com/user-attachments/assets/23783198-3f9c-442e-811e-23a38fdbf557) Notice the row of buttons along the bottom. I exit the lightbox and click on any of the audio posts. I get this. ![Image](https://github.com/user-attachments/assets/cc405476-eab4-43fc-ace2-f92493bf0183)  Expected behaviour Row of buttons so I can go to original post and such.  Actual behaviour Oh no! Buttons are gone!  Detailed description Actually, the buttons are there, they're just drawn as white-on-white so it's really hard to see them. I fiddled for a couple minutes when I encountered this trying to figure out why the buttons that are normally there were gone. I didn't notice the pale shadow. If you go to Karlsson's home instance and look at the audio posts there, you don't have this problem. This could be because of a different software version, but I think it's because social.ordinal.garden presents dark theme to logged out users. I didn't test but I hypothesize if I switched to dark theme, this problem would go away.  Mastodon instance mastodon.social  Mastodon version v4.4.0-alpha.1+pr-33266-17e66a4  Browser name and version Chrome 131.0.6778.109 Stable 64-bit  Operating system Windows 10  Technical details _No response_ other-file other-file",no-bug,0.95
31396,mastodon,https://github.com/mastodon/mastodon/issues/31396,Authorize Interaction padding bug on mobile," Steps to reproduce the problem 1. Open a browser on a iOS device 2. Navigate to a mastodon server 3. Click on the ""Follow"" button or favourite/boost button while not logged in 4. See the modal with no padding  Expected behaviour There should be padding  Actual behaviour There was no padding  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-08-12  Browser name and version Chrome 127.0.6533.100  Operating system macOS 14.4.1  Technical details ![IMG_6349](https://github.com/user-attachments/assets/ae0107c2-8468-4d22-997f-cd899bbdffc7)",other-file | other-file,"Authorize Interaction padding bug on mobile  Steps to reproduce the problem 1. Open a browser on a iOS device 2. Navigate to a mastodon server 3. Click on the ""Follow"" button or favourite/boost button while not logged in 4. See the modal with no padding  Expected behaviour There should be padding  Actual behaviour There was no padding  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-08-12  Browser name and version Chrome 127.0.6533.100  Operating system macOS 14.4.1  Technical details ![IMG_6349](https://github.com/user-attachments/assets/ae0107c2-8468-4d22-997f-cd899bbdffc7) other-file other-file",no-bug,0.95
27175,mastodon,https://github.com/mastodon/mastodon/issues/27175,Links with anchors in them create hashtags, Steps to reproduce the problem Post this: > 21:45 Edinburgh to Perth due 23:06 > Facilities on the 21:45 Edinburgh to Perth due 23:06. > http://www.journeycheck.com/scotrail/route?id=16801062571L71Y30051270923&action=search&from=&to=&savedRoute=&formTubeUpdateType=&formTubeUpdateLocation=Service+Updates&formTubeUpdatePeriod=#16801062571L71Y30051270923  Expected behaviour Post has no hashtags  Actual behaviour Post shows hashtag #16801062571L71Y30051270923 on the bottom  Detailed description Wrote an RSS bot that is pulling links with hashtags in them. The end of the link is parsed as a hashtag ![image](https://github.com/mastodon/mastodon/assets/4095570/22494cbe-375b-4c53-8f31-f7575c43fd66)  Mastodon instance mastodon.scot  Mastodon version v4.2.0  Browser name and version Firefox 118.0  Operating system Linux Mint  Technical details _No response_,source-file | source-file,Links with anchors in them create hashtags  Steps to reproduce the problem Post this: > 21:45 Edinburgh to Perth due 23:06 > Facilities on the 21:45 Edinburgh to Perth due 23:06. > http://www.journeycheck.com/scotrail/route?id=16801062571L71Y30051270923&action=search&from=&to=&savedRoute=&formTubeUpdateType=&formTubeUpdateLocation=Service+Updates&formTubeUpdatePeriod=#16801062571L71Y30051270923  Expected behaviour Post has no hashtags  Actual behaviour Post shows hashtag #16801062571L71Y30051270923 on the bottom  Detailed description Wrote an RSS bot that is pulling links with hashtags in them. The end of the link is parsed as a hashtag ![image](https://github.com/mastodon/mastodon/assets/4095570/22494cbe-375b-4c53-8f31-f7575c43fd66)  Mastodon instance mastodon.scot  Mastodon version v4.2.0  Browser name and version Firefox 118.0  Operating system Linux Mint  Technical details _No response_ source-file source-file,no-bug,0.9
34427,mastodon,https://github.com/mastodon/mastodon/issues/34427,Empty menu section on timeline," Steps to reproduce the problem 1. Open the timeline 2. Click on the  menu on a post  Expected behaviour There are no empty sections  Actual behaviour There is an empty section in the menu  Detailed description <img width=""374"" alt=""Image"" src=""https://github.com/user-attachments/assets/dc87522c-60e6-42a1-a655-a9757e41808c"" />  Mastodon instance oisaur.com  Mastodon version nightly  Browser name and version Latest Safari  Operating system Latest macOS  Technical details Probably related to the recent dropdown refactor?",other-file,"Empty menu section on timeline  Steps to reproduce the problem 1. Open the timeline 2. Click on the  menu on a post  Expected behaviour There are no empty sections  Actual behaviour There is an empty section in the menu  Detailed description <img width=""374"" alt=""Image"" src=""https://github.com/user-attachments/assets/dc87522c-60e6-42a1-a655-a9757e41808c"" />  Mastodon instance oisaur.com  Mastodon version nightly  Browser name and version Latest Safari  Operating system Latest macOS  Technical details Probably related to the recent dropdown refactor? other-file",no-bug,0.9
32186,mastodon,https://github.com/mastodon/mastodon/issues/32186,New Restrictive Form Action CSP breaks OMNIAUTH_ONLY," Steps to reproduce the problem 1. Setup a server with OMNIAUTH_ONLY configured 2. Try clicking the login button on the main webpage  Expected behaviour can get redirected to provider  Actual behaviour get csp error in console  Detailed description i suspect that https://github.com/mastodon/mastodon/pull/26897 broke omniauth_only. the login button on the main page would redirect to https://INSTANCE/auth/auth/openid_connect which then takes you to the oidc provider. this is blocked by the new form-action policy. turning off omniauth_only makes it work as does logging in via /auth/sign_in. I was able to fix this by hardcoding p.form_action in the web app controller concern to be https://INSTANCE/auth/auth/openid_connect . i've reverted the change for now to showcase current behaviour.  Mastodon instance m.fa.gl  Mastodon version v4.3.0-beta.2  Browser name and version Firefox 130, Edge 129  Operating system Windows 11  Technical details CSP error in console: > Refused to send form data to 'https://m.fa.gl/auth/auth/openid_connect' because it violates the following Content Security Policy directive: ""form-action https://auth.home.fa.gl/api/oidc/authorization"".",source-file | source-file,"New Restrictive Form Action CSP breaks OMNIAUTH_ONLY  Steps to reproduce the problem 1. Setup a server with OMNIAUTH_ONLY configured 2. Try clicking the login button on the main webpage  Expected behaviour can get redirected to provider  Actual behaviour get csp error in console  Detailed description i suspect that https://github.com/mastodon/mastodon/pull/26897 broke omniauth_only. the login button on the main page would redirect to https://INSTANCE/auth/auth/openid_connect which then takes you to the oidc provider. this is blocked by the new form-action policy. turning off omniauth_only makes it work as does logging in via /auth/sign_in. I was able to fix this by hardcoding p.form_action in the web app controller concern to be https://INSTANCE/auth/auth/openid_connect . i've reverted the change for now to showcase current behaviour.  Mastodon instance m.fa.gl  Mastodon version v4.3.0-beta.2  Browser name and version Firefox 130, Edge 129  Operating system Windows 11  Technical details CSP error in console: > Refused to send form data to 'https://m.fa.gl/auth/auth/openid_connect' because it violates the following Content Security Policy directive: ""form-action https://auth.home.fa.gl/api/oidc/authorization"". source-file source-file",no-bug,0.85
33742,mastodon,https://github.com/mastodon/mastodon/issues/33742,Streaming API and REST API language filtering is inconsistent," Steps to reproduce the problem 1. select chosen languages in `/settings/preferences/other` 2. open the public timeline 3. observe new posts appearing 4. refresh page  Expected behaviour refreshing the page should result in the same posts  Actual behaviour streaming gets more posts than REST API  Detailed description At first glance, this seems to be due to the language filtering logic being different in the streaming server (`streamFrom` function) and the Ruby server (`PublicFeed#language_scope`): - the streaming code treats posts with an unknown language as acceptable (`payload.language !== null `) - when language filtering is enabled, the Ruby code does not return posts with `language: nil`  Mastodon instance mastodon.social  Mastodon version v4.3.0  Technical details _No response_",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,"Streaming API and REST API language filtering is inconsistent  Steps to reproduce the problem 1. select chosen languages in `/settings/preferences/other` 2. open the public timeline 3. observe new posts appearing 4. refresh page  Expected behaviour refreshing the page should result in the same posts  Actual behaviour streaming gets more posts than REST API  Detailed description At first glance, this seems to be due to the language filtering logic being different in the streaming server (`streamFrom` function) and the Ruby server (`PublicFeed#language_scope`): - the streaming code treats posts with an unknown language as acceptable (`payload.language !== null `) - when language filtering is enabled, the Ruby code does not return posts with `language: nil`  Mastodon instance mastodon.social  Mastodon version v4.3.0  Technical details _No response_ source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file source-file",bug,0.95
29071,mastodon,https://github.com/mastodon/mastodon/issues/29071,"Regression: Suggestion.source is documented as a string, currently returns list of strings"," Steps to reproduce the problem 1. On `mastodon.social`, call [`/api/v2/suggestions`](https://docs.joinmastodon.org/methods/suggestions/#v2) 2. Attempt to decode output as documented, as an array of [`Suggestion`](https://docs.joinmastodon.org/entities/Suggestion/) objects 3. Decoding fails because object has changed from documented format  Expected behaviour `Suggestion.source` should be a string  Actual behaviour `Suggestion.source` is an array of strings  Detailed description I'm not sure when this changed, but it's not documented, or backwards compatible with existing clients. My suggestion for the fix would be to keep `source` as a string, populate it with the first or most important of the possible source strings, deprecate `source`, and return the full list of sources as a new `sources` property on `Suggestion`.  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-02-02  Technical details _No response_",source-file | source-file | source-file | source-file | source-file,"Regression: Suggestion.source is documented as a string, currently returns list of strings  Steps to reproduce the problem 1. On `mastodon.social`, call [`/api/v2/suggestions`](https://docs.joinmastodon.org/methods/suggestions/#v2) 2. Attempt to decode output as documented, as an array of [`Suggestion`](https://docs.joinmastodon.org/entities/Suggestion/) objects 3. Decoding fails because object has changed from documented format  Expected behaviour `Suggestion.source` should be a string  Actual behaviour `Suggestion.source` is an array of strings  Detailed description I'm not sure when this changed, but it's not documented, or backwards compatible with existing clients. My suggestion for the fix would be to keep `source` as a string, populate it with the first or most important of the possible source strings, deprecate `source`, and return the full list of sources as a new `sources` property on `Suggestion`.  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-02-02  Technical details _No response_ source-file source-file source-file source-file source-file",bug,0.95
32294,mastodon,https://github.com/mastodon/mastodon/issues/32294,All Push Notifications in English," Steps to reproduce the problem 1. Using Mastodon Social instance. 2. Device and Instance both set in Spanish 3. The official app has been sending all push notifications in English and not Spanish as usual (since five days).   Expected behaviour All push notifications (phone notifications) should be in Spanish as usual  Actual behaviour All push notifications (phone notifications) are being all received in English since five days.  Detailed description About five days ago push notifications (phone notifications) (using Mastodon official app) are all being received in English. If instance and device are both set in Spanish, and if it has never been any issue, that means that something weird should be happening on someone's side. It's good to say that this is an issue with mastodon.social . It's not that way to other instances.  Mastodon instance mastodon.social  Mastodon version The latest version  Browser name and version Chrome for Android last Playstore versin.  Operating system Android 11  Technical details It's been happening using Mastodon Official app for Android. Have no log.",source-file,"All Push Notifications in English  Steps to reproduce the problem 1. Using Mastodon Social instance. 2. Device and Instance both set in Spanish 3. The official app has been sending all push notifications in English and not Spanish as usual (since five days).   Expected behaviour All push notifications (phone notifications) should be in Spanish as usual  Actual behaviour All push notifications (phone notifications) are being all received in English since five days.  Detailed description About five days ago push notifications (phone notifications) (using Mastodon official app) are all being received in English. If instance and device are both set in Spanish, and if it has never been any issue, that means that something weird should be happening on someone's side. It's good to say that this is an issue with mastodon.social . It's not that way to other instances.  Mastodon instance mastodon.social  Mastodon version The latest version  Browser name and version Chrome for Android last Playstore versin.  Operating system Android 11  Technical details It's been happening using Mastodon Official app for Android. Have no log. source-file",no-bug,0.7
28330,mastodon,https://github.com/mastodon/mastodon/issues/28330,"The text about ""follows from other servers"" is cropped and difficult to read in some cases"," Steps to reproduce the problem 1.Create view that news are in columns (Home, Local timeline and Federated timeline) 2. Open https://pol.social/deck/@linuxmagazine@fosstodon.org/following in fourth column and take a look on right down corner: ![image](https://github.com/mastodon/mastodon/assets/26818304/283959fb-acc9-4ab1-b661-d1ca03326686)  Expected behaviour Correct displaying of text  Actual behaviour The text is cropped and difficult to read  Detailed description Text `Follows from other servers are not displayed.` is cropped when profile has many informations on element `#mastodon > div > div > div.columns-area > div:nth-child(5) > div > div.account-timeline__header > div > div.account__header__bar` Element where text is cropped: `<div class=""empty-column-indicator""><div class=""timeline-hint""><strong><span><span>Follows</span> from other servers are not displayed.</span></strong><br><a href=""https://fosstodon.org/@linuxmagazine"" target=""_blank"" rel=""noopener noreferrer""><span>Browse more on the original profile</span></a></div></div>` Selector: `#mastodon > div > div > div.columns-area > div:nth-child(5) > div > div.empty-column-indicator`  Mastodon instance pol.social  Mastodon version v4.2.0  Browser name and version Microsoft Edge Version 120.0.2210.61 (Official build) (64-bit)  Operating system OS Name Microsoft Windows 10 Enterprise  Technical details _No response_",other-file,"The text about ""follows from other servers"" is cropped and difficult to read in some cases  Steps to reproduce the problem 1.Create view that news are in columns (Home, Local timeline and Federated timeline) 2. Open https://pol.social/deck/@linuxmagazine@fosstodon.org/following in fourth column and take a look on right down corner: ![image](https://github.com/mastodon/mastodon/assets/26818304/283959fb-acc9-4ab1-b661-d1ca03326686)  Expected behaviour Correct displaying of text  Actual behaviour The text is cropped and difficult to read  Detailed description Text `Follows from other servers are not displayed.` is cropped when profile has many informations on element `#mastodon > div > div > div.columns-area > div:nth-child(5) > div > div.account-timeline__header > div > div.account__header__bar` Element where text is cropped: `<div class=""empty-column-indicator""><div class=""timeline-hint""><strong><span><span>Follows</span> from other servers are not displayed.</span></strong><br><a href=""https://fosstodon.org/@linuxmagazine"" target=""_blank"" rel=""noopener noreferrer""><span>Browse more on the original profile</span></a></div></div>` Selector: `#mastodon > div > div > div.columns-area > div:nth-child(5) > div > div.empty-column-indicator`  Mastodon instance pol.social  Mastodon version v4.2.0  Browser name and version Microsoft Edge Version 120.0.2210.61 (Official build) (64-bit)  Operating system OS Name Microsoft Windows 10 Enterprise  Technical details _No response_ other-file",no-bug,0.95
32382,mastodon,https://github.com/mastodon/mastodon/issues/32382,"""Suppress follow recommendation"" keeps user in both Active and Suppressed lists. Error page when suppressing same user again."," Steps to reproduce the problem 1. Navigate to ""Follow recommendations"" moderation page. 2. Suppress a recommended user 3. Select the ""Suppressed"" filter to see the user is listed 4. Select the ""Active"" filter to see the user is also still listed there 5. Suppress the same user again  Expected behaviour When suppressing a user, the user is listed in both Active and Suppressed lists. Supressing the user a second time displays an error page.  Actual behaviour Suppressed user is no longer listed on the Active page. Supressing a user a second time (eg. if two tabs are open) behaves the same as suppressing it once.  Detailed description _No response_  Mastodon instance sunny.garden  Mastodon version v4.3.0  Browser name and version Firefox 131.0.2  Operating system Microsoft Windows [Version 10.0.19045.4894]  Technical details _No response_",source-file | source-file,"""Suppress follow recommendation"" keeps user in both Active and Suppressed lists. Error page when suppressing same user again.  Steps to reproduce the problem 1. Navigate to ""Follow recommendations"" moderation page. 2. Suppress a recommended user 3. Select the ""Suppressed"" filter to see the user is listed 4. Select the ""Active"" filter to see the user is also still listed there 5. Suppress the same user again  Expected behaviour When suppressing a user, the user is listed in both Active and Suppressed lists. Supressing the user a second time displays an error page.  Actual behaviour Suppressed user is no longer listed on the Active page. Supressing a user a second time (eg. if two tabs are open) behaves the same as suppressing it once.  Detailed description _No response_  Mastodon instance sunny.garden  Mastodon version v4.3.0  Browser name and version Firefox 131.0.2  Operating system Microsoft Windows [Version 10.0.19045.4894]  Technical details _No response_ source-file source-file",no-bug,0.8
28258,mastodon,https://github.com/mastodon/mastodon/issues/28258,Status edits are not sent to streaming clients if they do not appear in a subscribed feed, Steps to reproduce the problem 1. Send a status with direct visibility to a user who doesn't follow you 2. Edit the sent status 3. The recipient does not see the status edit unless they refresh  Expected behaviour The recipient should have received the edited status  Actual behaviour The recipient does not see the status edit unless they refresh  Detailed description _No response_  Mastodon instance _No response_  Mastodon version v4.2.3  Technical details - Ruby version: 3.2.2 - Node.js version: v20.6.1,source-file | source-file,Status edits are not sent to streaming clients if they do not appear in a subscribed feed  Steps to reproduce the problem 1. Send a status with direct visibility to a user who doesn't follow you 2. Edit the sent status 3. The recipient does not see the status edit unless they refresh  Expected behaviour The recipient should have received the edited status  Actual behaviour The recipient does not see the status edit unless they refresh  Detailed description _No response_  Mastodon instance _No response_  Mastodon version v4.2.3  Technical details - Ruby version: 3.2.2 - Node.js version: v20.6.1 source-file source-file,bug,0.85
31084,mastodon,https://github.com/mastodon/mastodon/issues/31084,"Mastodon rejects multiple rel=self links in webfinger, breaching webfinger spec"," Steps to reproduce the problem 1. implement webfinger endpoint with multiple ``rel: self`` entries in the ``links`` array, but using different ``type``s (example: application/json & application/activity+json) 2. query it using mastodon (for example @aprl@social.lysand.org), see that the user isnt resolved 3. query webfinger yourself, and see that there are multiple rel tags indeed (for example: https://social.lysand.org/.well-known/webfinger?resource=acct:aprl@social.lysand.org )  Expected behaviour Mastodon picks rel=self with type=application/activity+json  Actual behaviour mastodon shits itself  Detailed description This is valid, in spec webfinger, and thus every other fedi server for example akkoma and misskey support such webfinger, but mastodon discards it as invalid for some reason. I did not find the place in code yet but this issue has been around for a long time but never got fixed. Afaik this breaches webfinger spec because the spec never mentions there only being one rel=self tag. it instead should scan for a rel=self & type=application/activity+json tag  Mastodon instance any  Mastodon version v4.2.10  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.1.2) - Node.js version: (from `node --version`, eg. v18.16.0)",source-file | source-file | source-file | other-file,"Mastodon rejects multiple rel=self links in webfinger, breaching webfinger spec  Steps to reproduce the problem 1. implement webfinger endpoint with multiple ``rel: self`` entries in the ``links`` array, but using different ``type``s (example: application/json & application/activity+json) 2. query it using mastodon (for example @aprl@social.lysand.org), see that the user isnt resolved 3. query webfinger yourself, and see that there are multiple rel tags indeed (for example: https://social.lysand.org/.well-known/webfinger?resource=acct:aprl@social.lysand.org )  Expected behaviour Mastodon picks rel=self with type=application/activity+json  Actual behaviour mastodon shits itself  Detailed description This is valid, in spec webfinger, and thus every other fedi server for example akkoma and misskey support such webfinger, but mastodon discards it as invalid for some reason. I did not find the place in code yet but this issue has been around for a long time but never got fixed. Afaik this breaches webfinger spec because the spec never mentions there only being one rel=self tag. it instead should scan for a rel=self & type=application/activity+json tag  Mastodon instance any  Mastodon version v4.2.10  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.1.2) - Node.js version: (from `node --version`, eg. v18.16.0) source-file source-file source-file other-file",no-bug,0.9
32820,mastodon,https://github.com/mastodon/mastodon/issues/32820,Spelling error in EN settings," Steps to reproduce the problem Minor Open Preferences Click Public Profile Click Privacy and Reach ![Image](https://github.com/user-attachments/assets/b7dc4243-774e-4161-a5ba-ce260d5da526)  Expected behaviour ""choose""  Actual behaviour ""chose""  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.4.0-nightly.2024-11-06  Browser name and version firefox  Operating system lunix  Technical details _No response_",config-file,"Spelling error in EN settings  Steps to reproduce the problem Minor Open Preferences Click Public Profile Click Privacy and Reach ![Image](https://github.com/user-attachments/assets/b7dc4243-774e-4161-a5ba-ce260d5da526)  Expected behaviour ""choose""  Actual behaviour ""chose""  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.4.0-nightly.2024-11-06  Browser name and version firefox  Operating system lunix  Technical details _No response_ config-file",no-bug,0.95
29697,mastodon,https://github.com/mastodon/mastodon/issues/29697,Notification message padding," Steps to reproduce the problem 1. Deny notifications 2. Open the notification menu 3. Look at the message Desktop notifications are unavailable due to previously denied browser permissions request  Expected behaviour The message should look well integrated in the menu  Actual behaviour The message looks non-integrated in the menu, at least because of missing padding  Detailed description <img width=""623"" alt=""Screenshot 2024-03-21 at 16 10 10"" src=""https://github.com/mastodon/mastodon/assets/923008/f6ae3b2e-1134-486d-934a-929a6bdd9e59"">  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-03-19  Browser name and version n/a  Operating system n/a  Technical details _No response_",other-file,"Notification message padding  Steps to reproduce the problem 1. Deny notifications 2. Open the notification menu 3. Look at the message Desktop notifications are unavailable due to previously denied browser permissions request  Expected behaviour The message should look well integrated in the menu  Actual behaviour The message looks non-integrated in the menu, at least because of missing padding  Detailed description <img width=""623"" alt=""Screenshot 2024-03-21 at 16 10 10"" src=""https://github.com/mastodon/mastodon/assets/923008/f6ae3b2e-1134-486d-934a-929a6bdd9e59"">  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-03-19  Browser name and version n/a  Operating system n/a  Technical details _No response_ other-file",no-bug,0.95
33793,mastodon,https://github.com/mastodon/mastodon/issues/33793,Expose URLs of privacy policy and TOS via API," Pitch Allow 3rd party clients to get the URLs of an instances privacy policy, terms of service (if defined), and (maybe?) About page. The `configuration.urls` object in `/api/v2/instance` seems like a reasonable place to put this since it already contains the URL of the instances status page. Something like: json ""configuration"": { ""urls"": { ""streaming"": ""wss://streaming.mastodon.social"", ""status"": ""https://status.mastodon.social"", ""about"": ""https://mastodon.social/about"", ""privacy_policy"": ""https://mastodon.social/privacy-policy"", ""tos"": ""https://mastodon.social/terms"" }   That would allow clients to link to these pages or present them in a web view. The ability to actually get the content via an API endpoint (like we already can for the About page using `api/v1/instance/extended_description`) might also be nice, but isnt as necessary.  Motivation Especially for clients that offer account creation, the client must be able to present the instance's privacy policy and terms of service (if present) to the user. Currently, I dont believe there is a way for the client to obtain these URLs other than hard-coding the relative paths, which will break if they ever change, and requires clients to maintain a list of up-to-date paths for every Mastodon-API-compatible server software.",source-file,"Expose URLs of privacy policy and TOS via API  Pitch Allow 3rd party clients to get the URLs of an instances privacy policy, terms of service (if defined), and (maybe?) About page. The `configuration.urls` object in `/api/v2/instance` seems like a reasonable place to put this since it already contains the URL of the instances status page. Something like: json ""configuration"": { ""urls"": { ""streaming"": ""wss://streaming.mastodon.social"", ""status"": ""https://status.mastodon.social"", ""about"": ""https://mastodon.social/about"", ""privacy_policy"": ""https://mastodon.social/privacy-policy"", ""tos"": ""https://mastodon.social/terms"" }   That would allow clients to link to these pages or present them in a web view. The ability to actually get the content via an API endpoint (like we already can for the About page using `api/v1/instance/extended_description`) might also be nice, but isnt as necessary.  Motivation Especially for clients that offer account creation, the client must be able to present the instance's privacy policy and terms of service (if present) to the user. Currently, I dont believe there is a way for the client to obtain these URLs other than hard-coding the relative paths, which will break if they ever change, and requires clients to maintain a list of up-to-date paths for every Mastodon-API-compatible server software. source-file",no-bug,0.9
32993,mastodon,https://github.com/mastodon/mastodon/issues/32993,Duplicate notifications in notification groups in slow mode, Steps to reproduce the problem 1. Enable slow mode 2. Get some notifications in a group that is already displayed 3. Load the pending notifications  Expected behaviour Older notifications are not re-added to the group  Actual behaviour Loading pending notifications causes already-loaded notifications to be duplicated  Detailed description This is because the logic in the following code does not distinguish between old and new notifications: https://github.com/mastodon/mastodon/blob/174c687ca0234285fac87d47196bbf0b1b606c33/app/javascript/mastodon/reducers/notification_groups.ts#L534-L543  Mastodon instance any  Mastodon version v4.3.1  Browser name and version any  Operating system any  Technical details _No response_,source-file | source-file,Duplicate notifications in notification groups in slow mode  Steps to reproduce the problem 1. Enable slow mode 2. Get some notifications in a group that is already displayed 3. Load the pending notifications  Expected behaviour Older notifications are not re-added to the group  Actual behaviour Loading pending notifications causes already-loaded notifications to be duplicated  Detailed description This is because the logic in the following code does not distinguish between old and new notifications: https://github.com/mastodon/mastodon/blob/174c687ca0234285fac87d47196bbf0b1b606c33/app/javascript/mastodon/reducers/notification_groups.ts#L534-L543  Mastodon instance any  Mastodon version v4.3.1  Browser name and version any  Operating system any  Technical details _No response_ source-file source-file,no-bug,0.9
30039,mastodon,https://github.com/mastodon/mastodon/issues/30039,Idempotency-Key ignored when scheduling a post," Steps to reproduce the problem Make multiple requests to schedule a post to `POST /api/v1/statuses`, e.g. with this body `{""status"":""Test"",""spoiler_text"":"""",""visibility"":""private"",""sensitive"":false,""media_ids"":[],""media_attributes"":[],""scheduled_at"":""2024-04-24T14:59:42.868Z"",""language"":""en""}` and with the same `Idempotency-Key` header.  Expected behaviour There is one scheduled status created because the Idempotency-Key was the same.  Actual behaviour Multiple scheduled statuses were created  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version 4.3.0-nightly.2024-04-18  Technical details _No response_",source-file | source-file,"Idempotency-Key ignored when scheduling a post  Steps to reproduce the problem Make multiple requests to schedule a post to `POST /api/v1/statuses`, e.g. with this body `{""status"":""Test"",""spoiler_text"":"""",""visibility"":""private"",""sensitive"":false,""media_ids"":[],""media_attributes"":[],""scheduled_at"":""2024-04-24T14:59:42.868Z"",""language"":""en""}` and with the same `Idempotency-Key` header.  Expected behaviour There is one scheduled status created because the Idempotency-Key was the same.  Actual behaviour Multiple scheduled statuses were created  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version 4.3.0-nightly.2024-04-18  Technical details _No response_ source-file source-file",bug,0.95
32595,mastodon,https://github.com/mastodon/mastodon/issues/32595,"Media from a server limited with ""reject media files"" no longer shows as ""Preview not available"""," Steps to reproduce the problem 1. Limit a server with ""reject media files"" 2. Follow someone from that server, User A 3. User A posts with a single image and it shows up on your followed timeline  Expected behaviour The media is not downloaded, but it shows that there's media on the post, a ""Preview not available"" and a link to the original media  Actual behaviour The post shows as if there was no media attached  Detailed description I noticed recently that new posts from users of a server with rejected media does not show as ""preview not available"" anymore. There's no indication that the post had media in the first place and the only way to find out is if you go to the original post.  Mastodon instance masto.donte.com.br  Mastodon version v4.3.0+donte  Browser name and version Chromium Version 129.0.6668.58 (Official Build, ungoogled-chromium) Arch Linux (64-bit)  Operating system Linux  Technical details There's no errors on the rails logs or on the console logs.",other-file | other-file | other-file,"Media from a server limited with ""reject media files"" no longer shows as ""Preview not available""  Steps to reproduce the problem 1. Limit a server with ""reject media files"" 2. Follow someone from that server, User A 3. User A posts with a single image and it shows up on your followed timeline  Expected behaviour The media is not downloaded, but it shows that there's media on the post, a ""Preview not available"" and a link to the original media  Actual behaviour The post shows as if there was no media attached  Detailed description I noticed recently that new posts from users of a server with rejected media does not show as ""preview not available"" anymore. There's no indication that the post had media in the first place and the only way to find out is if you go to the original post.  Mastodon instance masto.donte.com.br  Mastodon version v4.3.0+donte  Browser name and version Chromium Version 129.0.6668.58 (Official Build, ungoogled-chromium) Arch Linux (64-bit)  Operating system Linux  Technical details There's no errors on the rails logs or on the console logs. other-file other-file other-file",no-bug,0.7
31976,mastodon,https://github.com/mastodon/mastodon/issues/31976,Text is overlapping in hashtag moderation view for status in French, Steps to reproduce the problem 1. Go to `admin/tags/` 2. Select any tag ![image](https://github.com/user-attachments/assets/685db191-2e96-4132-a667-a16abe47676e)  Expected behaviour Text is displayed on 1 line  Actual behaviour Text is displayed on 2 lines and overlapping next block  Detailed description Text for status of hashtag moderation is overlapping the next line because it is displayed on 2 lines.  Mastodon instance social.coukaratcha.fr  Mastodon version v4.3.0-beta.2  Browser name and version Firefox 130.0.1 (64 bits)  Operating system Windows 11  Technical details _No response_,other-file,Text is overlapping in hashtag moderation view for status in French  Steps to reproduce the problem 1. Go to `admin/tags/` 2. Select any tag ![image](https://github.com/user-attachments/assets/685db191-2e96-4132-a667-a16abe47676e)  Expected behaviour Text is displayed on 1 line  Actual behaviour Text is displayed on 2 lines and overlapping next block  Detailed description Text for status of hashtag moderation is overlapping the next line because it is displayed on 2 lines.  Mastodon instance social.coukaratcha.fr  Mastodon version v4.3.0-beta.2  Browser name and version Firefox 130.0.1 (64 bits)  Operating system Windows 11  Technical details _No response_ other-file,no-bug,0.95
27230,mastodon,https://github.com/mastodon/mastodon/issues/27230,LinkCrawlWorker does not handle non-UTF8 charsets," Steps to reproduce the problem 1. Post or receive a status with https://www.worldconcerthall.com/en/schedule/herrmann_korngold_with_lamsma_wagner_and_kodaly_from_rotterdam/77834/ in it  Expected behaviour The `LinkCrawlWorker` will fetch the URL properly  Actual behaviour The `LinkCrawlWorker` crashes with ""ArgumentError: invalid byte sequence in UTF-8""  Detailed description When looking at the above URL, the headers indicate `content-type: text/html; charset=ISO-8859-1`, a non-UTF8 charset. We have around hundreds of these dead workers littering the dead worker queue, and nearly every one of them failed in this similar fashion. I think it's a fixable problem, so i'm reporting it here.  Mastodon instance tech.lgbt  Mastodon version v4.2.0-rc2+glitch  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.0.2p107 (2021-07-07 revision 0db68f0233) [x86_64-linux-gnu] - Node.js version: v18.12.1",source-file | other-file | source-file,"LinkCrawlWorker does not handle non-UTF8 charsets  Steps to reproduce the problem 1. Post or receive a status with https://www.worldconcerthall.com/en/schedule/herrmann_korngold_with_lamsma_wagner_and_kodaly_from_rotterdam/77834/ in it  Expected behaviour The `LinkCrawlWorker` will fetch the URL properly  Actual behaviour The `LinkCrawlWorker` crashes with ""ArgumentError: invalid byte sequence in UTF-8""  Detailed description When looking at the above URL, the headers indicate `content-type: text/html; charset=ISO-8859-1`, a non-UTF8 charset. We have around hundreds of these dead workers littering the dead worker queue, and nearly every one of them failed in this similar fashion. I think it's a fixable problem, so i'm reporting it here.  Mastodon instance tech.lgbt  Mastodon version v4.2.0-rc2+glitch  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.0.2p107 (2021-07-07 revision 0db68f0233) [x86_64-linux-gnu] - Node.js version: v18.12.1 source-file other-file source-file",no-bug,0.8
30066,mastodon,https://github.com/mastodon/mastodon/issues/30066,Error: `422 can't verify CSRF token authenticity` on explore page," Steps to reproduce the problem 1. Visit typo.social/explore 2. Scroll down 3. See error: ![Screenshot_20240425-110837](https://github.com/mastodon/mastodon/assets/3739866/282a3222-78ea-424b-af98-9fc3ec97bbe4) On desktop (Windows, Firefox) no error is produced, but scrolling stops at the same point, suggesting to me that the error occurs but is not communicated.  Expected behaviour No error  Actual behaviour Error (and then no additional posts will load)  Detailed description Also reported here: - https://www.reddit.com/r/Mastodon/comments/18fmda5/422_cant_verify_csrf_token_authenticity/?rdt=43597 - https://mementomori.social/@rolle/110802929745486086 - Possible duplicate of https://github.com/mastodon/mastodon/issues/1236 (I can't tell)  Mastodon instance typo.social  Mastodon version v4.2.8  Browser name and version Firefox on Android, 124.2.0 (Build #2016012559), 7a0e399c7b+ GV: 124.0.2-20240401114208 AS: 124.0 2024-04-01T17:18:00.821594648  Operating system Android 13  Technical details _No response_",source-file | source-file | source-file | source-file | source-file,"Error: `422 can't verify CSRF token authenticity` on explore page  Steps to reproduce the problem 1. Visit typo.social/explore 2. Scroll down 3. See error: ![Screenshot_20240425-110837](https://github.com/mastodon/mastodon/assets/3739866/282a3222-78ea-424b-af98-9fc3ec97bbe4) On desktop (Windows, Firefox) no error is produced, but scrolling stops at the same point, suggesting to me that the error occurs but is not communicated.  Expected behaviour No error  Actual behaviour Error (and then no additional posts will load)  Detailed description Also reported here: - https://www.reddit.com/r/Mastodon/comments/18fmda5/422_cant_verify_csrf_token_authenticity/?rdt=43597 - https://mementomori.social/@rolle/110802929745486086 - Possible duplicate of https://github.com/mastodon/mastodon/issues/1236 (I can't tell)  Mastodon instance typo.social  Mastodon version v4.2.8  Browser name and version Firefox on Android, 124.2.0 (Build #2016012559), 7a0e399c7b+ GV: 124.0.2-20240401114208 AS: 124.0 2024-04-01T17:18:00.821594648  Operating system Android 13  Technical details _No response_ source-file source-file source-file source-file source-file",no-bug,0.8
31736,mastodon,https://github.com/mastodon/mastodon/issues/31736,Allow OAuth revoke through CORS (to be symmetric with OAuth obtain)," Steps to reproduce the problem The [Obtain a token](https://docs.joinmastodon.org/methods/oauth/#token) endpoint is available to browser clients via CORS requests but the [Revoke a token](https://docs.joinmastodon.org/methods/oauth/#revoke) endpoint is not Please add the CORS headers to revoke, as it is the flip side of obtain and needed for browser-only clients. Thanks!  Expected behaviour The revoke endpoint should have been available over CORS  Actual behaviour The revoke endpoint was not available over CORS  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-09-03  Technical details _No response_",source-file,"Allow OAuth revoke through CORS (to be symmetric with OAuth obtain)  Steps to reproduce the problem The [Obtain a token](https://docs.joinmastodon.org/methods/oauth/#token) endpoint is available to browser clients via CORS requests but the [Revoke a token](https://docs.joinmastodon.org/methods/oauth/#revoke) endpoint is not Please add the CORS headers to revoke, as it is the flip side of obtain and needed for browser-only clients. Thanks!  Expected behaviour The revoke endpoint should have been available over CORS  Actual behaviour The revoke endpoint was not available over CORS  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-09-03  Technical details _No response_ source-file",no-bug,0.9
32316,mastodon,https://github.com/mastodon/mastodon/issues/32316,Advanced web interface is slightly too wide for common screen resolution (1080p)," Pitch When using the advanced web interface with five columns  e.g. compose / search (the drawer, IIUC?), home, notifications, local timeline, and focused post / getting started  the resulting interface is 1950px wide, which is just slightly more than the 1920px width you get with some common screen resolutions (1920x1080, or 3840x2160 at 200% zoom). I think it would be reasonable to reduce the width a bit, e.g. by shaving 30px off the first column: css .drawer { max-width: 320px; /* instead of 350px; .column has 400px btw */ }   Motivation This would avoid a distracting horizontal scrollbar (and visual truncation at the right edge) for users using a common screen resolution.",other-file,"Advanced web interface is slightly too wide for common screen resolution (1080p)  Pitch When using the advanced web interface with five columns  e.g. compose / search (the drawer, IIUC?), home, notifications, local timeline, and focused post / getting started  the resulting interface is 1950px wide, which is just slightly more than the 1920px width you get with some common screen resolutions (1920x1080, or 3840x2160 at 200% zoom). I think it would be reasonable to reduce the width a bit, e.g. by shaving 30px off the first column: css .drawer { max-width: 320px; /* instead of 350px; .column has 400px btw */ }   Motivation This would avoid a distracting horizontal scrollbar (and visual truncation at the right edge) for users using a common screen resolution. other-file",no-bug,0.95
28234,mastodon,https://github.com/mastodon/mastodon/issues/28234,`LinkDetailsExtractor#language` chokes on an Array language type,"This is mostly a reproducibility report for another certain bug that'll cause `LinkCrawlWorker`s to pile up in the dead queue. Given a status which contains any of the following links; - https://nos.nl/l/2500401 - https://nos.nl/artikel/2500401-d66-kamerlid-van-weyenberg-volgt-uslu-op-als-staatssecretaris-van-cultuur It'll eventually crash a `LinkCrawlWorker` with the following error; `NoMethodError: undefined method 'to_sym' for [{""@type""=>""Language"", ""name""=>""Dutch""}]:Array` Because of the following backtrace; <details> <summary>Backtrace</summary>  app/helpers/languages_helper.rb:294:in `valid_locale?' app/helpers/languages_helper.rb:275:in `valid_locale_or_nil' app/lib/link_details_extractor.rb:202:in `language' app/lib/link_details_extractor.rb:128:in `to_preview_card_attributes' app/services/fetch_link_card_service.rb:152:in `attempt_opengraph' app/services/fetch_link_card_service.rb:42:in `process_url' app/services/fetch_link_card_service.rb:28:in `block in call' app/models/concerns/lockable.rb:12:in `block (2 levels) in with_redis_lock' vendor/bundle/ruby/3.0.0/gems/mario-redis-lock-1.2.1/lib/redis_lock.rb:44:in `acquire' app/models/concerns/lockable.rb:10:in `block in with_redis_lock' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:110:in `block (2 levels) in with' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:109:in `handle_interrupt' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:109:in `block in with' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:106:in `handle_interrupt' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:106:in `with' app/lib/redis_configuration.rb:10:in `with' app/models/concerns/redisable.rb:9:in `with_redis' app/models/concerns/lockable.rb:9:in `with_redis_lock' app/services/fetch_link_card_service.rb:26:in `call' app/workers/link_crawl_worker.rb:9:in `perform' (irb):134:in `<main>'  </details> Because the following line allows it to go through without conversion; https://github.com/mastodon/mastodon/blob/89a8e6e6227eb901b5811d8417d81dc8ab1427a9/app/lib/link_details_extractor.rb#L40",source-file | source-file,"`LinkDetailsExtractor#language` chokes on an Array language type This is mostly a reproducibility report for another certain bug that'll cause `LinkCrawlWorker`s to pile up in the dead queue. Given a status which contains any of the following links; - https://nos.nl/l/2500401 - https://nos.nl/artikel/2500401-d66-kamerlid-van-weyenberg-volgt-uslu-op-als-staatssecretaris-van-cultuur It'll eventually crash a `LinkCrawlWorker` with the following error; `NoMethodError: undefined method 'to_sym' for [{""@type""=>""Language"", ""name""=>""Dutch""}]:Array` Because of the following backtrace; <details> <summary>Backtrace</summary>  app/helpers/languages_helper.rb:294:in `valid_locale?' app/helpers/languages_helper.rb:275:in `valid_locale_or_nil' app/lib/link_details_extractor.rb:202:in `language' app/lib/link_details_extractor.rb:128:in `to_preview_card_attributes' app/services/fetch_link_card_service.rb:152:in `attempt_opengraph' app/services/fetch_link_card_service.rb:42:in `process_url' app/services/fetch_link_card_service.rb:28:in `block in call' app/models/concerns/lockable.rb:12:in `block (2 levels) in with_redis_lock' vendor/bundle/ruby/3.0.0/gems/mario-redis-lock-1.2.1/lib/redis_lock.rb:44:in `acquire' app/models/concerns/lockable.rb:10:in `block in with_redis_lock' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:110:in `block (2 levels) in with' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:109:in `handle_interrupt' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:109:in `block in with' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:106:in `handle_interrupt' vendor/bundle/ruby/3.0.0/gems/connection_pool-2.4.1/lib/connection_pool.rb:106:in `with' app/lib/redis_configuration.rb:10:in `with' app/models/concerns/redisable.rb:9:in `with_redis' app/models/concerns/lockable.rb:9:in `with_redis_lock' app/services/fetch_link_card_service.rb:26:in `call' app/workers/link_crawl_worker.rb:9:in `perform' (irb):134:in `<main>'  </details> Because the following line allows it to go through without conversion; https://github.com/mastodon/mastodon/blob/89a8e6e6227eb901b5811d8417d81dc8ab1427a9/app/lib/link_details_extractor.rb#L40 source-file source-file",no-bug,0.9
28455,mastodon,https://github.com/mastodon/mastodon/issues/28455,The summary for converted ActivityPub objects must be treated as html according to the ActivityStreams specification," Steps to reproduce the problem 1. Retrieve a non-note object like an `Event` from with a HTML summary. 2. The resulting post will not be rendered/converted as HTML but as plain text.  Expected behaviour The summary should be treated as HTML by default.  Actual behaviour The summary is treated as plain text. The following Screenshot shows what a event received from Gancio then looks like. ![Screenshot_from_2023-12-20_01-20-36](https://github.com/mastodon/mastodon/assets/99024746/d9472d8a-2e0c-4648-b1e5-574428110565)  Detailed description The feature introduced in https://github.com/mastodon/mastodon/pull/9823 is basically a great one, without Mastodon implementing custom renderings for ActivityPub objects like `Event` it has basic support for them. The actual convertion likely takes place here: https://github.com/mastodon/mastodon/blob/2463b53363a621c1e18223bda5c47a663707a22c/app/lib/activitypub/activity/create.rb#L371-L373. The [ActivityStreams vocabulary specification](https://www.w3.org/TR/activitystreams-vocabulary/#dfn-summary) states that > **Summary**: A natural language summarization of the object encoded as HTML. This will cause interoperability issues with future Gancio, Mobilizon and WordPress ActivityPub releases. Altough the ActivityPub spec does not mention it, one might also think of accepting custom `MediaType` for the summary, to handle both plain/text and HTML summaries. See https://framagit.org/les/gancio/-/issues/321#note_2038846  Mastodon instance All  Mastodon version Since https://github.com/mastodon/mastodon/pull/9823  Technical details _No response_",source-file | source-file,"The summary for converted ActivityPub objects must be treated as html according to the ActivityStreams specification  Steps to reproduce the problem 1. Retrieve a non-note object like an `Event` from with a HTML summary. 2. The resulting post will not be rendered/converted as HTML but as plain text.  Expected behaviour The summary should be treated as HTML by default.  Actual behaviour The summary is treated as plain text. The following Screenshot shows what a event received from Gancio then looks like. ![Screenshot_from_2023-12-20_01-20-36](https://github.com/mastodon/mastodon/assets/99024746/d9472d8a-2e0c-4648-b1e5-574428110565)  Detailed description The feature introduced in https://github.com/mastodon/mastodon/pull/9823 is basically a great one, without Mastodon implementing custom renderings for ActivityPub objects like `Event` it has basic support for them. The actual convertion likely takes place here: https://github.com/mastodon/mastodon/blob/2463b53363a621c1e18223bda5c47a663707a22c/app/lib/activitypub/activity/create.rb#L371-L373. The [ActivityStreams vocabulary specification](https://www.w3.org/TR/activitystreams-vocabulary/#dfn-summary) states that > **Summary**: A natural language summarization of the object encoded as HTML. This will cause interoperability issues with future Gancio, Mobilizon and WordPress ActivityPub releases. Altough the ActivityPub spec does not mention it, one might also think of accepting custom `MediaType` for the summary, to handle both plain/text and HTML summaries. See https://framagit.org/les/gancio/-/issues/321#note_2038846  Mastodon instance All  Mastodon version Since https://github.com/mastodon/mastodon/pull/9823  Technical details _No response_ source-file source-file",bug,0.9
32371,mastodon,https://github.com/mastodon/mastodon/issues/32371,No apparent way to see mute durations in revised web interface 4.3.0," Steps to reproduce the problem 1. Give someone a timed mute 2. Navigate to list of muted users via """" ""muted users""  Expected behaviour A list of muted users complete with remaining mute duration should appear  Actual behaviour No distinction is made between the users muted for a limited time and those muted indefinitely.  Detailed description IIRC in the previous version the ""plain"" interface used to show remaining mute duration as well as presenting the option to unmute. The ""deck"" view didn't show duration due to space constraints. Now neither show them nor are the durations or end date shown on the individual profiles so you have to have a really good memory or a third party app.  Mastodon instance en.osm.towm  Mastodon version v4.3.0  Browser name and version 131.0 (64-bit)  Operating system Windows 11  Technical details _No response_",source-file | source-file | source-file | source-file | source-file | source-file,"No apparent way to see mute durations in revised web interface 4.3.0  Steps to reproduce the problem 1. Give someone a timed mute 2. Navigate to list of muted users via """" ""muted users""  Expected behaviour A list of muted users complete with remaining mute duration should appear  Actual behaviour No distinction is made between the users muted for a limited time and those muted indefinitely.  Detailed description IIRC in the previous version the ""plain"" interface used to show remaining mute duration as well as presenting the option to unmute. The ""deck"" view didn't show duration due to space constraints. Now neither show them nor are the durations or end date shown on the individual profiles so you have to have a really good memory or a third party app.  Mastodon instance en.osm.towm  Mastodon version v4.3.0  Browser name and version 131.0 (64-bit)  Operating system Windows 11  Technical details _No response_ source-file source-file source-file source-file source-file source-file",no-bug,0.9
32540,mastodon,https://github.com/mastodon/mastodon/issues/32540,Streaming healthcheck doesn't send headers to prevent caching," Steps to reproduce the problem Request to the streaming health check shouldn't be cached by intermediaries  Expected behaviour Responses have appropriate cache control headers  Actual behaviour They don't  Detailed description Ask @ThisIsMissEm  Mastodon instance _No response_  Mastodon version _No response_  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.3.5) - Node.js version: (from `node --version`, eg. v20.18.0)",source-file | source-file,"Streaming healthcheck doesn't send headers to prevent caching  Steps to reproduce the problem Request to the streaming health check shouldn't be cached by intermediaries  Expected behaviour Responses have appropriate cache control headers  Actual behaviour They don't  Detailed description Ask @ThisIsMissEm  Mastodon instance _No response_  Mastodon version _No response_  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.3.5) - Node.js version: (from `node --version`, eg. v20.18.0) source-file source-file",bug,0.9
31987,mastodon,https://github.com/mastodon/mastodon/issues/31987,sidekiq: FeedInsertWorker: undefined method `account_id' for nil:NilClass," Steps to reproduce the problem 1. use the instance normally.  Expected behaviour home feed is not empty  Actual behaviour home feed is empty and there are many failed sidekiq jobs  Detailed description 1. My home feed is suddenly empty, and `RAILS_ENV=production ./bin/tootctl feeds build` does not solve it. 2. the log of sidekiq seems to say it could not insert into feed.  Mastodon instance jing.lgbt  Mastodon version v4.2.12  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.2.3 (2024-01-18 revision 52bb2ac0a6) [x86_64-linux] - Node.js version: v20.17.0 journald:  Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.333Z pid=1042215 tid=ilnj class=FeedInsertWorker jid=537fcecfb09c55be7366b105 INFO: start Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.344Z pid=1042215 tid=ilnj class=FeedInsertWorker jid=537fcecfb09c55be7366b105 elapsed=0.012 INFO: fail Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.344Z pid=1042215 tid=ilnj WARN: {""context"":""Job raised exception"",""job"":{""retry"":true,""queue"":""default"",""class"":""FeedInsertWorker"",""args"":[113159302227197083,111832116425341006,""home"",{""update"":null}],""jid"":""537fcecfb09c55be7366b105"",""created_at"":1726673923.177217,""enqueued_at"":1726763928.3325593,""error_message"":""undefined method `account_id' for nil:NilClass"",""error_class"":""NoMethodError"",""failed_at"":1726673923.183306,""retry_count"":13,""retried_at"":1726735322.2056925}} Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.344Z pid=1042215 tid=ilnj WARN: NoMethodError: undefined method `account_id' for nil:NilClass Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.344Z pid=1042215 tid=ilnj WARN: /home/mastodon/live/app/lib/feed_manager.rb:561:in `block in build_crutches' Sep 20 01:38:48 mastodon1 bundle[1042215]: /home/mastodon/live/app/lib/feed_manager.rb:556:in `each' Sep 20 01:38:48 mastodon1 bundle[1042215]: /home/mastodon/live/app/lib/feed_manager.rb:556:in `flat_map' ",source-file | source-file,"sidekiq: FeedInsertWorker: undefined method `account_id' for nil:NilClass  Steps to reproduce the problem 1. use the instance normally.  Expected behaviour home feed is not empty  Actual behaviour home feed is empty and there are many failed sidekiq jobs  Detailed description 1. My home feed is suddenly empty, and `RAILS_ENV=production ./bin/tootctl feeds build` does not solve it. 2. the log of sidekiq seems to say it could not insert into feed.  Mastodon instance jing.lgbt  Mastodon version v4.2.12  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.2.3 (2024-01-18 revision 52bb2ac0a6) [x86_64-linux] - Node.js version: v20.17.0 journald:  Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.333Z pid=1042215 tid=ilnj class=FeedInsertWorker jid=537fcecfb09c55be7366b105 INFO: start Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.344Z pid=1042215 tid=ilnj class=FeedInsertWorker jid=537fcecfb09c55be7366b105 elapsed=0.012 INFO: fail Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.344Z pid=1042215 tid=ilnj WARN: {""context"":""Job raised exception"",""job"":{""retry"":true,""queue"":""default"",""class"":""FeedInsertWorker"",""args"":[113159302227197083,111832116425341006,""home"",{""update"":null}],""jid"":""537fcecfb09c55be7366b105"",""created_at"":1726673923.177217,""enqueued_at"":1726763928.3325593,""error_message"":""undefined method `account_id' for nil:NilClass"",""error_class"":""NoMethodError"",""failed_at"":1726673923.183306,""retry_count"":13,""retried_at"":1726735322.2056925}} Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.344Z pid=1042215 tid=ilnj WARN: NoMethodError: undefined method `account_id' for nil:NilClass Sep 20 01:38:48 mastodon1 bundle[1042215]: 2024-09-19T16:38:48.344Z pid=1042215 tid=ilnj WARN: /home/mastodon/live/app/lib/feed_manager.rb:561:in `block in build_crutches' Sep 20 01:38:48 mastodon1 bundle[1042215]: /home/mastodon/live/app/lib/feed_manager.rb:556:in `each' Sep 20 01:38:48 mastodon1 bundle[1042215]: /home/mastodon/live/app/lib/feed_manager.rb:556:in `flat_map'  source-file source-file",no-bug,0.9
30783,mastodon,https://github.com/mastodon/mastodon/issues/30783,"""Delete & re-draft"" is only deleting"," Steps to reproduce the problem 1. Write a post in the web interface. 2. Select the ""Delete & re-draft"" option from the  menu. 3. Post is deleted, but ""Oops an error occurred"" happens. 4. Post content is lost.  Expected behaviour Post is lost  Actual behaviour Post is ready to draft  Detailed description https://github.com/mastodon/mastodon/assets/3002053/c136f811-2a35-4cd7-85d1-2c3f828b5191  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha.4  Browser name and version Multiple  Operating system Multiple  Technical details Reproduced on mastodon.online as well",source-file | source-file,"""Delete & re-draft"" is only deleting  Steps to reproduce the problem 1. Write a post in the web interface. 2. Select the ""Delete & re-draft"" option from the  menu. 3. Post is deleted, but ""Oops an error occurred"" happens. 4. Post content is lost.  Expected behaviour Post is lost  Actual behaviour Post is ready to draft  Detailed description https://github.com/mastodon/mastodon/assets/3002053/c136f811-2a35-4cd7-85d1-2c3f828b5191  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha.4  Browser name and version Multiple  Operating system Multiple  Technical details Reproduced on mastodon.online as well source-file source-file",bug,0.85
27195,mastodon,https://github.com/mastodon/mastodon/issues/27195,Caught mastodon.social dropping boosts," Steps to reproduce the problem I am logged into mastodon.social. At this exact moment, if I open https://mastodon.social/@graydon@types.pl , I see this ![image](https://github.com/mastodon/mastodon/assets/277318/dadcb6dd-c0d2-41ad-92f2-a4cd2a0271a7) Notice the reference to a ""last boost"". If I go directly to graydon's feed on types.pl https://types.pl/@graydon , I see this: ![image](https://github.com/mastodon/mastodon/assets/277318/d3d307d7-9130-4bd2-94fd-70fd75dff8ed) Beneath the crawfordsm post, I see the microplastics post. There is a post missing from this feed, but *only* when I view from mastodon.social. @crawfordsm@mastodon.social is on mastodon.social, so I assume that there is not a federation issue preventing me from seeing the post. I do not have crawfordsm blocked or muted. I have no filters which hide posts completly (only hide with warning) and none of my filters would apply to this post. It is possible crawfordsm has me blocked, but I assume not because I can see the original post on mastodon.social https://mastodon.social/@crawfordsm/110700335570308419 , I can see crawfordsm's profile, and the UI does not stop me from trying to @-mention Dr. Crawford.  Expected behaviour I expect that boosts and regular statuses should be shown to me in chronological order if the account is on a peer server in good standing.  Actual behaviour Post from my instance boosted on other instance missing from user feed  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.2.0+pr-27116-50e1f46  Browser name and version Chrome 117.0.5938.92 (Official Build) (64-bit)  Operating system Windows 10  Technical details _No response_",source-file | source-file | source-file | source-file,"Caught mastodon.social dropping boosts  Steps to reproduce the problem I am logged into mastodon.social. At this exact moment, if I open https://mastodon.social/@graydon@types.pl , I see this ![image](https://github.com/mastodon/mastodon/assets/277318/dadcb6dd-c0d2-41ad-92f2-a4cd2a0271a7) Notice the reference to a ""last boost"". If I go directly to graydon's feed on types.pl https://types.pl/@graydon , I see this: ![image](https://github.com/mastodon/mastodon/assets/277318/d3d307d7-9130-4bd2-94fd-70fd75dff8ed) Beneath the crawfordsm post, I see the microplastics post. There is a post missing from this feed, but *only* when I view from mastodon.social. @crawfordsm@mastodon.social is on mastodon.social, so I assume that there is not a federation issue preventing me from seeing the post. I do not have crawfordsm blocked or muted. I have no filters which hide posts completly (only hide with warning) and none of my filters would apply to this post. It is possible crawfordsm has me blocked, but I assume not because I can see the original post on mastodon.social https://mastodon.social/@crawfordsm/110700335570308419 , I can see crawfordsm's profile, and the UI does not stop me from trying to @-mention Dr. Crawford.  Expected behaviour I expect that boosts and regular statuses should be shown to me in chronological order if the account is on a peer server in good standing.  Actual behaviour Post from my instance boosted on other instance missing from user feed  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.2.0+pr-27116-50e1f46  Browser name and version Chrome 117.0.5938.92 (Official Build) (64-bit)  Operating system Windows 10  Technical details _No response_ source-file source-file source-file source-file",no-bug,0.8
32196,mastodon,https://github.com/mastodon/mastodon/issues/32196,Update the Notifications feed to see the body of posts that others have boosted or favorited," Pitch The new formatting for notifications is very positive in that you don't see your post for every single boost or favorite you get. It was too much. However, now you don't see your posts in your Notifications feed at all. You have to open the notification to see what someone liked or boosted ( I use Mastodon in a browser on a desktop PC ). Like it or not, part of the draw of social media, even Mastodon, is getting feedback on what you wrote. How about keeping the way things are condensed, but show a copy ( only 1 ) of the post that was favorited or boosted? Example. I post ""It will rain tomorrow"". Five people favorite and boost it. In my Notifications feed I see my full ""It will rain tomorrow"" post, with the 5 users names across the top of the people who favorited or boosted it. Similar to now, but I don't have to open the notification to see the post, but I get to keep the compacted goodness of the new style.  Motivation Clearer, easy to see feedback on what you posted, making Mastodon more fun.",other-file,"Update the Notifications feed to see the body of posts that others have boosted or favorited  Pitch The new formatting for notifications is very positive in that you don't see your post for every single boost or favorite you get. It was too much. However, now you don't see your posts in your Notifications feed at all. You have to open the notification to see what someone liked or boosted ( I use Mastodon in a browser on a desktop PC ). Like it or not, part of the draw of social media, even Mastodon, is getting feedback on what you wrote. How about keeping the way things are condensed, but show a copy ( only 1 ) of the post that was favorited or boosted? Example. I post ""It will rain tomorrow"". Five people favorite and boost it. In my Notifications feed I see my full ""It will rain tomorrow"" post, with the 5 users names across the top of the people who favorited or boosted it. Similar to now, but I don't have to open the notification to see the post, but I get to keep the compacted goodness of the new style.  Motivation Clearer, easy to see feedback on what you posted, making Mastodon more fun. other-file",no-bug,0.9
29770,mastodon,https://github.com/mastodon/mastodon/issues/29770,Inconsistent handling of REDIS environment variables across streaming and puma images," Steps to reproduce the problem It seems that the redis configuration is being parsed differently in `streaming/index.js` to the rest of Mastodon. Specifically in `redisConfigFromEnv`:  const redisConfigFromEnv = (env) => {  let redisPort = parseIntFromEnv(env.REDIS_PORT, 6379, 'REDIS_PORT'); let redisDatabase = parseIntFromEnv(env.REDIS_DB, 0, 'REDIS_DB'); /** @type {import('ioredis').RedisOptions} */ const redisParams = { host: env.REDIS_HOST || '127.0.0.1', port: redisPort, db: redisDatabase, password: env.REDIS_PASSWORD || undefined, }; return { redisParams, redisPrefix, redisUrl: typeof env.REDIS_URL  'string' ? env.REDIS_URL : undefined, };  This code will cause an exception when `REDIS_PORT` contains any `NaN` string other than `""""`, even when `REDIS_URL` is used to overwrite this very setting. This is inconsistent with how the rest of mastodon handles the redis configuration, where all other `REDIS_` env variables are ignored as long as a `REDIS_URL` is provided.  Expected behaviour Both streaming, sidekiq and puma should interpret the config the same  Actual behaviour streaming processes `REDIS_PORT` and `REDIS_DB` even when `REDIS_URL` is set.  Detailed description _No response_  Mastodon instance _No response_  Mastodon version _No response_  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.1.2) - Node.js version: (from `node --version`, eg. v18.16.0)",source-file | source-file | source-file,"Inconsistent handling of REDIS environment variables across streaming and puma images  Steps to reproduce the problem It seems that the redis configuration is being parsed differently in `streaming/index.js` to the rest of Mastodon. Specifically in `redisConfigFromEnv`:  const redisConfigFromEnv = (env) => {  let redisPort = parseIntFromEnv(env.REDIS_PORT, 6379, 'REDIS_PORT'); let redisDatabase = parseIntFromEnv(env.REDIS_DB, 0, 'REDIS_DB'); /** @type {import('ioredis').RedisOptions} */ const redisParams = { host: env.REDIS_HOST || '127.0.0.1', port: redisPort, db: redisDatabase, password: env.REDIS_PASSWORD || undefined, }; return { redisParams, redisPrefix, redisUrl: typeof env.REDIS_URL  'string' ? env.REDIS_URL : undefined, };  This code will cause an exception when `REDIS_PORT` contains any `NaN` string other than `""""`, even when `REDIS_URL` is used to overwrite this very setting. This is inconsistent with how the rest of mastodon handles the redis configuration, where all other `REDIS_` env variables are ignored as long as a `REDIS_URL` is provided.  Expected behaviour Both streaming, sidekiq and puma should interpret the config the same  Actual behaviour streaming processes `REDIS_PORT` and `REDIS_DB` even when `REDIS_URL` is set.  Detailed description _No response_  Mastodon instance _No response_  Mastodon version _No response_  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.1.2) - Node.js version: (from `node --version`, eg. v18.16.0) source-file source-file source-file",no-bug,0.9
27686,mastodon,https://github.com/mastodon/mastodon/issues/27686,"""Failed to compile"" error on development server"," Steps to reproduce the problem 1. `git clone https://github.com/mastodon/mastodon.git` 2. `bundle install` 3. `yarn install` 4. `foreman start` 5. Visit 'localhost:3000' in browser  Expected behaviour Page renders successfully  Actual behaviour Get ""Failed to compile"" error message  Detailed description The full message is: > Failed to compile. > > ./app/javascript/mastodon/features/emoji/emoji_unicode_mapping_light.ts 18:15-32 > ""export 'unicodeToFilename' was not found in './unicode_to_filename' - 0e3401bc1c24fc1f6d7e04e9d2 appears to be the commit when the issue was introduced. - JS tests (`yarn run test`) are passing. - If I manually set `NODE_ENV=production` then the site _does_ render successfully. shell RAILS_ENV=development ./bin/rails tmp:clear assets:clean NODE_ENV=production foreman start   Mastodon instance localhost  Mastodon version 3bf2a7296e6d80d5cd9d5d3cba1507af6ba83dfd  Technical details OS: Ubuntu 23.10 `ruby --version` > ruby 3.2.2 (2023-03-30 revision e51014f9c0) [x86_64-linux] `node --version` > v20.9.0",source-file | source-file | source-file | source-file | source-file | source-file,"""Failed to compile"" error on development server  Steps to reproduce the problem 1. `git clone https://github.com/mastodon/mastodon.git` 2. `bundle install` 3. `yarn install` 4. `foreman start` 5. Visit 'localhost:3000' in browser  Expected behaviour Page renders successfully  Actual behaviour Get ""Failed to compile"" error message  Detailed description The full message is: > Failed to compile. > > ./app/javascript/mastodon/features/emoji/emoji_unicode_mapping_light.ts 18:15-32 > ""export 'unicodeToFilename' was not found in './unicode_to_filename' - 0e3401bc1c24fc1f6d7e04e9d2 appears to be the commit when the issue was introduced. - JS tests (`yarn run test`) are passing. - If I manually set `NODE_ENV=production` then the site _does_ render successfully. shell RAILS_ENV=development ./bin/rails tmp:clear assets:clean NODE_ENV=production foreman start   Mastodon instance localhost  Mastodon version 3bf2a7296e6d80d5cd9d5d3cba1507af6ba83dfd  Technical details OS: Ubuntu 23.10 `ruby --version` > ruby 3.2.2 (2023-03-30 revision e51014f9c0) [x86_64-linux] `node --version` > v20.9.0 source-file source-file source-file source-file source-file source-file",no-bug,0.95
31089,mastodon,https://github.com/mastodon/mastodon/issues/31089,Notifications for posts with only an image have no way to open the post, Pitch ![image](https://github.com/user-attachments/assets/58428339-5285-446f-931d-597644c4eef8) This toot with only an image has no anchor to link back to the toot. or preview of the image.. so I don't know what image he liked.  Motivation Anti-Jank,other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,Notifications for posts with only an image have no way to open the post  Pitch ![image](https://github.com/user-attachments/assets/58428339-5285-446f-931d-597644c4eef8) This toot with only an image has no anchor to link back to the toot. or preview of the image.. so I don't know what image he liked.  Motivation Anti-Jank other-file other-file other-file other-file other-file other-file other-file other-file other-file,no-bug,0.9
29703,mastodon,https://github.com/mastodon/mastodon/issues/29703,[webinterface] Make role-specific styling possible again," Pitch User roles (e.g. ""Admin"", or custom roles) have a color attribute ([docs](https://docs.joinmastodon.org/entities/Role/#color)) and pre-4.2.0 that color was used to theme the role badge on an account's profile. With the 4.2.0 release, these badges were redesigned ([original PR here](https://github.com/mastodon/mastodon/pull/26281)) and the redesign removed not only the coloring itself, but also any way of identifying different badges through CSS selectors. The roles previously got a CSS class based on their ID, I'd like to propose to expose a role's ID as a `data-role-id` attribute to the frontend again.  Motivation We'd like to add custom styling for different roles on our instance, to highlight Moderators or supporters, through custom CSS. However, at the moment there's no simple way of knowing which role(s) the current user has.",other-file | other-file,"[webinterface] Make role-specific styling possible again  Pitch User roles (e.g. ""Admin"", or custom roles) have a color attribute ([docs](https://docs.joinmastodon.org/entities/Role/#color)) and pre-4.2.0 that color was used to theme the role badge on an account's profile. With the 4.2.0 release, these badges were redesigned ([original PR here](https://github.com/mastodon/mastodon/pull/26281)) and the redesign removed not only the coloring itself, but also any way of identifying different badges through CSS selectors. The roles previously got a CSS class based on their ID, I'd like to propose to expose a role's ID as a `data-role-id` attribute to the frontend again.  Motivation We'd like to add custom styling for different roles on our instance, to highlight Moderators or supporters, through custom CSS. However, at the moment there's no simple way of knowing which role(s) the current user has. other-file other-file",no-bug,0.9
31570,mastodon,https://github.com/mastodon/mastodon/issues/31570,errors uploading iPhone HEIC images," Steps to reproduce the problem 1. Attempt to upload an HEIC photo taken on an iPhone 2. See ""500 Error processing thumbnail for uploaded media"" in the web UI  Expected behaviour The image should upload and post  Actual behaviour The image fails to upload  Detailed description I initially thought this might be from using libvips but upon further testing, it occurs whether or not I have `MASTODON_USE_LIBVIPS=true` in .env.production, so it seems to be something else. I have attached two sample images that reproduce the issue (as a zip; GitHub doesn't support HEIF): [HEIF-images.zip](https://github.com/user-attachments/files/16734152/HEIF-images.zip) I also see this in my /var/log/syslog when the issue occurs  2024-08-23T12:32:35.879625-07:00 koi bundle[47993]: E, [2024-08-23T12:32:35.878990 #47993] ERROR -- : [2295fbc3-5619-4ccf-a574-e19fc5116ece] Paperclip::Error: Error while optimizing 799cd6bfc52d5baa8ba87191e42bdc0820240823-47993-10b16y: /tmp/799cd6bfc52d5baa8ba87191e42bdc0820240823-47993-10b16y.heif: bad seek to 3413051 2024-08-23T12:32:35.880347-07:00 koi bundle[47993]: heif: Invalid input: Unspecified: Metadata not correctly assigned to image (2.0)   Mastodon instance puddle.town  Mastodon version v4.3.0-beta.1  Technical details  $ ruby --version ruby 3.3.4 (2024-07-09 revision be1089c8ec) [x86_64-linux]   $ node --version v20.17.0   $ cat /etc/lsb-release DISTRIB_ID=Ubuntu DISTRIB_RELEASE=24.04 DISTRIB_CODENAME=noble DISTRIB_DESCRIPTION=""Ubuntu 24.04 LTS""   $ vips -v vips-8.15.1   $ vips --vips-config enable debug: false enable deprecated: true enable modules: true enable cplusplus: true enable RAD load/save: true enable Analyze7 load/save: true enable PPM load/save: true enable GIF load: true use fftw for FFTs: true SIMD support with highway: true accelerate loops with ORC: false ICC profile support with lcms: true zlib: true text rendering with pangocairo: true font file support with fontconfig: true EXIF metadata support with libexif: true JPEG load/save with libjpeg: true JXL load/save with libjxl: true (dynamic module: true) JPEG2000 load/save with OpenJPEG: true PNG load/save with libspng: true PNG load/save with libpng: false selected quantisation package: imagequant TIFF load/save with libtiff: true image pyramid save with libarchive: true HEIC/AVIF load/save with libheif: true (dynamic module: true) WebP load/save with libwebp: true PDF load with PDFium: false PDF load with poppler-glib: true (dynamic module: true) SVG load with librsvg: true EXR load with OpenEXR: true OpenSlide load: true (dynamic module: true) Matlab load with libmatio: true NIfTI load/save with niftiio: false FITS load/save with cfitsio: true GIF save with cgif: true selected Magick package: MagickCore (dynamic module: true) Magick API version: magick6 Magick load: true Magick save: true ",container-file,"errors uploading iPhone HEIC images  Steps to reproduce the problem 1. Attempt to upload an HEIC photo taken on an iPhone 2. See ""500 Error processing thumbnail for uploaded media"" in the web UI  Expected behaviour The image should upload and post  Actual behaviour The image fails to upload  Detailed description I initially thought this might be from using libvips but upon further testing, it occurs whether or not I have `MASTODON_USE_LIBVIPS=true` in .env.production, so it seems to be something else. I have attached two sample images that reproduce the issue (as a zip; GitHub doesn't support HEIF): [HEIF-images.zip](https://github.com/user-attachments/files/16734152/HEIF-images.zip) I also see this in my /var/log/syslog when the issue occurs  2024-08-23T12:32:35.879625-07:00 koi bundle[47993]: E, [2024-08-23T12:32:35.878990 #47993] ERROR -- : [2295fbc3-5619-4ccf-a574-e19fc5116ece] Paperclip::Error: Error while optimizing 799cd6bfc52d5baa8ba87191e42bdc0820240823-47993-10b16y: /tmp/799cd6bfc52d5baa8ba87191e42bdc0820240823-47993-10b16y.heif: bad seek to 3413051 2024-08-23T12:32:35.880347-07:00 koi bundle[47993]: heif: Invalid input: Unspecified: Metadata not correctly assigned to image (2.0)   Mastodon instance puddle.town  Mastodon version v4.3.0-beta.1  Technical details  $ ruby --version ruby 3.3.4 (2024-07-09 revision be1089c8ec) [x86_64-linux]   $ node --version v20.17.0   $ cat /etc/lsb-release DISTRIB_ID=Ubuntu DISTRIB_RELEASE=24.04 DISTRIB_CODENAME=noble DISTRIB_DESCRIPTION=""Ubuntu 24.04 LTS""   $ vips -v vips-8.15.1   $ vips --vips-config enable debug: false enable deprecated: true enable modules: true enable cplusplus: true enable RAD load/save: true enable Analyze7 load/save: true enable PPM load/save: true enable GIF load: true use fftw for FFTs: true SIMD support with highway: true accelerate loops with ORC: false ICC profile support with lcms: true zlib: true text rendering with pangocairo: true font file support with fontconfig: true EXIF metadata support with libexif: true JPEG load/save with libjpeg: true JXL load/save with libjxl: true (dynamic module: true) JPEG2000 load/save with OpenJPEG: true PNG load/save with libspng: true PNG load/save with libpng: false selected quantisation package: imagequant TIFF load/save with libtiff: true image pyramid save with libarchive: true HEIC/AVIF load/save with libheif: true (dynamic module: true) WebP load/save with libwebp: true PDF load with PDFium: false PDF load with poppler-glib: true (dynamic module: true) SVG load with librsvg: true EXR load with OpenEXR: true OpenSlide load: true (dynamic module: true) Matlab load with libmatio: true NIfTI load/save with niftiio: false FITS load/save with cfitsio: true GIF save with cgif: true selected Magick package: MagickCore (dynamic module: true) Magick API version: magick6 Magick load: true Magick save: true  container-file",no-bug,0.8
27288,mastodon,https://github.com/mastodon/mastodon/issues/27288,https://mastodon.social/relationships?activity=dormant consistently results in an error page," Steps to reproduce the problem 1. Navigate to https://mastodon.social/relationships?activity=dormant I usually do it via Preferences - Follows and followers - Dormant 2. See the ""We're sorry, but something went wrong on our end."" error page  Expected behaviour A list of dormant people that I'm following  Actual behaviour An error page  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.2.1-rc1+pr-27261-37da69c  Browser name and version Google Chrome Version 117.0.5938.132 (Official Build) (64-bit)  Operating system Debian  Technical details _No response_",source-file | source-file,"https://mastodon.social/relationships?activity=dormant consistently results in an error page  Steps to reproduce the problem 1. Navigate to https://mastodon.social/relationships?activity=dormant I usually do it via Preferences - Follows and followers - Dormant 2. See the ""We're sorry, but something went wrong on our end."" error page  Expected behaviour A list of dormant people that I'm following  Actual behaviour An error page  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.2.1-rc1+pr-27261-37da69c  Browser name and version Google Chrome Version 117.0.5938.132 (Official Build) (64-bit)  Operating system Debian  Technical details _No response_ source-file source-file",bug,0.95
31680,mastodon,https://github.com/mastodon/mastodon/issues/31680,Alt text is dropped when a video with custom thumbnail is uploaded.," Steps to reproduce the problem 1. Drag and drop a video in the new post area to upload it. 2. Click on the edit pencil icon of the video to edit the Alt text. 3. Enter Alt Text. 4. Upload a custom thumbnail for the video and save the changes. 5. If you now post your video post, the Alt text is missing.   Expected behaviour The Alt text should of course be kept alive and kicking ;-)  Actual behaviour The Alt text is dropped.  Detailed description When using a custom thumbnail for videos, the Alt text vanishes when the toot is posted. This only happens when adding a custom thumbnail. I can work around it if after posting I re-edit the post, enter the Alt text again and re-post. I have tested this on mastodon.art, zirk.us and Vivaldi.social. The bug is around for as long as I can remember, several years I think.  Mastodon instance mastodon.art, zirk.us and Vivaldi.social  Mastodon version v4.2.12 and earlier  Browser name and version Vivaldi for the last year or more, Firefox  Operating system Windows 10 and 11  Technical details _No response_",source-file,"Alt text is dropped when a video with custom thumbnail is uploaded.  Steps to reproduce the problem 1. Drag and drop a video in the new post area to upload it. 2. Click on the edit pencil icon of the video to edit the Alt text. 3. Enter Alt Text. 4. Upload a custom thumbnail for the video and save the changes. 5. If you now post your video post, the Alt text is missing.   Expected behaviour The Alt text should of course be kept alive and kicking ;-)  Actual behaviour The Alt text is dropped.  Detailed description When using a custom thumbnail for videos, the Alt text vanishes when the toot is posted. This only happens when adding a custom thumbnail. I can work around it if after posting I re-edit the post, enter the Alt text again and re-post. I have tested this on mastodon.art, zirk.us and Vivaldi.social. The bug is around for as long as I can remember, several years I think.  Mastodon instance mastodon.art, zirk.us and Vivaldi.social  Mastodon version v4.2.12 and earlier  Browser name and version Vivaldi for the last year or more, Firefox  Operating system Windows 10 and 11  Technical details _No response_ source-file",no-bug,0.9
32652,mastodon,https://github.com/mastodon/mastodon/issues/32652,Scrolling induces layout shift," Steps to reproduce the problem 1. Open the standard web interface in a 1200px wide window 2. Scroll the feed  Expected behaviour Layout should remain static  Actual behaviour Layout shifts  Detailed description The width of the main column shifts on scroll  Mastodon instance toot.wales, mastodon.social  Mastodon version v4.3.1  Browser name and version Firefox 131.0.3, Chrome 130.0.6723.59  Operating system Windows 10 22H2  Technical details div.columns-area__panels__main alternates between 581px and 600px wide",other-file,"Scrolling induces layout shift  Steps to reproduce the problem 1. Open the standard web interface in a 1200px wide window 2. Scroll the feed  Expected behaviour Layout should remain static  Actual behaviour Layout shifts  Detailed description The width of the main column shifts on scroll  Mastodon instance toot.wales, mastodon.social  Mastodon version v4.3.1  Browser name and version Firefox 131.0.3, Chrome 130.0.6723.59  Operating system Windows 10 22H2  Technical details div.columns-area__panels__main alternates between 581px and 600px wide other-file",no-bug,0.95
33732,mastodon,https://github.com/mastodon/mastodon/issues/33732,"Show profile cards on hover of profiles in ""who to follow"""," Pitch Profile cards are great, ""who to follow"" suggestions are great, but the cards don't display when you hover on the ""who to follow"" suggestions. Can we add them? Same goes for suggested profiles in Explore, on (example link) https://example.org/explore/suggestions.  Motivation It makes me more likely to follow someone without having to click through to their profile.",other-file | other-file,"Show profile cards on hover of profiles in ""who to follow""  Pitch Profile cards are great, ""who to follow"" suggestions are great, but the cards don't display when you hover on the ""who to follow"" suggestions. Can we add them? Same goes for suggested profiles in Explore, on (example link) https://example.org/explore/suggestions.  Motivation It makes me more likely to follow someone without having to click through to their profile. other-file other-file",no-bug,0.9
31661,mastodon,https://github.com/mastodon/mastodon/issues/31661,The mute user options only use color to indicate the selected option," Steps to reproduce the problem Mute a user and click Show Options. You now see multiple circles that only indicate they are selected by changing the color.  Expected behaviour Filled circles, point in circle. Something like a real radio button.  Actual behaviour Empty circles, only other color.  Detailed description See image. ![image](https://github.com/user-attachments/assets/7bc3d1ca-89cb-4278-887b-c0cd8162608a) The simulated radio buttons look differently from real radio buttons and make it hard for the user to see what they have selected.  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-08-28  Browser name and version Google Chrome 128.0.6613.114  Operating system Windows 10  Technical details _No response_",other-file,"The mute user options only use color to indicate the selected option  Steps to reproduce the problem Mute a user and click Show Options. You now see multiple circles that only indicate they are selected by changing the color.  Expected behaviour Filled circles, point in circle. Something like a real radio button.  Actual behaviour Empty circles, only other color.  Detailed description See image. ![image](https://github.com/user-attachments/assets/7bc3d1ca-89cb-4278-887b-c0cd8162608a) The simulated radio buttons look differently from real radio buttons and make it hard for the user to see what they have selected.  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-08-28  Browser name and version Google Chrome 128.0.6613.114  Operating system Windows 10  Technical details _No response_ other-file",no-bug,0.95
29721,mastodon,https://github.com/mastodon/mastodon/issues/29721,"Add ""accept all"" / ""deny all"" options to Filtered Notifications column"," Pitch The new ""Filtered Notifications"" column (mastodon.social v4.3.0-nightly.2024-03-19) ![image](https://github.com/tuskyapp/Tusky/assets/277318/3326c07e-ae2b-4eca-be8d-97b2dcd07356) Should have two buttons, probably in a drop down menu like the ""gear"" other columns have. These two buttons should say ""Accept all"" and ""Deny all"" and do what they say.  Motivation I have a mild case of RSI which becomes significant if I do many repetitive actions over a short time. A computer task which requires me to click many times in a row can cause this to flare up. If I were to use notification filters, ""accept all""/""deny all"" options would help me in two distinct situations: * **Everything is great.** Either I received many contacts on a viral ""toot"" overnight, or I left my account unattended for a while and got a lot of traffic in the meantime. * **Everything is terrible.** Someone is harassing me, and to do so they created many sockpuppet accounts. In both these cases, I could have so many items in the ""Filtered Notifications"" column that clicking the accept/dismiss buttons for each one [would become a burden](https://github.com/mastodon/mastodon/issues/29723). With ""Accept all"" / ""Deny all"" options, I could pick out the handful of good notifications (in the first case) or the handful of dubious notifications (in the second case) and bulk accept/deny the rest.",other-file | other-file | other-file | other-file,"Add ""accept all"" / ""deny all"" options to Filtered Notifications column  Pitch The new ""Filtered Notifications"" column (mastodon.social v4.3.0-nightly.2024-03-19) ![image](https://github.com/tuskyapp/Tusky/assets/277318/3326c07e-ae2b-4eca-be8d-97b2dcd07356) Should have two buttons, probably in a drop down menu like the ""gear"" other columns have. These two buttons should say ""Accept all"" and ""Deny all"" and do what they say.  Motivation I have a mild case of RSI which becomes significant if I do many repetitive actions over a short time. A computer task which requires me to click many times in a row can cause this to flare up. If I were to use notification filters, ""accept all""/""deny all"" options would help me in two distinct situations: * **Everything is great.** Either I received many contacts on a viral ""toot"" overnight, or I left my account unattended for a while and got a lot of traffic in the meantime. * **Everything is terrible.** Someone is harassing me, and to do so they created many sockpuppet accounts. In both these cases, I could have so many items in the ""Filtered Notifications"" column that clicking the accept/dismiss buttons for each one [would become a burden](https://github.com/mastodon/mastodon/issues/29723). With ""Accept all"" / ""Deny all"" options, I could pick out the handful of good notifications (in the first case) or the handful of dubious notifications (in the second case) and bulk accept/deny the rest. other-file other-file other-file other-file",no-bug,0.95
27685,mastodon,https://github.com/mastodon/mastodon/issues/27685,Edited posts history does not appear," Steps to reproduce the problem 1. Publish a post 2. Edit it 3. Click the edited timestamp  Expected behaviour I see edit history  Actual behaviour Nothing appears and a next click-event is spoiled  Detailed description _No response_  Mastodon instance -  Mastodon version v4.3.0-alpha.0  Browser name and version Firefox 119.0  Operating system -  Technical details I see that browser's dev-tool shows the container of edit history on the DOM when clicked the timestamps, that has `opacity: 0` and `pointer-events: none` CSS properties. I removed both via dev-tool and it works normally for once (but placed on top-left edge) This seems introduced by #27385 ![](https://github.com/mastodon/mastodon/assets/5103195/af17c5c8-d870-4284-9dc6-a1f08df0b9bd) ![](https://github.com/mastodon/mastodon/assets/5103195/2854b3ef-bf84-46cb-b9e6-9ce541a8d5de)",other-file,"Edited posts history does not appear  Steps to reproduce the problem 1. Publish a post 2. Edit it 3. Click the edited timestamp  Expected behaviour I see edit history  Actual behaviour Nothing appears and a next click-event is spoiled  Detailed description _No response_  Mastodon instance -  Mastodon version v4.3.0-alpha.0  Browser name and version Firefox 119.0  Operating system -  Technical details I see that browser's dev-tool shows the container of edit history on the DOM when clicked the timestamps, that has `opacity: 0` and `pointer-events: none` CSS properties. I removed both via dev-tool and it works normally for once (but placed on top-left edge) This seems introduced by #27385 ![](https://github.com/mastodon/mastodon/assets/5103195/af17c5c8-d870-4284-9dc6-a1f08df0b9bd) ![](https://github.com/mastodon/mastodon/assets/5103195/2854b3ef-bf84-46cb-b9e6-9ce541a8d5de) other-file",no-bug,0.9
30135,mastodon,https://github.com/mastodon/mastodon/issues/30135,Sort order on Pending Trending Hashtag moderation page inconsistant," Steps to reproduce the problem 1. Goto the ""pending review"" page for trending hashtags (admin/trends/tags?status=pending_review) when there are multiple tags awaiting approval 2. observe what hashtags are on the first page 3. Hit Ctrl+R or your favourite page reload process. 4. observe a completely different set of hashtags.  Expected behaviour The hashtags for review will always appear in a consistent order  Actual behaviour The sort order appears random, this is exacerbated when there are multiple pages  Detailed description I think the above covers it well. The reason this is a specific issue is I have ~800 tags to review and my intended process was to start at the end, allow all the ones I liked on the last page, then I could disallow anything remaining on the last page. However since the contents of the page keep changing it means I can't know which tags on the page I have already discounted and haveto review them all again.  Mastodon instance mstdn.crmbl.uk  Mastodon version v4.2.8  Browser name and version Vivaldi 6.7.3329.21 (Stable channel) (64-bit)  Operating system Windows 11  Technical details _No response_",source-file,"Sort order on Pending Trending Hashtag moderation page inconsistant  Steps to reproduce the problem 1. Goto the ""pending review"" page for trending hashtags (admin/trends/tags?status=pending_review) when there are multiple tags awaiting approval 2. observe what hashtags are on the first page 3. Hit Ctrl+R or your favourite page reload process. 4. observe a completely different set of hashtags.  Expected behaviour The hashtags for review will always appear in a consistent order  Actual behaviour The sort order appears random, this is exacerbated when there are multiple pages  Detailed description I think the above covers it well. The reason this is a specific issue is I have ~800 tags to review and my intended process was to start at the end, allow all the ones I liked on the last page, then I could disallow anything remaining on the last page. However since the contents of the page keep changing it means I can't know which tags on the page I have already discounted and haveto review them all again.  Mastodon instance mstdn.crmbl.uk  Mastodon version v4.2.8  Browser name and version Vivaldi 6.7.3329.21 (Stable channel) (64-bit)  Operating system Windows 11  Technical details _No response_ source-file",no-bug,0.9
27422,mastodon,https://github.com/mastodon/mastodon/issues/27422,Back button should close models and not navigate away, Steps to reproduce the problem 1. Open a toot with an image 2. Click the image  Expected behaviour The back link of the browser should close the zoomed view  Actual behaviour the back link navigates away.  Detailed description * opening the zoomed image should add to the browser history (closing should go back in history). This behaviour is desired for any modal that is opened (the back button should close the modal and not navigate away.  Mastodon instance mastodon.social  Mastodon version v4.1.2  Browser name and version Chrome 117.0.5938.149  Operating system Ubuntu 22.04  Technical details _No response_,source-file | other-file | other-file | source-file | other-file | other-file,Back button should close models and not navigate away  Steps to reproduce the problem 1. Open a toot with an image 2. Click the image  Expected behaviour The back link of the browser should close the zoomed view  Actual behaviour the back link navigates away.  Detailed description * opening the zoomed image should add to the browser history (closing should go back in history). This behaviour is desired for any modal that is opened (the back button should close the modal and not navigate away.  Mastodon instance mastodon.social  Mastodon version v4.1.2  Browser name and version Chrome 117.0.5938.149  Operating system Ubuntu 22.04  Technical details _No response_ source-file other-file other-file source-file other-file other-file,no-bug,0.9
31715,mastodon,https://github.com/mastodon/mastodon/issues/31715,Admin emails use user's localization rather than server's, Steps to reproduce the problem 1. Be an admin of an instance 2. Require verification for new accounts 3. As another user: Make a new account with a non default localization 4. As an admin: Receive email with wrong localization  Expected behaviour Email to admin should be standard/default localization  Actual behaviour Email to admin is sent in the user's localization  Detailed description If a user sets their language to some other language the email that comes to the admin of the instance to verify them is of that localization rather than the instances default. User has this selected: ![image](https://github.com/user-attachments/assets/f2292a75-27ce-4ae8-abf5-0b54a3d00adf) Email received **to the admin:** ![image](https://github.com/user-attachments/assets/b97f9dfa-33e1-4e9d-8d92-14f89cf803bd) Translation:  New account up for review on fuzzies.wtf The details of the new account are below. You can approve or reject this application.   Mastodon instance fuzzies.wtf  Mastodon version v4.3.0-alpha.5+no-portals  Technical details - Ruby version: ruby 3.3.4 (2024-07-09 revision be1089c8ec) [x86_64-linux] - Node.js version: v20.17.0,source-file | source-file | source-file | source-file,Admin emails use user's localization rather than server's  Steps to reproduce the problem 1. Be an admin of an instance 2. Require verification for new accounts 3. As another user: Make a new account with a non default localization 4. As an admin: Receive email with wrong localization  Expected behaviour Email to admin should be standard/default localization  Actual behaviour Email to admin is sent in the user's localization  Detailed description If a user sets their language to some other language the email that comes to the admin of the instance to verify them is of that localization rather than the instances default. User has this selected: ![image](https://github.com/user-attachments/assets/f2292a75-27ce-4ae8-abf5-0b54a3d00adf) Email received **to the admin:** ![image](https://github.com/user-attachments/assets/b97f9dfa-33e1-4e9d-8d92-14f89cf803bd) Translation:  New account up for review on fuzzies.wtf The details of the new account are below. You can approve or reject this application.   Mastodon instance fuzzies.wtf  Mastodon version v4.3.0-alpha.5+no-portals  Technical details - Ruby version: ruby 3.3.4 (2024-07-09 revision be1089c8ec) [x86_64-linux] - Node.js version: v20.17.0 source-file source-file source-file source-file,no-bug,0.9
31175,mastodon,https://github.com/mastodon/mastodon/issues/31175,Change the timeline notification to use the @ symbol for the private mention to match the timeline icon, Pitch Notification ![image](https://github.com/user-attachments/assets/da08473e-6379-4a42-9bbe-90c937100919) Timeline ![image](https://github.com/user-attachments/assets/cd409b96-fdd2-4bfb-9014-7b6d95c2474f)  Motivation Easier on the eyes. Matches style.,other-file,Change the timeline notification to use the @ symbol for the private mention to match the timeline icon  Pitch Notification ![image](https://github.com/user-attachments/assets/da08473e-6379-4a42-9bbe-90c937100919) Timeline ![image](https://github.com/user-attachments/assets/cd409b96-fdd2-4bfb-9014-7b6d95c2474f)  Motivation Easier on the eyes. Matches style. other-file,no-bug,0.9
33741,mastodon,https://github.com/mastodon/mastodon/issues/33741,"Keyboard: `x` doesn't always work on ""Show anyway"" on filtered posts"," Pitch I recently learned of the `x` keyboard binding for opening Content Warning'd posts, but was surprised to find out that this doesn't also work for ""Show anyway"" on filtered posts.  Motivation I primarily use keyboard navigation, any need to instead click with mouse is a break to my workflow. The presentation of a Content Warning post and a Show Anyway filtered post is very similar, so it makes sense to use the same keyboard binding to ""open up"" either of these. The functionality of `o` is different, as it opens up the post in a different column in the ""advanced"" view. This is particularly significant if you're viewing the post in the middle of a number of custom columns (the ""opening"" is always in the right most column, causing a lateral shift in the view).",other-file,"Keyboard: `x` doesn't always work on ""Show anyway"" on filtered posts  Pitch I recently learned of the `x` keyboard binding for opening Content Warning'd posts, but was surprised to find out that this doesn't also work for ""Show anyway"" on filtered posts.  Motivation I primarily use keyboard navigation, any need to instead click with mouse is a break to my workflow. The presentation of a Content Warning post and a Show Anyway filtered post is very similar, so it makes sense to use the same keyboard binding to ""open up"" either of these. The functionality of `o` is different, as it opens up the post in a different column in the ""advanced"" view. This is particularly significant if you're viewing the post in the middle of a number of custom columns (the ""opening"" is always in the right most column, causing a lateral shift in the view). other-file",no-bug,0.9
31917,mastodon,https://github.com/mastodon/mastodon/issues/31917,[Accessibility] The main scrollbar is too thin and is difficult to grab.," Steps to reproduce the problem 1. Go on Mastodon web interface on your desktop and look at the scrollbars sizes, mainly the main scrollbar totally on the right. 2. Some people, including me, can't grab it with the mouse because it's too thin.  Expected behaviour I can grab the scrollbar with the mouse to scroll because it's normal size.  Actual behaviour I can't grab the scrollbar with the mouse to scroll because it's too thin.  Detailed description The main scrollbar (on the `html` element) is too thin and it's very difficult to grab it to scroll with the mouse. On the screenshot below, this is the scrollbar on the right. The other for the navigation is normal size. ![Screenshot of Mastodon interface with the thin main scrollbar and a normal size one for the navigation](https://github.com/user-attachments/assets/7f7f2f10-3297-4461-8e30-18932e88901f) I've found this code in the CSS which is the problem: css @supports not selector(::-webkit-scrollbar) { html { scrollbar-color: #606085 var(--background-border-color); scrollbar-width: thin; } }  There is an [""Accessibility"" section on MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/scrollbar-width#accessibility) to explain why the CSS property `scrollbar-width` is a problem when you fix the `thin` value. Is it possible to remove this property from the CSS? Or to add an option so that users can choose if they want the normal size for scrollbar or a thin size? Thanks  Mastodon instance eldritch.cafe  Mastodon version v4.3.0  Browser name and version Firefox 130  Operating system Windows 11  Technical details _No response_",other-file,"[Accessibility] The main scrollbar is too thin and is difficult to grab.  Steps to reproduce the problem 1. Go on Mastodon web interface on your desktop and look at the scrollbars sizes, mainly the main scrollbar totally on the right. 2. Some people, including me, can't grab it with the mouse because it's too thin.  Expected behaviour I can grab the scrollbar with the mouse to scroll because it's normal size.  Actual behaviour I can't grab the scrollbar with the mouse to scroll because it's too thin.  Detailed description The main scrollbar (on the `html` element) is too thin and it's very difficult to grab it to scroll with the mouse. On the screenshot below, this is the scrollbar on the right. The other for the navigation is normal size. ![Screenshot of Mastodon interface with the thin main scrollbar and a normal size one for the navigation](https://github.com/user-attachments/assets/7f7f2f10-3297-4461-8e30-18932e88901f) I've found this code in the CSS which is the problem: css @supports not selector(::-webkit-scrollbar) { html { scrollbar-color: #606085 var(--background-border-color); scrollbar-width: thin; } }  There is an [""Accessibility"" section on MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/scrollbar-width#accessibility) to explain why the CSS property `scrollbar-width` is a problem when you fix the `thin` value. Is it possible to remove this property from the CSS? Or to add an option so that users can choose if they want the normal size for scrollbar or a thin size? Thanks  Mastodon instance eldritch.cafe  Mastodon version v4.3.0  Browser name and version Firefox 130  Operating system Windows 11  Technical details _No response_ other-file",no-bug,0.95
33910,mastodon,https://github.com/mastodon/mastodon/issues/33910,Sidekiq error: CardinalityViolation: ERROR: ON CONFLICT DO UPDATE," Steps to reproduce the problem I've been getting a lot of Mastodon sidekiq errors: `ActivityPub:ProcessingWorker ""ActiveRecord::StatementInvalid: PG::CardinalityViolation: ERROR: ON CONFLICT DO UPDATE command cannot affect row a second time HINT: Ensure that no rows proposed for insertion within the same command""`  Expected behaviour No error  Actual behaviour Error  Detailed description I've been getting a lot of Mastodon sidekiq errors: ActivityPub:ProcessingWorker ""ActiveRecord::StatementInvalid: PG::CardinalityViolation: ERROR: ON CONFLICT DO UPDATE command cannot affect row a second time HINT: Ensure that no rows proposed for insertion within the same command"" I thought it was a widespread problem, but it appears, after pulling journalctl mastodon-* today, all of my many errors come back to one post, I believe came from federation firehose and not an account I follow nor follows me. I didn't look at each error, though. The journalctl rows from the first time the error appeared is attached. I think I got all, or more of the relevant rows. [CardinalityViolation.txt](https://github.com/user-attachments/files/18769336/CardinalityViolation.txt)  Mastodon instance oldfriends.live  Mastodon version v4.3.3  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: v3.3.5 - Node.js version: v20.17.0 I posted a question on Mastodon about this to see if anyone else was getting this error and Renchap replied to file a report. https://oisaur.com/@renchap/113990485085328900",source-file | source-file | source-file,"Sidekiq error: CardinalityViolation: ERROR: ON CONFLICT DO UPDATE  Steps to reproduce the problem I've been getting a lot of Mastodon sidekiq errors: `ActivityPub:ProcessingWorker ""ActiveRecord::StatementInvalid: PG::CardinalityViolation: ERROR: ON CONFLICT DO UPDATE command cannot affect row a second time HINT: Ensure that no rows proposed for insertion within the same command""`  Expected behaviour No error  Actual behaviour Error  Detailed description I've been getting a lot of Mastodon sidekiq errors: ActivityPub:ProcessingWorker ""ActiveRecord::StatementInvalid: PG::CardinalityViolation: ERROR: ON CONFLICT DO UPDATE command cannot affect row a second time HINT: Ensure that no rows proposed for insertion within the same command"" I thought it was a widespread problem, but it appears, after pulling journalctl mastodon-* today, all of my many errors come back to one post, I believe came from federation firehose and not an account I follow nor follows me. I didn't look at each error, though. The journalctl rows from the first time the error appeared is attached. I think I got all, or more of the relevant rows. [CardinalityViolation.txt](https://github.com/user-attachments/files/18769336/CardinalityViolation.txt)  Mastodon instance oldfriends.live  Mastodon version v4.3.3  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: v3.3.5 - Node.js version: v20.17.0 I posted a question on Mastodon about this to see if anyone else was getting this error and Renchap replied to file a report. https://oisaur.com/@renchap/113990485085328900 source-file source-file source-file",no-bug,0.9
27305,mastodon,https://github.com/mastodon/mastodon/issues/27305,Mastodon 4.2.x randomly truncates posts coming in from at least Hubzilla," Steps to reproduce the problem 1. Have a Hubzilla channel with PubCrawl on and connections on mastodon.social as an example of an instance that runs at least Mastodon 4.2.0. 2. Create a post on Hubzilla, preferably one that's significantly longer than 500 characters. Add at least one not-too-common hashtag so it can be found more easily. 3. Go to `https://mastodon.social/tags/<the hashtag used in the post>` in the Web browser of your choice (tested with the original Mozilla build of Firefox on Debian GNU/Linux). 4. Scroll down until you find your post. 5. Compare how mastodon.social renders your post with what your original Hubzilla post looks like.  Expected behaviour The full post text is always shown on Mastodon.  Actual behaviour Chances are the post is truncated and incomplete.  Detailed description Since Mastodon 4.2.0 was released, it seems to randomly truncate posts from at least Hubzilla. It does so both to posts that came in after the upgrade of an instance to 4.2.x and to posts that have been on an instance before the 4.2.x upgrade. It doesn't happen to each post. It happens both to Hubzilla posts (first posts in a thread) and to Hubzilla comments (replies to posts which are something different on Hubzilla), and it happens to comments on both Mastodon and Hubzilla posts. Also, even truncated posts can still be over 500 characters long on instances that only allow for 500 characters. And posts that are well under 500 characters are truncated, too. There seems to be no pattern. There is nothing that indicates when and why a post is truncated, other than all truncated posts I know about have hashtags in the text rather than all hashtags at the end or no hashtags at all. Also, Hubzilla posts with summaries that became/become Mastodon posts with content warnings seem to never be truncated. That said, posts are never truncated in the middle of a word. The issue clearly lies on Mastodon's side. It started happening with the release of Mastodon 4.2.0 while Hubzilla did not have a new release at that time. Also, Mastodon 4.1.9 shows posts perfectly fine which Mastodon 4.2.0 truncates. Here is a proof, although it's a minor example. Original Hubzilla comment: https://hub.netzgemeinde.eu/display/b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vMzU0NTJkMmQtNDI0OC00NjI5LTg3MjgtZWE0YTlhOWIyNDBk Mastodon 4.1.9 (noc.social) showing the whole post: https://noc.social/@MarvinTheMartian/111115829359100943 (scroll down to my post) Mastodon 4.2.0 (tooters.org), full stop at the end of the last sentence is missing: https://tooters.org/@victor/111115391740487664 (scroll down to my post) More examples can be found by [searching mastodon.social for the hashtag #ImageDescription](https://mastodon.social/tags/imagedescription) and finding at my posts. For example: Original Hubzilla comment, very short even: https://hub.netzgemeinde.eu/display/b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vYWFjOWE2YTUtZTc1Zi00Njc5LWFiNjgtNGYyYzI5ZDJmMjI5 Mastodon 4.2.0 (mastodon.hardcoredevs.com), truncated mid-paragraph after the hashtag `#ImageDescription`: https://mastodon.hardcoredevs.com/@Andres/110894302610589500 (my comment is right below) This is a special case because the whole thread was written before Mastodon 4.2.0. Original Hubzilla comment: https://hub.netzgemeinde.eu/display/b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vOGYxYTQwMTUtNTc0Zi00YzEzLThkZTMtNDdhN2ViNGVjYjc1 Mastodon 4.2.1-rc1+pr-27261-37da69c (mastodon.social), entire second paragraph is missing: https://mastodon.social/@hikingdude/111091316259559387 (my comment is right below) Original Hubzilla comment: https://hub.netzgemeinde.eu/display/b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vMDAyMDk4MjgtM2VjOC00MDUwLTlhN2QtMmIzM2M2Njk3OWVj Mastodon 4.2.1-rc1+pr-27261-37da69c (mastodon.social), truncated mid-paragraph after the hashtag `#Friendica`: https://mastodon.social/@urlyman/111028486166963680 (my comment is right below) Original Hubzilla comment: https://hub.netzgemeinde.eu/channel/jupiter_rowland?mid=b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vZDIzY2NkMjItMzUzNy00ODI4LWEzMDgtYjQ5YjY0MGU5MTQx Mastodon 4.2.0 (ieji.de), truncated mid-paragraph after the hashtag `#AltText`: https://ieji.de/@soonix/111008439620893974 (my comment is right below) It also happens to Hubzilla posts. I don't have an example of a Hubzilla post truncated on Mastodon that can be seen by scrolling up from a Mastodon reply, but here is an example with a raw Mastodon link (which will open Hubzilla in a Web browser, though): Original Hubzilla post: https://hub.netzgemeinde.eu/channel/jupiter_rowland?mid=b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vMTM2MmE1NmUtYzU0Ny00MDU4LTgxZGMtNTRiZmMzMzgxNDVh Mastodon 4.2.1-rc1+pr-27261-37da69c (mastodon.social), the last paragraph is missing: https://mastodon.social/@jupiter_rowland@hub.netzgemeinde.eu/111158674653031871 The same may happen to posts from other projects, especially Friendica and (streams). I don't have any evidence of this happening or not happening yet. Also, I can't test this on mobile apps, so I can't say if this is a Web interface or backend issue.  Mastodon instance mastodon.social, fosstodon.org, norden.social, tooters.org, ieji.de, mastodon.hardcoredevs.com  Mastodon version v4.2.0, v4.2.1-rc1+pr-27261-37da69c  Browser name and version Firefox 118.0.1, original Mozilla build  Operating system Debian 13 ""trixie"" (testing)  Technical details _No response_",other-file,"Mastodon 4.2.x randomly truncates posts coming in from at least Hubzilla  Steps to reproduce the problem 1. Have a Hubzilla channel with PubCrawl on and connections on mastodon.social as an example of an instance that runs at least Mastodon 4.2.0. 2. Create a post on Hubzilla, preferably one that's significantly longer than 500 characters. Add at least one not-too-common hashtag so it can be found more easily. 3. Go to `https://mastodon.social/tags/<the hashtag used in the post>` in the Web browser of your choice (tested with the original Mozilla build of Firefox on Debian GNU/Linux). 4. Scroll down until you find your post. 5. Compare how mastodon.social renders your post with what your original Hubzilla post looks like.  Expected behaviour The full post text is always shown on Mastodon.  Actual behaviour Chances are the post is truncated and incomplete.  Detailed description Since Mastodon 4.2.0 was released, it seems to randomly truncate posts from at least Hubzilla. It does so both to posts that came in after the upgrade of an instance to 4.2.x and to posts that have been on an instance before the 4.2.x upgrade. It doesn't happen to each post. It happens both to Hubzilla posts (first posts in a thread) and to Hubzilla comments (replies to posts which are something different on Hubzilla), and it happens to comments on both Mastodon and Hubzilla posts. Also, even truncated posts can still be over 500 characters long on instances that only allow for 500 characters. And posts that are well under 500 characters are truncated, too. There seems to be no pattern. There is nothing that indicates when and why a post is truncated, other than all truncated posts I know about have hashtags in the text rather than all hashtags at the end or no hashtags at all. Also, Hubzilla posts with summaries that became/become Mastodon posts with content warnings seem to never be truncated. That said, posts are never truncated in the middle of a word. The issue clearly lies on Mastodon's side. It started happening with the release of Mastodon 4.2.0 while Hubzilla did not have a new release at that time. Also, Mastodon 4.1.9 shows posts perfectly fine which Mastodon 4.2.0 truncates. Here is a proof, although it's a minor example. Original Hubzilla comment: https://hub.netzgemeinde.eu/display/b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vMzU0NTJkMmQtNDI0OC00NjI5LTg3MjgtZWE0YTlhOWIyNDBk Mastodon 4.1.9 (noc.social) showing the whole post: https://noc.social/@MarvinTheMartian/111115829359100943 (scroll down to my post) Mastodon 4.2.0 (tooters.org), full stop at the end of the last sentence is missing: https://tooters.org/@victor/111115391740487664 (scroll down to my post) More examples can be found by [searching mastodon.social for the hashtag #ImageDescription](https://mastodon.social/tags/imagedescription) and finding at my posts. For example: Original Hubzilla comment, very short even: https://hub.netzgemeinde.eu/display/b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vYWFjOWE2YTUtZTc1Zi00Njc5LWFiNjgtNGYyYzI5ZDJmMjI5 Mastodon 4.2.0 (mastodon.hardcoredevs.com), truncated mid-paragraph after the hashtag `#ImageDescription`: https://mastodon.hardcoredevs.com/@Andres/110894302610589500 (my comment is right below) This is a special case because the whole thread was written before Mastodon 4.2.0. Original Hubzilla comment: https://hub.netzgemeinde.eu/display/b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vOGYxYTQwMTUtNTc0Zi00YzEzLThkZTMtNDdhN2ViNGVjYjc1 Mastodon 4.2.1-rc1+pr-27261-37da69c (mastodon.social), entire second paragraph is missing: https://mastodon.social/@hikingdude/111091316259559387 (my comment is right below) Original Hubzilla comment: https://hub.netzgemeinde.eu/display/b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vMDAyMDk4MjgtM2VjOC00MDUwLTlhN2QtMmIzM2M2Njk3OWVj Mastodon 4.2.1-rc1+pr-27261-37da69c (mastodon.social), truncated mid-paragraph after the hashtag `#Friendica`: https://mastodon.social/@urlyman/111028486166963680 (my comment is right below) Original Hubzilla comment: https://hub.netzgemeinde.eu/channel/jupiter_rowland?mid=b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vZDIzY2NkMjItMzUzNy00ODI4LWEzMDgtYjQ5YjY0MGU5MTQx Mastodon 4.2.0 (ieji.de), truncated mid-paragraph after the hashtag `#AltText`: https://ieji.de/@soonix/111008439620893974 (my comment is right below) It also happens to Hubzilla posts. I don't have an example of a Hubzilla post truncated on Mastodon that can be seen by scrolling up from a Mastodon reply, but here is an example with a raw Mastodon link (which will open Hubzilla in a Web browser, though): Original Hubzilla post: https://hub.netzgemeinde.eu/channel/jupiter_rowland?mid=b64.aHR0cHM6Ly9odWIubmV0emdlbWVpbmRlLmV1L2l0ZW0vMTM2MmE1NmUtYzU0Ny00MDU4LTgxZGMtNTRiZmMzMzgxNDVh Mastodon 4.2.1-rc1+pr-27261-37da69c (mastodon.social), the last paragraph is missing: https://mastodon.social/@jupiter_rowland@hub.netzgemeinde.eu/111158674653031871 The same may happen to posts from other projects, especially Friendica and (streams). I don't have any evidence of this happening or not happening yet. Also, I can't test this on mobile apps, so I can't say if this is a Web interface or backend issue.  Mastodon instance mastodon.social, fosstodon.org, norden.social, tooters.org, ieji.de, mastodon.hardcoredevs.com  Mastodon version v4.2.0, v4.2.1-rc1+pr-27261-37da69c  Browser name and version Firefox 118.0.1, original Mozilla build  Operating system Debian 13 ""trixie"" (testing)  Technical details _No response_ other-file",bug,0.95
33460,mastodon,https://github.com/mastodon/mastodon/issues/33460,"""High contrast"" theme has wrong color in report user modal"," Steps to reproduce the problem 1. Open `/settings/preferences/appearance` 2. Set `Site theme` to `Mastodon (High contrast)` 3. Report someone 4. Open `Are there any posts that back up this report?` modal  Expected behaviour Username and post date are displayed in a readable color  Actual behaviour Username and post date are hard to read  Detailed description Dark | High contrast (wrong)  |  <img width=""363"" alt=""Image"" src=""https://github.com/user-attachments/assets/13d5f159-ce38-4cff-a367-504c815b686f"" /> | <img width=""363"" alt=""Image"" src=""https://github.com/user-attachments/assets/e2605298-25f6-4aa5-bb3b-5b76a3a27095"" /> |  Mastodon instance mastodon.social  Mastodon version v4.4.0-nightly.2025-01-03  Browser name and version Vivaldi 7.0.3495.27 (Chrome/130.0.0.0)  Operating system Windows 11  Technical details - https://github.com/mastodon/mastodon/blob/main/app/javascript/styles/mastodon/components.scss#L1593 - https://github.com/mastodon/mastodon/blob/main/app/javascript/styles/contrast/variables.scss#L20",other-file | other-file,"""High contrast"" theme has wrong color in report user modal  Steps to reproduce the problem 1. Open `/settings/preferences/appearance` 2. Set `Site theme` to `Mastodon (High contrast)` 3. Report someone 4. Open `Are there any posts that back up this report?` modal  Expected behaviour Username and post date are displayed in a readable color  Actual behaviour Username and post date are hard to read  Detailed description Dark | High contrast (wrong)  |  <img width=""363"" alt=""Image"" src=""https://github.com/user-attachments/assets/13d5f159-ce38-4cff-a367-504c815b686f"" /> | <img width=""363"" alt=""Image"" src=""https://github.com/user-attachments/assets/e2605298-25f6-4aa5-bb3b-5b76a3a27095"" /> |  Mastodon instance mastodon.social  Mastodon version v4.4.0-nightly.2025-01-03  Browser name and version Vivaldi 7.0.3495.27 (Chrome/130.0.0.0)  Operating system Windows 11  Technical details - https://github.com/mastodon/mastodon/blob/main/app/javascript/styles/mastodon/components.scss#L1593 - https://github.com/mastodon/mastodon/blob/main/app/javascript/styles/contrast/variables.scss#L20 other-file other-file",no-bug,0.95
30142,mastodon,https://github.com/mastodon/mastodon/issues/30142,Appeal interface should display post content when an appeal is opened for review," Pitch Any content (post, media, or accounts) that is made inaccessible through moderation action should sill be accessible to moderators when an appeal is reviewed. Similarly, if the moderator intervention is overturned then the content should be restored; which is not possible if it's been purged from the system. When intervening with reports, there should be an option to ""deny appeal"" which would have today's behavior of (near) immediate deletion. However, this should require opt-in so that any appeal can be fully actioned.  Motivation While there are definitely compliance cases where media should be immediately purged, offending content should generally be accessible for appeal. The moderation team at SFBA requires that a different moderator than the intervening one reviews any appeal. Not having the context for the posts makes this checked workflow much more difficult; since the content is often deleted before the appeal is filed or reviewed. This aggressive deletion pattern makes auditing and reviewing moderation interventions near impossible at times. ![486-622-max](https://github.com/mastodon/mastodon/assets/6901054/39c77e6b-1538-450c-8fb3-5060fda9b0e1)",source-file | source-file,"Appeal interface should display post content when an appeal is opened for review  Pitch Any content (post, media, or accounts) that is made inaccessible through moderation action should sill be accessible to moderators when an appeal is reviewed. Similarly, if the moderator intervention is overturned then the content should be restored; which is not possible if it's been purged from the system. When intervening with reports, there should be an option to ""deny appeal"" which would have today's behavior of (near) immediate deletion. However, this should require opt-in so that any appeal can be fully actioned.  Motivation While there are definitely compliance cases where media should be immediately purged, offending content should generally be accessible for appeal. The moderation team at SFBA requires that a different moderator than the intervening one reviews any appeal. Not having the context for the posts makes this checked workflow much more difficult; since the content is often deleted before the appeal is filed or reviewed. This aggressive deletion pattern makes auditing and reviewing moderation interventions near impossible at times. ![486-622-max](https://github.com/mastodon/mastodon/assets/6901054/39c77e6b-1538-450c-8fb3-5060fda9b0e1) source-file source-file",no-bug,0.9
30578,mastodon,https://github.com/mastodon/mastodon/issues/30578,"Without ImageMagick, uploading emoji files is not possible"," Steps to reproduce the problem 1. Set an emoji name and select the emoji file 2. Clicking Upload immediately throws an error  Expected behaviour Successful upload and emoji added  Actual behaviour Imediate error, failed upload  Detailed description After #30090, when uploading an emoji file, an error is immediately thrown.  INFO -- : [747998e2-f015-4df6-9828-21284dd45a61] [paperclip] Trying to link /tmp/RackMultipart20240606-4122054-jvtb5n.gif to /tmp/727f3ea9cd9c5f222fec438bb341a8a020240606-4122054-79d0xi.gif INFO -- : [747998e2-f015-4df6-9828-21284dd45a61] Command :: identify -format '%wx%h,%[exif:orientation]' '/tmp/727f3ea9cd9c5f222fec438bb341a8a020240606-4122054-79d0xi.gif[0]' 2>/dev/null INFO -- : [747998e2-f015-4df6-9828-21284dd45a61] method=POST path=/admin/custom_emojis format=html controller=Admin::CustomEmojisController action=create status=500 allocations=3481 duration=45.68 view=0.00 db=11.68 FATAL -- : [747998e2-f015-4df6-9828-21284dd45a61] [747998e2-f015-4df6-9828-21284dd45a61] Paperclip::Errors::CommandNotFoundError (Could not run the `identify` command. Please install ImageMagick.): [747998e2-f015-4df6-9828-21284dd45a61] lib/paperclip/attachment_extensions.rb:21:in `block in post_process_style' [747998e2-f015-4df6-9828-21284dd45a61] lib/paperclip/attachment_extensions.rb:20:in `each' [747998e2-f015-4df6-9828-21284dd45a61] lib/paperclip/attachment_extensions.rb:20:in `inject' [747998e2-f015-4df6-9828-21284dd45a61] lib/paperclip/attachment_extensions.rb:20:in `post_process_style' [747998e2-f015-4df6-9828-21284dd45a61] app/controllers/admin/custom_emojis_controller.rb:21:in `create' [747998e2-f015-4df6-9828-21284dd45a61] app/controllers/concerns/localized.rb:11:in `set_locale' [747998e2-f015-4df6-9828-21284dd45a61] lib/mastodon/rack_middleware.rb:9:in `call'  I enabled `libvips` and uninstalled `ImageMagick`. If emojis are meant to be processed by IM instead, I'll reinstall it again.  Mastodon instance bolha.one  Mastodon version v4.3.0-alpha.4-4655be0  Technical details _No response_",source-file | source-file,"Without ImageMagick, uploading emoji files is not possible  Steps to reproduce the problem 1. Set an emoji name and select the emoji file 2. Clicking Upload immediately throws an error  Expected behaviour Successful upload and emoji added  Actual behaviour Imediate error, failed upload  Detailed description After #30090, when uploading an emoji file, an error is immediately thrown.  INFO -- : [747998e2-f015-4df6-9828-21284dd45a61] [paperclip] Trying to link /tmp/RackMultipart20240606-4122054-jvtb5n.gif to /tmp/727f3ea9cd9c5f222fec438bb341a8a020240606-4122054-79d0xi.gif INFO -- : [747998e2-f015-4df6-9828-21284dd45a61] Command :: identify -format '%wx%h,%[exif:orientation]' '/tmp/727f3ea9cd9c5f222fec438bb341a8a020240606-4122054-79d0xi.gif[0]' 2>/dev/null INFO -- : [747998e2-f015-4df6-9828-21284dd45a61] method=POST path=/admin/custom_emojis format=html controller=Admin::CustomEmojisController action=create status=500 allocations=3481 duration=45.68 view=0.00 db=11.68 FATAL -- : [747998e2-f015-4df6-9828-21284dd45a61] [747998e2-f015-4df6-9828-21284dd45a61] Paperclip::Errors::CommandNotFoundError (Could not run the `identify` command. Please install ImageMagick.): [747998e2-f015-4df6-9828-21284dd45a61] lib/paperclip/attachment_extensions.rb:21:in `block in post_process_style' [747998e2-f015-4df6-9828-21284dd45a61] lib/paperclip/attachment_extensions.rb:20:in `each' [747998e2-f015-4df6-9828-21284dd45a61] lib/paperclip/attachment_extensions.rb:20:in `inject' [747998e2-f015-4df6-9828-21284dd45a61] lib/paperclip/attachment_extensions.rb:20:in `post_process_style' [747998e2-f015-4df6-9828-21284dd45a61] app/controllers/admin/custom_emojis_controller.rb:21:in `create' [747998e2-f015-4df6-9828-21284dd45a61] app/controllers/concerns/localized.rb:11:in `set_locale' [747998e2-f015-4df6-9828-21284dd45a61] lib/mastodon/rack_middleware.rb:9:in `call'  I enabled `libvips` and uninstalled `ImageMagick`. If emojis are meant to be processed by IM instead, I'll reinstall it again.  Mastodon instance bolha.one  Mastodon version v4.3.0-alpha.4-4655be0  Technical details _No response_ source-file source-file",bug,0.9
34235,mastodon,https://github.com/mastodon/mastodon/issues/34235,User export link timeout too short," Steps to reproduce the problem 1. download archive from `/settings/export` 2. the archive fails to download  Expected behaviour the archive should download  Actual behaviour it didn't  Detailed description i notice that in https://github.com/mastodon/mastodon/blob/1960aac90b16fce1ec620ac990aa931efcf04700/app/controllers/backups_controller.rb#L15 the timeout is `10`, given that nothing indicates else, i believe that this is seconds, which is super short, and gives no chances for retrying a download  Mastodon instance _No response_  Mastodon version _No response_  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.4.1) - Node.js version: (from `node --version`, eg. v20.18.0)",source-file,"User export link timeout too short  Steps to reproduce the problem 1. download archive from `/settings/export` 2. the archive fails to download  Expected behaviour the archive should download  Actual behaviour it didn't  Detailed description i notice that in https://github.com/mastodon/mastodon/blob/1960aac90b16fce1ec620ac990aa931efcf04700/app/controllers/backups_controller.rb#L15 the timeout is `10`, given that nothing indicates else, i believe that this is seconds, which is super short, and gives no chances for retrying a download  Mastodon instance _No response_  Mastodon version _No response_  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.4.1) - Node.js version: (from `node --version`, eg. v20.18.0) source-file",no-bug,0.9
30792,mastodon,https://github.com/mastodon/mastodon/issues/30792,LinkCrawlWorker Encoding::UndefinedConversionError," Steps to reproduce the problem Starting seeing a lot of these appear recently, connected to links posted by https://mastodon.social/@ukraineforum `""\xC3"" from ASCII-8BIT to UTF-8 on https://ukraineforum.de/unterstaatssekret%C3%A4r-au%C3%9Fenministerium-gespr%C3%A4chen-kyjiw-eingetroffen-t160676.html?mtm_source=mastodon&mtm_medium=social&mtm_campaign=ma` Encoding fixes just added in #30780 did not cover these.  Expected behaviour No encoding errors  Actual behaviour Errors  Detailed description ![CleanShot 2024-06-21 at 08 05 33@2x](https://github.com/mastodon/mastodon/assets/3002053/19bdeb63-4587-4d0f-b62b-b50a8eed5c2b)  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha.4  Technical details - Mastodon 4.3.0-alpha.4+pr-30780 - Ruby 3.3.3p89 - PostgreSQL 16.3 - Redis 7.2.4 - OpenSearch 2.14.0 - libvips 8.15.2 - FFmpeg 7.0.1",source-file | other-file | source-file,"LinkCrawlWorker Encoding::UndefinedConversionError  Steps to reproduce the problem Starting seeing a lot of these appear recently, connected to links posted by https://mastodon.social/@ukraineforum `""\xC3"" from ASCII-8BIT to UTF-8 on https://ukraineforum.de/unterstaatssekret%C3%A4r-au%C3%9Fenministerium-gespr%C3%A4chen-kyjiw-eingetroffen-t160676.html?mtm_source=mastodon&mtm_medium=social&mtm_campaign=ma` Encoding fixes just added in #30780 did not cover these.  Expected behaviour No encoding errors  Actual behaviour Errors  Detailed description ![CleanShot 2024-06-21 at 08 05 33@2x](https://github.com/mastodon/mastodon/assets/3002053/19bdeb63-4587-4d0f-b62b-b50a8eed5c2b)  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha.4  Technical details - Mastodon 4.3.0-alpha.4+pr-30780 - Ruby 3.3.3p89 - PostgreSQL 16.3 - Redis 7.2.4 - OpenSearch 2.14.0 - libvips 8.15.2 - FFmpeg 7.0.1 source-file other-file source-file",no-bug,0.9
28505,mastodon,https://github.com/mastodon/mastodon/issues/28505,When reporting user: blur images in post list," Pitch In the report user section ""Are there any posts that back up this report?"" it would be nifty if the images were automatically marked as sensitive, i.e. blurred, regardless of what the user being reported set them as.  Motivation When reporting someone for posting rule-violating images users might not want to see the rest of the images posted (maybe not even re-see the one being reporting), but there they are. Background: I reported someone for posting his fave porn into the public feed and got shown a bunch more in the report popup :( This might just be annoying when it's porn, but if someone's posting illegal or just gruesome stuff a blurred view in the reporting popup might save the reporter a lot of anxiety.",other-file | other-file,"When reporting user: blur images in post list  Pitch In the report user section ""Are there any posts that back up this report?"" it would be nifty if the images were automatically marked as sensitive, i.e. blurred, regardless of what the user being reported set them as.  Motivation When reporting someone for posting rule-violating images users might not want to see the rest of the images posted (maybe not even re-see the one being reporting), but there they are. Background: I reported someone for posting his fave porn into the public feed and got shown a bunch more in the report popup :( This might just be annoying when it's porn, but if someone's posting illegal or just gruesome stuff a blurred view in the reporting popup might save the reporter a lot of anxiety. other-file other-file",no-bug,0.9
32458,mastodon,https://github.com/mastodon/mastodon/issues/32458,[RTL] `People to follow` has no way to scroll, Steps to reproduce the problem 1. Make the web interface (4.3.0) RTL. 2. Look at the `people top follow` section ![image](https://github.com/user-attachments/assets/0933a91e-445a-46a6-96d2-a0d41439b79d)  Expected behaviour a button with an arrow to left should be on the left side of the section  Actual behaviour a button with an arrow to right is on the right side of the section doing nothing  Detailed description _No response_  Mastodon instance botsin.space  Mastodon version 4.3.0  Browser name and version Firefox-ESR 128.3.1  Operating system Debian GNU/Linux 12  Technical details _No response_,other-file,[RTL] `People to follow` has no way to scroll  Steps to reproduce the problem 1. Make the web interface (4.3.0) RTL. 2. Look at the `people top follow` section ![image](https://github.com/user-attachments/assets/0933a91e-445a-46a6-96d2-a0d41439b79d)  Expected behaviour a button with an arrow to left should be on the left side of the section  Actual behaviour a button with an arrow to right is on the right side of the section doing nothing  Detailed description _No response_  Mastodon instance botsin.space  Mastodon version 4.3.0  Browser name and version Firefox-ESR 128.3.1  Operating system Debian GNU/Linux 12  Technical details _No response_ other-file,no-bug,0.9
29561,mastodon,https://github.com/mastodon/mastodon/issues/29561,Old Explore Icon in Advanced Interface," Steps to reproduce the problem Under ""Getting Started"", the old ""# Explore"" option is present in the column.  Expected behaviour The modern compass Explorer icon should be present.  Actual behaviour The hashtag icon is displayed next to Explore.  Detailed description When clicking on Explore, the new icon is used at the top of the Explore column, it just doesn't show on the Getting Started tab.  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-02-23  Browser name and version Firefox 123.0.1  Operating system Windows 11 22H2  Technical details _No response_",other-file,"Old Explore Icon in Advanced Interface  Steps to reproduce the problem Under ""Getting Started"", the old ""# Explore"" option is present in the column.  Expected behaviour The modern compass Explorer icon should be present.  Actual behaviour The hashtag icon is displayed next to Explore.  Detailed description When clicking on Explore, the new icon is used at the top of the Explore column, it just doesn't show on the Getting Started tab.  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-02-23  Browser name and version Firefox 123.0.1  Operating system Windows 11 22H2  Technical details _No response_ other-file",no-bug,0.95
31091,mastodon,https://github.com/mastodon/mastodon/issues/31091,"Duplicate key ""orderedItems"" in outbox.json when exporting a user's archive"," Steps to reproduce the problem 1. Export a user's archive 2. Download & extract the archive 3. Look at outbox.json 4. There's two ""orderedItems"" keys! ![image](https://github.com/user-attachments/assets/eb69d63e-eb76-462e-a0f1-69b4600337ca) (originally [reported on glitch-soc](https://github.com/glitch-soc/mastodon/issues/2787) but was told that it's also happening upstream)  Expected behaviour There should only be one ""orderedItems"" key  Actual behaviour There were two ""orderedItems"" keys, one of which was a blank array  Detailed description _No response_  Mastodon instance _No response_  Mastodon version v4.3.0-alpha.5+glitch  Technical details _No response_",source-file | source-file | source-file | source-file | source-file | source-file | source-file,"Duplicate key ""orderedItems"" in outbox.json when exporting a user's archive  Steps to reproduce the problem 1. Export a user's archive 2. Download & extract the archive 3. Look at outbox.json 4. There's two ""orderedItems"" keys! ![image](https://github.com/user-attachments/assets/eb69d63e-eb76-462e-a0f1-69b4600337ca) (originally [reported on glitch-soc](https://github.com/glitch-soc/mastodon/issues/2787) but was told that it's also happening upstream)  Expected behaviour There should only be one ""orderedItems"" key  Actual behaviour There were two ""orderedItems"" keys, one of which was a blank array  Detailed description _No response_  Mastodon instance _No response_  Mastodon version v4.3.0-alpha.5+glitch  Technical details _No response_ source-file source-file source-file source-file source-file source-file source-file",bug,0.85
29793,mastodon,https://github.com/mastodon/mastodon/issues/29793,Automatic (use system theme) uses dark `theme-color` in light mode," Steps to reproduce the problem 1. In Settings, choose Automatic (use system theme) as the UI theme 2. Set system to light mode  Expected behaviour The `theme-color` meta tag (and thus the browser chrome) should match the light/dark mode  Actual behaviour The `theme-color` meta tag stays set to a dark color when the system and site are in light mode  Detailed description How it appears on macOS with Safaris compact UI: <img width=""1117"" alt=""Screenshot 2024-03-28 at 4 30 17 PM"" src=""https://github.com/mastodon/mastodon/assets/3615519/24fa9faa-9d8a-4bf5-b278-5e9ba099b86d""> And iOS: ![Simulator Screenshot - iPhone 15 - 2024-03-28 at 16 37 02](https://github.com/mastodon/mastodon/assets/3615519/01427304-1b48-43a1-8707-aaee414b8ba3)  Mastodon instance mastodon.online  Mastodon version v4.3.0-nightly.2024-03-27  Browser name and version Safari 17.4.1  Operating system macOS 14.4.1  Technical details The problem tag: `<meta content=""#191b22"" name=""theme-color>` Per https://webkit.org/blog/11989/new-webkit-features-in-safari-15/, that tag supports media queries for light and dark mode.",source-file | source-file | other-file,"Automatic (use system theme) uses dark `theme-color` in light mode  Steps to reproduce the problem 1. In Settings, choose Automatic (use system theme) as the UI theme 2. Set system to light mode  Expected behaviour The `theme-color` meta tag (and thus the browser chrome) should match the light/dark mode  Actual behaviour The `theme-color` meta tag stays set to a dark color when the system and site are in light mode  Detailed description How it appears on macOS with Safaris compact UI: <img width=""1117"" alt=""Screenshot 2024-03-28 at 4 30 17 PM"" src=""https://github.com/mastodon/mastodon/assets/3615519/24fa9faa-9d8a-4bf5-b278-5e9ba099b86d""> And iOS: ![Simulator Screenshot - iPhone 15 - 2024-03-28 at 16 37 02](https://github.com/mastodon/mastodon/assets/3615519/01427304-1b48-43a1-8707-aaee414b8ba3)  Mastodon instance mastodon.online  Mastodon version v4.3.0-nightly.2024-03-27  Browser name and version Safari 17.4.1  Operating system macOS 14.4.1  Technical details The problem tag: `<meta content=""#191b22"" name=""theme-color>` Per https://webkit.org/blog/11989/new-webkit-features-in-safari-15/, that tag supports media queries for light and dark mode. source-file source-file other-file",no-bug,0.95
30123,mastodon,https://github.com/mastodon/mastodon/issues/30123,Confirmation modal for boosts appears at the bottom of the page in advanced web interface," Steps to reproduce the problem Try to boost a post with confirmation modal enabled  Expected behaviour Boost modal appears in the middle of the page  Actual behaviour Boost modal appears at the bottom of the page  Detailed description There's probably a media query / breakpoint being set for some CSS that moves the modal to the bottom, but it seems to only account for the default/simple UI and not the advanced UI. This bug is hitting me even at 1021px wide.  Mastodon instance mastodon.social v4.3.0-nightly.2024-04-29",other-file,"Confirmation modal for boosts appears at the bottom of the page in advanced web interface  Steps to reproduce the problem Try to boost a post with confirmation modal enabled  Expected behaviour Boost modal appears in the middle of the page  Actual behaviour Boost modal appears at the bottom of the page  Detailed description There's probably a media query / breakpoint being set for some CSS that moves the modal to the bottom, but it seems to only account for the default/simple UI and not the advanced UI. This bug is hitting me even at 1021px wide.  Mastodon instance mastodon.social v4.3.0-nightly.2024-04-29 other-file",no-bug,0.95
30863,mastodon,https://github.com/mastodon/mastodon/issues/30863,LinkCrawlWorker NoMethodError: undefined method `[]' for nil, Steps to reproduce the problem Generated by these status/links: https://mastodon.online/users/michael_w_busch/statuses/112689809505071015 https://www.mprnews.org/story/2024/06/26/new-facial-recognition-to-add-more-layers-to-mall-of-america-security  Expected behaviour No error  Actual behaviour Error  Detailed description _No response_  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha.4  Technical details ![CleanShot 2024-06-27 at 13 19 37@2x](https://github.com/mastodon/mastodon/assets/3002053/e7450f70-c873-4592-9c7e-fe83b598fdbc),source-file | source-file,LinkCrawlWorker NoMethodError: undefined method `[]' for nil  Steps to reproduce the problem Generated by these status/links: https://mastodon.online/users/michael_w_busch/statuses/112689809505071015 https://www.mprnews.org/story/2024/06/26/new-facial-recognition-to-add-more-layers-to-mall-of-america-security  Expected behaviour No error  Actual behaviour Error  Detailed description _No response_  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha.4  Technical details ![CleanShot 2024-06-27 at 13 19 37@2x](https://github.com/mastodon/mastodon/assets/3002053/e7450f70-c873-4592-9c7e-fe83b598fdbc) source-file source-file,no-bug,0.8
32030,mastodon,https://github.com/mastodon/mastodon/issues/32030,Reply-All button shifts action bar icons to the side," Steps to reproduce the problem ![Mastodon web interface. One action-bar with a 0-comments thread-icon, and one action bar with a 1 comment, single-thread icon. The remaining icons (share, fav, save, menu) are offset by a couple of pixels.](https://github.com/user-attachments/assets/4e6148d7-5641-415c-86a4-90c7884d0cac) Same, but on 4.3 mastodon.social (as of creating the ticket) ![image](https://github.com/user-attachments/assets/19059e6a-e408-46ee-8b52-bf26d825c8bc)  Expected behaviour The action-bar is a static grid with space allocated for each button. Changing the width of one element, shouldn't affect the other elements (within reasonable limits).  Actual behaviour As the reply-all button is wider than the reply button the action bar icons realign.  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.2.12 & v4.3.0-nightly.2024-09-23  Browser name and version Edge 129  Operating system Windows 11, 23h2  Technical details _No response_",other-file | other-file,"Reply-All button shifts action bar icons to the side  Steps to reproduce the problem ![Mastodon web interface. One action-bar with a 0-comments thread-icon, and one action bar with a 1 comment, single-thread icon. The remaining icons (share, fav, save, menu) are offset by a couple of pixels.](https://github.com/user-attachments/assets/4e6148d7-5641-415c-86a4-90c7884d0cac) Same, but on 4.3 mastodon.social (as of creating the ticket) ![image](https://github.com/user-attachments/assets/19059e6a-e408-46ee-8b52-bf26d825c8bc)  Expected behaviour The action-bar is a static grid with space allocated for each button. Changing the width of one element, shouldn't affect the other elements (within reasonable limits).  Actual behaviour As the reply-all button is wider than the reply button the action bar icons realign.  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.2.12 & v4.3.0-nightly.2024-09-23  Browser name and version Edge 129  Operating system Windows 11, 23h2  Technical details _No response_ other-file other-file",no-bug,0.95
28539,mastodon,https://github.com/mastodon/mastodon/issues/28539,Streaming endpoint on Vagrant sends 301 redirect to localhost," Steps to reproduce the problem I wanted to test an in-development Mastodon client's use of the streaming API endpoints such as `/api/v1/streaming/user`, so I set up a development instance using Vagrant as follows: 1. cloned the git repo on Ubuntu 22.04, obtaining the head commit 6374358357ee81b5f137f471f028a56974109155 2. ran `vagrant up` in the root of the checkout, and authorised it to add `mastodon.local` to my `/etc/hosts` 3. ran the suggested startup command `vagrant ssh -c ""cd /vagrant && foreman start""` 4. created a test user on the instance using the web UI, and authenticated my test client The client tried to access the streaming API, by sending an HTTP request as follows (observed via `strace`, since in this environment we're using cleartext HTTP):  GET /api/v1/streaming/user HTTP/1.1 authorization: Bearer LHfBPlUXWkgVSZl5DMSiBOTD1CeaidAWwWs8TiUKmUk accept: */* host: mastodon.local   Expected behaviour I expected that this GET request would return a 200 status and begin delivering chunked data, starting with a line such as "":)"" and continuing with "":thump"" heartbeats interleaved with update events.  Actual behaviour The web server on the Vagrant instance returned a 301 redirect to a URL on ""localhost"", so my client next tried to connect to the host machine, and got 404 because _that_ web server knows nothing about the test Mastodon instance.  Detailed description The full HTTP response from the Mastodon test server was:  HTTP/1.1 301 Moved Permanently X-Frame-Options: SAMEORIGIN X-XSS-Protection: 0 X-Content-Type-Options: nosniff X-Download-Options: noopen X-Permitted-Cross-Domain-Policies: none Referrer-Policy: strict-origin-when-cross-origin X-RateLimit-Limit: 300 X-RateLimit-Remaining: 299 X-RateLimit-Reset: 2023-12-31T14:55:00.170985Z Location: http://localhost/api/v1/streaming/user Content-Type: text/html; charset=utf-8 Cache-Control: private, no-store Content-Security-Policy: default-src 'none'; frame-ancestors 'none'; form-action 'none' X-Request-Id: 0b582768-c006-4a45-b808-49803c87e1d4 X-Runtime: 0.126129 Server-Timing: cache_read.active_support;dur=0.02, sql.active_record;dur=0.66, cache_generate.active_support;dur=1.31, cache_write.active_support;dur=0.11, instantiation.active_record;dur=0.23, start_processing.action_controller;dur=0.00, redirect_to.action_controller;dur=0.03, process_action.action_controller;dur=7.38 vary: Authorization, Origin Content-Length: 0   Mastodon instance mastodon.local (installed via Vagrant)  Mastodon version v4.3.0-alpha.0  Technical details Software versions that `vagrant up` installed for me:  vagrant@mastodon:~$ ruby --version ruby 3.2.2 (2023-03-30 revision e51014f9c0) [x86_64-linux] vagrant@mastodon:~$ node --version v20.10.0 ",source-file,"Streaming endpoint on Vagrant sends 301 redirect to localhost  Steps to reproduce the problem I wanted to test an in-development Mastodon client's use of the streaming API endpoints such as `/api/v1/streaming/user`, so I set up a development instance using Vagrant as follows: 1. cloned the git repo on Ubuntu 22.04, obtaining the head commit 6374358357ee81b5f137f471f028a56974109155 2. ran `vagrant up` in the root of the checkout, and authorised it to add `mastodon.local` to my `/etc/hosts` 3. ran the suggested startup command `vagrant ssh -c ""cd /vagrant && foreman start""` 4. created a test user on the instance using the web UI, and authenticated my test client The client tried to access the streaming API, by sending an HTTP request as follows (observed via `strace`, since in this environment we're using cleartext HTTP):  GET /api/v1/streaming/user HTTP/1.1 authorization: Bearer LHfBPlUXWkgVSZl5DMSiBOTD1CeaidAWwWs8TiUKmUk accept: */* host: mastodon.local   Expected behaviour I expected that this GET request would return a 200 status and begin delivering chunked data, starting with a line such as "":)"" and continuing with "":thump"" heartbeats interleaved with update events.  Actual behaviour The web server on the Vagrant instance returned a 301 redirect to a URL on ""localhost"", so my client next tried to connect to the host machine, and got 404 because _that_ web server knows nothing about the test Mastodon instance.  Detailed description The full HTTP response from the Mastodon test server was:  HTTP/1.1 301 Moved Permanently X-Frame-Options: SAMEORIGIN X-XSS-Protection: 0 X-Content-Type-Options: nosniff X-Download-Options: noopen X-Permitted-Cross-Domain-Policies: none Referrer-Policy: strict-origin-when-cross-origin X-RateLimit-Limit: 300 X-RateLimit-Remaining: 299 X-RateLimit-Reset: 2023-12-31T14:55:00.170985Z Location: http://localhost/api/v1/streaming/user Content-Type: text/html; charset=utf-8 Cache-Control: private, no-store Content-Security-Policy: default-src 'none'; frame-ancestors 'none'; form-action 'none' X-Request-Id: 0b582768-c006-4a45-b808-49803c87e1d4 X-Runtime: 0.126129 Server-Timing: cache_read.active_support;dur=0.02, sql.active_record;dur=0.66, cache_generate.active_support;dur=1.31, cache_write.active_support;dur=0.11, instantiation.active_record;dur=0.23, start_processing.action_controller;dur=0.00, redirect_to.action_controller;dur=0.03, process_action.action_controller;dur=7.38 vary: Authorization, Origin Content-Length: 0   Mastodon instance mastodon.local (installed via Vagrant)  Mastodon version v4.3.0-alpha.0  Technical details Software versions that `vagrant up` installed for me:  vagrant@mastodon:~$ ruby --version ruby 3.2.2 (2023-03-30 revision e51014f9c0) [x86_64-linux] vagrant@mastodon:~$ node --version v20.10.0  source-file",bug,0.95
32374,mastodon,https://github.com/mastodon/mastodon/issues/32374,"""Mark every notification as read"" not working when scrolled down in notifications column"," Steps to reproduce the problem 1. navigate to `<yourinstance>/deck/getting-started` 2. get a notification 3. scroll down in notifications 4. click the double check mark button on top to mark every notification as read  Expected behaviour ""Mark every notification as read"" button should mark notifications read even when scrolled down  Actual behaviour ""Mark every notification as read"" button does not mark notifications read even when scrolled down  Detailed description The ""Mark every notification as read"" button on top of the notifications column in the deck view does not work when scrolled down in the notifications view. It only works when scrolled all the way to the top.  Mastodon instance vis.social  Mastodon version v4.3.0  Browser name and version Firefox 131.0 (aarch64)  Operating system macOS 14.6.1  Technical details _No response_",source-file,"""Mark every notification as read"" not working when scrolled down in notifications column  Steps to reproduce the problem 1. navigate to `<yourinstance>/deck/getting-started` 2. get a notification 3. scroll down in notifications 4. click the double check mark button on top to mark every notification as read  Expected behaviour ""Mark every notification as read"" button should mark notifications read even when scrolled down  Actual behaviour ""Mark every notification as read"" button does not mark notifications read even when scrolled down  Detailed description The ""Mark every notification as read"" button on top of the notifications column in the deck view does not work when scrolled down in the notifications view. It only works when scrolled all the way to the top.  Mastodon instance vis.social  Mastodon version v4.3.0  Browser name and version Firefox 131.0 (aarch64)  Operating system macOS 14.6.1  Technical details _No response_ source-file",no-bug,0.9
30860,mastodon,https://github.com/mastodon/mastodon/issues/30860,Unable to link to URLs ending with a @, Steps to reproduce the problem 1. Look at this post: https://mastodon.gamedev.place/@CarePackage17/112688958098239356 2. Try clicking the link 3. Observe it leads to a 404 instead of https://gta.fandom.com/wiki/TW@  Expected behaviour The link should include the @ as part of its URL: https://gta.fandom.com/wiki/TW@  Actual behaviour the link gets broken  Detailed description _No response_  Mastodon instance mastodon.gamedev.place  Mastodon version 4.2.9  Browser name and version Firefox Nightly 129  Operating system Android  Technical details _No response_,source-file | source-file,Unable to link to URLs ending with a @  Steps to reproduce the problem 1. Look at this post: https://mastodon.gamedev.place/@CarePackage17/112688958098239356 2. Try clicking the link 3. Observe it leads to a 404 instead of https://gta.fandom.com/wiki/TW@  Expected behaviour The link should include the @ as part of its URL: https://gta.fandom.com/wiki/TW@  Actual behaviour the link gets broken  Detailed description _No response_  Mastodon instance mastodon.gamedev.place  Mastodon version 4.2.9  Browser name and version Firefox Nightly 129  Operating system Android  Technical details _No response_ source-file source-file,bug,0.9
34557,mastodon,https://github.com/mastodon/mastodon/issues/34557,`this.props.actions is undefined` on Actions modal when opening edit history on mobile view," Steps to reproduce the problem 1. Open a mobile device or use the devtools of a desktop browser to emulate a mobile device (and refresh the page!) 2. Go to mastodon.social (or any Mastodon instance) and log in 3. Resolve the post `https://mastodon.catgirl.cloud/@sophie144p/114361912718260123` by entering it in the search bar (if on mastodon.social: `https://mastodon.social/@sophie144p@catgirl.cloud/114361912845612037`) 4. Click on the edit history  Expected behaviour Mastodon does not crash  Actual behaviour Mastodon does crash  Detailed description _No response_  Mastodon instance mastodon.social, (mastodon.catgirl.cloud)  Mastodon version Mastodon v4.4.0-nightly.2025-04-15, (custom fork)  Browser name and version Firefox 136.0  Operating system NixOS unstable  Technical details Not sure how exactly it happens, but it seems like the Actions modal just gets called without an `actions` property.  TypeError: this.props.actions is undefined render@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:1986902 Cs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2390389 Es@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2390188 kl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2433226 yc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2421527 pc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2421455 gc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2421316 rc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2418151 lc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2418533 Zi@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2359682 ac/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416106 VoidFunction*ac@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416082 nc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2415555 enqueueSetState@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2382096 b.prototype.setState@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2442569 n.componentDidMount/this.unlisten<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:248849 a@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451133 p/notifyListeners/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451363 notifyListeners@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451333 S@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:452352 k/push/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:453370 confirmTransitionTo@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451073 push@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:453155 l.push@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:430549 _ensureHistoryBuffer@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2251325 componentDidUpdate@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2250714 vl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2413473 yl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2413159 bl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2412703 wc/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2424366 wc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2424868 lc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2418680 Zi@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2359682 ac/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416106 VoidFunction*ac@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416082 nc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2415555 So@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2376150 Eo/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2376009 H/s/notify/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 f@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:213657 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 H/s/notify/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 f@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:213657 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 H/s/notify/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 f@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:213657 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 H/s/notify/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 O/</</</subscribe/t<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:188880 l/p/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:402688 render (webpack:app/javascript/mastodon/features/ui/components/actions_modal.jsx:42:11) jj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:203:188) hj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:202:148) null,Zf(d)?(f=!0,cg (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:291:171) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:391) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:322) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:179) Nk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:270:87) Ck (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:272:299) jg (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:127:104) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:272) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:247) yi (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:265:335) isMounted (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:182:224) setState (webpack:node_modules/react/cjs/react.production.min.js:12:236) this.props.history.listen(function (webpack:node_modules/react-router/esm/react-router.js:270:17) listener (webpack:node_modules/history/esm/history.js:155:23) listeners.forEach(function (webpack:node_modules/history/esm/history.js:173:22) listeners.forEach(function (webpack:node_modules/history/esm/history.js:172:14) setState (webpack:node_modules/history/esm/history.js:288:22) globalHistory.pushState (webpack:node_modules/history/esm/history.js:369:10) prompt (webpack:node_modules/history/esm/history.js:145:6) transitionManager.confirmTransitionTo (webpack:node_modules/history/esm/history.js:350:22) push (webpack:app/javascript/mastodon/components/router.tsx:69:2) _ensureHistoryBuffer (webpack:app/javascript/mastodon/components/modal_root.jsx:123:19) this._handleModalOpen (webpack:app/javascript/mastodon/components/modal_root.jsx:92:11) kk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:260:315) ik (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:259:445) ek (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:258:430) Wk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:282:95) Sk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:280:400) Ck (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:272:438) jg (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:127:104) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:272) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:247) yi (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:265:335) ci (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:167:246) ci (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:167:106) defaultNoopBatch( (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) childPropsSelector (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:657:8) handleChangeWrapper (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) defaultNoopBatch( (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) childPropsSelector (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:657:8) handleChangeWrapper (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) defaultNoopBatch( (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) childPropsSelector (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:657:8) handleChangeWrapper (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) defaultNoopBatch( (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) handleChangeWrapper (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) listener (webpack:src/autoBatchEnhancer.ts:79:66) Error (webpack:node_modules/redux/dist/redux.legacy-esm.js:166:6) ",other-file | other-file | other-file | other-file,"`this.props.actions is undefined` on Actions modal when opening edit history on mobile view  Steps to reproduce the problem 1. Open a mobile device or use the devtools of a desktop browser to emulate a mobile device (and refresh the page!) 2. Go to mastodon.social (or any Mastodon instance) and log in 3. Resolve the post `https://mastodon.catgirl.cloud/@sophie144p/114361912718260123` by entering it in the search bar (if on mastodon.social: `https://mastodon.social/@sophie144p@catgirl.cloud/114361912845612037`) 4. Click on the edit history  Expected behaviour Mastodon does not crash  Actual behaviour Mastodon does crash  Detailed description _No response_  Mastodon instance mastodon.social, (mastodon.catgirl.cloud)  Mastodon version Mastodon v4.4.0-nightly.2025-04-15, (custom fork)  Browser name and version Firefox 136.0  Operating system NixOS unstable  Technical details Not sure how exactly it happens, but it seems like the Actions modal just gets called without an `actions` property.  TypeError: this.props.actions is undefined render@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:1986902 Cs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2390389 Es@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2390188 kl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2433226 yc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2421527 pc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2421455 gc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2421316 rc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2418151 lc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2418533 Zi@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2359682 ac/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416106 VoidFunction*ac@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416082 nc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2415555 enqueueSetState@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2382096 b.prototype.setState@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2442569 n.componentDidMount/this.unlisten<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:248849 a@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451133 p/notifyListeners/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451363 notifyListeners@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451333 S@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:452352 k/push/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:453370 confirmTransitionTo@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:451073 push@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:453155 l.push@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:430549 _ensureHistoryBuffer@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2251325 componentDidUpdate@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2250714 vl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2413473 yl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2413159 bl@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2412703 wc/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2424366 wc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2424868 lc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2418680 Zi@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2359682 ac/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416106 VoidFunction*ac@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2416082 nc@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2415555 So@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2376150 Eo/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:2376009 H/s/notify/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 f@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:213657 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 H/s/notify/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 f@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:213657 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 H/s/notify/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 f@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:213657 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 H/s/notify/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208777 R@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208506 notify@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208752 notifyNestedSubs@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:209252 o@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:208607 O/</</</subscribe/t<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:188880 l/p/<@https://mastodon.social/packs/js/common-61cd48a72602edfbf50e.js:2:402688 render (webpack:app/javascript/mastodon/features/ui/components/actions_modal.jsx:42:11) jj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:203:188) hj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:202:148) null,Zf(d)?(f=!0,cg (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:291:171) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:391) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:322) tj (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:279:179) Nk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:270:87) Ck (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:272:299) jg (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:127:104) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:272) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:247) yi (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:265:335) isMounted (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:182:224) setState (webpack:node_modules/react/cjs/react.production.min.js:12:236) this.props.history.listen(function (webpack:node_modules/react-router/esm/react-router.js:270:17) listener (webpack:node_modules/history/esm/history.js:155:23) listeners.forEach(function (webpack:node_modules/history/esm/history.js:173:22) listeners.forEach(function (webpack:node_modules/history/esm/history.js:172:14) setState (webpack:node_modules/history/esm/history.js:288:22) globalHistory.pushState (webpack:node_modules/history/esm/history.js:369:10) prompt (webpack:node_modules/history/esm/history.js:145:6) transitionManager.confirmTransitionTo (webpack:node_modules/history/esm/history.js:350:22) push (webpack:app/javascript/mastodon/components/router.tsx:69:2) _ensureHistoryBuffer (webpack:app/javascript/mastodon/components/modal_root.jsx:123:19) this._handleModalOpen (webpack:app/javascript/mastodon/components/modal_root.jsx:92:11) kk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:260:315) ik (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:259:445) ek (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:258:430) Wk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:282:95) Sk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:280:400) Ck (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:272:438) jg (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:127:104) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:272) Dk (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:266:247) yi (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:265:335) ci (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:167:246) ci (webpack:node_modules/react-dom/cjs/react-dom.production.min.js:167:106) defaultNoopBatch( (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) childPropsSelector (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:657:8) handleChangeWrapper (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) defaultNoopBatch( (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) childPropsSelector (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:657:8) handleChangeWrapper (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) defaultNoopBatch( (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) childPropsSelector (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:657:8) handleChangeWrapper (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) defaultNoopBatch( (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:358:19) defaultNoopBatch (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:342:2) notify (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:355:6) notifyNestedSubs (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:424:14) handleChangeWrapper (webpack:node_modules/react-redux/dist/react-redux.legacy-esm.js:428:19) listener (webpack:src/autoBatchEnhancer.ts:79:66) Error (webpack:node_modules/redux/dist/redux.legacy-esm.js:166:6)  other-file other-file other-file other-file",no-bug,0.9
31385,mastodon,https://github.com/mastodon/mastodon/issues/31385,"Can we get a line above the new ""Some replies from other servers are not displayed"" message","Last week y'all were talking about adding a message to the end of comment threads to show replies may be missing. Today I see you did this ![screenshot](https://github.com/user-attachments/assets/ad42b33a-f46f-4795-8eab-752edd9af71b) I like this feature, but could we get like a horizontal line, separating the final user message, from this server status message? My poor easily-baffled neurology wants to group the server status text as part of the post because there is no visual separation between them. But they're unrelated. It is distracting. If you want to indicate that the division between the post and the server message is of a different nature than lines dividing posts, you could make the line less wide than the full content area, or make it a different shade of gray.  And another thing The visual confusion I feel here is increased by the fact that if you select the final post in a thread, there *is* a line at the end. ![image](https://github.com/user-attachments/assets/6156961d-a8f5-4f0c-aba9-d44c0c2f9ab9)  Configuration I am seeing this in v4.3.0-nightly.2024-08-12 on mastodon.social in Chrome. I am using Advanced Mode in the above screenshots but I checked and it is the same in Regular Mode",other-file | other-file | other-file,"Can we get a line above the new ""Some replies from other servers are not displayed"" message Last week y'all were talking about adding a message to the end of comment threads to show replies may be missing. Today I see you did this ![screenshot](https://github.com/user-attachments/assets/ad42b33a-f46f-4795-8eab-752edd9af71b) I like this feature, but could we get like a horizontal line, separating the final user message, from this server status message? My poor easily-baffled neurology wants to group the server status text as part of the post because there is no visual separation between them. But they're unrelated. It is distracting. If you want to indicate that the division between the post and the server message is of a different nature than lines dividing posts, you could make the line less wide than the full content area, or make it a different shade of gray.  And another thing The visual confusion I feel here is increased by the fact that if you select the final post in a thread, there *is* a line at the end. ![image](https://github.com/user-attachments/assets/6156961d-a8f5-4f0c-aba9-d44c0c2f9ab9)  Configuration I am seeing this in v4.3.0-nightly.2024-08-12 on mastodon.social in Chrome. I am using Advanced Mode in the above screenshots but I checked and it is the same in Regular Mode other-file other-file other-file",no-bug,0.95
28193,mastodon,https://github.com/mastodon/mastodon/issues/28193,No notification sounds on 456597d," Steps to reproduce the problem 1. Upgrade to 456597d 2. Receive a notification 3. Hear no sounds even if it's on   Expected behaviour The boop mp3/ogg should play  Actual behaviour No sounds  Detailed description _No response_  Mastodon instance mementomori.social  Mastodon version v4.3.0-alpha.0  Browser name and version Google Chrome, Version 119.0.6045.199 (Official Build) (64-bit) + Firefox 120.0 (64-bit)  Operating system Pop!_OS 22.04 LTS  Technical details _No response_",source-file,"No notification sounds on 456597d  Steps to reproduce the problem 1. Upgrade to 456597d 2. Receive a notification 3. Hear no sounds even if it's on   Expected behaviour The boop mp3/ogg should play  Actual behaviour No sounds  Detailed description _No response_  Mastodon instance mementomori.social  Mastodon version v4.3.0-alpha.0  Browser name and version Google Chrome, Version 119.0.6045.199 (Official Build) (64-bit) + Firefox 120.0 (64-bit)  Operating system Pop!_OS 22.04 LTS  Technical details _No response_ source-file",no-bug,0.9
34080,mastodon,https://github.com/mastodon/mastodon/issues/34080,Streaming server can't deal with unix socket path in DATABASE_URL," Steps to reproduce the problem Use unix socket as the method to access Postgres, with username and password set, by setting `DATABASE_URL` to this value:  DATABASE_URL=postgresql://<username>:<password>@%2F<path>%2F<to>%2F<socket>/<database_name>?host=/<path>/<to>/<socket>  This URL works well with `web` container.  Expected behaviour Streaming server boots up  Actual behaviour Streaming server won't boot due to missing port number  Detailed description I can add this small patch in `database.js`: js // if (env.DATABASE_URL_STREAMING) { baseConfig = pgConnectionString.parse(env.DATABASE_URL_STREAMING); } else if (env.DATABASE_URL) { //  And add a additional environment variable as workaround:  DATABASE_URL_STREAMING=socket://<username>:<password>@/<path>/<to>/<socket>?db=<database_name>   Mastodon instance N/A  Mastodon version v4.3.4  Environment N/A  Technical details Error before mitigation applied:  Node.js v20.18.0 file:opt/mastodon/streaming/database.js:55 throw new Error('Invalid port specified in DATABASE_URL environment variable'); ^ Error: Invalid port specified in DATABASE_URL environment variable at Module.configFromEnv (file:opt/mastodon/streaming/database.js:55:15) at startServer (file:opt/mastodon/streaming/index.js:104:44) at file:opt/mastodon/streaming/index.js:1401:1 at ModuleJob.run (node:internal/modules/esm/module_job:234:25) at async ModuleLoader.import (node:internal/modules/esm/loader:473:24) at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:123:5) ",source-file | source-file,"Streaming server can't deal with unix socket path in DATABASE_URL  Steps to reproduce the problem Use unix socket as the method to access Postgres, with username and password set, by setting `DATABASE_URL` to this value:  DATABASE_URL=postgresql://<username>:<password>@%2F<path>%2F<to>%2F<socket>/<database_name>?host=/<path>/<to>/<socket>  This URL works well with `web` container.  Expected behaviour Streaming server boots up  Actual behaviour Streaming server won't boot due to missing port number  Detailed description I can add this small patch in `database.js`: js // if (env.DATABASE_URL_STREAMING) { baseConfig = pgConnectionString.parse(env.DATABASE_URL_STREAMING); } else if (env.DATABASE_URL) { //  And add a additional environment variable as workaround:  DATABASE_URL_STREAMING=socket://<username>:<password>@/<path>/<to>/<socket>?db=<database_name>   Mastodon instance N/A  Mastodon version v4.3.4  Environment N/A  Technical details Error before mitigation applied:  Node.js v20.18.0 file:opt/mastodon/streaming/database.js:55 throw new Error('Invalid port specified in DATABASE_URL environment variable'); ^ Error: Invalid port specified in DATABASE_URL environment variable at Module.configFromEnv (file:opt/mastodon/streaming/database.js:55:15) at startServer (file:opt/mastodon/streaming/index.js:104:44) at file:opt/mastodon/streaming/index.js:1401:1 at ModuleJob.run (node:internal/modules/esm/module_job:234:25) at async ModuleLoader.import (node:internal/modules/esm/loader:473:24) at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:123:5)  source-file source-file",no-bug,0.9
31611,mastodon,https://github.com/mastodon/mastodon/issues/31611,There is an issue with an additional symbol , Steps to reproduce the problem mastodon:v4.3.0-beta.1 There is an issue with an additional symbol  ![image](https://github.com/user-attachments/assets/2297308a-e3e5-4899-b3b8-3c905a234a28),config-file,There is an issue with an additional symbol   Steps to reproduce the problem mastodon:v4.3.0-beta.1 There is an issue with an additional symbol  ![image](https://github.com/user-attachments/assets/2297308a-e3e5-4899-b3b8-3c905a234a28) config-file,no-bug,0.7
30587,mastodon,https://github.com/mastodon/mastodon/issues/30587,"Extra '@context' in 'outbox.jon' when archive export is generated, fails validation"," Steps to reproduce the problem 1. Request data archive 2. Download archive 3. Extract archive, open 'outbox.json' 4. Validate JSON, which fails  Expected behaviour A single `@context` key  Actual behaviour A second `@context` key is present  Detailed description As far as I have been able to determine, this was introduced between December 31st and February 14th, which are the dates of the two exports we can test against; the former opens and validates just fine, while the latter throws an error. If the second `@context`, which as far as I can tell contains no actual data, is removed, the file validates. This happens both in larger exports, with over 17.000 items, as well as a small one, with just 111 'orderedItems', exported right before creating this ticket. See attached screenshot from the VDT Labs JSON Editor. Comparing the dates with available releases, this may have been introduced in 4.2.4, 4.2.5, or 4.2.6? ![Screenshot 2024-06-07 at 08 17 15-optimised](https://github.com/mastodon/mastodon/assets/91268/65d42d5e-dfc3-4c90-b088-8500f82c4e30)  Mastodon instance ngmx.com  Mastodon version v4.2.9  Technical details  $ ruby --version ruby 3.0.4p208 (2022-04-12 revision 3fa771dded) [x86_64-linux] $ node --version v16.20.2 ",source-file | source-file,"Extra '@context' in 'outbox.jon' when archive export is generated, fails validation  Steps to reproduce the problem 1. Request data archive 2. Download archive 3. Extract archive, open 'outbox.json' 4. Validate JSON, which fails  Expected behaviour A single `@context` key  Actual behaviour A second `@context` key is present  Detailed description As far as I have been able to determine, this was introduced between December 31st and February 14th, which are the dates of the two exports we can test against; the former opens and validates just fine, while the latter throws an error. If the second `@context`, which as far as I can tell contains no actual data, is removed, the file validates. This happens both in larger exports, with over 17.000 items, as well as a small one, with just 111 'orderedItems', exported right before creating this ticket. See attached screenshot from the VDT Labs JSON Editor. Comparing the dates with available releases, this may have been introduced in 4.2.4, 4.2.5, or 4.2.6? ![Screenshot 2024-06-07 at 08 17 15-optimised](https://github.com/mastodon/mastodon/assets/91268/65d42d5e-dfc3-4c90-b088-8500f82c4e30)  Mastodon instance ngmx.com  Mastodon version v4.2.9  Technical details  $ ruby --version ruby 3.0.4p208 (2022-04-12 revision 3fa771dded) [x86_64-linux] $ node --version v16.20.2  source-file source-file",no-bug,0.9
31395,mastodon,https://github.com/mastodon/mastodon/issues/31395,IPv6 only, Steps to reproduce the problem The **IPv6 only** installation of Mastodon (Docker) seems to have several problems.  Expected behaviour run a single stack IPv6 server  Actual behaviour have to run a dual stack server or an IPv4 server  Detailed description It would be nice to test all new versions of Mastodon on an **IPv6 only** environment.  Mastodon instance _No response_  Mastodon version v4.x  Technical details _No response_,source-file,IPv6 only  Steps to reproduce the problem The **IPv6 only** installation of Mastodon (Docker) seems to have several problems.  Expected behaviour run a single stack IPv6 server  Actual behaviour have to run a dual stack server or an IPv4 server  Detailed description It would be nice to test all new versions of Mastodon on an **IPv6 only** environment.  Mastodon instance _No response_  Mastodon version v4.x  Technical details _No response_ source-file,no-bug,0.7
30281,mastodon,https://github.com/mastodon/mastodon/issues/30281,Favicon is considered orphaned media," Steps to reproduce the problem 1. Upload a favicon in **Branding** settings 2. Run `tootctl media remove-orphans` 3. Favicon `.png` is now gone, but `.ico` remains.   Expected behaviour Favicon not to be considered orphaned media  Actual behaviour Favicon is considered orphaned media and deleted  Detailed description After #30040, admins can now upload favicons to their instances. But the `tootctl media remove-orphans` command considers them as orphaned media, so the `.png` files are deleted. The `.ico` version is preserved, but the favicon used by browsers is the `.png` one, so they fail to show a favicon at all. Akkoma instances also fails to present the favicon.  I, [2024-05-13T10:04:45.895906 #421984] INFO -- : [dotenv] Loaded .env.production () Found and removed orphan: site_uploads/files/000/000/019/16/724461bd9f815f15.png Found and removed orphan: site_uploads/files/000/000/019/32/724461bd9f815f15.png Found and removed orphan: site_uploads/files/000/000/019/48/724461bd9f815f15.png ()   Mastodon instance bolha.one  Mastodon version v4.3.0-alpha.3-1959365  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: `3.3.1 (2024-04-23 revision c56cd86388)` - Node.js version: `v20.13.0`",source-file,"Favicon is considered orphaned media  Steps to reproduce the problem 1. Upload a favicon in **Branding** settings 2. Run `tootctl media remove-orphans` 3. Favicon `.png` is now gone, but `.ico` remains.   Expected behaviour Favicon not to be considered orphaned media  Actual behaviour Favicon is considered orphaned media and deleted  Detailed description After #30040, admins can now upload favicons to their instances. But the `tootctl media remove-orphans` command considers them as orphaned media, so the `.png` files are deleted. The `.ico` version is preserved, but the favicon used by browsers is the `.png` one, so they fail to show a favicon at all. Akkoma instances also fails to present the favicon.  I, [2024-05-13T10:04:45.895906 #421984] INFO -- : [dotenv] Loaded .env.production () Found and removed orphan: site_uploads/files/000/000/019/16/724461bd9f815f15.png Found and removed orphan: site_uploads/files/000/000/019/32/724461bd9f815f15.png Found and removed orphan: site_uploads/files/000/000/019/48/724461bd9f815f15.png ()   Mastodon instance bolha.one  Mastodon version v4.3.0-alpha.3-1959365  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: `3.3.1 (2024-04-23 revision c56cd86388)` - Node.js version: `v20.13.0` source-file",no-bug,0.9
31880,mastodon,https://github.com/mastodon/mastodon/issues/31880,Default focus on modal dialogs," Steps to reproduce the problem 1. Turn on boost confirmation option 2. Try to boost some post 3. Press <kbd>Space</kbd> or <kbd>Enter</kbd> to confirm   Expected behaviour Pressing space or enter press confirmation button on dialog  Actual behaviour Default focus is gone, Need to tab, shift+tab to focus on confirmation button to proceed  Detailed description On Mastodon v4.2, Boost confirmation dialog has focused on confirmation button by default. So user can just press space or enter key to proceed (Shift+tab enter to press cancel button) After dialog rework, Default focus is gone. So user need to press shift+tab and tab to focus on confirmation button Same applied on post delete confirmation dialog  Mastodon instance mastodon.social  Mastodon version v4.3  Browser name and version Firefox 130.0  Operating system Ubuntu 24.04.1 LTS  Technical details _No response_",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file,"Default focus on modal dialogs  Steps to reproduce the problem 1. Turn on boost confirmation option 2. Try to boost some post 3. Press <kbd>Space</kbd> or <kbd>Enter</kbd> to confirm   Expected behaviour Pressing space or enter press confirmation button on dialog  Actual behaviour Default focus is gone, Need to tab, shift+tab to focus on confirmation button to proceed  Detailed description On Mastodon v4.2, Boost confirmation dialog has focused on confirmation button by default. So user can just press space or enter key to proceed (Shift+tab enter to press cancel button) After dialog rework, Default focus is gone. So user need to press shift+tab and tab to focus on confirmation button Same applied on post delete confirmation dialog  Mastodon instance mastodon.social  Mastodon version v4.3  Browser name and version Firefox 130.0  Operating system Ubuntu 24.04.1 LTS  Technical details _No response_ other-file other-file other-file other-file other-file other-file other-file other-file source-file other-file other-file other-file other-file other-file other-file other-file other-file",no-bug,0.95
30924,mastodon,https://github.com/mastodon/mastodon/issues/30924,Overflow on hover cards with long URl descriptions," Steps to reproduce the problem 1. View the hover card of `@media_dept@mastodon.social` 2. Notice the overflow 3. ![Screenshot from 2024-07-04 23-42-41](https://github.com/mastodon/mastodon/assets/837136/07e44a70-29b2-4b64-97bb-b51e25caa76a)  Expected behaviour Text should not overflow the bounds of the hover card  Actual behaviour Long URl descriptions break the look and feel.  Detailed description The user appears to have very long descriptions of their URls. For example `Voting options for UK General Election, Thursday 4th July 2024` ![Screenshot 2024-07-04 at 23-43-50 Games Games Games (@media_dept@mastodon social) - Mastodon](https://github.com/mastodon/mastodon/assets/837136/cda3ffb3-6b85-4d9f-9b00-fe8704db7167)  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-07-05-security  Browser name and version Firefox 127  Operating system Ubuntu 22.04  Technical details _No response_",other-file,"Overflow on hover cards with long URl descriptions  Steps to reproduce the problem 1. View the hover card of `@media_dept@mastodon.social` 2. Notice the overflow 3. ![Screenshot from 2024-07-04 23-42-41](https://github.com/mastodon/mastodon/assets/837136/07e44a70-29b2-4b64-97bb-b51e25caa76a)  Expected behaviour Text should not overflow the bounds of the hover card  Actual behaviour Long URl descriptions break the look and feel.  Detailed description The user appears to have very long descriptions of their URls. For example `Voting options for UK General Election, Thursday 4th July 2024` ![Screenshot 2024-07-04 at 23-43-50 Games Games Games (@media_dept@mastodon social) - Mastodon](https://github.com/mastodon/mastodon/assets/837136/cda3ffb3-6b85-4d9f-9b00-fe8704db7167)  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-07-05-security  Browser name and version Firefox 127  Operating system Ubuntu 22.04  Technical details _No response_ other-file",no-bug,0.9
32133,mastodon,https://github.com/mastodon/mastodon/issues/32133,Missing 'allow-popups' directive from sandbox attribute in embed.js causes browsers to prevent users directly opening links within the embed iframe," Steps to reproduce the problem 1. Click ""Get embed code"" on any Mastodon post 2. Publish the generated embed code on any website 3. Go to the website and click on any link within the embed iframe 4. Links do not open and browser shows console message `Blocked opening '[]' in a new window because the request was made in a sandboxed frame whose 'allow-popups' permission is not set.`  Expected behaviour User should be able to click on links within IFrame and they should open the corresponding Mastodon post, user profile, etc.  Actual behaviour Browser blocks opening of links  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-09-26  Browser name and version Google Chrome Version 129.0.6668.70 (Official Build) (64-bit)  Operating system Ubuntu 24.04.01  Technical details _No response_",source-file,"Missing 'allow-popups' directive from sandbox attribute in embed.js causes browsers to prevent users directly opening links within the embed iframe  Steps to reproduce the problem 1. Click ""Get embed code"" on any Mastodon post 2. Publish the generated embed code on any website 3. Go to the website and click on any link within the embed iframe 4. Links do not open and browser shows console message `Blocked opening '[]' in a new window because the request was made in a sandboxed frame whose 'allow-popups' permission is not set.`  Expected behaviour User should be able to click on links within IFrame and they should open the corresponding Mastodon post, user profile, etc.  Actual behaviour Browser blocks opening of links  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-09-26  Browser name and version Google Chrome Version 129.0.6668.70 (Official Build) (64-bit)  Operating system Ubuntu 24.04.01  Technical details _No response_ source-file",no-bug,0.9
30182,mastodon,https://github.com/mastodon/mastodon/issues/30182,Links with # turn into tags," Steps to reproduce the problem When you make a post on Mastodon and include a link with a # in it e.g. https://org/#example the post will have the # example under it. See this post for a live example: https://mastodon.social/@madeindex/112388235443765052 Other social media platforms have this issue also, some of them even do not display the link at all.  Expected behaviour No hashtag under the post  Actual behaviour A hashtag under the post  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0  Browser name and version /  Operating system /  Technical details _No response_",source-file | source-file,"Links with # turn into tags  Steps to reproduce the problem When you make a post on Mastodon and include a link with a # in it e.g. https://org/#example the post will have the # example under it. See this post for a live example: https://mastodon.social/@madeindex/112388235443765052 Other social media platforms have this issue also, some of them even do not display the link at all.  Expected behaviour No hashtag under the post  Actual behaviour A hashtag under the post  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0  Browser name and version /  Operating system /  Technical details _No response_ source-file source-file",no-bug,0.8
32870,mastodon,https://github.com/mastodon/mastodon/issues/32870,CW appears open in Home timeline and can't be closed," Steps to reproduce the problem 1. CW posts aren't configured to automatically open 2. A CW'd post appears opened in the Home timeline either way 3. You can't close it  Expected behaviour CW'd post appears closed and can be opened and closed  Actual behaviour It appears opened and can't be closed  Detailed description It only happens in the **Home** column. When looking at the toot in a page or other column, the button works just fine, and the post isn't automatically open. If the same toot is open in the Home timeline and in another column (like the user profile column in the example bellow), the CW opens and closes in the other column but not in the Home timeline. Home timeline: ![Image](https://github.com/user-attachments/assets/c4c343e8-7e30-4e7a-8626-79be0b53b916) Different columns' behaviour: ![Image](https://github.com/user-attachments/assets/fa1ad9ff-7e84-4726-94cf-16607c1fd311)  Mastodon instance bolha.one, ursal.zone  Mastodon version v4.4.0-alpha.1-f8e96e7 (bolha.one), v4.4.0-alpha.1-f8e96e7 (ursal.zone)  Browser name and version LibreWolf 132.0.1-1, Chromium 130.0.6723.123  Operating system Linux Debian 13  Technical details _No response_",other-file,"CW appears open in Home timeline and can't be closed  Steps to reproduce the problem 1. CW posts aren't configured to automatically open 2. A CW'd post appears opened in the Home timeline either way 3. You can't close it  Expected behaviour CW'd post appears closed and can be opened and closed  Actual behaviour It appears opened and can't be closed  Detailed description It only happens in the **Home** column. When looking at the toot in a page or other column, the button works just fine, and the post isn't automatically open. If the same toot is open in the Home timeline and in another column (like the user profile column in the example bellow), the CW opens and closes in the other column but not in the Home timeline. Home timeline: ![Image](https://github.com/user-attachments/assets/c4c343e8-7e30-4e7a-8626-79be0b53b916) Different columns' behaviour: ![Image](https://github.com/user-attachments/assets/fa1ad9ff-7e84-4726-94cf-16607c1fd311)  Mastodon instance bolha.one, ursal.zone  Mastodon version v4.4.0-alpha.1-f8e96e7 (bolha.one), v4.4.0-alpha.1-f8e96e7 (ursal.zone)  Browser name and version LibreWolf 132.0.1-1, Chromium 130.0.6723.123  Operating system Linux Debian 13  Technical details _No response_ other-file",no-bug,0.9
31021,mastodon,https://github.com/mastodon/mastodon/issues/31021,Mentioned handles are rendered as plaintext without link if the sharp s ('') character appears in the previous word," Steps to reproduce the problem 1. Write a post with the following content and send it `Gem @Gargron@mastodon.social`  Expected behaviour The handle is rendered with a link to the profile: Gem @Gargron  Actual behaviour The handle is rendered as plaintext: Gem @Gargron@mastodon.social  Detailed description Apparently when a handle is mentioned after a """" (sharp s) character it is always rendered as plaintext. Please find the following post where it was first observed: https://nrw.social/@melsdung/112784007422571926 The issue could also be reproduced with the 3rd party app ""Tusky"" using mastodon.online.  Mastodon instance mastodon.online and nrw.social  Mastodon version v4.2.10 (nrw.social) and v4.3.0-nightly.2024-07-11 (mastodon.online)  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.1.2) - Node.js version: (from `node --version`, eg. v18.16.0)",source-file | source-file | source-file | source-file,"Mentioned handles are rendered as plaintext without link if the sharp s ('') character appears in the previous word  Steps to reproduce the problem 1. Write a post with the following content and send it `Gem @Gargron@mastodon.social`  Expected behaviour The handle is rendered with a link to the profile: Gem @Gargron  Actual behaviour The handle is rendered as plaintext: Gem @Gargron@mastodon.social  Detailed description Apparently when a handle is mentioned after a """" (sharp s) character it is always rendered as plaintext. Please find the following post where it was first observed: https://nrw.social/@melsdung/112784007422571926 The issue could also be reproduced with the 3rd party app ""Tusky"" using mastodon.online.  Mastodon instance mastodon.online and nrw.social  Mastodon version v4.2.10 (nrw.social) and v4.3.0-nightly.2024-07-11 (mastodon.online)  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: (from `ruby --version`, eg. v3.1.2) - Node.js version: (from `node --version`, eg. v18.16.0) source-file source-file source-file source-file",no-bug,0.8
30806,mastodon,https://github.com/mastodon/mastodon/issues/30806,Push Interlingua locale, Pitch Mastodon web translation into interlingua (ia) language is completed in Crowdin (https://crowdin.com/project/mastodon/ia) and its langcode is already listed in app/helpers/languages_helper.rb and config/locales but not in config/initializers/i18n.rb  Motivation Same as Interlingue/Occidental (ie) locale #28628.,source-file,Push Interlingua locale  Pitch Mastodon web translation into interlingua (ia) language is completed in Crowdin (https://crowdin.com/project/mastodon/ia) and its langcode is already listed in app/helpers/languages_helper.rb and config/locales but not in config/initializers/i18n.rb  Motivation Same as Interlingue/Occidental (ie) locale #28628. source-file,no-bug,0.9
31407,mastodon,https://github.com/mastodon/mastodon/issues/31407,No line below follow notifications?," Steps to reproduce the problem - Get followed - Enter ""all"" tab ![image](https://github.com/user-attachments/assets/d99d0611-38a2-47e9-89e8-e0cab83127a0) Every notification type has a line above it and below it *except* a follow notification.  Expected behaviour Line should appear between follow notification and mention  Actual behaviour Line visible above follow notification but not below  Detailed description It just looks weird is all. I don't think I've noticed this before so maybe it's new. I was messing with my notification filters right before I saw this for the first time, so if this isn't usual, maybe something I did triggered it. If you are intentionally doing a thing where you draw no lines between follow notifications when two follow notifications are in a row, that sounds fine to me, but there should be lines between follow notifications and other notification types or it looks inconsistent. Saw on v4.3.0-nightly.2024-08-12, mastodon.social, BOTH advanced and non-advanced mode, BOTH Chrome and Firefox, uBlock Origin is ON, Stylus is OFF.",other-file | other-file,"No line below follow notifications?  Steps to reproduce the problem - Get followed - Enter ""all"" tab ![image](https://github.com/user-attachments/assets/d99d0611-38a2-47e9-89e8-e0cab83127a0) Every notification type has a line above it and below it *except* a follow notification.  Expected behaviour Line should appear between follow notification and mention  Actual behaviour Line visible above follow notification but not below  Detailed description It just looks weird is all. I don't think I've noticed this before so maybe it's new. I was messing with my notification filters right before I saw this for the first time, so if this isn't usual, maybe something I did triggered it. If you are intentionally doing a thing where you draw no lines between follow notifications when two follow notifications are in a row, that sounds fine to me, but there should be lines between follow notifications and other notification types or it looks inconsistent. Saw on v4.3.0-nightly.2024-08-12, mastodon.social, BOTH advanced and non-advanced mode, BOTH Chrome and Firefox, uBlock Origin is ON, Stylus is OFF. other-file other-file",no-bug,0.9
32896,mastodon,https://github.com/mastodon/mastodon/issues/32896,Websites allowed to credit you field has autocorrect enabled," Steps to reproduce the problem 1. Navigate to Settings > Public Profile > Verification 2. Try to type one or more website addresses into the Websites allowed to credit you field  Expected behaviour it accepts that youve typed a website address  Actual behaviour autocorrect changes what youve typed to English words, inserts spaces between words, and spellcheck gives you a red underline if you type a domain that isnt an English word (or whatever the browser language is set to)  Detailed description Website addresses dont tend to be spelled correctly or grammatically correct in whatever language someone is browsing in, so autocorrect/autocomplete and spell check are not appropriate here. I shouldnt have to carefully decline all of my autocorrect suggestions to avoid having the website address be misspelled.  Mastodon instance mastodon.online, mastodon.gamedev.place  Mastodon version v4.3.1  Browser name and version Safari  Operating system iPadOS 18.2b3  Technical details This field should probably have `autocorrect=off`, `autocomplete=off`, `autocapitalize=none`, and `spellcheck=false`. Or better yet, instead of one textarea for entering multiple URLs, use multiple `<input type=url>` elements so the browser can do the correct thing on its own and also show a more appropriate keyboard.",other-file,"Websites allowed to credit you field has autocorrect enabled  Steps to reproduce the problem 1. Navigate to Settings > Public Profile > Verification 2. Try to type one or more website addresses into the Websites allowed to credit you field  Expected behaviour it accepts that youve typed a website address  Actual behaviour autocorrect changes what youve typed to English words, inserts spaces between words, and spellcheck gives you a red underline if you type a domain that isnt an English word (or whatever the browser language is set to)  Detailed description Website addresses dont tend to be spelled correctly or grammatically correct in whatever language someone is browsing in, so autocorrect/autocomplete and spell check are not appropriate here. I shouldnt have to carefully decline all of my autocorrect suggestions to avoid having the website address be misspelled.  Mastodon instance mastodon.online, mastodon.gamedev.place  Mastodon version v4.3.1  Browser name and version Safari  Operating system iPadOS 18.2b3  Technical details This field should probably have `autocorrect=off`, `autocomplete=off`, `autocapitalize=none`, and `spellcheck=false`. Or better yet, instead of one textarea for entering multiple URLs, use multiple `<input type=url>` elements so the browser can do the correct thing on its own and also show a more appropriate keyboard. other-file",no-bug,0.9
29867,mastodon,https://github.com/mastodon/mastodon/issues/29867,Trending hashtags text show i18n markup in welcome email, Steps to reproduce the problem 1. Receive a welcome email ![IMG_5948](https://github.com/mastodon/mastodon/assets/42070/49ed7965-e751-4745-b2d2-5eaea1813244)  Expected behaviour English text should be shown  Actual behaviour Text in the trending hashtags is showing i18n syntax  Detailed description _No response_  Mastodon instance mastodon.online  Mastodon version v4.3.0-nightly.2024-04-05  Browser name and version -  Operating system -  Technical details Probably related to the translators comments that were left on Crowdin,other-file,Trending hashtags text show i18n markup in welcome email  Steps to reproduce the problem 1. Receive a welcome email ![IMG_5948](https://github.com/mastodon/mastodon/assets/42070/49ed7965-e751-4745-b2d2-5eaea1813244)  Expected behaviour English text should be shown  Actual behaviour Text in the trending hashtags is showing i18n syntax  Detailed description _No response_  Mastodon instance mastodon.online  Mastodon version v4.3.0-nightly.2024-04-05  Browser name and version -  Operating system -  Technical details Probably related to the translators comments that were left on Crowdin other-file,no-bug,0.9
28947,mastodon,https://github.com/mastodon/mastodon/issues/28947,New compose interface chokes on uppercase language codes," Steps to reproduce the problem I am using mastodon.social with the new (beta?) compose UI. Now below the status I am typing there is a box with a little A icon and the word ""English"", indicating my post language. (There are several things I don't like about the new compose UI, but I do like this one change because it makes it harder to post with the wrong language metadata set.) But! Consider this one post (or in general, any post by the user @suricrasia@lethargic.talkative.fish), which breaks the ""English"" box: https://lethargic.talkative.fish/@suricrasia/statuses/01HN1NGM7F2N63PJYE5W2YTPY9 To reproduce, bring up this post (for example by entering it into the Mastodon search box) and hit reply.  Expected behaviour When replying to a post, Mastodon's current behavior is to copy the original poster's language field into your own. Suricrasia is speaking English. Therefore, I assume replying to Suricrasia, my language will be set to English. For example: ![image](https://github.com/mastodon/mastodon/assets/277318/da37504a-c835-4761-8cff-29ede6fa7608) ![image](https://github.com/mastodon/mastodon/assets/277318/17a5f64c-fa16-4ba1-b3fb-28f001bcd406)  Actual behaviour The language is set to the letters ""EN"". ![image](https://github.com/mastodon/mastodon/assets/277318/04ebee4d-5716-41e4-bccb-a3eceff358f4) I don't actually know what happens to my status language code if I send this reply.  Detailed description I suspect this may be a variant of issue #19302, that mastodon.social in general chokes on language codes with dialects such as en-US (I think in the past I remember noticing this same user posting with en-US language). ~~If my guess is correct, this means #19302 has got worse because rather than ""en-US"" being relayed verbatim, which may be confusing to some users, it has been changed to ""EN"" which both will confuse some users and also is (if my guess is right) incorrect.~~ EDIT: Not quite  Mastodon instance mastodon.social  Mastodon version v4.3.0-alpha.0+pr-28119-b84fe92 lethargic.talkative.fish, the source of the problematic status, says it is running GoToSocial v0.12.0 git-5fd2e42  Browser name and version Chrome 120.0.6099.227 (Official Build) (64-bit) I am running with uBlock. I usually run with Stylus but for these tests/screenshots I have disabled it and reloaded the page.  Operating system Windows 10  Technical details _No response_",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,"New compose interface chokes on uppercase language codes  Steps to reproduce the problem I am using mastodon.social with the new (beta?) compose UI. Now below the status I am typing there is a box with a little A icon and the word ""English"", indicating my post language. (There are several things I don't like about the new compose UI, but I do like this one change because it makes it harder to post with the wrong language metadata set.) But! Consider this one post (or in general, any post by the user @suricrasia@lethargic.talkative.fish), which breaks the ""English"" box: https://lethargic.talkative.fish/@suricrasia/statuses/01HN1NGM7F2N63PJYE5W2YTPY9 To reproduce, bring up this post (for example by entering it into the Mastodon search box) and hit reply.  Expected behaviour When replying to a post, Mastodon's current behavior is to copy the original poster's language field into your own. Suricrasia is speaking English. Therefore, I assume replying to Suricrasia, my language will be set to English. For example: ![image](https://github.com/mastodon/mastodon/assets/277318/da37504a-c835-4761-8cff-29ede6fa7608) ![image](https://github.com/mastodon/mastodon/assets/277318/17a5f64c-fa16-4ba1-b3fb-28f001bcd406)  Actual behaviour The language is set to the letters ""EN"". ![image](https://github.com/mastodon/mastodon/assets/277318/04ebee4d-5716-41e4-bccb-a3eceff358f4) I don't actually know what happens to my status language code if I send this reply.  Detailed description I suspect this may be a variant of issue #19302, that mastodon.social in general chokes on language codes with dialects such as en-US (I think in the past I remember noticing this same user posting with en-US language). ~~If my guess is correct, this means #19302 has got worse because rather than ""en-US"" being relayed verbatim, which may be confusing to some users, it has been changed to ""EN"" which both will confuse some users and also is (if my guess is right) incorrect.~~ EDIT: Not quite  Mastodon instance mastodon.social  Mastodon version v4.3.0-alpha.0+pr-28119-b84fe92 lethargic.talkative.fish, the source of the problematic status, says it is running GoToSocial v0.12.0 git-5fd2e42  Browser name and version Chrome 120.0.6099.227 (Official Build) (64-bit) I am running with uBlock. I usually run with Stylus but for these tests/screenshots I have disabled it and reloaded the page.  Operating system Windows 10  Technical details _No response_ source-file source-file source-file source-file source-file source-file source-file source-file",no-bug,0.85
31383,mastodon,https://github.com/mastodon/mastodon/issues/31383,Unable to logout on Safari," Steps to reproduce the problem 1. Log in your account on mastodon.social 2. Select logout option in menu section beside profile. 3. Click on ""Log out"" in Confirm Log out modal.  Expected behaviour Should be able to logout  Actual behaviour Unable to logout from my account  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-08-09  Browser name and version Safari Version 17.5  Operating system macOS 14.5  Technical details _No response_",source-file | source-file | source-file | other-file | source-file,"Unable to logout on Safari  Steps to reproduce the problem 1. Log in your account on mastodon.social 2. Select logout option in menu section beside profile. 3. Click on ""Log out"" in Confirm Log out modal.  Expected behaviour Should be able to logout  Actual behaviour Unable to logout from my account  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.3.0-nightly.2024-08-09  Browser name and version Safari Version 17.5  Operating system macOS 14.5  Technical details _No response_ source-file source-file source-file other-file source-file",no-bug,0.7
29873,mastodon,https://github.com/mastodon/mastodon/issues/29873,`Your application is pending review by our staff. ~` prevents the development web app from working.," Steps to reproduce the problem 1. Repo fork 2. Create Dev Containers 3. Run `foreman start` 4. Sign in as `admin@localhost`  Expected behaviour The development web app works  Actual behaviour I can't navigate away from `http://localhost:3000/auth/edit` because `Your application is pending review by our staff. ~`  Detailed description <img width=""2000"" alt=""image"" src=""https://github.com/mastodon/mastodon/assets/58300794/ed8e5aca-1cbd-46fb-8497-65875bc8f7c4"">  Mastodon instance I don't know. What is the instance of your development environment?  Mastodon version v4.3.0-alpha.3  Browser name and version Google Chrome 123.0.6312.107  Operating system macOS Sonoma 14.4.1  Technical details _No response_",source-file,"`Your application is pending review by our staff. ~` prevents the development web app from working.  Steps to reproduce the problem 1. Repo fork 2. Create Dev Containers 3. Run `foreman start` 4. Sign in as `admin@localhost`  Expected behaviour The development web app works  Actual behaviour I can't navigate away from `http://localhost:3000/auth/edit` because `Your application is pending review by our staff. ~`  Detailed description <img width=""2000"" alt=""image"" src=""https://github.com/mastodon/mastodon/assets/58300794/ed8e5aca-1cbd-46fb-8497-65875bc8f7c4"">  Mastodon instance I don't know. What is the instance of your development environment?  Mastodon version v4.3.0-alpha.3  Browser name and version Google Chrome 123.0.6312.107  Operating system macOS Sonoma 14.4.1  Technical details _No response_ source-file",no-bug,0.9
33420,mastodon,https://github.com/mastodon/mastodon/issues/33420,Keyboard shortcut for Translation," Pitch Add a keyboard shortcut to the mastodon web UI for when a post has a 'Translate' link.  Motivation I primarily use Mastodon via the techhub.social's web interface. I see enough posts that aren't in my primary language (English) that a 'Translate' link is sometimes within the post. I also primarily navigate the mastodon web UI using keyboard, not mouse unless I can't avoid it. Thus my workflow when using Mastodon would be smoother if there was a keyboard shortcut for triggering translation. It looks like `t` is currently unused.",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file,"Keyboard shortcut for Translation  Pitch Add a keyboard shortcut to the mastodon web UI for when a post has a 'Translate' link.  Motivation I primarily use Mastodon via the techhub.social's web interface. I see enough posts that aren't in my primary language (English) that a 'Translate' link is sometimes within the post. I also primarily navigate the mastodon web UI using keyboard, not mouse unless I can't avoid it. Thus my workflow when using Mastodon would be smoother if there was a keyboard shortcut for triggering translation. It looks like `t` is currently unused. other-file other-file other-file other-file other-file other-file other-file other-file documentation-file",no-bug,0.95
32459,mastodon,https://github.com/mastodon/mastodon/issues/32459,[RTL] Back arrow is backward, Steps to reproduce the problem 1. Make the web interface (4.3.0) RTL. 2. Open any profile. 3. Look at the `back` arrow. ![image](https://github.com/user-attachments/assets/165458a7-58d3-432e-8fce-6a71169bfb6f)  Expected behaviour The arrow should point to right (back)  Actual behaviour The arrow is pointing to left (forward)  Detailed description _No response_  Mastodon instance persadon.com  Mastodon version 4.3.0  Browser name and version Firefox-ESR 128.3.1  Operating system Debian GNU/Linux 12  Technical details _No response_,other-file | other-file,[RTL] Back arrow is backward  Steps to reproduce the problem 1. Make the web interface (4.3.0) RTL. 2. Open any profile. 3. Look at the `back` arrow. ![image](https://github.com/user-attachments/assets/165458a7-58d3-432e-8fce-6a71169bfb6f)  Expected behaviour The arrow should point to right (back)  Actual behaviour The arrow is pointing to left (forward)  Detailed description _No response_  Mastodon instance persadon.com  Mastodon version 4.3.0  Browser name and version Firefox-ESR 128.3.1  Operating system Debian GNU/Linux 12  Technical details _No response_ other-file other-file,no-bug,0.95
31679,mastodon,https://github.com/mastodon/mastodon/issues/31679,4.3.0-beta.1: The message window is not displayed correctly, Steps to reproduce the problem 1. The message box is displayed incorrectly when the browser window width is small. 2. Set the window size to a width of 1200 to 1167 pixels. ![vivaldi_2024-09-01_17-48-27](https://github.com/user-attachments/assets/a5f98fab-ed7e-4a12-b6ec-35d381fd9e5c)  Expected behaviour The message box is cropped to the left  Actual behaviour The message window is displayed correctly  Detailed description _No response_  Mastodon instance example.com  Mastodon version 4.3.0-beta.1  Browser name and version Vivaldi 6.2.3105.58  Operating system Windows 10 22H2  Technical details _No response_,other-file | other-file | other-file | other-file | other-file,4.3.0-beta.1: The message window is not displayed correctly  Steps to reproduce the problem 1. The message box is displayed incorrectly when the browser window width is small. 2. Set the window size to a width of 1200 to 1167 pixels. ![vivaldi_2024-09-01_17-48-27](https://github.com/user-attachments/assets/a5f98fab-ed7e-4a12-b6ec-35d381fd9e5c)  Expected behaviour The message box is cropped to the left  Actual behaviour The message window is displayed correctly  Detailed description _No response_  Mastodon instance example.com  Mastodon version 4.3.0-beta.1  Browser name and version Vivaldi 6.2.3105.58  Operating system Windows 10 22H2  Technical details _No response_ other-file other-file other-file other-file other-file,no-bug,0.95
29720,mastodon,https://github.com/mastodon/mastodon/issues/29720,Server rules admin UI repeats the rule," Steps to reproduce the problem 1. Visit `/admin/rules`  Expected behaviour The addtional information should be shown, just as in the user facing UI  Actual behaviour The server rule is shown twice  Detailed description Admin-facing server rule looks like this: ![server_rules_admin](https://github.com/mastodon/mastodon/assets/4095570/33060017-841f-4119-b26f-69f3340d954f) The user-facing server rule looks like this: ![server_rules_public](https://github.com/mastodon/mastodon/assets/4095570/41075199-a9d7-4295-8f80-0ed8954724ba)  Mastodon instance https://ailbhean.co-shaoghal.net/  Mastodon version v4.3.0-alpha.3+git-77897cd24cbf9802bd000c88ab3c7bfb6714f968  Browser name and version Firefox 123.0.1  Operating system Linux Mint 21.3 Mate  Technical details _No response_",other-file,"Server rules admin UI repeats the rule  Steps to reproduce the problem 1. Visit `/admin/rules`  Expected behaviour The addtional information should be shown, just as in the user facing UI  Actual behaviour The server rule is shown twice  Detailed description Admin-facing server rule looks like this: ![server_rules_admin](https://github.com/mastodon/mastodon/assets/4095570/33060017-841f-4119-b26f-69f3340d954f) The user-facing server rule looks like this: ![server_rules_public](https://github.com/mastodon/mastodon/assets/4095570/41075199-a9d7-4295-8f80-0ed8954724ba)  Mastodon instance https://ailbhean.co-shaoghal.net/  Mastodon version v4.3.0-alpha.3+git-77897cd24cbf9802bd000c88ab3c7bfb6714f968  Browser name and version Firefox 123.0.1  Operating system Linux Mint 21.3 Mate  Technical details _No response_ other-file",no-bug,0.9
27197,mastodon,https://github.com/mastodon/mastodon/issues/27197,Explore prompt shows up on fairly busy home timeline," Steps to reproduce the problem 1. Follow about ~200 people who post and boost reasonably often (I see new posts on my home timeline about once every 1-5 minutes during the day) 2. Upgrade to Mastodon 4.2.0  Expected behaviour I wouldn't be prompted to follow more people  Actual behaviour Got a prompt to see trending posts and people to follow  Detailed description I feel like I use Mastodon fairly heavily, see plenty of posts in my timeline, use the advanced web interface with the local timeline also open where I see even more. A prompt that seems to be designed for new users who don't follow very many people and may want to discover more people to follow seems unnecessary and intrusive for someone who already uses Mastodon heavily.  Mastodon instance hachyderm.io  Mastodon version v4.2.0  Browser name and version Firefox 118.0.1  Operating system Ubuntu 22.04.3 LTS (Jammy Jellyfish)  Technical details _No response_",other-file | other-file | other-file,"Explore prompt shows up on fairly busy home timeline  Steps to reproduce the problem 1. Follow about ~200 people who post and boost reasonably often (I see new posts on my home timeline about once every 1-5 minutes during the day) 2. Upgrade to Mastodon 4.2.0  Expected behaviour I wouldn't be prompted to follow more people  Actual behaviour Got a prompt to see trending posts and people to follow  Detailed description I feel like I use Mastodon fairly heavily, see plenty of posts in my timeline, use the advanced web interface with the local timeline also open where I see even more. A prompt that seems to be designed for new users who don't follow very many people and may want to discover more people to follow seems unnecessary and intrusive for someone who already uses Mastodon heavily.  Mastodon instance hachyderm.io  Mastodon version v4.2.0  Browser name and version Firefox 118.0.1  Operating system Ubuntu 22.04.3 LTS (Jammy Jellyfish)  Technical details _No response_ other-file other-file other-file",no-bug,0.9
27639,mastodon,https://github.com/mastodon/mastodon/issues/27639,document_parsing_exception errors from a status with an invalid date," Steps to reproduce the problem 1. Unclear how we acquired this status, but [this post](https://mk.itzti.li/notes/9la79fmeadxw63t4) arrived in our instance with an invalid timestamp:  created_at: Thu, 07 Nov 11968 17:22:13.599000000 UTC +00:00, updated_at: Sat, 28 Oct 2023 15:09:01.341614000 UTC +00:00,  2. since then, a sidekiq job fails once per minute trying to deal with this status:  Oct 31 15:05:09 - bundle[3249279]: `{""type""=>""document_parsing_exception"", ""reason""=>""[1:62] failed to parse field [last_status_at] of type [date] in document with id '47476'. Preview of field's value: '11968-11-07T17:22:13.599Z'"", ""caused_by""=>{""type""=>""illegal_argument_exception"", ""reason""=>""failed to parse date field [11968-11-07T17:22:13.599Z] with format [strict_date_optional_time||epoch_millis]"", ""caused_by""=>{""type""=>""date_time_parse_exception"", ""reason""=>""Failed to parse with all enclosed parsers""`   Expected behaviour Sidekiq should be able to deal with whatever statuses it might encounter  Actual behaviour Sidekiq dies dealing with this status once per minute  Detailed description _No response_  Mastodon instance cosocial.ca  Mastodon version v4.2.0  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.2.2 (2023-03-30 revision e51014f9c0) [x86_64-linux] - Node.js version: v16.20.2",source-file | source-file | source-file,"document_parsing_exception errors from a status with an invalid date  Steps to reproduce the problem 1. Unclear how we acquired this status, but [this post](https://mk.itzti.li/notes/9la79fmeadxw63t4) arrived in our instance with an invalid timestamp:  created_at: Thu, 07 Nov 11968 17:22:13.599000000 UTC +00:00, updated_at: Sat, 28 Oct 2023 15:09:01.341614000 UTC +00:00,  2. since then, a sidekiq job fails once per minute trying to deal with this status:  Oct 31 15:05:09 - bundle[3249279]: `{""type""=>""document_parsing_exception"", ""reason""=>""[1:62] failed to parse field [last_status_at] of type [date] in document with id '47476'. Preview of field's value: '11968-11-07T17:22:13.599Z'"", ""caused_by""=>{""type""=>""illegal_argument_exception"", ""reason""=>""failed to parse date field [11968-11-07T17:22:13.599Z] with format [strict_date_optional_time||epoch_millis]"", ""caused_by""=>{""type""=>""date_time_parse_exception"", ""reason""=>""Failed to parse with all enclosed parsers""`   Expected behaviour Sidekiq should be able to deal with whatever statuses it might encounter  Actual behaviour Sidekiq dies dealing with this status once per minute  Detailed description _No response_  Mastodon instance cosocial.ca  Mastodon version v4.2.0  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.2.2 (2023-03-30 revision e51014f9c0) [x86_64-linux] - Node.js version: v16.20.2 source-file source-file source-file",no-bug,0.8
33167,mastodon,https://github.com/mastodon/mastodon/issues/33167,New embed sometimes needs a scrollbar even for short statuses, Steps to reproduce the problem 1. Copy the embed code for a status with an image attachment (?) 2. Paste the embed code into an HTML file  Expected behaviour iframe is sized to not need a scrollbar? (421px tall)  Actual behaviour iframe is slightly too small (418px tall)  Detailed description ![Image](https://github.com/user-attachments/assets/359838f7-e4bd-4020-b913-c392f1d16112)  Technical details mastodon.social v4.4.0-nightly.2024-12-02 Chromium v130.0.6723.58,other-file | other-file,New embed sometimes needs a scrollbar even for short statuses  Steps to reproduce the problem 1. Copy the embed code for a status with an image attachment (?) 2. Paste the embed code into an HTML file  Expected behaviour iframe is sized to not need a scrollbar? (421px tall)  Actual behaviour iframe is slightly too small (418px tall)  Detailed description ![Image](https://github.com/user-attachments/assets/359838f7-e4bd-4020-b913-c392f1d16112)  Technical details mastodon.social v4.4.0-nightly.2024-12-02 Chromium v130.0.6723.58 other-file other-file,no-bug,0.9
27568,mastodon,https://github.com/mastodon/mastodon/issues/27568,Ignore not found media files in AttachmentBatch deletion with OpenStack Swift," Steps to reproduce the problem 1. Manually delete a media file/directory from the OpenStack Swift object storage (to simulate a missing file) 2. Run AttachmentBatch deletion that would attempt to delete that file  Expected behaviour Log error and continue  Actual behaviour Stops AttachmentBatch deletion  Detailed description With the fix introduced in #27554 AttachmentBatch deletion is working but it introduces a couple of problems. If OpenStack Swift object storage stops fails to respond either due to a server error (500 or similar) or in my case because it hit the maximum requests per minute (429 Too Many Requests), the object may be deleted in the object storage but the database not updated to reflect that. The next time you attempt to run AttachmentBatch deletion where that media is again marked for deletion, the process exits because the file is missing ""Expected(204) <=> Actual(404 Not Found)"". Note that a file may also be missing for other reasons, like failing to properly upload or some other error. So, it would be good to just ignore files that were missing but continue to fail if other errors from the object storage (500, 429, etc). Possibly something similar to what we see on the filesystem storage https://github.com/mastodon/mastodon/blob/863ba46b00ea8b736e7473264e54b73029cafb60/app/lib/attachment_batch.rb#L72-L74  Mastodon instance Several  Mastodon version v4.2.1 + #27554  Technical details OpenStack Swift Object Storage with #27554",source-file,"Ignore not found media files in AttachmentBatch deletion with OpenStack Swift  Steps to reproduce the problem 1. Manually delete a media file/directory from the OpenStack Swift object storage (to simulate a missing file) 2. Run AttachmentBatch deletion that would attempt to delete that file  Expected behaviour Log error and continue  Actual behaviour Stops AttachmentBatch deletion  Detailed description With the fix introduced in #27554 AttachmentBatch deletion is working but it introduces a couple of problems. If OpenStack Swift object storage stops fails to respond either due to a server error (500 or similar) or in my case because it hit the maximum requests per minute (429 Too Many Requests), the object may be deleted in the object storage but the database not updated to reflect that. The next time you attempt to run AttachmentBatch deletion where that media is again marked for deletion, the process exits because the file is missing ""Expected(204) <=> Actual(404 Not Found)"". Note that a file may also be missing for other reasons, like failing to properly upload or some other error. So, it would be good to just ignore files that were missing but continue to fail if other errors from the object storage (500, 429, etc). Possibly something similar to what we see on the filesystem storage https://github.com/mastodon/mastodon/blob/863ba46b00ea8b736e7473264e54b73029cafb60/app/lib/attachment_batch.rb#L72-L74  Mastodon instance Several  Mastodon version v4.2.1 + #27554  Technical details OpenStack Swift Object Storage with #27554 source-file",no-bug,0.8
31212,mastodon,https://github.com/mastodon/mastodon/issues/31212,Table rendering issues with new Hashtag moderation search view," Steps to reproduce the problem Table is using `.batch-table` but without a toolbar or any options, so the top of the table doesn't render in the new admin theme. <img width=""830"" alt=""image"" src=""https://github.com/user-attachments/assets/34884d29-9bb9-4311-8c80-a9ae23e455f3"">  Expected behaviour Border complete  Actual behaviour Incomplete border  Detailed description _No response_  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha  Browser name and version All  Operating system All  Technical details _No response_",other-file | other-file,"Table rendering issues with new Hashtag moderation search view  Steps to reproduce the problem Table is using `.batch-table` but without a toolbar or any options, so the top of the table doesn't render in the new admin theme. <img width=""830"" alt=""image"" src=""https://github.com/user-attachments/assets/34884d29-9bb9-4311-8c80-a9ae23e455f3"">  Expected behaviour Border complete  Actual behaviour Incomplete border  Detailed description _No response_  Mastodon instance vmst.io  Mastodon version v4.3.0-alpha  Browser name and version All  Operating system All  Technical details _No response_ other-file other-file",no-bug,0.9
33357,mastodon,https://github.com/mastodon/mastodon/issues/33357,Featured hashtag last used date is incorrect for remote users," Steps to reproduce the problem 1. Load `/api/v1/accounts/[id]/featured_hashtags` with the ID of a remote user  Expected behaviour `last_status_at` should show the date of the most recent post from this user using that hashtag that is either public or viewable to the person making the query  Actual behaviour `last_status_at` shows a long ago date for a hashtag with recent public posts. I think `statuses_count` is also incorrect. I also found at least one example (possibly specific to the web UI) where a future date is displayed as the last usage date of a featured hashtag, even though the users posts are all dated correctly.  Detailed description Ive seen this frequently on multiple servers where it will either give a long ago date or even say no posts for a featured hashtag that someone uses very frequently. I can see the users posts just fine from the affected server so its not an issue of the posts not federating. When looking at my own featured hashtags on my own server, or looking at local users featured hashtags, the date appears to be correct, only remote accounts seem to be affected. For example, https://mastodon.social/api/v1/accounts/109281825849025262/featured_tags should be the featured tags of my own mastodon.online account, viewed from mastodon.social. The `last_status_at` for the swiftui hashtag is `2024-02-19`, almost a year ago, but Ive posted about it several times since then, including in the last few days. Possibly related to #22665 where someone saw the `last_status_at` date getting updated correctly but not the `statuses_count`. In my case, the `last_status_at` is also incorrect.  Mastodon instance mastodon.social, mastodon.online, mastodon.gamedev.place  Mastodon version v4.4.0-nightly.2024-12-18, v4.3.2  Technical details _No response_",source-file | source-file,"Featured hashtag last used date is incorrect for remote users  Steps to reproduce the problem 1. Load `/api/v1/accounts/[id]/featured_hashtags` with the ID of a remote user  Expected behaviour `last_status_at` should show the date of the most recent post from this user using that hashtag that is either public or viewable to the person making the query  Actual behaviour `last_status_at` shows a long ago date for a hashtag with recent public posts. I think `statuses_count` is also incorrect. I also found at least one example (possibly specific to the web UI) where a future date is displayed as the last usage date of a featured hashtag, even though the users posts are all dated correctly.  Detailed description Ive seen this frequently on multiple servers where it will either give a long ago date or even say no posts for a featured hashtag that someone uses very frequently. I can see the users posts just fine from the affected server so its not an issue of the posts not federating. When looking at my own featured hashtags on my own server, or looking at local users featured hashtags, the date appears to be correct, only remote accounts seem to be affected. For example, https://mastodon.social/api/v1/accounts/109281825849025262/featured_tags should be the featured tags of my own mastodon.online account, viewed from mastodon.social. The `last_status_at` for the swiftui hashtag is `2024-02-19`, almost a year ago, but Ive posted about it several times since then, including in the last few days. Possibly related to #22665 where someone saw the `last_status_at` date getting updated correctly but not the `statuses_count`. In my case, the `last_status_at` is also incorrect.  Mastodon instance mastodon.social, mastodon.online, mastodon.gamedev.place  Mastodon version v4.4.0-nightly.2024-12-18, v4.3.2  Technical details _No response_ source-file source-file",bug,0.9
34082,mastodon,https://github.com/mastodon/mastodon/issues/34082,NoMethodError: undefined method `evalsha' for nil," Steps to reproduce the problem 1. Inspect logs or sidekiq retry/dead queues  Expected behaviour No warnings about NoMethodError  Actual behaviour Warnings about NoMethodError  Detailed description Since v4.3 I've seen a noticeable number of sidekiq jobs failing with the warning:  NoMethodError: undefined method `evalsha' for nil  It's unclear to me whether this is a bug, a deployment issue on my server, or the expected behaviour of some failure case.  Mastodon instance sunny.garden  Mastodon version v4.3.4  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.3.5 (2024-09-03 revision ef084cc8f4) [x86_64-linux] - Node.js version: v20.17.0 In the majority of cases, the remote server is running Akkoma or Pleroma, however it also results from Mastodon servers less frequently as well.  Mar 05 05:53:36 radish-1 bundle[1908833]: 2025-03-05T05:53:36.195Z pid=1908833 tid=5zbdd WARN: {""context"":""Job raised exception"",""job"":{""retry"":16,""queue"":""push"",""dead"":false,""class"":""ActivityPub::DeliveryWorker"",""args"":[""{\""@context\"":[\""https://www.w3.org/ns/activitystreams\"",\""https://w3id.org/security/v1\"",{\""manuallyApprovesFollowers\"":\""as:manuallyApprovesFollowers\"",\""sensitive\"":\""as:sensitive\"",\""Hashtag\"":\""as:Hashtag\"",\""movedTo\"":{\""@id\"":\""as:movedTo\"",\""@type\"":\""@id\""},\""alsoKnownAs\"":{\""@id\"":\""as:alsoKnownAs\"",\""@type\"":\""@id\""},\""toot\"":\""http://joinmastodon.org/ns#\"",\""Emoji\"":\""toot:Emoji\"",\""featured\"":{\""@id\"":\""toot:featured\"",\""@type\"":\""@id\""},\""featuredTags\"":{\""@id\"":\""toot:featuredTags\"",\""@type\"":\""@id\""},\""schema\"":\""http://schema.org#\"",\""PropertyValue\"":\""schema:PropertyValue\"",\""value\"":\""schema:value\"",\""ostatus\"":\""http://ostatus.org#\"",\""atomUri\"":\""ostatus:atomUri\"",\""inReplyToAtomUri\"":\""ostatus:inReplyToAtomUri\"",\""conversation\"":\""ostatus:conversation\"",\""focalPoint\"":{\""@container\"":\""@list\"",\""@id\"":\""toot:focalPoint\""},\""blurhash\"":\""toot:blurhash\"",\""discoverable\"":\""toot:discoverable\"",\""indexable\"":\""toot:indexable\"",\""memorial\"":\""toot:memorial\"",\""votersCount\"":\""toot:votersCount\"",\""suspended\"":\""toot:suspended\"",\""attributionDomains\"":{\""@id\"":\""toot:attributionDomains\"",\""@type\"":\""@id\""}}],\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/activity\"",\""type\"":\""Create\"",\""actor\"":\""https://pie.gd/users/faerye\"",\""published\"":\""2025-03-05T05:49:18Z\"",\""to\"":[\""https://www.w3.org/ns/activitystreams#Public\""],\""cc\"":[\""https://pie.gd/users/faerye/followers\"",\""https://sunny.garden/users/handmade_ghost\""],\""object\"":{\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063\"",\""type\"":\""Note\"",\""inReplyTo\"":\""https://sunny.garden/users/handmade_ghost/statuses/114107038088241764\"",\""published\"":\""2025-03-05T05:49:18Z\"",\""url\"":\""https://pie.gd/@faerye/114108252734374063\"",\""attributedTo\"":\""https://pie.gd/users/faerye\"",\""to\"":[\""https://www.w3.org/ns/activitystreams#Public\""],\""cc\"":[\""https://pie.gd/users/faerye/followers\"",\""https://sunny.garden/users/handmade_ghost\""],\""sensitive\"":false,\""atomUri\"":\""https://pie.gd/users/faerye/statuses/114108252734374063\"",\""inReplyToAtomUri\"":\""https://sunny.garden/users/handmade_ghost/statuses/114107038088241764\"",\""conversation\"":\""tag:pie.gd,2025-02-28:objectId=1386706:objectType=Conversation\"",\""content\"":\""<p><span class=""h-card"" translate=""no""><a href=""https://sunny.garden/@handmade_ghost"" class=""u-url mention"">@<span>handmade_ghost</span></a></span> Yesssss! I most often hear creepers in a mature second growth conifer forest I go to, but never see em. Basically every decent or good photo I have is from deciduous wooded parkland (a sort of botanical garden in this case!) Not just the bark match factor: they were far lower! Ill see what I can do about getting their advice creeper-peeping its way south :)</p>\"",\""contentMap\"":{\""en\"":\""<p><span class=""h-card"" translate=""no""><a href=""https://sunny.garden/@handmade_ghost"" class=""u-url mention"">@<span>handmade_ghost</span></a></span> Yesssss! I most often hear creepers in a mature second growth conifer forest I go to, but never see em. Basically every decent or good photo I have is from deciduous wooded parkland (a sort of botanical garden in this case!) Not just the bark match factor: they were far lower! Ill see what I can do about getting their advice creeper-peeping its way south :)</p>\""},\""attachment\"":[],\""tag\"":[{\""type\"":\""Mention\"",\""href\"":\""https://sunny.garden/users/handmade_ghost\"",\""name\"":\""@handmade_ghost@sunny.garden\""}],\""replies\"":{\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/replies\"",\""type\"":\""Collection\"",\""first\"":{\""type\"":\""CollectionPage\"",\""next\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/replies?only_other_accounts=true&page=true\"",\""partOf\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/replies\"",\""items\"":[]}},\""likes\"":{\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/likes\"",\""type\"":\""Collection\"",\""totalItems\"":0},\""shares\"":{\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/shares\"",\""type\"":\""Collection\"",\""totalItems\"":0}},\""signature\"":{\""type\"":\""RsaSignature2017\"",\""creator\"":\""https://pie.gd/users/faerye#main-key\"",\""created\"":\""2025-03-05T05:49:18Z\"",\""signatureValue\"":\""YlN++XTAnBRn8ediYHUDeZOFznlI0kHg5CR5sz9WQlB5XgMj9FXMoRNmVciOglT0tRENebRCXSHDtaruYNSHyaGOgoXDkvQs67upp/1CbSXVtGRRxZ3RtVxVNROI3rKqMwUY3X7Iak5AJg6aXdcxJh65imCXINHXY1g+1f8vcyZsEH8u4zAeEV/eq9Im5znoShozaLLiChkDog+WZgkQZYGjLPYffze5AqNlrx/vO07j9Jv50/m8SvK/Ttc3WLNvTnO+2+wiezOjDWwRYMvVqOj0SLHjaxIpYGccH5u1e49Rs6HK7BvMdu26v/ipDE95zEs8Ei1QkRT+jmfVKgh7uQ==\""}}"",112151750992567142,""https://outerheaven.club/inbox"",{}],""jid"":""96048db846354f6fac304e82"",""created_at"":1741153759.255959,""enqueued_at"":1741154015.807546,""error_message"":""https://outerheaven.club/inbox returned code 401"",""error_class"":""Mastodon::UnexpectedResponseError"",""failed_at"":1741153765.253845,""retry_count"":3,""retried_at"":1741153876.4350216}} Mar 05 05:53:36 radish-1 bundle[1908833]: 2025-03-05T05:53:36.196Z pid=1908833 tid=5zbdd WARN: NoMethodError: undefined method `evalsha' for nil Mar 05 05:53:36 radish-1 bundle[1908833]: 2025-03-05T05:53:36.196Z pid=1908833 tid=5zbdd WARN: /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/redlock-1.3.2/lib/redlock/client.rb:171:in `block (2 levels) in lock' Mar 05 05:53:36 radish-1 bundle[1908833]: /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/activesupport-7.1.5.1/lib/active_support/core_ext/object/with.rb:31:in `with' Mar 05 05:53:36 radish-1 bundle[1908833]: /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/redlock-1.3.2/lib/redlock/client.rb:171:in `block in lock' ",source-file,"NoMethodError: undefined method `evalsha' for nil  Steps to reproduce the problem 1. Inspect logs or sidekiq retry/dead queues  Expected behaviour No warnings about NoMethodError  Actual behaviour Warnings about NoMethodError  Detailed description Since v4.3 I've seen a noticeable number of sidekiq jobs failing with the warning:  NoMethodError: undefined method `evalsha' for nil  It's unclear to me whether this is a bug, a deployment issue on my server, or the expected behaviour of some failure case.  Mastodon instance sunny.garden  Mastodon version v4.3.4  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.3.5 (2024-09-03 revision ef084cc8f4) [x86_64-linux] - Node.js version: v20.17.0 In the majority of cases, the remote server is running Akkoma or Pleroma, however it also results from Mastodon servers less frequently as well.  Mar 05 05:53:36 radish-1 bundle[1908833]: 2025-03-05T05:53:36.195Z pid=1908833 tid=5zbdd WARN: {""context"":""Job raised exception"",""job"":{""retry"":16,""queue"":""push"",""dead"":false,""class"":""ActivityPub::DeliveryWorker"",""args"":[""{\""@context\"":[\""https://www.w3.org/ns/activitystreams\"",\""https://w3id.org/security/v1\"",{\""manuallyApprovesFollowers\"":\""as:manuallyApprovesFollowers\"",\""sensitive\"":\""as:sensitive\"",\""Hashtag\"":\""as:Hashtag\"",\""movedTo\"":{\""@id\"":\""as:movedTo\"",\""@type\"":\""@id\""},\""alsoKnownAs\"":{\""@id\"":\""as:alsoKnownAs\"",\""@type\"":\""@id\""},\""toot\"":\""http://joinmastodon.org/ns#\"",\""Emoji\"":\""toot:Emoji\"",\""featured\"":{\""@id\"":\""toot:featured\"",\""@type\"":\""@id\""},\""featuredTags\"":{\""@id\"":\""toot:featuredTags\"",\""@type\"":\""@id\""},\""schema\"":\""http://schema.org#\"",\""PropertyValue\"":\""schema:PropertyValue\"",\""value\"":\""schema:value\"",\""ostatus\"":\""http://ostatus.org#\"",\""atomUri\"":\""ostatus:atomUri\"",\""inReplyToAtomUri\"":\""ostatus:inReplyToAtomUri\"",\""conversation\"":\""ostatus:conversation\"",\""focalPoint\"":{\""@container\"":\""@list\"",\""@id\"":\""toot:focalPoint\""},\""blurhash\"":\""toot:blurhash\"",\""discoverable\"":\""toot:discoverable\"",\""indexable\"":\""toot:indexable\"",\""memorial\"":\""toot:memorial\"",\""votersCount\"":\""toot:votersCount\"",\""suspended\"":\""toot:suspended\"",\""attributionDomains\"":{\""@id\"":\""toot:attributionDomains\"",\""@type\"":\""@id\""}}],\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/activity\"",\""type\"":\""Create\"",\""actor\"":\""https://pie.gd/users/faerye\"",\""published\"":\""2025-03-05T05:49:18Z\"",\""to\"":[\""https://www.w3.org/ns/activitystreams#Public\""],\""cc\"":[\""https://pie.gd/users/faerye/followers\"",\""https://sunny.garden/users/handmade_ghost\""],\""object\"":{\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063\"",\""type\"":\""Note\"",\""inReplyTo\"":\""https://sunny.garden/users/handmade_ghost/statuses/114107038088241764\"",\""published\"":\""2025-03-05T05:49:18Z\"",\""url\"":\""https://pie.gd/@faerye/114108252734374063\"",\""attributedTo\"":\""https://pie.gd/users/faerye\"",\""to\"":[\""https://www.w3.org/ns/activitystreams#Public\""],\""cc\"":[\""https://pie.gd/users/faerye/followers\"",\""https://sunny.garden/users/handmade_ghost\""],\""sensitive\"":false,\""atomUri\"":\""https://pie.gd/users/faerye/statuses/114108252734374063\"",\""inReplyToAtomUri\"":\""https://sunny.garden/users/handmade_ghost/statuses/114107038088241764\"",\""conversation\"":\""tag:pie.gd,2025-02-28:objectId=1386706:objectType=Conversation\"",\""content\"":\""<p><span class=""h-card"" translate=""no""><a href=""https://sunny.garden/@handmade_ghost"" class=""u-url mention"">@<span>handmade_ghost</span></a></span> Yesssss! I most often hear creepers in a mature second growth conifer forest I go to, but never see em. Basically every decent or good photo I have is from deciduous wooded parkland (a sort of botanical garden in this case!) Not just the bark match factor: they were far lower! Ill see what I can do about getting their advice creeper-peeping its way south :)</p>\"",\""contentMap\"":{\""en\"":\""<p><span class=""h-card"" translate=""no""><a href=""https://sunny.garden/@handmade_ghost"" class=""u-url mention"">@<span>handmade_ghost</span></a></span> Yesssss! I most often hear creepers in a mature second growth conifer forest I go to, but never see em. Basically every decent or good photo I have is from deciduous wooded parkland (a sort of botanical garden in this case!) Not just the bark match factor: they were far lower! Ill see what I can do about getting their advice creeper-peeping its way south :)</p>\""},\""attachment\"":[],\""tag\"":[{\""type\"":\""Mention\"",\""href\"":\""https://sunny.garden/users/handmade_ghost\"",\""name\"":\""@handmade_ghost@sunny.garden\""}],\""replies\"":{\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/replies\"",\""type\"":\""Collection\"",\""first\"":{\""type\"":\""CollectionPage\"",\""next\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/replies?only_other_accounts=true&page=true\"",\""partOf\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/replies\"",\""items\"":[]}},\""likes\"":{\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/likes\"",\""type\"":\""Collection\"",\""totalItems\"":0},\""shares\"":{\""id\"":\""https://pie.gd/users/faerye/statuses/114108252734374063/shares\"",\""type\"":\""Collection\"",\""totalItems\"":0}},\""signature\"":{\""type\"":\""RsaSignature2017\"",\""creator\"":\""https://pie.gd/users/faerye#main-key\"",\""created\"":\""2025-03-05T05:49:18Z\"",\""signatureValue\"":\""YlN++XTAnBRn8ediYHUDeZOFznlI0kHg5CR5sz9WQlB5XgMj9FXMoRNmVciOglT0tRENebRCXSHDtaruYNSHyaGOgoXDkvQs67upp/1CbSXVtGRRxZ3RtVxVNROI3rKqMwUY3X7Iak5AJg6aXdcxJh65imCXINHXY1g+1f8vcyZsEH8u4zAeEV/eq9Im5znoShozaLLiChkDog+WZgkQZYGjLPYffze5AqNlrx/vO07j9Jv50/m8SvK/Ttc3WLNvTnO+2+wiezOjDWwRYMvVqOj0SLHjaxIpYGccH5u1e49Rs6HK7BvMdu26v/ipDE95zEs8Ei1QkRT+jmfVKgh7uQ==\""}}"",112151750992567142,""https://outerheaven.club/inbox"",{}],""jid"":""96048db846354f6fac304e82"",""created_at"":1741153759.255959,""enqueued_at"":1741154015.807546,""error_message"":""https://outerheaven.club/inbox returned code 401"",""error_class"":""Mastodon::UnexpectedResponseError"",""failed_at"":1741153765.253845,""retry_count"":3,""retried_at"":1741153876.4350216}} Mar 05 05:53:36 radish-1 bundle[1908833]: 2025-03-05T05:53:36.196Z pid=1908833 tid=5zbdd WARN: NoMethodError: undefined method `evalsha' for nil Mar 05 05:53:36 radish-1 bundle[1908833]: 2025-03-05T05:53:36.196Z pid=1908833 tid=5zbdd WARN: /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/redlock-1.3.2/lib/redlock/client.rb:171:in `block (2 levels) in lock' Mar 05 05:53:36 radish-1 bundle[1908833]: /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/activesupport-7.1.5.1/lib/active_support/core_ext/object/with.rb:31:in `with' Mar 05 05:53:36 radish-1 bundle[1908833]: /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/redlock-1.3.2/lib/redlock/client.rb:171:in `block in lock'  source-file",no-bug,0.9
30728,mastodon,https://github.com/mastodon/mastodon/issues/30728,Favicon customization doesnt touch svg `mask-icon`," Steps to reproduce the problem 1. As a server admin, customize favicon using capabilities introduced in #30040  Expected behaviour Users should be able to see the customized icon everywhere and/or admin should be able to configure the svg mask-icon separately  Actual behaviour The svg `mask-icon` is still the mastodon logo in the mastodon brand color, so users may see it as their browsers tab icon rather than the custom one  Detailed description Ideally, the admin should be able to upload their own properly formatted vector file for the `mask-icon`, choose a color for it, and see a preview of how it would be displayed in the admin interface along with the other icons. Maybe the admin should be able to disable the mask-icon if they use a custom favicon without uploading a matching `mask-icon`.  Mastodon instance N/A  Mastodon version anything that includes #30040  Browser name and version Safari (any version)  Operating system any apple OS  Technical details _No response_",source-file | source-file | other-file,"Favicon customization doesnt touch svg `mask-icon`  Steps to reproduce the problem 1. As a server admin, customize favicon using capabilities introduced in #30040  Expected behaviour Users should be able to see the customized icon everywhere and/or admin should be able to configure the svg mask-icon separately  Actual behaviour The svg `mask-icon` is still the mastodon logo in the mastodon brand color, so users may see it as their browsers tab icon rather than the custom one  Detailed description Ideally, the admin should be able to upload their own properly formatted vector file for the `mask-icon`, choose a color for it, and see a preview of how it would be displayed in the admin interface along with the other icons. Maybe the admin should be able to disable the mask-icon if they use a custom favicon without uploading a matching `mask-icon`.  Mastodon instance N/A  Mastodon version anything that includes #30040  Browser name and version Safari (any version)  Operating system any apple OS  Technical details _No response_ source-file source-file other-file",no-bug,0.9
33681,mastodon,https://github.com/mastodon/mastodon/issues/33681,Mastodon (.social) Web Share Intent broken right now," Steps to reproduce the problem For years, I have been using this bookmarklet to share links on Mastodon. `javascript:window.open(""https://mastodon.social/share?text=""+encodeURIComponent(document.title)+""&url=""+encodeURIComponent(""\n\n""+location.href), """");` This is broken right now on mastodon.social. If I try to share just text, it seems to work so I imagine that the encoding of URL is causing the share page to not load fully. Example of a broken share intent link at the moment: `https://mastodon.social/share?text=Home%20-%20Mastodon&url=%0A%0Ahttps%3A%2F%2Fmastodon.social%2Fhome`  Expected behaviour Share page should load properly with link title and link URI  Actual behaviour Share page does not load fully.  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version 4.4.0-nightly.2025-01-22  Browser name and version Chrome 131.0.6778.265  Operating system Windows 10  Technical details _No response_",source-file,"Mastodon (.social) Web Share Intent broken right now  Steps to reproduce the problem For years, I have been using this bookmarklet to share links on Mastodon. `javascript:window.open(""https://mastodon.social/share?text=""+encodeURIComponent(document.title)+""&url=""+encodeURIComponent(""\n\n""+location.href), """");` This is broken right now on mastodon.social. If I try to share just text, it seems to work so I imagine that the encoding of URL is causing the share page to not load fully. Example of a broken share intent link at the moment: `https://mastodon.social/share?text=Home%20-%20Mastodon&url=%0A%0Ahttps%3A%2F%2Fmastodon.social%2Fhome`  Expected behaviour Share page should load properly with link title and link URI  Actual behaviour Share page does not load fully.  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version 4.4.0-nightly.2025-01-22  Browser name and version Chrome 131.0.6778.265  Operating system Windows 10  Technical details _No response_ source-file",no-bug,0.8
27194,mastodon,https://github.com/mastodon/mastodon/issues/27194,Post language strings with country code are invalid according to BCP47," Steps to reproduce the problem 1. Create a post with the language set to a locale with a country code (e.g. zh-HK) 2. Obtain the JSON-LD of the post (e.g. using `curl -H ""Accept: application/json""`) 3. Note the keys of the `contentMap` object  Expected behaviour The first key of the object should be a valid locale string in accordance with BCP47 (e.g. zh-HK)  Actual behaviour The first key is in camel-case without a hyphen (e.g. zhHk)  Detailed description Introduced by #27099. It seems like this is how languages are currently stored in the database, so some conversion is likely needed before sending a post to inboxes.  Mastodon instance _No response_  Mastodon version _No response_  Technical details - Ruby version: 3.2.2 - Node.js version: 18.17.1",source-file | source-file,"Post language strings with country code are invalid according to BCP47  Steps to reproduce the problem 1. Create a post with the language set to a locale with a country code (e.g. zh-HK) 2. Obtain the JSON-LD of the post (e.g. using `curl -H ""Accept: application/json""`) 3. Note the keys of the `contentMap` object  Expected behaviour The first key of the object should be a valid locale string in accordance with BCP47 (e.g. zh-HK)  Actual behaviour The first key is in camel-case without a hyphen (e.g. zhHk)  Detailed description Introduced by #27099. It seems like this is how languages are currently stored in the database, so some conversion is likely needed before sending a post to inboxes.  Mastodon instance _No response_  Mastodon version _No response_  Technical details - Ruby version: 3.2.2 - Node.js version: 18.17.1 source-file source-file",bug,0.9
33772,mastodon,https://github.com/mastodon/mastodon/issues/33772,"""Mastodon update is available"" shown even after upgrading"," Steps to reproduce the problem I've upgraded to 4.2.15 successfully but under the Admin Dashboard it still shows the warning prompt of ""A Mastodon update is available."" Clicking on that link takes me to a screen that displays both 4.2.15 as well as 4.3.3.  Expected behaviour Only 4.3.3 to appear in this list?  Actual behaviour v4.2.15 should not appear in my list because I've already upgraded to it / it is present live version. Should it still show the ""update available"" even if you're on the latest prev branch?  Detailed description _No response_  Mastodon instance birdbutt.com  Mastodon version v4.2.15  Browser name and version Firefox 133  Operating system macOS 14.5  Technical details Let me know if any more is needed, but it was a very easy / straightforward 4.2.15 upgrade. Services and server restarted too, caches cleared.",source-file | source-file,"""Mastodon update is available"" shown even after upgrading  Steps to reproduce the problem I've upgraded to 4.2.15 successfully but under the Admin Dashboard it still shows the warning prompt of ""A Mastodon update is available."" Clicking on that link takes me to a screen that displays both 4.2.15 as well as 4.3.3.  Expected behaviour Only 4.3.3 to appear in this list?  Actual behaviour v4.2.15 should not appear in my list because I've already upgraded to it / it is present live version. Should it still show the ""update available"" even if you're on the latest prev branch?  Detailed description _No response_  Mastodon instance birdbutt.com  Mastodon version v4.2.15  Browser name and version Firefox 133  Operating system macOS 14.5  Technical details Let me know if any more is needed, but it was a very easy / straightforward 4.2.15 upgrade. Services and server restarted too, caches cleared. source-file source-file",no-bug,0.9
28003,mastodon,https://github.com/mastodon/mastodon/issues/28003,Unable to mute users without web UI error," Steps to reproduce the problem 1. Try to mute a user  Expected behaviour User is muted  Actual behaviour ""Oops, an expected error has occurred"" (It appears the user is also then muted.)  Detailed description _No response_  Mastodon instance vmst.io, mastodon.online  Mastodon version v4.3.0-alpha.0, v4.3.0-nightly.2023-11-19  Browser name and version Safari  Operating system macOS  Technical details _No response_",source-file,"Unable to mute users without web UI error  Steps to reproduce the problem 1. Try to mute a user  Expected behaviour User is muted  Actual behaviour ""Oops, an expected error has occurred"" (It appears the user is also then muted.)  Detailed description _No response_  Mastodon instance vmst.io, mastodon.online  Mastodon version v4.3.0-alpha.0, v4.3.0-nightly.2023-11-19  Browser name and version Safari  Operating system macOS  Technical details _No response_ source-file",bug,0.9
33109,mastodon,https://github.com/mastodon/mastodon/issues/33109,Edits appear to fail to process with unresolvable mentions," Steps to reproduce the problem 1. Receive an `Update` with an unresolvable mention (ie domain is gone) 2. Job fails to process, so `Update` is never applied 3. See failed job in sidekick morgue Needs a fix akin to #29215  Expected behaviour Job will process successfully  Actual behaviour Job will fail to process  Detailed description Backtrace:  app/lib/request.rb:110:in `rescue in perform': failed to connect: No address for beta.mstdn.cf on https://beta.mstdn.cf/users/mariaressa (HTTP::ConnectionError) from app/lib/request.rb:107:in `perform' from app/helpers/jsonld_helper.rb:174:in `fetch_resource_without_id_validation' from app/helpers/jsonld_helper.rb:167:in `fetch_resource' from app/services/activitypub/fetch_remote_actor_service.rb:18:in `call' from app/services/activitypub/fetch_remote_account_service.rb:6:in `call' from app/services/activitypub/process_status_update_service.rb:198:in `block in update_mentions!' from app/services/activitypub/process_status_update_service.rb:194:in `each' from app/services/activitypub/process_status_update_service.rb:194:in `update_mentions!' from app/services/activitypub/process_status_update_service.rb:182:in `update_metadata!' from app/services/activitypub/process_status_update_service.rb:45:in `block (2 levels) in handle_explicit_update!' from app/services/activitypub/process_status_update_service.rb:40:in `block in handle_explicit_update!' from app/models/concerns/lockable.rb:12:in `block (2 levels) in with_redis_lock' from app/models/concerns/lockable.rb:10:in `block in with_redis_lock' from app/lib/redis_connection.rb:10:in `with' from app/models/concerns/redisable.rb:9:in `with_redis' from app/models/concerns/lockable.rb:9:in `with_redis_lock'  13 levels /home/mastodon/live/app/lib/request.rb:328:in `open': failed to connect: No address for beta.mstdn.cf (HTTP::ConnectionError) from /home/mastodon/live/app/lib/request.rb:24:in `connect' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/connection.rb:42:in `initialize' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:49:in `initialize' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:70:in `new' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:70:in `perform' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:12:in `block (2 levels) in <class:Client>' from /home/mastodon/.rbenv/versions/3.3.5/lib/ruby/3.3.0/benchmark.rb:313:in `realtime' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:11:in `block in <class:Client>' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:31:in `request' from /home/mastodon/live/app/lib/request.rb:108:in `perform' from /home/mastodon/live/app/helpers/jsonld_helper.rb:174:in `fetch_resource_without_id_validation' from /home/mastodon/live/app/helpers/jsonld_helper.rb:167:in `fetch_resource' from /home/mastodon/live/app/services/activitypub/fetch_remote_actor_service.rb:18:in `call' from /home/mastodon/live/app/services/activitypub/fetch_remote_account_service.rb:6:in `call' from /home/mastodon/live/app/services/activitypub/process_status_update_service.rb:198:in `block in update_mentions!' from /home/mastodon/live/app/services/activitypub/process_status_update_service.rb:194:in `each'  64 levels /home/mastodon/live/app/lib/request.rb:328:in `open': No address for beta.mstdn.cf (SocketError) from /home/mastodon/live/app/lib/request.rb:24:in `connect' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/connection.rb:42:in `initialize' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:49:in `initialize' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:70:in `new' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:70:in `perform' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:12:in `block (2 levels) in <class:Client>' from /home/mastodon/.rbenv/versions/3.3.5/lib/ruby/3.3.0/benchmark.rb:313:in `realtime' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:11:in `block in <class:Client>' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:31:in `request' from /home/mastodon/live/app/lib/request.rb:108:in `perform' from /home/mastodon/live/app/helpers/jsonld_helper.rb:174:in `fetch_resource_without_id_validation' from /home/mastodon/live/app/helpers/jsonld_helper.rb:167:in `fetch_resource' from /home/mastodon/live/app/services/activitypub/fetch_remote_actor_service.rb:18:in `call' from /home/mastodon/live/app/services/activitypub/fetch_remote_account_service.rb:6:in `call' from /home/mastodon/live/app/services/activitypub/process_status_update_service.rb:198:in `block in update_mentions!' from /home/mastodon/live/app/services/activitypub/process_status_update_service.rb:194:in `each'  64 levels   Mastodon instance raphus.social  Mastodon version v4.3.1  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.3.5 (2024-09-03 revision ef084cc8f4) [x86_64-linux] - Node.js version: v20.5.1",source-file,"Edits appear to fail to process with unresolvable mentions  Steps to reproduce the problem 1. Receive an `Update` with an unresolvable mention (ie domain is gone) 2. Job fails to process, so `Update` is never applied 3. See failed job in sidekick morgue Needs a fix akin to #29215  Expected behaviour Job will process successfully  Actual behaviour Job will fail to process  Detailed description Backtrace:  app/lib/request.rb:110:in `rescue in perform': failed to connect: No address for beta.mstdn.cf on https://beta.mstdn.cf/users/mariaressa (HTTP::ConnectionError) from app/lib/request.rb:107:in `perform' from app/helpers/jsonld_helper.rb:174:in `fetch_resource_without_id_validation' from app/helpers/jsonld_helper.rb:167:in `fetch_resource' from app/services/activitypub/fetch_remote_actor_service.rb:18:in `call' from app/services/activitypub/fetch_remote_account_service.rb:6:in `call' from app/services/activitypub/process_status_update_service.rb:198:in `block in update_mentions!' from app/services/activitypub/process_status_update_service.rb:194:in `each' from app/services/activitypub/process_status_update_service.rb:194:in `update_mentions!' from app/services/activitypub/process_status_update_service.rb:182:in `update_metadata!' from app/services/activitypub/process_status_update_service.rb:45:in `block (2 levels) in handle_explicit_update!' from app/services/activitypub/process_status_update_service.rb:40:in `block in handle_explicit_update!' from app/models/concerns/lockable.rb:12:in `block (2 levels) in with_redis_lock' from app/models/concerns/lockable.rb:10:in `block in with_redis_lock' from app/lib/redis_connection.rb:10:in `with' from app/models/concerns/redisable.rb:9:in `with_redis' from app/models/concerns/lockable.rb:9:in `with_redis_lock'  13 levels /home/mastodon/live/app/lib/request.rb:328:in `open': failed to connect: No address for beta.mstdn.cf (HTTP::ConnectionError) from /home/mastodon/live/app/lib/request.rb:24:in `connect' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/connection.rb:42:in `initialize' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:49:in `initialize' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:70:in `new' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:70:in `perform' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:12:in `block (2 levels) in <class:Client>' from /home/mastodon/.rbenv/versions/3.3.5/lib/ruby/3.3.0/benchmark.rb:313:in `realtime' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:11:in `block in <class:Client>' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:31:in `request' from /home/mastodon/live/app/lib/request.rb:108:in `perform' from /home/mastodon/live/app/helpers/jsonld_helper.rb:174:in `fetch_resource_without_id_validation' from /home/mastodon/live/app/helpers/jsonld_helper.rb:167:in `fetch_resource' from /home/mastodon/live/app/services/activitypub/fetch_remote_actor_service.rb:18:in `call' from /home/mastodon/live/app/services/activitypub/fetch_remote_account_service.rb:6:in `call' from /home/mastodon/live/app/services/activitypub/process_status_update_service.rb:198:in `block in update_mentions!' from /home/mastodon/live/app/services/activitypub/process_status_update_service.rb:194:in `each'  64 levels /home/mastodon/live/app/lib/request.rb:328:in `open': No address for beta.mstdn.cf (SocketError) from /home/mastodon/live/app/lib/request.rb:24:in `connect' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/connection.rb:42:in `initialize' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:49:in `initialize' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:70:in `new' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:70:in `perform' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:12:in `block (2 levels) in <class:Client>' from /home/mastodon/.rbenv/versions/3.3.5/lib/ruby/3.3.0/benchmark.rb:313:in `realtime' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/httplog-1.7.0/lib/httplog/adapters/http.rb:11:in `block in <class:Client>' from /home/mastodon/live/vendor/bundle/ruby/3.3.0/gems/http-5.2.0/lib/http/client.rb:31:in `request' from /home/mastodon/live/app/lib/request.rb:108:in `perform' from /home/mastodon/live/app/helpers/jsonld_helper.rb:174:in `fetch_resource_without_id_validation' from /home/mastodon/live/app/helpers/jsonld_helper.rb:167:in `fetch_resource' from /home/mastodon/live/app/services/activitypub/fetch_remote_actor_service.rb:18:in `call' from /home/mastodon/live/app/services/activitypub/fetch_remote_account_service.rb:6:in `call' from /home/mastodon/live/app/services/activitypub/process_status_update_service.rb:198:in `block in update_mentions!' from /home/mastodon/live/app/services/activitypub/process_status_update_service.rb:194:in `each'  64 levels   Mastodon instance raphus.social  Mastodon version v4.3.1  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: ruby 3.3.5 (2024-09-03 revision ef084cc8f4) [x86_64-linux] - Node.js version: v20.5.1 source-file",bug,0.85
27678,mastodon,https://github.com/mastodon/mastodon/issues/27678,Container build error due to missing config/webpack/tests," Steps to reproduce the problem 1. Build container in github codespace  Expected behaviour Successful build  Actual behaviour Got an error  Detailed description Error message: webpack config /workspaces/mastodon/config/webpack/tests.js not found, please run 'bundle exec rails webpacker:install' to install Webpacker with default configs or add the missing config file for your custom environment. The file was deleted in #27333  Mastodon instance _No response_  Mastodon version _No response_  Technical details _No response_",config-file,"Container build error due to missing config/webpack/tests  Steps to reproduce the problem 1. Build container in github codespace  Expected behaviour Successful build  Actual behaviour Got an error  Detailed description Error message: webpack config /workspaces/mastodon/config/webpack/tests.js not found, please run 'bundle exec rails webpacker:install' to install Webpacker with default configs or add the missing config file for your custom environment. The file was deleted in #27333  Mastodon instance _No response_  Mastodon version _No response_  Technical details _No response_ config-file",no-bug,0.9
34251,mastodon,https://github.com/mastodon/mastodon/issues/34251,Too many CacheBuster queues after run tootctl," Steps to reproduce the problem 1. run `tootctl status remove` 2. Check /sidekiq   Expected behaviour Nothing weird happens  Actual behaviour A lot of CacheBusterWorker queue for ""/thumbnails/original/missing.png""  Detailed description ![Image](https://github.com/user-attachments/assets/6242650d-3532-402a-afaf-fe0374cf9577)  Mastodon instance qdon.space  Mastodon version v4.4.0-alpha.4 (30e334b51a4e7add05401895bff5a2ea4a97e0bd)  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: v3.4.2 - Node.js version: v22.14",source-file,"Too many CacheBuster queues after run tootctl  Steps to reproduce the problem 1. run `tootctl status remove` 2. Check /sidekiq   Expected behaviour Nothing weird happens  Actual behaviour A lot of CacheBusterWorker queue for ""/thumbnails/original/missing.png""  Detailed description ![Image](https://github.com/user-attachments/assets/6242650d-3532-402a-afaf-fe0374cf9577)  Mastodon instance qdon.space  Mastodon version v4.4.0-alpha.4 (30e334b51a4e7add05401895bff5a2ea4a97e0bd)  Technical details If this is happening on your own Mastodon server, please fill out those: - Ruby version: v3.4.2 - Node.js version: v22.14 source-file",no-bug,0.9
29063,mastodon,https://github.com/mastodon/mastodon/issues/29063,"[Android] onboarding broken, not possible to verify email"," Steps to reproduce the problem 1. register a new email in the Android app (latest) 2. wait for verification email 3. notice how the email doesn't have a verification link, but has an ""Account Setting"" link instead, which will lead you to change your password rather than verify your email.   Expected behaviour Verify email link  Actual behaviour Account settings link  Detailed description _No response_  Mastodon instance Android app latest version  Mastodon version Latest  Technical details _No response_",other-file,"[Android] onboarding broken, not possible to verify email  Steps to reproduce the problem 1. register a new email in the Android app (latest) 2. wait for verification email 3. notice how the email doesn't have a verification link, but has an ""Account Setting"" link instead, which will lead you to change your password rather than verify your email.   Expected behaviour Verify email link  Actual behaviour Account settings link  Detailed description _No response_  Mastodon instance Android app latest version  Mastodon version Latest  Technical details _No response_ other-file",no-bug,0.7
31547,mastodon,https://github.com/mastodon/mastodon/issues/31547,Appearance of blocked domains list in Federation page is broken," Steps to reproduce the problem 1. Open Moderation > Federation page 2. The CSS style of the list seems broken  Expected behaviour Domain list presented as cards  Actual behaviour Domain list presented as underlined links and misaligned  Detailed description This is how the domains (blocked/limited or not) are presented now: ![image](https://github.com/user-attachments/assets/90a29e40-526a-42dc-bec2-099fae33d822)  Mastodon instance bolha.one, ursal.zone  Mastodon version v4.3.0-alpha.5-2da687a  Browser name and version LibreWolf 129, Chromium v127.0.6533.120  Operating system Debian 12  Technical details _No response_",other-file,"Appearance of blocked domains list in Federation page is broken  Steps to reproduce the problem 1. Open Moderation > Federation page 2. The CSS style of the list seems broken  Expected behaviour Domain list presented as cards  Actual behaviour Domain list presented as underlined links and misaligned  Detailed description This is how the domains (blocked/limited or not) are presented now: ![image](https://github.com/user-attachments/assets/90a29e40-526a-42dc-bec2-099fae33d822)  Mastodon instance bolha.one, ursal.zone  Mastodon version v4.3.0-alpha.5-2da687a  Browser name and version LibreWolf 129, Chromium v127.0.6533.120  Operating system Debian 12  Technical details _No response_ other-file",no-bug,0.9
27726,mastodon,https://github.com/mastodon/mastodon/issues/27726,Explore prompt still shows up with out of order posts," Steps to reproduce the problem 1. Load a home timeline with plenty of activity, in which one of the most recent 20 posts was received out of order and had been created more than 10 hours ago  Expected behaviour Expect to see no explore prompt prompting you to follow more people  Actual behaviour See an explore prompt that prompts you to follow more people  Detailed description This looks like it's the same issue as #27211 which didn't actually fix the issue; in fact, it made it worse (though thankfully easier to debug) as now the explore prompt shows up the entire time the out of order post is in the latest 20 posts. If a post from another server arrives at your server over 10 hours late, then it can show up in the latest 20 posts which are used to calculate whether the explore prompt should show up, and it will be used as the oldest post when calculating the average gap. If there's over a 10 hour delta between this and the newest post, then the calculation will decide to show the explore prompt. In #27211 a change was made to try to address this issue; but that changed it from looking at the last post in the list (ordered by the order they are arranged on your timeline), to looking at the one with the oldest timestamp. Now, the explore prompt will show up the entire time this post which is displayed out of order is in the latest 20, not just when it's at the end of the list. For example, here are a couple of the values I extracted for the oldest and newest when looking at this in the debugger: * Newest: Date Mon Nov 06 2023 07:34:30 GMT-0500 (Eastern Standard Time) * Oldest: Date Sun Nov 05 2023 12:35:52 GMT-0500 (Eastern Standard Time) I think that a quick fix for this might be to sort by the created date before looking at the first 20 statuses, so you'll get the latest 20 by created date, rather than taking the latest 20 by displayed order.  Mastodon instance hachyderm.io  Mastodon version v4.2.1  Browser name and version FIrefox 119.0  Operating system Ubuntu 22.04.3 LTS (Jammy Jellyfish)  Technical details _No response_",other-file | other-file | other-file,"Explore prompt still shows up with out of order posts  Steps to reproduce the problem 1. Load a home timeline with plenty of activity, in which one of the most recent 20 posts was received out of order and had been created more than 10 hours ago  Expected behaviour Expect to see no explore prompt prompting you to follow more people  Actual behaviour See an explore prompt that prompts you to follow more people  Detailed description This looks like it's the same issue as #27211 which didn't actually fix the issue; in fact, it made it worse (though thankfully easier to debug) as now the explore prompt shows up the entire time the out of order post is in the latest 20 posts. If a post from another server arrives at your server over 10 hours late, then it can show up in the latest 20 posts which are used to calculate whether the explore prompt should show up, and it will be used as the oldest post when calculating the average gap. If there's over a 10 hour delta between this and the newest post, then the calculation will decide to show the explore prompt. In #27211 a change was made to try to address this issue; but that changed it from looking at the last post in the list (ordered by the order they are arranged on your timeline), to looking at the one with the oldest timestamp. Now, the explore prompt will show up the entire time this post which is displayed out of order is in the latest 20, not just when it's at the end of the list. For example, here are a couple of the values I extracted for the oldest and newest when looking at this in the debugger: * Newest: Date Mon Nov 06 2023 07:34:30 GMT-0500 (Eastern Standard Time) * Oldest: Date Sun Nov 05 2023 12:35:52 GMT-0500 (Eastern Standard Time) I think that a quick fix for this might be to sort by the created date before looking at the first 20 statuses, so you'll get the latest 20 by created date, rather than taking the latest 20 by displayed order.  Mastodon instance hachyderm.io  Mastodon version v4.2.1  Browser name and version FIrefox 119.0  Operating system Ubuntu 22.04.3 LTS (Jammy Jellyfish)  Technical details _No response_ other-file other-file other-file",no-bug,0.9
32815,mastodon,https://github.com/mastodon/mastodon/issues/32815,Posts with a future date can trend," Steps to reproduce the problem For example https://social.besties.house/@h/113449358538636686 has been trending on mastodon.social  Expected behaviour Those posts are either dropped, or at least can not trend  Actual behaviour They can appear in trends  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.4.0  Browser name and version -  Operating system -  Technical details _No response_",source-file,"Posts with a future date can trend  Steps to reproduce the problem For example https://social.besties.house/@h/113449358538636686 has been trending on mastodon.social  Expected behaviour Those posts are either dropped, or at least can not trend  Actual behaviour They can appear in trends  Detailed description _No response_  Mastodon instance mastodon.social  Mastodon version v4.4.0  Browser name and version -  Operating system -  Technical details _No response_ source-file",no-bug,0.8
27231,mastodon,https://github.com/mastodon/mastodon/issues/27231,Import following list never finished," Steps to reproduce the problem 1. Open https://mastodon.social/settings/imports 2. Select following list 3. Choose file of followers exported from previous instance 4. Select Merge 5. Upload  Expected behaviour Finished with downloadable list of failures  Actual behaviour In progress with no list of failures  Detailed description I migrated Mastodon instances yesterday and then imported my following list from the previous instance. After more than 24 hours, the import is still ""In progress"", with 202 / 204 imported, with 1 failure. So it appears to be stuck on 1 imported follower. Also, the Failures list is not clickable, because it's still in progress, unlike with finished imports. ![Screenshot 2023-10-01 at 10 39 35 AM](https://github.com/mastodon/mastodon/assets/56086/23f57008-7974-4ff9-b5f0-f3db18660db9)  Mastodon instance mastodon.social  Mastodon version v4.2.0+pr-27116-50e1f46  Browser name and version Safari 17  Operating system macOS 13.6  Technical details _No response_",source-file,"Import following list never finished  Steps to reproduce the problem 1. Open https://mastodon.social/settings/imports 2. Select following list 3. Choose file of followers exported from previous instance 4. Select Merge 5. Upload  Expected behaviour Finished with downloadable list of failures  Actual behaviour In progress with no list of failures  Detailed description I migrated Mastodon instances yesterday and then imported my following list from the previous instance. After more than 24 hours, the import is still ""In progress"", with 202 / 204 imported, with 1 failure. So it appears to be stuck on 1 imported follower. Also, the Failures list is not clickable, because it's still in progress, unlike with finished imports. ![Screenshot 2023-10-01 at 10 39 35 AM](https://github.com/mastodon/mastodon/assets/56086/23f57008-7974-4ff9-b5f0-f3db18660db9)  Mastodon instance mastodon.social  Mastodon version v4.2.0+pr-27116-50e1f46  Browser name and version Safari 17  Operating system macOS 13.6  Technical details _No response_ source-file",no-bug,0.8
33554,mastodon,https://github.com/mastodon/mastodon/issues/33554,"Attached images get squashed and the ""X"" and ""Edit"" buttons don't respond to clicks"," Steps to reproduce the problem 1. Start a new post in the web interface (with a reasonably wide browser window, so that the post editor is on the left column); 2. Attach four images; 3. Try to remove one of the images.  Expected behaviour I should be able to click the ""X"" button to remove an image.  Actual behaviour Both the ""X"" and the ""Edit"" buttons don't respond to clicks, only ""ALT"" does.  Detailed description This screenshot illustrates the problem: <img width=""363"" alt=""Image"" src=""https://github.com/user-attachments/assets/7ade3868-4f81-4f7f-bb29-231130480915"" />  Mastodon instance mastodon.social  Mastodon version v4.4.0-alpha.1+pr-33401-1ac8df0  Browser name and version Chrome 131.0.6778.265  Operating system macOS 15.2  Technical details The unresponsive buttons are laid out under the `<div class=""compose-form__upload__warning"">` element. If I set `pointer-events: none` on that, the ""X"" and ""Edit"" buttons work. However, the ""ALT"" button (which is part of the aforementioned element) stops working. In the past the images didn't get squashed so much vertically in the editor. Currently the `<div class=""compose-form__uploads media-gallery media-gallery--layout-3"">` has `min-height: 64px` and it should perhaps be `150px` instead, for the overlaid controls to remain properly separated.",other-file,"Attached images get squashed and the ""X"" and ""Edit"" buttons don't respond to clicks  Steps to reproduce the problem 1. Start a new post in the web interface (with a reasonably wide browser window, so that the post editor is on the left column); 2. Attach four images; 3. Try to remove one of the images.  Expected behaviour I should be able to click the ""X"" button to remove an image.  Actual behaviour Both the ""X"" and the ""Edit"" buttons don't respond to clicks, only ""ALT"" does.  Detailed description This screenshot illustrates the problem: <img width=""363"" alt=""Image"" src=""https://github.com/user-attachments/assets/7ade3868-4f81-4f7f-bb29-231130480915"" />  Mastodon instance mastodon.social  Mastodon version v4.4.0-alpha.1+pr-33401-1ac8df0  Browser name and version Chrome 131.0.6778.265  Operating system macOS 15.2  Technical details The unresponsive buttons are laid out under the `<div class=""compose-form__upload__warning"">` element. If I set `pointer-events: none` on that, the ""X"" and ""Edit"" buttons work. However, the ""ALT"" button (which is part of the aforementioned element) stops working. In the past the images didn't get squashed so much vertically in the editor. Currently the `<div class=""compose-form__uploads media-gallery media-gallery--layout-3"">` has `min-height: 64px` and it should perhaps be `150px` instead, for the overlaid controls to remain properly separated. other-file",no-bug,0.9
32213,mastodon,https://github.com/mastodon/mastodon/issues/32213,"[Advanced mode] Edited post UI with image, displays atop pre-existing search listing"," Steps to reproduce the problem I saw this today on v4.3.0-nightly.2024-10-01 on firefox 130.0.1 snap version on Ubuntu 24.04. Reproduces across many refreshes. I think this is a regression, I feel like I've done this series of steps before but not seen the problem. Below is a video (due to some sort of bug on my computer, the mouse cursor appears fixed in this video, although it is in fact moving). Steps in video: - Start from a new mastodon.social window. - Do a search (in this search from:mcc, so I get my own posts) - Select a post with an image. It will appear in the rightmost column. - Click  on the post in the rightmost column and choose ""Edit"". - The image from the edited post ONLY appears floating atop the search column. [Screencast from 2024-10-01 17-36-31.webm](https://github.com/user-attachments/assets/8f5eb1b4-ad24-46b7-b002-54939cbce228)  Expected behaviour Choosing ""edit"" should dismiss the search column. If choosing edit does not dismiss the search column, the edit pane appearing ""behind"" the search column and not reappearing until the search column is closed would also be entirely acceptable.  Actual behaviour Edit UI appears both behind and in front of the search column.  Detailed description In this video, uBlock Origin is ON and Stylus is OFF.  Mastodon instance -  Mastodon version -  Browser name and version -  Operating system -  Technical details -",other-file,"[Advanced mode] Edited post UI with image, displays atop pre-existing search listing  Steps to reproduce the problem I saw this today on v4.3.0-nightly.2024-10-01 on firefox 130.0.1 snap version on Ubuntu 24.04. Reproduces across many refreshes. I think this is a regression, I feel like I've done this series of steps before but not seen the problem. Below is a video (due to some sort of bug on my computer, the mouse cursor appears fixed in this video, although it is in fact moving). Steps in video: - Start from a new mastodon.social window. - Do a search (in this search from:mcc, so I get my own posts) - Select a post with an image. It will appear in the rightmost column. - Click  on the post in the rightmost column and choose ""Edit"". - The image from the edited post ONLY appears floating atop the search column. [Screencast from 2024-10-01 17-36-31.webm](https://github.com/user-attachments/assets/8f5eb1b4-ad24-46b7-b002-54939cbce228)  Expected behaviour Choosing ""edit"" should dismiss the search column. If choosing edit does not dismiss the search column, the edit pane appearing ""behind"" the search column and not reappearing until the search column is closed would also be entirely acceptable.  Actual behaviour Edit UI appears both behind and in front of the search column.  Detailed description In this video, uBlock Origin is ON and Stylus is OFF.  Mastodon instance -  Mastodon version -  Browser name and version -  Operating system -  Technical details - other-file",no-bug,0.9
30510,mastodon,https://github.com/mastodon/mastodon/issues/30510,Capture Doorkeeper Application used to create the Report via the API," Pitch Currently there's an issue relating to the data quality of reports, where some clients just aren't sending useful information via the API to moderators. To help rectify this situation, I'd like to collect from which client a report was made, much like we collect the application used to create a status via the API. This would mean a migration to add an `application_id` column to reports, which would be nullable, and modifying the controller / ReportService to pass through that context from the controller: `application: doorkeeper_token.application`  Motivation This will hopefully highlight which applications are producing low-quality reports, such that community pressure can build to drive better trust and safety practices in these applications.",source-file | source-file | source-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | config-file | source-file | source-file | source-file | source-file | source-file | source-file,"Capture Doorkeeper Application used to create the Report via the API  Pitch Currently there's an issue relating to the data quality of reports, where some clients just aren't sending useful information via the API to moderators. To help rectify this situation, I'd like to collect from which client a report was made, much like we collect the application used to create a status via the API. This would mean a migration to add an `application_id` column to reports, which would be nullable, and modifying the controller / ReportService to pass through that context from the controller: `application: doorkeeper_token.application`  Motivation This will hopefully highlight which applications are producing low-quality reports, such that community pressure can build to drive better trust and safety practices in these applications. source-file source-file source-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file config-file source-file source-file source-file source-file source-file source-file source-file source-file source-file other-file config-file source-file source-file source-file source-file source-file source-file",no-bug,0.9
34155,mastodon,https://github.com/mastodon/mastodon/issues/34155,User notes don't work," Steps to reproduce the problem 1. Go to another person profile 2. Enter the user note 3. Refresh page   Expected behaviour User note should be there  Actual behaviour User note is blank  Detailed description _No response_  Mastodon instance 101010.pl, mastodon.social  Mastodon version v4.4.0-alpha.3+aff5182  Browser name and version Microsoft Edge 134.0.3124.66  Operating system Windows 11 24H2  Technical details Don't see anything in server logs.",other-file | source-file | other-file,"User notes don't work  Steps to reproduce the problem 1. Go to another person profile 2. Enter the user note 3. Refresh page   Expected behaviour User note should be there  Actual behaviour User note is blank  Detailed description _No response_  Mastodon instance 101010.pl, mastodon.social  Mastodon version v4.4.0-alpha.3+aff5182  Browser name and version Microsoft Edge 134.0.3124.66  Operating system Windows 11 24H2  Technical details Don't see anything in server logs. other-file source-file other-file",no-bug,0.7
27643,mastodon,https://github.com/mastodon/mastodon/issues/27643,Regression in emoji picker: Selecting an emoji does not output the emoji to textarea," Steps to reproduce the problem 1. Pull latest main to 277e696 2. Rebuild and restart 3. See emoji not outputting to textarea after selecting an emoji   Expected behaviour Emoji code should appear to textarea  Actual behaviour Nothing happens  Detailed description I may have been too hasty since this was introduced [8 hours ago](https://github.com/mastodon/mastodon/commit/9c8891b39a2d04898880f4bd0754a52739ada30a#diff-b407b14e1a5570dfc879754f8669660ee64065027c51912f5061726fe1679b4f) sorry for that, if it should be this way and is acknowledged. Maybe @ClearlyClaire has a clue?  Mastodon instance mementomori.social  Mastodon version v4.3.0-alpha.0-2023-10-31  Browser name and version Google Chrome 118.0.5993.70 (Official Build) (64-bit)  Operating system Pop!_OS 22.04 LTS  Technical details DevTools Console:  Uncaught TypeError: Cannot read properties of undefined (reading 'selectionStart') at compose_form.jsx:219:40 at Object.onPickEmoji [as onPick] (emoji_picker_dropdown_container.js:80:7) at Object.onClick (emoji_picker_dropdown.jsx:236:16) at a.value (nimble-picker.js:315:18) at nimble-emoji.js:46:23 at onClick (nimble-emoji.js:220:16) at Object.Ae (react-dom.production.min.js:54:317) at ze (react-dom.production.min.js:54:471) at react-dom.production.min.js:55:35 at Rr (react-dom.production.min.js:105:68) ",other-file | other-file | other-file | other-file | other-file | other-file,"Regression in emoji picker: Selecting an emoji does not output the emoji to textarea  Steps to reproduce the problem 1. Pull latest main to 277e696 2. Rebuild and restart 3. See emoji not outputting to textarea after selecting an emoji   Expected behaviour Emoji code should appear to textarea  Actual behaviour Nothing happens  Detailed description I may have been too hasty since this was introduced [8 hours ago](https://github.com/mastodon/mastodon/commit/9c8891b39a2d04898880f4bd0754a52739ada30a#diff-b407b14e1a5570dfc879754f8669660ee64065027c51912f5061726fe1679b4f) sorry for that, if it should be this way and is acknowledged. Maybe @ClearlyClaire has a clue?  Mastodon instance mementomori.social  Mastodon version v4.3.0-alpha.0-2023-10-31  Browser name and version Google Chrome 118.0.5993.70 (Official Build) (64-bit)  Operating system Pop!_OS 22.04 LTS  Technical details DevTools Console:  Uncaught TypeError: Cannot read properties of undefined (reading 'selectionStart') at compose_form.jsx:219:40 at Object.onPickEmoji [as onPick] (emoji_picker_dropdown_container.js:80:7) at Object.onClick (emoji_picker_dropdown.jsx:236:16) at a.value (nimble-picker.js:315:18) at nimble-emoji.js:46:23 at onClick (nimble-emoji.js:220:16) at Object.Ae (react-dom.production.min.js:54:317) at ze (react-dom.production.min.js:54:471) at react-dom.production.min.js:55:35 at Rr (react-dom.production.min.js:105:68)  other-file other-file other-file other-file other-file other-file",no-bug,0.9
