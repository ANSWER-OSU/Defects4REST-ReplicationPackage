issue_no,repo,issue_url,title,description,patched_file_types,text_for_topic_modeling,prediction,confidence,combined_text
6498,awx,https://github.com/ansible/awx/issues/6498,504 timeouts when fetching job_events for a running job,"##### ISSUE TYPE - Bug Report ##### SUMMARY Having issues with 504 timeouts on `job_events` APIs for a given host when a job is running, e.g. `api/v2/hosts/1/job_events/`. Maybe due to deadlocks? **EDIT**: We redeployed `awx_web` to see if we could make the APIs work again, still 504 timeout on every `api/v2/hosts/1/job_events/` request. Something is very wrong here. ##### ENVIRONMENT * AWX version: 9.3.0 * AWX install method: openshift manual deployment * Ansible version: 2.9.5 * Operating System: Official AWX images * Web Browser: Firefox, postman, Python's `request.get()` (from both a Linux and Mac client) ##### STEPS TO REPRODUCE 1. Start a task that takes long time to finish (Our task is a task that writes hundreds of commands on a device and takes about 8 minutes to finish) 2. Fetch job events API while task is running 3. 504 timeouts on that API even after the job is done for a loong time. (It did start responding again earlier, but now I've waited 10 minutes and still no response from the API). It's important to note that when this occurs we get sporadic 504's on other endpoints too, but I believe this may happen due to sync workers and not enough of them. ##### EXPECTED RESULTS Being able to fetch `job_events` when a task is running. ##### ACTUAL RESULTS Timeout on `job_events`. ##### ADDITIONAL INFORMATION We found #6108 and disabled external logging to Logstash, but don't seem like the issue was solved. The timeout is happening due to OpenShift cutting the connection (499), but the request should never take more than 30 seconds anyway: ![image](https://user-images.githubusercontent.com/5310116/78008928-926dec00-7340-11ea-82e8-877aedbe2b17.png)",source-file,timeouts fetching job events running job type bug report summary issues timeouts job events apis given host job running api hosts job events maybe due deadlocks edit redeployed web see could make apis work still timeout every api hosts job events something wrong environment install method openshift manual deployment ansible operating system official images web browser firefox postman python get linux mac client steps reproduce start task takes long time finish task task writes hundreds commands device takes minutes finish fetch job events api task running timeouts api even job done loong time start responding earlier waited minutes still response api important note occurs get sporadic endpoints believe may happen due sync workers enough expected results able fetch job events task running actual results timeout job events additional information found disabled external logging logstash seem like solved timeout happening due openshift cutting connection never take seconds anyway image https user images githubusercontent dec aedbe png,bug,0.9,"504 timeouts when fetching job_events for a running job ##### ISSUE TYPE - Bug Report ##### SUMMARY Having issues with 504 timeouts on `job_events` APIs for a given host when a job is running, e.g. `api/v2/hosts/1/job_events/`. Maybe due to deadlocks? **EDIT**: We redeployed `awx_web` to see if we could make the APIs work again, still 504 timeout on every `api/v2/hosts/1/job_events/` request. Something is very wrong here. ##### ENVIRONMENT * AWX version: 9.3.0 * AWX install method: openshift manual deployment * Ansible version: 2.9.5 * Operating System: Official AWX images * Web Browser: Firefox, postman, Python's `request.get()` (from both a Linux and Mac client) ##### STEPS TO REPRODUCE 1. Start a task that takes long time to finish (Our task is a task that writes hundreds of commands on a device and takes about 8 minutes to finish) 2. Fetch job events API while task is running 3. 504 timeouts on that API even after the job is done for a loong time. (It did start responding again earlier, but now I've waited 10 minutes and still no response from the API). It's important to note that when this occurs we get sporadic 504's on other endpoints too, but I believe this may happen due to sync workers and not enough of them. ##### EXPECTED RESULTS Being able to fetch `job_events` when a task is running. ##### ACTUAL RESULTS Timeout on `job_events`. ##### ADDITIONAL INFORMATION We found #6108 and disabled external logging to Logstash, but don't seem like the issue was solved. The timeout is happening due to OpenShift cutting the connection (499), but the request should never take more than 30 seconds anyway: ![image](https://user-images.githubusercontent.com/5310116/78008928-926dec00-7340-11ea-82e8-877aedbe2b17.png)"
8641,awx,https://github.com/ansible/awx/issues/8641,Cannot disable a schedule for a JT with a missing project (and it keeps running),"##### ISSUE TYPE - Bug Report ##### SUMMARY It's fairly easy to get into a state where a schedule is enabled with an invalid JT, and the schedule cannot be turned off, due to a validation error on the JT. Even though the schedule is invalid, it keeps running on the schedule interval, and its jobs fail obviously. ##### ENVIRONMENT * AWX version: 15.0.1 ##### STEPS TO REPRODUCE Create a JT Create a 1-minute schedule for that JT Delete the project used by the JT (or its inventory) Try to disable the schedule in the UI ##### EXPECTED RESULTS Schedule turns off ##### ACTUAL RESULTS 400 response ```json {""resources_needed_to_start"":[""Job Template project is missing or undefined."",""Job Template inventory is missing or undefined.""]} ``` This is what you get hitting the disable button in the UI, which performs a PATCH to the schedule, setting the ""enabled"" field to False, and it includes the rest of the data. The issue is on the API here, because the request made by the UI seems reasonable, and should be expected to succeed. Perhaps the API should only error on this type of validation if the schedule is being _enabled_. ##### ADDITIONAL INFORMATION Similar to https://github.com/ansible/awx/issues/7521 by @chrismeyersfsu, seen in test runs, and creates background processing since the 1-minute schedule continues to run for the duration that the server is up.",source-file | source-file | source-file | source-file | source-file | source-file,cannot disable schedule missing project keeps running type bug report summary fairly easy get state schedule enabled invalid schedule cannot turned due validation even though schedule invalid keeps running schedule interval jobs fail obviously environment steps reproduce create create minute schedule delete project used inventory disable schedule expected results schedule turns actual results response json resources needed start job template project missing undefined job template inventory missing undefined get hitting disable button performs schedule setting enabled field false includes rest data api made seems reasonable expected succeed perhaps api type validation schedule enabled additional information similar https github ansible issues chrismeyersfsu seen runs creates background processing since minute schedule continues duration server,bug,0.95,"Cannot disable a schedule for a JT with a missing project (and it keeps running) ##### ISSUE TYPE - Bug Report ##### SUMMARY It's fairly easy to get into a state where a schedule is enabled with an invalid JT, and the schedule cannot be turned off, due to a validation error on the JT. Even though the schedule is invalid, it keeps running on the schedule interval, and its jobs fail obviously. ##### ENVIRONMENT * AWX version: 15.0.1 ##### STEPS TO REPRODUCE Create a JT Create a 1-minute schedule for that JT Delete the project used by the JT (or its inventory) Try to disable the schedule in the UI ##### EXPECTED RESULTS Schedule turns off ##### ACTUAL RESULTS 400 response ```json {""resources_needed_to_start"":[""Job Template project is missing or undefined."",""Job Template inventory is missing or undefined.""]} ``` This is what you get hitting the disable button in the UI, which performs a PATCH to the schedule, setting the ""enabled"" field to False, and it includes the rest of the data. The issue is on the API here, because the request made by the UI seems reasonable, and should be expected to succeed. Perhaps the API should only error on this type of validation if the schedule is being _enabled_. ##### ADDITIONAL INFORMATION Similar to https://github.com/ansible/awx/issues/7521 by @chrismeyersfsu, seen in test runs, and creates background processing since the 1-minute schedule continues to run for the duration that the server is up."
5882,awx,https://github.com/ansible/awx/issues/5882,API Provides credential_type for WFJTs,"##### ISSUE TYPE Bug maybe? ##### SUMMARY Missing information in the WFJT end point re: webhook credentials. JobTemplates end point provides credential type and kind information, but WFJT end point does not provide that info for webhook credentials. It would be nice to have. ##### ENVIRONMENT * AWX version: 9.1.1 * AWX install method: docker for mac * Ansible version: 2.10 * Operating System: Mojave * Web Browser: Chrome ##### STEPS TO REPRODUCE Generate a workflow JT with a webhook credential. Go to api gui for that WFJT ##### EXPECTED RESULTS Credential type and credential kind info would be provided. ##### ACTUAL RESULTS Credential type and credential kind are not provided at that end point when all the other info for the template is provided.",source-file,api provides credential type wfjts type bug maybe summary missing information wfjt end point webhook credentials jobtemplates end point provides credential type kind information wfjt end point provide webhook credentials would nice environment install method docker mac ansible operating system mojave web browser chrome steps reproduce generate workflow webhook credential api gui wfjt expected results credential type credential kind would provided actual results credential type credential kind provided end point template provided,bug,0.85,"API Provides credential_type for WFJTs ##### ISSUE TYPE Bug maybe? ##### SUMMARY Missing information in the WFJT end point re: webhook credentials. JobTemplates end point provides credential type and kind information, but WFJT end point does not provide that info for webhook credentials. It would be nice to have. ##### ENVIRONMENT * AWX version: 9.1.1 * AWX install method: docker for mac * Ansible version: 2.10 * Operating System: Mojave * Web Browser: Chrome ##### STEPS TO REPRODUCE Generate a workflow JT with a webhook credential. Go to api gui for that WFJT ##### EXPECTED RESULTS Credential type and credential kind info would be provided. ##### ACTUAL RESULTS Credential type and credential kind are not provided at that end point when all the other info for the template is provided."
6049,awx,https://github.com/ansible/awx/issues/6049,Inventory Group Nested Hosts View errors with a 404,"##### ISSUE TYPE - Bug Report ##### SUMMARY I searched for implemented issues and couldn't find anything. /inventories/inventory/*num*/groups/*num*/nested_hosts isn't loading in ui_next ##### ENVIRONMENT * AWX version: 9.next ##### STEPS TO REPRODUCE 1. Create an Inventory Group with nested hosts 2. View the #/inventories/inventory/*num*/groups/*num*/nested_hosts page ##### EXPECTED RESULTS Nested Hosts to be displayed ##### ACTUAL RESULTS 404 messaging page ##### ADDITIONAL INFORMATION <img width=""1159"" alt=""Screen Shot 2020-02-25 at 9 10 38 AM"" src=""https://user-images.githubusercontent.com/12446869/75254948-29c6a900-57af-11ea-92c0-7d35dee281c6.png"">",source-file,inventory group nested hosts view errors type bug report summary searched implemented issues find anything inventories inventory num groups num nested hosts loading next environment next steps reproduce create inventory group nested hosts view inventories inventory num groups num nested hosts page expected results nested hosts displayed actual results messaging page additional information img width alt screen shot https user images githubusercontent dee png,bug,0.9,"Inventory Group Nested Hosts View errors with a 404 ##### ISSUE TYPE - Bug Report ##### SUMMARY I searched for implemented issues and couldn't find anything. /inventories/inventory/*num*/groups/*num*/nested_hosts isn't loading in ui_next ##### ENVIRONMENT * AWX version: 9.next ##### STEPS TO REPRODUCE 1. Create an Inventory Group with nested hosts 2. View the #/inventories/inventory/*num*/groups/*num*/nested_hosts page ##### EXPECTED RESULTS Nested Hosts to be displayed ##### ACTUAL RESULTS 404 messaging page ##### ADDITIONAL INFORMATION <img width=""1159"" alt=""Screen Shot 2020-02-25 at 9 10 38 AM"" src=""https://user-images.githubusercontent.com/12446869/75254948-29c6a900-57af-11ea-92c0-7d35dee281c6.png"">"
4541,awx,https://github.com/ansible/awx/issues/4541,Notifications - missing hosts with webhook notification,"##### ISSUE TYPE - Bug Report ##### SUMMARY We have around 400 hosts in the inventory, however, the notification webhook endpoint receives notification about only around 40-50 hosts. (Sometimes it's working fine reporting all the hosts.) ##### ENVIRONMENT * AWX version: 6.1.0.0 (Same problem with 6.0.0.0) * AWX install method: docker on linux (official image from docker hub) * Ansible version: 2.8.2 * Operating System: Centos7 * Web Browser: Chrome ##### STEPS TO REPRODUCE - Create a webhook notification - Start a job (or job-flow), enable notifications. ##### EXPECTED RESULTS Report from all the hosts in JSON format ##### ACTUAL RESULTS Most of the times only partial host list in the report, sometimes full list. Differs in a job-flow, some jobs reporting about all hosts, some only about a few) Workflow with 2 jobs: Number of hosts, on which the job ran (reported in AWX): 438 Number of hosts reported on the webhook script: 53 ##### ADDITIONAL INFORMATION I also have the same problem with 6.0.0.0 and 6.1.0.0 I tried with different users, with standalon jobs or woth flows, also with different playbooks, the problem looks pretty consistent. Thx",source-file,notifications missing hosts webhook notification type bug report summary around hosts inventory however notification webhook endpoint receives notification around hosts sometimes working fine reporting hosts environment install method docker linux official image docker hub ansible operating system centos web browser chrome steps reproduce create webhook notification start job job flow enable notifications expected results report hosts json format actual results times partial host list report sometimes full list differs job flow jobs reporting hosts workflow jobs number hosts job ran reported number hosts reported webhook script additional information also tried different users standalon jobs woth flows also different playbooks looks pretty consistent thx,bug,0.9,"Notifications - missing hosts with webhook notification ##### ISSUE TYPE - Bug Report ##### SUMMARY We have around 400 hosts in the inventory, however, the notification webhook endpoint receives notification about only around 40-50 hosts. (Sometimes it's working fine reporting all the hosts.) ##### ENVIRONMENT * AWX version: 6.1.0.0 (Same problem with 6.0.0.0) * AWX install method: docker on linux (official image from docker hub) * Ansible version: 2.8.2 * Operating System: Centos7 * Web Browser: Chrome ##### STEPS TO REPRODUCE - Create a webhook notification - Start a job (or job-flow), enable notifications. ##### EXPECTED RESULTS Report from all the hosts in JSON format ##### ACTUAL RESULTS Most of the times only partial host list in the report, sometimes full list. Differs in a job-flow, some jobs reporting about all hosts, some only about a few) Workflow with 2 jobs: Number of hosts, on which the job ran (reported in AWX): 438 Number of hosts reported on the webhook script: 53 ##### ADDITIONAL INFORMATION I also have the same problem with 6.0.0.0 and 6.1.0.0 I tried with different users, with standalon jobs or woth flows, also with different playbooks, the problem looks pretty consistent. Thx"
12046,awx,https://github.com/ansible/awx/issues/12046,Disable isCreatable for Select component on Advanced Search,"##### SUMMARY Disable isCreatable for Select component on Advanced Search. This prop leads to invalid API searches. <img width=""1496"" alt=""image"" src=""https://user-images.githubusercontent.com/9053044/163234927-b4b0c433-435e-4a28-923a-26eafa17f8ef.png""> <img width=""1498"" alt=""image"" src=""https://user-images.githubusercontent.com/9053044/163234857-a07d7a9a-1da5-41f9-8ae5-e23213f877ca.png"">",source-file,disable iscreatable select component advanced search summary disable iscreatable select component advanced search prop leads invalid api searches img width alt image https user images githubusercontent eafa png img width alt image https user images githubusercontent png,bug,0.8,"Disable isCreatable for Select component on Advanced Search ##### SUMMARY Disable isCreatable for Select component on Advanced Search. This prop leads to invalid API searches. <img width=""1496"" alt=""image"" src=""https://user-images.githubusercontent.com/9053044/163234927-b4b0c433-435e-4a28-923a-26eafa17f8ef.png""> <img width=""1498"" alt=""image"" src=""https://user-images.githubusercontent.com/9053044/163234857-a07d7a9a-1da5-41f9-8ae5-e23213f877ca.png"">"
13439,awx,https://github.com/ansible/awx/issues/13439,CyberArk Conjur lookup plugin does not work with open source Conjur version,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary The CyberArk Conjur Secrets Manager Lookup plugin no longer supports the lookup against the Conjur OSS. Most likely because the opensource conjure version API endpoint does not have the `/api/` portion recently added by this change: https://github.com/ansible/awx/pull/13121 ### AWX version 2.4 ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce 1. Deploy Conjur OSS. We use the latest `cyberark/conjur` image for that. The Conjur version is ``` Version 1.19.1-3398 API Version 5.3.0 ``` 2. Under the AWX, create the CyberArk Conjur Secrets Manager Lookup credential. Provide Conjure URL, user, and token. 3. Click Test and provide a path. ### Expected results Connection to Conjur should be established. HTTP 200 response. ### Actual results 401 error returned. ``` Traceback (most recent call last): File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/tasks/jobs.py"", line 504, in run args = self.build_args(self.instance, private_data_dir, passwords) File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/tasks/jobs.py"", line 937, in build_args ssh_username = creds.get_input('username', default='') File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/models/credential/__init__.py"", line 275, in get_input return self._get_dynamic_input(field_name) File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/models/credential/__init__.py"", line 309, in _get_dynamic_input return input_source.get_input_value() File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/models/credential/__init__.py"", line 1250, in get_input_value return backend(**backend_kwargs) File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/credential_plugins/conjur.py"", line 72, in conjur_backend raise_for_status(resp) File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/credential_plugins/plugin.py"", line 12, in raise_for_status resp.raise_for_status() File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/requests/models.py"", line 1021, in raise_for_status raise HTTPError(http_error_msg, response=self) requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://conjureurl.com/api/authn/test/admin/authenticate ``` ### Additional information _No response_",source-file,cyberark conjur lookup plugin work open conjur please confirm following agree follow project conduct https docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free might receive timely response bug summary cyberark conjur secrets manager lookup plugin longer supports lookup conjur oss likely opensource conjure api endpoint api portion recently added https github ansible select relevant components api docs collection cli installation method docker development environment modifications ansible response operating system response web browser response steps reproduce deploy conjur oss use latest cyberark conjur image conjur api create cyberark conjur secrets manager lookup credential provide conjure url user token click provide path expected results connection conjur established http response actual results returned traceback recent call last var venv python site packages tasks jobs args self args self instance private data dir passwords var venv python site packages tasks jobs args ssh username creds get input username default var venv python site packages models credential init get input return self get dynamic input field name var venv python site packages models credential init get dynamic input return input get input value var venv python site packages models credential init get input value return backend backend kwargs var venv python site packages credential plugins conjur conjur backend raise status resp var venv python site packages credential plugins plugin raise status resp raise status var venv python site packages requests models raise status raise httperror http msg response self requests exceptions httperror client unauthorized url https conjureurl api authn admin authenticate additional information response,bug,0.9,"CyberArk Conjur lookup plugin does not work with open source Conjur version ### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary The CyberArk Conjur Secrets Manager Lookup plugin no longer supports the lookup against the Conjur OSS. Most likely because the opensource conjure version API endpoint does not have the `/api/` portion recently added by this change: https://github.com/ansible/awx/pull/13121 ### AWX version 2.4 ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce 1. Deploy Conjur OSS. We use the latest `cyberark/conjur` image for that. The Conjur version is ``` Version 1.19.1-3398 API Version 5.3.0 ``` 2. Under the AWX, create the CyberArk Conjur Secrets Manager Lookup credential. Provide Conjure URL, user, and token. 3. Click Test and provide a path. ### Expected results Connection to Conjur should be established. HTTP 200 response. ### Actual results 401 error returned. ``` Traceback (most recent call last): File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/tasks/jobs.py"", line 504, in run args = self.build_args(self.instance, private_data_dir, passwords) File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/tasks/jobs.py"", line 937, in build_args ssh_username = creds.get_input('username', default='') File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/models/credential/__init__.py"", line 275, in get_input return self._get_dynamic_input(field_name) File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/models/credential/__init__.py"", line 309, in _get_dynamic_input return input_source.get_input_value() File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/models/credential/__init__.py"", line 1250, in get_input_value return backend(**backend_kwargs) File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/credential_plugins/conjur.py"", line 72, in conjur_backend raise_for_status(resp) File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/awx/main/credential_plugins/plugin.py"", line 12, in raise_for_status resp.raise_for_status() File ""/var/lib/awx/venv/awx/lib64/python3.9/site-packages/requests/models.py"", line 1021, in raise_for_status raise HTTPError(http_error_msg, response=self) requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://conjureurl.com/api/authn/test/admin/authenticate ``` ### Additional information _No response_"
8777,awx,https://github.com/ansible/awx/issues/8777,awx collection workflow approval with success node fail,"##### ISSUE TYPE - Bug Report ##### SUMMARY apply success node to approval_node fail because success_nodes not exists in /api/v2/workflow_approval_templates/ ""msg"": ""The requested object could not be found at /api/v2/workflow_approval_templates/280/success_nodes/."" ##### ENVIRONMENT * AWX version: 15.0.1 * AWX install method: docker * Ansible version: 2.8.7 * Operating System: redhat * Web Browser: chrome ##### STEPS TO REPRODUCE approval_node with success_node ##### EXPECTED RESULTS ansible tasks changed ##### ACTUAL RESULTS ansible fail ##### ADDITIONAL INFORMATION",source-file | source-file | source-file | source-file | source-file | source-file | source-file,collection workflow approval success node fail type bug report summary apply success node approval node fail success nodes exists api workflow approval templates msg requested object could found api workflow approval templates success nodes environment install method docker ansible operating system redhat web browser chrome steps reproduce approval node success node expected results ansible tasks changed actual results ansible fail additional information,bug,0.9,"awx collection workflow approval with success node fail ##### ISSUE TYPE - Bug Report ##### SUMMARY apply success node to approval_node fail because success_nodes not exists in /api/v2/workflow_approval_templates/ ""msg"": ""The requested object could not be found at /api/v2/workflow_approval_templates/280/success_nodes/."" ##### ENVIRONMENT * AWX version: 15.0.1 * AWX install method: docker * Ansible version: 2.8.7 * Operating System: redhat * Web Browser: chrome ##### STEPS TO REPRODUCE approval_node with success_node ##### EXPECTED RESULTS ansible tasks changed ##### ACTUAL RESULTS ansible fail ##### ADDITIONAL INFORMATION"
5717,awx,https://github.com/ansible/awx/issues/5717,awx cli schedules create cannot create schedule if the user is of type Normal User with required permissions.,"##### ISSUE TYPE - Bug Report ##### SUMMARY awx cli schedules create cannot create schedule if the user is of type Normal User with required permissions on the object or even with Organization admin role. Currently the user needs to be a System Administrator type to create the schedule. From the UI the Normal User with permission can create the schedule. POST at the /api/v2/schedules/ endpoint is only available for the user with System Administrator type which is the endpoint used by awx schedules create command. ##### ENVIRONMENT * AWX version: Tower 3.6.2 * AWX install method: Tower 3.6.2 cluster installed with online installer * Ansible version: 2.9.1 * Operating System: RHEL 8 * Web Browser: Chrome 79 ##### STEPS TO REPRODUCE * Create a normal user: * Assign permission to a job template or set the user role as Organization admin. * Try to create the schedule for the job template using awx cli. ``` awx --conf.host https://tower.ishwar.io --conf.username test --conf.password 'PASSWORD' schedules create --name=test --unified_job_template=111 --rrule=""DTSTART;TZID=America/New_York:20180208T221500 RRULE:FREQ=MONTHLY;INTERVAL=1;BYDAY=TH;BYSETPOS=3"" -vvv ``` * Change the user type to system administrator and rerun the command. ##### EXPECTED RESULTS ``` DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): tower.ishwar.io:443 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.208793 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.api.ApiV2'> by url: /api/v2/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/v2/ HTTP/1.1"" 200 1688 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/v2/"" elapsed: 0:00:00.047443 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.052170 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""POST /api/login/ HTTP/1.1"" 302 0 DEBUG:awxkit.api.client:""POST https://tower.ishwar.io/api/login/"" elapsed: 0:00:00.247407 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.080558 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.084587 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""OPTIONS /api/v2/schedules/ HTTP/1.1"" 200 13449 DEBUG:awxkit.api.client:""OPTIONS https://tower.ishwar.io/api/v2/schedules/"" elapsed: 0:00:00.101736 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""OPTIONS /api/v2/schedules/1/ HTTP/1.1"" 200 7915 DEBUG:awxkit.api.client:""OPTIONS https://tower.ishwar.io/api/v2/schedules/1/"" elapsed: 0:00:00.120726 awx: unrecognized arguments: -vvv DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""POST /api/v2/schedules/ HTTP/1.1"" 201 1552 DEBUG:awxkit.api.client:""POST https://tower.ishwar.io/api/v2/schedules/"" elapsed: 0:00:00.156802 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ { ""rrule"": ""DTSTART;TZID=America/New_York:20180208T221500 RRULE:FREQ=MONTHLY;INTERVAL=1;BYDAY=TH;BYSETPOS=3"", ""id"": 14, ""type"": ""schedule"", ""url"": ""/api/v2/schedules/14/"", ""summary_fields"": { ""unified_job_template"": { ""id"": 111, ""name"": ""test-schedule"", ""description"": """", ""unified_job_type"": ""job"" }, ""created_by"": { ""id"": 121, ""username"": ""test"", ""first_name"": ""test"", ""last_name"": ""test"" }, ""modified_by"": { ""id"": 121, ""username"": ""test"", ""first_name"": ""test"", ""last_name"": ""test"" }, ""user_capabilities"": { ""edit"": true, ""delete"": true }, ""inventory"": { ""id"": 29, ""name"": ""Demo Inventory"", ""description"": """", ""has_active_failures"": false, ""total_hosts"": 1, ""hosts_with_active_failures"": 0, ""total_groups"": 0, ""groups_with_active_failures"": 0, ""has_inventory_sources"": false, ""total_inventory_sources"": 0, ""inventory_sources_with_failures"": 0, ""organization_id"": 1, ""kind"": """", ""insights_credential_id"": null } }, ""created"": ""2020-01-21T07:31:19.312383Z"", ""modified"": ""2020-01-21T07:31:19.312398Z"", ""name"": ""test"", ""description"": """", ""extra_data"": {}, ""inventory"": null, ""scm_branch"": null, ""job_type"": null, ""job_tags"": null, ""skip_tags"": null, ""limit"": null, ""diff_mode"": null, ""verbosity"": null, ""unified_job_template"": 111, ""enabled"": true, ""dtstart"": ""2018-02-16T03:15:00Z"", ""dtend"": null, ""next_run"": ""2020-02-21T03:15:00Z"", ""timezone"": ""America/New_York"", ""until"": """" } ``` ##### ACTUAL RESULTS ``` DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): tower.ishwar.io:443 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.173558 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.api.ApiV2'> by url: /api/v2/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/v2/ HTTP/1.1"" 200 1688 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/v2/"" elapsed: 0:00:00.046141 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.050566 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""POST /api/login/ HTTP/1.1"" 302 0 DEBUG:awxkit.api.client:""POST https://tower.ishwar.io/api/login/"" elapsed: 0:00:00.247518 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.088723 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.081436 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""OPTIONS /api/v2/schedules/ HTTP/1.1"" 200 11598 DEBUG:awxkit.api.client:""OPTIONS https://tower.ishwar.io/api/v2/schedules/"" elapsed: 0:00:00.088985 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""OPTIONS /api/v2/schedules/1/ HTTP/1.1"" 200 6065 DEBUG:awxkit.api.client:""OPTIONS https://tower.ishwar.io/api/v2/schedules/1/"" elapsed: 0:00:00.112443 usage: awx schedules [-h] action ... positional arguments: action list get modify delete optional arguments: -h, --help show this help message and exit awx schedules: argument action: invalid choice: 'create' (choose from 'list', 'get', 'modify', 'delete') ```",source-file | test-file,cli schedules create cannot create schedule user type normal user required permissions type bug report summary cli schedules create cannot create schedule user type normal user required permissions object even organization admin role currently user needs system administrator type create schedule normal user permission create schedule post api schedules endpoint available user system administrator type endpoint used schedules create command environment tower install method tower cluster installed online installer ansible operating system rhel web browser chrome steps reproduce create normal user assign permission job template set user role organization admin create schedule job template cli conf host https tower ishwar conf username conf password password schedules create name unified job template rrule dtstart tzid america new york rrule freq monthly interval byday bysetpos vvv user type system administrator rerun command expected results urllib connectionpool starting new https connection tower ishwar urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed awxkit api registry retrieved class awxkit api pages api apiv url api urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed urllib connectionpool https tower ishwar post api login http awxkit api client post https tower ishwar api login elapsed urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed awxkit api registry retrieved class awxkit api pages schedules schedules url api schedules urllib connectionpool https tower ishwar options api schedules http awxkit api client options https tower ishwar api schedules elapsed awxkit api registry retrieved class awxkit api pages schedules schedules url api schedules urllib connectionpool https tower ishwar options api schedules http awxkit api client options https tower ishwar api schedules elapsed unrecognized arguments vvv awxkit api registry retrieved class awxkit api pages schedules schedules url api schedules urllib connectionpool https tower ishwar post api schedules http awxkit api client post https tower ishwar api schedules elapsed awxkit api registry retrieved class awxkit api pages schedules schedules url api schedules rrule dtstart tzid america new york rrule freq monthly interval byday bysetpos type schedule url api schedules summary fields unified job template name schedule description unified job type job created username first name last name modified username first name last name user capabilities edit true delete true inventory name demo inventory description active failures false total hosts hosts active failures total groups groups active failures inventory sources false total inventory sources inventory sources failures organization kind insights credential null created modified name description extra data inventory null scm branch null job type null job tags null skip tags null limit null diff mode null verbosity null unified job template enabled true dtstart dtend null next timezone america new york actual results urllib connectionpool starting new https connection tower ishwar urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed awxkit api registry retrieved class awxkit api pages api apiv url api urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed urllib connectionpool https tower ishwar post api login http awxkit api client post https tower ishwar api login elapsed urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed urllib connectionpool https tower ishwar get api http awxkit api client get https tower ishwar api elapsed awxkit api registry retrieved class awxkit api pages schedules schedules url api schedules urllib connectionpool https tower ishwar options api schedules http awxkit api client options https tower ishwar api schedules elapsed awxkit api registry retrieved class awxkit api pages schedules schedules url api schedules urllib connectionpool https tower ishwar options api schedules http awxkit api client options https tower ishwar api schedules elapsed usage schedules action positional arguments action list get modify delete optional arguments help show help message exit schedules argument action invalid choice create choose list get modify delete,bug,0.9,"awx cli schedules create cannot create schedule if the user is of type Normal User with required permissions. ##### ISSUE TYPE - Bug Report ##### SUMMARY awx cli schedules create cannot create schedule if the user is of type Normal User with required permissions on the object or even with Organization admin role. Currently the user needs to be a System Administrator type to create the schedule. From the UI the Normal User with permission can create the schedule. POST at the /api/v2/schedules/ endpoint is only available for the user with System Administrator type which is the endpoint used by awx schedules create command. ##### ENVIRONMENT * AWX version: Tower 3.6.2 * AWX install method: Tower 3.6.2 cluster installed with online installer * Ansible version: 2.9.1 * Operating System: RHEL 8 * Web Browser: Chrome 79 ##### STEPS TO REPRODUCE * Create a normal user: * Assign permission to a job template or set the user role as Organization admin. * Try to create the schedule for the job template using awx cli. ``` awx --conf.host https://tower.ishwar.io --conf.username test --conf.password 'PASSWORD' schedules create --name=test --unified_job_template=111 --rrule=""DTSTART;TZID=America/New_York:20180208T221500 RRULE:FREQ=MONTHLY;INTERVAL=1;BYDAY=TH;BYSETPOS=3"" -vvv ``` * Change the user type to system administrator and rerun the command. ##### EXPECTED RESULTS ``` DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): tower.ishwar.io:443 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.208793 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.api.ApiV2'> by url: /api/v2/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/v2/ HTTP/1.1"" 200 1688 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/v2/"" elapsed: 0:00:00.047443 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.052170 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""POST /api/login/ HTTP/1.1"" 302 0 DEBUG:awxkit.api.client:""POST https://tower.ishwar.io/api/login/"" elapsed: 0:00:00.247407 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.080558 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.084587 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""OPTIONS /api/v2/schedules/ HTTP/1.1"" 200 13449 DEBUG:awxkit.api.client:""OPTIONS https://tower.ishwar.io/api/v2/schedules/"" elapsed: 0:00:00.101736 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""OPTIONS /api/v2/schedules/1/ HTTP/1.1"" 200 7915 DEBUG:awxkit.api.client:""OPTIONS https://tower.ishwar.io/api/v2/schedules/1/"" elapsed: 0:00:00.120726 awx: unrecognized arguments: -vvv DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""POST /api/v2/schedules/ HTTP/1.1"" 201 1552 DEBUG:awxkit.api.client:""POST https://tower.ishwar.io/api/v2/schedules/"" elapsed: 0:00:00.156802 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ { ""rrule"": ""DTSTART;TZID=America/New_York:20180208T221500 RRULE:FREQ=MONTHLY;INTERVAL=1;BYDAY=TH;BYSETPOS=3"", ""id"": 14, ""type"": ""schedule"", ""url"": ""/api/v2/schedules/14/"", ""summary_fields"": { ""unified_job_template"": { ""id"": 111, ""name"": ""test-schedule"", ""description"": """", ""unified_job_type"": ""job"" }, ""created_by"": { ""id"": 121, ""username"": ""test"", ""first_name"": ""test"", ""last_name"": ""test"" }, ""modified_by"": { ""id"": 121, ""username"": ""test"", ""first_name"": ""test"", ""last_name"": ""test"" }, ""user_capabilities"": { ""edit"": true, ""delete"": true }, ""inventory"": { ""id"": 29, ""name"": ""Demo Inventory"", ""description"": """", ""has_active_failures"": false, ""total_hosts"": 1, ""hosts_with_active_failures"": 0, ""total_groups"": 0, ""groups_with_active_failures"": 0, ""has_inventory_sources"": false, ""total_inventory_sources"": 0, ""inventory_sources_with_failures"": 0, ""organization_id"": 1, ""kind"": """", ""insights_credential_id"": null } }, ""created"": ""2020-01-21T07:31:19.312383Z"", ""modified"": ""2020-01-21T07:31:19.312398Z"", ""name"": ""test"", ""description"": """", ""extra_data"": {}, ""inventory"": null, ""scm_branch"": null, ""job_type"": null, ""job_tags"": null, ""skip_tags"": null, ""limit"": null, ""diff_mode"": null, ""verbosity"": null, ""unified_job_template"": 111, ""enabled"": true, ""dtstart"": ""2018-02-16T03:15:00Z"", ""dtend"": null, ""next_run"": ""2020-02-21T03:15:00Z"", ""timezone"": ""America/New_York"", ""until"": """" } ``` ##### ACTUAL RESULTS ``` DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): tower.ishwar.io:443 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.173558 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.api.ApiV2'> by url: /api/v2/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/v2/ HTTP/1.1"" 200 1688 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/v2/"" elapsed: 0:00:00.046141 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.050566 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""POST /api/login/ HTTP/1.1"" 302 0 DEBUG:awxkit.api.client:""POST https://tower.ishwar.io/api/login/"" elapsed: 0:00:00.247518 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.088723 DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""GET /api/ HTTP/1.1"" 200 188 DEBUG:awxkit.api.client:""GET https://tower.ishwar.io/api/"" elapsed: 0:00:00.081436 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""OPTIONS /api/v2/schedules/ HTTP/1.1"" 200 11598 DEBUG:awxkit.api.client:""OPTIONS https://tower.ishwar.io/api/v2/schedules/"" elapsed: 0:00:00.088985 DEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/ DEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 ""OPTIONS /api/v2/schedules/1/ HTTP/1.1"" 200 6065 DEBUG:awxkit.api.client:""OPTIONS https://tower.ishwar.io/api/v2/schedules/1/"" elapsed: 0:00:00.112443 usage: awx schedules [-h] action ... positional arguments: action list get modify delete optional arguments: -h, --help show this help message and exit awx schedules: argument action: invalid choice: 'create' (choose from 'list', 'get', 'modify', 'delete') ```"
9905,awx,https://github.com/ansible/awx/issues/9905,Unable to cancel job - method POST not allowed - awx19,"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY I had an inventory sync job that was stuck. Upon trying to cancel it, I got an error saying `Method ""POST"" not allowed` This is a refile of #9714 as the issue is still not fixed. ##### ENVIRONMENT * AWX version: 19.0.0 * AWX install method: minishift * Ansible version: * Operating System: Debian 10 * Web Browser: Chrome ##### STEPS TO REPRODUCE 1. Get a stuck job? 2. Try to cancel job. ##### EXPECTED RESULTS job to cancel ##### ACTUAL RESULTS ``` POST /api/v2/inventory_updates/11/cancel/ 405 Method ""POST"" not allowed. ``` ![image](https://user-images.githubusercontent.com/1826947/114759279-f7b63480-9d2b-11eb-96ff-2d5669e4c4a1.png) ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->",other-file,unable cancel job method post allowed issues concrete actionable bugs feature requests asking debugging help technical please use http webchat freenode channels ansible https groups google forum forum project limit limited volunteer time respond issues type bug report summary inventory sync job stuck upon trying cancel got saying method post allowed refile still fixed environment install method minishift ansible operating system debian web browser chrome steps reproduce get stuck job cancel job expected results job cancel actual results post api inventory updates cancel method post allowed image https user images githubusercontent png additional information include links sosreport database dumps screenshots information,bug,0.9,"Unable to cancel job - method POST not allowed - awx19 <!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY I had an inventory sync job that was stuck. Upon trying to cancel it, I got an error saying `Method ""POST"" not allowed` This is a refile of #9714 as the issue is still not fixed. ##### ENVIRONMENT * AWX version: 19.0.0 * AWX install method: minishift * Ansible version: * Operating System: Debian 10 * Web Browser: Chrome ##### STEPS TO REPRODUCE 1. Get a stuck job? 2. Try to cancel job. ##### EXPECTED RESULTS job to cancel ##### ACTUAL RESULTS ``` POST /api/v2/inventory_updates/11/cancel/ 405 Method ""POST"" not allowed. ``` ![image](https://user-images.githubusercontent.com/1826947/114759279-f7b63480-9d2b-11eb-96ff-2d5669e4c4a1.png) ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->"
7264,awx,https://github.com/ansible/awx/issues/7264,Mattermost Notification fails on latest release,"##### ISSUE TYPE - Bug Report ##### SUMMARY Trying to send a (test) notification to a Mattermost Channel fails with ``` mattermostinfo: Notification failed. Error sending notification mattermost: {""id"":""api.webhook.incoming.error"",""message"":""Could not decode the multipart payload of incoming webhook."",""detailed_error"":"""",""request_id"":""<request ID>"",""status_code"":400} ``` ##### ENVIRONMENT * AWX version: 11.2.0 * AWX install method: docker on linux * Ansible version: 2.9.7 * Operating System: CentOS 7.8 * Web Browser: Chrome,Chromium,Firefox * Mattermost Server Version: 5.22.1 ##### STEPS TO REPRODUCE - Create an incomming webhook - Create a mattermost notification - Send a test notification ##### EXPECTED RESULTS Having a notification in the Channel ##### ACTUAL RESULTS Sending failed with above error message ##### ADDITIONAL INFORMATION The error message in the mattermost log shows ``` {""level"":""error"",""ts"":1591342011.6592789,""caller"":""mlog/log.go:175"",""msg"":""Could not decode the multipart payload of incoming webhook."",""path"":""/ hooks/<hook ID>"",""request_id"":""<request ID>"",""ip_addr"":""<IP Address>"",""user_id"":"""",""method"":""POST"",""err_where"":"" incomingWebhook"",""http_code"":400,""err_details"":""mime: no media type""} ``` --- edit: some ID removed in the log sample, mattermost server version added",source-file | source-file | source-file | source-file | documentation-file | other-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | source-file | config-file | source-file | documentation-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | other-file | test-file | other-file | other-file | test-file | other-file | test-file | other-file | source-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | other-file | test-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | test-file | other-file | other-file | source-file | other-file | test-file | other-file | other-file | test-file | test-file | other-file | test-file | other-file | other-file | other-file | other-file | test-file | other-file | test-file | other-file | other-file | test-file | other-file | test-file | other-file | other-file | test-file | source-file | other-file | test-file | source-file | other-file | other-file | source-file | other-file | test-file | other-file | other-file | test-file | source-file | test-file | test-file | other-file | other-file | other-file | test-file | other-file | other-file | other-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | other-file | other-file | test-file | other-file | other-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | test-file | other-file | other-file | test-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | documentation-file | other-file | test-file | source-file | other-file | other-file | test-file | other-file | source-file | other-file | test-file | source-file | other-file | test-file | other-file | other-file | other-file | source-file | other-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | other-file | other-file | other-file | other-file | other-file | test-file | other-file | other-file | test-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file,mattermost notification fails latest type bug report summary trying send notification mattermost channel fails mattermostinfo notification failed sending notification mattermost api webhook incoming message could decode multipart payload incoming webhook detailed status environment install method docker linux ansible operating system centos web browser chrome chromium firefox mattermost server steps reproduce create incomming webhook create mattermost notification send notification expected results notification channel actual results sending failed message additional information message mattermost log shows level caller mlog log msg could decode multipart payload incoming webhook path hooks hook addr address user method post err incomingwebhook http err details mime media type edit removed log sample mattermost server added,bug,0.9,"Mattermost Notification fails on latest release ##### ISSUE TYPE - Bug Report ##### SUMMARY Trying to send a (test) notification to a Mattermost Channel fails with ``` mattermostinfo: Notification failed. Error sending notification mattermost: {""id"":""api.webhook.incoming.error"",""message"":""Could not decode the multipart payload of incoming webhook."",""detailed_error"":"""",""request_id"":""<request ID>"",""status_code"":400} ``` ##### ENVIRONMENT * AWX version: 11.2.0 * AWX install method: docker on linux * Ansible version: 2.9.7 * Operating System: CentOS 7.8 * Web Browser: Chrome,Chromium,Firefox * Mattermost Server Version: 5.22.1 ##### STEPS TO REPRODUCE - Create an incomming webhook - Create a mattermost notification - Send a test notification ##### EXPECTED RESULTS Having a notification in the Channel ##### ACTUAL RESULTS Sending failed with above error message ##### ADDITIONAL INFORMATION The error message in the mattermost log shows ``` {""level"":""error"",""ts"":1591342011.6592789,""caller"":""mlog/log.go:175"",""msg"":""Could not decode the multipart payload of incoming webhook."",""path"":""/ hooks/<hook ID>"",""request_id"":""<request ID>"",""ip_addr"":""<IP Address>"",""user_id"":"""",""method"":""POST"",""err_where"":"" incomingWebhook"",""http_code"":400,""err_details"":""mime: no media type""} ``` --- edit: some ID removed in the log sample, mattermost server version added"
6128,awx,https://github.com/ansible/awx/issues/6128,AWX Collection user and role modules break when creating or updating an existing object,"##### ISSUE TYPE - Bug Report ##### SUMMARY #### Collection Updating an object without a `name` field breaks, which also breaks idempotency. Probably because of: https://github.com/ansible/awx/blob/devel/awx_collection/plugins/module_utils/tower_api.py#L534 ##### ENVIRONMENT * AWX version: 9.2.0 * AWX install method: docker on linux * Ansible version: 2.9.4 * Operating System: ubuntu 18.04 ##### STEPS TO REPRODUCE Run a playbook that creates a user or role twice, the second time it will fail ##### EXPECTED RESULTS it should be Idempotent and know how to update those objects ##### ACTUAL RESULTS ``` PLAY [testhost] **************************************************************** TASK [Gathering Facts] ********************************************************* ok: [testhost] TASK [tower_user : Create a User] ********************************************** fatal: [testhost]: FAILED! => {""changed"": false, ""msg"": ""Unable to process update of item due to missing data 'name'""} PLAY RECAP ********************************************************************* testhost : ok=1 changed=0 unreachable=0 failed=1 skipped=0 rescued=0 ignored=0 ```",source-file | source-file,collection user role modules break creating updating existing object type bug report summary collection updating object without name field breaks also breaks idempotency probably https github ansible blob devel collection plugins module utils tower api environment install method docker linux ansible operating system ubuntu steps reproduce playbook creates user role twice second time fail expected results idempotent know objects actual results play testhost task gathering facts testhost task tower user create user fatal testhost failed changed false msg unable process item due missing data name play recap testhost changed unreachable failed skipped rescued ignored,bug,0.9,"AWX Collection user and role modules break when creating or updating an existing object ##### ISSUE TYPE - Bug Report ##### SUMMARY #### Collection Updating an object without a `name` field breaks, which also breaks idempotency. Probably because of: https://github.com/ansible/awx/blob/devel/awx_collection/plugins/module_utils/tower_api.py#L534 ##### ENVIRONMENT * AWX version: 9.2.0 * AWX install method: docker on linux * Ansible version: 2.9.4 * Operating System: ubuntu 18.04 ##### STEPS TO REPRODUCE Run a playbook that creates a user or role twice, the second time it will fail ##### EXPECTED RESULTS it should be Idempotent and know how to update those objects ##### ACTUAL RESULTS ``` PLAY [testhost] **************************************************************** TASK [Gathering Facts] ********************************************************* ok: [testhost] TASK [tower_user : Create a User] ********************************************** fatal: [testhost]: FAILED! => {""changed"": false, ""msg"": ""Unable to process update of item due to missing data 'name'""} PLAY RECAP ********************************************************************* testhost : ok=1 changed=0 unreachable=0 failed=1 skipped=0 rescued=0 ignored=0 ```"
9772,awx,https://github.com/ansible/awx/issues/9772,"Job output paginator can make requests to page 0 of job_events endpoint, resulting in unhandled 404","It's possible for the job output paginator to produce a request to page 0, which returns an unhandled 404: ![Screenshot from 2021-03-31 11-48-29](https://user-images.githubusercontent.com/9753817/113173073-0b837600-9217-11eb-9962-eccdd4e1785f.png)",source-file | test-file,job output paginator make requests page job events endpoint resulting unhandled possible job output paginator produce page returns unhandled screenshot https user images githubusercontent eccdd png,bug,0.9,"Job output paginator can make requests to page 0 of job_events endpoint, resulting in unhandled 404 It's possible for the job output paginator to produce a request to page 0, which returns an unhandled 404: ![Screenshot from 2021-03-31 11-48-29](https://user-images.githubusercontent.com/9753817/113173073-0b837600-9217-11eb-9962-eccdd4e1785f.png)"
10383,awx,https://github.com/ansible/awx/issues/10383,Unexpected api config requests on logout,"##### ISSUE TYPE - Bug Report ##### STEPS TO REPRODUCE - logout using the top-nav dropdown ##### EXPECTED RESULTS no requests are made to the config endpoint on logout ##### ACTUAL RESULTS requests are made to config endpoint, 400 errors",other-file | other-file,unexpected api config requests logout type bug report steps reproduce logout top nav dropdown expected results requests made config endpoint logout actual results requests made config endpoint errors,bug,0.85,"Unexpected api config requests on logout ##### ISSUE TYPE - Bug Report ##### STEPS TO REPRODUCE - logout using the top-nav dropdown ##### EXPECTED RESULTS no requests are made to the config endpoint on logout ##### ACTUAL RESULTS requests are made to config endpoint, 400 errors"
5110,awx,https://github.com/ansible/awx/issues/5110,"JOB TAGS and SKIP TAGS not being honored via ""prompt on launch""","##### ISSUE TYPE - Bug Report ##### SUMMARY User entered values for SKIP TAGS and JOB TAGS are not honored. ##### ENVIRONMENT * AWX version: 8.0.0 * AWX install method: docker on linux * Ansible version: 2.8.5 * Operating System: RHEL 7.6 * Web Browser: Chrome Version 78.0.3904.70 (Official Build) (64-bit) ##### STEPS TO REPRODUCE Configure a template to have null or populated values in JOB TAGS and SKIP TAGS and activate ""prompt on launch"" for those 2 fields. ![tags_null](https://user-images.githubusercontent.com/56000662/67570164-bb89b100-f6fe-11e9-8cd9-bc0b31d44edf.png) On launch, enter the tags one might want to run/skip ![tags_tagged](https://user-images.githubusercontent.com/56000662/67570267-eecc4000-f6fe-11e9-9671-c37445f0c425.png) Click next to get to the job preview. The preview shows no tags have been assigned to the job though they were in fact entered. On launch of the job, the requested tags will not be honored. ![tags_nothonored](https://user-images.githubusercontent.com/56000662/67570508-934e8200-f6ff-11e9-9d57-3af0801cd660.png) NOTE: If the template is saved WITH values, and prompt on launch is selected. You may REMOVE those predefined values with no issue. Any new values entered during ""prompt to launch"" will still go unrecognized. ##### EXPECTED RESULTS JOB TAGS and SKIP TAGS values are assigned via ""prompt on launch"" and honored in job execution ![tags_honored](https://user-images.githubusercontent.com/56000662/67570589-cbee5b80-f6ff-11e9-9eb9-d8f34d52e7df.png) ##### ACTUAL RESULTS Jobs run without honoring the tags entered by the user. ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->",source-file,job tags skip tags honored via prompt launch type bug report summary user entered values skip tags job tags honored environment install method docker linux ansible operating system rhel web browser chrome official bit steps reproduce configure template null populated values job tags skip tags activate prompt launch fields tags null https user images githubusercontent edf png launch enter tags one might want skip tags tagged https user images githubusercontent eecc png click next get job preview preview shows tags assigned job though fact entered launch job requested tags honored tags nothonored https user images githubusercontent png note template saved values prompt launch selected may predefined values new values entered prompt launch still unrecognized expected results job tags skip tags values assigned via prompt launch honored job execution tags honored https user images githubusercontent cbee png actual results jobs without honoring tags entered user additional information include links sosreport database dumps screenshots information,bug,0.9,"JOB TAGS and SKIP TAGS not being honored via ""prompt on launch"" ##### ISSUE TYPE - Bug Report ##### SUMMARY User entered values for SKIP TAGS and JOB TAGS are not honored. ##### ENVIRONMENT * AWX version: 8.0.0 * AWX install method: docker on linux * Ansible version: 2.8.5 * Operating System: RHEL 7.6 * Web Browser: Chrome Version 78.0.3904.70 (Official Build) (64-bit) ##### STEPS TO REPRODUCE Configure a template to have null or populated values in JOB TAGS and SKIP TAGS and activate ""prompt on launch"" for those 2 fields. ![tags_null](https://user-images.githubusercontent.com/56000662/67570164-bb89b100-f6fe-11e9-8cd9-bc0b31d44edf.png) On launch, enter the tags one might want to run/skip ![tags_tagged](https://user-images.githubusercontent.com/56000662/67570267-eecc4000-f6fe-11e9-9671-c37445f0c425.png) Click next to get to the job preview. The preview shows no tags have been assigned to the job though they were in fact entered. On launch of the job, the requested tags will not be honored. ![tags_nothonored](https://user-images.githubusercontent.com/56000662/67570508-934e8200-f6ff-11e9-9d57-3af0801cd660.png) NOTE: If the template is saved WITH values, and prompt on launch is selected. You may REMOVE those predefined values with no issue. Any new values entered during ""prompt to launch"" will still go unrecognized. ##### EXPECTED RESULTS JOB TAGS and SKIP TAGS values are assigned via ""prompt on launch"" and honored in job execution ![tags_honored](https://user-images.githubusercontent.com/56000662/67570589-cbee5b80-f6ff-11e9-9eb9-d8f34d52e7df.png) ##### ACTUAL RESULTS Jobs run without honoring the tags entered by the user. ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->"
6492,awx,https://github.com/ansible/awx/issues/6492,ISSUE: Call to /api/v2/job_templates/12/launch failed. POST returned status: 504.,"<!--- The Ansible community is highly committed to the security of our open source projects. Security concerns should be reported directly by email to security@ansible.com. For more information on the Ansible community's practices regarding responsible disclosure, see https://www.ansible.com/security --> ##### ISSUE TYPE <!--- Pick one below and delete the rest: --> - Job Template Run - POST returned status: 504 ##### COMPONENT NAME <!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: --> - API ##### SUMMARY <!-- Briefly describe the problem. --> ##### ENVIRONMENT * AWX version: How to know the version? This is a newly installed AWX as well * AWX install method: docker on Linux * Ansible version: 2.9.6 * Operating System: CentOS 7 * Web Browser: Firefox ##### STEPS TO REPRODUCE The issue will be reproduced when Launching the Job Template <!-- For new features, show how the feature would be used. For bugs, please show exactly how to reproduce the problem. Ideally, provide all steps and data needed to recreate the bug from a new awx install. --> ##### EXPECTED RESULTS <!-- For bug reports, what did you expect to happen when running the steps above? --> ##### ACTUAL RESULTS - Call to /api/v2/job_templates/12/launch failed. POST returned status: 504. <!-- For bug reports, what actually happened? --> ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. --> GUYS, PLEASE HELP ME WITH THIS ISSUE. :( Let me know if you need more info.",source-file | test-file,call api job templates launch failed post returned status ansible community highly committed security open projects security concerns reported directly email security ansible information ansible community practices regarding responsible disclosure see https www ansible security type pick one delete rest job template post returned status component name pick area multiple delete rest api summary briefly describe environment know newly installed well install method docker linux ansible operating system centos web browser firefox steps reproduce reproduced launching job template new features show feature would used bugs please show exactly reproduce ideally provide steps data needed recreate bug new install expected results bug reports expect happen running steps actual results call api job templates launch failed post returned status bug reports actually happened additional information include links sosreport database dumps screenshots information guys please help let know need,bug,0.8,"ISSUE: Call to /api/v2/job_templates/12/launch failed. POST returned status: 504. <!--- The Ansible community is highly committed to the security of our open source projects. Security concerns should be reported directly by email to security@ansible.com. For more information on the Ansible community's practices regarding responsible disclosure, see https://www.ansible.com/security --> ##### ISSUE TYPE <!--- Pick one below and delete the rest: --> - Job Template Run - POST returned status: 504 ##### COMPONENT NAME <!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: --> - API ##### SUMMARY <!-- Briefly describe the problem. --> ##### ENVIRONMENT * AWX version: How to know the version? This is a newly installed AWX as well * AWX install method: docker on Linux * Ansible version: 2.9.6 * Operating System: CentOS 7 * Web Browser: Firefox ##### STEPS TO REPRODUCE The issue will be reproduced when Launching the Job Template <!-- For new features, show how the feature would be used. For bugs, please show exactly how to reproduce the problem. Ideally, provide all steps and data needed to recreate the bug from a new awx install. --> ##### EXPECTED RESULTS <!-- For bug reports, what did you expect to happen when running the steps above? --> ##### ACTUAL RESULTS - Call to /api/v2/job_templates/12/launch failed. POST returned status: 504. <!-- For bug reports, what actually happened? --> ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. --> GUYS, PLEASE HELP ME WITH THIS ISSUE. :( Let me know if you need more info."
7191,awx,https://github.com/ansible/awx/issues/7191,Invalid HTTP request when Conjur credential secret has a space in the name,##### ISSUE TYPE - Bug Report ##### SUMMARY Invalid HTTP request when Conjur credential secret has a space in the name ##### STEPS TO REPRODUCE Create a conjur credential containing a space. When retrieving the credential a 404 is returned from conjur. The reason for this is because the conjur credential plugin url encodes the secretID with a `+` however conjur is expecting a `%20`. ##### EXPECTED RESULTS To get back the credential content. ##### ACTUAL RESULTS AWX fails to retrieve the credential and a 404 is returned. ##### ADDITIONAL INFORMATION,source-file | source-file | documentation-file,invalid http conjur credential secret space name type bug report summary invalid http conjur credential secret space name steps reproduce create conjur credential containing space retrieving credential returned conjur reason conjur credential plugin url encodes secretid however conjur expecting expected results get back credential content actual results fails retrieve credential returned additional information,bug,0.9,Invalid HTTP request when Conjur credential secret has a space in the name ##### ISSUE TYPE - Bug Report ##### SUMMARY Invalid HTTP request when Conjur credential secret has a space in the name ##### STEPS TO REPRODUCE Create a conjur credential containing a space. When retrieving the credential a 404 is returned from conjur. The reason for this is because the conjur credential plugin url encodes the secretID with a `+` however conjur is expecting a `%20`. ##### EXPECTED RESULTS To get back the credential content. ##### ACTUAL RESULTS AWX fails to retrieve the credential and a 404 is returned. ##### ADDITIONAL INFORMATION
11350,awx,https://github.com/ansible/awx/issues/11350,Instance group basic Name search missing __icontains,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary When searching a list of instance groups the __icontains parameter is missing. This means that a user can do a basic search for a string contained within the name of an existing instance group, and the UI will return no results. ![image](https://user-images.githubusercontent.com/63685497/142051117-77ea7fad-6d6e-4d35-a830-66435ac89c29.png) ### AWX version 4.1 ### Installation method docker on linux ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce To reproduce: 1. Create an instance group 2. Visit the list of instance groups and do a basic Name search for part of the name you gave the instance group. No results. ### Expected results If an instance group exists, searching for part of the name should bring up a result. ### Actual results The UI shows no results ### Additional information _No response_",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,instance group basic name search missing icontains please confirm following agree follow project conduct http docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free entitled status updates assurances summary searching list instance groups icontains parameter missing means user basic search string contained within name existing instance group return results image https user images githubusercontent fad png installation method docker linux modifications ansible response operating system response web browser response steps reproduce reproduce create instance group visit list instance groups basic name search part name gave instance group results expected results instance group exists searching part name bring result actual results shows results additional information response,bug,0.9,"Instance group basic Name search missing __icontains ### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary When searching a list of instance groups the __icontains parameter is missing. This means that a user can do a basic search for a string contained within the name of an existing instance group, and the UI will return no results. ![image](https://user-images.githubusercontent.com/63685497/142051117-77ea7fad-6d6e-4d35-a830-66435ac89c29.png) ### AWX version 4.1 ### Installation method docker on linux ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce To reproduce: 1. Create an instance group 2. Visit the list of instance groups and do a basic Name search for part of the name you gave the instance group. No results. ### Expected results If an instance group exists, searching for part of the name should bring up a result. ### Actual results The UI shows no results ### Additional information _No response_"
11130,awx,https://github.com/ansible/awx/issues/11130,Disable editing more fields of `controlplane` group,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Users are able to modify several fields of the `controlplane` instance group, which they probably shouldn't be allowed to edit (these edits will break things). ### AWX version 19.2.2 ### Installation method docker on linux ### Modifications no ### Ansible version devel ### Operating system N/A ### Web browser Chrome ### Steps to reproduce PATCH to `/api/v2/instance_groups/N/` where that record has the `name` of ""controlplane"" try giving all the fields (individually) a non-default value: ```json ""name"": ""controlplane"", ""is_container_group"": false, ""credential"": null, ""policy_instance_percentage"": 98, ""policy_instance_minimum"": 0, ""policy_instance_list"": [], ""pod_spec_override"": """" ``` ### Expected results Most of these should give a 400 error ### Actual results Only modifying `name` gives a 400 Out of the others, particularly problematic seeming ones are: - I can set `is_container_group` to true... that doesn't sound good - I can set `policy_instance_percentage` to a value lower than what was set by the installer, which is probably not desired (maybe arguable? but I doubt it) - I can add execution nodes to `policy_instance_list`, which is absolutely not okay ### Additional information _No response_",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | test-file | test-file,disable editing fields controlplane group please confirm following agree follow project conduct http docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free entitled status updates assurances summary users able modify several fields controlplane instance group probably allowed edit edits break things installation method docker linux modifications ansible devel operating system web browser chrome steps reproduce api instance groups record name controlplane giving fields individually non default value json name controlplane container group false credential null policy instance percentage policy instance minimum policy instance list pod spec override expected results give actual results modifying name gives others particularly problematic seeming ones set container group true sound good set policy instance percentage value lower set installer probably desired maybe arguable doubt execution nodes policy instance list absolutely okay additional information response,bug,0.9,"Disable editing more fields of `controlplane` group ### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Users are able to modify several fields of the `controlplane` instance group, which they probably shouldn't be allowed to edit (these edits will break things). ### AWX version 19.2.2 ### Installation method docker on linux ### Modifications no ### Ansible version devel ### Operating system N/A ### Web browser Chrome ### Steps to reproduce PATCH to `/api/v2/instance_groups/N/` where that record has the `name` of ""controlplane"" try giving all the fields (individually) a non-default value: ```json ""name"": ""controlplane"", ""is_container_group"": false, ""credential"": null, ""policy_instance_percentage"": 98, ""policy_instance_minimum"": 0, ""policy_instance_list"": [], ""pod_spec_override"": """" ``` ### Expected results Most of these should give a 400 error ### Actual results Only modifying `name` gives a 400 Out of the others, particularly problematic seeming ones are: - I can set `is_container_group` to true... that doesn't sound good - I can set `policy_instance_percentage` to a value lower than what was set by the installer, which is probably not desired (maybe arguable? but I doubt it) - I can add execution nodes to `policy_instance_list`, which is absolutely not okay ### Additional information _No response_"
10118,awx,https://github.com/ansible/awx/issues/10118,Jobs on systems missing EEs throw an error instead of failing,"##### ISSUE TYPE - Bug Report ##### SUMMARY If the user fails to have an execution environment available, the dispatcher will raise an error and a traceback will go to the logs, but the feedback provided to the user via the UI or API is mysterious. ##### ENVIRONMENT * AWX version: 19.1.0 ##### STEPS TO REPRODUCE 1. deliberately delete all EEs, including any installed managed-by-tower EEs 2. trigger a project update ##### EXPECTED RESULTS If there are no EEs available, the job should fail with an explicit reason provided in the job output in the UI. ##### ACTUAL RESULTS job output: ![image(4)](https://user-images.githubusercontent.com/685957/117202438-d17c3580-adbb-11eb-8d5e-ab255aefeacc.png) in the logs: ``` tools_awx_1 | awx-dispatcher stdout | 2021-05-05 19:46:16,092 ERROR [c77b9784] awx.main.tasks project_update 17 (running) Exception occurred while running task tools_awx_1 | awx-dispatcher stdout | Traceback (most recent call last): tools_awx_1 | awx-dispatcher stdout | File ""/awx_devel/awx/main/tasks.py"", line 1316, in run tools_awx_1 | awx-dispatcher stdout | env = self.build_env(self.instance, private_data_dir, private_data_files=private_data_files) tools_awx_1 | awx-dispatcher stdout | File ""/awx_devel/awx/main/tasks.py"", line 1883, in build_env tools_awx_1 | awx-dispatcher stdout | env = super(RunProjectUpdate, self).build_env(project_update, private_data_dir, private_data_files=private_data_files) tools_awx_1 | awx-dispatcher stdout | File ""/awx_devel/awx/main/tasks.py"", line 997, in build_env tools_awx_1 | awx-dispatcher stdout | ee_cred = self.instance.execution_environment.credential tools_awx_1 | awx-dispatcher stdout | AttributeError: 'NoneType' object has no attribute 'credential' tools_awx_1 | awx-dispatcher stdout | ```",source-file | test-file,jobs systems missing ees throw instead failing type bug report summary user fails execution environment available dispatcher raise traceback logs feedback provided user via api mysterious environment steps reproduce deliberately delete ees including installed managed tower ees trigger project expected results ees available job fail explicit reason provided job output actual results job output image https user images githubusercontent adbb aefeacc png logs tools dispatcher stdout tasks project running exception occurred running task tools dispatcher stdout traceback recent call last tools dispatcher stdout devel tasks tools dispatcher stdout env self env self instance private data dir private data files private data files tools dispatcher stdout devel tasks env tools dispatcher stdout env super runprojectupdate self env project private data dir private data files private data files tools dispatcher stdout devel tasks env tools dispatcher stdout cred self instance execution environment credential tools dispatcher stdout attributeerror nonetype object attribute credential tools dispatcher stdout,bug,0.9,"Jobs on systems missing EEs throw an error instead of failing ##### ISSUE TYPE - Bug Report ##### SUMMARY If the user fails to have an execution environment available, the dispatcher will raise an error and a traceback will go to the logs, but the feedback provided to the user via the UI or API is mysterious. ##### ENVIRONMENT * AWX version: 19.1.0 ##### STEPS TO REPRODUCE 1. deliberately delete all EEs, including any installed managed-by-tower EEs 2. trigger a project update ##### EXPECTED RESULTS If there are no EEs available, the job should fail with an explicit reason provided in the job output in the UI. ##### ACTUAL RESULTS job output: ![image(4)](https://user-images.githubusercontent.com/685957/117202438-d17c3580-adbb-11eb-8d5e-ab255aefeacc.png) in the logs: ``` tools_awx_1 | awx-dispatcher stdout | 2021-05-05 19:46:16,092 ERROR [c77b9784] awx.main.tasks project_update 17 (running) Exception occurred while running task tools_awx_1 | awx-dispatcher stdout | Traceback (most recent call last): tools_awx_1 | awx-dispatcher stdout | File ""/awx_devel/awx/main/tasks.py"", line 1316, in run tools_awx_1 | awx-dispatcher stdout | env = self.build_env(self.instance, private_data_dir, private_data_files=private_data_files) tools_awx_1 | awx-dispatcher stdout | File ""/awx_devel/awx/main/tasks.py"", line 1883, in build_env tools_awx_1 | awx-dispatcher stdout | env = super(RunProjectUpdate, self).build_env(project_update, private_data_dir, private_data_files=private_data_files) tools_awx_1 | awx-dispatcher stdout | File ""/awx_devel/awx/main/tasks.py"", line 997, in build_env tools_awx_1 | awx-dispatcher stdout | ee_cred = self.instance.execution_environment.credential tools_awx_1 | awx-dispatcher stdout | AttributeError: 'NoneType' object has no attribute 'credential' tools_awx_1 | awx-dispatcher stdout | ```"
9669,awx,https://github.com/ansible/awx/issues/9669,Cannot save Miscellaneous System Settings on new cluster,"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY I cannot save my changes to the Miscellaneous System settings of a newly created AWX Tower install. I receive no UI feedback but the network tab shows `{""CUSTOM_VENV_PATHS"":[""Expected list of strings but got <class 'str'> instead.""]}`. I have not attempted to set up custom venvs, nor can I find that setting in the UI. ##### ENVIRONMENT * AWX version: 18.0.0 * AWX install method: minikube following https://github.com/ansible/awx/blob/devel/INSTALL.md * Ansible version: unknown * Operating System: ArchLinux * Web Browser: Firefox 87 ##### STEPS TO REPRODUCE 1. Install a new instance of AWX using the instructions given in the INSTALL.md file 2. Log in as admin 3. Edit settings under /#/settings/miscellaneous_system/details 4. Attempt to change the base url from ""https://towerhost"" to my actual base URL. 5. Hit save ##### EXPECTED RESULTS Settings save and UI reverts to the details page. ##### ACTUAL RESULTS No UI feedback at all, following error in network tab. ``` {""CUSTOM_VENV_PATHS"":[""Expected list of strings but got <class 'str'> instead.""]} ``` The PATCH request is sent to https://MYDOMAIN/api/v2/settings/all/ and has the following relevant data: ``` ""CUSTOM_VENV_PATHS"":""[]"" ``` ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->",other-file | test-file | other-file | test-file | other-file | documentation-file | documentation-file | source-file | other-file | test-file | other-file | test-file | other-file | documentation-file | documentation-file | source-file | other-file | test-file | other-file | test-file | other-file | documentation-file | documentation-file | source-file | other-file | other-file | test-file | other-file | test-file | other-file | other-file | documentation-file | documentation-file | source-file | source-file | other-file | other-file | test-file | other-file | test-file | other-file | documentation-file | documentation-file | source-file | other-file | other-file | test-file | other-file | test-file | other-file | documentation-file | documentation-file | source-file | other-file | other-file | test-file | other-file | test-file | other-file | documentation-file | documentation-file | source-file | other-file | other-file | test-file | other-file | test-file | other-file | documentation-file | documentation-file | source-file | other-file | other-file | test-file | other-file | test-file | other-file | documentation-file | documentation-file | source-file | other-file | other-file | test-file | other-file | test-file | other-file | documentation-file | documentation-file,cannot save miscellaneous system settings new cluster issues concrete actionable bugs feature requests asking debugging help technical please use http webchat freenode channels ansible https groups google forum forum project limit limited volunteer time respond issues type bug report summary cannot save changes miscellaneous system settings newly created tower install receive feedback network tab shows custom venv paths expected list strings got class str instead attempted set custom venvs find setting environment install method minikube following https github ansible blob devel install ansible unknown operating system archlinux web browser firefox steps reproduce install new instance instructions given install log admin edit settings settings miscellaneous system details attempt base url https towerhost actual base url hit save expected results settings save reverts details page actual results feedback following network tab custom venv paths expected list strings got class str instead sent https mydomain api settings following relevant data custom venv paths additional information include links sosreport database dumps screenshots information,bug,0.9,"Cannot save Miscellaneous System Settings on new cluster <!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY I cannot save my changes to the Miscellaneous System settings of a newly created AWX Tower install. I receive no UI feedback but the network tab shows `{""CUSTOM_VENV_PATHS"":[""Expected list of strings but got <class 'str'> instead.""]}`. I have not attempted to set up custom venvs, nor can I find that setting in the UI. ##### ENVIRONMENT * AWX version: 18.0.0 * AWX install method: minikube following https://github.com/ansible/awx/blob/devel/INSTALL.md * Ansible version: unknown * Operating System: ArchLinux * Web Browser: Firefox 87 ##### STEPS TO REPRODUCE 1. Install a new instance of AWX using the instructions given in the INSTALL.md file 2. Log in as admin 3. Edit settings under /#/settings/miscellaneous_system/details 4. Attempt to change the base url from ""https://towerhost"" to my actual base URL. 5. Hit save ##### EXPECTED RESULTS Settings save and UI reverts to the details page. ##### ACTUAL RESULTS No UI feedback at all, following error in network tab. ``` {""CUSTOM_VENV_PATHS"":[""Expected list of strings but got <class 'str'> instead.""]} ``` The PATCH request is sent to https://MYDOMAIN/api/v2/settings/all/ and has the following relevant data: ``` ""CUSTOM_VENV_PATHS"":""[]"" ``` ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->"
7063,awx,https://github.com/ansible/awx/issues/7063,POSTing to create workflow approval node (node without UJT) ignores all_parents_must_converge,"##### ISSUE TYPE - Bug Report ##### SUMMARY ![all_parents](https://user-images.githubusercontent.com/9889020/82239367-abd5f200-9906-11ea-8c60-39ef86625ff8.gif) Relates to https://github.com/ansible/awx/issues/6998 ##### STEPS TO REPRODUCE 1. Create an empty workflow 2. Attempt to POST to `/api/v2/workflow_job_templates/:id/workflow_nodes/` with the following payload: ``` { ""all_parents_must_converge"": true } ``` ##### EXPECTED RESULTS A node is created with `all_parents_must_converge` set to `true` ##### ACTUAL RESULTS A node is created with `all_parents_must_converge` set to `false` ##### ADDITIONAL INFORMATION The use case here is approval nodes. In order to create an approval node in the UI we make this initial POST request to create the node. After we have a node, we create the corresponding approval template. If the user were to attempt to create a new approval node in the UI where `all_parents_must_converge` was set to true it would currently save but `all_parents_must_converge` would be set to false. If this becomes problematic to fix, the UI could always issue a 3rd request to go back and PATCH the node from the first request but this would be less desirable.",source-file | source-file | source-file | test-file | source-file | test-file | source-file | test-file | documentation-file | other-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | source-file | config-file | source-file | documentation-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | other-file | test-file | other-file | other-file | test-file | other-file | test-file | other-file | source-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | other-file | test-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | test-file | other-file | other-file | source-file | other-file | test-file | other-file | other-file | test-file | test-file | other-file | test-file | other-file | other-file | other-file | other-file | test-file | other-file | test-file | other-file | other-file | test-file | other-file | test-file | other-file | other-file | test-file | source-file | other-file | test-file | source-file | other-file | other-file | source-file | other-file | test-file | other-file | other-file | test-file | source-file | test-file | test-file | other-file | other-file | other-file | test-file | other-file | other-file | other-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | other-file | other-file | test-file | other-file | other-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | test-file | other-file | other-file | test-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | documentation-file | other-file | test-file | source-file | other-file | other-file | test-file | other-file | source-file | other-file | test-file | source-file | other-file | test-file | other-file | other-file | other-file | source-file | other-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | other-file | other-file | other-file | other-file | other-file | test-file | other-file | other-file | test-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | source-file | other-file | test-file | source-file | source-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file,posting create workflow approval node node without ujt ignores parents must converge type bug report summary parents https user images githubusercontent abd gif relates https github ansible issues steps reproduce create empty workflow attempt post api workflow job templates workflow nodes following payload parents must converge true expected results node created parents must converge set true actual results node created parents must converge set false additional information use case approval nodes order create approval node make initial post create node node create corresponding approval template user attempt create new approval node parents must converge set true would currently save parents must converge would set false becomes problematic could always back node first would less desirable,bug,0.9,"POSTing to create workflow approval node (node without UJT) ignores all_parents_must_converge ##### ISSUE TYPE - Bug Report ##### SUMMARY ![all_parents](https://user-images.githubusercontent.com/9889020/82239367-abd5f200-9906-11ea-8c60-39ef86625ff8.gif) Relates to https://github.com/ansible/awx/issues/6998 ##### STEPS TO REPRODUCE 1. Create an empty workflow 2. Attempt to POST to `/api/v2/workflow_job_templates/:id/workflow_nodes/` with the following payload: ``` { ""all_parents_must_converge"": true } ``` ##### EXPECTED RESULTS A node is created with `all_parents_must_converge` set to `true` ##### ACTUAL RESULTS A node is created with `all_parents_must_converge` set to `false` ##### ADDITIONAL INFORMATION The use case here is approval nodes. In order to create an approval node in the UI we make this initial POST request to create the node. After we have a node, we create the corresponding approval template. If the user were to attempt to create a new approval node in the UI where `all_parents_must_converge` was set to true it would currently save but `all_parents_must_converge` would be set to false. If this becomes problematic to fix, the UI could always issue a 3rd request to go back and PATCH the node from the first request but this would be less desirable."
9472,awx,https://github.com/ansible/awx/issues/9472,awx.main.utils.common.get_ansible_version breaks with ansible-core,"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> The `awx.main.utils.common.get_ansible_version` helper breaks with new `ansible --version` when ansible-core is installed. This also changes the format the `api/v2/config` returns for the `ansible_version` field. What breaks tools that relies on this field to check the current ansible version used by AWX. ##### ENVIRONMENT * AWX version: devel * AWX install method: vm * Ansible version: ansible-core 2.11 * Operating System: RHEL8.3 * Web Browser: ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> Install AWX with ansible-core and perform a GET request to `/api/v2/config` and check the `ansible_version` field format. ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> The ansible version format should be something like `X.Y.Z` (format capable to be parsed by tools like `distutils.version.LooseVersion`) ##### ACTUAL RESULTS <!-- What actually happened? --> Returning something like `""ansible_version"": ""[core 2.11.0.dev0]""` ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. --> Output of `ansible --version` for ansible-core 2.11: ```console $ ansible --version ansible [core 2.11.0b1] config file = /home/elyezer/code/ansible/ansible-core/ansible.cfg configured module search path = ['/home/elyezer/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules'] ansible python module location = /home/elyezer/.virtualenvs/ansible-core/lib/python3.9/site-packages/ansible ansible collection location = /home/elyezer/.ansible/collections:/usr/share/ansible/collections executable location = /home/elyezer/.virtualenvs/ansible-core/bin/ansible python version = 3.9.0 (default, Oct 6 2020, 00:00:00) [GCC 10.2.1 20200826 (Red Hat 10.2.1-3)] jinja version = 2.11.3 libyaml = True ``` For ansible 2.9: ``` ansible 2.9.16 config file = /home/elyezer/code/ansible/ansible/ansible.cfg configured module search path = ['/home/elyezer/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules'] ansible python module location = /home/elyezer/.virtualenvs/ansible/lib/python3.9/site-packages/ansible executable location = /home/elyezer/.virtualenvs/ansible/bin/ansible python version = 3.9.0 (default, Oct 6 2020, 00:00:00) [GCC 10.2.1 20200826 (Red Hat 10.2.1-3)] ```",source-file | source-file | source-file | source-file | other-file | other-file | test-file | source-file | source-file | source-file | source-file | other-file | other-file | test-file | source-file | source-file | source-file | source-file | other-file | other-file | test-file | source-file | source-file | source-file | source-file | other-file | other-file | test-file | source-file | source-file | source-file | source-file | other-file | other-file | test-file,utils common get ansible breaks ansible core issues concrete actionable bugs feature requests asking debugging help technical please use http webchat freenode channels ansible https groups google forum forum project limit limited volunteer time respond issues type bug report summary briefly describe utils common get ansible helper breaks new ansible ansible core installed also changes format api config returns ansible field breaks tools relies field check current ansible used environment devel install method ansible ansible core operating system rhel web browser steps reproduce please describe exactly reproduce install ansible core perform get api config check ansible field format expected results expect happen running steps ansible format something like format capable parsed tools like distutils looseversion actual results actually happened returning something like ansible core additional information include links sosreport database dumps screenshots information output ansible ansible core console ansible ansible core config home elyezer ansible ansible core ansible cfg configured module search path home elyezer ansible plugins modules share ansible plugins modules ansible python module location home elyezer virtualenvs ansible core python site packages ansible ansible collection location home elyezer ansible collections share ansible collections executable location home elyezer virtualenvs ansible core ansible python default oct gcc red hat jinja libyaml true ansible ansible config home elyezer ansible ansible ansible cfg configured module search path home elyezer ansible plugins modules share ansible plugins modules ansible python module location home elyezer virtualenvs ansible python site packages ansible executable location home elyezer virtualenvs ansible ansible python default oct gcc red hat,bug,0.9,"awx.main.utils.common.get_ansible_version breaks with ansible-core <!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> The `awx.main.utils.common.get_ansible_version` helper breaks with new `ansible --version` when ansible-core is installed. This also changes the format the `api/v2/config` returns for the `ansible_version` field. What breaks tools that relies on this field to check the current ansible version used by AWX. ##### ENVIRONMENT * AWX version: devel * AWX install method: vm * Ansible version: ansible-core 2.11 * Operating System: RHEL8.3 * Web Browser: ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> Install AWX with ansible-core and perform a GET request to `/api/v2/config` and check the `ansible_version` field format. ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> The ansible version format should be something like `X.Y.Z` (format capable to be parsed by tools like `distutils.version.LooseVersion`) ##### ACTUAL RESULTS <!-- What actually happened? --> Returning something like `""ansible_version"": ""[core 2.11.0.dev0]""` ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. --> Output of `ansible --version` for ansible-core 2.11: ```console $ ansible --version ansible [core 2.11.0b1] config file = /home/elyezer/code/ansible/ansible-core/ansible.cfg configured module search path = ['/home/elyezer/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules'] ansible python module location = /home/elyezer/.virtualenvs/ansible-core/lib/python3.9/site-packages/ansible ansible collection location = /home/elyezer/.ansible/collections:/usr/share/ansible/collections executable location = /home/elyezer/.virtualenvs/ansible-core/bin/ansible python version = 3.9.0 (default, Oct 6 2020, 00:00:00) [GCC 10.2.1 20200826 (Red Hat 10.2.1-3)] jinja version = 2.11.3 libyaml = True ``` For ansible 2.9: ``` ansible 2.9.16 config file = /home/elyezer/code/ansible/ansible/ansible.cfg configured module search path = ['/home/elyezer/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules'] ansible python module location = /home/elyezer/.virtualenvs/ansible/lib/python3.9/site-packages/ansible executable location = /home/elyezer/.virtualenvs/ansible/bin/ansible python version = 3.9.0 (default, Oct 6 2020, 00:00:00) [GCC 10.2.1 20200826 (Red Hat 10.2.1-3)] ```"
4542,awx,https://github.com/ansible/awx/issues/4542,Google Cloud Compute Engine credential type is stripping the json file,"##### ISSUE TYPE - Bug Report ##### SUMMARY When a google compute engine credential is created with the json credential file, AWX is stripping some valuable lines. I need those, as I am using gcp_compute_disk module which also requires the service account file to be give as absolute path to the json and instead of giving the file path twice manually, I am using {{ lookup('env','GCP_SERVICE_ACCOUNT_FILE') }} to refer the absolute path to the json, but I am getting error that the lines about email and token_uri are missing. In order to resolve that I was forced to create a custom credential type for uploading the json and use it without stripping. ##### ENVIRONMENT * AWX version: 6.x.x * AWX install method: docker * Ansible version: 2.8.2 * Operating System: Ubuntu 18.04 * Web Browser: Firefox, Chrome ##### STEPS TO REPRODUCE Upload a google json credential to awx and try to use the service_account_file: ""{{ lookup('env','GCP_SERVICE_ACCOUNT_FILE') }}"" when using the gcp_compute_disk module for example. Your AWX template must be pointed to the gce credential also. ##### EXPECTED RESULTS get the full json and take all needed lines ##### ACTUAL RESULTS gets the json, but it seems the AWX module for gce credenials strips some lines and the file is usable by the gcp_compute_* ansible modules. ##### ADDITIONAL INFORMATION New credential type I've used to get around this is: Input configuration: `fields: - id: gcp_credential_file type: string label: GCP Credential File (JSON) secret: true multiline: true` Injector configuration: `env: GCP_SERVICE_ACCOUNT_FILE: '{{ tower.filename }}' file: template: '{{ gcp_credential_file }}'`",source-file | source-file | source-file | test-file,google cloud compute engine credential type stripping json type bug report summary google compute engine credential created json credential stripping valuable lines need gcp compute disk module also requires service account give absolute path json instead giving path twice manually lookup env gcp service account refer absolute path json getting lines email token uri missing order resolve forced create custom credential type uploading json use without stripping environment install method docker ansible operating system ubuntu web browser firefox chrome steps reproduce upload google json credential use service account lookup env gcp service account gcp compute disk module example template must pointed gce credential also expected results get full json take needed lines actual results gets json seems module gce credenials strips lines usable gcp compute ansible modules additional information new credential type used get around input configuration fields gcp credential type string label gcp credential json secret true multiline true injector configuration env gcp service account tower filename template gcp credential,bug,0.9,"Google Cloud Compute Engine credential type is stripping the json file ##### ISSUE TYPE - Bug Report ##### SUMMARY When a google compute engine credential is created with the json credential file, AWX is stripping some valuable lines. I need those, as I am using gcp_compute_disk module which also requires the service account file to be give as absolute path to the json and instead of giving the file path twice manually, I am using {{ lookup('env','GCP_SERVICE_ACCOUNT_FILE') }} to refer the absolute path to the json, but I am getting error that the lines about email and token_uri are missing. In order to resolve that I was forced to create a custom credential type for uploading the json and use it without stripping. ##### ENVIRONMENT * AWX version: 6.x.x * AWX install method: docker * Ansible version: 2.8.2 * Operating System: Ubuntu 18.04 * Web Browser: Firefox, Chrome ##### STEPS TO REPRODUCE Upload a google json credential to awx and try to use the service_account_file: ""{{ lookup('env','GCP_SERVICE_ACCOUNT_FILE') }}"" when using the gcp_compute_disk module for example. Your AWX template must be pointed to the gce credential also. ##### EXPECTED RESULTS get the full json and take all needed lines ##### ACTUAL RESULTS gets the json, but it seems the AWX module for gce credenials strips some lines and the file is usable by the gcp_compute_* ansible modules. ##### ADDITIONAL INFORMATION New credential type I've used to get around this is: Input configuration: `fields: - id: gcp_credential_file type: string label: GCP Credential File (JSON) secret: true multiline: true` Injector configuration: `env: GCP_SERVICE_ACCOUNT_FILE: '{{ tower.filename }}' file: template: '{{ gcp_credential_file }}'`"
13120,awx,https://github.com/ansible/awx/issues/13120,Add Conjur Cloud support to CyberArk Conjur Secrets Lookup credential plugin,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary Conjur Cloud adds the requirement of `/api` after the base domain of the service prior to endpoints that are currently configured in the credential plugin. Providing `/api` as part of the URL on the secret lookup gets trimmed by `urllib.parse.urljoin()` that builds the URL to send API requests when executing the credential plugin. ### AWX version 21.7.0 ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version 2.13.5 ### Operating system Ubuntu 22.04.1 LTS ### Web browser _No response_ ### Steps to reproduce With a Conjur Cloud tenant available to target, configure the CyberArk Conjur Secrets Lookup external management system credential plugin as documented. ### Expected results Tests should pass successfully. ### Actual results Tests to retrieve a secret will return `HTTP 404`. ### Additional information A PR is prepared and will be submitted shortly.",source-file | source-file | test-file | test-file | documentation-file | documentation-file | source-file,conjur cloud cyberark conjur secrets lookup credential plugin please confirm following agree follow project conduct https docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free might receive timely response bug summary conjur cloud adds requirement api base domain service prior endpoints currently configured credential plugin providing api part url secret lookup gets trimmed urllib parse urljoin builds url send api requests executing credential plugin select relevant components api docs collection cli installation method docker development environment modifications ansible operating system ubuntu lts web browser response steps reproduce conjur cloud tenant available target configure cyberark conjur secrets lookup external management system credential plugin documented expected results tests pass successfully actual results tests retrieve secret return http additional information prepared submitted shortly,bug,0.9,"Add Conjur Cloud support to CyberArk Conjur Secrets Lookup credential plugin ### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary Conjur Cloud adds the requirement of `/api` after the base domain of the service prior to endpoints that are currently configured in the credential plugin. Providing `/api` as part of the URL on the secret lookup gets trimmed by `urllib.parse.urljoin()` that builds the URL to send API requests when executing the credential plugin. ### AWX version 21.7.0 ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version 2.13.5 ### Operating system Ubuntu 22.04.1 LTS ### Web browser _No response_ ### Steps to reproduce With a Conjur Cloud tenant available to target, configure the CyberArk Conjur Secrets Lookup external management system credential plugin as documented. ### Expected results Tests should pass successfully. ### Actual results Tests to retrieve a secret will return `HTTP 404`. ### Additional information A PR is prepared and will be submitted shortly."
5983,awx,https://github.com/ansible/awx/issues/5983,List Navigation 404,##### ISSUE TYPE - Bug Report ##### SUMMARY List navigation error. ##### ENVIRONMENT * AWX version: 2.10 * AWX install method: docker for mac * Ansible version: 9.2.1 * Operating System: Mojave * Web Browser: Chrome ##### STEPS TO REPRODUCE Go to a list and select either 5 or 10 items per page. Navigate to the last page. Then select a number of items per page higher that what you selected originally. If you selected 5 items per page originally then select 10 items per page. ##### EXPECTED RESULTS Page should reset to the first page and no 404 error ##### ACTUAL RESULTS 404 error ##### ADDITIONAL INFORMATION ![navigation bug](https://user-images.githubusercontent.com/39280967/74779455-84ba4680-526b-11ea-9fad-8fb59a1bd556.gif),other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file,list navigation type bug report summary list navigation environment install method docker mac ansible operating system mojave web browser chrome steps reproduce list select either items per page navigate last page select number items per page higher selected originally selected items per page originally select items per page expected results page reset first page actual results additional information navigation bug https user images githubusercontent fad gif,bug,0.85,List Navigation 404 ##### ISSUE TYPE - Bug Report ##### SUMMARY List navigation error. ##### ENVIRONMENT * AWX version: 2.10 * AWX install method: docker for mac * Ansible version: 9.2.1 * Operating System: Mojave * Web Browser: Chrome ##### STEPS TO REPRODUCE Go to a list and select either 5 or 10 items per page. Navigate to the last page. Then select a number of items per page higher that what you selected originally. If you selected 5 items per page originally then select 10 items per page. ##### EXPECTED RESULTS Page should reset to the first page and no 404 error ##### ACTUAL RESULTS 404 error ##### ADDITIONAL INFORMATION ![navigation bug](https://user-images.githubusercontent.com/39280967/74779455-84ba4680-526b-11ea-9fad-8fb59a1bd556.gif)
6460,awx,https://github.com/ansible/awx/issues/6460,Unable to save any forms,"##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> I'm unable to save any forms in AWX 9.3.0. When I try to click on the save button to create a new sample project or add LDAP authencatication I have a status code 504. And the form is never saved. ##### ENVIRONMENT * AWX version: 9.3.0 * AWX install method: docker on linux * Ansible version: 2.9.5 * Operating System: CentOS 7.7 * Web Browser: Chrome and Chrome in private ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> Create a new project sample and click save ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> The form should be saved ##### ACTUAL RESULTS <!-- What actually happened? --> Failed to create new project. POST returned status: 504 ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. --> In the logs I can see : `awx_web | 2020/03/27 14:23:31 [error] 122#0: *47 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 10.204.35.76, server: _, request: ""GET /websocket/ HTTP/1.1"", upstream: ""http://127.0.0.1:8051/websocket/"", host: ""myserver:82"" ` And in the browser console I have : ``` Failed to load resource: the server responded with a status of 504 (Gateway Time-out) WebSocket connection to 'ws://myserver:82/websocket/' failed: WebSocket opening handshake timed out ```",source-file,unable save forms type bug report summary briefly describe unable save forms click save button create new sample project ldap authencatication status form never saved environment install method docker linux ansible operating system centos web browser chrome chrome private steps reproduce please describe exactly reproduce create new project sample click save expected results expect happen running steps form saved actual results actually happened failed create new project post returned status additional information include links sosreport database dumps screenshots information logs see web upstream timed connection timed reading response header upstream client server get websocket http upstream http websocket host myserver browser console failed load resource server responded status gateway time websocket connection myserver websocket failed websocket opening handshake timed,bug,0.9,"Unable to save any forms ##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> I'm unable to save any forms in AWX 9.3.0. When I try to click on the save button to create a new sample project or add LDAP authencatication I have a status code 504. And the form is never saved. ##### ENVIRONMENT * AWX version: 9.3.0 * AWX install method: docker on linux * Ansible version: 2.9.5 * Operating System: CentOS 7.7 * Web Browser: Chrome and Chrome in private ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> Create a new project sample and click save ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> The form should be saved ##### ACTUAL RESULTS <!-- What actually happened? --> Failed to create new project. POST returned status: 504 ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. --> In the logs I can see : `awx_web | 2020/03/27 14:23:31 [error] 122#0: *47 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 10.204.35.76, server: _, request: ""GET /websocket/ HTTP/1.1"", upstream: ""http://127.0.0.1:8051/websocket/"", host: ""myserver:82"" ` And in the browser console I have : ``` Failed to load resource: the server responded with a status of 504 (Gateway Time-out) WebSocket connection to 'ws://myserver:82/websocket/' failed: WebSocket opening handshake timed out ```"
6309,awx,https://github.com/ansible/awx/issues/6309,POST to api/v2/inventories/<ID>/inventory_sources/ with id and name gets 201 created (should be 400),"##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> I was trying to associate an inventory script with an inventory as an inventory source. When I did a POST to api/v2/inventories/<ID>/inventory_sources/ with id and name I got a 201 created (should be 400) and an inventory source object back. I then launched an inventory update and the following traceback was produced: ``` Traceback (most recent call last): File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py"", line 1308, in run args = self.build_args(self.instance, private_data_dir, passwords) File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py"", line 2472, in build_args if getattr(settings, '%s_EXCLUDE_EMPTY_GROUPS' % src.upper()): File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py"", line 511, in __getattr_without_cache__ return getattr(self._wrapped, name) File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py"", line 418, in __getattr__ value = self._get_default(name) File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py"", line 405, in _get_default return getattr(self.default_settings, name) AttributeError: 'Settings' object has no attribute '_EXCLUDE_EMPTY_GROUPS' ``` Seems like the bug is that we are not requiring the `source` perhaps among other things and ignoring `id`",source-file | source-file,post api inventories inventory sources name gets created type bug report summary briefly describe trying associate inventory script inventory inventory post api inventories inventory sources name got created inventory object back launched inventory following traceback produced traceback recent call last var venv python site packages tasks args self args self instance private data dir passwords var venv python site packages tasks args getattr settings exclude empty groups upper var venv python site packages conf settings getattr without cache return getattr self wrapped name var venv python site packages conf settings getattr value self get default name var venv python site packages conf settings get default return getattr self default settings name attributeerror settings object attribute exclude empty groups seems like bug requiring perhaps among things ignoring,bug,0.95,"POST to api/v2/inventories/<ID>/inventory_sources/ with id and name gets 201 created (should be 400) ##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> I was trying to associate an inventory script with an inventory as an inventory source. When I did a POST to api/v2/inventories/<ID>/inventory_sources/ with id and name I got a 201 created (should be 400) and an inventory source object back. I then launched an inventory update and the following traceback was produced: ``` Traceback (most recent call last): File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py"", line 1308, in run args = self.build_args(self.instance, private_data_dir, passwords) File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py"", line 2472, in build_args if getattr(settings, '%s_EXCLUDE_EMPTY_GROUPS' % src.upper()): File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py"", line 511, in __getattr_without_cache__ return getattr(self._wrapped, name) File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py"", line 418, in __getattr__ value = self._get_default(name) File ""/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py"", line 405, in _get_default return getattr(self.default_settings, name) AttributeError: 'Settings' object has no attribute '_EXCLUDE_EMPTY_GROUPS' ``` Seems like the bug is that we are not requiring the `source` perhaps among other things and ignoring `id`"
7665,awx,https://github.com/ansible/awx/issues/7665,API should not accept modification of local_path for nom-manual projects,"##### ISSUE TYPE - Bug Report ##### SUMMARY The API will accept a PATCH to edit `local_path` for a git project, but the change will not take effect. Some version of a 400 error would be preferable to this. This is a valid field to edit in the case of manual projects, so there's no valid justification that it's ""not a field"". ##### ENVIRONMENT * AWX version: 13.0.0 * AWX install method: N/A * Ansible version: N/A ##### STEPS TO REPRODUCE PATCH `/api/v2/projects/6/` ```json { ""description"": ""asdf"", ""local_path"": ""_6__demo_project_edited"" } ``` ##### EXPECTED RESULTS One of: - the local_path value changes to ""_6__demo_project_edited"" - get error ##### ACTUAL RESULTS No error description changes to ""asdf"" the `local_path` remains at prior value of ""_6__demo_project""",source-file | test-file | source-file | test-file,api accept modification local path nom manual projects type bug report summary api accept edit local path git project take effect would preferable valid field edit case manual projects valid justification field environment install method ansible steps reproduce api projects json description asdf local path demo project edited expected results one local path value changes demo project edited get actual results description changes asdf local path remains prior value demo project,bug,0.9,"API should not accept modification of local_path for nom-manual projects ##### ISSUE TYPE - Bug Report ##### SUMMARY The API will accept a PATCH to edit `local_path` for a git project, but the change will not take effect. Some version of a 400 error would be preferable to this. This is a valid field to edit in the case of manual projects, so there's no valid justification that it's ""not a field"". ##### ENVIRONMENT * AWX version: 13.0.0 * AWX install method: N/A * Ansible version: N/A ##### STEPS TO REPRODUCE PATCH `/api/v2/projects/6/` ```json { ""description"": ""asdf"", ""local_path"": ""_6__demo_project_edited"" } ``` ##### EXPECTED RESULTS One of: - the local_path value changes to ""_6__demo_project_edited"" - get error ##### ACTUAL RESULTS No error description changes to ""asdf"" the `local_path` remains at prior value of ""_6__demo_project"""
5528,awx,https://github.com/ansible/awx/issues/5528,New AWX CLI returns type error when modifying list or dict settings,"##### ISSUE TYPE - Bug Report ##### SUMMARY When trying to modify a list or dictionary valued setting from the **awx** command line tool, the API return a type error. ##### ENVIRONMENT * AWX version: 9.0.1 * AWX install method: Kubernetes * Ansible version: 2.7.11 * Operating System: Ubuntu 18.04 * Web Browser: Firefox 71 ##### STEPS TO REPRODUCE 1. Install the AWX CLI tool: ``` pip install ""https://github.com/ansible/awx/archive/9.0.1.tar.gz#egg=awxkit&subdirectory=awxkit"" ``` 2. Try to modify the AUTH_LDAP_GROUP_SEARCH (type list) setting ``` awx settings modify AUTH_LDAP_USER_SEARCH '[""DC=example,DC=com"",""SCOPE_SUBTREE"",""(uid=%(user)s)""]' ``` 3. Receive the following error ``` {""AUTH_LDAP_USER_SEARCH"": [""Expected a list of items but got type \""str\"".""]} ``` ##### EXPECTED RESULTS Expected to modify the setting like the old tower-cli or awx-cli tools were able to. ##### ACTUAL RESULTS Received a type error ``` {""AUTH_LDAP_USER_SEARCH"": [""Expected a list of items but got type \""str\"".""]} ``` ##### ADDITIONAL INFORMATION You can achieve the same modification with the awx-cli: ``` awx-cli setting modify AUTH_LDAP_USER_SEARCH '[""DC=example,DC=com"",""SCOPE_SUBTREE"",""(uid=%(user)s)""]' Resource changed. ===================== =========================================================== id value ===================== =========================================================== AUTH_LDAP_USER_SEARCH [u'DC=example,DC=com', u'SCOPE_SUBTREE', u'(uid=%(user)s)'] ===================== =========================================================== ```",other-file | source-file | source-file | source-file | test-file | test-file,new cli returns type modifying list dict settings type bug report summary trying modify list dictionary valued setting command tool api return type environment install method kubernetes ansible operating system ubuntu web browser firefox steps reproduce install cli tool pip install https github ansible archive tar egg awxkit subdirectory awxkit modify auth ldap group search type list setting settings modify auth ldap user search example scope subtree uid user receive following auth ldap user search expected list items got type str expected results expected modify setting like old tower cli cli tools able actual results received type auth ldap user search expected list items got type str additional information achieve modification cli cli setting modify auth ldap user search example scope subtree uid user resource changed value auth ldap user search example scope subtree uid user,bug,0.9,"New AWX CLI returns type error when modifying list or dict settings ##### ISSUE TYPE - Bug Report ##### SUMMARY When trying to modify a list or dictionary valued setting from the **awx** command line tool, the API return a type error. ##### ENVIRONMENT * AWX version: 9.0.1 * AWX install method: Kubernetes * Ansible version: 2.7.11 * Operating System: Ubuntu 18.04 * Web Browser: Firefox 71 ##### STEPS TO REPRODUCE 1. Install the AWX CLI tool: ``` pip install ""https://github.com/ansible/awx/archive/9.0.1.tar.gz#egg=awxkit&subdirectory=awxkit"" ``` 2. Try to modify the AUTH_LDAP_GROUP_SEARCH (type list) setting ``` awx settings modify AUTH_LDAP_USER_SEARCH '[""DC=example,DC=com"",""SCOPE_SUBTREE"",""(uid=%(user)s)""]' ``` 3. Receive the following error ``` {""AUTH_LDAP_USER_SEARCH"": [""Expected a list of items but got type \""str\"".""]} ``` ##### EXPECTED RESULTS Expected to modify the setting like the old tower-cli or awx-cli tools were able to. ##### ACTUAL RESULTS Received a type error ``` {""AUTH_LDAP_USER_SEARCH"": [""Expected a list of items but got type \""str\"".""]} ``` ##### ADDITIONAL INFORMATION You can achieve the same modification with the awx-cli: ``` awx-cli setting modify AUTH_LDAP_USER_SEARCH '[""DC=example,DC=com"",""SCOPE_SUBTREE"",""(uid=%(user)s)""]' Resource changed. ===================== =========================================================== id value ===================== =========================================================== AUTH_LDAP_USER_SEARCH [u'DC=example,DC=com', u'SCOPE_SUBTREE', u'(uid=%(user)s)'] ===================== =========================================================== ```"
11622,awx,https://github.com/ansible/awx/issues/11622,Hop nodes instances can be modified,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Summary After merging https://github.com/ansible/awx/pull/11591 the hop nodes are now exposed in `/api/v2/instances/`. Example: ``` { ""id"": 4, ""type"": ""instance"", ""url"": ""/api/v2/instances/4/"", ""related"": { ""jobs"": ""/api/v2/instances/4/jobs/"", ""instance_groups"": ""/api/v2/instances/4/instance_groups/"" }, ""uuid"": ""00000000-0000-0000-0000-000000000000"", ""hostname"": ""receptor-hop"", ""created"": ""2022-01-26T19:15:07.439405Z"", ""modified"": ""2022-01-26T19:27:58.447951Z"", ""last_seen"": ""2022-01-27T13:36:46.163205Z"", ""last_health_check"": null, ""errors"": """", ""capacity_adjustment"": ""1.00"", ""version"": """", ""capacity"": 0, ""consumed_capacity"": 0, ""percent_capacity_remaining"": 0.0, ""jobs_running"": 0, ""jobs_total"": 0, ""cpu"": 0, ""memory"": 0, ""cpu_capacity"": 0, ""mem_capacity"": 0, ""enabled"": false, ""managed_by_policy"": false, ""node_type"": ""hop"" } ``` and now is possible to `PUT` or `PATCH` the values through API ``` { ""capacity_adjustment"": ""1.00"", ""enabled"": false, ""managed_by_policy"": false } ``` although setting capacity to 0 enabld to false is not making the job to faul, @jbradberry do we want allow users to patch/put on hop node instances? ### AWX version devel ### Installation method docker on linux ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser Chrome ### Steps to reproduce 1. Go to /api/v2/instances/<id>/ 2. patch any value: ``` { ""capacity_adjustment"": 1.0, ""enabled"": true, ""managed_by_policy"": true } ``` ### Expected results These fields to be not modifyable for hop nodes? ### Actual results 1. The user can change those values 2. This is not making the job to fail 3. The hop nodes instances are showing as `disabled` in the mesh view (may confuse users) ### Additional information _No response_",source-file | source-file,hop nodes instances modified please confirm following agree follow project conduct https docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free might receive timely response summary merging https github ansible hop nodes exposed api instances example type instance url api instances related jobs api instances jobs instance groups api instances instance groups uuid hostname receptor hop created modified last seen last health check null errors capacity adjustment capacity consumed capacity percent capacity remaining jobs running jobs total cpu memory cpu capacity mem capacity enabled false managed policy false node type hop possible put values api capacity adjustment enabled false managed policy false although setting capacity enabld false making job faul jbradberry want allow users put hop node instances devel installation method docker linux modifications ansible response operating system response web browser chrome steps reproduce api instances value capacity adjustment enabled true managed policy true expected results fields modifyable hop nodes actual results user values making job fail hop nodes instances showing disabled mesh view may confuse users additional information response,bug,0.9,"Hop nodes instances can be modified ### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Summary After merging https://github.com/ansible/awx/pull/11591 the hop nodes are now exposed in `/api/v2/instances/`. Example: ``` { ""id"": 4, ""type"": ""instance"", ""url"": ""/api/v2/instances/4/"", ""related"": { ""jobs"": ""/api/v2/instances/4/jobs/"", ""instance_groups"": ""/api/v2/instances/4/instance_groups/"" }, ""uuid"": ""00000000-0000-0000-0000-000000000000"", ""hostname"": ""receptor-hop"", ""created"": ""2022-01-26T19:15:07.439405Z"", ""modified"": ""2022-01-26T19:27:58.447951Z"", ""last_seen"": ""2022-01-27T13:36:46.163205Z"", ""last_health_check"": null, ""errors"": """", ""capacity_adjustment"": ""1.00"", ""version"": """", ""capacity"": 0, ""consumed_capacity"": 0, ""percent_capacity_remaining"": 0.0, ""jobs_running"": 0, ""jobs_total"": 0, ""cpu"": 0, ""memory"": 0, ""cpu_capacity"": 0, ""mem_capacity"": 0, ""enabled"": false, ""managed_by_policy"": false, ""node_type"": ""hop"" } ``` and now is possible to `PUT` or `PATCH` the values through API ``` { ""capacity_adjustment"": ""1.00"", ""enabled"": false, ""managed_by_policy"": false } ``` although setting capacity to 0 enabld to false is not making the job to faul, @jbradberry do we want allow users to patch/put on hop node instances? ### AWX version devel ### Installation method docker on linux ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser Chrome ### Steps to reproduce 1. Go to /api/v2/instances/<id>/ 2. patch any value: ``` { ""capacity_adjustment"": 1.0, ""enabled"": true, ""managed_by_policy"": true } ``` ### Expected results These fields to be not modifyable for hop nodes? ### Actual results 1. The user can change those values 2. This is not making the job to fail 3. The hop nodes instances are showing as `disabled` in the mesh view (may confuse users) ### Additional information _No response_"
7798,awx,https://github.com/ansible/awx/issues/7798,Exported Workflow Job Templates refer to inventories by id instead of natural key,"##### ISSUE TYPE - The API endpoint for a workflow_job_template does not provide a representation that includes the natural key of the related Inventory, which is problematic when migrating it between different instances of AWX/Tower. ##### SUMMARY The API endpoint for a workflow_job_template does not provide a representation that includes the natural key of the related Inventory, if set. Instead, it just uses the numerical `id`, which is problematic when attempting to export and import the workflow between different instances of AWX/Tower, since the API will attempt to use the given numerical `id` to associate an inventory to the import workflow, which will most likely be different on the target instance of AWX/Tower. This behaviour is dangerous because if the target instance of AWX/Tower has a different inventory with the same numerical `id`, no warnings will be raised, causing the workflow to be associated with the wrong template. ##### ENVIRONMENT * AWX version: 3.7.1 (Tower) * AWX install method: openshift * Ansible version: 2.9.9 * Operating System: OpenShift * Web Browser: Google Chrome ##### STEPS TO REPRODUCE 1. Export a `workflow_job_template` that is associated with an inventory 2. Observe the value of the `workflow_job_templates.[].inventory` attribut in the exported YAML. ##### EXPECTED RESULTS It is reasonable to expect that the following YAML document would be generated for an example workflow_job_template object. ```yaml workflow_job_templates: - allow_simultaneous: true ask_inventory_on_launch: false ask_limit_on_launch: false ask_scm_branch_on_launch: true ask_variables_on_launch: true description: My VM provisioning extra_vars: '' inventory: name: my-vms type: inventory organization: name: ACME type: organization limit: null name: my-workflow natural_key: name: my-workflow organization: name: ACME type: organization type: workflow_job_template organization: name: ACME type: organization related: notification_templates_approvals: [] notification_templates_error: [] notification_templates_started: [] notification_templates_success: [] schedules: [] survey_spec: {} workflow_nodes: [] scm_branch: null survey_enabled: false webhook_credential: null ``` The document above, when imported, will generate the association with the inventory correctly on Tower 3.7.1. This is the expected behaviour, relying on the natural key of the object instead of the `id`. ##### ACTUAL RESULTS YAML such as the following is generated: ```yaml workflow_job_templates: - allow_simultaneous: true ask_inventory_on_launch: false ask_limit_on_launch: false ask_scm_branch_on_launch: true ask_variables_on_launch: true description: My VM provisioning extra_vars: '' inventory: 29 limit: null name: my-workflow natural_key: name: my-workflow organization: name: ACME type: organization type: workflow_job_template organization: name: ACME type: organization related: notification_templates_approvals: [] notification_templates_error: [] notification_templates_started: [] notification_templates_success: [] schedules: [] survey_spec: {} workflow_nodes: [] scm_branch: null survey_enabled: false webhook_credential: null ``` Notice that the `inventory` key has the value corresponding to the unique id on the source AWX/Tower server. This is not guaranteed to be the same on the target server when the object will be imported.",source-file | source-file | source-file | source-file | source-file | source-file,exported workflow job templates refer inventories instead natural key type api endpoint workflow job template provide representation includes natural key related inventory problematic migrating different instances tower summary api endpoint workflow job template provide representation includes natural key related inventory set instead uses numerical problematic attempting export import workflow different instances tower since api attempt use given numerical associate inventory import workflow likely different target instance tower behaviour dangerous target instance tower different inventory numerical warnings raised causing workflow associated wrong template environment tower install method openshift ansible operating system openshift web browser google chrome steps reproduce export workflow job template associated inventory observe value workflow job templates inventory attribut exported yaml expected results reasonable expect following yaml document would generated example workflow job template object yaml workflow job templates allow simultaneous true ask inventory launch false ask limit launch false ask scm branch launch true ask variables launch true description provisioning extra vars inventory name vms type inventory organization name acme type organization limit null name workflow natural key name workflow organization name acme type organization type workflow job template organization name acme type organization related notification templates approvals notification templates notification templates started notification templates success schedules survey spec workflow nodes scm branch null survey enabled false webhook credential null document imported generate association inventory correctly tower expected behaviour relying natural key object instead actual results yaml following generated yaml workflow job templates allow simultaneous true ask inventory launch false ask limit launch false ask scm branch launch true ask variables launch true description provisioning extra vars inventory limit null name workflow natural key name workflow organization name acme type organization type workflow job template organization name acme type organization related notification templates approvals notification templates notification templates started notification templates success schedules survey spec workflow nodes scm branch null survey enabled false webhook credential null notice inventory key value corresponding unique tower server guaranteed target server object imported,bug,0.9,"Exported Workflow Job Templates refer to inventories by id instead of natural key ##### ISSUE TYPE - The API endpoint for a workflow_job_template does not provide a representation that includes the natural key of the related Inventory, which is problematic when migrating it between different instances of AWX/Tower. ##### SUMMARY The API endpoint for a workflow_job_template does not provide a representation that includes the natural key of the related Inventory, if set. Instead, it just uses the numerical `id`, which is problematic when attempting to export and import the workflow between different instances of AWX/Tower, since the API will attempt to use the given numerical `id` to associate an inventory to the import workflow, which will most likely be different on the target instance of AWX/Tower. This behaviour is dangerous because if the target instance of AWX/Tower has a different inventory with the same numerical `id`, no warnings will be raised, causing the workflow to be associated with the wrong template. ##### ENVIRONMENT * AWX version: 3.7.1 (Tower) * AWX install method: openshift * Ansible version: 2.9.9 * Operating System: OpenShift * Web Browser: Google Chrome ##### STEPS TO REPRODUCE 1. Export a `workflow_job_template` that is associated with an inventory 2. Observe the value of the `workflow_job_templates.[].inventory` attribut in the exported YAML. ##### EXPECTED RESULTS It is reasonable to expect that the following YAML document would be generated for an example workflow_job_template object. ```yaml workflow_job_templates: - allow_simultaneous: true ask_inventory_on_launch: false ask_limit_on_launch: false ask_scm_branch_on_launch: true ask_variables_on_launch: true description: My VM provisioning extra_vars: '' inventory: name: my-vms type: inventory organization: name: ACME type: organization limit: null name: my-workflow natural_key: name: my-workflow organization: name: ACME type: organization type: workflow_job_template organization: name: ACME type: organization related: notification_templates_approvals: [] notification_templates_error: [] notification_templates_started: [] notification_templates_success: [] schedules: [] survey_spec: {} workflow_nodes: [] scm_branch: null survey_enabled: false webhook_credential: null ``` The document above, when imported, will generate the association with the inventory correctly on Tower 3.7.1. This is the expected behaviour, relying on the natural key of the object instead of the `id`. ##### ACTUAL RESULTS YAML such as the following is generated: ```yaml workflow_job_templates: - allow_simultaneous: true ask_inventory_on_launch: false ask_limit_on_launch: false ask_scm_branch_on_launch: true ask_variables_on_launch: true description: My VM provisioning extra_vars: '' inventory: 29 limit: null name: my-workflow natural_key: name: my-workflow organization: name: ACME type: organization type: workflow_job_template organization: name: ACME type: organization related: notification_templates_approvals: [] notification_templates_error: [] notification_templates_started: [] notification_templates_success: [] schedules: [] survey_spec: {} workflow_nodes: [] scm_branch: null survey_enabled: false webhook_credential: null ``` Notice that the `inventory` key has the value corresponding to the unique id on the source AWX/Tower server. This is not guaranteed to be the same on the target server when the object will be imported."
4573,awx,https://github.com/ansible/awx/issues/4573,CLI: Need general solution for dictionary-like inputs,"##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> This is a general problem but I'm going to flesh out one particular use case for now: Currently, credential type creation does not accept inputs. New credential types need to have some kind of inputs in order to be of any use. Currently the CLI and APi have conflicting constraints on the `--inputs` flag so there is no way to pass it....at least not that I could figure out. ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> Passing any type of dictionary like thing gets an error from the CLI saying it should be an integer: ``` awx credential_types create --name foo_cred_type1 --kind cloud --inputs=""\{'fields': [\{'id': 'password', 'label':'password', 'secret':true, 'type':'string'\}]\}"" usage: awx credential_types create [-h] --name TEXT [--description TEXT] --kind {net,cloud} [--inputs INPUTS] [--injectors INJECTORS] required arguments: --kind {net,cloud} [REQUIRED] optional arguments: -h, --help show this help message and exit --description TEXT Optional description of this credential type. --inputs INPUTS Enter inputs using either JSON or YAML syntax. Use the radio button to toggle between the two. Refer to the Ansible Tower documentation for example syntax. --injectors INJECTORS Enter injectors using either JSON or YAML syntax. Use the radio button to toggle between the two. Refer to the Ansible Tower documentation for example syntax. required arguments: --name TEXT [REQUIRED] Name of this credential type. awx credential_types create: argument --inputs: invalid int value: ""\\{'fields': [\\{'id': 'password', 'label':'password', 'secret':true, 'type':'string'\\}]\\}"" ``` But if you pass an integer (which makes no sense), you get error from API: ``` awx credential_types create --name foo_cred_type1 --kind cloud --inputs=42 {""inputs"": [""int provided, expected dict""]} ``` ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> Either have reasonable way provide `inputs` to the new credential_type or do not allow creation from command line. This is something we need to consider what a reasonable UX would be for specifying the new credential type inputs.",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file,cli need general solution dictionary like inputs type bug report summary briefly describe general going flesh one particular use case currently credential type creation accept inputs new credential types need kind inputs order use currently cli api conflicting constraints inputs flag way pass least could figure steps reproduce please describe exactly reproduce passing type dictionary like thing gets cli saying integer credential types create name foo cred type kind cloud inputs fields password label password secret true type string usage credential types create name text description text kind cloud inputs inputs injectors injectors required arguments kind cloud required optional arguments help show help message exit description text optional description credential type inputs inputs enter inputs either json yaml syntax use radio button toggle two refer ansible tower documentation example syntax injectors injectors enter injectors either json yaml syntax use radio button toggle two refer ansible tower documentation example syntax required arguments name text required name credential type credential types create argument inputs invalid int value fields password label password secret true type string pass integer makes sense get api credential types create name foo cred type kind cloud inputs inputs int provided expected dict expected results expect happen running steps either reasonable way provide inputs new credential type allow creation command something need consider reasonable would specifying new credential type inputs,bug,0.9,"CLI: Need general solution for dictionary-like inputs ##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> This is a general problem but I'm going to flesh out one particular use case for now: Currently, credential type creation does not accept inputs. New credential types need to have some kind of inputs in order to be of any use. Currently the CLI and APi have conflicting constraints on the `--inputs` flag so there is no way to pass it....at least not that I could figure out. ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> Passing any type of dictionary like thing gets an error from the CLI saying it should be an integer: ``` awx credential_types create --name foo_cred_type1 --kind cloud --inputs=""\{'fields': [\{'id': 'password', 'label':'password', 'secret':true, 'type':'string'\}]\}"" usage: awx credential_types create [-h] --name TEXT [--description TEXT] --kind {net,cloud} [--inputs INPUTS] [--injectors INJECTORS] required arguments: --kind {net,cloud} [REQUIRED] optional arguments: -h, --help show this help message and exit --description TEXT Optional description of this credential type. --inputs INPUTS Enter inputs using either JSON or YAML syntax. Use the radio button to toggle between the two. Refer to the Ansible Tower documentation for example syntax. --injectors INJECTORS Enter injectors using either JSON or YAML syntax. Use the radio button to toggle between the two. Refer to the Ansible Tower documentation for example syntax. required arguments: --name TEXT [REQUIRED] Name of this credential type. awx credential_types create: argument --inputs: invalid int value: ""\\{'fields': [\\{'id': 'password', 'label':'password', 'secret':true, 'type':'string'\\}]\\}"" ``` But if you pass an integer (which makes no sense), you get error from API: ``` awx credential_types create --name foo_cred_type1 --kind cloud --inputs=42 {""inputs"": [""int provided, expected dict""]} ``` ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> Either have reasonable way provide `inputs` to the new credential_type or do not allow creation from command line. This is something we need to consider what a reasonable UX would be for specifying the new credential type inputs."
10123,awx,https://github.com/ansible/awx/issues/10123,AWX 19.1.0 - Job settings cannot be saved (/worker-json.js returns 404),"##### ISSUE TYPE - Bug Report ##### SUMMARY Job settings cannot be saved, probably due to the `worker-json.js` returning 404. ##### ENVIRONMENT * AWX version: 19.1.0 * AWX install method: minikube * OS: Debian * Browser: Chromium: 90.0.4430.93 (Official Build) (64-bit) ##### STEPS TO REPRODUCE - Go the Settings > Jobs settings > Edit - Tweak a setting - Hit Save ##### EXPECTED RESULTS - The settings are saved succesfully ##### ACTUAL RESULTS - The settings never get updated, the save button doesn't do anything ##### ADDITIONAL INFORMATION I am not sure what debug information would help, but I will be happy to provide any if required",documentation-file | documentation-file | documentation-file | other-file | test-file | other-file | test-file | documentation-file | documentation-file | documentation-file | documentation-file,job settings cannot saved worker json returns type bug report summary job settings cannot saved probably due worker json returning environment install method minikube debian browser chromium official bit steps reproduce settings jobs settings edit tweak setting hit save expected results settings saved succesfully actual results settings never get updated save button anything additional information sure information would help happy provide required,bug,0.8,"AWX 19.1.0 - Job settings cannot be saved (/worker-json.js returns 404) ##### ISSUE TYPE - Bug Report ##### SUMMARY Job settings cannot be saved, probably due to the `worker-json.js` returning 404. ##### ENVIRONMENT * AWX version: 19.1.0 * AWX install method: minikube * OS: Debian * Browser: Chromium: 90.0.4430.93 (Official Build) (64-bit) ##### STEPS TO REPRODUCE - Go the Settings > Jobs settings > Edit - Tweak a setting - Hit Save ##### EXPECTED RESULTS - The settings are saved succesfully ##### ACTUAL RESULTS - The settings never get updated, the save button doesn't do anything ##### ADDITIONAL INFORMATION I am not sure what debug information would help, but I will be happy to provide any if required"
5046,awx,https://github.com/ansible/awx/issues/5046,Child WorkflowJob not started when Inventory on WorkflowJobTemplateNode,"##### ISSUE TYPE - Bug Report ##### SUMMARY I have nested workflow templates, when I set Prompt on launch on child workflow template and set Inventory through ""Prompt"" in Workflow visualizer, then Launch is in Running state forever and Workflow job for child Workflow template doesn't exist (is probably deleted, because there is missing ID in list of Jobs) ##### ENVIRONMENT * AWX version: Tower 3.5.0 * AWX install method: AMI - https://www.ansible.com/products/tower/trial - Tower in Amazon EC2 * Ansible version: 2.8.0 * Operating System: * Web Browser: Google Chrome 77.0.3865.120 ##### STEPS TO REPRODUCE Child Workflow template contains: - No inventory, Prompt on launch - Job Template with https://github.com/mkanoor/playbook/blob/master/hello_world.yml - No inventory, Prompt on launch - Workflow Job Template Node with Inventory1 (added through ""Prompt"" button in Workflow visualizer) Parent Workflow template contains: - No inventory - Child workflow - (No inventory, Prompt on Launch) - Workflow Job Template Node with Inventory2 (added through ""Prompt"" button in Workflow visualizer) ``` Parent Workflow (without Inventory) (Start) ==> (Inventory2 on Workflow Node) ==> [ Child Workflow (without Inventory, Prompt on Launch) => (Start) ==> (Inventory1 on Workflow Node) ==> Job Template with Prompt on Launch ] ``` ##### EXPECTED RESULTS Job Template should be successfully finished (I suppose with Inventory2?) ##### ACTUAL RESULTS Parent workflow job Status = Running forever Child workflow job doesn't exist (probably deleted, one ID in Jobs is missing) API: (the only node) in `api/workflow_jobs/<parent_workflow_id>/workflow_nodes` doesn't have `/summary_fields/job`, also `/related/job` doesn't exist. But there are `/summary_fields/inventory` and `/related/inventory`. Parent workflow doesn't have inventory In another case that Parent workflow has inventory and workflow node doesn't have, then `/summary_fields/job` and `/related/job` links exist and point to child workflow. ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->",other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | other-file,child workflowjob started inventory workflowjobtemplatenode type bug report summary nested workflow templates set prompt launch child workflow template set inventory prompt workflow visualizer launch running state forever workflow job child workflow template exist probably deleted missing list jobs environment tower install method ami https www ansible products tower trial tower amazon ansible operating system web browser google chrome steps reproduce child workflow template contains inventory prompt launch job template https github mkanoor playbook blob hello world yml inventory prompt launch workflow job template node inventory added prompt button workflow visualizer parent workflow template contains inventory child workflow inventory prompt launch workflow job template node inventory added prompt button workflow visualizer parent workflow without inventory start inventory workflow node child workflow without inventory prompt launch start inventory workflow node job template prompt launch expected results job template successfully finished suppose inventory actual results parent workflow job status running forever child workflow job exist probably deleted one jobs missing api node api workflow jobs parent workflow workflow nodes summary fields job also related job exist summary fields inventory related inventory parent workflow inventory another case parent workflow inventory workflow node summary fields job related job links exist point child workflow additional information include links sosreport database dumps screenshots information,bug,0.9,"Child WorkflowJob not started when Inventory on WorkflowJobTemplateNode ##### ISSUE TYPE - Bug Report ##### SUMMARY I have nested workflow templates, when I set Prompt on launch on child workflow template and set Inventory through ""Prompt"" in Workflow visualizer, then Launch is in Running state forever and Workflow job for child Workflow template doesn't exist (is probably deleted, because there is missing ID in list of Jobs) ##### ENVIRONMENT * AWX version: Tower 3.5.0 * AWX install method: AMI - https://www.ansible.com/products/tower/trial - Tower in Amazon EC2 * Ansible version: 2.8.0 * Operating System: * Web Browser: Google Chrome 77.0.3865.120 ##### STEPS TO REPRODUCE Child Workflow template contains: - No inventory, Prompt on launch - Job Template with https://github.com/mkanoor/playbook/blob/master/hello_world.yml - No inventory, Prompt on launch - Workflow Job Template Node with Inventory1 (added through ""Prompt"" button in Workflow visualizer) Parent Workflow template contains: - No inventory - Child workflow - (No inventory, Prompt on Launch) - Workflow Job Template Node with Inventory2 (added through ""Prompt"" button in Workflow visualizer) ``` Parent Workflow (without Inventory) (Start) ==> (Inventory2 on Workflow Node) ==> [ Child Workflow (without Inventory, Prompt on Launch) => (Start) ==> (Inventory1 on Workflow Node) ==> Job Template with Prompt on Launch ] ``` ##### EXPECTED RESULTS Job Template should be successfully finished (I suppose with Inventory2?) ##### ACTUAL RESULTS Parent workflow job Status = Running forever Child workflow job doesn't exist (probably deleted, one ID in Jobs is missing) API: (the only node) in `api/workflow_jobs/<parent_workflow_id>/workflow_nodes` doesn't have `/summary_fields/job`, also `/related/job` doesn't exist. But there are `/summary_fields/inventory` and `/related/inventory`. Parent workflow doesn't have inventory In another case that Parent workflow has inventory and workflow node doesn't have, then `/summary_fields/job` and `/related/job` links exist and point to child workflow. ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->"
11505,awx,https://github.com/ansible/awx/issues/11505,Cannot create manual project in Japanese (possibly all non-English languages),### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary _No response_ ### AWX version 19.5.0 ### Installation method docker for mac ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce 1. Compile strings 2. Start up AWX 3. Set default browser language to Japanese (UI should now render in Japanese for translated strings) 4. Attempt to create a manual project ### Expected results A manual project is created ### Actual results Project creation fails ### Additional information I suspect that we are sending the translated string back to the API rather than `manual` which is what it is expecting.,source-file | source-file | source-file,cannot create manual project japanese possibly non english languages please confirm following agree follow project conduct http docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free entitled status updates assurances summary response installation method docker mac modifications ansible response operating system response web browser response steps reproduce compile strings start set default browser language japanese render japanese translated strings attempt create manual project expected results manual project created actual results project creation fails additional information suspect sending translated string back api rather manual expecting,bug,0.9,Cannot create manual project in Japanese (possibly all non-English languages) ### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary _No response_ ### AWX version 19.5.0 ### Installation method docker for mac ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce 1. Compile strings 2. Start up AWX 3. Set default browser language to Japanese (UI should now render in Japanese for translated strings) 4. Attempt to create a manual project ### Expected results A manual project is created ### Actual results Project creation fails ### Additional information I suspect that we are sending the translated string back to the API rather than `manual` which is what it is expecting.
8305,awx,https://github.com/ansible/awx/issues/8305,500 error when attempting to delete workflow approval,"##### ISSUE TYPE - Bug Report ##### SUMMARY ![delete_wf_approval](https://user-images.githubusercontent.com/9889020/94853438-67e91280-03f9-11eb-9233-63c15e611f70.gif) I haven't tried this with a pending workflow approval but I suspect it would yield the same result. We don't have an interface that interacts with this endpoint in the UI so maybe this has been around for a while? I'm exploring adding an interface for listing out _all_ workflow approvals so that a user could go back and see who approved/denied what in the past. This interface will support deletion if the API allows it. ##### STEPS TO REPRODUCE 1) Create a workflow with an approval step 2) Launch workflow 3) Approve step 4) Attempt to delete workflow approval via API ##### EXPECTED RESULTS Successful delete ##### ACTUAL RESULTS 500 error ``` Request Method: | DELETE -- | -- https://localhost:8043/api/v2/workflow_approvals/3/ 2.2.16 AttributeError 'NoneType' object has no attribute 'objects' ./awx/main/models/unified_jobs.py in get_event_queryset, line 994 /venv/awx/bin/uwsgi 3.6.8 ['/venv/awx/lib/python3.6/site-packages/git/ext/gitdb', '.', '', '/venv/awx/lib64/python36.zip', '/venv/awx/lib64/python3.6', '/venv/awx/lib64/python3.6/lib-dynload', '/usr/lib64/python3.6', '/usr/lib/python3.6', '/venv/awx/lib/python3.6/site-packages', '/venv/awx/lib/python3.6/site-packages/gitdb/ext/smmap'] Thu, 1 Oct 2020 19:17:11 +0000 ```",source-file,attempting delete workflow approval type bug report summary delete approval https user images githubusercontent gif tried pending workflow approval suspect would yield result interface interacts endpoint maybe around exploring adding interface listing workflow approvals user could back see approved denied past interface deletion api allows steps reproduce create workflow approval step launch workflow approve step attempt delete workflow approval via api expected results successful delete actual results method delete https localhost api workflow approvals attributeerror nonetype object attribute objects models unified jobs get event queryset venv uwsgi venv python site packages git ext gitdb venv python zip venv python venv python dynload python python venv python site packages venv python site packages gitdb ext smmap oct,bug,0.95,"500 error when attempting to delete workflow approval ##### ISSUE TYPE - Bug Report ##### SUMMARY ![delete_wf_approval](https://user-images.githubusercontent.com/9889020/94853438-67e91280-03f9-11eb-9233-63c15e611f70.gif) I haven't tried this with a pending workflow approval but I suspect it would yield the same result. We don't have an interface that interacts with this endpoint in the UI so maybe this has been around for a while? I'm exploring adding an interface for listing out _all_ workflow approvals so that a user could go back and see who approved/denied what in the past. This interface will support deletion if the API allows it. ##### STEPS TO REPRODUCE 1) Create a workflow with an approval step 2) Launch workflow 3) Approve step 4) Attempt to delete workflow approval via API ##### EXPECTED RESULTS Successful delete ##### ACTUAL RESULTS 500 error ``` Request Method: | DELETE -- | -- https://localhost:8043/api/v2/workflow_approvals/3/ 2.2.16 AttributeError 'NoneType' object has no attribute 'objects' ./awx/main/models/unified_jobs.py in get_event_queryset, line 994 /venv/awx/bin/uwsgi 3.6.8 ['/venv/awx/lib/python3.6/site-packages/git/ext/gitdb', '.', '', '/venv/awx/lib64/python36.zip', '/venv/awx/lib64/python3.6', '/venv/awx/lib64/python3.6/lib-dynload', '/usr/lib64/python3.6', '/usr/lib/python3.6', '/venv/awx/lib/python3.6/site-packages', '/venv/awx/lib/python3.6/site-packages/gitdb/ext/smmap'] Thu, 1 Oct 2020 19:17:11 +0000 ```"
4492,awx,https://github.com/ansible/awx/issues/4492,API/SDK configure CUSTOM_LOGO doesn't take affect,"##### ISSUE TYPE - Bug Report ##### SUMMARY When utilizing the UI, one can head to Settings/UI and upload an image file. This ""replaces"" the Image file on the login screen. One can also view this image in a ""data:url"" format at api/v2/settings/ui CUSTOM_LOGO: ""data:image/png;base64,Base64EncodedStringhere="" Attempting the same via the API or tower-cli (example below) produces no ""error"" and updates the CUSTOM_LOGO attribute properly when viewed in the API, but doesn't actually ""take effect"" in that the logo is not actually changed at login. ##### ENVIRONMENT * AWX version: 6.1.0 * AWX install method: openshift * Ansible version: Whatever comes built-in with 6.1.0's ansible virtualenv * Operating System: Openshift 3.11 running on RHEL 7.6 * Web Browser: Firefox ##### STEPS TO REPRODUCE Reproduce using the tower-cli: ``` with open(""/path/to/a/png/file.png, 'rb') as logofile: logo_64_encode = base64.b64encode(logofile.read()).decode() created_data_url = 'data:image/png;base64,{}'.format(logo_64_encode) # Placeholder: Setup AWX auth - however you do it since there's 10,000 ways # Set a bunch of other settings as examples - these all WORK FINE # Assuming you have some valid data in login_message and custom_venv_paths variables settings_resource.modify('CUSTOM_LOGIN_INFO', login_message) settings_resource.modify('CUSTOM_VENV_PATHS', json.dumps(custom_venv_paths)) # Setup AWX Custom Logo using above data:url - this shows a successful return and updates CUSTOM_LOGO - but never displays settings_resource.modify('CUSTOM_LOGO', created_data_url) ``` ##### EXPECTED RESULTS if the tower-cli call succeeded (no errors) an i can see the encoded data:url in CUSTOM_LOGO - i would expect a Custom Image to be displayed at the login prompt. ##### ACTUAL RESULTS No image is displayed. Uploading the same image via the UI's ""browse"" option causes it to display immediately, same apparent data:url object written to CUSTOM_LOGO ##### ADDITIONAL INFORMATION N/A",source-file,api sdk configure custom logo take affect type bug report summary utilizing one head settings upload image replaces image login screen one also view image data url format api settings custom logo data image png base base encodedstringhere attempting via api tower cli example produces updates custom logo attribute properly viewed api actually take effect logo actually changed login environment install method openshift ansible whatever comes built ansible virtualenv operating system openshift running rhel web browser firefox steps reproduce reproduce tower cli open path png png logofile logo encode base encode logofile read decode created data url data image png base format logo encode placeholder setup auth however since ways set bunch settings examples work fine assuming valid data login message custom venv paths variables settings resource modify custom login login message settings resource modify custom venv paths json dumps custom venv paths setup custom logo data url shows successful return updates custom logo never displays settings resource modify custom logo created data url expected results tower cli call succeeded errors see encoded data url custom logo would expect custom image displayed login prompt actual results image displayed uploading image via browse option causes display immediately apparent data url object written custom logo additional information,bug,0.9,"API/SDK configure CUSTOM_LOGO doesn't take affect ##### ISSUE TYPE - Bug Report ##### SUMMARY When utilizing the UI, one can head to Settings/UI and upload an image file. This ""replaces"" the Image file on the login screen. One can also view this image in a ""data:url"" format at api/v2/settings/ui CUSTOM_LOGO: ""data:image/png;base64,Base64EncodedStringhere="" Attempting the same via the API or tower-cli (example below) produces no ""error"" and updates the CUSTOM_LOGO attribute properly when viewed in the API, but doesn't actually ""take effect"" in that the logo is not actually changed at login. ##### ENVIRONMENT * AWX version: 6.1.0 * AWX install method: openshift * Ansible version: Whatever comes built-in with 6.1.0's ansible virtualenv * Operating System: Openshift 3.11 running on RHEL 7.6 * Web Browser: Firefox ##### STEPS TO REPRODUCE Reproduce using the tower-cli: ``` with open(""/path/to/a/png/file.png, 'rb') as logofile: logo_64_encode = base64.b64encode(logofile.read()).decode() created_data_url = 'data:image/png;base64,{}'.format(logo_64_encode) # Placeholder: Setup AWX auth - however you do it since there's 10,000 ways # Set a bunch of other settings as examples - these all WORK FINE # Assuming you have some valid data in login_message and custom_venv_paths variables settings_resource.modify('CUSTOM_LOGIN_INFO', login_message) settings_resource.modify('CUSTOM_VENV_PATHS', json.dumps(custom_venv_paths)) # Setup AWX Custom Logo using above data:url - this shows a successful return and updates CUSTOM_LOGO - but never displays settings_resource.modify('CUSTOM_LOGO', created_data_url) ``` ##### EXPECTED RESULTS if the tower-cli call succeeded (no errors) an i can see the encoded data:url in CUSTOM_LOGO - i would expect a Custom Image to be displayed at the login prompt. ##### ACTUAL RESULTS No image is displayed. Uploading the same image via the UI's ""browse"" option causes it to display immediately, same apparent data:url object written to CUSTOM_LOGO ##### ADDITIONAL INFORMATION N/A"
6464,awx,https://github.com/ansible/awx/issues/6464,Survey multiple choice options need improvements and error handling,"##### ISSUE TYPE - Bug Report ##### SUMMARY From https://github.com/ansible/awx/issues/5900#issuecomment-605008285: cc @keithjgrant > Both add and edit forms for JT surveys need some way of clarifying how to format single-select and multi-select options. It is trivial to create modal-overlay 400 errors with the basic input textbox given, and these 400 errors do not provide any useful information to the end user. ##### STEPS TO REPRODUCE Put bad input into a job template survey with either single or multi-select. semicolons in random spots, etc, in an attempt to break it. some things work, some don't. ##### EXPECTED RESULTS Form validation on submission that keeps you on the form page, indicating formatting errors or something similar when met with a 400 error. I would also like information around the box about how to format the survey. ##### ACTUAL RESULTS 400 that takes you back to the survey list, no further information about the error.",other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | test-file | other-file | other-file | other-file | test-file | source-file,survey multiple choice options need improvements handling type bug report summary https github ansible issues issuecomment keithjgrant edit forms surveys need way clarifying format single select multi select options trivial create modal overlay errors basic input textbox given errors provide useful information end user steps reproduce put bad input job template survey either single multi select semicolons random spots etc attempt break things work expected results form validation submission keeps form page indicating formatting errors something similar met would also like information around box format survey actual results takes back survey list information,bug,0.9,"Survey multiple choice options need improvements and error handling ##### ISSUE TYPE - Bug Report ##### SUMMARY From https://github.com/ansible/awx/issues/5900#issuecomment-605008285: cc @keithjgrant > Both add and edit forms for JT surveys need some way of clarifying how to format single-select and multi-select options. It is trivial to create modal-overlay 400 errors with the basic input textbox given, and these 400 errors do not provide any useful information to the end user. ##### STEPS TO REPRODUCE Put bad input into a job template survey with either single or multi-select. semicolons in random spots, etc, in an attempt to break it. some things work, some don't. ##### EXPECTED RESULTS Form validation on submission that keeps you on the form page, indicating formatting errors or something similar when met with a 400 error. I would also like information around the box about how to format the survey. ##### ACTUAL RESULTS 400 that takes you back to the survey list, no further information about the error."
5099,awx,https://github.com/ansible/awx/issues/5099,Default for webhook_service is not in field choices and not accepted,"##### ISSUE TYPE - Bug Report ##### SUMMARY The OPTIONS for job_templates is not self-consistent for the field `webhook_service`. This breaks the `tower-cli send` command, assuming the data comes from the receive command. A hack is in progress for this, but it would be better to change behavior from API moving forward. ##### ENVIRONMENT * AWX version: 8.0.0 * AWX install method: N/A * Ansible version: N/A * Operating System: * Web Browser: ##### STEPS TO REPRODUCE Of particular interest here is the sequence of `tower-cli receive`, saving that to a file, and using it in `tower-cli send`. ##### EXPECTED RESULTS Data given from the API is consistent with OPTIONS ##### ACTUAL RESULTS OPTIONS for job_templates gives ```json ""webhook_service"": { ""type"": ""choice"", ""label"": ""Webhook service"", ""help_text"": ""Service that webhook requests will be accepted from"", ""filterable"": true, ""choices"": [ [ ""github"", ""GitHub"" ], [ ""gitlab"", ""GitLab"" ] ] ``` The receive command always gives `webhook_credential` in the asset data because it has no default. Without a default, it cannot be determined if the field has been set. The send command gives ``` JOB TEMPLATE [SRtest] *************************************************************************************************************************************************************** Value is not a valid choice for option webhook_service for job_template SRtest. Options: ['github', 'GitHub', 'gitlab', 'GitLab'] ``` ##### ADDITIONAL INFORMATION https://github.com/ansible/tower-cli/pull/741 Ping @jbradberry, @john-westcott-iv In terms of CLI design in general, @ryanpetrello I find the ability to determine if a field has a non-default value is a powerful tool. This is one of the things I most like about the send/receive commands. I would even prefer that for compact representations of resources for human consumption.",source-file,default webhook service field choices accepted type bug report summary options job templates self consistent field webhook service breaks tower cli send command assuming data comes receive command hack progress would better behavior api moving forward environment install method ansible operating system web browser steps reproduce particular interest sequence tower cli receive saving tower cli send expected results data given api consistent options actual results options job templates gives json webhook service type choice label webhook service help text service webhook requests accepted filterable true choices github github gitlab gitlab receive command always gives webhook credential asset data default without default cannot determined field set send command gives job template srtest value valid choice option webhook service job template srtest options github github gitlab gitlab additional information https github ansible tower cli ping jbradberry john westcott terms cli design general ryanpetrello find ability determine field non default value powerful tool one things like send receive commands would even prefer compact representations resources human consumption,bug,0.9,"Default for webhook_service is not in field choices and not accepted ##### ISSUE TYPE - Bug Report ##### SUMMARY The OPTIONS for job_templates is not self-consistent for the field `webhook_service`. This breaks the `tower-cli send` command, assuming the data comes from the receive command. A hack is in progress for this, but it would be better to change behavior from API moving forward. ##### ENVIRONMENT * AWX version: 8.0.0 * AWX install method: N/A * Ansible version: N/A * Operating System: * Web Browser: ##### STEPS TO REPRODUCE Of particular interest here is the sequence of `tower-cli receive`, saving that to a file, and using it in `tower-cli send`. ##### EXPECTED RESULTS Data given from the API is consistent with OPTIONS ##### ACTUAL RESULTS OPTIONS for job_templates gives ```json ""webhook_service"": { ""type"": ""choice"", ""label"": ""Webhook service"", ""help_text"": ""Service that webhook requests will be accepted from"", ""filterable"": true, ""choices"": [ [ ""github"", ""GitHub"" ], [ ""gitlab"", ""GitLab"" ] ] ``` The receive command always gives `webhook_credential` in the asset data because it has no default. Without a default, it cannot be determined if the field has been set. The send command gives ``` JOB TEMPLATE [SRtest] *************************************************************************************************************************************************************** Value is not a valid choice for option webhook_service for job_template SRtest. Options: ['github', 'GitHub', 'gitlab', 'GitLab'] ``` ##### ADDITIONAL INFORMATION https://github.com/ansible/tower-cli/pull/741 Ping @jbradberry, @john-westcott-iv In terms of CLI design in general, @ryanpetrello I find the ability to determine if a field has a non-default value is a powerful tool. This is one of the things I most like about the send/receive commands. I would even prefer that for compact representations of resources for human consumption."
6332,awx,https://github.com/ansible/awx/issues/6332,Getting a 400 error when Credential Add/Edit has an invalid SSH Private Key field,"##### ISSUE TYPE - Bug Report ##### SUMMARY When a invalid SSH Private Key is specified, getting a 400 error instead of an error under the field that the value is invalid ##### STEPS TO REPRODUCE 1. Add/Edit a credential 2. select any of the credential type 2. Enter an invalid value for the SSH Private Key ##### EXPECTED RESULTS It should say that the value is invalid under the field ##### ACTUAL RESULTS Getting a 400 error ![Screen Shot 2020-03-18 at 1 19 38 PM](https://user-images.githubusercontent.com/11617351/76988490-255b5f00-691b-11ea-848a-8c48233e987b.png)",source-file,getting credential edit invalid ssh private key field type bug report summary invalid ssh private key specified getting instead field value invalid steps reproduce edit credential select credential type enter invalid value ssh private key expected results say value invalid field actual results getting screen shot https user images githubusercontent png,bug,0.9,"Getting a 400 error when Credential Add/Edit has an invalid SSH Private Key field ##### ISSUE TYPE - Bug Report ##### SUMMARY When a invalid SSH Private Key is specified, getting a 400 error instead of an error under the field that the value is invalid ##### STEPS TO REPRODUCE 1. Add/Edit a credential 2. select any of the credential type 2. Enter an invalid value for the SSH Private Key ##### EXPECTED RESULTS It should say that the value is invalid under the field ##### ACTUAL RESULTS Getting a 400 error ![Screen Shot 2020-03-18 at 1 19 38 PM](https://user-images.githubusercontent.com/11617351/76988490-255b5f00-691b-11ea-848a-8c48233e987b.png)"
9441,awx,https://github.com/ansible/awx/issues/9441,Advanced search for type returns 400,"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY Trying to do an advanced search by `type` the results are always `ExecutionEnvironment has no field named 'type'`: ![image](https://user-images.githubusercontent.com/12464858/109544586-83d70a00-7aa6-11eb-994c-dedcbce8801a.png)",source-file | source-file | source-file | source-file,advanced search type returns issues concrete actionable bugs feature requests asking debugging help technical please use http webchat freenode channels ansible https groups google forum forum project limit limited volunteer time respond issues type bug report summary trying advanced search type results always executionenvironment field named type image https user images githubusercontent dedcbce png,bug,0.9,"Advanced search for type returns 400 <!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY Trying to do an advanced search by `type` the results are always `ExecutionEnvironment has no field named 'type'`: ![image](https://user-images.githubusercontent.com/12464858/109544586-83d70a00-7aa6-11eb-994c-dedcbce8801a.png)"
4943,awx,https://github.com/ansible/awx/issues/4943,System Auditor is unable to view Container Groups,##### ISSUE TYPE - Bug Report ##### SUMMARY System Auditor is unable to view Container Groups ##### ENVIRONMENT * AWX version: 7.0.0 ##### STEPS TO REPRODUCE 1. Create Container Group 2. Log in as System Auditor 3. Attempt to view a container group ##### EXPECTED RESULTS Able to view container group like an instance group ##### ACTUAL RESULTS Unable to view container group ##### ADDITIONAL INFORMATION ![Screen Shot 2019-10-08 at 5 32 17 PM](https://user-images.githubusercontent.com/12446869/66435218-5c375b80-e9f2-11e9-8abb-0be7ba30ad30.png),source-file,system auditor unable view container groups type bug report summary system auditor unable view container groups environment steps reproduce create container group log system auditor attempt view container group expected results able view container group like instance group actual results unable view container group additional information screen shot https user images githubusercontent abb png,bug,0.85,System Auditor is unable to view Container Groups ##### ISSUE TYPE - Bug Report ##### SUMMARY System Auditor is unable to view Container Groups ##### ENVIRONMENT * AWX version: 7.0.0 ##### STEPS TO REPRODUCE 1. Create Container Group 2. Log in as System Auditor 3. Attempt to view a container group ##### EXPECTED RESULTS Able to view container group like an instance group ##### ACTUAL RESULTS Unable to view container group ##### ADDITIONAL INFORMATION ![Screen Shot 2019-10-08 at 5 32 17 PM](https://user-images.githubusercontent.com/12446869/66435218-5c375b80-e9f2-11e9-8abb-0be7ba30ad30.png)
8202,awx,https://github.com/ansible/awx/issues/8202,Launching job with vault password 400s when default machine cred is replaced,"##### ISSUE TYPE - Bug Report ##### SUMMARY Really odd behavior that I came across while building out credential prompting in the new UI. This can be reproduced via the API browser though. I created a JT with a default machine credential (that prompted for some passwords) and a default vault credential (that prompted for password). If I swap the machine credential for one that does not prompt for a password then the API responds with a 400 on launch complaining about the vault password: `{""passwords_needed_to_start"":[""vault_password.A""]}` In the example below credential with ID = 1 is the machine credential that prompts for ssh and become passwords. Credential ID = 2 is the machine credential that does not prompt for passwords. Credential ID = 4 is the vault credential that prompts for password. A normal launch without changing credentials: ![good_launch](https://user-images.githubusercontent.com/9889020/93922608-26ad8000-fce0-11ea-8b61-8604ec329d83.gif) A launch where I change the machine credential: ![bad_launch](https://user-images.githubusercontent.com/9889020/93922684-493f9900-fce0-11ea-93a5-891b46041a13.gif)",source-file | test-file | source-file | test-file | source-file | test-file,launching job vault password default machine cred replaced type bug report summary really odd behavior came across building credential prompting new reproduced via api browser though created default machine credential prompted passwords default vault credential prompted password swap machine credential one prompt password api responds launch complaining vault password passwords needed start vault password example credential machine credential prompts ssh become passwords credential machine credential prompt passwords credential vault credential prompts password normal launch without changing credentials good launch https user images githubusercontent fce gif launch machine credential bad launch https user images githubusercontent fce gif,bug,0.9,"Launching job with vault password 400s when default machine cred is replaced ##### ISSUE TYPE - Bug Report ##### SUMMARY Really odd behavior that I came across while building out credential prompting in the new UI. This can be reproduced via the API browser though. I created a JT with a default machine credential (that prompted for some passwords) and a default vault credential (that prompted for password). If I swap the machine credential for one that does not prompt for a password then the API responds with a 400 on launch complaining about the vault password: `{""passwords_needed_to_start"":[""vault_password.A""]}` In the example below credential with ID = 1 is the machine credential that prompts for ssh and become passwords. Credential ID = 2 is the machine credential that does not prompt for passwords. Credential ID = 4 is the vault credential that prompts for password. A normal launch without changing credentials: ![good_launch](https://user-images.githubusercontent.com/9889020/93922608-26ad8000-fce0-11ea-8b61-8604ec329d83.gif) A launch where I change the machine credential: ![bad_launch](https://user-images.githubusercontent.com/9889020/93922684-493f9900-fce0-11ea-93a5-891b46041a13.gif)"
9373,awx,https://github.com/ansible/awx/issues/9373,[ui_next] Silent error when creating or editing an inventory source to 'Update on launch' and 'Update on project update',"##### ISSUE TYPE - Bug Report ##### SUMMARY When creating or editing an inventory which is sourced from a project, if the 'Update on launch' and 'Update on project update' options are selected, the form does not save and the API's error response does not get displayed in the UI. ``` {""update_on_launch"":[""Cannot update SCM-based inventory source on launch if set to update on project update. Instead, configure the corresponding source project to update on launch.""]} ``` I think the fix for this should be two parts: 1. Update the tooltips for both toggles to note that they cannot be used simultaneously 2. Surface API errors to user on save, generally. ##### STEPS TO REPRODUCE 1. Create an Inventory with type 'Sourced from a Project' 2. Select both 'Update on launch' or 'Update on project update' 3. Save Note: error in console",other-file | test-file | other-file,next silent creating editing inventory launch project type bug report summary creating editing inventory sourced project launch project options selected form save api response get displayed launch cannot scm based inventory launch set project instead configure corresponding project launch think two parts tooltips toggles note cannot used simultaneously surface api errors user save generally steps reproduce create inventory type sourced project select launch project save note console,bug,0.9,"[ui_next] Silent error when creating or editing an inventory source to 'Update on launch' and 'Update on project update' ##### ISSUE TYPE - Bug Report ##### SUMMARY When creating or editing an inventory which is sourced from a project, if the 'Update on launch' and 'Update on project update' options are selected, the form does not save and the API's error response does not get displayed in the UI. ``` {""update_on_launch"":[""Cannot update SCM-based inventory source on launch if set to update on project update. Instead, configure the corresponding source project to update on launch.""]} ``` I think the fix for this should be two parts: 1. Update the tooltips for both toggles to note that they cannot be used simultaneously 2. Surface API errors to user on save, generally. ##### STEPS TO REPRODUCE 1. Create an Inventory with type 'Sourced from a Project' 2. Select both 'Update on launch' or 'Update on project update' 3. Save Note: error in console"
6630,awx,https://github.com/ansible/awx/issues/6630,refresh token does not expire,"##### ISSUE TYPE - Bug Report ##### SUMMARY Using password grant type, refresh token does not expire according to `REFRESH_TOKEN_EXPIRE_SECONDS`. ##### ENVIRONMENT * AWX version: 10.0.0 * AWX install method: docker on linux * Operating System: CentOS v8 * Web Browser: Chrome ##### STEPS TO REPRODUCE Set the expiry times low from AWX GUI > Settings > System Confirm the settings from api ``` https://x.x.x.x/api/v2/settings/all/ ``` ``` ""OAUTH2_PROVIDER"": { ""ACCESS_TOKEN_EXPIRE_SECONDS"": 10, ""REFRESH_TOKEN_EXPIRE_SECONDS"": 10, ""AUTHORIZATION_CODE_EXPIRE_SECONDS"": 600 }, ``` Create an Application from the GUI of Authorization Grant Type `Resource owner password-based`. Save a copy of the `clientId` and `clientSecret`. Create the access and refresh tokens using password grant: ```bash curl -v -k -X POST -d \ ""grant_type=password&username=someuser&password=somepassword&scope=read"" \ -u ""clientId:clientSecret"" https://x.x.x.x/api/o/token/ -i ``` Which returns ```json {""access_token"": ""Ma5cLFKYs1Q8iknITJjAe0VXJyiUVP"", ""expires_in"": 10, ""token_type"": ""Bearer"", ""scope"": ""read"", ""refresh_token"": ""IymTfQp0JtT3HtDUitoAj7eaxXr3zM""} ``` Wait at least 20 seconds and try use refresh token ``` curl -k -X POST -d \ ""grant_type=refresh_token&refresh_token=IymTfQp0JtT3HtDUitoAj7eaxXr3zM"" \ -u ""clientId:clientSecret"" https://x.x.x.x/api/o/token/ -i ``` That previous refresh token continues to generate new `access_token` and new `refresh_token` after 20 seconds. Even after I waited 12 hours it still worked. I also tried manually adding the settings to `/etc/tower/settings.py` of the docker container. ``` OAUTH2_PROVIDER = {'ACCESS_TOKEN_EXPIRE_SECONDS': 10, 'REFRESH_TOKEN_EXPIRE_SECONDS': 10, 'AUTHORIZATION_CODE_EXPIRE_SECONDS': 600} ``` and restarting the container. ##### EXPECTED RESULTS The refresh token should have failed to generate a new access token and returned an error message after more than 10 + 10 seconds. ##### ACTUAL RESULTS The last refresh token still generates a new `access_token` and new `refresh_token` after 20 seconds. I waited 12 hours and the last generated refresh token still works. So it appears to ignore the refresh token expiry time. #### ADDITIONAL INFO Should the refresh token stay the same each time it is used? Current behavior is that a new refresh token is generated each time it is used. The previous one no longer works. So the way it works currently, refresh tokens are one-time use only.",source-file | source-file | source-file | source-file | test-file | source-file | test-file | source-file | test-file,refresh token expire type bug report summary password grant type refresh token expire according refresh token expire seconds environment install method docker linux operating system centos web browser chrome steps reproduce set expiry times low gui settings system confirm settings api https api settings oauth provider access token expire seconds refresh token expire seconds authorization expire seconds create application gui authorization grant type resource owner password based save copy clientid clientsecret create access refresh tokens password grant bash curl post grant type password username someuser password somepassword scope read clientid clientsecret https api token returns json access token clfkys iknitjjae vxjyiuvp expires token type bearer scope read refresh token iymtfqp jtt htduitoaj eaxxr wait least seconds use refresh token curl post grant type refresh token refresh token iymtfqp jtt htduitoaj eaxxr clientid clientsecret https api token previous refresh token continues generate new access token new refresh token seconds even waited hours still worked also tried manually adding settings etc tower settings docker container oauth provider access token expire seconds refresh token expire seconds authorization expire seconds restarting container expected results refresh token failed generate new access token returned message seconds actual results last refresh token still generates new access token new refresh token seconds waited hours last generated refresh token still works appears ignore refresh token expiry time additional refresh token stay time used current behavior new refresh token generated time used previous one longer works way works currently refresh tokens one time use,bug,0.95,"refresh token does not expire ##### ISSUE TYPE - Bug Report ##### SUMMARY Using password grant type, refresh token does not expire according to `REFRESH_TOKEN_EXPIRE_SECONDS`. ##### ENVIRONMENT * AWX version: 10.0.0 * AWX install method: docker on linux * Operating System: CentOS v8 * Web Browser: Chrome ##### STEPS TO REPRODUCE Set the expiry times low from AWX GUI > Settings > System Confirm the settings from api ``` https://x.x.x.x/api/v2/settings/all/ ``` ``` ""OAUTH2_PROVIDER"": { ""ACCESS_TOKEN_EXPIRE_SECONDS"": 10, ""REFRESH_TOKEN_EXPIRE_SECONDS"": 10, ""AUTHORIZATION_CODE_EXPIRE_SECONDS"": 600 }, ``` Create an Application from the GUI of Authorization Grant Type `Resource owner password-based`. Save a copy of the `clientId` and `clientSecret`. Create the access and refresh tokens using password grant: ```bash curl -v -k -X POST -d \ ""grant_type=password&username=someuser&password=somepassword&scope=read"" \ -u ""clientId:clientSecret"" https://x.x.x.x/api/o/token/ -i ``` Which returns ```json {""access_token"": ""Ma5cLFKYs1Q8iknITJjAe0VXJyiUVP"", ""expires_in"": 10, ""token_type"": ""Bearer"", ""scope"": ""read"", ""refresh_token"": ""IymTfQp0JtT3HtDUitoAj7eaxXr3zM""} ``` Wait at least 20 seconds and try use refresh token ``` curl -k -X POST -d \ ""grant_type=refresh_token&refresh_token=IymTfQp0JtT3HtDUitoAj7eaxXr3zM"" \ -u ""clientId:clientSecret"" https://x.x.x.x/api/o/token/ -i ``` That previous refresh token continues to generate new `access_token` and new `refresh_token` after 20 seconds. Even after I waited 12 hours it still worked. I also tried manually adding the settings to `/etc/tower/settings.py` of the docker container. ``` OAUTH2_PROVIDER = {'ACCESS_TOKEN_EXPIRE_SECONDS': 10, 'REFRESH_TOKEN_EXPIRE_SECONDS': 10, 'AUTHORIZATION_CODE_EXPIRE_SECONDS': 600} ``` and restarting the container. ##### EXPECTED RESULTS The refresh token should have failed to generate a new access token and returned an error message after more than 10 + 10 seconds. ##### ACTUAL RESULTS The last refresh token still generates a new `access_token` and new `refresh_token` after 20 seconds. I waited 12 hours and the last generated refresh token still works. So it appears to ignore the refresh token expiry time. #### ADDITIONAL INFO Should the refresh token stay the same each time it is used? Current behavior is that a new refresh token is generated each time it is used. The previous one no longer works. So the way it works currently, refresh tokens are one-time use only."
13429,awx,https://github.com/ansible/awx/issues/13429,admin_role disassociated despite remove_admins = false,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary After upgrading from AWX 21.5.1 to 21.10.2 all organization admin roles were removed from the users' accounts. We're using LDAP with an organization map looking like this: ``` { ""Org1"": { ""admins"": false, ""remove_admins"": false, ""remove_users"": true, ""users"": [ ""CN=..."" ] } } ``` Users were manually granted the organization admin role. That had worked before, but after the upgrade, the role was removed from the users with the following activity message: ``` | 13.1.2023, 14:10:40 | system | disassociated Org1 admin_role from jdoe ``` And AWX was logging the following: ``` DEBUG [4ecb27399afb4cb7b9ad2fd5e666a8ca] awx.sso.backends LDAP adapter removing user jdoe permission of admin_role from organization Org1 ``` I tried to remove '""admins"": false' from the config or replace it with an empty list ('admins"": [],') but that didn't change anything. ""None"" was not accepted by the form. According to the Automation Platform docs that should work: https://docs.ansible.com/automation-controller/4.2.1/html/administration/social_auth.html#organization-mapping This seems to be related to the following PR: https://github.com/ansible/awx/pull/12949 ### AWX version 21.10.2 ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version 2.12.2 ### Operating system Debian 11 ### Web browser Firefox ### Steps to reproduce 1) Add default LDAP settings 2) Create an organization map with ""admins: false"" 3) Add a user manually as organization admin to an organization 4) Login with that user and recognize that the admin_role was removed ### Expected results The system doesn't remove the admin_role from the user. ### Actual results The admin_role is removed from the user ### Additional information _No response_",source-file | source-file | source-file | source-file | source-file,admin role disassociated despite admins false please confirm following agree follow project conduct https docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free might receive timely response bug summary upgrading organization admin roles removed users accounts ldap organization map looking like admins false admins false users true users users manually granted organization admin role worked upgrade role removed users following activity message system disassociated admin role jdoe logging following ecb afb sso backends ldap adapter removing user jdoe permission admin role organization tried admins false config replace empty list admins anything none accepted form according automation platform docs work https docs ansible automation controller html administration social auth html organization mapping seems related following https github ansible select relevant components api docs collection cli installation method docker development environment modifications ansible operating system debian web browser firefox steps reproduce default ldap settings create organization map admins false user manually organization admin organization login user recognize admin role removed expected results system admin role user actual results admin role removed user additional information response,bug,0.9,"admin_role disassociated despite remove_admins = false ### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary After upgrading from AWX 21.5.1 to 21.10.2 all organization admin roles were removed from the users' accounts. We're using LDAP with an organization map looking like this: ``` { ""Org1"": { ""admins"": false, ""remove_admins"": false, ""remove_users"": true, ""users"": [ ""CN=..."" ] } } ``` Users were manually granted the organization admin role. That had worked before, but after the upgrade, the role was removed from the users with the following activity message: ``` | 13.1.2023, 14:10:40 | system | disassociated Org1 admin_role from jdoe ``` And AWX was logging the following: ``` DEBUG [4ecb27399afb4cb7b9ad2fd5e666a8ca] awx.sso.backends LDAP adapter removing user jdoe permission of admin_role from organization Org1 ``` I tried to remove '""admins"": false' from the config or replace it with an empty list ('admins"": [],') but that didn't change anything. ""None"" was not accepted by the form. According to the Automation Platform docs that should work: https://docs.ansible.com/automation-controller/4.2.1/html/administration/social_auth.html#organization-mapping This seems to be related to the following PR: https://github.com/ansible/awx/pull/12949 ### AWX version 21.10.2 ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version 2.12.2 ### Operating system Debian 11 ### Web browser Firefox ### Steps to reproduce 1) Add default LDAP settings 2) Create an organization map with ""admins: false"" 3) Add a user manually as organization admin to an organization 4) Login with that user and recognize that the admin_role was removed ### Expected results The system doesn't remove the admin_role from the user. ### Actual results The admin_role is removed from the user ### Additional information _No response_"
6267,awx,https://github.com/ansible/awx/issues/6267,Email Notification - started date is displayed as null when the approval node needs review,"When an approval node needs review and an email notification is setup, the email body contains null started, when the started field is actually set in the api Steps to reproduce: 1. Create a WFJT with approval node 2. associate it with Email notification template that will send notification on WF Approvals 3. launch the WFJT 4. wait for the email notification when the approval node needs review: Expected Results: the notification should be as follows: ``` The approval node ""approval node MediumResident"" needs review. This approval node can be viewed at: https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86 { ""id"": 87, ""name"": ""approval node MediumResident\ufffd"", ""url"": ""https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86"", ""created_by"": ""apurva"", ""started"": ""2020-03-11T21:21:19.898052+00:00"", ""finished"": null, ""status"": ""pending"", ""traceback"": """" } ``` Actual Results: the notification has null started field ``` The approval node ""approval node MediumResident"" needs review. This approval node can be viewed at: https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86 { ""id"": 87, ""name"": ""approval node MediumResident\ufffd"", ""url"": ""https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86"", ""created_by"": ""apurva"", ""started"": null, ""finished"": null, ""status"": ""pending"", ""traceback"": """" } ```",source-file | source-file,email notification started date displayed null approval node needs review approval node needs review email notification setup email body contains null started started field actually set api steps reproduce create wfjt approval node associate email notification template send notification approvals launch wfjt wait email notification approval node needs review expected results notification follows approval node approval node mediumresident needs review approval node viewed https compute amazonaws workflows name approval node mediumresident ufffd url https compute amazonaws workflows created apurva started finished null status pending traceback actual results notification null started field approval node approval node mediumresident needs review approval node viewed https compute amazonaws workflows name approval node mediumresident ufffd url https compute amazonaws workflows created apurva started null finished null status pending traceback,bug,0.9,"Email Notification - started date is displayed as null when the approval node needs review When an approval node needs review and an email notification is setup, the email body contains null started, when the started field is actually set in the api Steps to reproduce: 1. Create a WFJT with approval node 2. associate it with Email notification template that will send notification on WF Approvals 3. launch the WFJT 4. wait for the email notification when the approval node needs review: Expected Results: the notification should be as follows: ``` The approval node ""approval node MediumResident"" needs review. This approval node can be viewed at: https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86 { ""id"": 87, ""name"": ""approval node MediumResident\ufffd"", ""url"": ""https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86"", ""created_by"": ""apurva"", ""started"": ""2020-03-11T21:21:19.898052+00:00"", ""finished"": null, ""status"": ""pending"", ""traceback"": """" } ``` Actual Results: the notification has null started field ``` The approval node ""approval node MediumResident"" needs review. This approval node can be viewed at: https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86 { ""id"": 87, ""name"": ""approval node MediumResident\ufffd"", ""url"": ""https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86"", ""created_by"": ""apurva"", ""started"": null, ""finished"": null, ""status"": ""pending"", ""traceback"": """" } ```"
5093,awx,https://github.com/ansible/awx/issues/5093,[AWXKIT] Unable to provide extra_vars when launching workflow_job_template,"##### ISSUE TYPE - Bug Report ##### SUMMARY Using the AWXKIT CLI tool `awx` it is not possible to provide extra parameters like `scm_branch` or `extra_vars` when launching a workflow_job_template. ##### ENVIRONMENT * AWX version: 8.0.0 * AWX install method: docker on linux * Ansible version: 2.7.10 (Client) * Operating system: macOS Mojave ##### STEPS TO REPRODUCE Installed AWX 8.0.0 and created a workflow `sample_workflow`, which * has survey enabled: ""Ask for `foobar`"" * prompt for SCM branch when launching workflow Installed AWXKIT: ```pip install ""https://github.com/ansible/awx/archive/8.0.0.tar.gz#egg=awxkit&subdirectory=awxkit""``` Tried to launch workflow: ```awx workflow_job_templates launch sample_workflow``` Result: ```{""variables_needed_to_start"": [""'foobar' value missing""]}``` Tried to extend request by using same parameter as for `tower-cli`: ```awx workflow_job_templates launch sample_workflow -e '{""foobar"": 12345}'``` After enabling debug output `awx` threw a warning, that `-e` is an `unrecognized argument`. Tried various arguments like * `--extra_vars` * `--extra-vars` * `-extra_vars` * ... Same result. ##### EXPECTED RESULTS CLI tool should ask for missing configuration items like `extra_vars`, `scm_branch`, or at least provide documentation on how to launch this special kind of workflow_job_templates. ##### ACTUAL RESULTS See ""Steps to reproduce""",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | test-file | source-file | test-file | source-file,awxkit unable provide extra vars launching workflow job template type bug report summary awxkit cli tool possible provide extra parameters like scm branch extra vars launching workflow job template environment install method docker linux ansible client operating system macos mojave steps reproduce installed created workflow sample workflow survey enabled ask foobar prompt scm branch launching workflow installed awxkit pip install https github ansible archive tar egg awxkit subdirectory awxkit tried launch workflow workflow job templates launch sample workflow result variables needed start foobar value missing tried extend parameter tower cli workflow job templates launch sample workflow foobar enabling output threw warning unrecognized argument tried various arguments like extra vars extra vars extra vars result expected results cli tool ask missing configuration items like extra vars scm branch least provide documentation launch special kind workflow job templates actual results see steps reproduce,bug,0.9,"[AWXKIT] Unable to provide extra_vars when launching workflow_job_template ##### ISSUE TYPE - Bug Report ##### SUMMARY Using the AWXKIT CLI tool `awx` it is not possible to provide extra parameters like `scm_branch` or `extra_vars` when launching a workflow_job_template. ##### ENVIRONMENT * AWX version: 8.0.0 * AWX install method: docker on linux * Ansible version: 2.7.10 (Client) * Operating system: macOS Mojave ##### STEPS TO REPRODUCE Installed AWX 8.0.0 and created a workflow `sample_workflow`, which * has survey enabled: ""Ask for `foobar`"" * prompt for SCM branch when launching workflow Installed AWXKIT: ```pip install ""https://github.com/ansible/awx/archive/8.0.0.tar.gz#egg=awxkit&subdirectory=awxkit""``` Tried to launch workflow: ```awx workflow_job_templates launch sample_workflow``` Result: ```{""variables_needed_to_start"": [""'foobar' value missing""]}``` Tried to extend request by using same parameter as for `tower-cli`: ```awx workflow_job_templates launch sample_workflow -e '{""foobar"": 12345}'``` After enabling debug output `awx` threw a warning, that `-e` is an `unrecognized argument`. Tried various arguments like * `--extra_vars` * `--extra-vars` * `-extra_vars` * ... Same result. ##### EXPECTED RESULTS CLI tool should ask for missing configuration items like `extra_vars`, `scm_branch`, or at least provide documentation on how to launch this special kind of workflow_job_templates. ##### ACTUAL RESULTS See ""Steps to reproduce"""
5081,awx,https://github.com/ansible/awx/issues/5081,Setting base url fail with error 400,"##### ISSUE TYPE - Bug Report ##### SUMMARY Whe have an internal dns with a domain like ""org.les800"" when i'm trying to set the base url of the tower host with something like ""tower.org.les800"", it fail with an error 400 and url not valid ##### ENVIRONMENT * AWX version: 8.0.0 * AWX install method: MrMee rpm * Ansible version: 2.8.6 * Operating System: CentOS 7.7 * Web Browser: Chrome latest ##### STEPS TO REPRODUCE try an url like http://tower.org.les800 in settings/system ##### EXPECTED RESULTS url for the base host set ##### ACTUAL RESULTS got url with the name of the server instead ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->",other-file,setting base url fail type bug report summary whe internal dns domain like les trying set base url tower host something like tower les fail url valid environment install method mrmee rpm ansible operating system centos web browser chrome latest steps reproduce url like http tower les settings system expected results url base host set actual results got url name server instead additional information include links sosreport database dumps screenshots information,bug,0.8,"Setting base url fail with error 400 ##### ISSUE TYPE - Bug Report ##### SUMMARY Whe have an internal dns with a domain like ""org.les800"" when i'm trying to set the base url of the tower host with something like ""tower.org.les800"", it fail with an error 400 and url not valid ##### ENVIRONMENT * AWX version: 8.0.0 * AWX install method: MrMee rpm * Ansible version: 2.8.6 * Operating System: CentOS 7.7 * Web Browser: Chrome latest ##### STEPS TO REPRODUCE try an url like http://tower.org.les800 in settings/system ##### EXPECTED RESULTS url for the base host set ##### ACTUAL RESULTS got url with the name of the server instead ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->"
6365,awx,https://github.com/ansible/awx/issues/6365,Fresh install Jobs not starting,"##### ISSUE TYPE - Bug Report Just did a fresh install of AWX 9.3.0 and none of the JOBs are being triggered. Project, Jobs, Ad-hoc jobs any jobs. after a few minutes it Times out with this error: > Call to /api/v2/ad_hoc_commands/1/relaunch/ failed. returned status: 504. ##### SUMMARY ##### ENVIRONMENT * AWX version: 9.3.0 * AWX install method: docker on centos 7 * Ansible version: 2.9.6 * Operating System: Centos 7 * Web Browser: Chrome ##### STEPS TO REPRODUCE try to execute ANY job such as project, ad-hoc script, etc.. ##### EXPECTED RESULTS Jobs are stuck in starting mode they never start, please see screenshots below. ##### ADDITIONAL INFORMATION Please review images below: ![image](https://user-images.githubusercontent.com/20629911/77183907-3e375200-6a8c-11ea-9d0e-f1a7b2310b21.png) Image from Web continaer ![image](https://user-images.githubusercontent.com/20629911/77184346-ed742900-6a8c-11ea-93da-ea0380c10360.png) Image from TASK container ![image](https://user-images.githubusercontent.com/20629911/77186997-0a126000-6a91-11ea-803f-8017d8536abc.png) Thank you, HS",source-file | test-file,fresh install jobs starting type bug report fresh install none jobs triggered project jobs hoc jobs jobs minutes times call api hoc commands relaunch failed returned status summary environment install method docker centos ansible operating system centos web browser chrome steps reproduce execute job project hoc script etc expected results jobs stuck starting mode never start please see screenshots additional information please review images image https user images githubusercontent png image web continaer image https user images githubusercontent png image task container image https user images githubusercontent abc png thank,bug,0.8,"Fresh install Jobs not starting ##### ISSUE TYPE - Bug Report Just did a fresh install of AWX 9.3.0 and none of the JOBs are being triggered. Project, Jobs, Ad-hoc jobs any jobs. after a few minutes it Times out with this error: > Call to /api/v2/ad_hoc_commands/1/relaunch/ failed. returned status: 504. ##### SUMMARY ##### ENVIRONMENT * AWX version: 9.3.0 * AWX install method: docker on centos 7 * Ansible version: 2.9.6 * Operating System: Centos 7 * Web Browser: Chrome ##### STEPS TO REPRODUCE try to execute ANY job such as project, ad-hoc script, etc.. ##### EXPECTED RESULTS Jobs are stuck in starting mode they never start, please see screenshots below. ##### ADDITIONAL INFORMATION Please review images below: ![image](https://user-images.githubusercontent.com/20629911/77183907-3e375200-6a8c-11ea-9d0e-f1a7b2310b21.png) Image from Web continaer ![image](https://user-images.githubusercontent.com/20629911/77184346-ed742900-6a8c-11ea-93da-ea0380c10360.png) Image from TASK container ![image](https://user-images.githubusercontent.com/20629911/77186997-0a126000-6a91-11ea-803f-8017d8536abc.png) Thank you, HS"
7243,awx,https://github.com/ansible/awx/issues/7243,500 error on unauthenticated HTTP GET to nested workflow endpoint,"##### ISSUE TYPE - Bug Report ##### SUMMARY Not a huge deal, just something I noticed while debugging some unrelated test failures: If you make a GET request to ` api/v2/workflow_job_template_nodes/n/create_approval_template/` when unauthenticated, you'll get a 500 instead of a 401. It seems to work fine if you're logged in. ##### STEPS TO REPRODUCE - make a workflow with nodes - log out - open browser dev tools and network tab - visit ` api/v2/workflow_job_template_nodes/n/create_approval_template/` in api browser ##### EXPECTED RESULTS 401 ##### ACTUAL RESULTS 500 ##### ADDITIONAL INFORMATION ![Screenshot from 2020-06-03 19-11-23](https://user-images.githubusercontent.com/9753817/83697865-08efca00-a5ce-11ea-9d0c-0173751041df.png)",source-file | source-file,unauthenticated http get nested workflow endpoint type bug report summary huge deal something noticed debugging unrelated failures make get api workflow job template nodes create approval template unauthenticated get instead seems work fine logged steps reproduce make workflow nodes log open browser tools network tab visit api workflow job template nodes create approval template api browser expected results actual results additional information screenshot https user images githubusercontent efca png,bug,0.95,"500 error on unauthenticated HTTP GET to nested workflow endpoint ##### ISSUE TYPE - Bug Report ##### SUMMARY Not a huge deal, just something I noticed while debugging some unrelated test failures: If you make a GET request to ` api/v2/workflow_job_template_nodes/n/create_approval_template/` when unauthenticated, you'll get a 500 instead of a 401. It seems to work fine if you're logged in. ##### STEPS TO REPRODUCE - make a workflow with nodes - log out - open browser dev tools and network tab - visit ` api/v2/workflow_job_template_nodes/n/create_approval_template/` in api browser ##### EXPECTED RESULTS 401 ##### ACTUAL RESULTS 500 ##### ADDITIONAL INFORMATION ![Screenshot from 2020-06-03 19-11-23](https://user-images.githubusercontent.com/9753817/83697865-08efca00-a5ce-11ea-9d0c-0173751041df.png)"
9176,awx,https://github.com/ansible/awx/issues/9176,Optional textarea survey fields not optional when min length > 0,"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY Text area survey fields that are optional (required checkbox unchecked) are not optional if the minimum length is greater than zero. Upon launching, an error message displays saying the field must be X characters. In versions <= 15.0.1, an optional field with a min length of one could be left blank and the variable would not be defined or set. In 17.0.0, awx attempts to define the variable regardless if the field is optional or not. ##### ENVIRONMENT * AWX version: 17.0.1 * AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker * Ansible version: X.Y.Z * Operating System: * Web Browser: ##### STEPS TO REPRODUCE Create a survey with an optional text area field Set the min length to 1 Attempt to launch the job leaving the survey field blank ##### EXPECTED RESULTS When min length is greater than zero and the field is optional, the variable should be left undefined when the survey field is blank and the job should launch. ##### ACTUAL RESULTS Launch fails with a message saying the field must be at least one character. ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->",other-file | source-file,optional textarea survey fields optional min length issues concrete actionable bugs feature requests asking debugging help technical please use http webchat freenode channels ansible https groups google forum forum project limit limited volunteer time respond issues type bug report summary text area survey fields optional required checkbox unchecked optional minimum length greater zero upon launching message displays saying field must characters versions optional field min length one could left blank variable would defined set attempts define variable regardless field optional environment install method openshift minishift docker linux docker mac boot docker ansible operating system web browser steps reproduce create survey optional text area field set min length attempt launch job leaving survey field blank expected results min length greater zero field optional variable left undefined survey field blank job launch actual results launch fails message saying field must least one character additional information include links sosreport database dumps screenshots information,bug,0.9,"Optional textarea survey fields not optional when min length > 0 <!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY Text area survey fields that are optional (required checkbox unchecked) are not optional if the minimum length is greater than zero. Upon launching, an error message displays saying the field must be X characters. In versions <= 15.0.1, an optional field with a min length of one could be left blank and the variable would not be defined or set. In 17.0.0, awx attempts to define the variable regardless if the field is optional or not. ##### ENVIRONMENT * AWX version: 17.0.1 * AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker * Ansible version: X.Y.Z * Operating System: * Web Browser: ##### STEPS TO REPRODUCE Create a survey with an optional text area field Set the min length to 1 Attempt to launch the job leaving the survey field blank ##### EXPECTED RESULTS When min length is greater than zero and the field is optional, the variable should be left undefined when the survey field is blank and the job should launch. ##### ACTUAL RESULTS Launch fails with a message saying the field must be at least one character. ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. -->"
6342,awx,https://github.com/ansible/awx/issues/6342,Virtualenv in Kubernetes deployment doesn't work,"##### ISSUE TYPE - Bug Report ##### SUMMARY Error when applying `curl -X PATCH 'https://admin:mypass@myurl/api/v2/organizations/my_org/' \ -d '{""custom_virtualenv"": ""/opt/custom-venvs/my_env/""}' -H 'Content-Type:application/json'` `{""custom_virtualenv"":[""/opt/custom-venvs/my_env/ is not a valid virtualenv in /var/lib/awx/venv""]}` ##### ENVIRONMENT * AWX version: 9.3.0 * AWX install method: Kubernetes v1.15.3 * Ansible version: 2.9.5 ##### STEPS TO REPRODUCE 1) Install AWX to kubernetes with similar config <details> <summary>inventory config</summary> ``` localhost ansible_connection=local ansible_python_interpreter=""/usr/bin/env python"" [all:vars] dockerhub_base=ansible kubernetes_context=mycontext kubernetes_namespace=awx kubernetes_ingress_hostname=myingress awx_task_hostname=awx awx_web_hostname=awxweb postgres_data_dir=""~/.awx/pgdocker"" host_port=80 host_port_ssl=443 docker_compose_dir=""~/.awx/awxcompose"" pg_hostname=mypghost pg_username=awx pg_password=mypgpass pg_database=awx pg_port=5432 rabbitmq_password=awxpass rabbitmq_erlang_cookie=cookiemonster admin_user=admin admin_password=myadminpass secret_key=mysecretkey logos/blob/master/TRADEMARKS.md ``` </details> <details> <summary>venv_vars.yaml</summary> ``` --- custom_venvs: - name: my_env python: python3 python_ansible_version: 2.9.6 python_modules: - dnspython - zabbix-api - jmespath ``` </details> 2) Assigning custom venv according to [this documentation](https://github.com/ansible/awx/blob/devel/docs/custom_virtualenvs.md) `curl -X PATCH 'https://admin:mypass@myurl/api/v2/settings/system/' \ -d '{""CUSTOM_VENV_PATHS"": [[""/opt/custom-venvs/my_env/""]}' -H 'Content-Type:application/json'` <details> <summary>answer</summary> ``` { ""ACTIVITY_STREAM_ENABLED"":true, ""ACTIVITY_STREAM_ENABLED_FOR_INVENTORY_SYNC"":false, ""ORG_ADMINS_CAN_SEE_ALL_USERS"":true, ""MANAGE_ORGANIZATION_AUTH"":true, ""TOWER_URL_BASE"":""myurl"", ""REMOTE_HOST_HEADERS"":[ ""HTTP_X_FORWARDED_FOR"" ], ""PROXY_IP_WHITELIST"":[ ], ""LICENSE"":{ }, ""REDHAT_USERNAME"":""admin"", ""REDHAT_PASSWORD"":""$encrypted$"", ""AUTOMATION_ANALYTICS_URL"":""https://example.org"", ""INSTALL_UUID"":""c1885c2a-d736-4023-9517-49929f8d77fa"", ""CUSTOM_VENV_PATHS"":[ ""/opt/custom-venvs/my_env/"" ], ""INSIGHTS_TRACKING_STATE"":false, ""BROKER_DURABILITY"":true, ""AUTOMATION_ANALYTICS_LAST_GATHER"":null, ""AUTOMATION_ANALYTICS_GATHER_INTERVAL"":14400 } ``` </details> 3) Assigning custom venv to organization and get and error `curl -X PATCH 'https://admin:mypass@myurl/api/v2/organizations/my_org/' \ -d '{""custom_virtualenv"": ""/opt/custom-venvs/my_env/""}' -H 'Content-Type:application/json'` <details> <summary>error</summary> ``` {""custom_virtualenv"":[""/opt/custom-venvs/my_env/ is not a valid virtualenv in /var/lib/awx/venv""]} ``` </details> ##### EXPECTED RESULTS `my_org` will use custom venv ##### ACTUAL RESULTS `my_org` raises an error when apllying custom venv ##### ADDITIONAL INFORMATION I've checked both containers `awx_web` and `awx_task`, they have `/opt/custom-venvs/my_env/` dir with working venv. Even if `PATCH api/v2/settings/system/` works properly (according to it answer, and i can see added venv in web interface), `GET api/v2/config/` still returns no venv's <details> <summary>api/v2/config/ answer</summary> ``` { ""time_zone"": ""UTC"", ""license_info"": { ""license_key"": ""OPEN"", ""valid_key"": true, ""compliant"": true, ""features"": { ""activity_streams"": true, ""ha"": true, ""ldap"": true, ""multiple_organizations"": true, ""surveys"": true, ""system_tracking"": true, ""rebranding"": true, ""enterprise_auth"": true, ""workflows"": true }, ""license_type"": ""open"" }, ""version"": ""9.3.0"", ""ansible_version"": ""2.9.5"", ""eula"": """", ""analytics_status"": ""off"", ""become_methods"": [ [ ""sudo"", ""Sudo"" ], [ ""su"", ""Su"" ], [ ""pbrun"", ""Pbrun"" ], [ ""pfexec"", ""Pfexec"" ], [ ""dzdo"", ""DZDO"" ], [ ""pmrun"", ""Pmrun"" ], [ ""runas"", ""Runas"" ], [ ""enable"", ""Enable"" ], [ ""doas"", ""Doas"" ], [ ""ksu"", ""Ksu"" ], [ ""machinectl"", ""Machinectl"" ], [ ""sesu"", ""Sesu"" ] ], ""project_base_dir"": ""/var/lib/awx/projects"", ""project_local_paths"": [], ""custom_virtualenvs"": [ ""/var/lib/awx/venv/ansible/"" ] } ``` </details> After finding that venv doesn't apply even in `system`, i've tried to make fresh install of awx on another kube cluster, with same results.",source-file,virtualenv kubernetes deployment work type bug report summary applying curl https admin mypass myurl api organizations custom virtualenv opt custom venvs env content type application json custom virtualenv opt custom venvs env valid virtualenv var venv environment install method kubernetes ansible steps reproduce install kubernetes similar config details summary inventory config summary localhost ansible connection local ansible python interpreter env python vars dockerhub base ansible kubernetes context mycontext kubernetes namespace kubernetes ingress hostname myingress task hostname web hostname awxweb postgres data dir pgdocker host port host port ssl docker compose dir awxcompose hostname mypghost username password mypgpass database port rabbitmq password awxpass rabbitmq erlang cookie cookiemonster admin user admin admin password myadminpass secret key mysecretkey logos blob trademarks details details summary venv vars yaml summary custom venvs name env python python python ansible python modules dnspython zabbix api jmespath details assigning custom venv according documentation https github ansible blob devel docs custom virtualenvs curl https admin mypass myurl api settings system custom venv paths opt custom venvs env content type application json details summary answer summary activity stream enabled true activity stream enabled inventory sync false admins see users true manage organization auth true tower url base myurl remote host headers http forwarded proxy whitelist license redhat username admin redhat password encrypted automation analytics url https example install uuid custom venv paths opt custom venvs env insights tracking state false broker durability true automation analytics last gather null automation analytics gather interval details assigning custom venv organization get curl https admin mypass myurl api organizations custom virtualenv opt custom venvs env content type application json details summary summary custom virtualenv opt custom venvs env valid virtualenv var venv details expected results use custom venv actual results raises apllying custom venv additional information checked containers web task opt custom venvs env dir working venv even api settings system works properly according answer see added venv web interface get api config still returns venv details summary api config answer summary time zone utc license license key open valid key true compliant true features activity streams true true ldap true multiple organizations true surveys true system tracking true rebranding true enterprise auth true workflows true license type open ansible eula analytics status become methods sudo sudo pbrun pbrun pfexec pfexec dzdo dzdo pmrun pmrun runas runas enable enable doas doas ksu ksu machinectl machinectl sesu sesu project base dir var projects project local paths custom virtualenvs var venv ansible details finding venv apply even system tried make fresh install another kube cluster results,bug,0.9,"Virtualenv in Kubernetes deployment doesn't work ##### ISSUE TYPE - Bug Report ##### SUMMARY Error when applying `curl -X PATCH 'https://admin:mypass@myurl/api/v2/organizations/my_org/' \ -d '{""custom_virtualenv"": ""/opt/custom-venvs/my_env/""}' -H 'Content-Type:application/json'` `{""custom_virtualenv"":[""/opt/custom-venvs/my_env/ is not a valid virtualenv in /var/lib/awx/venv""]}` ##### ENVIRONMENT * AWX version: 9.3.0 * AWX install method: Kubernetes v1.15.3 * Ansible version: 2.9.5 ##### STEPS TO REPRODUCE 1) Install AWX to kubernetes with similar config <details> <summary>inventory config</summary> ``` localhost ansible_connection=local ansible_python_interpreter=""/usr/bin/env python"" [all:vars] dockerhub_base=ansible kubernetes_context=mycontext kubernetes_namespace=awx kubernetes_ingress_hostname=myingress awx_task_hostname=awx awx_web_hostname=awxweb postgres_data_dir=""~/.awx/pgdocker"" host_port=80 host_port_ssl=443 docker_compose_dir=""~/.awx/awxcompose"" pg_hostname=mypghost pg_username=awx pg_password=mypgpass pg_database=awx pg_port=5432 rabbitmq_password=awxpass rabbitmq_erlang_cookie=cookiemonster admin_user=admin admin_password=myadminpass secret_key=mysecretkey logos/blob/master/TRADEMARKS.md ``` </details> <details> <summary>venv_vars.yaml</summary> ``` --- custom_venvs: - name: my_env python: python3 python_ansible_version: 2.9.6 python_modules: - dnspython - zabbix-api - jmespath ``` </details> 2) Assigning custom venv according to [this documentation](https://github.com/ansible/awx/blob/devel/docs/custom_virtualenvs.md) `curl -X PATCH 'https://admin:mypass@myurl/api/v2/settings/system/' \ -d '{""CUSTOM_VENV_PATHS"": [[""/opt/custom-venvs/my_env/""]}' -H 'Content-Type:application/json'` <details> <summary>answer</summary> ``` { ""ACTIVITY_STREAM_ENABLED"":true, ""ACTIVITY_STREAM_ENABLED_FOR_INVENTORY_SYNC"":false, ""ORG_ADMINS_CAN_SEE_ALL_USERS"":true, ""MANAGE_ORGANIZATION_AUTH"":true, ""TOWER_URL_BASE"":""myurl"", ""REMOTE_HOST_HEADERS"":[ ""HTTP_X_FORWARDED_FOR"" ], ""PROXY_IP_WHITELIST"":[ ], ""LICENSE"":{ }, ""REDHAT_USERNAME"":""admin"", ""REDHAT_PASSWORD"":""$encrypted$"", ""AUTOMATION_ANALYTICS_URL"":""https://example.org"", ""INSTALL_UUID"":""c1885c2a-d736-4023-9517-49929f8d77fa"", ""CUSTOM_VENV_PATHS"":[ ""/opt/custom-venvs/my_env/"" ], ""INSIGHTS_TRACKING_STATE"":false, ""BROKER_DURABILITY"":true, ""AUTOMATION_ANALYTICS_LAST_GATHER"":null, ""AUTOMATION_ANALYTICS_GATHER_INTERVAL"":14400 } ``` </details> 3) Assigning custom venv to organization and get and error `curl -X PATCH 'https://admin:mypass@myurl/api/v2/organizations/my_org/' \ -d '{""custom_virtualenv"": ""/opt/custom-venvs/my_env/""}' -H 'Content-Type:application/json'` <details> <summary>error</summary> ``` {""custom_virtualenv"":[""/opt/custom-venvs/my_env/ is not a valid virtualenv in /var/lib/awx/venv""]} ``` </details> ##### EXPECTED RESULTS `my_org` will use custom venv ##### ACTUAL RESULTS `my_org` raises an error when apllying custom venv ##### ADDITIONAL INFORMATION I've checked both containers `awx_web` and `awx_task`, they have `/opt/custom-venvs/my_env/` dir with working venv. Even if `PATCH api/v2/settings/system/` works properly (according to it answer, and i can see added venv in web interface), `GET api/v2/config/` still returns no venv's <details> <summary>api/v2/config/ answer</summary> ``` { ""time_zone"": ""UTC"", ""license_info"": { ""license_key"": ""OPEN"", ""valid_key"": true, ""compliant"": true, ""features"": { ""activity_streams"": true, ""ha"": true, ""ldap"": true, ""multiple_organizations"": true, ""surveys"": true, ""system_tracking"": true, ""rebranding"": true, ""enterprise_auth"": true, ""workflows"": true }, ""license_type"": ""open"" }, ""version"": ""9.3.0"", ""ansible_version"": ""2.9.5"", ""eula"": """", ""analytics_status"": ""off"", ""become_methods"": [ [ ""sudo"", ""Sudo"" ], [ ""su"", ""Su"" ], [ ""pbrun"", ""Pbrun"" ], [ ""pfexec"", ""Pfexec"" ], [ ""dzdo"", ""DZDO"" ], [ ""pmrun"", ""Pmrun"" ], [ ""runas"", ""Runas"" ], [ ""enable"", ""Enable"" ], [ ""doas"", ""Doas"" ], [ ""ksu"", ""Ksu"" ], [ ""machinectl"", ""Machinectl"" ], [ ""sesu"", ""Sesu"" ] ], ""project_base_dir"": ""/var/lib/awx/projects"", ""project_local_paths"": [], ""custom_virtualenvs"": [ ""/var/lib/awx/venv/ansible/"" ] } ``` </details> After finding that venv doesn't apply even in `system`, i've tried to make fresh install of awx on another kube cluster, with same results."
11229,awx,https://github.com/ansible/awx/issues/11229,Ansible collection - job_template module unable to update survey spec,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Using the job_template module, I am unable to update/add/delete ""survey_spec.spec"", when I only change the ""survey_spec.spec"" and nothing else. If some other JobTemplate property changes, everthing works fine and the survey will update as well. ### AWX version 19.2.2 ### Installation method kubernetes ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce only add a single survey question with the job_template module to an existing job template ### Expected results survey should have a new survey question and the task should be marked as changed ### Actual results The new question is in the task output, but it is not added to the job template and the task is not marked as changed. ### Additional information _No response_",source-file | source-file | source-file | source-file,ansible collection job template module unable survey spec please confirm following agree follow project conduct http docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free entitled status updates assurances summary job template module unable delete survey spec spec survey spec spec nothing else jobtemplate property changes everthing works fine survey well installation method kubernetes modifications ansible response operating system response web browser response steps reproduce single survey question job template module existing job template expected results survey new survey question task marked changed actual results new question task output added job template task marked changed additional information response,bug,0.85,"Ansible collection - job_template module unable to update survey spec ### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Using the job_template module, I am unable to update/add/delete ""survey_spec.spec"", when I only change the ""survey_spec.spec"" and nothing else. If some other JobTemplate property changes, everthing works fine and the survey will update as well. ### AWX version 19.2.2 ### Installation method kubernetes ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce only add a single survey question with the job_template module to an existing job template ### Expected results survey should have a new survey question and the task should be marked as changed ### Actual results The new question is in the task output, but it is not added to the job template and the task is not marked as changed. ### Additional information _No response_"
10681,awx,https://github.com/ansible/awx/issues/10681,API strings are not being compiled,"### Summary In our move to ui_next, the `make languages` target was no longer called when compiling the UI. This means that the API strings (think help_text in OPTIONS requests) are no longer being compiled and thus are not displayed in the client's browser. ### AWX version devel ### Web browser Chrome ### Steps to reproduce 1. Start the dev env - `make docker-compose` 2. Change your browser preferences to default to `ja` as your locale 3. Navigate to `api/v2/settings/authentication` and click OPTIONS to see the untranslated strings 4. Run the following to compile API strings: ``` $ python tools/scripts/compilemessages.py ``` 5. Restart your containers 6. Observe the strings are now translated ### Expected results ![image](https://user-images.githubusercontent.com/11698892/126224196-f76da94a-f6ca-4306-9187-b2db8326ab5c.png) ### Actual results ![image](https://user-images.githubusercontent.com/11698892/126224326-2461395d-6f14-4eaf-b34b-58a2108c0354.png) Sidenote, there is also a `fr` string that is throwing a compilation error which I will fix. ### Additional information We may also be able to lose our `compilemessages.py` file in favor of using the django build-in command.",other-file | source-file | other-file,api strings compiled summary move next make languages target longer called compiling means api strings think help text options requests longer compiled thus displayed client browser devel web browser chrome steps reproduce start env make docker compose browser preferences default locale navigate api settings authentication click options see untranslated strings following compile api strings python tools scripts compilemessages restart containers observe strings translated expected results image https user images githubusercontent png actual results image https user images githubusercontent eaf png sidenote also string throwing compilation additional information may also able lose compilemessages favor django command,bug,0.85,"API strings are not being compiled ### Summary In our move to ui_next, the `make languages` target was no longer called when compiling the UI. This means that the API strings (think help_text in OPTIONS requests) are no longer being compiled and thus are not displayed in the client's browser. ### AWX version devel ### Web browser Chrome ### Steps to reproduce 1. Start the dev env - `make docker-compose` 2. Change your browser preferences to default to `ja` as your locale 3. Navigate to `api/v2/settings/authentication` and click OPTIONS to see the untranslated strings 4. Run the following to compile API strings: ``` $ python tools/scripts/compilemessages.py ``` 5. Restart your containers 6. Observe the strings are now translated ### Expected results ![image](https://user-images.githubusercontent.com/11698892/126224196-f76da94a-f6ca-4306-9187-b2db8326ab5c.png) ### Actual results ![image](https://user-images.githubusercontent.com/11698892/126224326-2461395d-6f14-4eaf-b34b-58a2108c0354.png) Sidenote, there is also a `fr` string that is throwing a compilation error which I will fix. ### Additional information We may also be able to lose our `compilemessages.py` file in favor of using the django build-in command."
6485,awx,https://github.com/ansible/awx/issues/6485,modal searches shouldn't be case-sensitive,"##### ISSUE TYPE - Bug Report ##### SUMMARY Tried to search for an Organization when creating a user. ""default"" doesn't return the ""Default"" organization. This should be case-insensitive. in addition, this ticket should involve going through similar searches and ensuring that they are case-insensitive.",source-file,modal searches case sensitive type bug report summary tried search organization creating user default return default organization case insensitive addition ticket involve going similar searches ensuring case insensitive,bug,0.85,"modal searches shouldn't be case-sensitive ##### ISSUE TYPE - Bug Report ##### SUMMARY Tried to search for an Organization when creating a user. ""default"" doesn't return the ""Default"" organization. This should be case-insensitive. in addition, this ticket should involve going through similar searches and ensuring that they are case-insensitive."
13597,awx,https://github.com/ansible/awx/issues/13597,Unable to use CCP lookup plugin with empty webservice_id,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary When job uses the `CyberArk Central Credential Provider Lookup` credential plugin with an empty web service id, it fails with the exception: ``` Traceback (most recent call last): File ""/awx_devel/awx/main/tasks/jobs.py"", line 508, in run args = self.build_args(self.instance, private_data_dir, passwords) File ""/awx_devel/awx/main/tasks/jobs.py"", line 941, in build_args ssh_username = creds.get_input('username', default='') File ""/awx_devel/awx/main/models/credential/__init__.py"", line 275, in get_input return self._get_dynamic_input(field_name) File ""/awx_devel/awx/main/models/credential/__init__.py"", line 309, in _get_dynamic_input return input_source.get_input_value() File ""/awx_devel/awx/main/models/credential/__init__.py"", line 1250, in get_input_value return backend(**backend_kwargs) File ""/awx_devel/awx/main/credential_plugins/aim.py"", line 73, in aim_backend webservice_id = kwargs['webservice_id'] KeyError: 'webservice_id' ``` The issue is only reproducible if we create a CCP lookup credential using API and we do not provide the `webservice_id` key as the input. If you create CCP lookup with UI - everything works fine. ### AWX version devel ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce 1. Create CyberArk Central Credential Provider Lookup credential. Do not provide the WebService ID value, keep it empty. I used API to create credetnail and the webservice_id was missing in the inputs: ``` inputs = { 'url': url, 'app_id': app_id, 'client_key': client_key, 'client_cert': client_cert, 'verify': verify } payload = factories.credential.payload( name=fauxfactory.gen_utf8(), description=fauxfactory.gen_utf8(), credential_type=cred_type, inputs=inputs ) ``` 2. Create Machine credential that uses the CCP lookup credential. Set proper Object query. 3. Create Job Template that uses this credential. Run the job. ### Expected results The lookup should use default webservice id: `AIMWebService` ### Actual results Exception occured. See description. ### Additional information _No response_",source-file,unable use ccp lookup plugin empty webservice please confirm following agree follow project conduct https docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free might receive timely response bug summary job uses cyberark central credential provider lookup credential plugin empty web service fails exception traceback recent call last devel tasks jobs args self args self instance private data dir passwords devel tasks jobs args ssh username creds get input username default devel models credential init get input return self get dynamic input field name devel models credential init get dynamic input return input get input value devel models credential init get input value return backend backend kwargs devel credential plugins aim aim backend webservice kwargs webservice keyerror webservice reproducible create ccp lookup credential api provide webservice key input create ccp lookup everything works fine devel select relevant components api docs collection cli installation method docker development environment modifications ansible response operating system response web browser response steps reproduce create cyberark central credential provider lookup credential provide webservice value keep empty used api create credetnail webservice missing inputs inputs url url app app client key client key client cert client cert verify verify payload factories credential payload name fauxfactory gen utf description fauxfactory gen utf credential type cred type inputs inputs create machine credential uses ccp lookup credential set proper object query create job template uses credential job expected results lookup use default webservice aimwebservice actual results exception occured see description additional information response,bug,0.9,"Unable to use CCP lookup plugin with empty webservice_id ### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary When job uses the `CyberArk Central Credential Provider Lookup` credential plugin with an empty web service id, it fails with the exception: ``` Traceback (most recent call last): File ""/awx_devel/awx/main/tasks/jobs.py"", line 508, in run args = self.build_args(self.instance, private_data_dir, passwords) File ""/awx_devel/awx/main/tasks/jobs.py"", line 941, in build_args ssh_username = creds.get_input('username', default='') File ""/awx_devel/awx/main/models/credential/__init__.py"", line 275, in get_input return self._get_dynamic_input(field_name) File ""/awx_devel/awx/main/models/credential/__init__.py"", line 309, in _get_dynamic_input return input_source.get_input_value() File ""/awx_devel/awx/main/models/credential/__init__.py"", line 1250, in get_input_value return backend(**backend_kwargs) File ""/awx_devel/awx/main/credential_plugins/aim.py"", line 73, in aim_backend webservice_id = kwargs['webservice_id'] KeyError: 'webservice_id' ``` The issue is only reproducible if we create a CCP lookup credential using API and we do not provide the `webservice_id` key as the input. If you create CCP lookup with UI - everything works fine. ### AWX version devel ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce 1. Create CyberArk Central Credential Provider Lookup credential. Do not provide the WebService ID value, keep it empty. I used API to create credetnail and the webservice_id was missing in the inputs: ``` inputs = { 'url': url, 'app_id': app_id, 'client_key': client_key, 'client_cert': client_cert, 'verify': verify } payload = factories.credential.payload( name=fauxfactory.gen_utf8(), description=fauxfactory.gen_utf8(), credential_type=cred_type, inputs=inputs ) ``` 2. Create Machine credential that uses the CCP lookup credential. Set proper Object query. 3. Create Job Template that uses this credential. Run the job. ### Expected results The lookup should use default webservice id: `AIMWebService` ### Actual results Exception occured. See description. ### Additional information _No response_"
4910,awx,https://github.com/ansible/awx/issues/4910,jobs still dispatched to container group even if ResourceQuota will cause them to be rejected + fail immediately,"##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> This is a known issue of #4189 that will be resolved in follow up PR. _IF the user sets up the namespace that they use for the Container Group with a ResourceQuota_... @one-t has confirmed that when a Container Group has exceeded capacity (e.g. has met its ResourceQuota) , jobs will still be sent to it because of lack of capacity calculation for ContainerGroups. The jobs then immediately fail becaues of a `403` response from kubernetes API instead of expected behavior of waiting to dispatch job until an instance group has capacity to run it. This means in a Tower environment that is saturated with jobs such that all other resources available to a new job are out of capacity, the Container Group will still appear to have capacity even if it itself has also exceeded resource limits. This will cause the job and any future jobs dispatched to the CG to immediately fail until resources are freed up. ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> Create a ResourceQuota in the namespace you use to set up a ContainerGroup Associate the ContainerGroup with a JT Launch more jobs that your ResourceQuota will allow ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> Later jobs will go into pending until resources are available ##### ACTUAL RESULTS <!-- What actually happened? --> Later jobs fail immediately with `403` from kubernetes API ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. --> @one-t can provide more details about how to configure your namespace ResourceQuota",source-file,jobs still dispatched container group even resourcequota cause rejected fail immediately type bug report summary briefly describe known resolved follow user sets namespace use container group resourcequota one confirmed container group exceeded capacity met resourcequota jobs still sent lack capacity calculation containergroups jobs immediately fail becaues response kubernetes api instead expected behavior waiting dispatch job instance group capacity means tower environment saturated jobs resources available new job capacity container group still appear capacity even also exceeded resource limits cause job future jobs dispatched immediately fail resources freed steps reproduce please describe exactly reproduce create resourcequota namespace use set containergroup associate containergroup launch jobs resourcequota allow expected results expect happen running steps later jobs pending resources available actual results actually happened later jobs fail immediately kubernetes api additional information include links sosreport database dumps screenshots information one provide details configure namespace resourcequota,bug,0.9,"jobs still dispatched to container group even if ResourceQuota will cause them to be rejected + fail immediately ##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> This is a known issue of #4189 that will be resolved in follow up PR. _IF the user sets up the namespace that they use for the Container Group with a ResourceQuota_... @one-t has confirmed that when a Container Group has exceeded capacity (e.g. has met its ResourceQuota) , jobs will still be sent to it because of lack of capacity calculation for ContainerGroups. The jobs then immediately fail becaues of a `403` response from kubernetes API instead of expected behavior of waiting to dispatch job until an instance group has capacity to run it. This means in a Tower environment that is saturated with jobs such that all other resources available to a new job are out of capacity, the Container Group will still appear to have capacity even if it itself has also exceeded resource limits. This will cause the job and any future jobs dispatched to the CG to immediately fail until resources are freed up. ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> Create a ResourceQuota in the namespace you use to set up a ContainerGroup Associate the ContainerGroup with a JT Launch more jobs that your ResourceQuota will allow ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> Later jobs will go into pending until resources are available ##### ACTUAL RESULTS <!-- What actually happened? --> Later jobs fail immediately with `403` from kubernetes API ##### ADDITIONAL INFORMATION <!-- Include any links to sosreport, database dumps, screenshots or other information. --> @one-t can provide more details about how to configure your namespace ResourceQuota"
11017,awx,https://github.com/ansible/awx/issues/11017,Unable to use ansible_facts for smart inventory source,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary One older article describes how ansible_facts can be used to create smart inventory within AWX/Ansible tower: https://www.ansible.com/blog/ansible-tower-advanced-smart-inventory-usage Unfortunately this feature seems to be broken or not properly documented, as API doesn't seem to be recognizing field ansible_facts. GET to /api/v2/hosts/?ansible_facts.ansible_distribution_version=18.04 ``` HTTP 400 Bad Request Allow: GET, POST, HEAD, OPTIONS Content-Type: application/json Vary: Accept X-API-Node: awx-6bd564b87c-26bv6 X-API-Product-Name: AWX X-API-Product-Version: 19.3.0 X-API-Time: 0.005s { ""error"": ""Host has no field named 'ansible_facts.ansible_distribution_version'"" } ``` ### AWX version 19.3.0 ### Installation method kubernetes ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser Firefox ### Steps to reproduce 1. Go to Inventory 2. Add - Smart Inventory 3. Try to filter using ""Smart host filter"" field Alternative: 1. Go to /api/v2/hosts/ 2. try using query string with desired field (eg /api/v2/hosts/?ansible_facts.ansible_distribution_version=18.04) ### Expected results API queries facts and displays hosts that only match those facts ### Actual results API complains that the field is incorrect ### Additional information Using any top-level field works normally: eg. /api/v2/hosts/?id=302 (if host with ID 302 in AWX exists) returns properties for that host. It would appear that since the ansible_facts is just a reference to additional page that the API is not able to query it.",source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | source-file,unable use ansible facts smart inventory please confirm following agree follow project conduct http docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free entitled status updates assurances summary one older article describes ansible facts used create smart inventory within ansible tower https www ansible blog ansible tower advanced smart inventory usage unfortunately feature seems broken properly documented api seem recognizing field ansible facts get api hosts ansible facts ansible distribution http bad allow get post head options content type application json vary accept api node api product name api product api time host field named ansible facts ansible distribution installation method kubernetes modifications ansible response operating system response web browser firefox steps reproduce inventory smart inventory filter smart host filter field alternative api hosts query string desired field api hosts ansible facts ansible distribution expected results api queries facts displays hosts match facts actual results api complains field incorrect additional information top level field works normally api hosts host exists returns properties host would appear since ansible facts reference additional page api able query,bug,0.95,"Unable to use ansible_facts for smart inventory source ### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary One older article describes how ansible_facts can be used to create smart inventory within AWX/Ansible tower: https://www.ansible.com/blog/ansible-tower-advanced-smart-inventory-usage Unfortunately this feature seems to be broken or not properly documented, as API doesn't seem to be recognizing field ansible_facts. GET to /api/v2/hosts/?ansible_facts.ansible_distribution_version=18.04 ``` HTTP 400 Bad Request Allow: GET, POST, HEAD, OPTIONS Content-Type: application/json Vary: Accept X-API-Node: awx-6bd564b87c-26bv6 X-API-Product-Name: AWX X-API-Product-Version: 19.3.0 X-API-Time: 0.005s { ""error"": ""Host has no field named 'ansible_facts.ansible_distribution_version'"" } ``` ### AWX version 19.3.0 ### Installation method kubernetes ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser Firefox ### Steps to reproduce 1. Go to Inventory 2. Add - Smart Inventory 3. Try to filter using ""Smart host filter"" field Alternative: 1. Go to /api/v2/hosts/ 2. try using query string with desired field (eg /api/v2/hosts/?ansible_facts.ansible_distribution_version=18.04) ### Expected results API queries facts and displays hosts that only match those facts ### Actual results API complains that the field is incorrect ### Additional information Using any top-level field works normally: eg. /api/v2/hosts/?id=302 (if host with ID 302 in AWX exists) returns properties for that host. It would appear that since the ansible_facts is just a reference to additional page that the API is not able to query it."
10152,awx,https://github.com/ansible/awx/issues/10152,AWX 19.1: management jobs can not be scheduled,"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY I'm trying to edit the schedules for the management jobs, but the (existing) schedules are prefilled with values that can't be saved?? ##### ENVIRONMENT * AWX version: 19.1.0 * AWX install method: k3s on debian buster, deployed with awx-operator 0.9.0 * Ansible version: n/a at this point * Operating System: whatever is used inside the containers? * Web Browser: any ##### STEPS TO REPRODUCE 1. click ""management jobs"" 2. click any one job of the four 3. edit or create a schedule 4. observe ""start time"" is prefilled with ""NaN-NaN-NaNTNaN:NaN:NaN"" even if the job had been edited and/or run before already 5. observe how it is impossible to save the schedule unless you manually change the start time to some value that makes sense ##### EXPECTED RESULTS I'd expect the ""start time"" to be either 01-01-1970T00:00:00 or the time the AWX instance was deployed before its first run, then the time&date of the first run ##### ACTUAL RESULTS Schedule can not be saved. ##### ADDITIONAL INFORMATION",other-file | other-file | test-file | other-file | test-file | other-file | test-file | other-file | other-file | test-file | source-file | other-file | test-file | other-file | test-file,management jobs scheduled issues concrete actionable bugs feature requests asking debugging help technical please use http webchat freenode channels ansible https groups google forum forum project limit limited volunteer time respond issues type bug report summary trying edit schedules management jobs existing schedules prefilled values saved environment install method debian buster deployed operator ansible point operating system whatever used inside containers web browser steps reproduce click management jobs click one job four edit create schedule observe start time prefilled nan nan nantnan nan nan even job edited already observe impossible save schedule unless manually start time value makes sense expected results expect start time either time instance deployed first time date first actual results schedule saved additional information,bug,0.8,"AWX 19.1: management jobs can not be scheduled <!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use: - http://webchat.freenode.net/?channels=ansible-awx - https://groups.google.com/forum/#!forum/awx-project We have to limit this because of limited volunteer time to respond to issues! --> ##### ISSUE TYPE - Bug Report ##### SUMMARY I'm trying to edit the schedules for the management jobs, but the (existing) schedules are prefilled with values that can't be saved?? ##### ENVIRONMENT * AWX version: 19.1.0 * AWX install method: k3s on debian buster, deployed with awx-operator 0.9.0 * Ansible version: n/a at this point * Operating System: whatever is used inside the containers? * Web Browser: any ##### STEPS TO REPRODUCE 1. click ""management jobs"" 2. click any one job of the four 3. edit or create a schedule 4. observe ""start time"" is prefilled with ""NaN-NaN-NaNTNaN:NaN:NaN"" even if the job had been edited and/or run before already 5. observe how it is impossible to save the schedule unless you manually change the start time to some value that makes sense ##### EXPECTED RESULTS I'd expect the ""start time"" to be either 01-01-1970T00:00:00 or the time the AWX instance was deployed before its first run, then the time&date of the first run ##### ACTUAL RESULTS Schedule can not be saved. ##### ADDITIONAL INFORMATION"
11442,awx,https://github.com/ansible/awx/issues/11442,Workflow Visualizer making endless API requests with no result,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary When a user creates a workflow and saves and is redirected to the visualizer screen, API requests happen endlessly, with no result. Note: I am able to recreate this on an ec2 instance as well as a local build. ### AWX version devel ### Installation method docker on linux ### Modifications no ### Ansible version _No response_ ### Operating system Fedora 35 ### Web browser Chrome ### Steps to reproduce 1. access the templates page. 2. create a new workflow template. 3. when the redirect to the visualizer happens, you will see the problem. https://user-images.githubusercontent.com/63685497/145466510-0b5de590-ee87-446e-9b58-058ce7bca611.mp4 ### Expected results user would be able to create, save, and launch a workflow. ### Actual results the visualizer is not working properly and submits endless API requests. ### Additional information _No response_",source-file | source-file | source-file | source-file,workflow visualizer making endless api requests result please confirm following agree follow project conduct http docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free entitled status updates assurances summary user creates workflow saves redirected visualizer screen api requests happen endlessly result note able recreate instance well local devel installation method docker linux modifications ansible response operating system fedora web browser chrome steps reproduce access templates page create new workflow template redirect visualizer happens see https user images githubusercontent bca expected results user would able create save launch workflow actual results visualizer working properly submits endless api requests additional information response,bug,0.9,"Workflow Visualizer making endless API requests with no result ### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary When a user creates a workflow and saves and is redirected to the visualizer screen, API requests happen endlessly, with no result. Note: I am able to recreate this on an ec2 instance as well as a local build. ### AWX version devel ### Installation method docker on linux ### Modifications no ### Ansible version _No response_ ### Operating system Fedora 35 ### Web browser Chrome ### Steps to reproduce 1. access the templates page. 2. create a new workflow template. 3. when the redirect to the visualizer happens, you will see the problem. https://user-images.githubusercontent.com/63685497/145466510-0b5de590-ee87-446e-9b58-058ce7bca611.mp4 ### Expected results user would be able to create, save, and launch a workflow. ### Actual results the visualizer is not working properly and submits endless API requests. ### Additional information _No response_"
6366,awx,https://github.com/ansible/awx/issues/6366,[awx-pf] Can't edit job templates,"##### ISSUE TYPE - Bug Report ##### SUMMARY Tried to edit the name and description of a job template. It doesn't change when I click save. Reproduction: 1. Make a job template 2. Try to edit various things about it. pretty straightforward. I don't see any 400s or anything, though feel free to poke around and see what you find.",source-file | test-file,edit job templates type bug report summary tried edit name description job template click save reproduction make job template edit various things pretty straightforward see anything though feel free poke around see find,bug,0.7,"[awx-pf] Can't edit job templates ##### ISSUE TYPE - Bug Report ##### SUMMARY Tried to edit the name and description of a job template. It doesn't change when I click save. Reproduction: 1. Make a job template 2. Try to edit various things about it. pretty straightforward. I don't see any 400s or anything, though feel free to poke around and see what you find."
4781,awx,https://github.com/ansible/awx/issues/4781,workflow_job_template_nodes POST authentication issuees,"##### ISSUE TYPE - Bug Report ##### SUMMARY When trying to POST to workflow_job_template_nodes using basic auth and/or token-auth AWX replies with 401 failure. `awx_web | 2019-09-19 08:40:32,754 WARNING awx.api.generics status 401 received by user AnonymousUser attempting to access /api/v2/workflow_job_template_nodes/ from XXX.XXX.XXX.XXX awx_web | 2019-09-19 08:40:32,780 WARNING django.request Bad Request: /api/v2/workflow_job_template_nodes/ awx_web | 2019-09-19 08:40:32,780 WARNING django.request Bad Request: /api/v2/workflow_job_template_nodes/ awx_web | [pid: 153|app: 0|req: 57/208] XXX.XXX.XXX.XXX () {38 vars in 568 bytes} [Thu Sep 19 08:40:32 2019] POST /api/v2/workflow_job_template_nodes/ => generated 140 bytes in 74 msecs (HTTP/1.1 400) 8 headers in 246 bytes (1 switches on core 0) awx_web | XXX.XXX.XXX.XXX - - [19/Sep/2019:08:40:32 +0000] ""POST /api/v2/workflow_job_template_nodes/ HTTP/1.1"" 400 140 ""-"" ""curl/7.54.0"" ""-""` ##### ENVIRONMENT * AWX version: 7.0.0 * AWX install method: docker on linux * Ansible version: 2.6 * Operating System: CentOS * Web Browser: Curl 7.54 ##### STEPS TO REPRODUCE 0. nodes.json `{ { ""type"": ""workflow_job_template_node"", ""workflow_job_template"": { ""id"": 1238, ""name"": ""DNS WF"", ""description"": """" }, ""unified_job_template"": { ""id"": 820, ""name"": ""template-name"", ""unified_job_type"": ""job"" } ""extra_data"": {}, ""inventory"": null, ""scm_branch"": null, ""job_type"": null, ""job_tags"": """", ""skip_tags"": null, ""limit"": """", ""diff_mode"": null, ""verbosity"": null, ""workflow_job_template"": 1238, ""unified_job_template"": 820, ""success_nodes"": [], ""failure_nodes"": [], ""always_nodes"": [] } } ` 1. `curl -vvv -f -H 'Authorization: Token XXXX' -u username:password -H 'Content-Type: application/json' -XPOST http://awxhost/api/v2/workflow_job_template_nodes/ -d @nodes.json` ##### EXPECTED RESULTS Creation of nodes for related workflow ##### ACTUAL RESULTS Authorization failure. Client: ``` * The requested URL returned error: 400 Bad Request * stopped the pause stream! 100 706 0 0 100 706 0 7887 --:--:-- --:--:-- --:--:-- 7932 * Closing connection 0 curl: (22) The requested URL returned error: 400 Bad Request ``` Server: ``awx_web | 2019-09-19 08:40:32,754 WARNING awx.api.generics status 401 received by user AnonymousUser attempting to access /api/v2/workflow_job_template_nodes/ from XXX.XXX.XXX.XXX awx_web | 2019-09-19 08:40:32,780 WARNING django.request Bad Request: /api/v2/workflow_job_template_nodes/ awx_web | 2019-09-19 08:40:32,780 WARNING django.request Bad Request: /api/v2/workflow_job_template_nodes/ awx_web | [pid: 153|app: 0|req: 57/208] XXX.XXX.XXX.XXX () {38 vars in 568 bytes} [Thu Sep 19 08:40:32 2019] POST /api/v2/workflow_job_template_nodes/ => generated 140 bytes in 74 msecs (HTTP/1.1 400) 8 headers in 246 bytes (1 switches on core 0) awx_web | XXX.XXX.XXX.XXX - - [19/Sep/2019:08:40:32 +0000] ""POST /api/v2/workflow_job_template_nodes/ HTTP/1.1"" 400 140 ""-"" ""curl/7.54.0"" ""-""`` ##### ADDITIONAL INFORMATION",source-file,workflow job template nodes post authentication issuees type bug report summary trying post workflow job template nodes basic auth token auth replies failure web warning api generics status received user anonymoususer attempting access api workflow job template nodes xxx xxx xxx xxx web warning django bad api workflow job template nodes web warning django bad api workflow job template nodes web pid app req xxx xxx xxx xxx vars bytes sep post api workflow job template nodes generated bytes msecs http headers bytes switches core web xxx xxx xxx xxx sep post api workflow job template nodes http curl environment install method docker linux ansible operating system centos web browser curl steps reproduce nodes json type workflow job template node workflow job template name dns description unified job template name template name unified job type job extra data inventory null scm branch null job type null job tags skip tags null limit diff mode null verbosity null workflow job template unified job template success nodes failure nodes always nodes curl vvv authorization token xxxx username password content type application json xpost http awxhost api workflow job template nodes nodes json expected results creation nodes related workflow actual results authorization failure client requested url returned bad stopped pause stream closing connection curl requested url returned bad server web warning api generics status received user anonymoususer attempting access api workflow job template nodes xxx xxx xxx xxx web warning django bad api workflow job template nodes web warning django bad api workflow job template nodes web pid app req xxx xxx xxx xxx vars bytes sep post api workflow job template nodes generated bytes msecs http headers bytes switches core web xxx xxx xxx xxx sep post api workflow job template nodes http curl additional information,bug,0.9,"workflow_job_template_nodes POST authentication issuees ##### ISSUE TYPE - Bug Report ##### SUMMARY When trying to POST to workflow_job_template_nodes using basic auth and/or token-auth AWX replies with 401 failure. `awx_web | 2019-09-19 08:40:32,754 WARNING awx.api.generics status 401 received by user AnonymousUser attempting to access /api/v2/workflow_job_template_nodes/ from XXX.XXX.XXX.XXX awx_web | 2019-09-19 08:40:32,780 WARNING django.request Bad Request: /api/v2/workflow_job_template_nodes/ awx_web | 2019-09-19 08:40:32,780 WARNING django.request Bad Request: /api/v2/workflow_job_template_nodes/ awx_web | [pid: 153|app: 0|req: 57/208] XXX.XXX.XXX.XXX () {38 vars in 568 bytes} [Thu Sep 19 08:40:32 2019] POST /api/v2/workflow_job_template_nodes/ => generated 140 bytes in 74 msecs (HTTP/1.1 400) 8 headers in 246 bytes (1 switches on core 0) awx_web | XXX.XXX.XXX.XXX - - [19/Sep/2019:08:40:32 +0000] ""POST /api/v2/workflow_job_template_nodes/ HTTP/1.1"" 400 140 ""-"" ""curl/7.54.0"" ""-""` ##### ENVIRONMENT * AWX version: 7.0.0 * AWX install method: docker on linux * Ansible version: 2.6 * Operating System: CentOS * Web Browser: Curl 7.54 ##### STEPS TO REPRODUCE 0. nodes.json `{ { ""type"": ""workflow_job_template_node"", ""workflow_job_template"": { ""id"": 1238, ""name"": ""DNS WF"", ""description"": """" }, ""unified_job_template"": { ""id"": 820, ""name"": ""template-name"", ""unified_job_type"": ""job"" } ""extra_data"": {}, ""inventory"": null, ""scm_branch"": null, ""job_type"": null, ""job_tags"": """", ""skip_tags"": null, ""limit"": """", ""diff_mode"": null, ""verbosity"": null, ""workflow_job_template"": 1238, ""unified_job_template"": 820, ""success_nodes"": [], ""failure_nodes"": [], ""always_nodes"": [] } } ` 1. `curl -vvv -f -H 'Authorization: Token XXXX' -u username:password -H 'Content-Type: application/json' -XPOST http://awxhost/api/v2/workflow_job_template_nodes/ -d @nodes.json` ##### EXPECTED RESULTS Creation of nodes for related workflow ##### ACTUAL RESULTS Authorization failure. Client: ``` * The requested URL returned error: 400 Bad Request * stopped the pause stream! 100 706 0 0 100 706 0 7887 --:--:-- --:--:-- --:--:-- 7932 * Closing connection 0 curl: (22) The requested URL returned error: 400 Bad Request ``` Server: ``awx_web | 2019-09-19 08:40:32,754 WARNING awx.api.generics status 401 received by user AnonymousUser attempting to access /api/v2/workflow_job_template_nodes/ from XXX.XXX.XXX.XXX awx_web | 2019-09-19 08:40:32,780 WARNING django.request Bad Request: /api/v2/workflow_job_template_nodes/ awx_web | 2019-09-19 08:40:32,780 WARNING django.request Bad Request: /api/v2/workflow_job_template_nodes/ awx_web | [pid: 153|app: 0|req: 57/208] XXX.XXX.XXX.XXX () {38 vars in 568 bytes} [Thu Sep 19 08:40:32 2019] POST /api/v2/workflow_job_template_nodes/ => generated 140 bytes in 74 msecs (HTTP/1.1 400) 8 headers in 246 bytes (1 switches on core 0) awx_web | XXX.XXX.XXX.XXX - - [19/Sep/2019:08:40:32 +0000] ""POST /api/v2/workflow_job_template_nodes/ HTTP/1.1"" 400 140 ""-"" ""curl/7.54.0"" ""-""`` ##### ADDITIONAL INFORMATION"
8838,awx,https://github.com/ansible/awx/issues/8838,[ui_next] Inventory update Delete hits wrong endpoint,"##### ISSUE TYPE - Bug Report ##### SUMMARY Inventory update Delete hits wrong endpoint. ```I try to delete the SCM inventory update from the job page. It fails with an error about the inventory, but it shouldnt be deleting the inventory, it should only be deleting the update.``` ##### ENVIRONMENT * AWX version: 12/10 ##### MORE INFO Also, thats not the right number for the inventory, 66 is the ID of the inventory update. ![Screen Shot 2020-12-10 at 3 52 00 PM](https://user-images.githubusercontent.com/12446869/101828548-b30d5900-3aff-11eb-8a7a-d10208387cbd.png)",source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | test-file | other-file | other-file | other-file | other-file | test-file | other-file | other-file | source-file | source-file | test-file,next inventory delete hits wrong endpoint type bug report summary inventory delete hits wrong endpoint delete scm inventory job page fails inventory shouldnt deleting inventory deleting environment also thats right number inventory inventory screen shot https user images githubusercontent aff cbd png,bug,0.9,"[ui_next] Inventory update Delete hits wrong endpoint ##### ISSUE TYPE - Bug Report ##### SUMMARY Inventory update Delete hits wrong endpoint. ```I try to delete the SCM inventory update from the job page. It fails with an error about the inventory, but it shouldnt be deleting the inventory, it should only be deleting the update.``` ##### ENVIRONMENT * AWX version: 12/10 ##### MORE INFO Also, thats not the right number for the inventory, 66 is the ID of the inventory update. ![Screen Shot 2020-12-10 at 3 52 00 PM](https://user-images.githubusercontent.com/12446869/101828548-b30d5900-3aff-11eb-8a7a-d10208387cbd.png)"
4531,awx,https://github.com/ansible/awx/issues/4531,Unable to remove customized messages from notification template,"##### ISSUE TYPE - Bug Report ##### SUMMARY Unable to remove customized messages from notification template ##### STEPS TO REPRODUCE 1. Create a Slack notification with customized notification messages. 2. Edit Slack notification from step 1 and remove customized notification messages via toggle and save Note: 500 error ##### EXPECTED RESULTS 1. Default messages used and customize message toggle disabled ##### ACTUAL RESULTS HTTP 500 from API ##### ADDITIONAL INFORMATION <img width=""1497"" alt=""Screen Shot 2019-08-20 at 12 43 30 PM"" src=""https://user-images.githubusercontent.com/12446869/63366604-222dcf80-c348-11e9-80b7-a53a717a4b9f.png"">",source-file,unable customized messages notification template type bug report summary unable customized messages notification template steps reproduce create slack notification customized notification messages edit slack notification step customized notification messages via toggle save note expected results default messages used customize message toggle disabled actual results http api additional information img width alt screen shot https user images githubusercontent dcf png,bug,0.9,"Unable to remove customized messages from notification template ##### ISSUE TYPE - Bug Report ##### SUMMARY Unable to remove customized messages from notification template ##### STEPS TO REPRODUCE 1. Create a Slack notification with customized notification messages. 2. Edit Slack notification from step 1 and remove customized notification messages via toggle and save Note: 500 error ##### EXPECTED RESULTS 1. Default messages used and customize message toggle disabled ##### ACTUAL RESULTS HTTP 500 from API ##### ADDITIONAL INFORMATION <img width=""1497"" alt=""Screen Shot 2019-08-20 at 12 43 30 PM"" src=""https://user-images.githubusercontent.com/12446869/63366604-222dcf80-c348-11e9-80b7-a53a717a4b9f.png"">"
5028,awx,https://github.com/ansible/awx/issues/5028,500 Error when creating notification templates with bad message format,"```shell $ awx notification_templates create --name ""Testing 123"" --organization Default --notification_type webhook --messages '{""success"": ""500 error""}' --notification_configuration '{""url"": ""http://example.org"", ""headers"": {}}' ``` <img width=""932"" alt=""image"" src=""https://user-images.githubusercontent.com/214912/67009102-e2ba0000-f0b8-11e9-9346-816dea7ffa02.png"">",source-file | source-file,creating notification templates bad message format shell notification templates create name testing organization default notification type webhook messages success notification configuration url http example headers img width alt image https user images githubusercontent dea ffa png,bug,0.9,"500 Error when creating notification templates with bad message format ```shell $ awx notification_templates create --name ""Testing 123"" --organization Default --notification_type webhook --messages '{""success"": ""500 error""}' --notification_configuration '{""url"": ""http://example.org"", ""headers"": {}}' ``` <img width=""932"" alt=""image"" src=""https://user-images.githubusercontent.com/214912/67009102-e2ba0000-f0b8-11e9-9346-816dea7ffa02.png"">"
5744,awx,https://github.com/ansible/awx/issues/5744,More Helpful Error Message on api/v2/inventories Endpoint,"##### ISSUE TYPE - Bug Report ##### SUMMARY When trying to change a regular inventory into a ""smart"" inventory, the `PUT` and `PATCH` both error out (as they should), but the error message is not very informative. Please see screenshots below for both PUT and PATCH errors: <img width=""1048"" alt=""PUTNotAllowed"" src=""https://user-images.githubusercontent.com/28930622/72933561-f3b98380-3d2f-11ea-9269-7320367cabb3.png""> <img width=""1033"" alt=""PATCHNotAllowed"" src=""https://user-images.githubusercontent.com/28930622/72933566-f6b47400-3d2f-11ea-8540-147b2da53dc8.png""> It would be nice if the error was something more along the lines of `'You cannot turn a regular inventory into a ""smart"" inventory.'` ##### ENVIRONMENT * AWX version: 9.1.1 * AWX install method: docker for mac * Web Browser: Chrome ##### STEPS TO REPRODUCE Navigate to a pre-existing _regular_ inventory endpoint via `api/v2/inventories/[id]`, then try to `PUT` or `PATCH` to try to make it into a ""smart"" inventory: ``` { ""name"": ""[inventory_name]"", ""description"": """", ""organization"": [inventory_id], ""kind"": ""smart"", ""host_filter"": null, ""variables"": """", ""insights_credential"": null } ``` ##### EXPECTED RESULTS An error message that tells the user that a regular inventory can't be turned into a smart inventory. ##### ACTUAL RESULTS ``` { ""detail"": ""Method \""PATCH\"" not allowed."" } ```",documentation-file | documentation-file | source-file | other-file | other-file | other-file | test-file | documentation-file | documentation-file | source-file | other-file | other-file | other-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | test-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | test-file | source-file | source-file | test-file | source-file | test-file | source-file | test-file | source-file | source-file | source-file | test-file | test-file,helpful message api inventories endpoint type bug report summary trying regular inventory smart inventory put message informative please see screenshots put errors img width alt putnotallowed https user images githubusercontent cabb png img width alt patchnotallowed https user images githubusercontent png would nice something along lines cannot turn regular inventory smart inventory environment install method docker mac web browser chrome steps reproduce navigate pre existing regular inventory endpoint via api inventories put make smart inventory name inventory name description organization inventory kind smart host filter null variables insights credential null expected results message tells user regular inventory turned smart inventory actual results detail method allowed,bug,0.9,"More Helpful Error Message on api/v2/inventories Endpoint ##### ISSUE TYPE - Bug Report ##### SUMMARY When trying to change a regular inventory into a ""smart"" inventory, the `PUT` and `PATCH` both error out (as they should), but the error message is not very informative. Please see screenshots below for both PUT and PATCH errors: <img width=""1048"" alt=""PUTNotAllowed"" src=""https://user-images.githubusercontent.com/28930622/72933561-f3b98380-3d2f-11ea-9269-7320367cabb3.png""> <img width=""1033"" alt=""PATCHNotAllowed"" src=""https://user-images.githubusercontent.com/28930622/72933566-f6b47400-3d2f-11ea-8540-147b2da53dc8.png""> It would be nice if the error was something more along the lines of `'You cannot turn a regular inventory into a ""smart"" inventory.'` ##### ENVIRONMENT * AWX version: 9.1.1 * AWX install method: docker for mac * Web Browser: Chrome ##### STEPS TO REPRODUCE Navigate to a pre-existing _regular_ inventory endpoint via `api/v2/inventories/[id]`, then try to `PUT` or `PATCH` to try to make it into a ""smart"" inventory: ``` { ""name"": ""[inventory_name]"", ""description"": """", ""organization"": [inventory_id], ""kind"": ""smart"", ""host_filter"": null, ""variables"": """", ""insights_credential"": null } ``` ##### EXPECTED RESULTS An error message that tells the user that a regular inventory can't be turned into a smart inventory. ##### ACTUAL RESULTS ``` { ""detail"": ""Method \""PATCH\"" not allowed."" } ```"
5478,awx,https://github.com/ansible/awx/issues/5478,Deleting Oauth token with itself throws 500 error,1. create an Oauth token for a user 2. delete the Oauth token using itself as the Bearer `curl -k -H 'Authorization: Bearer r8jwGD25D9rIDQ6F1lqcRwrejR9gR7' -X DELETE https://localhost/api/v2/tokens/21/` 3. Observe HTTP 500,source-file,deleting oauth token throws create oauth token user delete oauth token bearer curl authorization bearer jwgd ridq lqcrwrejr delete https localhost api tokens observe http,bug,0.9,Deleting Oauth token with itself throws 500 error 1. create an Oauth token for a user 2. delete the Oauth token using itself as the Bearer `curl -k -H 'Authorization: Bearer r8jwGD25D9rIDQ6F1lqcRwrejR9gR7' -X DELETE https://localhost/api/v2/tokens/21/` 3. Observe HTTP 500
6653,awx,https://github.com/ansible/awx/issues/6653,Machine credentials are refused by tower_job_template,"##### ISSUE TYPE - Bug Report ##### SUMMARY Can't create job template with tower_job_template because of credentials. Machine credentials (SSH) are refused. ##### ENVIRONMENT * AWX version: 10.0.0 * AWX install method: docker on linux * Ansible version: 2.9.5 * Operating System: Debian Buster * Web Browser: Firefox * AWX collection: 10.0.0 ##### STEPS TO REPRODUCE ``` - name: Creation templates tower_job_template: name: ""{{ item.name }}"" playbook: ""{{ item.playbook }}"" inventory: ""{{ awx_inventory }}"" project: ""{{ awx_inventory }}"" credentials: - ""ssh-root-key"" survey_enabled: yes survey_spec: name: ""survey {{ item.name }}"" description: """" spec: ""{{ item.survey_spec }}"" tower_host: ""{{ tower_host }}"" tower_username: ""{{ tower_username }}"" tower_password: ""{{ tower_password }}"" validate_certs: False with_items: ""{{ awx_job_templates }}"" loop_control: label: ""{{ item.name }}"" tags: templates ``` ##### EXPECTED RESULTS Template created ##### ACTUAL RESULTS ``` { ""ansible_loop_var"":""item"", ""changed"":false, ""item"":{ ""job_type"":""run"", ""name"":""Provisionning TWIN"", ""playbook"":""play-provisioning_twin.yml"", }, ""msg"":""Failed to add credential to job template: The Tower server claims it was sent a bad request.\n\nPOST https://localhost/api/v2/job_templates/9/extra_credentials/\nParams: None\nData: {\""id\"": 3, \""associate\"": true}\n\nResponse: {\""error\"":\""Extra credentials must be network or cloud.\""}"" } ``` ##### ADDITIONAL INFORMATION `credential: ""ssh-root-key""` kinda works, but according to the documentation it is deprecated. And when I go into the web interface, the credentials field is empty.",source-file | test-file,machine credentials refused tower job template type bug report summary create job template tower job template credentials machine credentials ssh refused environment install method docker linux ansible operating system debian buster web browser firefox collection steps reproduce name creation templates tower job template name item name playbook item playbook inventory inventory project inventory credentials ssh root key survey enabled yes survey spec name survey item name description spec item survey spec tower host tower host tower username tower username tower password tower password validate certs false items job templates loop control label item name tags templates expected results template created actual results ansible loop var item changed false item job type name provisionning twin playbook play provisioning twin yml msg failed credential job template tower server claims sent bad npost https localhost api job templates extra credentials nparams none ndata associate true nresponse extra credentials must network cloud additional information credential ssh root key kinda works according documentation deprecated web interface credentials field empty,bug,0.9,"Machine credentials are refused by tower_job_template ##### ISSUE TYPE - Bug Report ##### SUMMARY Can't create job template with tower_job_template because of credentials. Machine credentials (SSH) are refused. ##### ENVIRONMENT * AWX version: 10.0.0 * AWX install method: docker on linux * Ansible version: 2.9.5 * Operating System: Debian Buster * Web Browser: Firefox * AWX collection: 10.0.0 ##### STEPS TO REPRODUCE ``` - name: Creation templates tower_job_template: name: ""{{ item.name }}"" playbook: ""{{ item.playbook }}"" inventory: ""{{ awx_inventory }}"" project: ""{{ awx_inventory }}"" credentials: - ""ssh-root-key"" survey_enabled: yes survey_spec: name: ""survey {{ item.name }}"" description: """" spec: ""{{ item.survey_spec }}"" tower_host: ""{{ tower_host }}"" tower_username: ""{{ tower_username }}"" tower_password: ""{{ tower_password }}"" validate_certs: False with_items: ""{{ awx_job_templates }}"" loop_control: label: ""{{ item.name }}"" tags: templates ``` ##### EXPECTED RESULTS Template created ##### ACTUAL RESULTS ``` { ""ansible_loop_var"":""item"", ""changed"":false, ""item"":{ ""job_type"":""run"", ""name"":""Provisionning TWIN"", ""playbook"":""play-provisioning_twin.yml"", }, ""msg"":""Failed to add credential to job template: The Tower server claims it was sent a bad request.\n\nPOST https://localhost/api/v2/job_templates/9/extra_credentials/\nParams: None\nData: {\""id\"": 3, \""associate\"": true}\n\nResponse: {\""error\"":\""Extra credentials must be network or cloud.\""}"" } ``` ##### ADDITIONAL INFORMATION `credential: ""ssh-root-key""` kinda works, but according to the documentation it is deprecated. And when I go into the web interface, the credentials field is empty."
6362,awx,https://github.com/ansible/awx/issues/6362,Can't Edit JT with no Inventory,"##### ISSUE TYPE - Bug Report ##### SUMMARY Can't Edit JT with no Inventory but Inventory Prompt on Launch ##### ENVIRONMENT * AWX version: 2.9 * AWX install method: docker for mac * Ansible version: 9.2 * Operating System: Mojave * Web Browser: Chrome ##### STEPS TO REPRODUCE Create a JT with no inventory, but click the Prompt On Launch checkbox. Go back and edit that inventory, but keep the inventory field empty and prompt on launch for it checked. ##### EXPECTED RESULTS The JT can be saved ##### ACTUAL RESULTS See that the JT can't be saved and returns a 400 error",source-file | source-file | source-file | test-file,edit inventory type bug report summary edit inventory inventory prompt launch environment install method docker mac ansible operating system mojave web browser chrome steps reproduce create inventory click prompt launch checkbox back edit inventory keep inventory field empty prompt launch checked expected results saved actual results see saved returns,bug,0.9,"Can't Edit JT with no Inventory ##### ISSUE TYPE - Bug Report ##### SUMMARY Can't Edit JT with no Inventory but Inventory Prompt on Launch ##### ENVIRONMENT * AWX version: 2.9 * AWX install method: docker for mac * Ansible version: 9.2 * Operating System: Mojave * Web Browser: Chrome ##### STEPS TO REPRODUCE Create a JT with no inventory, but click the Prompt On Launch checkbox. Go back and edit that inventory, but keep the inventory field empty and prompt on launch for it checked. ##### EXPECTED RESULTS The JT can be saved ##### ACTUAL RESULTS See that the JT can't be saved and returns a 400 error"
12992,awx,https://github.com/ansible/awx/issues/12992,scm_url doesn't allow [IPV6]:portnum format,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary IPv6 addresses like `http://user:pass@[4444:5555:6666:7777:8888:11]:3000/sbf/foster.git` throws an error when attempting to sync a project with that scm_url `update_scm_url` is where the traceback is the issue is that we strip down the address and reform it, but when reforming we don't add the brackets back in. `netloc = u'@'.join(filter(None, [netloc, parts.hostname]))` parts.hostname does not include the brackets if the original url had brackets around the hostname, then we should re-add them back in ### AWX version awx: 21.5.1.dev244+g5b5aac675b.d20221003 ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce create project with scm_url `http://user:pass@[4444:5555:6666:7777:8888:11]:3000/sbf/foster.git` attempt to launch a job ### Expected results job runs ### Actual results ```Traceback (most recent call last): File ""/awx_devel/awx/main/utils/common.py"", line 249, in update_scm_url if scm_type not in ('git', 'svn', 'insights', 'archive'): File ""/usr/lib64/python3.9/urllib/parse.py"", line 178, in port raise ValueError(message) from None ValueError: Port could not be cast to integer value as '5555:6666:7777:8888:11:3000' During handling of the above exception, another exception occurred: Traceback (most recent call last): File ""/awx_devel/awx/main/tasks/jobs.py"", line 512, in run self.build_extra_vars_file(self.instance, private_data_dir) File ""/awx_devel/awx/main/tasks/jobs.py"", line 1228, in build_extra_vars_file scm_url, extra_vars_new = self._build_scm_url_extra_vars(project_update) File ""/awx_devel/awx/main/tasks/jobs.py"", line 1203, in _build_scm_url_extra_vars scm_url = update_scm_url(scm_type, scm_url, scp_format=True) File ""/awx_devel/awx/main/utils/common.py"", line 249, in update_scm_url if scm_type not in ('git', 'svn', 'insights', 'archive'): ValueError: Invalid git URL``` ### Additional information _No response_",test-file | source-file | test-file | source-file | test-file | source-file,scm url allow ipv portnum format please confirm following agree follow project conduct https docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free might receive timely response bug summary ipv addresses like http user pass sbf foster git throws attempting sync project scm url scm url traceback strip address reform reforming brackets back netloc join filter none netloc parts hostname parts hostname include brackets original url brackets around hostname back aac select relevant components api docs collection cli installation method docker development environment modifications ansible response operating system response web browser response steps reproduce create project scm url http user pass sbf foster git attempt launch job expected results job runs actual results traceback recent call last devel utils common scm url scm type git svn insights archive python urllib parse port raise valueerror message none valueerror port could cast integer value handling exception another exception occurred traceback recent call last devel tasks jobs self extra vars self instance private data dir devel tasks jobs extra vars scm url extra vars new self scm url extra vars project devel tasks jobs scm url extra vars scm url scm url scm type scm url scp format true devel utils common scm url scm type git svn insights archive valueerror invalid git url additional information response,bug,0.9,"scm_url doesn't allow [IPV6]:portnum format ### Please confirm the following - [X] I agree to follow this project's [code of conduct](https://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I might not receive a timely response. ### Bug Summary IPv6 addresses like `http://user:pass@[4444:5555:6666:7777:8888:11]:3000/sbf/foster.git` throws an error when attempting to sync a project with that scm_url `update_scm_url` is where the traceback is the issue is that we strip down the address and reform it, but when reforming we don't add the brackets back in. `netloc = u'@'.join(filter(None, [netloc, parts.hostname]))` parts.hostname does not include the brackets if the original url had brackets around the hostname, then we should re-add them back in ### AWX version awx: 21.5.1.dev244+g5b5aac675b.d20221003 ### Select the relevant components - [ ] UI - [X] API - [ ] Docs - [ ] Collection - [ ] CLI - [ ] Other ### Installation method docker development environment ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser _No response_ ### Steps to reproduce create project with scm_url `http://user:pass@[4444:5555:6666:7777:8888:11]:3000/sbf/foster.git` attempt to launch a job ### Expected results job runs ### Actual results ```Traceback (most recent call last): File ""/awx_devel/awx/main/utils/common.py"", line 249, in update_scm_url if scm_type not in ('git', 'svn', 'insights', 'archive'): File ""/usr/lib64/python3.9/urllib/parse.py"", line 178, in port raise ValueError(message) from None ValueError: Port could not be cast to integer value as '5555:6666:7777:8888:11:3000' During handling of the above exception, another exception occurred: Traceback (most recent call last): File ""/awx_devel/awx/main/tasks/jobs.py"", line 512, in run self.build_extra_vars_file(self.instance, private_data_dir) File ""/awx_devel/awx/main/tasks/jobs.py"", line 1228, in build_extra_vars_file scm_url, extra_vars_new = self._build_scm_url_extra_vars(project_update) File ""/awx_devel/awx/main/tasks/jobs.py"", line 1203, in _build_scm_url_extra_vars scm_url = update_scm_url(scm_type, scm_url, scp_format=True) File ""/awx_devel/awx/main/utils/common.py"", line 249, in update_scm_url if scm_type not in ('git', 'svn', 'insights', 'archive'): ValueError: Invalid git URL``` ### Additional information _No response_"
4907,awx,https://github.com/ansible/awx/issues/4907,inventory updates + project updates deployed to container groups don't report execution node,"##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> This is a known issue of https://github.com/ansible/awx/pull/4189 that will be resolved in follow up PR. Inventory updates need to run on a Tower node, and this does happen even when ""deployed"" to a Container Group. The problem is, there is no way to figure out from API what tower node it was deployed to. This is connected to the fact that there is no designated ""controller node"" for the Container Groups, solving that may help this. Regardless, currently if an inventory update is ""deployed"" to a container group it will show the container group on the inventory update, but no execution node or controller node, so it is unclear where the update actually ran. ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> 1) create a working Container Group 2) Create an organization 3) Assign Container Group to organization as only instance group 4) create inventory with inventory source OR create project 5) launch inventory update or project update ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> One of the Tower nodes is shown as execution node ##### ACTUAL RESULTS <!-- What actually happened? --> No execution node, only container group shown",source-file | source-file,inventory updates project updates deployed container groups report execution node type bug report summary briefly describe known https github ansible resolved follow inventory updates need tower node happen even deployed container group way figure api tower node deployed connected fact designated controller node container groups solving may help regardless currently inventory deployed container group show container group inventory execution node controller node unclear actually ran steps reproduce please describe exactly reproduce create working container group create organization assign container group organization instance group create inventory inventory create project launch inventory project expected results expect happen running steps one tower nodes shown execution node actual results actually happened execution node container group shown,bug,0.9,"inventory updates + project updates deployed to container groups don't report execution node ##### ISSUE TYPE - Bug Report ##### SUMMARY <!-- Briefly describe the problem. --> This is a known issue of https://github.com/ansible/awx/pull/4189 that will be resolved in follow up PR. Inventory updates need to run on a Tower node, and this does happen even when ""deployed"" to a Container Group. The problem is, there is no way to figure out from API what tower node it was deployed to. This is connected to the fact that there is no designated ""controller node"" for the Container Groups, solving that may help this. Regardless, currently if an inventory update is ""deployed"" to a container group it will show the container group on the inventory update, but no execution node or controller node, so it is unclear where the update actually ran. ##### STEPS TO REPRODUCE <!-- Please describe exactly how to reproduce the problem. --> 1) create a working Container Group 2) Create an organization 3) Assign Container Group to organization as only instance group 4) create inventory with inventory source OR create project 5) launch inventory update or project update ##### EXPECTED RESULTS <!-- What did you expect to happen when running the steps above? --> One of the Tower nodes is shown as execution node ##### ACTUAL RESULTS <!-- What actually happened? --> No execution node, only container group shown"
10879,awx,https://github.com/ansible/awx/issues/10879,Errors caused by Social Auth Organization and Team Mapping; Users unable to login,"### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Attempting to configure Social Organization/Team Mapping prevents social-auth users from logging in. `awx-web` and postgres show errors. If ORGANIZATION_MAP and TEAM_MAP are reverted to default/empty, user is able to login. ### AWX version 19.2.2 ### Installation method kubernetes ### Modifications yes ### Ansible version _No response_ ### Operating system _No response_ ### Web browser Chrome ### Steps to reproduce 1. Fresh AWX 19.2.2 installation via awx-operator (0.12.0) with `create_preload_data: 'false'` 2. Log in as Admin; Configure Github Organization OAuth2 Social Auth ( do not configure org/team maps ) ```json { ""SOCIAL_AUTH_GITHUB_ORG_CALLBACK_URL"": ""https://my-awx-install.com/sso/complete/github-org/"", ""SOCIAL_AUTH_GITHUB_ORG_KEY"": ""<redacted>"", ""SOCIAL_AUTH_GITHUB_ORG_SECRET"": ""$encrypted$"", ""SOCIAL_AUTH_GITHUB_ORG_ORGANIZATION_MAP"": null, ""SOCIAL_AUTH_GITHUB_ORG_TEAM_MAP"": null } ``` 3. Validate Step 2 configs by logging in via Github Org Social Auth 4. Log out. 5. Login as Admin; Configure Org/Team Maps (I tried this in both the Global and GitHub Org specific configs) ```json { ""SOCIAL_AUTH_GITHUB_ORG_CALLBACK_URL"": ""https://my-awx-install.com/sso/complete/github-org/"", ""SOCIAL_AUTH_GITHUB_ORG_KEY"": ""<redacted>"", ""SOCIAL_AUTH_GITHUB_ORG_SECRET"": ""$encrypted$"", ""SOCIAL_AUTH_GITHUB_ORG_NAME"": ""MyOrg"", ""SOCIAL_AUTH_GITHUB_ORG_ORGANIZATION_MAP"": { ""MyOrg"": { ""users"": [ ""me@example.com"" ], ""admins"": [ ""admin@example.com"" ], ""remove_users"": true, ""remove_admins"": true } }, ""SOCIAL_AUTH_GITHUB_ORG_TEAM_MAP"": { ""operations-team"": { ""remove"": true, ""organization"": ""MyOrg"", ""users"": [ ""me@example.com"" ] } } } ``` 6. Attempt to login as user; Get redirected to login page; Observe error awx-web and postgres error logs ### Expected results Organizations specified by valid Social Auth Org map(s) are created automatically Teams specified by valid Social Auth Team map(s) are created automatically Users are able to login as specified by Social Auth Org/Team maps ### Actual results User was not able to login following Org/Map configuration. Organization and Teams were not created on our behalf. `postgres` errors ```bash 2021-08-13 21:39:42.438 UTC [2886] STATEMENT: INSERT INTO ""main_organizationgalaxycredentialmembership"" (""organization_id"", ""credential_id"", ""position"") VALUES (1, NULL, NULL) RETURNING ""main_organizationgalaxycredentialmembership"".""id"" 2021-08-13 21:39:42.438 UTC [2886] ERROR: null value in column ""credential_id"" violates not-null constraint 2021-08-13 21:39:42.438 UTC [2886] DETAIL: Failing row contains (1, null, null, 1). ``` `awx-web` errors ``` 2021-08-13 21:39:42,440 ERROR [c6496ec03db747d3a7800f653acd316b] social null value in column ""credential_id"" violates not-null constraint DETAIL: Failing row contains (1, null, null, 1). . ``` ### Additional information * Installed via awx-operator with `create_preload_data: false` * Prior to opening this issue, I've also attempted this against 19.3.0 to no success.",source-file | source-file,errors caused social auth organization team mapping users unable login please confirm following agree follow project conduct http docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free entitled status updates assurances summary attempting configure social organization team mapping prevents social auth users logging web postgres show errors organization map team map reverted default empty user able login installation method kubernetes modifications yes ansible response operating system response web browser chrome steps reproduce fresh installation via operator create preload data false log admin configure github organization oauth social auth configure team maps json social auth github callback url https install sso complete github social auth github key redacted social auth github secret encrypted social auth github organization map null social auth github team map null validate step configs logging via github social auth log login admin configure team maps tried global github specific configs json social auth github callback url https install sso complete github social auth github key redacted social auth github secret encrypted social auth github name myorg social auth github organization map myorg users example admins admin example users true admins true social auth github team map operations team true organization myorg users example attempt login user get redirected login page observe web postgres logs expected results organizations specified valid social auth map created automatically teams specified valid social auth team map created automatically users able login specified social auth team maps actual results user able login following map configuration organization teams created behalf postgres errors bash utc statement insert organizationgalaxycredentialmembership organization credential position values null null returning organizationgalaxycredentialmembership utc null value column credential violates null constraint utc detail failing row contains null null web errors acd social null value column credential violates null constraint detail failing row contains null null additional information installed via operator create preload data false prior opening also attempted success,bug,0.9,"Errors caused by Social Auth Organization and Team Mapping; Users unable to login ### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Attempting to configure Social Organization/Team Mapping prevents social-auth users from logging in. `awx-web` and postgres show errors. If ORGANIZATION_MAP and TEAM_MAP are reverted to default/empty, user is able to login. ### AWX version 19.2.2 ### Installation method kubernetes ### Modifications yes ### Ansible version _No response_ ### Operating system _No response_ ### Web browser Chrome ### Steps to reproduce 1. Fresh AWX 19.2.2 installation via awx-operator (0.12.0) with `create_preload_data: 'false'` 2. Log in as Admin; Configure Github Organization OAuth2 Social Auth ( do not configure org/team maps ) ```json { ""SOCIAL_AUTH_GITHUB_ORG_CALLBACK_URL"": ""https://my-awx-install.com/sso/complete/github-org/"", ""SOCIAL_AUTH_GITHUB_ORG_KEY"": ""<redacted>"", ""SOCIAL_AUTH_GITHUB_ORG_SECRET"": ""$encrypted$"", ""SOCIAL_AUTH_GITHUB_ORG_ORGANIZATION_MAP"": null, ""SOCIAL_AUTH_GITHUB_ORG_TEAM_MAP"": null } ``` 3. Validate Step 2 configs by logging in via Github Org Social Auth 4. Log out. 5. Login as Admin; Configure Org/Team Maps (I tried this in both the Global and GitHub Org specific configs) ```json { ""SOCIAL_AUTH_GITHUB_ORG_CALLBACK_URL"": ""https://my-awx-install.com/sso/complete/github-org/"", ""SOCIAL_AUTH_GITHUB_ORG_KEY"": ""<redacted>"", ""SOCIAL_AUTH_GITHUB_ORG_SECRET"": ""$encrypted$"", ""SOCIAL_AUTH_GITHUB_ORG_NAME"": ""MyOrg"", ""SOCIAL_AUTH_GITHUB_ORG_ORGANIZATION_MAP"": { ""MyOrg"": { ""users"": [ ""me@example.com"" ], ""admins"": [ ""admin@example.com"" ], ""remove_users"": true, ""remove_admins"": true } }, ""SOCIAL_AUTH_GITHUB_ORG_TEAM_MAP"": { ""operations-team"": { ""remove"": true, ""organization"": ""MyOrg"", ""users"": [ ""me@example.com"" ] } } } ``` 6. Attempt to login as user; Get redirected to login page; Observe error awx-web and postgres error logs ### Expected results Organizations specified by valid Social Auth Org map(s) are created automatically Teams specified by valid Social Auth Team map(s) are created automatically Users are able to login as specified by Social Auth Org/Team maps ### Actual results User was not able to login following Org/Map configuration. Organization and Teams were not created on our behalf. `postgres` errors ```bash 2021-08-13 21:39:42.438 UTC [2886] STATEMENT: INSERT INTO ""main_organizationgalaxycredentialmembership"" (""organization_id"", ""credential_id"", ""position"") VALUES (1, NULL, NULL) RETURNING ""main_organizationgalaxycredentialmembership"".""id"" 2021-08-13 21:39:42.438 UTC [2886] ERROR: null value in column ""credential_id"" violates not-null constraint 2021-08-13 21:39:42.438 UTC [2886] DETAIL: Failing row contains (1, null, null, 1). ``` `awx-web` errors ``` 2021-08-13 21:39:42,440 ERROR [c6496ec03db747d3a7800f653acd316b] social null value in column ""credential_id"" violates not-null constraint DETAIL: Failing row contains (1, null, null, 1). . ``` ### Additional information * Installed via awx-operator with `create_preload_data: false` * Prior to opening this issue, I've also attempted this against 19.3.0 to no success."
10008,awx,https://github.com/ansible/awx/issues/10008,awx.awx.tower_job_launch tags are not properly passed to API,"##### ISSUE TYPE - Bug Report ##### SUMMARY If you are using awx.awx.tower_job_launch to launch a job-/workflowtemplate in AWX and you pass tags to the job launch they will be ignored. Against expectations all tasks are executed not only those with the provided tags ##### ENVIRONMENT * AWX version: Tower 3.8.2 * Ansible version: Ansible 2.9.13 * Operating System: RHEL 8.3 ##### STEPS TO REPRODUCE Create a playbook similar to this: ``` - hosts: localhost gather_facts: no environment: TOWER_USERNAME: ""<<INPUT TOWER USERNAME HERE>>"" TOWER_HOST: ""<<INPUT TOWER HOST HERE>>"" TOWER_PASSWORD: ""<<INPUT TOWER USER PASSWORD HERE>>"" vars: ansible_connection: local tasks: - name: Launch a job template with a tag on remote Tower instance awx.awx.tower_job_launch: job_template: ""test_template"" inventory: ""test_inventory"" tags: - example_tag ``` Create a second playbook named ""test_template"" with two random tasks. One needs to be tagged with ""example_tag"" ##### EXPECTED RESULTS Only the task tagged with ""example_tag"" will be executed ##### ACTUAL RESULTS All tasks will be executed ##### ADDITIONAL INFORMATION The error occurs because [tower_job_launch.py](https://github.com/ansible/awx/blob/devel/awx_collection/plugins/modules/tower_job_launch.py) passes the wrong post data to the api. The tags have to be provided under key ""job_tags"". This can be found in [API documentation](https://docs.ansible.com/ansible-tower/latest/html/towerapi/api_ref.html#/Job_Templates/Job_Templates_job_templates_launch_read). Certainly the module passes the tags with the key ""tags"" which is wrong I think the follwing code needs to be adjusted: https://github.com/ansible/awx/blob/devel/awx_collection/plugins/modules/tower_job_launch.py#L184 The correct line should be: ` optional_args['job_tags'] = module.params.get('tags')` I will test the suggestion on monday and report the result.",source-file | test-file,tower job launch tags properly passed api type bug report summary tower job launch launch job workflowtemplate pass tags job launch ignored expectations tasks executed provided tags environment tower ansible ansible operating system rhel steps reproduce create playbook similar hosts localhost gather facts environment tower username input tower username tower host input tower host tower password input tower user password vars ansible connection local tasks name launch job template tag remote tower instance tower job launch job template template inventory inventory tags example tag create second playbook named template two random tasks one needs tagged example tag expected results task tagged example tag executed actual results tasks executed additional information occurs tower job launch https github ansible blob devel collection plugins modules tower job launch passes wrong post data api tags provided key job tags found api documentation https docs ansible ansible tower latest html towerapi api ref html job templates job templates job templates launch read certainly module passes tags key tags wrong think follwing needs adjusted https github ansible blob devel collection plugins modules tower job launch correct optional args job tags module params get tags suggestion monday report result,bug,0.95,"awx.awx.tower_job_launch tags are not properly passed to API ##### ISSUE TYPE - Bug Report ##### SUMMARY If you are using awx.awx.tower_job_launch to launch a job-/workflowtemplate in AWX and you pass tags to the job launch they will be ignored. Against expectations all tasks are executed not only those with the provided tags ##### ENVIRONMENT * AWX version: Tower 3.8.2 * Ansible version: Ansible 2.9.13 * Operating System: RHEL 8.3 ##### STEPS TO REPRODUCE Create a playbook similar to this: ``` - hosts: localhost gather_facts: no environment: TOWER_USERNAME: ""<<INPUT TOWER USERNAME HERE>>"" TOWER_HOST: ""<<INPUT TOWER HOST HERE>>"" TOWER_PASSWORD: ""<<INPUT TOWER USER PASSWORD HERE>>"" vars: ansible_connection: local tasks: - name: Launch a job template with a tag on remote Tower instance awx.awx.tower_job_launch: job_template: ""test_template"" inventory: ""test_inventory"" tags: - example_tag ``` Create a second playbook named ""test_template"" with two random tasks. One needs to be tagged with ""example_tag"" ##### EXPECTED RESULTS Only the task tagged with ""example_tag"" will be executed ##### ACTUAL RESULTS All tasks will be executed ##### ADDITIONAL INFORMATION The error occurs because [tower_job_launch.py](https://github.com/ansible/awx/blob/devel/awx_collection/plugins/modules/tower_job_launch.py) passes the wrong post data to the api. The tags have to be provided under key ""job_tags"". This can be found in [API documentation](https://docs.ansible.com/ansible-tower/latest/html/towerapi/api_ref.html#/Job_Templates/Job_Templates_job_templates_launch_read). Certainly the module passes the tags with the key ""tags"" which is wrong I think the follwing code needs to be adjusted: https://github.com/ansible/awx/blob/devel/awx_collection/plugins/modules/tower_job_launch.py#L184 The correct line should be: ` optional_args['job_tags'] = module.params.get('tags')` I will test the suggestion on monday and report the result."
6520,awx,https://github.com/ansible/awx/issues/6520,Logout button on the API for ui-next does not work,"##### ISSUE TYPE - Bug Report ##### SUMMARY Click on the logout button on the API for ui-next makes a get request instead of a post request, due to which an error is thrown ##### STEPS TO REPRODUCE 1. https://localhost:3000/api 2. click on the logout button <img width=""352"" alt=""Screen Shot 2020-04-01 at 10 28 17 AM"" src=""https://user-images.githubusercontent.com/11617351/78149937-98c59c00-7404-11ea-9a9d-f954d1e9e24f.png""> ##### EXPECTED RESULTS The logout should be successfull ##### ACTUAL RESULTS An error is thrown: <img width=""533"" alt=""Screen Shot 2020-04-01 at 10 28 34 AM"" src=""https://user-images.githubusercontent.com/11617351/78149948-9c592300-7404-11ea-8be8-cb87c67542cf.png"">",test-file,logout button api next work type bug report summary click logout button api next makes get instead post due thrown steps reproduce https localhost api click logout button img width alt screen shot https user images githubusercontent png expected results logout successfull actual results thrown img width alt screen shot https user images githubusercontent png,bug,0.9,"Logout button on the API for ui-next does not work ##### ISSUE TYPE - Bug Report ##### SUMMARY Click on the logout button on the API for ui-next makes a get request instead of a post request, due to which an error is thrown ##### STEPS TO REPRODUCE 1. https://localhost:3000/api 2. click on the logout button <img width=""352"" alt=""Screen Shot 2020-04-01 at 10 28 17 AM"" src=""https://user-images.githubusercontent.com/11617351/78149937-98c59c00-7404-11ea-9a9d-f954d1e9e24f.png""> ##### EXPECTED RESULTS The logout should be successfull ##### ACTUAL RESULTS An error is thrown: <img width=""533"" alt=""Screen Shot 2020-04-01 at 10 28 34 AM"" src=""https://user-images.githubusercontent.com/11617351/78149948-9c592300-7404-11ea-8be8-cb87c67542cf.png"">"
6225,awx,https://github.com/ansible/awx/issues/6225,ask_variables_on_launch issue on AWX,"##### ISSUE TYPE ask_variables_on_launch is set to true still getting error as undefined variable. ##### SUMMARY I have created a Job template via API and set the ask_variables_on_launch value to true. Though setting the value as true, playbook fails during execution, saying 'undefined variable' ##### ENVIRONMENT * AWX version: 9.2.0 * Tower CLI 3.3.8 * API v2 * AWX install method: Installation without Docker on CentOS7 * Ansible version: 2.9.5 * Operating System: CentOS Linux release 7.7.1908 (Core) * Web Browser: Google Chrome Version 80.0.3987.132 (Official Build) (64-bit) ##### STEPS TO REPRODUCE >> Created a Job Template for sample. >> Verify the values of the sample job template for 'project, inventory, playbook' attributes, and its corresponding values. >> With the values observed from the sample job template, create a new job template via APIv2 and set the value of ""ask_variables_on_launch to true"" * API URL: * http://awx-server-ip/api/v2/job_templates/ ##### EXPECTED RESULTS Being set the value of 'ask_variables_on_launch' to true, I should be able to execute the playbook by passing extra variable during launch of the playbook and via Survey as well. ##### ACTUAL RESULTS ""msg"": ""The task includes an option with an undefined variable. The error was: 'ansible.utils.unsafe_proxy.AnsibleUnsafeText object' has no attribute 'it_user'\n\nThe error appears to be in '/tmp/awx_25_ahs6_izp/project/useradd_IT.yml': line 7, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n tasks:\n - name: Adding users\n ^ here\n"", ""_ansible_no_log"": false --The same error occurred when the value of 'ask_variables_on_launch' set as false. ##### ADDITIONAL INFORMATION ![image](https://user-images.githubusercontent.com/47471901/76210019-3d4f2680-6229-11ea-95f8-04dc9ac4f84d.png) ![image](https://user-images.githubusercontent.com/47471901/76210151-87380c80-6229-11ea-8e8e-2359422c1276.png)",source-file,ask variables launch type ask variables launch set true still getting undefined variable summary created job template via api set ask variables launch value true though setting value true playbook fails execution saying undefined variable environment tower cli api install method installation without docker centos ansible operating system centos linux core web browser google chrome official bit steps reproduce created job template sample verify values sample job template project inventory playbook attributes corresponding values values observed sample job template create new job template via apiv set value ask variables launch true api url http server api job templates expected results set value ask variables launch true able execute playbook passing extra variable launch playbook via survey well actual results msg task includes option undefined variable ansible utils unsafe proxy ansibleunsafetext object attribute user nthe appears tmp ahs izp project useradd yml column may nbe elsewhere depending exact syntax nthe offending appears tasks name adding users ansible log false occurred value ask variables launch set false additional information image https user images githubusercontent png image https user images githubusercontent png,bug,0.85,"ask_variables_on_launch issue on AWX ##### ISSUE TYPE ask_variables_on_launch is set to true still getting error as undefined variable. ##### SUMMARY I have created a Job template via API and set the ask_variables_on_launch value to true. Though setting the value as true, playbook fails during execution, saying 'undefined variable' ##### ENVIRONMENT * AWX version: 9.2.0 * Tower CLI 3.3.8 * API v2 * AWX install method: Installation without Docker on CentOS7 * Ansible version: 2.9.5 * Operating System: CentOS Linux release 7.7.1908 (Core) * Web Browser: Google Chrome Version 80.0.3987.132 (Official Build) (64-bit) ##### STEPS TO REPRODUCE >> Created a Job Template for sample. >> Verify the values of the sample job template for 'project, inventory, playbook' attributes, and its corresponding values. >> With the values observed from the sample job template, create a new job template via APIv2 and set the value of ""ask_variables_on_launch to true"" * API URL: * http://awx-server-ip/api/v2/job_templates/ ##### EXPECTED RESULTS Being set the value of 'ask_variables_on_launch' to true, I should be able to execute the playbook by passing extra variable during launch of the playbook and via Survey as well. ##### ACTUAL RESULTS ""msg"": ""The task includes an option with an undefined variable. The error was: 'ansible.utils.unsafe_proxy.AnsibleUnsafeText object' has no attribute 'it_user'\n\nThe error appears to be in '/tmp/awx_25_ahs6_izp/project/useradd_IT.yml': line 7, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n tasks:\n - name: Adding users\n ^ here\n"", ""_ansible_no_log"": false --The same error occurred when the value of 'ask_variables_on_launch' set as false. ##### ADDITIONAL INFORMATION ![image](https://user-images.githubusercontent.com/47471901/76210019-3d4f2680-6229-11ea-95f8-04dc9ac4f84d.png) ![image](https://user-images.githubusercontent.com/47471901/76210151-87380c80-6229-11ea-8e8e-2359422c1276.png)"
5964,awx,https://github.com/ansible/awx/issues/5964,awx kit provides a bad error message,"##### ISSUE TYPE - Bug Report ##### SUMMARY When authentication fails awx kit gives a cryptic error message ##### ENVIRONMENT * AWX version: devel * AWX install method: mac * Ansible version: 2.8.2 * Operating System: mac * Web Browser: N/A ##### STEPS TO REPRODUCE Attempt to login to awx with bad credentials. ##### EXPECTED RESULTS > Unauthorized: Unauthorized (401) received - {'detail': 'Authentication credentials were not provided. To establish a login session, visit /api/login/.'} ##### ACTUAL RESULTS > TypeError: '>=' not supported between instances of 'Unauthorized' and 'int' ##### ADDITIONAL INFORMATION > akit --base-url httsp://some-awx -c ~/creds/credentials.vault -f load_resources.py -x",source-file,kit provides bad message type bug report summary authentication fails kit gives cryptic message environment devel install method mac ansible operating system mac web browser steps reproduce attempt login bad credentials expected results unauthorized unauthorized received detail authentication credentials provided establish login session visit api login actual results typeerror supported instances unauthorized int additional information akit base url httsp creds credentials vault load resources,bug,0.9,"awx kit provides a bad error message ##### ISSUE TYPE - Bug Report ##### SUMMARY When authentication fails awx kit gives a cryptic error message ##### ENVIRONMENT * AWX version: devel * AWX install method: mac * Ansible version: 2.8.2 * Operating System: mac * Web Browser: N/A ##### STEPS TO REPRODUCE Attempt to login to awx with bad credentials. ##### EXPECTED RESULTS > Unauthorized: Unauthorized (401) received - {'detail': 'Authentication credentials were not provided. To establish a login session, visit /api/login/.'} ##### ACTUAL RESULTS > TypeError: '>=' not supported between instances of 'Unauthorized' and 'int' ##### ADDITIONAL INFORMATION > akit --base-url httsp://some-awx -c ~/creds/credentials.vault -f load_resources.py -x"
6433,awx,https://github.com/ansible/awx/issues/6433,Can't save the modal when adding a team role to an organization,"##### ISSUE TYPE - Bug Report ##### SUMMARY The save button in this screenshot doesn't always work: ![Screenshot from 2020-03-26 09-39-57](https://user-images.githubusercontent.com/19942822/77653157-c9f62600-6f45-11ea-87d1-8c2ad40e1d12.png) ##### STEPS TO REPRODUCE 1. Make a team and org, put the team inside the org. 2. Go to org -> Access tab -> add a team permission 3. Try to give the team admin permissions. ##### EXPECTED RESULTS Clicking the save button works, or presents an error. ##### ACTUAL RESULTS No visual feedback, the button appears to not respond. The network tab presents a 400: ```{""msg"":""You cannot assign an Organization participation role as a child role for a Team.""}```",other-file | other-file,save modal adding team role organization type bug report summary save button screenshot always work screenshot https user images githubusercontent png steps reproduce make team put team inside access tab team permission give team admin permissions expected results clicking save button works presents actual results visual feedback button appears respond network tab presents msg cannot assign organization participation role child role team,bug,0.8,"Can't save the modal when adding a team role to an organization ##### ISSUE TYPE - Bug Report ##### SUMMARY The save button in this screenshot doesn't always work: ![Screenshot from 2020-03-26 09-39-57](https://user-images.githubusercontent.com/19942822/77653157-c9f62600-6f45-11ea-87d1-8c2ad40e1d12.png) ##### STEPS TO REPRODUCE 1. Make a team and org, put the team inside the org. 2. Go to org -> Access tab -> add a team permission 3. Try to give the team admin permissions. ##### EXPECTED RESULTS Clicking the save button works, or presents an error. ##### ACTUAL RESULTS No visual feedback, the button appears to not respond. The network tab presents a 400: ```{""msg"":""You cannot assign an Organization participation role as a child role for a Team.""}```"
11523,awx,https://github.com/ansible/awx/issues/11523,"/api/v2/ping is returning wrong value in ""heartbeat"" field","### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Summary: I believe that this behavior where two endpoints ( `/api/v2/ping` and `/api/v2/instances/` ) return different values for the same ""heartbeat"" like field is not consistent, and I think that `/api/v2/ping` ""heartbeat"" field should be mapped to `last_health_check` field of `Instance` model. Details: In AAP1.2 (Tower 3.8.4) `/api/v2/ping` response, ""heartbeat"" field was mapped to `instance.modified` (*), and the value ""heartbeat"" field in the response was returning a new updated value every minute. ~~~ /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/api/views/root.py class ApiV2PingView(APIView): ... def get(self, request, format=None): ... for instance in Instance.objects.all(): response['instances'].append(dict(node=instance.hostname, uuid=instance.uuid, heartbeat=instance.modified, <=== capacity=instance.capacity, version=instance.version)) ~~~ This is not the case anymore in AAP2.1 (Ansible Automation Platform Controller 4.1.0). I see that in AAP2.1 (Ansible Automation Platform Controller 4.1.0) `/api/v2/ping` ""heartbeat"" field is **still** mapped to modified , and not to `last_seen` nor to `last_health_check` that have been introduced for this purpose. ~~~ /var/lib/awx/venv/awx/lib/python3.8/site-packages/awx/api/views/root.py 133 class ApiV2PingView(APIView): 134 """"""A simple view that reports very basic information about this 135 instance, which is acceptable to be public information. 136 """""" .. 143 def get(self, request, format=None): ... 152 for instance in Instance.objects.all(): 153 response['instances'].append( 154 dict( ... 158 heartbeat=instance.modified, <======= ... ~~~ Because of that, `/api/v2/ping` will not return a new value every minute, it will return a new value only if the user fiddles manually with the instance properties (e.g. any change on Administration > Instance Group > ""any instance group"" > Instance Page, etc.). Now, being said that in AAP2.1 (Ansible Automation Platform Controller 4.1.0) `/api/v2/instances/` **does** return correctly all the fields, including last_seen and last_health_check which are updated every minute as expected. (*) back then, there was no `last_seen` nor `last_health_check` field in the Instance model ### AWX version Red Hat Downstream AAP2.1 ### Installation method docker on linux ### Modifications no ### Ansible version Ansible Automation Platform Controller 4.1.0 ### Operating system Linux RHEL8.3 ### Web browser Firefox ### Steps to reproduce Access `https://<awx-url>/api/v2/ping/` and compare the response with the one from `https://192.168.122.106/api/v2/instances/`. ""heartbeat"" value from `ping` endpoint will be older than the same value from `instances` endpoint. ### Expected results ""heartbeat"" value from `ping` endpoint should match ""last_seen"" and ""last_health_check"" values from `instances` endpoint results. (Not sure about ""last_seen"", but in my tests, said field have always had the same value as ""last_health_check"" field so far) ### Actual results ""heartbeat"" value from `ping` endpoint will be older than the same value from `instances` endpoint. ### Additional information Likely related commit: https://github.com/ansible/tower/commit/6a17e5b65bf9421c2e650d23817c79ce81248c6f Likely related issue: https://github.com/ansible/awx/issues/10737",source-file | source-file,api ping returning wrong value heartbeat field please confirm following agree follow project conduct http docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free entitled status updates assurances summary summary believe behavior two endpoints api ping api instances return different values heartbeat like field consistent think api ping heartbeat field mapped last health check field instance model details aap tower api ping response heartbeat field mapped instance modified value heartbeat field response returning new updated value every minute var venv python site packages api views root class apiv pingview apiview def get self format none instance instance objects response instances append dict node instance hostname uuid instance uuid heartbeat instance modified capacity instance capacity instance case anymore aap ansible automation platform controller see aap ansible automation platform controller api ping heartbeat field still mapped modified last seen last health check introduced purpose var venv python site packages api views root class apiv pingview apiview simple view reports basic information instance acceptable public information def get self format none instance instance objects response instances append dict heartbeat instance modified api ping return new value every minute return new value user fiddles manually instance properties administration instance group instance group instance page etc said aap ansible automation platform controller api instances return correctly fields including last seen last health check updated every minute expected back last seen last health check field instance model red hat downstream aap installation method docker linux modifications ansible ansible automation platform controller operating system linux rhel web browser firefox steps reproduce access https url api ping compare response one https api instances heartbeat value ping endpoint older value instances endpoint expected results heartbeat value ping endpoint match last seen last health check values instances endpoint results sure last seen tests said field always value last health check field far actual results heartbeat value ping endpoint older value instances endpoint additional information likely related https github ansible tower likely related https github ansible issues,bug,0.9,"/api/v2/ping is returning wrong value in ""heartbeat"" field ### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Summary: I believe that this behavior where two endpoints ( `/api/v2/ping` and `/api/v2/instances/` ) return different values for the same ""heartbeat"" like field is not consistent, and I think that `/api/v2/ping` ""heartbeat"" field should be mapped to `last_health_check` field of `Instance` model. Details: In AAP1.2 (Tower 3.8.4) `/api/v2/ping` response, ""heartbeat"" field was mapped to `instance.modified` (*), and the value ""heartbeat"" field in the response was returning a new updated value every minute. ~~~ /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/api/views/root.py class ApiV2PingView(APIView): ... def get(self, request, format=None): ... for instance in Instance.objects.all(): response['instances'].append(dict(node=instance.hostname, uuid=instance.uuid, heartbeat=instance.modified, <=== capacity=instance.capacity, version=instance.version)) ~~~ This is not the case anymore in AAP2.1 (Ansible Automation Platform Controller 4.1.0). I see that in AAP2.1 (Ansible Automation Platform Controller 4.1.0) `/api/v2/ping` ""heartbeat"" field is **still** mapped to modified , and not to `last_seen` nor to `last_health_check` that have been introduced for this purpose. ~~~ /var/lib/awx/venv/awx/lib/python3.8/site-packages/awx/api/views/root.py 133 class ApiV2PingView(APIView): 134 """"""A simple view that reports very basic information about this 135 instance, which is acceptable to be public information. 136 """""" .. 143 def get(self, request, format=None): ... 152 for instance in Instance.objects.all(): 153 response['instances'].append( 154 dict( ... 158 heartbeat=instance.modified, <======= ... ~~~ Because of that, `/api/v2/ping` will not return a new value every minute, it will return a new value only if the user fiddles manually with the instance properties (e.g. any change on Administration > Instance Group > ""any instance group"" > Instance Page, etc.). Now, being said that in AAP2.1 (Ansible Automation Platform Controller 4.1.0) `/api/v2/instances/` **does** return correctly all the fields, including last_seen and last_health_check which are updated every minute as expected. (*) back then, there was no `last_seen` nor `last_health_check` field in the Instance model ### AWX version Red Hat Downstream AAP2.1 ### Installation method docker on linux ### Modifications no ### Ansible version Ansible Automation Platform Controller 4.1.0 ### Operating system Linux RHEL8.3 ### Web browser Firefox ### Steps to reproduce Access `https://<awx-url>/api/v2/ping/` and compare the response with the one from `https://192.168.122.106/api/v2/instances/`. ""heartbeat"" value from `ping` endpoint will be older than the same value from `instances` endpoint. ### Expected results ""heartbeat"" value from `ping` endpoint should match ""last_seen"" and ""last_health_check"" values from `instances` endpoint results. (Not sure about ""last_seen"", but in my tests, said field have always had the same value as ""last_health_check"" field so far) ### Actual results ""heartbeat"" value from `ping` endpoint will be older than the same value from `instances` endpoint. ### Additional information Likely related commit: https://github.com/ansible/tower/commit/6a17e5b65bf9421c2e650d23817c79ce81248c6f Likely related issue: https://github.com/ansible/awx/issues/10737"
9222,awx,https://github.com/ansible/awx/issues/9222,Passing a bad lookup type modifier in api request triggers 500 error,"##### ISSUE TYPE - Bug Report ##### SUMMARY Send a request like `/api/v2/jobs/?id__iexact=1` <img width=""1680"" alt=""Screen Shot 2021-02-03 at 12 28 26 PM"" src=""https://user-images.githubusercontent.com/9889020/106785392-56b84880-661b-11eb-9288-fa50845636f7.png""> `iexact` isn't supported on the `id` field. What I'm hoping for is a nice 4xx error that says that modifier is not supported. The impetuous for this issue came from https://github.com/ansible/awx/issues/7834. The advanced search in the UI allows the user to select from a static list of modifiers in the `Advanced` section. I left that issue open as a UI enhancement to attempt to trim that list down to only modifiers that will work with a particular field.",source-file | test-file | source-file | test-file | source-file | test-file,passing bad lookup type modifier api triggers type bug report summary send like api jobs iexact img width alt screen shot https user images githubusercontent png iexact supported field hoping nice says modifier supported impetuous came https github ansible issues advanced search allows user select static list modifiers advanced section left open enhancement attempt trim list modifiers work particular field,bug,0.95,"Passing a bad lookup type modifier in api request triggers 500 error ##### ISSUE TYPE - Bug Report ##### SUMMARY Send a request like `/api/v2/jobs/?id__iexact=1` <img width=""1680"" alt=""Screen Shot 2021-02-03 at 12 28 26 PM"" src=""https://user-images.githubusercontent.com/9889020/106785392-56b84880-661b-11eb-9288-fa50845636f7.png""> `iexact` isn't supported on the `id` field. What I'm hoping for is a nice 4xx error that says that modifier is not supported. The impetuous for this issue came from https://github.com/ansible/awx/issues/7834. The advanced search in the UI allows the user to select from a static list of modifiers in the `Advanced` section. I left that issue open as a UI enhancement to attempt to trim that list down to only modifiers that will work with a particular field."
11452,awx,https://github.com/ansible/awx/issues/11452,TypeError: Converting circular structure to JSON trying to relaunch Jobs,### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Trying to relaunch a job is causing `Failed to launch job.` `TypeError: Converting circular structure to JSON --> starting at object with constructor 'HTMLButtonElement'` ### AWX version devel ### Installation method docker on linux ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser Chrome ### Steps to reproduce 1. Create a job template 2. Launch this JT 3. Go to jobs list 4. Relaunch the job ### Expected results The job to relaunch successfully and run ### Actual results ``` TypeError: Converting circular structure to JSON --> starting at object with constructor 'HTMLButtonElement' | property '__reactFiber$ufx73v3ec7m' -> object with constructor 'Bl' --- property 'stateNode' closes the circle at stringify (<anonymous>) at https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:912670 at Object.l.transformRequest (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:912674) at https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1450812 at Object.u [as forEach] (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:356646) at Object.e.exports (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1450785) at e.exports (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1450199) at u.request (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1449016) at u.r.forEach.u.<computed> [as post] (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1449469) at Function.post (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1059419) ``` ![image](https://user-images.githubusercontent.com/12464858/145837634-7227b6ae-d1e4-4553-9a74-c5bc68aa3569.png) ### Additional information _No response_,source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file,typeerror converting circular structure json trying relaunch jobs please confirm following agree follow project conduct http docs ansible ansible latest community conduct html checked current issues https github ansible issues duplicates understand open software provided free entitled status updates assurances summary trying relaunch job causing failed launch job typeerror converting circular structure json starting object constructor htmlbuttonelement devel installation method docker linux modifications ansible response operating system response web browser chrome steps reproduce create job template launch jobs list relaunch job expected results job relaunch successfully actual results typeerror converting circular structure json starting object constructor htmlbuttonelement property reactfiber ufx object constructor property statenode closes circle stringify anonymous https localhost static chunk object transformrequest https localhost static chunk https localhost static chunk object foreach https localhost static chunk object exports https localhost static chunk exports https localhost static chunk https localhost static chunk foreach computed post https localhost static chunk function post https localhost static chunk image https user images githubusercontent png additional information response,bug,0.9,TypeError: Converting circular structure to JSON trying to relaunch Jobs ### Please confirm the following - [X] I agree to follow this project's [code of conduct](http://docs.ansible.com/ansible/latest/community/code_of_conduct.html). - [X] I have checked the [current issues](https://github.com/ansible/awx/issues) for duplicates. - [X] I understand that AWX is open source software provided for free and that I am not entitled to status updates or other assurances. ### Summary Trying to relaunch a job is causing `Failed to launch job.` `TypeError: Converting circular structure to JSON --> starting at object with constructor 'HTMLButtonElement'` ### AWX version devel ### Installation method docker on linux ### Modifications no ### Ansible version _No response_ ### Operating system _No response_ ### Web browser Chrome ### Steps to reproduce 1. Create a job template 2. Launch this JT 3. Go to jobs list 4. Relaunch the job ### Expected results The job to relaunch successfully and run ### Actual results ``` TypeError: Converting circular structure to JSON --> starting at object with constructor 'HTMLButtonElement' | property '__reactFiber$ufx73v3ec7m' -> object with constructor 'Bl' --- property 'stateNode' closes the circle at stringify (<anonymous>) at https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:912670 at Object.l.transformRequest (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:912674) at https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1450812 at Object.u [as forEach] (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:356646) at Object.e.exports (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1450785) at e.exports (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1450199) at u.request (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1449016) at u.r.forEach.u.<computed> [as post] (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1449469) at Function.post (https://localhost:8043/static/js/2.c2ae93d7.chunk.js:2:1059419) ``` ![image](https://user-images.githubusercontent.com/12464858/145837634-7227b6ae-d1e4-4553-9a74-c5bc68aa3569.png) ### Additional information _No response_
6324,awx,https://github.com/ansible/awx/issues/6324,tower_role not idempotent,"##### ISSUE TYPE - Bug Report ##### SUMMARY Granting a user a role with the AWX collection twice gives changed twice ##### ENVIRONMENT * AWX version: 9.3.0 ##### STEPS TO REPRODUCE ```yaml - name: Add Joe to workflow execute role tower_role: user: joe role: execute workflow: test-role-workflow state: present register: result - assert: that: - ""result is changed"" - name: Add Joe from the workflow execute role, no-op tower_role: user: joe role: execute workflow: test-role-workflow state: present register: result - assert: that: - ""result is not changed"" ``` ##### EXPECTED RESULTS passes ##### ACTUAL RESULTS fails, both tasks report changed ##### ADDITIONAL INFORMATION this is being refactored anyway, test again then https://github.com/ansible/awx/pull/6304",source-file | source-file | test-file,tower role idempotent type bug report summary granting user role collection twice gives changed twice environment steps reproduce yaml name joe workflow execute role tower role user joe role execute workflow role workflow state present register result assert result changed name joe workflow execute role tower role user joe role execute workflow role workflow state present register result assert result changed expected results passes actual results fails tasks report changed additional information refactored anyway https github ansible,bug,0.9,"tower_role not idempotent ##### ISSUE TYPE - Bug Report ##### SUMMARY Granting a user a role with the AWX collection twice gives changed twice ##### ENVIRONMENT * AWX version: 9.3.0 ##### STEPS TO REPRODUCE ```yaml - name: Add Joe to workflow execute role tower_role: user: joe role: execute workflow: test-role-workflow state: present register: result - assert: that: - ""result is changed"" - name: Add Joe from the workflow execute role, no-op tower_role: user: joe role: execute workflow: test-role-workflow state: present register: result - assert: that: - ""result is not changed"" ``` ##### EXPECTED RESULTS passes ##### ACTUAL RESULTS fails, both tasks report changed ##### ADDITIONAL INFORMATION this is being refactored anyway, test again then https://github.com/ansible/awx/pull/6304"
